Title: Mozilla Security Research Summit 2019 - The Security and Privacy Impact of Redirects
Publication date: 2019-06-24
Playlist: 2019 SF Security Research Summit
Description: 
	Matt Bernard - Internet Pinball: The Security and Privacy Impact of Redirects

Talk from the 2019 SF Security Research Summit (https://events.mozilla.org/moz2019securityresearchsummit). This event is part of the Security Engineering University Relationship Framework (SURF) initiative, which aims to increase collaboration between Mozilla and the academic community. We would like to leverage academic talent to help explore security and privacy research problems, and to strengthen Mozilla's ties to the academic community. Mozilla security engineers aim to actively participate in the research community through thesis supervision, collaborations, placements and Mozilla-hosted security summits. For more info see: https://surf.mozilla.org/

Slides: https://drive.google.com/open?id=1Gur6Gjz88bVRHyATv_XxJ6Xwe02qmSgA
Captions: 
	00:00:00,390 --> 00:00:04,170
hello my name is Matt Bernhardt I'm a

00:00:02,909 --> 00:00:05,580
PhD student at the University of

00:00:04,170 --> 00:00:07,649
Michigan and I'm going to talk to you

00:00:05,580 --> 00:00:12,559
today about some work we've done looking

00:00:07,649 --> 00:00:14,460
at security and privacy of redirects and

00:00:12,559 --> 00:00:19,410
these slides are a little old

00:00:14,460 --> 00:00:21,060
unfortunately you know browsers there's

00:00:19,410 --> 00:00:22,710
a lot of good security work that's been

00:00:21,060 --> 00:00:25,170
done on browsers Mozilla has rolled out

00:00:22,710 --> 00:00:27,720
a lot of really great technologies and

00:00:25,170 --> 00:00:31,410
things like as we heard earlier today

00:00:27,720 --> 00:00:36,750
tracking third parties are fairly well

00:00:31,410 --> 00:00:38,460
understood parts of you know the way

00:00:36,750 --> 00:00:40,890
that we secure end users however

00:00:38,460 --> 00:00:42,420
redirects have not been as independently

00:00:40,890 --> 00:00:43,440
study or have not really been studied on

00:00:42,420 --> 00:00:45,600
their own they've been studied in

00:00:43,440 --> 00:00:48,600
context of third parties and so forth

00:00:45,600 --> 00:00:51,059
and so what we wanted to do was look if

00:00:48,600 --> 00:00:54,000
we just set redirects kind of on their

00:00:51,059 --> 00:00:57,300
own what what are the security and

00:00:54,000 --> 00:01:01,109
privacy aspects of them so just a quick

00:00:57,300 --> 00:01:02,940
brief reminder you know redirects are a

00:01:01,109 --> 00:01:05,220
fairly critical part of Internet

00:01:02,940 --> 00:01:06,750
infrastructure especially as social

00:01:05,220 --> 00:01:10,890
media platforms and so forth have become

00:01:06,750 --> 00:01:13,409
bigger we see redirects used to fix the

00:01:10,890 --> 00:01:18,360
format of links to shortened links we

00:01:13,409 --> 00:01:21,960
also see them to blind you know web

00:01:18,360 --> 00:01:23,670
content behavior and you know to enable

00:01:21,960 --> 00:01:25,790
tracking and so on and so forth so

00:01:23,670 --> 00:01:29,490
there's sort of a wide variety of

00:01:25,790 --> 00:01:30,920
functionality that redirect support and

00:01:29,490 --> 00:01:33,990
unfortunately this can lead to

00:01:30,920 --> 00:01:35,850
compromise of security privacy right you

00:01:33,990 --> 00:01:39,240
things like drive-by downloads cookie

00:01:35,850 --> 00:01:42,840
leakage tracking so on and so forth are

00:01:39,240 --> 00:01:44,189
all enabled by redirects so one of the

00:01:42,840 --> 00:01:46,380
first things we did was we tried to sort

00:01:44,189 --> 00:01:48,780
of texana mize redirects in the process

00:01:46,380 --> 00:01:50,579
of a reader what can happen well you

00:01:48,780 --> 00:01:52,380
know they're sort of from a TLS

00:01:50,579 --> 00:01:54,060
perspective there's sort of two things

00:01:52,380 --> 00:01:56,909
that can happen right you can either be

00:01:54,060 --> 00:02:00,390
using TLS or you cannot be so this is

00:01:56,909 --> 00:02:02,130
just sort of a brief diagram of all the

00:02:00,390 --> 00:02:06,680
different ways that that TLS can be

00:02:02,130 --> 00:02:06,680
turned on and off via redirects

00:02:07,590 --> 00:02:12,870
so one thing we you know we were trying

00:02:11,610 --> 00:02:14,970
to set up a measurement platform

00:02:12,870 --> 00:02:18,239
how can we measure the impact of

00:02:14,970 --> 00:02:20,910
redirects and what we decided to do was

00:02:18,239 --> 00:02:23,310
use Twitter links so we collected 7.4

00:02:20,910 --> 00:02:24,709
million links from Twitter from verified

00:02:23,310 --> 00:02:27,810
accounts that had over a million

00:02:24,709 --> 00:02:31,769
followers so it'd be like that link

00:02:27,810 --> 00:02:33,209
there and then we we pulled out a

00:02:31,769 --> 00:02:35,970
hundred million of those at first and

00:02:33,209 --> 00:02:38,040
crawl them using open wpm but that was

00:02:35,970 --> 00:02:40,170
really slow open wpm is not really

00:02:38,040 --> 00:02:43,830
designed for this specific task so we

00:02:40,170 --> 00:02:45,690
built a new system called tilt that it

00:02:43,830 --> 00:02:47,579
adds some sort of a synchronicity and

00:02:45,690 --> 00:02:50,190
stuff that makes crawling redirects a

00:02:47,579 --> 00:02:52,380
lot faster and with that we were able to

00:02:50,190 --> 00:02:54,120
process ten redirects over ten redirects

00:02:52,380 --> 00:02:58,230
per second and we could actually crawl

00:02:54,120 --> 00:03:00,120
our whole data set using tilt some sort

00:02:58,230 --> 00:03:02,010
of brief results this is still an

00:03:00,120 --> 00:03:04,620
ongoing work we need to we're still kind

00:03:02,010 --> 00:03:05,730
of fiddling with with exactly how the

00:03:04,620 --> 00:03:08,370
measurements are done on what data were

00:03:05,730 --> 00:03:09,629
collecting but from our preliminary

00:03:08,370 --> 00:03:11,610
results

00:03:09,629 --> 00:03:12,959
23% of redirects take less than a

00:03:11,610 --> 00:03:15,930
hundred milliseconds which is well below

00:03:12,959 --> 00:03:17,310
the threshold for you know users being

00:03:15,930 --> 00:03:19,049
able to recognize that even a redirect

00:03:17,310 --> 00:03:21,720
has occurred seventy percent take less

00:03:19,049 --> 00:03:23,609
than a second and in terms of redirect

00:03:21,720 --> 00:03:25,859
chains so you get redirected from site a

00:03:23,609 --> 00:03:28,920
to site B to site see something like

00:03:25,859 --> 00:03:33,090
fifty percent of those happen in under a

00:03:28,920 --> 00:03:34,709
second so so redirects you know the if

00:03:33,090 --> 00:03:36,389
things like TLS downgrades are happening

00:03:34,709 --> 00:03:38,280
or cookie leaking or something like that

00:03:36,389 --> 00:03:40,380
is happening it's going to be fairly

00:03:38,280 --> 00:03:42,780
imperceptible to users

00:03:40,380 --> 00:03:44,910
we saw one percent of redirect links

00:03:42,780 --> 00:03:46,849
resulted in down grits to HTTPS which i

00:03:44,910 --> 00:03:50,040
think is actually pretty good

00:03:46,849 --> 00:03:51,510
ten percent never go over HTTP so

00:03:50,040 --> 00:03:53,489
there's never any upgrading that happens

00:03:51,510 --> 00:03:56,819
which i think is roughly in line with

00:03:53,489 --> 00:03:57,750
TLS deployment across the web and one of

00:03:56,819 --> 00:03:59,609
the more interesting things that we

00:03:57,750 --> 00:04:01,109
found is that four percent it's actually

00:03:59,609 --> 00:04:03,239
closer to five percent traverse

00:04:01,109 --> 00:04:07,260
international borders so you know if you

00:04:03,239 --> 00:04:09,389
are visiting a website and you for some

00:04:07,260 --> 00:04:11,160
reason your traffic now suddenly goes

00:04:09,389 --> 00:04:12,959
over international border you might be

00:04:11,160 --> 00:04:15,359
subject to different data privacy laws

00:04:12,959 --> 00:04:17,940
so for instance GDP or something like

00:04:15,359 --> 00:04:18,900
that might come into play suddenly and

00:04:17,940 --> 00:04:20,489
it's also has implication you know

00:04:18,900 --> 00:04:22,620
California has a privacy law that is

00:04:20,489 --> 00:04:27,659
about to go into effect that might have

00:04:22,620 --> 00:04:29,099
implications there so you know we have

00:04:27,659 --> 00:04:31,200
some sort of very tentative evidence

00:04:29,099 --> 00:04:34,190
that that there are some risks that

00:04:31,200 --> 00:04:37,200
Reader expose to users we heard about

00:04:34,190 --> 00:04:41,669
some of the tracking defenses earlier

00:04:37,200 --> 00:04:43,380
today so what we propose to do is build

00:04:41,669 --> 00:04:46,110
a browser extension to shortcut

00:04:43,380 --> 00:04:48,030
redirects and so the way this works is

00:04:46,110 --> 00:04:49,979
that we have a browser extension and

00:04:48,030 --> 00:04:52,229
then we have on the cloud we have our

00:04:49,979 --> 00:04:53,760
tilt system running and so the when you

00:04:52,229 --> 00:04:55,800
click a link the browser extension will

00:04:53,760 --> 00:04:57,810
upload we'll send that link to our to a

00:04:55,800 --> 00:05:01,020
sandbox in the cloud which will execute

00:04:57,810 --> 00:05:02,760
all of the the redirect paths and then

00:05:01,020 --> 00:05:04,800
whatever the final URL is that it gets

00:05:02,760 --> 00:05:06,840
it'll send it back to you or to your

00:05:04,800 --> 00:05:09,000
browser and the hope there is that it

00:05:06,840 --> 00:05:10,320
you know we can we can set this to be

00:05:09,000 --> 00:05:11,909
super strict where it'll just strip out

00:05:10,320 --> 00:05:13,500
all possible tracking cookies and so

00:05:11,909 --> 00:05:16,550
forth or it can be a little bit more

00:05:13,500 --> 00:05:18,780
permissive well we don't know yet is

00:05:16,550 --> 00:05:20,690
whether or not this totally breaks the

00:05:18,780 --> 00:05:24,960
internet that's something that we are

00:05:20,690 --> 00:05:28,080
working on right now so yeah

00:05:24,960 --> 00:05:29,580
redirects are a critical part of

00:05:28,080 --> 00:05:31,020
Internet infrastructure so we can't just

00:05:29,580 --> 00:05:34,229
get rid of them kind of like we saw with

00:05:31,020 --> 00:05:35,820
with tracking and so forth and you know

00:05:34,229 --> 00:05:37,409
a lot of work is still ongoing

00:05:35,820 --> 00:05:39,060
to try and better understand what's

00:05:37,409 --> 00:05:40,260
going on with redirects so with that I

00:05:39,060 --> 00:05:41,880
want to thank my collaborators

00:05:40,260 --> 00:05:43,680
drew spring all Steve Spector Alex

00:05:41,880 --> 00:05:45,240
Holland and Brian and saathi and thanks

00:05:43,680 --> 00:05:47,130
to Steve for inviting me to talk and

00:05:45,240 --> 00:05:53,900
also helping us learn how open wpm works

00:05:47,130 --> 00:05:53,900

YouTube URL: https://www.youtube.com/watch?v=JzKh-3xfYQ0


