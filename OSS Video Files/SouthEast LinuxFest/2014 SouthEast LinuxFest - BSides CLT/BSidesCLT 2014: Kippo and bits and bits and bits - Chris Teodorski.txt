Title: BSidesCLT 2014: Kippo and bits and bits and bits - Chris Teodorski
Publication date: 2015-05-23
Playlist: 2014 SouthEast LinuxFest - BSides CLT
Description: 
	BSides 2014: Presentation by Chris Teodorski on his experience implementing and testing honeypots to improve organizational security...with some humorous stories and examples!
Captions: 
	00:00:00,000 --> 00:00:03,000
alright well first of all thanks

00:00:01,469 --> 00:00:05,009
everybody for coming i will try not to

00:00:03,000 --> 00:00:08,309
wander i tend to wander around the stage

00:00:05,009 --> 00:00:10,410
and i will try not to do that as John

00:00:08,309 --> 00:00:14,460
said my name is Kristy door ski and the

00:00:10,410 --> 00:00:16,289
first talk is on ssh honey potting or as

00:00:14,460 --> 00:00:19,680
I called it Capo's hippo and bits and

00:00:16,289 --> 00:00:21,300
bits and bits so first of all a little

00:00:19,680 --> 00:00:23,910
bit about me as I said my name is

00:00:21,300 --> 00:00:26,939
Christian or ski I'm a dad and a husband

00:00:23,910 --> 00:00:31,340
I just recently started as a security

00:00:26,939 --> 00:00:36,809
analyst for emc Rubicon that is emcs

00:00:31,340 --> 00:00:40,500
cloud offering I'm a full-time geek I am

00:00:36,809 --> 00:00:42,750
at can o beans on Twitter and I'll put

00:00:40,500 --> 00:00:44,670
my little plug in here the cert that I

00:00:42,750 --> 00:00:47,280
have that I'm the most proud of is the

00:00:44,670 --> 00:00:52,199
OS CP which is the offensive security

00:00:47,280 --> 00:00:54,899
hands on pentesting cert and it's very

00:00:52,199 --> 00:00:56,309
inexpensive and it is the cert that I

00:00:54,899 --> 00:00:59,129
have like I said that I'm the most proud

00:00:56,309 --> 00:01:01,500
of it's it's a hell of a bargain and

00:00:59,129 --> 00:01:03,480
you'll learn a ton if you take it not

00:01:01,500 --> 00:01:05,549
getting paid for saying this or anything

00:01:03,480 --> 00:01:08,250
I just it's I was really really

00:01:05,549 --> 00:01:12,060
impressed with the class and what they

00:01:08,250 --> 00:01:17,159
offer the other thing I promised my boss

00:01:12,060 --> 00:01:20,970
I would say is we are hiring so we have

00:01:17,159 --> 00:01:22,710
two security positions open on my team

00:01:20,970 --> 00:01:24,990
they are a hundred percent work from

00:01:22,710 --> 00:01:26,400
home positions one of them is a senior

00:01:24,990 --> 00:01:29,220
level position and one is a mid-level

00:01:26,400 --> 00:01:30,750
position so I can't guarantee you a job

00:01:29,220 --> 00:01:32,159
but I can guarantee I can get your

00:01:30,750 --> 00:01:34,590
resume to the right people if you want

00:01:32,159 --> 00:01:36,689
to get it to me and like I said you can

00:01:34,590 --> 00:01:39,299
be anywhere in the country so because it

00:01:36,689 --> 00:01:40,619
is one hundred percent work from home so

00:01:39,299 --> 00:01:43,680
I did promise I would put that in and

00:01:40,619 --> 00:01:46,799
that's quite enough about me and let's

00:01:43,680 --> 00:01:49,619
get down to the talk so let's talk about

00:01:46,799 --> 00:01:53,070
what a honeypot is first of all a

00:01:49,619 --> 00:01:56,250
honeypot is a system on your network

00:01:53,070 --> 00:01:59,399
that serves no purpose other than to be

00:01:56,250 --> 00:02:01,939
a target for a bad guy right that's

00:01:59,399 --> 00:02:04,860
that's essentially what a honeypot is

00:02:01,939 --> 00:02:07,469
and I would break honey pots down into

00:02:04,860 --> 00:02:10,500
two different categories there's an

00:02:07,469 --> 00:02:12,120
analysis things like honey d the

00:02:10,500 --> 00:02:13,800
honeynet project these are things where

00:02:12,120 --> 00:02:16,340
you can install your honey pot

00:02:13,800 --> 00:02:19,410
learn about what the attackers are doing

00:02:16,340 --> 00:02:20,850
then there's also the delay now these

00:02:19,410 --> 00:02:22,080
are things like the La Brea tar pit

00:02:20,850 --> 00:02:24,330
that's a project that's been around

00:02:22,080 --> 00:02:26,610
forever essentially what that does is

00:02:24,330 --> 00:02:28,830
when an attacker hits it they get tar

00:02:26,610 --> 00:02:31,230
pit they get stuck in it and you know

00:02:28,830 --> 00:02:32,670
scanners and things take a long time to

00:02:31,230 --> 00:02:36,270
run through the Tar Pits so it's

00:02:32,670 --> 00:02:38,910
designed to slow them down again the

00:02:36,270 --> 00:02:41,700
idea is that this resource exists solely

00:02:38,910 --> 00:02:43,170
to be compromised right that's the only

00:02:41,700 --> 00:02:45,180
reason it exists it doesn't offer any

00:02:43,170 --> 00:02:47,670
other services and that's important

00:02:45,180 --> 00:02:50,850
because the only traffic it should ever

00:02:47,670 --> 00:02:55,200
see is a legitimate traffic shouldn't

00:02:50,850 --> 00:02:57,750
ever be seeing legitimate traffic so

00:02:55,200 --> 00:02:59,550
when I when I started this talk I

00:02:57,750 --> 00:03:02,370
started when I decided to do this talk I

00:02:59,550 --> 00:03:05,670
started doing a lot of research into the

00:03:02,370 --> 00:03:09,450
honeypot and what I call the rise and

00:03:05,670 --> 00:03:11,970
fall and rise again of the honeypot the

00:03:09,450 --> 00:03:14,250
first reference in print anyways to a

00:03:11,970 --> 00:03:16,580
honeypot is Cliff's Tolls book the

00:03:14,250 --> 00:03:18,600
Cuckoo's egg which was written in 1989

00:03:16,580 --> 00:03:21,690
if you haven't read the book I highly

00:03:18,600 --> 00:03:24,989
recommended it's an easy read cliff was

00:03:21,690 --> 00:03:27,239
working for Berkeley Lab's and noticed a

00:03:24,989 --> 00:03:29,940
discrepancy in the way they were billing

00:03:27,239 --> 00:03:32,040
CPU time and then discovered that

00:03:29,940 --> 00:03:34,110
someone had accessed their computers and

00:03:32,040 --> 00:03:36,420
was completely was continually accessing

00:03:34,110 --> 00:03:41,910
their computers so he set up a honeypot

00:03:36,420 --> 00:03:43,770
to capture these intruders and like I

00:03:41,910 --> 00:03:47,790
said it's it's a it's a very it's a very

00:03:43,770 --> 00:03:51,000
interesting read in the early 2000s

00:03:47,790 --> 00:03:52,560
honey pots were a hot idea when you

00:03:51,000 --> 00:03:55,050
google honeypot you'll find lots of

00:03:52,560 --> 00:03:56,970
stuff from you know 10 15 years ago that

00:03:55,050 --> 00:03:58,470
talks about honey pots there were a lot

00:03:56,970 --> 00:04:01,670
of manufacturers there are a lot of

00:03:58,470 --> 00:04:03,540
commercial honeypot products out there

00:04:01,670 --> 00:04:08,700
symantec was selling a product called

00:04:03,540 --> 00:04:11,940
man trap there was Specter net bait KF

00:04:08,700 --> 00:04:18,900
sensor but all these products kind of

00:04:11,940 --> 00:04:20,400
were there and then gone and so if you

00:04:18,900 --> 00:04:22,350
look at now there there's there's

00:04:20,400 --> 00:04:24,240
there's honey pots out there most of

00:04:22,350 --> 00:04:26,130
them are non-commercial and i'll get to

00:04:24,240 --> 00:04:27,720
that in a second so while i was googling

00:04:26,130 --> 00:04:30,330
I did run

00:04:27,720 --> 00:04:32,490
cross this product and there's an inside

00:04:30,330 --> 00:04:35,250
security community joke coming up so

00:04:32,490 --> 00:04:37,590
just so you just so you're ready for

00:04:35,250 --> 00:04:39,360
that I did come across this product and

00:04:37,590 --> 00:04:40,650
and I was very interested in at first

00:04:39,360 --> 00:04:43,680
cuz I was like oh wow look this is a

00:04:40,650 --> 00:04:45,570
commercial honey pot and then I started

00:04:43,680 --> 00:04:47,250
reading about it and yeah it kind of is

00:04:45,570 --> 00:04:49,500
and then I saw that it hadn't been

00:04:47,250 --> 00:04:52,020
updated in a long time and then a lot of

00:04:49,500 --> 00:04:54,420
the wording on it just seemed weird like

00:04:52,020 --> 00:04:56,460
they were calling it an IDs and I guess

00:04:54,420 --> 00:04:58,590
I can see how you would say a honeypot

00:04:56,460 --> 00:05:01,560
is an IDs an intrusion detection system

00:04:58,590 --> 00:05:05,310
but it's not really exactly the same

00:05:01,560 --> 00:05:06,450
thing and then the more I read about it

00:05:05,310 --> 00:05:10,800
the more I thought it sounded like

00:05:06,450 --> 00:05:12,090
something this guy wrote and so for any

00:05:10,800 --> 00:05:15,020
of you who don't know this is the

00:05:12,090 --> 00:05:19,500
world's number one hacker gregory evans

00:05:15,020 --> 00:05:24,510
who has is quite infamous for his his

00:05:19,500 --> 00:05:25,890
his bravado and his lack of abilities so

00:05:24,510 --> 00:05:30,630
we'll just kind of will just kind of

00:05:25,890 --> 00:05:33,390
leave it at that so as I was as I was

00:05:30,630 --> 00:05:36,150
researching this I started to wonder why

00:05:33,390 --> 00:05:37,470
the honeypot had kind of its why there

00:05:36,150 --> 00:05:39,800
was all this commercial interest in

00:05:37,470 --> 00:05:42,030
honey pot in two thousand and then by

00:05:39,800 --> 00:05:43,979
2005-2006 it seemed like everybody had

00:05:42,030 --> 00:05:46,560
exited the market you know what what

00:05:43,979 --> 00:05:49,169
happened why was it why wyd was the

00:05:46,560 --> 00:05:50,970
interest lost so I went to Twitter

00:05:49,169 --> 00:05:53,250
because that's what I do and said hey

00:05:50,970 --> 00:05:55,110
why is what's what's up with the honey

00:05:53,250 --> 00:05:58,620
pot like why is no one interested in the

00:05:55,110 --> 00:06:01,050
honey pot anymore and and Nick Harbor

00:05:58,620 --> 00:06:03,740
who was at the time malware analyst for

00:06:01,050 --> 00:06:07,200
mandiant i'm not sure if he still is

00:06:03,740 --> 00:06:09,060
responded to me and he said maybe

00:06:07,200 --> 00:06:12,090
because it's a waste of time and never

00:06:09,060 --> 00:06:13,680
improved security and i was like geez

00:06:12,090 --> 00:06:16,229
that hurts because i think this is a

00:06:13,680 --> 00:06:17,490
pretty cool idea and to say that it was

00:06:16,229 --> 00:06:21,030
a waste of time and never improved

00:06:17,490 --> 00:06:22,590
security I don't know that's just so I

00:06:21,030 --> 00:06:24,810
started thinking about it myself and I

00:06:22,590 --> 00:06:26,220
started thinking about again after I

00:06:24,810 --> 00:06:28,050
after I kind of went through the

00:06:26,220 --> 00:06:31,800
exercises that I went through to prepare

00:06:28,050 --> 00:06:36,110
for this talk i realized that i think my

00:06:31,800 --> 00:06:39,479
theory anyways on why honey pots lost

00:06:36,110 --> 00:06:41,360
lost their their their glamour and why

00:06:39,479 --> 00:06:44,569
they lost interest is because i don't

00:06:41,360 --> 00:06:46,400
think any of them at the time were kind

00:06:44,569 --> 00:06:48,289
of that click click drool tool where you

00:06:46,400 --> 00:06:52,400
could just kind of get really easy

00:06:48,289 --> 00:06:54,710
intelligence out of them and so that's

00:06:52,400 --> 00:06:55,939
my suspicions I don't really know what

00:06:54,710 --> 00:06:57,259
what happened I mean it could just be

00:06:55,939 --> 00:06:59,120
they weren't selling well right I mean

00:06:57,259 --> 00:07:00,949
that that could be what it was but but

00:06:59,120 --> 00:07:07,990
interest was definitely was definitely

00:07:00,949 --> 00:07:10,400
lost now in 2011 I think it is here

00:07:07,990 --> 00:07:13,280
symantec announced that they were going

00:07:10,400 --> 00:07:15,650
to start selling a honeypot product

00:07:13,280 --> 00:07:19,250
again but only to their large

00:07:15,650 --> 00:07:20,990
enterprises and government and I don't

00:07:19,250 --> 00:07:25,430
know what the status of this currently

00:07:20,990 --> 00:07:27,830
is this offering what I do know is that

00:07:25,430 --> 00:07:30,349
all of the all of the AV manufacturers

00:07:27,830 --> 00:07:32,180
you know run honey pots honey nets

00:07:30,349 --> 00:07:33,830
because they're collecting malware right

00:07:32,180 --> 00:07:36,710
so they can they can watch for it and

00:07:33,830 --> 00:07:40,819
apparently this basically semantics was

00:07:36,710 --> 00:07:42,259
turning around and and taking their you

00:07:40,819 --> 00:07:43,969
know what they were using internally and

00:07:42,259 --> 00:07:47,690
marketing it to these to these large

00:07:43,969 --> 00:07:50,629
customers and and according to the

00:07:47,690 --> 00:07:51,740
article both their competitors were

00:07:50,629 --> 00:07:54,650
rather surprised that they were doing

00:07:51,740 --> 00:07:57,529
this and again you know I think it must

00:07:54,650 --> 00:08:00,529
have been a tough sell to to to market

00:07:57,529 --> 00:08:01,789
the honeypot so that's kind of all the

00:08:00,529 --> 00:08:03,589
bad stuff that people have said about

00:08:01,789 --> 00:08:06,800
honey pots and what why honey pots are

00:08:03,589 --> 00:08:10,089
not maybe not in favor as much as they

00:08:06,800 --> 00:08:14,960
as I think they should be but I think

00:08:10,089 --> 00:08:17,180
Lenny Seltzer who teaches sands the

00:08:14,960 --> 00:08:19,430
forensics the malware analysis class and

00:08:17,180 --> 00:08:23,240
you know he's does a lot of malware

00:08:19,430 --> 00:08:26,509
analysis and a lot of there's a lot of a

00:08:23,240 --> 00:08:30,050
lot of teaching he posted this at one

00:08:26,509 --> 00:08:31,520
point about honey pots and I mean you

00:08:30,050 --> 00:08:34,190
guys are all very capable of reading but

00:08:31,520 --> 00:08:38,570
I think the important part there is he

00:08:34,190 --> 00:08:42,199
talks about in this he talks about it

00:08:38,570 --> 00:08:44,390
being part of a mature enterprise and I

00:08:42,199 --> 00:08:48,649
think that's probably one of the big

00:08:44,390 --> 00:08:50,180
keys is that honey pot should not be the

00:08:48,649 --> 00:08:51,920
first thing you deploy shouldn't be the

00:08:50,180 --> 00:08:53,839
second thing you deploy shouldn't even

00:08:51,920 --> 00:08:54,660
be the third thing right you should

00:08:53,839 --> 00:08:56,459
really be

00:08:54,660 --> 00:09:00,269
mature program before you even consider

00:08:56,459 --> 00:09:02,639
deploying honey pots and maybe that's

00:09:00,269 --> 00:09:04,470
why they fell out of favor because in my

00:09:02,639 --> 00:09:07,470
experience there's not a lot of mature

00:09:04,470 --> 00:09:10,759
security programs and that could be why

00:09:07,470 --> 00:09:13,790
you know why the interest was was lost

00:09:10,759 --> 00:09:16,680
the other thing to remember is that

00:09:13,790 --> 00:09:20,850
deploying a honey pot as cool as I think

00:09:16,680 --> 00:09:23,040
it is it's not a panacea you know if you

00:09:20,850 --> 00:09:25,589
have compliance requirements that you

00:09:23,040 --> 00:09:27,389
have to meet and you have an auditor

00:09:25,589 --> 00:09:30,180
come in who finds this intentionally

00:09:27,389 --> 00:09:32,129
vulnerable box it may be a tough sell I

00:09:30,180 --> 00:09:34,589
think it depends on the auditor you know

00:09:32,129 --> 00:09:36,899
if you have an intentionally vulnerable

00:09:34,589 --> 00:09:38,819
windows box again that's you know it

00:09:36,899 --> 00:09:41,670
doesn't look patched you know that looks

00:09:38,819 --> 00:09:44,160
like a big black mark to 2a q SI or to

00:09:41,670 --> 00:09:48,899
an auditor so there are there are real

00:09:44,160 --> 00:09:50,610
challenges to deploying a honeypot but

00:09:48,899 --> 00:09:52,920
for me it's a really fun Friday night

00:09:50,610 --> 00:09:54,480
right because this is how I want to

00:09:52,920 --> 00:09:55,500
spend my time and this is what I want to

00:09:54,480 --> 00:10:01,680
do and I don't have to worry about

00:09:55,500 --> 00:10:04,829
auditors or or q SAS or terms of service

00:10:01,680 --> 00:10:06,660
or anything like that so let's talk

00:10:04,829 --> 00:10:07,889
about Kip oh that's what I said we'd be

00:10:06,660 --> 00:10:09,149
talking about and we're going to start

00:10:07,889 --> 00:10:12,060
with Kip oh but we're not going to end

00:10:09,149 --> 00:10:16,230
with kippo kippo is defined as a medium

00:10:12,060 --> 00:10:19,230
interaction ssh honey pot and so honey

00:10:16,230 --> 00:10:20,610
pots are kind of broken down from low

00:10:19,230 --> 00:10:22,199
interaction medium interaction high

00:10:20,610 --> 00:10:25,439
interaction solo interaction is

00:10:22,199 --> 00:10:28,560
basically mimics a service so it opens a

00:10:25,439 --> 00:10:30,329
port and says hey I'm netbios and that's

00:10:28,560 --> 00:10:31,680
it that's as far as it goes right that's

00:10:30,329 --> 00:10:34,350
and it's just to see if someone's

00:10:31,680 --> 00:10:37,529
probing you then you have the medium

00:10:34,350 --> 00:10:40,170
interaction honeypot where kippo kippo

00:10:37,529 --> 00:10:43,319
mimics the entire shell so it looks and

00:10:40,170 --> 00:10:45,269
feels like SSH it's not but it looks and

00:10:43,319 --> 00:10:47,040
feels like it so when you connect to it

00:10:45,269 --> 00:10:49,860
it's very hard to tell that you're not

00:10:47,040 --> 00:10:51,990
actually on a real SSH connection and

00:10:49,860 --> 00:10:53,370
then of course a high interaction would

00:10:51,990 --> 00:10:55,259
be something like a full-blown operating

00:10:53,370 --> 00:10:59,459
system right that you have that you're

00:10:55,259 --> 00:11:02,370
watching what's going on so kippo is a

00:10:59,459 --> 00:11:04,319
piece of cake to install it's really

00:11:02,370 --> 00:11:06,649
easy to get running those are the

00:11:04,319 --> 00:11:06,649
requirements

00:11:06,870 --> 00:11:11,760
it's written in Python it's a piece of

00:11:09,120 --> 00:11:15,960
cake it's it's you know basically that

00:11:11,760 --> 00:11:18,180
will get you ready for kippo on debian

00:11:15,960 --> 00:11:20,339
or good 12 in the case that i used

00:11:18,180 --> 00:11:22,470
ubuntu that'll get you ready to go you

00:11:20,339 --> 00:11:24,480
download and you extract it and you

00:11:22,470 --> 00:11:28,260
execute it that's it I mean it's super

00:11:24,480 --> 00:11:31,589
simple sort of now you do want to tweak

00:11:28,260 --> 00:11:34,050
the config file there is the ssh port is

00:11:31,589 --> 00:11:36,060
set the host name which is what the

00:11:34,050 --> 00:11:38,010
system mimics right what it thinks what

00:11:36,060 --> 00:11:41,100
you want it to announce its host name as

00:11:38,010 --> 00:11:42,540
and the password now the password

00:11:41,100 --> 00:11:45,630
obviously if you want to let attackers

00:11:42,540 --> 00:11:47,250
in needs to be terrible because you want

00:11:45,630 --> 00:11:51,450
them to successfully brute force this

00:11:47,250 --> 00:11:53,940
right that's that's kind of the idea so

00:11:51,450 --> 00:11:56,970
you set that and you're and you're set

00:11:53,940 --> 00:12:01,620
and ready to go this should be obvious

00:11:56,970 --> 00:12:03,270
if you care if you care about the box

00:12:01,620 --> 00:12:05,820
that you're running this on if you don't

00:12:03,270 --> 00:12:08,070
want the the base OS that you're running

00:12:05,820 --> 00:12:10,890
this on to get compromised don't run it

00:12:08,070 --> 00:12:14,400
as root kippo is well written well

00:12:10,890 --> 00:12:16,589
tested but jeez don't do that because if

00:12:14,400 --> 00:12:20,520
they manage to escape out of kippo they

00:12:16,589 --> 00:12:22,230
are going to be owning your box and so

00:12:20,520 --> 00:12:26,220
you know that that could be a very bad

00:12:22,230 --> 00:12:27,779
situation now kippo will warn you if you

00:12:26,220 --> 00:12:29,550
try to do that it'll say hey dum-dum

00:12:27,779 --> 00:12:31,950
what are you doing stop it checks right

00:12:29,550 --> 00:12:34,440
but again just putting that out there

00:12:31,950 --> 00:12:36,180
don't don't do that now what that's

00:12:34,440 --> 00:12:38,339
going to mean is you're going to have to

00:12:36,180 --> 00:12:40,860
run on an unprivileged port which is

00:12:38,339 --> 00:12:44,190
less than ideal because you want to be

00:12:40,860 --> 00:12:47,250
running on 22 so that little IP table

00:12:44,190 --> 00:12:49,260
rule the default kippo port is 222 to

00:12:47,250 --> 00:12:53,339
that little IP table rule will redirect

00:12:49,260 --> 00:12:55,500
anything coming in on 22 22 22 2 which

00:12:53,339 --> 00:12:58,140
essentially gets you to appear as though

00:12:55,500 --> 00:13:01,350
you have ssh running on the standard ssh

00:12:58,140 --> 00:13:07,140
port so once you get this all set up and

00:13:01,350 --> 00:13:10,050
running you just wait and they'll get

00:13:07,140 --> 00:13:13,620
you might the password that i used most

00:13:10,050 --> 00:13:15,990
was one two three four five six and it

00:13:13,620 --> 00:13:19,500
the box got owned over and over and over

00:13:15,990 --> 00:13:21,540
again as one would expect now what

00:13:19,500 --> 00:13:22,830
hippo does is these are the folders that

00:13:21,540 --> 00:13:26,250
you're going to be interested in kippo

00:13:22,830 --> 00:13:28,380
so dl is the download folder so anything

00:13:26,250 --> 00:13:30,000
that you're and again this is on your

00:13:28,380 --> 00:13:32,550
base OS where you're seeing this not

00:13:30,000 --> 00:13:35,640
inside the not inside the kippo faked

00:13:32,550 --> 00:13:38,010
shell anything that your attacker

00:13:35,640 --> 00:13:40,050
attempts to download get stored in that

00:13:38,010 --> 00:13:42,000
download folder so you can go back and

00:13:40,050 --> 00:13:45,120
take a look and see what they downloaded

00:13:42,000 --> 00:13:47,010
the log will show all of the brute force

00:13:45,120 --> 00:13:48,840
attempts so any user name and password

00:13:47,010 --> 00:13:50,490
that they attempt gets written to the

00:13:48,840 --> 00:13:55,980
log so you'll have all that and then

00:13:50,490 --> 00:13:58,290
your TTYL is the coolest directory

00:13:55,980 --> 00:14:00,720
because inside there what kippo gives

00:13:58,290 --> 00:14:03,360
you is what they call vcr like playback

00:14:00,720 --> 00:14:05,640
of the shell session so you can see

00:14:03,360 --> 00:14:07,470
everything the attacker did while they

00:14:05,640 --> 00:14:09,420
were interacting with your shell right

00:14:07,470 --> 00:14:11,010
so you can play it back in in real time

00:14:09,420 --> 00:14:13,890
and watch them interact with your shell

00:14:11,010 --> 00:14:15,360
so now this is the live demo god so

00:14:13,890 --> 00:14:17,430
we're going to try to watch a kippo a

00:14:15,360 --> 00:14:19,200
kippo playback and we're going to see if

00:14:17,430 --> 00:14:21,380
this is going to if this is going to

00:14:19,200 --> 00:14:21,380
work

00:14:42,740 --> 00:14:45,970
okay so

00:14:49,139 --> 00:14:55,529
should only be the one file in there yes

00:14:52,160 --> 00:15:01,040
so kippo comes with a script called play

00:14:55,529 --> 00:15:01,040
log that is designed to play the log

00:15:02,689 --> 00:15:08,999
sorry about that okay so this is what

00:15:07,379 --> 00:15:10,949
you're seeing right here at the bottom

00:15:08,999 --> 00:15:13,649
of the screen there is the actual

00:15:10,949 --> 00:15:15,419
attacker interacting with my with my

00:15:13,649 --> 00:15:17,369
session I called the hostname member i

00:15:15,419 --> 00:15:19,230
said you could set the host name is

00:15:17,369 --> 00:15:20,819
called it SSL web server so they're

00:15:19,230 --> 00:15:22,889
clearing the history file right to hide

00:15:20,819 --> 00:15:25,049
their their tracks and then they start

00:15:22,889 --> 00:15:26,879
looking to see exactly what kind of

00:15:25,049 --> 00:15:27,809
system they're interacting with now

00:15:26,879 --> 00:15:29,899
they're going to set the root password

00:15:27,809 --> 00:15:33,619
they're gonna change the password to

00:15:29,899 --> 00:15:36,209
something they they know obviously I

00:15:33,619 --> 00:15:38,389
don't know I don't know but I'll get to

00:15:36,209 --> 00:15:40,739
that Pat the password stuff in a second

00:15:38,389 --> 00:15:42,660
so you know they take a look to see and

00:15:40,739 --> 00:15:45,589
kippo fakes all of this right this is

00:15:42,660 --> 00:15:47,970
all this is all this is all fake stuff

00:15:45,589 --> 00:15:50,220
so they're going to download their their

00:15:47,970 --> 00:15:53,279
tools right which is what they're doing

00:15:50,220 --> 00:15:58,169
with the W get there so they download

00:15:53,279 --> 00:16:00,269
the tool yeah yeah so as you see there

00:15:58,169 --> 00:16:02,309
typos right there making mistakes I mean

00:16:00,269 --> 00:16:04,169
you can tell this is a person right this

00:16:02,309 --> 00:16:08,160
is not an automated script this is a

00:16:04,169 --> 00:16:11,009
person sitting there so now is when Kip

00:16:08,160 --> 00:16:13,110
Oh will will show its some of its

00:16:11,009 --> 00:16:15,389
weaknesses right because it's not really

00:16:13,110 --> 00:16:18,829
the OS so they're trying to run their

00:16:15,389 --> 00:16:18,829
tools and their tools are exploding

00:16:20,019 --> 00:16:27,379
so so they're running through this and

00:16:26,120 --> 00:16:28,790
now they're going to start looking to

00:16:27,379 --> 00:16:30,259
see because you know obviously this

00:16:28,790 --> 00:16:37,759
created a little confusion because why

00:16:30,259 --> 00:16:39,050
isn't this tool working oh yeah exactly

00:16:37,759 --> 00:16:40,790
that's what I said that's the thing i

00:16:39,050 --> 00:16:47,500
love about this is you can actually it's

00:16:40,790 --> 00:16:47,500
clearly a person and and my favorite

00:16:47,560 --> 00:16:54,290
this is this is old this is probably two

00:16:50,269 --> 00:16:55,430
years old now so look they're going to

00:16:54,290 --> 00:16:57,350
check that you know to see because

00:16:55,430 --> 00:16:59,089
they're they're confused what what you

00:16:57,350 --> 00:17:03,500
know what kernel is this running who's

00:16:59,089 --> 00:17:06,230
logged in so then this is the awesome

00:17:03,500 --> 00:17:08,959
thing about Kip oh so they type exit but

00:17:06,230 --> 00:17:12,470
kippo won't actually let them out right

00:17:08,959 --> 00:17:14,030
so so it says localhost and now and now

00:17:12,470 --> 00:17:17,299
we start getting confused right he's run

00:17:14,030 --> 00:17:20,270
an nmap and i think he exits again he's

00:17:17,299 --> 00:17:22,130
like okay what's going on here so all

00:17:20,270 --> 00:17:26,990
his commands from his previous session

00:17:22,130 --> 00:17:31,340
are still in the history right right it

00:17:26,990 --> 00:17:32,600
absolutely should be so I believe so now

00:17:31,340 --> 00:17:35,659
he's checking his interfaces right

00:17:32,600 --> 00:17:37,159
because he's like where am I so he exits

00:17:35,659 --> 00:17:40,000
again and he gets dropped back to the

00:17:37,159 --> 00:17:40,000
kippo prompt again

00:17:47,450 --> 00:17:53,610
so he exits again right he's a knee back

00:17:50,820 --> 00:17:54,960
to the kippo prompt again so like I said

00:17:53,610 --> 00:18:04,500
as I imagine this was incredibly

00:17:54,960 --> 00:18:06,180
confusing to this this individual okay

00:18:04,500 --> 00:18:07,740
so that's it so that's so he gets smart

00:18:06,180 --> 00:18:17,250
at that point and finally actually

00:18:07,740 --> 00:18:19,230
disconnects so so despite that last

00:18:17,250 --> 00:18:22,620
display here's what I learned from my

00:18:19,230 --> 00:18:26,280
kippo is and I say they're smarter than

00:18:22,620 --> 00:18:28,590
I thought because there were a bunch of

00:18:26,280 --> 00:18:31,230
people who clearly were doing this who

00:18:28,590 --> 00:18:33,120
knew how to identify a kippah host right

00:18:31,230 --> 00:18:35,190
there were limits to what kippo can do

00:18:33,120 --> 00:18:37,710
and there were places they looked so for

00:18:35,190 --> 00:18:39,810
example by default hippos etsy password

00:18:37,710 --> 00:18:41,490
is empty so some of them would go

00:18:39,810 --> 00:18:43,290
immediately in cat etsy password and

00:18:41,490 --> 00:18:46,230
then they disappear they knew they'd hit

00:18:43,290 --> 00:18:48,060
a honey pot right so so they were

00:18:46,230 --> 00:18:51,030
smarter than I thought they had they had

00:18:48,060 --> 00:18:52,590
learned ways to identify a honeypot so

00:18:51,030 --> 00:18:55,110
what that meant was I had to keep

00:18:52,590 --> 00:18:57,600
tweaking so for example because you can

00:18:55,110 --> 00:19:00,120
add stuff to Kip OHS file system so I

00:18:57,600 --> 00:19:01,590
took a real etsy password from one of my

00:19:00,120 --> 00:19:03,270
machines and copied it in there so now I

00:19:01,590 --> 00:19:05,400
knew that hurdle but there were other

00:19:03,270 --> 00:19:07,110
things that they were checking that like

00:19:05,400 --> 00:19:09,600
I said they they realized that this was

00:19:07,110 --> 00:19:12,420
that this was a honey pot and I said

00:19:09,600 --> 00:19:14,190
they are Chinese because a vast majority

00:19:12,420 --> 00:19:17,520
of the IPS that I was collecting were

00:19:14,190 --> 00:19:19,110
coming from China and actually at the

00:19:17,520 --> 00:19:21,450
time I'm like that's kind of boring

00:19:19,110 --> 00:19:22,830
because that's what I expected right

00:19:21,450 --> 00:19:25,110
like I don't I don't know why I expected

00:19:22,830 --> 00:19:28,140
the the kippah hosts that I were running

00:19:25,110 --> 00:19:31,530
these on I was using to VP esas that

00:19:28,140 --> 00:19:34,770
were actually not the VPS provider

00:19:31,530 --> 00:19:37,800
that's here but I was using to VPS

00:19:34,770 --> 00:19:41,160
providers and hosting these out there so

00:19:37,800 --> 00:19:44,280
they were both us IPS and they were in

00:19:41,160 --> 00:19:45,480
different parts of the country and like

00:19:44,280 --> 00:19:47,430
i said i was just kind of disappointed

00:19:45,480 --> 00:19:48,840
because I was like oh well they're there

00:19:47,430 --> 00:19:50,760
that's that's exactly what I expected

00:19:48,840 --> 00:19:52,960
like this is kind of this is kind of

00:19:50,760 --> 00:19:55,990
boring

00:19:52,960 --> 00:19:58,990
so after doing all this I said okay well

00:19:55,990 --> 00:20:01,630
there's a problem in that I can't really

00:19:58,990 --> 00:20:04,419
see what they want to do once they

00:20:01,630 --> 00:20:07,000
compromise this host right because they

00:20:04,419 --> 00:20:08,770
compromise it and they can't run their

00:20:07,000 --> 00:20:10,600
tools because their tools don't actually

00:20:08,770 --> 00:20:12,940
work because it's a mimicked it's a fake

00:20:10,600 --> 00:20:15,309
doe s right so I want to see what

00:20:12,940 --> 00:20:17,529
they're gonna do if they were allowed to

00:20:15,309 --> 00:20:21,270
fully compromise a host right that's the

00:20:17,529 --> 00:20:21,270
next that's the next place I want to go

00:20:21,360 --> 00:20:25,630
so I'll put this disclaimer out here I

00:20:24,010 --> 00:20:27,490
have a very good friend who lives up in

00:20:25,630 --> 00:20:29,200
Pittsburgh who's an attorney who after

00:20:27,490 --> 00:20:30,970
he saw this was like you need to tell

00:20:29,200 --> 00:20:33,880
people not to do this this is a very bad

00:20:30,970 --> 00:20:36,970
idea so i'll put the disclaimer out

00:20:33,880 --> 00:20:39,190
there the stuff that i did ended up in

00:20:36,970 --> 00:20:41,830
with my box getting compromised and my

00:20:39,190 --> 00:20:45,970
box being used despite my best efforts

00:20:41,830 --> 00:20:49,210
in real attacks I did my best to limit

00:20:45,970 --> 00:20:50,919
that possibility but as you'll see my

00:20:49,210 --> 00:20:52,809
box was actually used in a real attack

00:20:50,919 --> 00:20:55,120
and had that been tracked back it would

00:20:52,809 --> 00:20:57,730
have come back to my IP and I would have

00:20:55,120 --> 00:21:00,700
I would have had some splainin to do so

00:20:57,730 --> 00:21:04,899
so you know doing this could end you up

00:21:00,700 --> 00:21:09,399
with a pair of these it could which in

00:21:04,899 --> 00:21:11,380
turn might end up with some of that but

00:21:09,399 --> 00:21:13,179
more than likely you're going to end up

00:21:11,380 --> 00:21:15,789
with that because you violated your

00:21:13,179 --> 00:21:17,950
isp's terms of service because I was

00:21:15,789 --> 00:21:20,590
running this at my house and so you're

00:21:17,950 --> 00:21:22,899
going to end up with no internet so

00:21:20,590 --> 00:21:25,510
that's my disclaimer you know do do with

00:21:22,899 --> 00:21:28,120
this information what you will so this

00:21:25,510 --> 00:21:31,090
is the way I set up my home network what

00:21:28,120 --> 00:21:34,390
I did was I you know this this right

00:21:31,090 --> 00:21:37,390
here is my external firewall and then

00:21:34,390 --> 00:21:40,480
over here this is actually a single ESX

00:21:37,390 --> 00:21:43,570
host vmware ESX host and it is hosting a

00:21:40,480 --> 00:21:46,510
pfsense box linux box with a horrible

00:21:43,570 --> 00:21:47,770
password snort and a client machine and

00:21:46,510 --> 00:21:50,500
i'll explain the client machine in a

00:21:47,770 --> 00:21:53,710
moment and then over here was my home

00:21:50,500 --> 00:21:55,510
network or where I keep my porn and that

00:21:53,710 --> 00:21:59,649
needed to be safe from the attackers

00:21:55,510 --> 00:22:01,090
right that was that was key so the Linux

00:21:59,649 --> 00:22:02,639
box with a horrible password had the

00:22:01,090 --> 00:22:03,870
password of one two three four five six

00:22:02,639 --> 00:22:08,289
again

00:22:03,870 --> 00:22:11,710
and it was done using non persistent

00:22:08,289 --> 00:22:13,809
disk in VMware so that allowed me to

00:22:11,710 --> 00:22:15,549
reboot the box and wipe out anything the

00:22:13,809 --> 00:22:18,220
attackers had done so i could basically

00:22:15,549 --> 00:22:21,010
kick them out and and start over from

00:22:18,220 --> 00:22:23,559
scratch but what that also meant was

00:22:21,010 --> 00:22:25,630
that if that box rebooted I lost any

00:22:23,559 --> 00:22:27,190
evidence that i had collected right

00:22:25,630 --> 00:22:31,450
because it was reset back to where it

00:22:27,190 --> 00:22:33,789
was so this Linux box was set up here

00:22:31,450 --> 00:22:36,010
with two interfaces so I would power

00:22:33,789 --> 00:22:38,620
that box on when I needed to move data

00:22:36,010 --> 00:22:40,780
out of that linux that the horrible

00:22:38,620 --> 00:22:43,059
linux box the horrible password linux

00:22:40,780 --> 00:22:44,950
box so that's what that client was for i

00:22:43,059 --> 00:22:48,250
had snort out there watching stuff

00:22:44,950 --> 00:22:51,190
honestly I didn't end up using it much

00:22:48,250 --> 00:22:52,690
because pfsense has a neat little

00:22:51,190 --> 00:22:55,030
feature where it can do full packet

00:22:52,690 --> 00:22:57,820
captures all the time so I just turned

00:22:55,030 --> 00:22:59,140
that on and relied on my own ability to

00:22:57,820 --> 00:23:02,980
go through the packet captures and take

00:22:59,140 --> 00:23:05,559
a look at what was going on so that was

00:23:02,980 --> 00:23:09,460
my setup that's what I did I then opened

00:23:05,559 --> 00:23:11,230
SSH on my you know my consumer it was a

00:23:09,460 --> 00:23:16,330
verizon internet connection at the time

00:23:11,230 --> 00:23:19,210
and said okay how about it guys so the

00:23:16,330 --> 00:23:22,720
way i configure my honey pot was I used

00:23:19,210 --> 00:23:25,480
sudo sh which is a shell that allows

00:23:22,720 --> 00:23:27,159
that VCR like playback that we got out

00:23:25,480 --> 00:23:29,440
of Kip oh I really didn't want to lose

00:23:27,159 --> 00:23:31,030
that because that's a really cool thing

00:23:29,440 --> 00:23:32,830
to watch what they're actually doing I

00:23:31,030 --> 00:23:36,039
really wanted to be able to see what

00:23:32,830 --> 00:23:37,929
keystrokes they were entering now sudo

00:23:36,039 --> 00:23:40,570
sh when you look at what shell is set

00:23:37,929 --> 00:23:43,570
for the user shows up as pseudo sh so I

00:23:40,570 --> 00:23:47,020
said okay well I'm gonna hide this so I

00:23:43,570 --> 00:23:50,590
called it ksh even though it was clearly

00:23:47,020 --> 00:23:52,270
bash and they and that that was fine

00:23:50,590 --> 00:23:54,909
again I wasn't doing a lot of effort to

00:23:52,270 --> 00:23:56,320
really mask what I was doing I said I

00:23:54,909 --> 00:23:59,530
didn't try to be very I didn't try very

00:23:56,320 --> 00:24:02,020
hard to be secretive I also hacked the

00:23:59,530 --> 00:24:05,320
ssh binary that was installed on there

00:24:02,020 --> 00:24:07,059
because one of the other things kippo

00:24:05,320 --> 00:24:08,409
again I'm kind of trying to mimic kippo

00:24:07,059 --> 00:24:11,049
on a live system one of the other things

00:24:08,409 --> 00:24:15,190
kippo does is it provides you with a

00:24:11,049 --> 00:24:16,600
list of all of the IPS the username and

00:24:15,190 --> 00:24:17,140
passwords that we're attempted in the

00:24:16,600 --> 00:24:20,170
brute force

00:24:17,140 --> 00:24:21,160
I still wanted to collect that SSH would

00:24:20,170 --> 00:24:24,820
hide that because it would have been

00:24:21,160 --> 00:24:27,790
encrypted so I am NOT a sea programmer

00:24:24,820 --> 00:24:30,670
so I'll put that out there I hacked this

00:24:27,790 --> 00:24:33,430
the the auth password sea and made it

00:24:30,670 --> 00:24:35,740
right a log file I'm sure there's more

00:24:33,430 --> 00:24:37,620
elegant ways to do this I'm sure there's

00:24:35,740 --> 00:24:41,110
just downright better ways to do it

00:24:37,620 --> 00:24:43,990
forget elegance just better but it's out

00:24:41,110 --> 00:24:46,150
there so if you like it feel free I just

00:24:43,990 --> 00:24:48,220
packed it up we compiled it and put it

00:24:46,150 --> 00:24:50,320
out there and it writes all of the

00:24:48,220 --> 00:24:53,020
username and passwords to a clear text

00:24:50,320 --> 00:24:55,570
file so obviously don't use this on a

00:24:53,020 --> 00:24:57,930
production machine because it will write

00:24:55,570 --> 00:25:00,460
your username and password in clear text

00:24:57,930 --> 00:25:02,980
so it's out there help yourselves and

00:25:00,460 --> 00:25:04,210
again you know improve it because I'm

00:25:02,980 --> 00:25:06,850
sure there's improvements that could be

00:25:04,210 --> 00:25:08,530
made but that's that's a little bit of

00:25:06,850 --> 00:25:13,000
code I changed it really wasn't a hard

00:25:08,530 --> 00:25:14,530
heart hack to get it in so these are the

00:25:13,000 --> 00:25:16,450
logs that I started to collect on this

00:25:14,530 --> 00:25:18,130
machine so again as you can see this is

00:25:16,450 --> 00:25:21,640
what the log looks like it just gets its

00:25:18,130 --> 00:25:25,540
time password or username password and

00:25:21,640 --> 00:25:28,750
an originating IP so nothing nothing

00:25:25,540 --> 00:25:31,990
spectacular so I set it up and I waited

00:25:28,750 --> 00:25:35,050
and of course the box gets owned over

00:25:31,990 --> 00:25:37,240
and over and over again I'm pulling

00:25:35,050 --> 00:25:40,030
stuff off and one of the interesting

00:25:37,240 --> 00:25:42,460
things that that I saw and again I saw

00:25:40,030 --> 00:25:45,670
this in kippo as well one of the things

00:25:42,460 --> 00:25:48,970
they do is they download windows service

00:25:45,670 --> 00:25:52,000
packs my guess is that they are using

00:25:48,970 --> 00:25:53,290
that as a benchmark for speed that

00:25:52,000 --> 00:25:54,880
they're trying to see what kind of

00:25:53,290 --> 00:25:55,900
connection they're sitting on that's the

00:25:54,880 --> 00:25:58,030
only thing I can come up with because

00:25:55,900 --> 00:25:59,830
they clearly know they're on linux boxes

00:25:58,030 --> 00:26:01,990
and they're downloading windows service

00:25:59,830 --> 00:26:03,820
packs my guess is it's a big file they

00:26:01,990 --> 00:26:05,080
know Microsoft has a big pipe so they

00:26:03,820 --> 00:26:08,580
just want to get an idea of what kind of

00:26:05,080 --> 00:26:12,240
bandwidth they're they're up against or

00:26:08,580 --> 00:26:14,380
it's the script other than I mean it

00:26:12,240 --> 00:26:16,770
will get into that will get it ya know

00:26:14,380 --> 00:26:19,240
we'll get into that so as I said

00:26:16,770 --> 00:26:22,150
obviously the box gets owned over and

00:26:19,240 --> 00:26:24,790
over and over again it was almost always

00:26:22,150 --> 00:26:26,830
the same malware and there was usually a

00:26:24,790 --> 00:26:27,880
IRC command and control and that might

00:26:26,830 --> 00:26:31,059
be on another slide I might be getting

00:26:27,880 --> 00:26:33,279
ahead of myself there was an IRC command

00:26:31,059 --> 00:26:39,970
roll it was usually a denial of service

00:26:33,279 --> 00:26:41,950
tool there was a another an ssh brute

00:26:39,970 --> 00:26:43,690
force scanning tool and password

00:26:41,950 --> 00:26:45,730
username and password lists was almost

00:26:43,690 --> 00:26:48,580
always the same thing that appeared on

00:26:45,730 --> 00:26:52,120
there and they were almost always hidden

00:26:48,580 --> 00:26:54,249
in the same places so they didn't vary a

00:26:52,120 --> 00:26:57,429
lot in where they and where they hid

00:26:54,249 --> 00:26:59,049
these files but this time I had a little

00:26:57,429 --> 00:27:02,649
more than I had with the capo box

00:26:59,049 --> 00:27:03,909
because now I had packet captures so I

00:27:02,649 --> 00:27:09,220
could see everything they were doing

00:27:03,909 --> 00:27:14,200
inbound and outbound and how much time

00:27:09,220 --> 00:27:17,649
do I have Mike I'm right at 30 minutes

00:27:14,200 --> 00:27:21,070
okay so let's whoops so let's go ahead

00:27:17,649 --> 00:27:26,649
and so this is just to give you an idea

00:27:21,070 --> 00:27:27,879
I have a pseudo SH capture here and

00:27:26,649 --> 00:27:30,330
basically you're going to see the same

00:27:27,879 --> 00:27:30,330
thing

00:27:50,840 --> 00:27:54,620
okay so i called the box phoenix because

00:27:53,150 --> 00:27:58,640
of course it burns in the fire and then

00:27:54,620 --> 00:28:00,350
reemerges but basically like i said

00:27:58,640 --> 00:28:02,150
you'll see that they it's pretty much

00:28:00,350 --> 00:28:03,680
the same stuff you know he's going

00:28:02,150 --> 00:28:05,000
through his tools i have this sped up a

00:28:03,680 --> 00:28:07,400
little so if it looks like he's typing

00:28:05,000 --> 00:28:12,350
real fast i have it at double speed just

00:28:07,400 --> 00:28:14,090
so we get through it quicker so again

00:28:12,350 --> 00:28:16,280
this is a live host this is actual you

00:28:14,090 --> 00:28:19,180
know he has he has root access to this

00:28:16,280 --> 00:28:19,180
box at this point

00:28:25,220 --> 00:28:35,030
so again downloading tools the couple

00:28:32,510 --> 00:28:38,059
rules I put in on my pfsense box while

00:28:35,030 --> 00:28:39,590
this is running my suspicion was and

00:28:38,059 --> 00:28:41,539
again because I couldn't actually see

00:28:39,590 --> 00:28:43,010
what they were doing with Kip oh my

00:28:41,539 --> 00:28:46,789
suspicion was that they were using these

00:28:43,010 --> 00:28:50,539
boxes to send out spam so I blocked 25

00:28:46,789 --> 00:28:54,409
outbound and I also blocked SSH well I

00:28:50,539 --> 00:28:56,510
black hold SSH so that they scanned and

00:28:54,409 --> 00:28:58,460
just got no responses and they did scan

00:28:56,510 --> 00:29:00,559
from my box they would use my box as a

00:28:58,460 --> 00:29:05,900
pivot point to try to scan to compromise

00:29:00,559 --> 00:29:07,070
other hosts so as you can see like I

00:29:05,900 --> 00:29:10,390
said you get the idea of what you get

00:29:07,070 --> 00:29:13,929
with sudo SH this is not a particularly

00:29:10,390 --> 00:29:16,610
you know there's no humor in this one

00:29:13,929 --> 00:29:18,080
let's put it that way so we'll get out

00:29:16,610 --> 00:29:20,690
of that but you get the idea sudo SH

00:29:18,080 --> 00:29:22,789
gets you the same kind of playback which

00:29:20,690 --> 00:29:25,010
I think might be useful ultimately if

00:29:22,789 --> 00:29:27,679
you have audit requirements that require

00:29:25,010 --> 00:29:29,240
you to see what's going on in a command

00:29:27,679 --> 00:29:31,880
line so I think it might have uses

00:29:29,240 --> 00:29:37,880
outside of just watching what the bad

00:29:31,880 --> 00:29:39,970
guys are doing so like I said these are

00:29:37,880 --> 00:29:43,010
the tools that showed up all the time

00:29:39,970 --> 00:29:46,580
you had IRC mec bot which was for

00:29:43,010 --> 00:29:48,380
command and control the PS scan or some

00:29:46,580 --> 00:29:51,110
variant of it which was for ssh

00:29:48,380 --> 00:29:54,169
brute-forcing different denial of

00:29:51,110 --> 00:29:56,960
services tools lots of them in Perl and

00:29:54,169 --> 00:29:58,520
a user and password list now what was

00:29:56,960 --> 00:30:00,350
interesting about the user and password

00:29:58,520 --> 00:30:04,159
list is they all dropped username and

00:30:00,350 --> 00:30:05,659
password lists and I grabbed the largest

00:30:04,159 --> 00:30:07,520
of them like i said i was pulling data

00:30:05,659 --> 00:30:08,870
off of that machine rather regularly and

00:30:07,520 --> 00:30:12,610
then rebooting it and starting it over

00:30:08,870 --> 00:30:16,390
again and i grabbed the largest of the

00:30:12,610 --> 00:30:18,350
of the password list and it was like

00:30:16,390 --> 00:30:20,539
230,000 passwords if i remember

00:30:18,350 --> 00:30:22,190
correctly and then I unique tit and

00:30:20,539 --> 00:30:24,080
there was only like a hundred and thirty

00:30:22,190 --> 00:30:26,659
thousand unique passwords so they were

00:30:24,080 --> 00:30:29,600
doing all kinds of redundant work which

00:30:26,659 --> 00:30:32,720
got me real interested in very curious

00:30:29,600 --> 00:30:34,669
about kind of the skill level of these

00:30:32,720 --> 00:30:36,740
individuals like it seemed it seem kind

00:30:34,669 --> 00:30:38,630
of odd to me that that's what was going

00:30:36,740 --> 00:30:42,560
on but

00:30:38,630 --> 00:30:44,900
I did have these packet captures now so

00:30:42,560 --> 00:30:47,090
you probably can't see that this is them

00:30:44,900 --> 00:30:49,210
attempting to ssh brute force something

00:30:47,090 --> 00:30:52,970
so I mean they're just blasting away at

00:30:49,210 --> 00:30:55,490
SSH again my firewall is you see just

00:30:52,970 --> 00:30:56,900
sins because my firewall is pfsense box

00:30:55,490 --> 00:31:00,560
is just tossing it away it's just

00:30:56,900 --> 00:31:03,710
ignoring it not responding the other

00:31:00,560 --> 00:31:06,500
thing you have here this is so this was

00:31:03,710 --> 00:31:09,620
actually my box being used in a denial

00:31:06,500 --> 00:31:11,360
of service attack I had blocked outbound

00:31:09,620 --> 00:31:14,360
ports that I thought they would use

00:31:11,360 --> 00:31:16,640
right the obvious stuff this was when I

00:31:14,360 --> 00:31:18,770
had thought of and so they were

00:31:16,640 --> 00:31:21,380
attacking somebody they were doing a UDP

00:31:18,770 --> 00:31:23,600
denial of service which was successful

00:31:21,380 --> 00:31:28,820
because I didn't block that so that that

00:31:23,600 --> 00:31:32,120
went out and i participated but then the

00:31:28,820 --> 00:31:36,770
other thing was I said they had dropped

00:31:32,120 --> 00:31:38,150
IRC command and control so I had I RC

00:31:36,770 --> 00:31:40,220
being in clear text they weren't using

00:31:38,150 --> 00:31:43,760
SSL so everything was in clear text so I

00:31:40,220 --> 00:31:47,030
could actually see what was going on so

00:31:43,760 --> 00:31:49,460
this is them connecting to their their

00:31:47,030 --> 00:31:52,190
owned box connecting back to IRC for a

00:31:49,460 --> 00:31:55,340
command and control and I apologize that

00:31:52,190 --> 00:31:58,370
that's that's so small so when I looked

00:31:55,340 --> 00:31:59,570
at the when I was going through all the

00:31:58,370 --> 00:32:01,940
packet captures and I was kind of

00:31:59,570 --> 00:32:04,880
looking at what the packet capture

00:32:01,940 --> 00:32:07,430
contained and looked at the IRC stuff

00:32:04,880 --> 00:32:09,770
you can't I am I apologize that's so

00:32:07,430 --> 00:32:12,080
small one of the channels they joined

00:32:09,770 --> 00:32:16,130
was i'm going to call i'm gonna say it's

00:32:12,080 --> 00:32:18,500
peccole OPIC oll oh and that's

00:32:16,130 --> 00:32:20,810
significant because i started thinking

00:32:18,500 --> 00:32:23,870
well i'm going to join this IRC channel

00:32:20,810 --> 00:32:27,500
and see what what the deal is right like

00:32:23,870 --> 00:32:30,880
what's going on here so i put pocholo

00:32:27,500 --> 00:32:32,840
into google and google said do you mean

00:32:30,880 --> 00:32:34,550
piccola which apparently is a dragon

00:32:32,840 --> 00:32:38,600
ball z character nothing i'm familiar

00:32:34,550 --> 00:32:41,480
with but I said ok so there's my cover

00:32:38,600 --> 00:32:43,220
again it's a silly stupid cover but I'm

00:32:41,480 --> 00:32:45,410
going to go in and I'm going to create a

00:32:43,220 --> 00:32:49,130
fake identity for myself and I'm going

00:32:45,410 --> 00:32:51,230
to say that I am a 16 year old kid

00:32:49,130 --> 00:32:52,280
although clearly not 16 but I'm a 16

00:32:51,230 --> 00:32:54,200
year old kid

00:32:52,280 --> 00:32:56,300
and I'm really interested in Dragon Ball

00:32:54,200 --> 00:32:59,390
Z and I'm going to join the channel and

00:32:56,300 --> 00:33:03,260
see and see how it goes so I did I

00:32:59,390 --> 00:33:05,720
joined the channel and this is what i

00:33:03,260 --> 00:33:07,070
was first greeted with so as I joined

00:33:05,720 --> 00:33:08,660
the channel there was no password on it

00:33:07,070 --> 00:33:10,880
there was nothing protecting it I just

00:33:08,660 --> 00:33:15,650
joined and I see all these names and

00:33:10,880 --> 00:33:18,770
then I see someone saying say a and then

00:33:15,650 --> 00:33:20,770
all the bots are spawned a now one of

00:33:18,770 --> 00:33:25,340
the things I will tell you is i

00:33:20,770 --> 00:33:27,710
sanitized all of this so that those are

00:33:25,340 --> 00:33:30,040
not real IRC names and I will explain

00:33:27,710 --> 00:33:32,420
that as we get to the end why I did that

00:33:30,040 --> 00:33:36,650
so those are not those are not real

00:33:32,420 --> 00:33:38,900
names so say a so one of the first

00:33:36,650 --> 00:33:42,410
things I did was I said we'll say a

00:33:38,900 --> 00:33:44,690
right when he said say a and then I said

00:33:42,410 --> 00:33:48,670
well why isn't it doing what I want it

00:33:44,690 --> 00:33:51,290
to do and let me see which slides next

00:33:48,670 --> 00:33:52,850
okay so actually here it is so I said

00:33:51,290 --> 00:33:54,590
okay I'm gonna I'm gonna become friends

00:33:52,850 --> 00:33:56,330
with these guys right like I'm gonna see

00:33:54,590 --> 00:34:00,500
if I can get them to start talking to me

00:33:56,330 --> 00:34:03,080
so I said as you can see there so my

00:34:00,500 --> 00:34:06,050
name that I came in was fava bean which

00:34:03,080 --> 00:34:07,730
again my handles canna beans so it

00:34:06,050 --> 00:34:09,470
wasn't very far from actually who I

00:34:07,730 --> 00:34:12,409
wasn't doing a lot to really protect my

00:34:09,470 --> 00:34:17,419
to protect who I was so I came in his

00:34:12,409 --> 00:34:20,419
fava bean and he says fava bean and I

00:34:17,419 --> 00:34:21,830
said say a and he says a right the bots

00:34:20,419 --> 00:34:24,950
don't respond because they're not

00:34:21,830 --> 00:34:26,480
supposed to respond to me and I said how

00:34:24,950 --> 00:34:27,950
come it doesn't work for me and then I

00:34:26,480 --> 00:34:30,470
start with my whole dragon ball z thing

00:34:27,950 --> 00:34:33,350
I'm a big fan of Dragon Ball Z and he

00:34:30,470 --> 00:34:36,409
asked me how old I am and I said 16 how

00:34:33,350 --> 00:34:38,090
old are you 24 and I said oh you're not

00:34:36,409 --> 00:34:41,060
too old for Dragon Ball Z and he said

00:34:38,090 --> 00:34:43,700
well I've seen cartoons once and I said

00:34:41,060 --> 00:34:46,340
once and I said I thought this was a

00:34:43,700 --> 00:34:47,960
dragon ball z channel and he said

00:34:46,340 --> 00:34:51,380
evenings we've seen and I said are you

00:34:47,960 --> 00:34:52,730
in Japan or us and he said Europa and I

00:34:51,380 --> 00:34:54,200
was like well this is not what I

00:34:52,730 --> 00:34:55,850
expected right like I thought I was

00:34:54,200 --> 00:34:57,230
dealing I was honestly expecting to see

00:34:55,850 --> 00:35:00,740
a lot of chinese language flying back

00:34:57,230 --> 00:35:03,869
and forth well i hung out in the channel

00:35:00,740 --> 00:35:06,269
a lot and what I watched was

00:35:03,869 --> 00:35:08,700
a language going back and forth that I

00:35:06,269 --> 00:35:11,630
didn't recognize and I started copying

00:35:08,700 --> 00:35:16,200
and pasting it into google translate and

00:35:11,630 --> 00:35:20,640
all of it was what I discovered was our

00:35:16,200 --> 00:35:22,289
PT or Romanian persistent threat all of

00:35:20,640 --> 00:35:24,509
the language that was being spoken was

00:35:22,289 --> 00:35:30,960
Romanian which was clear which was not

00:35:24,509 --> 00:35:32,519
at all what I expected and so it was it

00:35:30,960 --> 00:35:33,839
was a daunting task because i don't

00:35:32,519 --> 00:35:36,690
speak Romanian so I'm sitting there

00:35:33,839 --> 00:35:38,190
trying to copy and paste in out of IRC

00:35:36,690 --> 00:35:41,759
to at least get an idea of what they're

00:35:38,190 --> 00:35:43,589
talking about in you know into google

00:35:41,759 --> 00:35:45,630
translate well unfortunately and I

00:35:43,589 --> 00:35:48,299
assume it would be the same going from

00:35:45,630 --> 00:35:49,950
English to if you took an English IRC

00:35:48,299 --> 00:35:51,539
channel there was a ton of slang being

00:35:49,950 --> 00:35:53,999
thrown around which Google had no idea

00:35:51,539 --> 00:35:55,529
what to do with so so there was a lot of

00:35:53,999 --> 00:36:00,769
stuff that was being said that I didn't

00:35:55,529 --> 00:36:04,619
understand so once I realized that I

00:36:00,769 --> 00:36:06,359
started asking lots of questions because

00:36:04,619 --> 00:36:08,249
some of them started some of them would

00:36:06,359 --> 00:36:11,369
talk to me now clearly some of them were

00:36:08,249 --> 00:36:13,200
saying don't talk to him right I mean I

00:36:11,369 --> 00:36:14,489
caught some of that in Romanian it was

00:36:13,200 --> 00:36:19,410
we don't know who this is don't talk to

00:36:14,489 --> 00:36:21,660
him so you know I started asking you

00:36:19,410 --> 00:36:23,339
know what's what's at you see as I

00:36:21,660 --> 00:36:25,920
joined the channel the first thing it's

00:36:23,339 --> 00:36:27,539
say a and I say a right and then because

00:36:25,920 --> 00:36:29,819
he thinks i'ma bought at this point and

00:36:27,539 --> 00:36:31,829
then he you know he tries to get me to

00:36:29,819 --> 00:36:33,239
change my neck and I say Nick and then I

00:36:31,829 --> 00:36:35,069
said why are you saying these things and

00:36:33,239 --> 00:36:38,309
it's that point he realizes that I'm a

00:36:35,069 --> 00:36:39,569
real person right and I said you know

00:36:38,309 --> 00:36:41,369
why are you guys doing with all this say

00:36:39,569 --> 00:36:43,529
a stuff I see you do it all the time and

00:36:41,369 --> 00:36:46,920
then I asked so this was the command

00:36:43,529 --> 00:36:48,630
that they issue the bang SSH that's the

00:36:46,920 --> 00:36:50,099
command that they were issuing to their

00:36:48,630 --> 00:36:52,499
to ping their bought to see if it was

00:36:50,099 --> 00:36:56,430
alive and you know I said what does it

00:36:52,499 --> 00:36:59,700
do and he said it pings la server and I

00:36:56,430 --> 00:37:02,999
said why are there so many servers being

00:36:59,700 --> 00:37:05,430
pinged and he says excuse me and

00:37:02,999 --> 00:37:08,099
disappears like I don't know if I if he

00:37:05,430 --> 00:37:12,269
got nervous but he just he never talked

00:37:08,099 --> 00:37:14,400
to me again he was done with me so I

00:37:12,269 --> 00:37:16,470
quickly dropped the dragon ball z thing

00:37:14,400 --> 00:37:17,869
because obviously they had no idea what

00:37:16,470 --> 00:37:20,400
I was talking about

00:37:17,869 --> 00:37:22,680
so I asked them where they're from and

00:37:20,400 --> 00:37:25,980
he said I one of the other one said I'm

00:37:22,680 --> 00:37:28,170
Romanian and so then I was like okay now

00:37:25,980 --> 00:37:29,810
I'm going to appeal to a sense of

00:37:28,170 --> 00:37:34,800
nationalism I'm going to give that a try

00:37:29,810 --> 00:37:36,600
so I started talking a lot about Romania

00:37:34,800 --> 00:37:40,080
and asking lots of questions and I'm

00:37:36,600 --> 00:37:41,520
really interested in in Romania and so

00:37:40,080 --> 00:37:43,560
I'm you know I said I'm reading

00:37:41,520 --> 00:37:45,840
Wikipedia on it now and he says good and

00:37:43,560 --> 00:37:47,850
that actually worked like that got they

00:37:45,840 --> 00:37:52,350
were interested that I was interested in

00:37:47,850 --> 00:37:55,740
in Romania and then it got very

00:37:52,350 --> 00:37:58,410
interesting because when I said I said

00:37:55,740 --> 00:38:00,150
how old are you he said 23 and I said do

00:37:58,410 --> 00:38:02,070
you work or go to school and he said I'm

00:38:00,150 --> 00:38:04,080
stealing in other countries I mean he

00:38:02,070 --> 00:38:07,230
just came right out and said I'm

00:38:04,080 --> 00:38:09,150
stealing in other countries and I said

00:38:07,230 --> 00:38:11,550
what and he said to survive and I said I

00:38:09,150 --> 00:38:13,380
don't understand you know what what are

00:38:11,550 --> 00:38:15,840
you stealing and he said all of it we

00:38:13,380 --> 00:38:18,780
steal all of it how was like okay all

00:38:15,840 --> 00:38:19,890
right well this is interesting now the

00:38:18,780 --> 00:38:21,750
other interesting thing that I

00:38:19,890 --> 00:38:24,330
discovered is there is in fact honor

00:38:21,750 --> 00:38:27,480
amongst thieves I spent a lot of time in

00:38:24,330 --> 00:38:30,000
this channel just lurking chatting as

00:38:27,480 --> 00:38:33,180
much as I could again translating a lot

00:38:30,000 --> 00:38:35,510
of what was going back and forth and so

00:38:33,180 --> 00:38:42,810
i'm going to call this person raluca

00:38:35,510 --> 00:38:44,660
again name changed so raluca became my

00:38:42,810 --> 00:38:50,040
buddy raluca like to talk to me a lot

00:38:44,660 --> 00:38:52,590
and raluca wanted to help seem to want

00:38:50,040 --> 00:38:56,940
to help me out and I think part of it

00:38:52,590 --> 00:39:00,690
was because raluca was close in age to

00:38:56,940 --> 00:39:02,910
the character that I had created now

00:39:00,690 --> 00:39:07,260
what this conversation is between raluca

00:39:02,910 --> 00:39:08,790
and I again I'm after the whole you know

00:39:07,260 --> 00:39:10,020
I want to learn about Romania I started

00:39:08,790 --> 00:39:12,720
that I want to learn what you guys do

00:39:10,020 --> 00:39:14,220
like I want to learn how you how you're

00:39:12,720 --> 00:39:17,369
doing this I'm really curious to know

00:39:14,220 --> 00:39:21,510
what you're doing and so someone on the

00:39:17,369 --> 00:39:23,220
IRC channel said i'll sell you a route

00:39:21,510 --> 00:39:24,540
if you want to buy a route that was that

00:39:23,220 --> 00:39:25,710
was the terminology they used they refer

00:39:24,540 --> 00:39:29,880
to them as routes that's what they were

00:39:25,710 --> 00:39:31,200
selling and i said okay at the time I

00:39:29,880 --> 00:39:32,700
said okay

00:39:31,200 --> 00:39:33,869
do I get the money to you because he

00:39:32,700 --> 00:39:35,730
said he would sell it to me for a dollar

00:39:33,869 --> 00:39:37,230
and I so how do I get the money to you

00:39:35,730 --> 00:39:39,420
and again I'm playing that I'm a

00:39:37,230 --> 00:39:42,270
sixteen-year-old kid and I said I gotta

00:39:39,420 --> 00:39:43,589
get my mom's paypal account and so I

00:39:42,270 --> 00:39:45,089
said hold on i'm gonna get my mom's

00:39:43,589 --> 00:39:46,500
paypal account so i can pay you and then

00:39:45,089 --> 00:39:48,540
I said well do I need Romanian paypal

00:39:46,500 --> 00:39:49,530
like I don't know how this works and as

00:39:48,540 --> 00:39:51,420
soon as I was chatting with this

00:39:49,530 --> 00:39:54,030
individual I got a private message from

00:39:51,420 --> 00:39:56,190
raluca and as you see with Lucas says

00:39:54,030 --> 00:39:58,770
man stay chill don't buy roots like a

00:39:56,190 --> 00:40:00,089
dollar they're not roots and I said I

00:39:58,770 --> 00:40:02,550
don't understand and he said those are

00:40:00,089 --> 00:40:05,760
 you send him money he give you

00:40:02,550 --> 00:40:08,430
nothing and or he gives you root and

00:40:05,760 --> 00:40:10,920
takes it back so I'm like wow this guy's

00:40:08,430 --> 00:40:12,540
talking to me and he's protecting me so

00:40:10,920 --> 00:40:14,849
this is the guy I want to ask questions

00:40:12,540 --> 00:40:17,609
of so I asked him I said well how much

00:40:14,849 --> 00:40:21,480
should a good route cost and he said 10

00:40:17,609 --> 00:40:24,300
to 20 euro which was way more than I

00:40:21,480 --> 00:40:28,320
expected it to be and he said for a good

00:40:24,300 --> 00:40:30,660
route it's you know he said one dollar

00:40:28,320 --> 00:40:35,970
roots are and I said well is that

00:40:30,660 --> 00:40:37,859
US or euro and he said euro so again

00:40:35,970 --> 00:40:40,560
continue the conversation is it really a

00:40:37,859 --> 00:40:44,040
bad idea to use my mom's paypal he tells

00:40:40,560 --> 00:40:46,770
me I need to ask her before I do it okay

00:40:44,040 --> 00:40:49,980
so I mean like I said they're there are

00:40:46,770 --> 00:40:52,560
honor there is honor amongst thieves and

00:40:49,980 --> 00:40:54,569
I said you know i'll tell her i'm buying

00:40:52,560 --> 00:40:57,089
dragon ball z stuff from ebay like that

00:40:54,569 --> 00:40:59,099
was my excuse and so he starts

00:40:57,089 --> 00:41:00,930
explaining to me that he's scanning for

00:40:59,099 --> 00:41:03,150
more roots like he shows me what he's

00:41:00,930 --> 00:41:06,720
doing and he's telling me that he's

00:41:03,150 --> 00:41:10,109
scanning 3,500 IPS and he said from

00:41:06,720 --> 00:41:14,010
those he'll get 10 to 20 roots so I'm

00:41:10,109 --> 00:41:16,829
putting myself in his shoes at 16 if I

00:41:14,010 --> 00:41:18,660
had two hundred bucks coming in and

00:41:16,829 --> 00:41:20,609
that's you know in the u.s. I would

00:41:18,660 --> 00:41:23,160
imagine 200 euro in Romania goes a

00:41:20,609 --> 00:41:27,000
little bit further that's I'd do a lot

00:41:23,160 --> 00:41:30,720
of stupid things with that money so he

00:41:27,000 --> 00:41:32,339
said you know it's a lot of money and he

00:41:30,720 --> 00:41:36,540
said sometimes he gets no money it all

00:41:32,339 --> 00:41:38,369
depends so again we continued this

00:41:36,540 --> 00:41:40,890
conversation he and I talked a lot and

00:41:38,369 --> 00:41:43,349
he actually went as far as to tell me

00:41:40,890 --> 00:41:43,990
where he lived and what street he lived

00:41:43,349 --> 00:41:49,480
on

00:41:43,990 --> 00:41:52,900
um so now we'll get into why I changed

00:41:49,480 --> 00:41:55,780
names um like I said he told me where he

00:41:52,900 --> 00:41:58,090
lived he told me what street he told me

00:41:55,780 --> 00:42:00,070
like he was excited that I was googling

00:41:58,090 --> 00:42:03,190
that I was looking up what street he

00:42:00,070 --> 00:42:10,330
lived on and so there it is that's

00:42:03,190 --> 00:42:13,110
that's where he lives now one of the

00:42:10,330 --> 00:42:17,260
reasons that I changed his the names is

00:42:13,110 --> 00:42:19,420
because the more I got into this the

00:42:17,260 --> 00:42:21,400
more I started realizing that I wasn't

00:42:19,420 --> 00:42:25,150
sure exactly who I was dealing with

00:42:21,400 --> 00:42:27,340
right now my assumption is that this was

00:42:25,150 --> 00:42:30,040
a kid who was just supplementing his

00:42:27,340 --> 00:42:31,570
income but I don't know right i don't

00:42:30,040 --> 00:42:33,970
know he could be doing this under duress

00:42:31,570 --> 00:42:36,520
right i don't i don't know the situation

00:42:33,970 --> 00:42:38,590
and I suddenly started getting concerned

00:42:36,520 --> 00:42:41,710
that is I give this talk somebody

00:42:38,590 --> 00:42:44,710
recognizes those names and you know and

00:42:41,710 --> 00:42:46,180
we have we have trouble on our hands he

00:42:44,710 --> 00:42:47,890
has trouble on his hands I don't because

00:42:46,180 --> 00:42:50,400
I'm far removed from it so that's why I

00:42:47,890 --> 00:42:54,850
went ahead and changed all the names and

00:42:50,400 --> 00:42:58,600
and everything is you know has been

00:42:54,850 --> 00:43:02,770
sanitized so he goes on to explain how

00:42:58,600 --> 00:43:04,480
to do what he's doing right he says you

00:43:02,770 --> 00:43:06,340
know he'd out I asked if I can download

00:43:04,480 --> 00:43:07,900
a tool and he says you have to have root

00:43:06,340 --> 00:43:09,880
if you want to use it it's a scanner and

00:43:07,900 --> 00:43:12,760
he says you scan eye peas and brute

00:43:09,880 --> 00:43:14,440
force and he says it tries 1000 to 2000

00:43:12,760 --> 00:43:18,430
user to password at an IP if it matches

00:43:14,440 --> 00:43:19,960
bingo you got root in 20 bucks and I

00:43:18,430 --> 00:43:24,100
said do you ever get in trouble and he

00:43:19,960 --> 00:43:25,690
says no I'm under 18 and he said if he

00:43:24,100 --> 00:43:28,210
was over 18 he could go to jail for this

00:43:25,690 --> 00:43:30,130
but because he's under 18 his plan was

00:43:28,210 --> 00:43:35,440
to do it until he hit 18 and then he

00:43:30,130 --> 00:43:37,090
would stop so what's funny was I started

00:43:35,440 --> 00:43:38,980
explaining to him I asked him I said

00:43:37,090 --> 00:43:40,450
well because I was surprised that he was

00:43:38,980 --> 00:43:43,000
like I can get off scot-free if I'm

00:43:40,450 --> 00:43:44,590
under 18 and so I said well don't you

00:43:43,000 --> 00:43:46,150
guys have juvie like don't you have the

00:43:44,590 --> 00:43:48,310
equivalent of that and he's like what's

00:43:46,150 --> 00:43:49,660
that and I started explaining to it and

00:43:48,310 --> 00:43:51,250
when you explain it to someone and

00:43:49,660 --> 00:43:55,150
you're like well it's a prison for kids

00:43:51,250 --> 00:43:56,740
it just it just it starts not not

00:43:55,150 --> 00:43:57,550
sounding very good right I was like

00:43:56,740 --> 00:44:02,980
let's let's

00:43:57,550 --> 00:44:04,570
let's not talk about that so you know I

00:44:02,980 --> 00:44:06,190
said so what do you guys do with all

00:44:04,570 --> 00:44:08,320
these like I see you getting them what

00:44:06,190 --> 00:44:10,120
do you do with them and I said to use

00:44:08,320 --> 00:44:12,100
him to play games right like what do you

00:44:10,120 --> 00:44:14,260
do and he says we scanned for other

00:44:12,100 --> 00:44:18,910
routes we can flood we can spam we can

00:44:14,260 --> 00:44:22,030
make money so what I asked him was I

00:44:18,910 --> 00:44:23,830
said you know who was buying these which

00:44:22,030 --> 00:44:26,890
was the one question he wouldn't answer

00:44:23,830 --> 00:44:29,500
his answer every single time was hahaha

00:44:26,890 --> 00:44:31,660
people like you that was his only answer

00:44:29,500 --> 00:44:34,030
so I still don't know who they're

00:44:31,660 --> 00:44:36,280
actually selling these to my suspicion

00:44:34,030 --> 00:44:37,900
is still it's used for spam that's my

00:44:36,280 --> 00:44:40,900
suspicions because I can't figure out

00:44:37,900 --> 00:44:42,970
what else I mean botnet I guess but I

00:44:40,900 --> 00:44:46,090
just it seems like an awful lot of money

00:44:42,970 --> 00:44:52,030
to be paying to have route to get root

00:44:46,090 --> 00:44:54,250
access to it now the next the next slide

00:44:52,030 --> 00:44:55,900
that i'm going to show was something

00:44:54,250 --> 00:44:58,660
that was dumped into the IRC channel

00:44:55,900 --> 00:45:01,660
this to me looked like an accidental

00:44:58,660 --> 00:45:04,630
copy and paste because it was followed

00:45:01,660 --> 00:45:06,490
by nothing else other than this this

00:45:04,630 --> 00:45:10,570
appears to be someone's complete

00:45:06,490 --> 00:45:14,170
identity and again i sanitized all of

00:45:10,570 --> 00:45:16,690
this i don't know how legitimate it is

00:45:14,170 --> 00:45:19,120
but if you look here the thing that

00:45:16,690 --> 00:45:25,840
really made me think it was right was

00:45:19,120 --> 00:45:27,730
the ATM PIN matches the birth date so

00:45:25,840 --> 00:45:30,190
that made me go oh this is really

00:45:27,730 --> 00:45:31,750
somebody's ID and that's really when i

00:45:30,190 --> 00:45:34,150
started when this happened was when I

00:45:31,750 --> 00:45:35,500
really started going whoa I don't know

00:45:34,150 --> 00:45:37,750
who I'm messing with here like I don't

00:45:35,500 --> 00:45:39,280
know you know it could be Eastern

00:45:37,750 --> 00:45:41,740
European organized crime I mean I have

00:45:39,280 --> 00:45:43,270
no idea who I'm messing with and that

00:45:41,740 --> 00:45:44,650
was when I said okay I got to sanitize

00:45:43,270 --> 00:45:47,500
all this stuff and I got to be careful

00:45:44,650 --> 00:45:49,420
because again it's interesting this is

00:45:47,500 --> 00:45:51,550
as this is to me I don't want somebody

00:45:49,420 --> 00:45:56,020
getting hurt because of my stupid

00:45:51,550 --> 00:46:00,460
presentation here so so that was kind of

00:45:56,020 --> 00:46:01,840
the end of my my activities I stopped

00:46:00,460 --> 00:46:04,239
following the channel stop participating

00:46:01,840 --> 00:46:06,639
in it

00:46:04,239 --> 00:46:08,559
and so the question is so all of this

00:46:06,639 --> 00:46:09,729
after all of this you know what does

00:46:08,559 --> 00:46:11,229
this all mean like what's the takeaway

00:46:09,729 --> 00:46:13,089
for us this is all really interesting

00:46:11,229 --> 00:46:15,519
and it's it's an interesting story but

00:46:13,089 --> 00:46:18,729
what's the takeaway so the things that I

00:46:15,519 --> 00:46:21,459
learned were first of all that these

00:46:18,729 --> 00:46:23,619
guys were really script kiddies for hire

00:46:21,459 --> 00:46:26,319
and to the person who commented about

00:46:23,619 --> 00:46:28,839
following a script these guys did not

00:46:26,319 --> 00:46:30,429
consider themselves hackers I asked them

00:46:28,839 --> 00:46:32,379
I said oh you guys are hackers and he's

00:46:30,429 --> 00:46:33,609
like no you have to know sequel

00:46:32,379 --> 00:46:36,249
injection if you want to be a hacker

00:46:33,609 --> 00:46:38,949
that was that was the bar for them and

00:46:36,249 --> 00:46:40,449
they said you know were we're just

00:46:38,949 --> 00:46:42,399
following we're following a script

00:46:40,449 --> 00:46:43,959
essentially where we have a you know we

00:46:42,399 --> 00:46:45,939
have it steps that we walk through and

00:46:43,959 --> 00:46:48,639
that seemed to be the extent of what

00:46:45,939 --> 00:46:50,169
they knew so these were not you know

00:46:48,639 --> 00:46:52,539
these were not technical Wizards they

00:46:50,169 --> 00:46:54,099
were just kind of following and I think

00:46:52,539 --> 00:46:55,959
the password with all of the you know

00:46:54,099 --> 00:46:57,789
how hard is it to unique a username and

00:46:55,959 --> 00:47:01,029
password file right i mean it's really

00:46:57,789 --> 00:47:04,629
easy but so i think that kind of speaks

00:47:01,029 --> 00:47:07,269
to their to their technical prowess so

00:47:04,629 --> 00:47:11,589
the other things that I learned use

00:47:07,269 --> 00:47:13,119
strong passwords obviously so those were

00:47:11,589 --> 00:47:15,099
what the passwords look like that we're

00:47:13,119 --> 00:47:19,349
in their file route 123 password 123

00:47:15,099 --> 00:47:21,729
Beavis but soul selection 123 and

00:47:19,349 --> 00:47:24,069
whatever that is was also in that list

00:47:21,729 --> 00:47:25,989
so they did have some long ugly

00:47:24,069 --> 00:47:28,839
passwords in there where that came from

00:47:25,989 --> 00:47:30,609
no idea but the one thing that I noticed

00:47:28,839 --> 00:47:33,459
is not a single one of their passwords

00:47:30,609 --> 00:47:36,489
out of space in it not a single one so

00:47:33,459 --> 00:47:37,839
at least the list that I saw if you had

00:47:36,489 --> 00:47:39,819
a space in your password even if you had

00:47:37,839 --> 00:47:43,059
password space 1 2 3 they wouldn't get

00:47:39,819 --> 00:47:45,009
you so you know feel free to use a

00:47:43,059 --> 00:47:49,119
special characters use spaces make those

00:47:45,009 --> 00:47:50,439
passwords long and ugly all of the tools

00:47:49,119 --> 00:47:52,359
they were running we're on port 22

00:47:50,439 --> 00:47:55,959
everything was looking for standard ssh

00:47:52,359 --> 00:47:58,149
port so not a fan of security through

00:47:55,959 --> 00:48:00,009
obscurity however it will lower the

00:47:58,149 --> 00:48:01,539
noise that you have to look at not

00:48:00,009 --> 00:48:03,429
saying you can ignore it and not look at

00:48:01,539 --> 00:48:06,459
the activity on that port if you move it

00:48:03,429 --> 00:48:09,039
but again you'llyou'll you know these

00:48:06,459 --> 00:48:12,129
guys will you know you will swell CH

00:48:09,039 --> 00:48:14,019
them pretty significantly also failed to

00:48:12,129 --> 00:48:16,760
ban failed demands awesome if you don't

00:48:14,019 --> 00:48:20,320
have it deployed really look at it

00:48:16,760 --> 00:48:23,690
will automatically add an IP table

00:48:20,320 --> 00:48:25,370
blacklist to a machine that is trying to

00:48:23,690 --> 00:48:27,230
an IP that is trying to brute force you

00:48:25,370 --> 00:48:28,820
so you can figure that and you can say

00:48:27,230 --> 00:48:31,730
you know what you get six failed

00:48:28,820 --> 00:48:33,980
attempts as an example and then I put an

00:48:31,730 --> 00:48:35,930
IP table block in for you for 15 minutes

00:48:33,980 --> 00:48:37,550
so that would essentially kill these

00:48:35,930 --> 00:48:41,750
guys like they'd be done at that point

00:48:37,550 --> 00:48:45,920
so and it's not just for ssh you can do

00:48:41,750 --> 00:48:48,170
it for ftp and other services so that's

00:48:45,920 --> 00:48:51,350
it there any questions I don't know how

00:48:48,170 --> 00:48:53,000
much time I have like we still got on

00:48:51,350 --> 00:48:54,530
time you don't know okay we're good on

00:48:53,000 --> 00:49:05,990
time then I have 10 minutes to there any

00:48:54,530 --> 00:49:07,880
questions absolutely nothing so that was

00:49:05,990 --> 00:49:11,540
a nice lob up there tom because tom

00:49:07,880 --> 00:49:14,240
knows that I did nothing I so the one

00:49:11,540 --> 00:49:19,460
thing that I did was when I was

00:49:14,240 --> 00:49:22,820
connecting to IRC I didn't use my home

00:49:19,460 --> 00:49:24,350
IP address for that because I knew my

00:49:22,820 --> 00:49:26,060
home IP address was showing up in there

00:49:24,350 --> 00:49:27,890
bought list all the time right as a

00:49:26,060 --> 00:49:29,420
compromise host and I didn't want to

00:49:27,890 --> 00:49:31,340
show up because I wanted that them to be

00:49:29,420 --> 00:49:32,420
separate they weren't doing any kind of

00:49:31,340 --> 00:49:35,030
analytics I don't think they would have

00:49:32,420 --> 00:49:38,000
noticed but I just wanted to be on the

00:49:35,030 --> 00:49:39,620
safe side so I used a verizon air card

00:49:38,000 --> 00:49:42,170
anytime I connected so it was a separate

00:49:39,620 --> 00:49:45,890
IP address that was the only thing I did

00:49:42,170 --> 00:49:47,150
as far as any kind of obscurity goes you

00:49:45,890 --> 00:49:50,450
know when I was running it at my house

00:49:47,150 --> 00:49:51,830
it was running on my my isp provided IP

00:49:50,450 --> 00:49:53,410
address like I said which could have

00:49:51,830 --> 00:49:56,840
probably got me into some trouble

00:49:53,410 --> 00:49:58,580
depending on what they were doing so but

00:49:56,840 --> 00:50:01,430
other than that I didn't do anything to

00:49:58,580 --> 00:50:03,890
to obscure the one thing that I did do

00:50:01,430 --> 00:50:06,680
was I knew that my verizon aircard IP if

00:50:03,890 --> 00:50:09,110
they did any kind of geo location of the

00:50:06,680 --> 00:50:12,470
IP would come back to at the time i was

00:50:09,110 --> 00:50:14,480
living outside of pittsburgh so my my

00:50:12,470 --> 00:50:16,220
identity that i created i said i was

00:50:14,480 --> 00:50:17,810
from around Pittsburgh because I just

00:50:16,220 --> 00:50:20,000
wanted those two matchup that if they

00:50:17,810 --> 00:50:23,609
started looking that they wouldn't get

00:50:20,000 --> 00:50:28,560
curious because that IP didn't match

00:50:23,609 --> 00:50:28,560
so anything else yeah

00:50:39,589 --> 00:50:51,229
well yeah so they so I don't the way

00:50:49,160 --> 00:50:53,450
they operated I don't think they weren't

00:50:51,229 --> 00:50:56,869
scanning internal IP addresses I never

00:50:53,450 --> 00:51:00,170
saw them look at RFC 1918 addresses so

00:50:56,869 --> 00:51:02,869
even if they were and my box had one

00:51:00,170 --> 00:51:04,069
right because it was inside my it was

00:51:02,869 --> 00:51:06,469
inside my network who's behind the

00:51:04,069 --> 00:51:09,739
pfsense box so I never saw them probe

00:51:06,469 --> 00:51:11,180
outside of outside of that box they

00:51:09,739 --> 00:51:13,789
always went to the internet again I

00:51:11,180 --> 00:51:15,499
don't think these guys are they're

00:51:13,789 --> 00:51:17,499
following a script right there they're

00:51:15,499 --> 00:51:20,839
they're just there they're trying to get

00:51:17,499 --> 00:51:22,729
the most boxes in the least amount of

00:51:20,839 --> 00:51:26,059
time right that's that's really seems to

00:51:22,729 --> 00:51:28,519
be what they're after I didn't do I mean

00:51:26,059 --> 00:51:30,950
they were allowed out on my network out

00:51:28,519 --> 00:51:35,059
80 and ftp right those those those

00:51:30,950 --> 00:51:36,799
weren't blocked I don't recall seeing a

00:51:35,059 --> 00:51:38,690
lot of traffic that way I mean they seem

00:51:36,799 --> 00:51:40,219
to be the traffic that I saw going out

00:51:38,690 --> 00:51:43,099
80 was the W gets they were fetching

00:51:40,219 --> 00:51:44,299
files to see you know their files that

00:51:43,099 --> 00:51:52,279
and then testing the speed of the

00:51:44,299 --> 00:51:54,559
network ya know so so I didn't write

00:51:52,279 --> 00:51:56,599
right I didn't let it run that long I

00:51:54,559 --> 00:51:59,630
would I would reboot the box and wipe it

00:51:56,599 --> 00:52:02,180
out so yeah that would be interesting to

00:51:59,630 --> 00:52:04,219
see to see I don't know how I would know

00:52:02,180 --> 00:52:05,779
when they when they sold it right that's

00:52:04,219 --> 00:52:06,979
that would be the only problem of but

00:52:05,779 --> 00:52:11,239
yeah it would be interesting to see

00:52:06,979 --> 00:52:14,049
where they what happens once it's sold

00:52:11,239 --> 00:52:16,039
again my suspicion is it's it's spam

00:52:14,049 --> 00:52:18,559
because that seems like that would be

00:52:16,039 --> 00:52:20,599
the biggest bang for the buck you know

00:52:18,559 --> 00:52:22,219
and you can blast away a ton of spam and

00:52:20,599 --> 00:52:24,289
then it gets blacklisted and you don't

00:52:22,219 --> 00:52:25,579
care because you know because it's not

00:52:24,289 --> 00:52:30,609
your box you just move on to the next

00:52:25,579 --> 00:52:30,609
the next compromise toast yeah

00:52:30,760 --> 00:52:36,289
so no they were almost always smart

00:52:34,789 --> 00:52:39,200
enough there were some Romanian IPS that

00:52:36,289 --> 00:52:41,240
so that the UDP dos attack that I showed

00:52:39,200 --> 00:52:44,690
you that was one of them attacking

00:52:41,240 --> 00:52:46,549
another one of them so and I did see

00:52:44,690 --> 00:52:48,160
some of that there was kind of there was

00:52:46,549 --> 00:52:51,019
some drawing back and forth and you

00:52:48,160 --> 00:52:53,089
would see people get blasted off IRC so

00:52:51,019 --> 00:52:57,619
they were attacking each other but they

00:52:53,089 --> 00:52:59,089
almost always used a jump host to to

00:52:57,619 --> 00:53:00,529
attack you know again well as soon as

00:52:59,089 --> 00:53:02,240
they compromised my box they started

00:53:00,529 --> 00:53:04,250
using it to scan for other things so

00:53:02,240 --> 00:53:06,529
they seemed smart enough to not have it

00:53:04,250 --> 00:53:11,690
tracked back to where they to where they

00:53:06,529 --> 00:53:14,779
were and again a lot of Chinese IPS and

00:53:11,690 --> 00:53:16,849
I can't I can't really explain why

00:53:14,779 --> 00:53:18,440
because when I did it in my house I

00:53:16,849 --> 00:53:20,029
didn't see it was there were a lot of

00:53:18,440 --> 00:53:21,829
Chinese ip's but it wasn't exclusively

00:53:20,029 --> 00:53:23,690
Chinese IPS but when I was looking at

00:53:21,829 --> 00:53:26,450
the other boxes it was so heavily

00:53:23,690 --> 00:53:29,200
towards Chinese IPS that I can't really

00:53:26,450 --> 00:53:31,609
explain why why the difference unless

00:53:29,200 --> 00:53:34,400
it's a different group right I mean

00:53:31,609 --> 00:53:37,130
because I don't know on those kippo

00:53:34,400 --> 00:53:39,380
boxes where they were really coming from

00:53:37,130 --> 00:53:41,359
because I didn't have the same the same

00:53:39,380 --> 00:53:47,259
kind of packet capture so it is possible

00:53:41,359 --> 00:53:47,259
that it was a different group yeah

00:53:48,349 --> 00:53:53,239
oh they get come with a bad password

00:53:50,630 --> 00:53:57,410
like that it within hours it was

00:53:53,239 --> 00:53:58,999
compromised I mean within hours so I

00:53:57,410 --> 00:54:00,259
mean I don't know if you if you run I

00:53:58,999 --> 00:54:02,329
mean all you have to do if you run any

00:54:00,259 --> 00:54:04,039
Linux box on the internet with an open

00:54:02,329 --> 00:54:06,319
ssh port if you look at your logs

00:54:04,039 --> 00:54:08,660
they're hitting you all the time all the

00:54:06,319 --> 00:54:10,729
time if you if you look at that log

00:54:08,660 --> 00:54:16,009
they're just banging away constantly on

00:54:10,729 --> 00:54:18,499
ssh so I mean it doesn't take long with

00:54:16,009 --> 00:54:19,880
a bad password I'm sure it you know I

00:54:18,499 --> 00:54:23,269
don't know where one two three four five

00:54:19,880 --> 00:54:24,410
sixes and their list but you know I'm

00:54:23,269 --> 00:54:25,640
sure if you put password it would be

00:54:24,410 --> 00:54:27,140
even quicker right because they would

00:54:25,640 --> 00:54:31,150
just would just cut it down a little bit

00:54:27,140 --> 00:54:31,150
on how long it took them to get there I

00:54:31,779 --> 00:54:37,940
don't know one two three four five six

00:54:34,670 --> 00:54:39,920
is such a horrible password but it but I

00:54:37,940 --> 00:54:42,259
don't know but but again with the Linux

00:54:39,920 --> 00:54:44,390
box it was a full on linux box like they

00:54:42,259 --> 00:54:45,410
could they could compile they could

00:54:44,390 --> 00:54:48,049
you know they could do whatever they

00:54:45,410 --> 00:54:49,579
wanted to do on that box so it wasn't

00:54:48,049 --> 00:54:51,229
like the capo box where they could where

00:54:49,579 --> 00:54:55,190
they could where they had easy ways to

00:54:51,229 --> 00:55:04,729
tell that it was a honeypot anything

00:54:55,190 --> 00:55:07,369
else so I have tried to get some

00:55:04,729 --> 00:55:12,109
interest in different employers in honey

00:55:07,369 --> 00:55:15,019
pots at a previous employer we had a

00:55:12,109 --> 00:55:23,390
proof of concept that might still be

00:55:15,019 --> 00:55:25,099
running I don't know it the suspicion

00:55:23,390 --> 00:55:29,299
was that we would see more than we

00:55:25,099 --> 00:55:31,339
actually did so the bad thing about that

00:55:29,299 --> 00:55:32,210
is they people kind of lose interest in

00:55:31,339 --> 00:55:33,229
it because they're like well why are we

00:55:32,210 --> 00:55:36,950
doing this if we're not really seeing

00:55:33,229 --> 00:55:38,839
anything off of it right so and again

00:55:36,950 --> 00:55:40,640
it's a you know deploying an

00:55:38,839 --> 00:55:43,519
intentionally vulnerable box so in that

00:55:40,640 --> 00:55:47,660
case I actually used I used honey d and

00:55:43,519 --> 00:55:49,309
had it mimic an XP box and now in that

00:55:47,660 --> 00:55:50,749
case all I did was offer XP like

00:55:49,309 --> 00:55:53,690
services it does that kind of low

00:55:50,749 --> 00:55:55,039
interaction where it looks like XP but

00:55:53,690 --> 00:55:58,510
once they actually try to do something

00:55:55,039 --> 00:56:03,520
to it it won't let them go any further

00:55:58,510 --> 00:56:06,400
and but we didn't see a lot of we didn't

00:56:03,520 --> 00:56:07,900
see a lot of traffic the most of the

00:56:06,400 --> 00:56:10,750
traffic we saw was legitimate it was

00:56:07,900 --> 00:56:13,210
some asset inventory stuff like sweeping

00:56:10,750 --> 00:56:14,830
every IP address and it would trip the

00:56:13,210 --> 00:56:17,020
honey pot in honey powder I got a hit

00:56:14,830 --> 00:56:21,670
and it was just asset inventory looking

00:56:17,020 --> 00:56:24,640
for stuff so but I haven't given up on

00:56:21,670 --> 00:56:27,730
that idea so I'm hoping that there's an

00:56:24,640 --> 00:56:35,710
opportunity in my new position to kind

00:56:27,730 --> 00:56:37,780
of revisit that with time no that's what

00:56:35,710 --> 00:56:41,260
I'm they weren't they were command and

00:56:37,780 --> 00:56:42,850
control mech bot they were completely

00:56:41,260 --> 00:56:44,980
again I think these guys were just

00:56:42,850 --> 00:56:46,360
following a script they had a set of

00:56:44,980 --> 00:56:48,190
tools they didn't really think about

00:56:46,360 --> 00:56:51,010
what they were doing that because they

00:56:48,190 --> 00:56:52,390
were just kids 16 years old I mean I

00:56:51,010 --> 00:56:57,430
take him at his word he seemed to be

00:56:52,390 --> 00:56:59,800
honest they were just yeah true your

00:56:57,430 --> 00:57:01,180
true you're right you're right it could

00:56:59,800 --> 00:57:07,480
be I mean your abs you're absolutely

00:57:01,180 --> 00:57:11,310
right and so yeah so they just seem like

00:57:07,480 --> 00:57:17,370
they're just following a script so

00:57:11,310 --> 00:57:17,370
anything else all right thanks everybody

00:57:20,549 --> 00:57:22,609

YouTube URL: https://www.youtube.com/watch?v=oWXZX3izR44


