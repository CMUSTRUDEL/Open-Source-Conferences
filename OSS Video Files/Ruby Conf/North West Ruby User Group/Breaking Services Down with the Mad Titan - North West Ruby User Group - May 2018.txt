Title: Breaking Services Down with the Mad Titan - North West Ruby User Group - May 2018
Publication date: 2018-05-23
Playlist: North West Ruby User Group
Description: 
	Breaking Services Down with the Mad Titan - Brandon Burton
Captions: 
	00:00:00,030 --> 00:00:05,339
so yet my talk is breaking services down

00:00:03,060 --> 00:00:08,519
with the man Titan for those of you

00:00:05,339 --> 00:00:10,950
don't know your limps Thanos destroyer

00:00:08,519 --> 00:00:14,429
of worlds but one thing he doesn't

00:00:10,950 --> 00:00:16,680
really like is bleeding resources dried

00:00:14,429 --> 00:00:20,430
training resources at least in the MC u

00:00:16,680 --> 00:00:23,430
universe and so what I'm gonna kind of

00:00:20,430 --> 00:00:25,830
mix in well he's gonna help me break

00:00:23,430 --> 00:00:28,680
down the service and the service in

00:00:25,830 --> 00:00:32,309
particular is one from a client of ours

00:00:28,680 --> 00:00:34,350
where they had this deletion service it

00:00:32,309 --> 00:00:36,510
was a one button does all sorts of thing

00:00:34,350 --> 00:00:39,390
and it's probably started off quite

00:00:36,510 --> 00:00:42,750
small eventually grew and grew and grew

00:00:39,390 --> 00:00:44,700
tons of methods all within one method

00:00:42,750 --> 00:00:46,739
that ran once and eventually the page

00:00:44,700 --> 00:00:50,129
just stopped loading because I was doing

00:00:46,739 --> 00:00:52,170
too many things so yeah we're gonna try

00:00:50,129 --> 00:00:54,149
to break that down I guess follow that

00:00:52,170 --> 00:00:58,649
through and then what I ended up doing

00:00:54,149 --> 00:01:00,719
to solve that problem so like I said

00:00:58,649 --> 00:01:02,399
probably started off nice and small

00:01:00,719 --> 00:01:04,500
something like this where it would just

00:01:02,399 --> 00:01:08,820
do a couple things delete it get rid of

00:01:04,500 --> 00:01:11,220
it and then move along but the problem

00:01:08,820 --> 00:01:13,020
with some of this stuff is that it can

00:01:11,220 --> 00:01:15,680
become obviously quite large as I was

00:01:13,020 --> 00:01:20,070
saying before it can become untenable

00:01:15,680 --> 00:01:25,110
and eventually what was once an okay

00:01:20,070 --> 00:01:29,009
plan is really no longer so you see it

00:01:25,110 --> 00:01:32,040
growing yeah and then you get tons of

00:01:29,009 --> 00:01:33,570
things and it just keep you keep end up

00:01:32,040 --> 00:01:35,520
sort of just chucking more and more

00:01:33,570 --> 00:01:37,470
because it's so easy you think oh I just

00:01:35,520 --> 00:01:39,810
need to delete something and this is

00:01:37,470 --> 00:01:43,079
that method and so just it belongs in

00:01:39,810 --> 00:01:44,820
there but no that's not the best thing

00:01:43,079 --> 00:01:48,780
oh I forgot to mention I've got some

00:01:44,820 --> 00:01:54,329
some pretty good amateur photo ya

00:01:48,780 --> 00:01:56,340
PowerPoint skills in here damn it no

00:01:54,329 --> 00:02:00,899
okay so you can't really hear that so

00:01:56,340 --> 00:02:02,369
I'll just skip that all right so I've

00:02:00,899 --> 00:02:08,129
got new contact lenses in so I can't

00:02:02,369 --> 00:02:11,790
really see so going back to our method

00:02:08,129 --> 00:02:13,710
before you can see there's actually

00:02:11,790 --> 00:02:15,660
quite a few similarities in there

00:02:13,710 --> 00:02:18,480
you can search identify so you've got

00:02:15,660 --> 00:02:21,270
user data birthday data user points

00:02:18,480 --> 00:02:22,470
these are all things that are related so

00:02:21,270 --> 00:02:23,850
you might be able to sort of extract

00:02:22,470 --> 00:02:25,830
them into something that makes a bit

00:02:23,850 --> 00:02:27,360
more sense when you're approaching this

00:02:25,830 --> 00:02:28,410
sort of deletion something's a bit more

00:02:27,360 --> 00:02:30,330
readable when you've got this massive

00:02:28,410 --> 00:02:31,500
long method if you want to change

00:02:30,330 --> 00:02:33,450
something that's related to the user

00:02:31,500 --> 00:02:40,140
data then you might want to visit a user

00:02:33,450 --> 00:02:42,990
service something like that so in part

00:02:40,140 --> 00:02:44,850
by doing that rather than just one sort

00:02:42,990 --> 00:02:46,650
of method one button click I'll delete

00:02:44,850 --> 00:02:48,720
everything you can now provide your

00:02:46,650 --> 00:02:51,270
users with with an option as to what

00:02:48,720 --> 00:02:52,740
they actually want to delete so a lot of

00:02:51,270 --> 00:02:54,900
this was actually used in a sort of

00:02:52,740 --> 00:02:57,090
testing kind of style so the client

00:02:54,900 --> 00:02:58,650
would go in would build this whole sort

00:02:57,090 --> 00:03:02,010
of program out test all the different

00:02:58,650 --> 00:03:03,510
functionalities show their customer what

00:03:02,010 --> 00:03:05,370
if we looked like and then to clear it

00:03:03,510 --> 00:03:06,900
down and then give it to them so they

00:03:05,370 --> 00:03:10,230
could then go on in use in a real

00:03:06,900 --> 00:03:11,490
production environment but sometimes you

00:03:10,230 --> 00:03:13,560
don't want to there's just things you

00:03:11,490 --> 00:03:14,730
don't need to do there's a proces steps

00:03:13,560 --> 00:03:17,370
that you don't need to go through so

00:03:14,730 --> 00:03:19,110
this now will sort of break it down into

00:03:17,370 --> 00:03:24,120
deleting only the things you really want

00:03:19,110 --> 00:03:26,010
to delete so this is kind of what some

00:03:24,120 --> 00:03:29,580
of those things would kind of go into it

00:03:26,010 --> 00:03:32,220
I suppose so you just really is that one

00:03:29,580 --> 00:03:35,040
one short method now it's tidier it's in

00:03:32,220 --> 00:03:40,050
a intention sort of revealing named

00:03:35,040 --> 00:03:45,090
class and space and I think that would

00:03:40,050 --> 00:03:51,720
be pretty happy about this as well yeah

00:03:45,090 --> 00:03:52,920
so now that we have this idea of how

00:03:51,720 --> 00:03:54,720
we're going to break down all of our

00:03:52,920 --> 00:03:56,100
other different bits into sort of the

00:03:54,720 --> 00:03:58,680
other sort of the services

00:03:56,100 --> 00:04:01,200
we'll need to create sort of a base of

00:03:58,680 --> 00:04:03,900
operation some place one place to hit

00:04:01,200 --> 00:04:05,400
that will then read in the data and say

00:04:03,900 --> 00:04:06,720
okay well what am I doing here what am I

00:04:05,400 --> 00:04:08,490
going to what am I supposed to be

00:04:06,720 --> 00:04:10,580
deleting Who am I supposed to be calling

00:04:08,490 --> 00:04:14,790
in order to sort of take care of this

00:04:10,580 --> 00:04:17,460
Thanos has a few friends called the the

00:04:14,790 --> 00:04:20,670
black order and one of them is a guy

00:04:17,460 --> 00:04:24,930
called kool obsidian and so he looks

00:04:20,670 --> 00:04:26,490
like that he's pretty cool he's really

00:04:24,930 --> 00:04:27,540
good at destroying things pretty strong

00:04:26,490 --> 00:04:30,810
guy

00:04:27,540 --> 00:04:33,830
so he's gonna be our sort of base it's

00:04:30,810 --> 00:04:37,740
going to do a lot of the deletion for us

00:04:33,830 --> 00:04:39,000
and what we can do is move that separate

00:04:37,740 --> 00:04:41,250
service class that we had before that

00:04:39,000 --> 00:04:44,010
you sort of use a class and we can move

00:04:41,250 --> 00:04:47,730
it under his command so we can bring in

00:04:44,010 --> 00:04:50,100
here and essentially eventually when we

00:04:47,730 --> 00:04:53,490
go through a step forward in a moment

00:04:50,100 --> 00:04:56,910
but he'll take in a service and then

00:04:53,490 --> 00:04:59,070
he'll execute that service for us and so

00:04:56,910 --> 00:05:01,530
from this perspective what would our our

00:04:59,070 --> 00:05:02,940
view in our controller look like now now

00:05:01,530 --> 00:05:05,940
that we've given the the user the option

00:05:02,940 --> 00:05:08,370
to make these decisions on what on their

00:05:05,940 --> 00:05:10,320
own so you might have a form and it

00:05:08,370 --> 00:05:12,780
might be a series of checkboxes and so

00:05:10,320 --> 00:05:14,370
they'll send through in an array just

00:05:12,780 --> 00:05:16,140
this list of services so you click on

00:05:14,370 --> 00:05:17,670
the ones that you want and it provides

00:05:16,140 --> 00:05:19,770
you with the name of the service that

00:05:17,670 --> 00:05:22,500
you're going to be utilizing I suppose

00:05:19,770 --> 00:05:24,570
you send that to your controller and it

00:05:22,500 --> 00:05:26,070
will run in the background as a as a

00:05:24,570 --> 00:05:27,750
psychic service so this was actually

00:05:26,070 --> 00:05:30,870
something I failed to mention before it

00:05:27,750 --> 00:05:34,020
should have done but the whole process

00:05:30,870 --> 00:05:37,350
of not just separating these things out

00:05:34,020 --> 00:05:39,690
into a manageable or readable service to

00:05:37,350 --> 00:05:41,250
avoid those page loads that we were sort

00:05:39,690 --> 00:05:43,440
of encountering was to run as a

00:05:41,250 --> 00:05:45,480
background job because it doesn't need

00:05:43,440 --> 00:05:46,950
to happen instantaneously they don't

00:05:45,480 --> 00:05:49,020
need the response immediately it just

00:05:46,950 --> 00:05:51,240
needs to work and then you can provide

00:05:49,020 --> 00:05:53,130
them as a notification afterwards if if

00:05:51,240 --> 00:05:55,800
that's what they really need so we'll

00:05:53,130 --> 00:05:57,240
set up a psychic service that will run

00:05:55,800 --> 00:06:00,270
that all of these services will run

00:05:57,240 --> 00:06:02,490
within we call that from our controller

00:06:00,270 --> 00:06:05,130
and then call obsidian we'll go off and

00:06:02,490 --> 00:06:08,220
do the dirty work and execute all of

00:06:05,130 --> 00:06:09,480
these services we won't have to worry

00:06:08,220 --> 00:06:10,740
about page requests failures anymore

00:06:09,480 --> 00:06:14,190
because they're not actually expecting

00:06:10,740 --> 00:06:15,600
anything to come back so you're like I'm

00:06:14,190 --> 00:06:17,280
saying makes it things a bit more

00:06:15,600 --> 00:06:19,950
manageable and readable and of course

00:06:17,280 --> 00:06:23,100
Stannis would be much happier now that

00:06:19,950 --> 00:06:27,440
his resources aren't being drained and

00:06:23,100 --> 00:06:29,500
that's everything yeah thanks listening

00:06:27,440 --> 00:06:29,500

YouTube URL: https://www.youtube.com/watch?v=joGs7jJymyk


