Title: OSMC 2019 | Monitoring Windows Events without Monitoring Logfiles by Martin Fürstenau
Publication date: 2019-11-18
Playlist: OSMC 2019 | Open Source Monitoring Conference
Description: 
	If you search the internet for how to monitoring Windows Events with Nagios/Naemon/Icinga(2) etc. you find pages over pages how to monitor lgofiles for Windows events. Monitoring logfiles can be a real big nightmare.

– How often will you scan a log?
– Have you processed the event with an earlier scan?
– What to do if a event is not logged?

Monitoring eventlogs needs mostly complex filter rules. And it is mostly not realtime. Beside nsclient++ real time event log monitoring there is not so well known but very effective method. But there is a method without installing any additional software on Windows. Without analyzing logfiles. SNMP traps. Presentation will show how to configure Microsoft SNMP to send traps, how to tell MS Windows to send events as traps same time when the event is written to the logfile and how to process the event with SNMPTT.


NETWAYS
Konferenzen: https://www.netways.de/events
Schulungen: https://www.netways.de/schulungen
Shop: https://shop.netways.de/
Blog: http://blog.netways.de/
NWS: https://nws.netways.de

Webinare
Archiv Link: https://www.netways.de/webinare/archi...
Aktuell: https://www.netways.de/wb

Social Media
SlideShare: http://de.slideshare.net/netways
YouTube: https://www.netways.de/youtube
Facebook: https://www.facebook.com/netways
Twitter: https://twitter.com/netways
Instagram: https://www.instagram.com/netwaysgmbh/

Musik: FRAMETRAXX
Captions: 
	00:00:09,379 --> 00:00:14,450
okay

00:00:10,620 --> 00:00:14,450
so I hope that nothing would go wrong

00:00:15,470 --> 00:00:22,650
okay I'll say I'm working for C printing

00:00:18,330 --> 00:00:29,570
systems working for C printing systems

00:00:22,650 --> 00:00:29,570
Bavarian Germany not North Dakota yes so

00:00:30,289 --> 00:00:37,560
Boeing near Munich am and Munich yeah

00:00:33,680 --> 00:00:40,890
okay as you can see you have a long long

00:00:37,560 --> 00:00:45,750
years of experience 162 next week and

00:00:40,890 --> 00:00:48,870
sometimes I feel older than that oh this

00:00:45,750 --> 00:00:53,220
is about me and to think it's mainly

00:00:48,870 --> 00:00:56,370
without any interest okay some thing

00:00:53,220 --> 00:00:59,400
about the environment a monitor we and

00:00:56,370 --> 00:01:03,060
pulling are for OC printing systems we

00:00:59,400 --> 00:01:06,659
are now 100% owned by canon from next

00:01:03,060 --> 00:01:09,990
year on we are not long no longer OCE we

00:01:06,659 --> 00:01:13,560
are Canon production printing unit fully

00:01:09,990 --> 00:01:15,630
integrated and well I have a long

00:01:13,560 --> 00:01:19,890
experience with Nagios I started with

00:01:15,630 --> 00:01:26,460
net st. I had written a lot of plugins

00:01:19,890 --> 00:01:29,219
and I have think not so small landscape

00:01:26,460 --> 00:01:32,969
a monitor systems for us in polling for

00:01:29,219 --> 00:01:38,159
hot water in vandal for Singapore for

00:01:32,969 --> 00:01:44,479
Melbourne for Timmy's roarin and in

00:01:38,159 --> 00:01:49,579
Romania I'm running currently around

00:01:44,479 --> 00:01:52,219
2004 and Houston monitoring with

00:01:49,579 --> 00:01:58,439
production

00:01:52,219 --> 00:02:06,780
23500 around services worth over 50% is

00:01:58,439 --> 00:02:09,869
on Windows well are the problem how to

00:02:06,780 --> 00:02:12,540
monitor Venus events there's anybody of

00:02:09,869 --> 00:02:14,880
you have a problem to monitor of Windows

00:02:12,540 --> 00:02:15,400
events no what is it running inside

00:02:14,880 --> 00:02:18,940
block

00:02:15,400 --> 00:02:20,159
from self-written programs from standard

00:02:18,940 --> 00:02:26,200


00:02:20,159 --> 00:02:28,840
well hello our headquarter asked me well

00:02:26,200 --> 00:02:30,879
we will replace Microsoft's come and we

00:02:28,840 --> 00:02:33,310
have to monitor events can you do it can

00:02:30,879 --> 00:02:36,720
you Lonnie to unlock finder said oh yeah

00:02:33,310 --> 00:02:39,790
no problem well there was a problem

00:02:36,720 --> 00:02:40,890
first and what the administrator of

00:02:39,790 --> 00:02:43,629
these systems

00:02:40,890 --> 00:02:48,849
second they want to have installed so

00:02:43,629 --> 00:02:52,269
much stuff on their systems and so I use

00:02:48,849 --> 00:02:55,920
very much as an MP because SNMP is

00:02:52,269 --> 00:03:03,040
available or nearly every system

00:02:55,920 --> 00:03:08,470
it's old it's shitty but it works well

00:03:03,040 --> 00:03:11,170
since Windows 2012 a lot of things

00:03:08,470 --> 00:03:15,730
formerly monitored by me with SNMP

00:03:11,170 --> 00:03:18,819
wasn't no longer possible Mitra's have

00:03:15,730 --> 00:03:21,370
produced it and saved hate take WMI but

00:03:18,819 --> 00:03:25,750
oh that's something special attack ends

00:03:21,370 --> 00:03:30,280
for disk also which covers windows linux

00:03:25,750 --> 00:03:34,139
solaris lot of other stuff all with the

00:03:30,280 --> 00:03:37,329
same plugin ok so we know some weapons

00:03:34,139 --> 00:03:39,989
ok check lock files from your glasses

00:03:37,329 --> 00:03:44,639
very farm plugin but unfortunately i

00:03:39,989 --> 00:03:49,030
can't refute it it's not because it

00:03:44,639 --> 00:03:50,739
needs to our internal environment you

00:03:49,030 --> 00:03:54,280
can compile it in a way that you've got

00:03:50,739 --> 00:03:56,889
an asset alone exit but the problem was

00:03:54,280 --> 00:03:58,449
that i have to deploy different

00:03:56,889 --> 00:04:02,019
configurations and that was not to

00:03:58,449 --> 00:04:04,510
handle so i started with an inclined log

00:04:02,019 --> 00:04:08,739
for monitoring I spent weeks on that

00:04:04,510 --> 00:04:11,260
 because there are mighty mighty

00:04:08,739 --> 00:04:13,599
mighty mighty filters and finally my

00:04:11,260 --> 00:04:15,849
filters were working but unfortunately

00:04:13,599 --> 00:04:19,090
in case of a critical I got a critical

00:04:15,849 --> 00:04:24,280
message but the return code of 0l0

00:04:19,090 --> 00:04:27,280
as you know it means ok I never found

00:04:24,280 --> 00:04:29,440
out what it was but I thought well this

00:04:27,280 --> 00:04:33,820
can't be handled I can't have filters

00:04:29,440 --> 00:04:41,550
for for any event and so I thought it

00:04:33,820 --> 00:04:44,919
must be another way to monitor events

00:04:41,550 --> 00:04:49,060
especially if you passing log files you

00:04:44,919 --> 00:04:54,370
have to to be aware for the time frame

00:04:49,060 --> 00:04:59,430
so that you won't process the same event

00:04:54,370 --> 00:04:59,430
event more than once that was hard

00:04:59,849 --> 00:05:05,229
you can use the feature of Anna's client

00:05:03,310 --> 00:05:10,090
class plus for lock for monitoring

00:05:05,229 --> 00:05:12,430
sending an event from Anna's client

00:05:10,090 --> 00:05:15,669
directly when it happens but this was

00:05:12,430 --> 00:05:18,849
more configuration for me and especially

00:05:15,669 --> 00:05:23,169
I have a standard standardized and

00:05:18,849 --> 00:05:26,740
assigned any and this is deployed to all

00:05:23,169 --> 00:05:29,260
locations and so I want it wasn't my

00:05:26,740 --> 00:05:32,110
opinion to have different versions to

00:05:29,260 --> 00:05:34,770
deploy we cannot maintain it because

00:05:32,110 --> 00:05:38,740
there are too much systems with too much

00:05:34,770 --> 00:05:42,490
administrators and believe me not every

00:05:38,740 --> 00:05:46,779
administrator is it's money it's money

00:05:42,490 --> 00:05:53,139
worth so we have a real big bunch of

00:05:46,779 --> 00:05:55,300
idiots working as administrators yeah

00:05:53,139 --> 00:06:00,760
especially we have a lot of only Mouse

00:05:55,300 --> 00:06:03,909
clickers yeah everything but which is

00:06:00,760 --> 00:06:07,690
more than a click it's like talking

00:06:03,909 --> 00:06:11,710
about Trump and intelligence of thing

00:06:07,690 --> 00:06:14,950
ok so I found out we have SNMP enabled

00:06:11,710 --> 00:06:18,010
on all Windows systems and I was very

00:06:14,950 --> 00:06:20,610
surprised Windows is able to send us

00:06:18,010 --> 00:06:23,680
some pictures I said great what great

00:06:20,610 --> 00:06:26,490
let's enable it and this is how you will

00:06:23,680 --> 00:06:29,469
do it you got just on the service and

00:06:26,490 --> 00:06:31,479
say ok service properties and then you

00:06:29,469 --> 00:06:34,020
have that frame of that window on the

00:06:31,479 --> 00:06:36,080
right side you have a traps

00:06:34,020 --> 00:06:37,970
car

00:06:36,080 --> 00:06:41,870
and the only thing you have to do to

00:06:37,970 --> 00:06:44,780
enable it to send traps is you have to

00:06:41,870 --> 00:06:48,909
add your trap destinations these are not

00:06:44,780 --> 00:06:48,909
my IP addresses so don't try it

00:06:49,900 --> 00:06:55,159
unfortunately the community a community

00:06:52,189 --> 00:06:58,669
name can't be changed its public but

00:06:55,159 --> 00:07:03,199
well I don't care about it i enabled it

00:06:58,669 --> 00:07:06,020
and when I looked into the chat log I

00:07:03,199 --> 00:07:10,930
saw wow I got a trap but I don't know

00:07:06,020 --> 00:07:13,569
what it meant it was sort of sort of

00:07:10,930 --> 00:07:19,659
okay forget it

00:07:13,569 --> 00:07:21,469
well later recognized it was only in an

00:07:19,659 --> 00:07:24,009
authorization trap it's caught by

00:07:21,469 --> 00:07:30,229
Microsoft and it's only like a heartbeat

00:07:24,009 --> 00:07:35,029
okay so I had the winner system sending

00:07:30,229 --> 00:07:41,300
traps but the next thing how will I get

00:07:35,029 --> 00:07:44,180
my events as a trap that's easy I looked

00:07:41,300 --> 00:07:49,009
into the air in the net I think it was

00:07:44,180 --> 00:07:54,710
weeks and have found no information then

00:07:49,009 --> 00:07:58,159
I found event win but first let's have a

00:07:54,710 --> 00:08:00,680
look an event is locked in a in a log

00:07:58,159 --> 00:08:02,479
file and for example and from a formal

00:08:00,680 --> 00:08:06,919
screenshots unfortunately I can't have a

00:08:02,479 --> 00:08:09,529
live presentation because the BPM wasn't

00:08:06,919 --> 00:08:12,860
working correctly sessions were crashed

00:08:09,529 --> 00:08:17,349
I tested it on our go and so we about to

00:08:12,860 --> 00:08:21,319
the screenshot so I tested it with

00:08:17,349 --> 00:08:27,199
around again so from my system my Linux

00:08:21,319 --> 00:08:31,039
system I have access to Windows testing

00:08:27,199 --> 00:08:33,289
machine and I use free RDP so I took my

00:08:31,039 --> 00:08:39,680
free atopy script and modified it with

00:08:33,289 --> 00:08:44,930
an wrong login and you see you get

00:08:39,680 --> 00:08:50,060
knotted failure with event ID of here

00:08:44,930 --> 00:08:53,660
seed for 6 to 5 so I thought

00:08:50,060 --> 00:08:56,510
without without our production

00:08:53,660 --> 00:08:59,060
environment and the trap they ask me the

00:08:56,510 --> 00:09:03,410
events they ask me it's good for testing

00:08:59,060 --> 00:09:05,000
so remember for six to five and you see

00:09:03,410 --> 00:09:09,980
we have a knowledge failure you can see

00:09:05,000 --> 00:09:13,420
it in your event log and believe me if

00:09:09,980 --> 00:09:20,180
someone will ask you to monitor events

00:09:13,420 --> 00:09:22,610
you are first to look into these log to

00:09:20,180 --> 00:09:28,100
see what you will expect what is coming

00:09:22,610 --> 00:09:30,980
on data so pardon marking a bit English

00:09:28,100 --> 00:09:33,050
but sometimes I'm missing words if I

00:09:30,980 --> 00:09:39,140
miss sentences please call a doctor then

00:09:33,050 --> 00:09:42,080
it's caused by my age okay so the great

00:09:39,140 --> 00:09:43,760
tool is event win event win is part of

00:09:42,080 --> 00:09:45,980
the event handling system of maxwell's

00:09:43,760 --> 00:09:48,710
of Windows and part of the incidentally

00:09:45,980 --> 00:09:49,730
package at the end of the slides and the

00:09:48,710 --> 00:09:53,600
thing in the slides will be available

00:09:49,730 --> 00:09:56,750
online later on you will see some

00:09:53,600 --> 00:10:03,530
resources these resources were hard to

00:09:56,750 --> 00:10:06,860
find and the resources for SNMP are all

00:10:03,530 --> 00:10:09,680
all in under win32 tree and the

00:10:06,860 --> 00:10:14,840
Microsoft documentation but it still

00:10:09,680 --> 00:10:16,970
actual it's from the end of 2018 so this

00:10:14,840 --> 00:10:21,620
is working about always Microsoft say

00:10:16,970 --> 00:10:23,960
hey WMI ok you start the band well until

00:10:21,620 --> 00:10:27,020
we got this event to track translator

00:10:23,960 --> 00:10:32,750
great yeah you know the with the event

00:10:27,020 --> 00:10:38,870
at 4 6 4 6 to 5 for example so how do I

00:10:32,750 --> 00:10:41,960
get the event in it well I think it was

00:10:38,870 --> 00:10:44,450
a setting strap anyway we got this one

00:10:41,960 --> 00:10:47,170
and you'll see on the lad event sources

00:10:44,450 --> 00:10:50,810
the same as you see in the event lock

00:10:47,170 --> 00:10:53,990
when you look at the villa countries so

00:10:50,810 --> 00:11:00,010
I looked for the right entry and you see

00:10:53,990 --> 00:11:03,370
all right side oh my mouse working no

00:11:00,010 --> 00:11:07,420
you say another security

00:11:03,370 --> 00:11:12,760
we have the four six two five okay okay

00:11:07,420 --> 00:11:17,470
take this one and at the top you'll see

00:11:12,760 --> 00:11:20,440
the object identifier theirs does

00:11:17,470 --> 00:11:24,100
everybody knows an object identifying as

00:11:20,440 --> 00:11:27,940
an MP yeah it's mainly like a telephone

00:11:24,100 --> 00:11:33,610
on my a continuum galaxy planet and so

00:11:27,940 --> 00:11:36,100
on oh you'll see it's four four six two

00:11:33,610 --> 00:11:39,670
five and the bottom you see the

00:11:36,100 --> 00:11:42,820
description we're where the description

00:11:39,670 --> 00:11:43,450
is a multi-line output we will come to

00:11:42,820 --> 00:11:47,620
it later on

00:11:43,450 --> 00:11:52,960
oh especially and this is interesting

00:11:47,620 --> 00:11:55,690
here you can say well generate a trap if

00:11:52,960 --> 00:11:58,060
an event count reaches within the time

00:11:55,690 --> 00:12:03,460
interval this is interesting for example

00:11:58,060 --> 00:12:06,400
for if you want a monitor or a lock in

00:12:03,460 --> 00:12:10,210
attack or something like that by script

00:12:06,400 --> 00:12:13,360
so you say okay if event counter reaches

00:12:10,210 --> 00:12:16,620
for example hundred in ten seconds well

00:12:13,360 --> 00:12:21,730
send me a trap ah I have to do something

00:12:16,620 --> 00:12:28,800
perhaps to to to look for the guy doing

00:12:21,730 --> 00:12:31,870
it and going to my desk and get my gun

00:12:28,800 --> 00:12:38,350
or better get a squirt and cut his

00:12:31,870 --> 00:12:42,040
fingers well from this time on it was

00:12:38,350 --> 00:12:43,900
sending this trap to my great but this

00:12:42,040 --> 00:12:48,070
trap doesn't say anything so I thought

00:12:43,900 --> 00:12:50,740
okay I always use as an MP treaty as

00:12:48,070 --> 00:12:54,190
when P trap translator to process traps

00:12:50,740 --> 00:12:56,590
and you use a friendly way and Linux and

00:12:54,190 --> 00:12:59,170
I looked for a map a management

00:12:56,590 --> 00:13:02,920
information base unfortunately

00:12:59,170 --> 00:13:05,680
unfortunately there is one even agent

00:13:02,920 --> 00:13:12,820
dot MIT unfortunately you can't use it

00:13:05,680 --> 00:13:15,640
because it's too old but event data this

00:13:12,820 --> 00:13:16,840
is still valid the objective denta fire

00:13:15,640 --> 00:13:19,960
is not valid

00:13:16,840 --> 00:13:22,780
but the data is valid so Khan you can

00:13:19,960 --> 00:13:26,400
use the data as no retention what you

00:13:22,780 --> 00:13:26,400
will get what you will have to process

00:13:27,210 --> 00:13:39,430
okay so next was I enabled on my test

00:13:34,690 --> 00:13:40,210
system block unknown traps and that's

00:13:39,430 --> 00:13:42,400
what I got

00:13:40,210 --> 00:13:46,000
you'll see at the end of the first line

00:13:42,400 --> 00:13:48,330
the last number is the event ID that's

00:13:46,000 --> 00:13:48,330
good to know

00:13:48,630 --> 00:13:53,800
then I had some values I don't know how

00:13:51,970 --> 00:13:57,940
to preserve these values and a shinobi

00:13:53,800 --> 00:14:01,470
track translator absolutely no and I

00:13:57,940 --> 00:14:05,290
have some I think it's entity values and

00:14:01,470 --> 00:14:11,740
if you look at these entity values you

00:14:05,290 --> 00:14:14,230
will say hey I have seen it before we

00:14:11,740 --> 00:14:18,040
have seen it when we looked on the

00:14:14,230 --> 00:14:21,670
Windows machine at the Lowcountry same

00:14:18,040 --> 00:14:26,250
data but their security journal that's a

00:14:21,670 --> 00:14:29,200
problem I mentioned multi-line output

00:14:26,250 --> 00:14:30,840
and multi-line output means in Windows

00:14:29,200 --> 00:14:33,970
as you know carriage return line feed

00:14:30,840 --> 00:14:36,180
LAN treat is dropped by default so we

00:14:33,970 --> 00:14:40,630
have a courage to turn we have to handle

00:14:36,180 --> 00:14:47,370
that means also all you can fork and

00:14:40,630 --> 00:14:47,370
fork out using simple scripts or you

00:14:47,430 --> 00:14:52,930
handle it in your shell script to

00:14:49,600 --> 00:14:56,800
replace a carriage return by a new line

00:14:52,930 --> 00:15:03,910
or something like that well I took a

00:14:56,800 --> 00:15:06,400
Perl script and then up next I the first

00:15:03,910 --> 00:15:09,910
filter first entry in my configuration

00:15:06,400 --> 00:15:14,500
file you'll see a name did lock in

00:15:09,910 --> 00:15:19,900
denied and a format Phu Phu Phu Phu Phu

00:15:14,500 --> 00:15:25,650
Phu and Donna down that means give me

00:15:19,900 --> 00:15:29,380
all the day or variables and say here

00:15:25,650 --> 00:15:30,400
with object identifier on the right side

00:15:29,380 --> 00:15:33,220
of the force

00:15:30,400 --> 00:15:36,700
still four to five it's a right event

00:15:33,220 --> 00:15:40,060
and then you see all data which is

00:15:36,700 --> 00:15:43,960
coming out of this stuff so here with

00:15:40,060 --> 00:15:48,310
this step you can verify do I get all

00:15:43,960 --> 00:15:51,250
the data which is certainly this is

00:15:48,310 --> 00:15:54,940
important because later on we break it

00:15:51,250 --> 00:16:00,760
down in several variables to handle and

00:15:54,940 --> 00:16:04,540
here you can check have I got all or all

00:16:00,760 --> 00:16:10,210
values I want it's a little bit hard to

00:16:04,540 --> 00:16:16,630
read but well I think most of us are

00:16:10,210 --> 00:16:20,910
paid by time by work okay so this clear

00:16:16,630 --> 00:16:24,190
so we are now having a window server

00:16:20,910 --> 00:16:30,490
sending a trap for specified event and

00:16:24,190 --> 00:16:36,310
you can do it for every event well then

00:16:30,490 --> 00:16:38,410
I took the net next step if somebody is

00:16:36,310 --> 00:16:40,390
wondered why I do it as rude well on

00:16:38,410 --> 00:16:43,090
this test machine I have only route I

00:16:40,390 --> 00:16:46,830
have no local accounts but it's a test

00:16:43,090 --> 00:16:46,830
machine and therefore is no problem

00:16:47,320 --> 00:16:54,760
and all my working directories are named

00:16:51,550 --> 00:16:57,310
our co-working scripts attack why well

00:16:54,760 --> 00:17:03,310
my name is phil steno and when I had my

00:16:57,310 --> 00:17:05,920
first job in IT for the non-english

00:17:03,310 --> 00:17:11,050
speakers first ears is like a Duke or

00:17:05,920 --> 00:17:13,150
Lord or so and so I was called I was

00:17:11,050 --> 00:17:16,750
asked how which account you won't have

00:17:13,150 --> 00:17:18,610
and I said give me a Duke and this guy

00:17:16,750 --> 00:17:22,630
made a duck for me okay it's in that

00:17:18,610 --> 00:17:26,740
time I know every system working

00:17:22,630 --> 00:17:28,900
directories or some scrap for us are

00:17:26,740 --> 00:17:32,340
always from duck tales it's dark or

00:17:28,900 --> 00:17:36,910
daisy or tone at all and I know I can

00:17:32,340 --> 00:17:40,090
can remove it so add a simple transcript

00:17:36,910 --> 00:17:42,640
and I only talk the first nine variables

00:17:40,090 --> 00:17:43,779
because I'm lazy and you know from shell

00:17:42,640 --> 00:17:45,639
scripting

00:17:43,779 --> 00:17:47,679
now I'm variables can be handled over

00:17:45,639 --> 00:17:51,279
without any problem

00:17:47,679 --> 00:17:56,529
and so I wrote this little stupid bear

00:17:51,279 --> 00:18:01,210
script on the right side I only what

00:17:56,529 --> 00:18:06,969
what did you test is it working and this

00:18:01,210 --> 00:18:13,779
was a result fine our first line had the

00:18:06,969 --> 00:18:15,460
message and unknown we have seen it this

00:18:13,779 --> 00:18:19,229
is not my server name but I had to

00:18:15,460 --> 00:18:23,440
replace it when I did the screenshot oh

00:18:19,229 --> 00:18:28,349
and some other stuff and we have seen

00:18:23,440 --> 00:18:34,719
all this stuff in the event log okay

00:18:28,349 --> 00:18:35,969
these were successful and then I did

00:18:34,719 --> 00:18:40,269
next

00:18:35,969 --> 00:18:41,369
if anyone anybody want to have this

00:18:40,269 --> 00:18:46,869
script

00:18:41,369 --> 00:18:49,899
it's a Perl script from me it can have

00:18:46,869 --> 00:18:53,139
it but it's currently only to to to log

00:18:49,899 --> 00:18:59,649
the events to show me which data is in

00:18:53,139 --> 00:19:05,979
it at the end of last week I was at that

00:18:59,649 --> 00:19:10,749
point just yeah I had just enough time

00:19:05,979 --> 00:19:17,229
to do the slides for today and I was

00:19:10,749 --> 00:19:21,219
very lucky that it was working so by the

00:19:17,229 --> 00:19:25,619
way as desk means system descript start

00:19:21,219 --> 00:19:25,619
description and each ask and description

00:19:25,769 --> 00:19:36,070
by the way commands never would increase

00:19:30,700 --> 00:19:40,419
runtime but they may be helpful well and

00:19:36,070 --> 00:19:44,349
that was the result I got has seen

00:19:40,419 --> 00:19:47,619
nearly every boundary the full lock was

00:19:44,349 --> 00:19:53,859
longer than a PowerPoint slide mayors

00:19:47,619 --> 00:19:57,240
and space for me and well here I have

00:19:53,859 --> 00:19:59,770
all the lines replaced

00:19:57,240 --> 00:20:05,100
the courage returned with the backslash

00:19:59,770 --> 00:20:05,100
and in the perb program and you'll see I

00:20:05,250 --> 00:20:12,880
have an text event system you see the

00:20:09,070 --> 00:20:15,580
server event text blah blah blah but

00:20:12,880 --> 00:20:17,940
this text is multi-line and you see here

00:20:15,580 --> 00:20:22,720
the event type and the event user ID

00:20:17,940 --> 00:20:25,780
well I tried it with an unknown user ID

00:20:22,720 --> 00:20:29,230
if I would have used a user ID valid

00:20:25,780 --> 00:20:35,470
with the wrong password at this point I

00:20:29,230 --> 00:20:42,780
have the user ID and text the same text

00:20:35,470 --> 00:20:48,160
here and this is a step I'm currently

00:20:42,780 --> 00:20:56,070
working on the next step is to enhance

00:20:48,160 --> 00:21:01,270
this script with modular filters because

00:20:56,070 --> 00:21:06,070
maybe not for standard with Windows

00:21:01,270 --> 00:21:08,590
systems so this message part is nearly

00:21:06,070 --> 00:21:12,520
fixed every window system so if you have

00:21:08,590 --> 00:21:15,460
a vanity ID you don't need the text but

00:21:12,520 --> 00:21:18,100
if you have a development department and

00:21:15,460 --> 00:21:22,900
this development department we lock in

00:21:18,100 --> 00:21:25,480
unlocks we produce own events maybe the

00:21:22,900 --> 00:21:30,970
important part you need for an error

00:21:25,480 --> 00:21:35,650
message is within the text so the main

00:21:30,970 --> 00:21:40,180
problem I have now is to enhance this

00:21:35,650 --> 00:21:43,690
script with modular filters to filter

00:21:40,180 --> 00:21:47,160
that out that part every other thing can

00:21:43,690 --> 00:21:54,640
be handled with command-line switches

00:21:47,160 --> 00:21:59,950
some years ago I had written my

00:21:54,640 --> 00:22:04,150
processing system to process email based

00:21:59,950 --> 00:22:07,600
alerts very hard has anyone ever tried

00:22:04,150 --> 00:22:10,490
it to process emails as alert while

00:22:07,600 --> 00:22:14,960
standards and things like well this may

00:22:10,490 --> 00:22:15,880
isn't text name its HTML okay we can

00:22:14,960 --> 00:22:18,200
handle it

00:22:15,880 --> 00:22:19,490
unfortunately it's based for a 64

00:22:18,200 --> 00:22:22,570
encoded oh

00:22:19,490 --> 00:22:28,190
and it has it hasn't a fixed format

00:22:22,570 --> 00:22:32,200
therefore I had a pro module where I

00:22:28,190 --> 00:22:36,110
could add shell scripts or Java programs

00:22:32,200 --> 00:22:38,060
yeah such other programs someone

00:22:36,110 --> 00:22:42,710
believes in it I don't know why but

00:22:38,060 --> 00:22:45,590
someone believes in God I do not all

00:22:42,710 --> 00:22:48,020
shell scripts all whatever it's not my

00:22:45,590 --> 00:22:51,050
interface and I will recycle it for this

00:22:48,020 --> 00:22:57,130
script so that in the very next time I

00:22:51,050 --> 00:23:00,470
will post it on github or on a singer or

00:22:57,130 --> 00:23:04,640
on request by email if I forget like

00:23:00,470 --> 00:23:07,820
many times to post it well I had do not

00:23:04,640 --> 00:23:11,410
have the time to post it and then we

00:23:07,820 --> 00:23:20,210
will have a system to easily prove

00:23:11,410 --> 00:23:23,060
process windows events well I think it

00:23:20,210 --> 00:23:29,980
was a thump up here I haven't seen it

00:23:23,060 --> 00:23:33,200
it's yeah it's a shiny here yeah well I

00:23:29,980 --> 00:23:36,380
thought first

00:23:33,200 --> 00:23:40,420
I spoke faster than in my chest I just

00:23:36,380 --> 00:23:43,760
did this presentation with the watch

00:23:40,420 --> 00:23:46,340
time okay

00:23:43,760 --> 00:23:50,840
as I mentioned the next will be winter

00:23:46,340 --> 00:23:53,840
up to monitor with filters for the

00:23:50,840 --> 00:23:59,390
variables which should have the most

00:23:53,840 --> 00:24:02,510
events only by passing command line I

00:23:59,390 --> 00:24:05,150
believe me maybe the one or the other

00:24:02,510 --> 00:24:08,060
window me I'm the author of check VM baa

00:24:05,150 --> 00:24:10,700
6 and a lot of other plugins and I know

00:24:08,060 --> 00:24:13,850
what are what I'm doing and I'll say I

00:24:10,700 --> 00:24:19,400
can do it and I will do it because I

00:24:13,850 --> 00:24:21,170
needed yeah I have planned to have a

00:24:19,400 --> 00:24:23,750
live presentation of this but

00:24:21,170 --> 00:24:26,720
unfortunately the Open VPN

00:24:23,750 --> 00:24:30,080
will not work it will hangs after a few

00:24:26,720 --> 00:24:32,960
seconds or a few minute here we have

00:24:30,080 --> 00:24:36,050
some resources these resources were hard

00:24:32,960 --> 00:24:38,000
to find you'll see the last resource is

00:24:36,050 --> 00:24:42,490
a documentation from combo'd convert as

00:24:38,000 --> 00:24:48,170
a backup system but this is very good to

00:24:42,490 --> 00:24:51,890
show how you have to enable traps on

00:24:48,170 --> 00:24:55,400
your on your system we monitor all our

00:24:51,890 --> 00:24:59,270
convert backups and so on with asana PTT

00:24:55,400 --> 00:25:00,020
and perhaps well I was faster than

00:24:59,270 --> 00:25:04,400
planned

00:25:00,020 --> 00:25:06,050
I spoke fast Abell so there is more

00:25:04,400 --> 00:25:13,910
spare time yet to get prepared for

00:25:06,050 --> 00:25:16,430
drinks are there any questions there's

00:25:13,910 --> 00:25:23,240
any thump rising up I won't see it

00:25:16,430 --> 00:25:27,170
because it's a shiny here's one where's

00:25:23,240 --> 00:25:29,630
one there's one hello alright you were

00:25:27,170 --> 00:25:32,150
talking about SNMP traps sending to the

00:25:29,630 --> 00:25:34,760
monitoring system if you have high loads

00:25:32,150 --> 00:25:40,430
many traps coming in do you have

00:25:34,760 --> 00:25:43,610
problems of dropping no traps I had the

00:25:40,430 --> 00:25:48,950
first presentation I had years ago was

00:25:43,610 --> 00:25:53,690
about trap handling with SNMP tt and at

00:25:48,950 --> 00:25:57,830
that time I had have the problem that

00:25:53,690 --> 00:26:02,720
our Dutch colleagues moved all of their

00:25:57,830 --> 00:26:06,620
as IP systems to us they try to replace

00:26:02,720 --> 00:26:09,220
the jobscheduler unfortunately there was

00:26:06,620 --> 00:26:11,870
no money for the jobscheduler they

00:26:09,220 --> 00:26:14,150
decided to use and so they stayed with

00:26:11,870 --> 00:26:16,640
IP X but unfortunately they had kicked

00:26:14,150 --> 00:26:19,940
off the operators monitoring that thing

00:26:16,640 --> 00:26:22,880
manually and so Dutch colleague came to

00:26:19,940 --> 00:26:26,090
me and said hey you told me you can

00:26:22,880 --> 00:26:27,650
process straps I can set your traps well

00:26:26,090 --> 00:26:33,910
the source of our first presentation

00:26:27,650 --> 00:26:36,410
here and I had monitored 1600 s IP jobs

00:26:33,910 --> 00:26:37,510
never random problems I have a lot of

00:26:36,410 --> 00:26:40,540
systems

00:26:37,510 --> 00:26:42,940
traps are won't process these traps are

00:26:40,540 --> 00:26:46,360
dropped by default so all our native

00:26:42,940 --> 00:26:51,910
systems are sending traps but we hadn't

00:26:46,360 --> 00:26:55,390
had the time the NetApp admin and I to

00:26:51,910 --> 00:26:59,440
say to see what we want to process so

00:26:55,390 --> 00:27:05,380
all these traps are coming in but no

00:26:59,440 --> 00:27:08,080
problem currently I'm running in out

00:27:05,380 --> 00:27:13,600
Nagios three dots something like this

00:27:08,080 --> 00:27:22,770
relays with somewhat human workers on to

00:27:13,600 --> 00:27:28,000
Fujitsu Siemens our net else six oh well

00:27:22,770 --> 00:27:30,929
I'm roof did a very every way because I

00:27:28,000 --> 00:27:36,910
have a lot of memory I don't use and so

00:27:30,929 --> 00:27:39,520
all the the files used from the system

00:27:36,910 --> 00:27:42,070
which we gone if you shut the system

00:27:39,520 --> 00:27:46,360
down the monitor down run in champ

00:27:42,070 --> 00:27:48,940
affairs so only memory operations I have

00:27:46,360 --> 00:27:51,130
no performance problems I have no

00:27:48,940 --> 00:27:55,870
performance problems with a lot of traps

00:27:51,130 --> 00:28:00,809
and I think several thousand a day

00:27:55,870 --> 00:28:04,799
I won't process the only problem is that

00:28:00,809 --> 00:28:07,780
the vassal system has to be big enough

00:28:04,799 --> 00:28:12,790
to keep the damned as an MP trap demon

00:28:07,780 --> 00:28:17,230
locks the SNMP TT locks are no problem

00:28:12,790 --> 00:28:23,410
because the unlock is only enabled when

00:28:17,230 --> 00:28:26,980
I do some testing and this is normally

00:28:23,410 --> 00:28:29,500
set to zero lengths by me if it's too

00:28:26,980 --> 00:28:35,350
long because I don't need all this stuff

00:28:29,500 --> 00:28:39,160
coming in and that's a lot during

00:28:35,350 --> 00:28:43,830
testing of this I had it enabled and

00:28:39,160 --> 00:28:49,210
wall between within two hours of testing

00:28:43,830 --> 00:28:55,809
I had around 40,000 lines

00:28:49,210 --> 00:28:58,419
for vlog the only problem is if you

00:28:55,809 --> 00:29:02,320
don't care if you have the the unlock

00:28:58,419 --> 00:29:05,710
enabled permanently lobby your bar file

00:29:02,320 --> 00:29:09,730
system will be cut for we got full but

00:29:05,710 --> 00:29:13,870
that's assuming PTT is a very

00:29:09,730 --> 00:29:23,140
lightweight ab sorry SNMP traps a very

00:29:13,870 --> 00:29:25,570
lightweight page so it is SNMP the

00:29:23,140 --> 00:29:28,270
simple doesn't mean simple to use it

00:29:25,570 --> 00:29:32,200
means simple from the structure and so

00:29:28,270 --> 00:29:34,330
you've got a simple data and it's not a

00:29:32,200 --> 00:29:37,240
heavy payload if you receive a lot of

00:29:34,330 --> 00:29:39,700
traps they kind of can receive hundreds

00:29:37,240 --> 00:29:44,620
of crops per minute without harming your

00:29:39,700 --> 00:29:48,630
system this should not be an issue on

00:29:44,620 --> 00:29:54,059
modern hardware but Yvette's general

00:29:48,630 --> 00:29:55,809
don't use according to my opinion

00:29:54,059 --> 00:29:58,840
virtual systems

00:29:55,809 --> 00:30:03,070
my boss has always had want to buy no no

00:29:58,840 --> 00:30:06,070
no hardware use for new systems virtual

00:30:03,070 --> 00:30:09,220
after and I said ok I'll be a yes on

00:30:06,070 --> 00:30:12,279
VMware and I told him why you remember

00:30:09,220 --> 00:30:15,159
last time I had working for our

00:30:12,279 --> 00:30:18,669
corporate network for kuai and this was

00:30:15,159 --> 00:30:23,500
only one worker Antichrist would be a

00:30:18,669 --> 00:30:26,080
mere systems yeah my new hardware's

00:30:23,500 --> 00:30:28,270
faster and I told him well you remember

00:30:26,080 --> 00:30:31,330
two weeks ago we had no heart a new

00:30:28,270 --> 00:30:33,640
hardware and I kicked off the brakes of

00:30:31,330 --> 00:30:37,500
my worker and I crashed the new VMs

00:30:33,640 --> 00:30:41,100
system yeah but you should do it with

00:30:37,500 --> 00:30:46,990
VMware ok but the same boss told me

00:30:41,100 --> 00:30:53,919
Martin you should use axel as a database

00:30:46,990 --> 00:30:59,320
and so after this I looked for for a

00:30:53,919 --> 00:31:02,230
thick piece of wood and go to to to

00:30:59,320 --> 00:31:07,739
agenda and beat it just before my hat

00:31:02,230 --> 00:31:08,980
we can interconnect but he's my boss

00:31:07,739 --> 00:31:13,480
okay

00:31:08,980 --> 00:31:15,929
and I can't kill him so I have to live

00:31:13,480 --> 00:31:22,960
with it

00:31:15,929 --> 00:31:36,429
okay any other questions no well it was

00:31:22,960 --> 00:31:42,190
pasta oh yeah I can't see him yeah okay

00:31:36,429 --> 00:31:53,010
then a big applause thank you

00:31:42,190 --> 00:31:53,010
[Music]

00:31:56,220 --> 00:31:59,350
you

00:31:56,600 --> 00:31:59,350

YouTube URL: https://www.youtube.com/watch?v=wZ2RQZs7Rzc


