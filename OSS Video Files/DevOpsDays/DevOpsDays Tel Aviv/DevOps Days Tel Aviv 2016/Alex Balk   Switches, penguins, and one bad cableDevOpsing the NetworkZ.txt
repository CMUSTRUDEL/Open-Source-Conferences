Title: Alex Balk   Switches, penguins, and one bad cableDevOpsing the NetworkZ
Publication date: 2017-01-08
Playlist: DevOps Days Tel Aviv 2016
Description: 
	
Captions: 
	00:00:02,710 --> 00:00:10,940
[Music]

00:00:07,360 --> 00:00:13,670
2015 Shalom coil is Cohen is out brains

00:00:10,940 --> 00:00:15,620
oops Hong Kong he's just getting home

00:00:13,670 --> 00:00:17,660
when his phone rings it's a pagerduty

00:00:15,620 --> 00:00:20,599
alert there's a latency issue in the

00:00:17,660 --> 00:00:21,890
Chicago datacenter he acts it when he

00:00:20,599 --> 00:00:24,410
gets home in a couple of minutes he'll

00:00:21,890 --> 00:00:29,539
handle it but then his phone rings again

00:00:24,410 --> 00:00:31,939
and again something is not right 18

00:00:29,539 --> 00:00:34,190
hours and many tired engineers later

00:00:31,939 --> 00:00:36,680
we've just recovered from having lost

00:00:34,190 --> 00:00:40,580
our Chicago data center in the taking

00:00:36,680 --> 00:00:42,320
that follows we recognize that a single

00:00:40,580 --> 00:00:44,540
network cable that was mistakenly

00:00:42,320 --> 00:00:46,580
connected to the wrong switch cause the

00:00:44,540 --> 00:00:48,800
broadcast storm one's new notes were

00:00:46,580 --> 00:00:55,940
connected to that switch in the analysis

00:00:48,800 --> 00:00:57,980
we recognize we recognize the problem

00:00:55,940 --> 00:01:00,980
with how we communicate with our remote

00:00:57,980 --> 00:01:02,870
hands and but we also recognize the

00:01:00,980 --> 00:01:05,659
problem in our architecture that both

00:01:02,870 --> 00:01:09,109
failed to mitigate and detect those

00:01:05,659 --> 00:01:10,490
problems two months later we're

00:01:09,109 --> 00:01:12,859
attending DevOps days we're walking

00:01:10,490 --> 00:01:14,420
around asking pretty much everyone the

00:01:12,859 --> 00:01:17,090
same question how do you manage your

00:01:14,420 --> 00:01:18,710
network we're looking for some insights

00:01:17,090 --> 00:01:20,210
from our peers something that is better

00:01:18,710 --> 00:01:22,069
than expect script something that's

00:01:20,210 --> 00:01:24,049
better than the dreaded copy paste that

00:01:22,069 --> 00:01:25,880
everybody's using we're getting some

00:01:24,049 --> 00:01:27,649
ideas some traction but nothing that's

00:01:25,880 --> 00:01:31,539
composable nothing that's testable

00:01:27,649 --> 00:01:31,539
nothing that is infrastructure as code

00:01:31,810 --> 00:01:39,649
everybody's in the cloud anyway and in

00:01:34,460 --> 00:01:42,889
the cloud and everybody's in the cloud

00:01:39,649 --> 00:01:47,090
anyway and physical hardware is just not

00:01:42,889 --> 00:01:49,819
interesting anymore eight months later I

00:01:47,090 --> 00:01:52,850
find myself in a Sacramento a city that

00:01:49,819 --> 00:01:54,679
makes hyphen look like Vegas it's a I'm

00:01:52,850 --> 00:01:57,409
in a fancy data center complete with

00:01:54,679 --> 00:01:58,999
iris scanners and climbing walls and if

00:01:57,409 --> 00:02:01,159
I must've wondering do they have

00:01:58,999 --> 00:02:02,929
insurance for that and wouldn't be it'd

00:02:01,159 --> 00:02:05,420
be better if the invest in a better dish

00:02:02,929 --> 00:02:07,459
washer in their kitchen but then the

00:02:05,420 --> 00:02:10,369
guys flip on the power to the network

00:02:07,459 --> 00:02:11,659
and I forget all about that you see it's

00:02:10,369 --> 00:02:14,360
been six months since we started working

00:02:11,659 --> 00:02:16,820
on our next generation lon architecture

00:02:14,360 --> 00:02:18,860
one that is fully automated from

00:02:16,820 --> 00:02:22,280
provisioning through config and up to

00:02:18,860 --> 00:02:25,520
monitoring having chosen come loose as

00:02:22,280 --> 00:02:27,470
our switch operating system vendor we

00:02:25,520 --> 00:02:29,930
were now running coolest linux on our

00:02:27,470 --> 00:02:31,370
switches which was Dale hardware similar

00:02:29,930 --> 00:02:35,660
to the hardware that we running on our

00:02:31,370 --> 00:02:38,480
servers we were using chef to configure

00:02:35,660 --> 00:02:40,430
the notes Prometheus to monitor them and

00:02:38,480 --> 00:02:43,430
we even simulated a full-blown data

00:02:40,430 --> 00:02:46,250
center using vagrant to both develop and

00:02:43,430 --> 00:02:48,950
test our implementation but that's not

00:02:46,250 --> 00:02:51,260
all we've also read Roger Perlman's

00:02:48,950 --> 00:02:53,989
papers and Facebook's RFC's and we

00:02:51,260 --> 00:02:56,300
figured we not only have a solution to

00:02:53,989 --> 00:02:58,160
our management needs but also a better

00:02:56,300 --> 00:03:01,070
way to scale it's called the cloth

00:02:58,160 --> 00:03:03,440
fabric and in this network everything is

00:03:01,070 --> 00:03:05,480
running bgp everything is a router from

00:03:03,440 --> 00:03:07,459
the host through the switches and up to

00:03:05,480 --> 00:03:09,170
the firewalls it actually makes the

00:03:07,459 --> 00:03:11,660
network simpler because it gets rid of

00:03:09,170 --> 00:03:13,580
all the layer to proprietary stuff given

00:03:11,660 --> 00:03:16,190
you've solved two issues one is

00:03:13,580 --> 00:03:19,489
management and the other is cabling now

00:03:16,190 --> 00:03:21,709
for management we already have chef and

00:03:19,489 --> 00:03:24,440
Prometheus done all that stuff which

00:03:21,709 --> 00:03:26,150
leaves us with roughly 1,500 cables that

00:03:24,440 --> 00:03:29,620
need to be very very accurately

00:03:26,150 --> 00:03:34,910
connected how hard could that be right

00:03:29,620 --> 00:03:36,350
back at the DC back at the DC we're just

00:03:34,910 --> 00:03:39,620
working out all the quirks of moving

00:03:36,350 --> 00:03:41,390
from VMs to physical Hardware fun things

00:03:39,620 --> 00:03:44,660
like inconsistent naming convention for

00:03:41,390 --> 00:03:46,100
our switches thank you though but it's

00:03:44,660 --> 00:03:48,860
just a couple of days and we're done

00:03:46,100 --> 00:03:51,410
we're running sanity checks pings meet

00:03:48,860 --> 00:03:54,080
bongs fail overs meet fell backs we even

00:03:51,410 --> 00:03:56,209
stream some content around and watch the

00:03:54,080 --> 00:03:57,709
network Bri converge once we kill the

00:03:56,209 --> 00:04:01,370
link with what without as much as a

00:03:57,709 --> 00:04:03,110
single lost packet even console was

00:04:01,370 --> 00:04:05,570
highly networked bit opinionated is

00:04:03,110 --> 00:04:06,739
awfully silent like a Polish mother who

00:04:05,570 --> 00:04:10,700
has nothing to say about your new

00:04:06,739 --> 00:04:12,769
girlfriend and that's when it happens we

00:04:10,700 --> 00:04:16,940
flip on monitoring and immediately an

00:04:12,769 --> 00:04:19,790
alert fires its cabinet b6 leaf to port

00:04:16,940 --> 00:04:22,970
16 breakout 23 the system has detected

00:04:19,790 --> 00:04:26,889
and routed around a faulty cable a

00:04:22,970 --> 00:04:31,280
single network cable out of over 1,500

00:04:26,889 --> 00:04:38,050
is bad and we caught it thank you

00:04:31,280 --> 00:04:38,050

YouTube URL: https://www.youtube.com/watch?v=rgSg2WQnK0s


