Title: Talk: Under and Dunder - Python secret functions - Cheuk Ting Ho
Publication date: 2020-12-03
Playlist: PyCon India 2020
Description: 
	This talk was presented at PyCon India 2020 Online.

PyCon India is the largest gathering of Pythonistas in India for the Python programming language. The 12th edition of PyCon India took place online from 2nd October to 5th October 2020.

Talk Detail: https://in.pycon.org/cfp/2020/proposals/under-and-dunder-python-secret-functions~dwMra/

Click here to subscribe to the PyCon India channel: https://www.youtube.com/user/inpycon?sub_confirmation=1
Follow PyCon India on Twitter: https://twitter.com/pyconindia
Follow PyCon India on Facebook: https://www.facebook.com/PyConIndia/
Captions: 
	                              hi everyone                               so our next stop is under and under                               python secret functions by chickting                               i mean the title looks pretty exciting                               and yeah the stage is yours now                               thank you so much and hello                               everybody i'm chuck and today i gotta                               talk about                               some python secret for you so                                sit back and buckle up and we gotta just                                dive into                                what's python hiding behind the scene                                for us                                so um first of all i think i would just                                do a brief introduction of myself                                i'm chuck and i love open source project                                i have been                                creating some projects in the past i've                                been involved in some projects in the                                past i                                of course have contributed to different                                uh projects some of them you may have                                already heard about like pandas or                                daisy tail and projects like that and                                but                                now uh i'm very lucky to be working                                full-time                                for a open source graph database                                uh at uh terminus tv so if you're                                interested in like graph database that                                can do git                                kind of things then talk to me                                afterwards or                                you will see my contact detail at the                                end of the talk as well um                                but i'm not going to talk too much about                                this because this talk is not about                                graph database                                next thing that i want to tell you about                                me is that i organize a lot of different                                uh events for the community there will                                be a pi data global conference                                in november coming up and also there                                will be another conference                                uh in december uh so both of them will                                be online uh                                you can join very easily by sitting at                                home just like now                                and also i stream on twitch um so if you                                want some more python content if you                                want a little bit more of me you can um                                follow me there and watch me weekly                                also there's another thing that we                                organized with pi data global                                is a humble data workshop what does it                                mean is that it's a python data science                                workshop for beginner                                it's free all you need is to get a                                ticket for pi data global which                                it's very affordable the minimum that                                you need to                                donate is                                             it's it's like yeah it's a it's                                i think it's it's very cheap compared to                                the previous uh                                conference i've been to at pi data so um                                but this workshop                                doesn't have any course on top and it's                                meant for beginners so if you know                                anybody or if you want to                                learn some data science uh with python                                then                                you can go to our website and find it                                out um                                so let's start this talk and i'm going                                to talk about python internal functions                                and this talk will mainly be shown                                in a jupiter notebook so it's gonna be                                live                                and uh so yeah so this is the jupiter                                notebook i know it's a little bit small                                so let me zoom in a little bit so you                                can see it a little bit better                                um i hope this is okay for you maybe i                                can zoom in one more time                                just to make it easier for everybody                                okay i hope that you can see it                                all right and uh if not maybe the host                                can                                kind of give me a shout okay so um                                so this is a jupiter notebook i hope you                                know like this just lets you do some                                python thing with it                                and um so you can see here if you have                                done it in the past that                                i have written a class in python and uh                                if you write a class then usually the                                first thing that you do is to write                                a done the init function so okay so what                                 is done                                 then there is something like this i                                 don't know whether you can see my                                 highlight here so                                 uh before the image so you start with                                 two underscore here's a two                                 of them and then so it's called thunder                                 because it's double underscores i think                                 someone very smart come up with this                                 name                                 i think is a brilliant name so thunder                                 it sounds funny as well um so then the                                 indie function is                                 something that like a lot of pythonistas                                 kind of like in the blood they're just                                 like okay whenever they write a class                                 first thing df done the init itself                                 okay so again like for all these methods                                 you see the first thing that i pass                                 into the method or function it depends                                 on how you look at it                                 because some people study data some                                 people study computer science they will                                 be like oh it's a method because it's a                                 binder function for class i don't really                                 care about names so bear with me                                 um so yeah the first thing that you pass                                 in itself so this means that you pass                                 in the object the instance of this class                                 itself uh here in this functional method                                 um so what is an instance of a class so                                 when you                                 create so when you have a class you can                                 create an                                 instance of a class and when you create                                 an instance of a class this                                 init will fire it will just get executed                                 so you can within it you can do some                                 like kind of                                 initial settings with this class                                 instances                                 and you'll see how it works later                                 because i put the print here so you see                                 whenever i call this init                                 thunder init function you will see this                                 got print out                                 so i just put a lot of print here just                                 to show you what is going on inside                                 okay so um after that look at here down                                 down here i have my print so my print is                                 just like your normal method right                                 i think you have already done it before                                 um so                                 it's just like anything here in this                                 like kind of                                 you know a binder functional method that                                 you have passed itself                                 and then you can pass in any parameters                                 that you want your user to pass in                                 so here you write a function usually as                                 a good practice you would write a dot                                 string here                                 i will show you why you would like to                                 write a dot string instead of                                 a comment afterwards as well there's a                                 benefit of that                                 so now this function is very just very                                 simple it takes in the user's message it                                 will just print it out                                 okay and uh but in my doctrine i                                 as a good practice i always tell people                                 what will be the parameter what are you                                 expecting from a user                                 and of course explain what it does by                                 the way this dot string                                 is called a numpy style dot string so if                                 you want to learn a                                 little bit more about how to write dot                                 strings and different style and all this                                 come to join us in the docs fringe i                                 would                                 actually have time to explain to you a                                 little bit more about those strings                                 but uh again i won't dive into the                                 detail here                                 um so after this two things right that                                 we are familiar with the done that you                                 need and my print                                 uh well we have something that is                                 slightly different uh we have                                 a um method a function that the name                                 starts with                                 an underscore so um yeah                                 is well what does it mean like why why                                 do you start with an underscore it looks                                 a little bit funny                                 well uh because this is an internal                                 function it's just                                 indicate that oh this function is not                                 meant for the user to call it                                 it meant for the developers to use it                                 within maybe doing some kind of internal                                 operation within this instance class is                                 supposed to be                                 you know providing itself some kind of                                 functionality because                                 well we all have experience that                                 sometimes the code get really big and we                                 want to                                 you know put a section of the code as                                 the function so                                 we can reuse them so it's more organized                                 so you could                                 look a little bit better so this is the                                 actually the purpose of this underscore                                 my phone is that                                 so it's providing for the other external                                 method that okay i have some helper                                 function here that's sitting at the back                                 seat that is not supposed to be you know                                 called by the user                                 of course you can still write a dot                                 string but it's less important here                                 because it's supposed to                                 only help the developers uh of course                                 you can still write it it will be                                 helpful for your fellow developers but                                 uh it's not super important like the my                                 print                                 okay so i also if you call it it will                                 just print out that okay this is                                 my function you shouldn't call it um                                 and then there's something that is                                 similar but slightly different                                 because it starts with two underscores                                 of thunder                                 instead of underscore so i just print                                 out this is a secret function you should                                 really not                                 call it you will see why in a bit                                 so okay i have planted a lot of seed of                                 like what                                 is happening here so let's have a look                                 so of course i can create an instance                                 but before that because it's jupiter                                 notebook i have to run the first cell                                 first                                 otherwise it's not a register in the                                 kernel so                                 yeah i've created an instance so my                                 object is an instance of my class and                                 i've created an instance yeah so                                 straightforward                                 and of course i can print out a message                                 yeah this is my message                                 this is something that you may have seen                                 before it's not too                                 uh unfamiliar so uh                                 here another thing so i talk about um                                 well why a dog string is a good idea is                                 that if you're using jupyter notebook                                 actually or actually or in your python                                 interface you could i think you may                                 are able to do that i haven't tried that                                 though but in jupiter notebook                                 you can do question mark and then put in                                 um you know                                 my print if it's a standalone function                                 you can call my print but because it's                                 part of my object i would just my object                                 not my print                                 and you'll see that oh what's going on                                 here um                                 there is something that is pop up this                                 is kind of like an internal dictionary                                 that you have written for your user so                                 even if they are let's say they are                                 coding on the plane i don't know why                                 um but you know if they don't have                                 internet access they can still look at                                 this documentation that you have put in                                 in the dock string so it's very handy                                 for your user especially you know                                 you shouldn't be expecting everybody can                                 google anything at any time right                                 because they have bad internet                                 connections so this is really really                                 handy                                 uh so especially when you're using                                 pandas uh you can do that as well you                                 can just like                                 pd dot read underscore csv you can put a                                 question mark in front and you will see                                 oh what you should put in when you're                                 reading a csv                                 so that's one thing i can close it as                                 well so go back to normal                                 and uh okay so now let's call myfunk                                 okay so of course the name is start with                                 an underscore i put it there                                 and i can still call it it just say that                                 oh yeah you shouldn't                                 call it uh because i put a prince there                                 and oops a little bit like                                 shaming here from the developer uh which                                 is myself                                 okay so um another thing so okay                                 i have called my phone i've successfully                                 called your internal function can i call                                 your secret function                                 well i'd call this done the function a                                 secret function so                                 uh it cannot it's a secret function so                                 um yeah so it's just i just get an error                                 from python saying like                                 oh it is uh there's no attribute secret                                 function                                 something's wrong so what's what's going                                 on where is                                 this secret function so let me introduce                                 you with a python                                 magic it's not magic it's just how                                 python works uh                                 it's this dir built-in function                                 that you can call on any instance of the                                 class or actually anything because                                 in python anything is like even a number                                 is an object so you can                                 have a dir object you know like what                                 whatever that it is                                 you can put a dial string there it will                                 still work i think                                 uh see if i can show that so this is                                 just                                 lip i didn't plan that but if you say uh                                 hello                                 here that yeah you can still put the out                                 in anything a string or a numbering and                                 put there out                                 one there you you'll still see a bunch                                 of things                                 um but i want to see what's inside my                                 object so i put the                                 out my object and you see here i have                                 my phone which is uh well that's why we                                 can call my functions because this is                                 part of the instance it's bind this is a                                 function that's bind to the instance                                 okay and my print as well                                 uh there are other things these are all                                 like it looks like the init                                 thing right start with a thunder and                                 with a dunder these are all default                                 um attributes that is bind to this                                 object so                                 for example sdr it just means that you                                 could change it into                                 a string representation um a dog                                 for a dog string so the indeed is here                                 as well so these are the things that we                                 are a little bit familiar with some of                                 them we rarely use so we                                 junction what they do but that's fine so                                 you see here this                                 is a very strange attribute here so                                 underscore my class done the secret                                 function this look                                 familiar but yet it's not something that                                 we have created right                                 so let's have a look so let's run this                                 weird                                 uh attribute so spoiler actually this is                                 a                                 binder function so again you can call it                                 like this um                                 yeah this is actually our secret                                 function um python                                 actually rename your secret function                                 something else so it kind of                                 uh stop people from you know maybe go to                                 github                                 and looking at your code and then see oh                                 there's a secret function and i can just                                 call it                                 no people can maybe do that with your                                 internal function with my func but                                 not this secret function so this is a                                 little trick that python do to just to                                 make this                                 a secret function a little bit more                                 secure so people can't just directly                                 call it by accident                                 um so uh this is very neat uh you can                                 hide something uh with your class that                                 really really like stop people from                                 calling it you can still call it with                                 your for example if you're my                                 uh if my phone is calling a secret                                 function                                 for example here if uh secret phone is                                 calling um                                 self dot uh sorry it's the other way                                 around so it should be                                 my phone is calling let's say self dot                                 uh secret uh sorry i just copy and paste                                 i'm so lazy                                 i'll just copy and paste here uh can i                                 call secret function in my phone yes you                                 can uh let me                                 just do this again and now if i call my                                 phone you'll see that                                 yeah it will call secret function                                 without problem we can just call it like                                 this                                 but uh in but outside you can't just                                 call it                                 like here you it still doesn't work i                                 just work in my funk                                 so yeah so it just locked the secret                                 function to be only used                                 internally not being able to use by the                                 user                                 by accident um so that's that's fun                                 shall we do something more sure um so                                 this is my list well it's a list that i                                 think of you know                                 if you have already have some experience                                 with python this is kind of like in your                                                                                                       object                                 in python so what is inside list so have                                 a look                                 and we can see all these things that you                                 have seen before                                 that is method that could be used with a                                 list you know append                                 an element in the list you know pop an                                 element from the list all this stuff                                 you know reverse it sorted whatever um                                 there are also other default things                                 that's supposed to be                                 you you won't call it directly but you                                 know again now you know all the secrets                                 so you can do that                                 um there's this get item so this is                                 quite unique                                 for a list object or actually any                                 sequential object                                 like you know um a dictionary or a                                 they all get this get item uh method                                 here                                 so let's play around with this one uh so                                 yeah my list the item what is this it's                                 actually                                 a function that you could call so how                                 about i call get item zero                                 uh give me one so actually it works like                                 this                                 so it's this first element of the list                                 right so one two three so the first                                 element is one                                 um and so basically                                 when you do this indexing thing so the                                 square bracket for a list                                 or a tuple and then this get item is                                 called                                 so let's do something funky uh i create                                 a                                 sequence class which is a not a normal                                 sequence class because i                                 well i do the same thing you know in it                                 and just say oh i create an instance                                 but this time i add the get item                                 and this get item again will take in an                                 integer                                 but it will just return the square of                                 the integer it doesn't make sense but                                 it's fun                                 so i created my sequent object                                 and then so this time actually i don't                                 have anything in this sequence right                                 remember i just indeed and just print                                 out create an instance i didn't                                 store anything or you know it's just                                 it's not like a list or triple or                                 anything                                 so but i can still use this square                                 bracket                                 and it will give me the square of                                   which is                                      square of                                                              is uh funky um so                                 for my list which is a normal list you                                 can have length right so one two three                                 the length is three                                 um how about my sequence well i don't                                 have it                                 it will give me an error because i this                                 is an artificial thing right i created                                 it doesn't have                                 the length thing there if you run a dio                                 then uh you can see hello so yeah                                 it's not here so you'll be able to see                                 it here if if i have it so                                 no um what should we do uh we could                                 create it                                 also so let's do something naughty so df                                 uh links and then self remember the self                                 this is a common mistake by beginners                                 uh return just put                                          uh yeah so why not uh so now i can call                                 length                                 uh oh i can't because i haven't run this                                 again okay now i can do it                                 and it would just give me                                     yeah this is uh yeah again naughty and                                 funky                                 uh and now you can see that uh it's here                                 length is here added because i edited it                                 myself                                 and um so another thing about list                                 or triple or dictionary that                                 um it's it's called an iterable it's                                 because there is a                                 method inside uh i don't know whether i                                 can show it here maybe i can show you                                 my list here so what's in my list you                                 will                                 be able to see there's an eater here so                                 this item means that                                 whenever i call an eater function on my                                 list                                 it should return something that is an                                 iterator                                 of my list so you can see that so now i                                 have the iter for my list which is an                                 iterator generated from my list                                 and if i call next on an iterator                                 o is one so what if i call it again oh                                 it's different                                 it's two what if i call it again so                                 three                                 okay what if i call it again okay not                                 this time i can't call it again                                 uh it exhausted itself so what happened                                 is that whenever you call                                 next it will just give you the element                                 of the list from the beginning to the                                 end                                 and when it reaches the end there will                                 be a a kind of                                 an error ish kind of thing that is                                 called stop iteration                                 that basically say that okay i have                                 exhausted i can't give you                                 next anymore um so uh                                 this is cool this is kind of like a for                                 loop right because like for example i                                 have a for loop here i put my list in                                 here                                 so one two three uh what happened in a                                 for loop                                 behind the hood is that whenever i write                                 something like this which is a for loop                                 uh what it does                                 is that uh it will call eater on my list                                 so it generates an iterator for my list                                 just like what i did here                                 and then x will just be calling next to                                 get the next value                                 in the iterator in my list um so i                                 printed out so it would give me one two                                 three                                 that's something that we are all                                 familiar with what about this my sequin                                 this naughty boy here                                 um of course i can't do this right now                                 because it's not                                 an iterator like i don't have the eater                                 i don't have next you know so i can't                                 really do this                                 this is not acceptable so what magic i                                 gotta do next                                 is that i gotta you know uh have fun                                 i gotta put in here the f um                                 so what i'm gonna do is that i will have                                 an eater first uh sorry                                 double underscore always because i'm                                 messing up with the default settings                                 so uh i would just you know return                                 myself as an iterator why not                                 uh so return self                                 and because i am returning myself                                 as an iterator so the characteristic of                                 an easter                                 iterator is that i will have next right                                 so i have to put next in here                                 yep so self                                 and i can return uh what do you like                                 what number do you like i feel like                                 seven is lucky so i'll return seven okay                                 so just return seven because it's my                                 lucky number why not                                 um yeah so let's try to create this                                 funky instance again                                 and well everything just works the same                                 right i can still do this thing i can                                 still have                                 length which return                                                      look at                                 my sequence you would see                                 um next is in here this is what i want                                 eater is in here as well this is what i                                 want great and                                 um this time i can connect my sequence                                 it will give me seven if i run it again                                 it will give me seven                                 uh well yeah it keeps giving me seven                                 and it will never stop and this is                                 scary because well if i put it in a for                                 loop                                 it will never stop i don't want to do                                 that so                                 let's create something that we could                                 stop so this time i really have to give                                 this um i really have to give this                                 sequence                                 somewhere to stop so let's take in an                                 end when i create it                                 and then i would just put self.n equals                                 to                                 n so i would just store this value                                 somewhere                                 and also i have to store another thing                                 that is a counter so                                 self account equals to zero so start                                 with zero and then when i call next what                                 happened is that                                 if this counter                                 is less than uh the self the n which is                                 the end of the                                 this sequence and uh                                 i will return seven okay so i'll just                                 return seven                                 it's a happy happy place you know just                                                                     otherwise uh so what should i do                                 is to raise a stop iteration                                 okay so uh let's try                                 to see if it works i'm missing something                                 yes                                 i am missing a an n here so this time i                                 have to put in something as n                                 let's put in three just to make it short                                 and simple so okay now i can create an                                 instance all these still work the same                                 it doesn't matter                                 what the length is it's just return the                                 square of it because this is how i                                 how i put it in and the length will                                 still say                                             well because this is how i said it but                                 this time                                 when i call next uh on my sequence okay                                 and dan oh                                 i've spelled it wrong sorry let me fix                                 it live coding curse okay                                 so now let's go back to normal and then                                 come back here and                                 uh run it so next it will give me seven                                 so this is the first time giving me                                 seven                                 second time it give me a seven third                                 time it gives me a seven                                 and the fourth time it still gave me                                 seven that's this is weird                                 this is not it's supposed to be oh i                                 know why because i forgot to increase                                 the counter                                 yep again uh live coding curse is always                                 something wrong with it                                 and i'm used to it that's fine don't                                 worry about me and then i would just                                 quickly                                 quite quickly run three times this thing                                 sorry about that it's a bit tedious now                                 and now yeah now it's stopped iteration                                 finally it                                 know how to stop so we can now put it in                                 a for loop uh                                 sorry sequ here and oops it's not                                 printing anything oh because i didn't                                 give back anything                                 right oh i know why because i have                                 exhausted myself so let me create a                                 instance again                                 yeah so three times the charm so uh                                 let's                                 let's create the sequence object again                                 so now it's refreshed                                 uh because previous previously i                                 exhausted myself so it was just like                                 okay it reaches the stop iteration                                 before already before i put it in a for                                 loop                                 but now i've refreshed so it should be                                 fine and it will give me three                                 sevens which is a very lucky number i                                 love it                                 and um yeah so this is the end of the                                 demonstration let's go back to the slice                                 and i only have a few slides to close                                 this talk                                 and uh so what is my thought on this                                 kind of craziness                                 uh so first of all about the internal                                 function and secret function                                 it's kind of like an option that you can                                 you can choose                                 as a developer that whether this                                 internal function is a kind suggestions                                 to tell your user that oh it's this is                                 an internal function                                 we are not expecting you to use it so                                 use it with a grain of salt and                                 the documentation may not be full so but                                 you can still use it if you know what                                 you're doing if you have look at our                                 code and you                                 you know this is open source right so                                 yeah look at our code and decide whether                                 you want to call it                                 or if something that i really have to                                 restrict                                 you to use it because this is super                                 dangerous you will you will mess things                                 up                                 badly um so yeah like i think                                 uh as a pythonista with some experience                                 i see most of the internal function are                                 just                                 single underscore not done there so i                                 think this is because                                 a lot of time we are writing code in                                 open source settings so                                 there's some openness there's some                                 transparency and we trust the user that                                 they will make their own decision                                 uh whether maybe develop they develop                                 some plugin                                 for our library then they may want to                                 call this underscore function                                 so yeah that's cool that's something                                 that i like and also                                 python is so flexible and yes so                                 powerful you see when i mess around with                                 the my sequence object                                 basically let you do anything so that's                                 why i love python                                 is that it's so easy for the beginners                                 to use because it's                                 hide all this complexity behind the                                 scene and                                 so beginners can pick up python and                                 start using it quickly                                 i think all of you must have already                                 experienced that but yet it is so                                 powerful that for a more experienced                                 user for advanced user they can                                 mess with all these internal settings                                 and basically they can do anything with                                 python so                                 this is so good and i really love it                                 um so my take on all this stuff                                 is that don't overlook the hidden beauty                                 of python                                 so yeah this is the last slide of my                                 talk and here                                 is my contact detail again so if you                                 want to know                                 anything about this topic or anything                                 about graph database you could talk to                                 me                                 you can basically find me on twitter or                                 anytime                                 you know um yeah so that's it                                 i think i have a little bit time to take                                 a few questions so if uh                                 if there's any that that would be great                                 sure it was a great talk we have a                                 couple of questions that i'll                                 uh read it out to you first question is                                 what is a binder function                                 uh okay so this is the the function that                                 i mentioned a little bit                                 so it's kind of um an attribute of                                 so when you create a class you create                                 all this like my func you know uh                                 my print and all this actually like they                                 are function that is fine                                 to an instance of a class so these are                                 all the                                 uh the functions that bind to it some in                                 some other programming language when you                                 learn it                                 they call it a method of of that                                 instance of of that class                                 so yeah it's just different naming but                                 in python because                                 instance of a class can have different                                 attributes so it could be you know                                 attribute as an object you know it could                                 be                                 a string an integer that you store like                                 the n and the count in my last example                                 or it could be a function a function is                                 also an object so it could be bind to an                                 instance of class                                 so the second question we have is how                                 can we use the dunder function if user                                 can't even call it                                 and where can it be called oh yeah so if                                 you remember my uh demonstration                                 so as the thunder secret my secret                                 function                                 can be called by my fun so it could be                                 called                                 by the the bind function                                 the method of the class itself so it                                 could be called by                                 its fellow method you know that sitting                                 inside the same                                 instance but it can't be called                                 outside so this is why this is a secret                                 function is                                 only meant for internal use not for                                 external use                                 and so far the most asked question is                                 where can the                                 oh you like the notebook okay                                 right so what can i do actually i've                                 given this talk before but                                 nobody really asked for the notebook but                                 what i can do is that i can put it on my                                 github repo                                 so you can see my github handle there so                                 uh today within today i would up                                 upload it to my github repo so if you                                 click on my repository you will find it                                 i think i would call it something called                                 python internal function or something                                 like that                                 so yeah just find on my github then                                 that was the last question and thank you                                 very much it was an amazing talk                                 and yeah have a good day                                 yeah thank you so much and enjoy the                                 conference
YouTube URL: https://www.youtube.com/watch?v=hQh9tyRfEKs


