Title: Lightning Talk:  What should you NOT miss when deploying Python apps to Kubernetes - Nabarun Pal
Publication date: 2020-12-03
Playlist: PyCon India 2020
Description: 
	This talk was presented at PyCon India 2020 Online.

PyCon India is the largest gathering of Pythonistas in India for the Python programming language. The 12th edition of PyCon India took place online from 2nd October to 5th October 2020.

Click here to subscribe to the PyCon India channel: https://www.youtube.com/user/inpycon?sub_confirmation=1
Follow PyCon India on Twitter: https://twitter.com/pyconindia
Follow PyCon India on Facebook: https://www.facebook.com/PyConIndia/
Captions: 
	                              hi folks                               uh i'll go in just a bit faster here                               so i talk on what you should not miss                               when deploying python applications to                               kubernetes                               and i hope my audio is fine and you are                               able to see                               see the slides uh i'll not waste time on                               introducing myself i'm just a random                                person                                uh in the dev community                                so first advice that i have uh when                                giving like when running python                                applications and kubernetes is never                                run containers as a route there are a                                lot of security issues that                                you may encounter when you run container                                search root                                uh people may do exploits                                uh in kubernetes you can enforce the                                same using a                                context called bot security context and                                then you can specify which user to run                                is you can specify which group to run is                                and then                                you can also say what file system mask                                do you want to provide                                to the container so any volume which is                                mounted to the container will be                                masked according to that the next advice                                is                                always put resource request limits for                                your application                                uh this is very important because if                                your application                                somewhere behaves weirdly and then you                                float your quota of resources this may                                result in exhaust                                like preemption which you may not want                                and that preemption may be very                                unpredictable                                to do that in kubernetes while defining                                a deployment you can say that hey                                my workload takes only                                uh                                                      and                                                      cpu fractions are weird but they are                                existent uh                                you can also say that hey it is expected                                that my application would take                                        of memory                                but it can take like                                                 goes                                up to                                                                  kill the                                process advice is always perform                                lifestyle checks using probes so                                kubernetes has two beautiful things                                called health checks                                uh liveness probes readiness probes                                uh you can think of them as similar to                                watchdogs that you can define                                in kubernetes you can specify several                                kinds of                                probe types so you have a tcp probe                                which                                actually pings the port and sees whether                                any traffic goes to the port or not you                                can also do an http request which                                actually                                queries that path which you specify and                                checks whether the                                request returned is                                                  the response code                                if it's not                                                          then you can specify somewhat tuning                                parameters like how frequently uh the                                probe should work and then                                how many pro failures should actually                                result in a failure that's called                                failure threshold                                you can also say that hey my application                                takes a certain amount of time to boot                                up                                let's not do health checks uh before                                that so you can specify                                initial delay so here is an example                                again you have to put it in your                                deployment manifest                                the next advice is always handle                                sickness properly                                kubernetes expects your applications to                                actually handle all                                os signals so when when you try to kill                                a kubernetes workload i'm talking in                                terms of workloads because there are                                several kinds of workloads and i want to                                extract it out                                for the short session uh when                                 you want to handle signals you have to                                 handle two specific signals signal                                 signal                                 uh you don't need to just like check for                                 sequel it's just like hey                                 you're gone no no more chances                                 you do have to check for sector when it                                 is always advised                                 that you trap that signal somehow and                                 finish all the work that the app is                                 doing kubernetes provides something                                 called termination grace period seconds                                 what this means is it may look like                                 really big uh                                 chunk of word but then what it means is                                 it it is the time difference between                                 when the sikh term is sent                                 when the process is asked to hey can you                                 gracefully terminate                                 and sick kill which is like hey i can't                                 run you anymore                                 so if you have a very important                                 application you                                 should actually trap the signal and then                                 finish all your pending work that you                                 have and                                 save state to database uh sorry for the                                 capital d                                 uh probably that's the type on my side                                 uh it should not happen in my                                 beautiful code uh any questions i'll                                 take in the chat                                 and that's all on my presentation you                                 can also dm me on twitter the only                                 number one                                 uh thank you also a shameless plug                                 tomorrow i have a workshop                                 on kubernetes uh in the second time slot                                 and                                 it revolves around majorly this kind of                                 topics how do you                                 resiliently deploy python applications                                 to kubernetes thank you thank you
YouTube URL: https://www.youtube.com/watch?v=o9NcWkhvLuA


