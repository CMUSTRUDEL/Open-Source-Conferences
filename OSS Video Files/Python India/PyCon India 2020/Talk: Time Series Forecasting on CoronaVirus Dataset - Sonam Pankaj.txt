Title: Talk: Time Series Forecasting on CoronaVirus Dataset - Sonam Pankaj
Publication date: 2020-12-03
Playlist: PyCon India 2020
Description: 
	This talk was presented at PyCon India 2020 Online.

PyCon India is the largest gathering of Pythonistas in India for the Python programming language. The 12th edition of PyCon India took place online from 2nd October to 5th October 2020.

Talk Detail: https://in.pycon.org/cfp/2020/proposals/time-series-forecasting-on-coronavirus-dataset~b2jAb/

Click here to subscribe to the PyCon India channel: https://www.youtube.com/user/inpycon?sub_confirmation=1
Follow PyCon India on Twitter: https://twitter.com/pyconindia
Follow PyCon India on Facebook: https://www.facebook.com/PyConIndia/
Captions: 
	                              hello everyone                               thank you for joining my session on time                               series forecasting youtube                               using chronovirus dataset so a little                               bit introduction about me                               i'm sona pankaj and i'm working as a                               software lead                               and i was also an ex-visiting faculty                               for robotics and computer vision                                so a little bit content and today's                                agenda                                so today we will be discussing about                                exponential growth in epidemic                                so why it is important we will be going                                through exponential growth because it is                                tough for                                human mind to intuit exponential growth                                uh history of pandemics be because the                                talk is                                related to karuna virus uh so i thought                                of maybe                                we should go through the history of                                dynamics flattening the curve                                why uh social distancing and masks are                                important why it is important to                                take care that uh the coronavirus                                doesn't spread as much as                                it is metrics for prediction so                                uh there are various met we will be                                using various algorithms we will be                                seeing how they are performing                                so uh we have to define one matrix to                                understand which one of them is                                performing well here we will be using                                rmse                                but you can use any other metrics                                so understanding difference between                                prediction and forecasting                                oftentimes people are uh people are                                confused between what is prediction and                                forecasting                                and we will be looking into different                                algorithms of forecasting machine                                learning non-machine learning and                                some other algorithms                                so let's get started so if i ask you                                a question about if there's a water lily                                in a pond and it doubles its population                                every day uh at what day it will reach a                                population of one thousand water delay                                so you have to think exponentially will                                it be week one uh                                will it be a week two thirty days                                so the answer is ten days                                so it will take ten days for that one                                waterlily                                to reach from a population of one to one                                thousand                                so little bit uh history of pandemic so                                uh you know that pandemics are not                                new things and throughout history there                                have been many cases                                like the black death which wiped about                                                                                                   smallpox was also considered as pandemic                                before its                                vaccine was discovered so uh on                                                                                                 coronavirus                                uh death toll has reached over one                                million uh                                                                                                       researchers at uh john hopkins more than                                                                                                      and                                that there could be more cases                                uh so while flapping the curve was                                important we we                                read a lot about this jargons and media                                flatten the curve                                so if we allow uh the disease to spread                                at                                its natural are not rate its natural                                reproductive rate                                it will follow this red curve and this                                red curve                                is your exponential curve                                it will take that red curve and so                                people will                                be affected so much that it will surpass                                the medical facilities that the country                                has                                so to keep the growth lower uh to keep                                attention on every patient it is                                important that                                uh the the confirmed cases follow the                                logistic curve                                so that we still have enough facilities                                to provide enough mass or maybe enough                                 ventilators                                 so the metrics to measure the                                 performance                                 there are various matrixes error which                                 is forecast                                 minus actual your mean square error your                                 root mean square error                                 and your mean absolute error we will be                                 using rmse                                 rms is a quadratic scoring tool that                                 also measures                                 average magnitude of the error it's a                                 square root of average                                 of square differences between prediction                                 and actual forecast                                 so what is prediction and forecasting                                 you have collected the data if you have                                 performed prediction on                                 if you are predicting some values on                                 that                                 then it is prediction but if you have                                 uh if you are performing prediction                                 on the future datas on the future                                 timeline say five days ahead                                 then it is forecasting so what is                                 prediction forecasting if                                 uh till that time you have collected the                                 data if you are performing                                 if you are predicting values and that                                 then it is prediction but if you are                                 performing prediction                                 after that then it is forecasting                                 so the algorithm today we will be                                 discussing is                                 a knife forecasting moving average uh                                 linear regression                                 machine learning algorithms like linear                                 regression                                 uh support vector machine uh neural                                 network algorithm like lstm                                 long short term memory which is a                                 special case of recurrent                                 uh neural network and then your profit                                 and error                                 so what if we see a series which is full                                 of white noise okay                                 uh if we want to perform live                                 forecasting on that                                 and what is knife forecasting it is                                 nothing but                                 taking a previous data and appending on                                 it                                 so you can see it's just over fit or                                 over relying on that actual curve your                                 blue line                                 is your actual data and your orange line                                 are your predicted data                                 so you can see it is just over fitting                                 that                                 and if you want to get into the code                                 it's like                                 appending the series but one unit later                                 so that is knight forecasting uh                                 if you do it on corona virus second set                                 it looks like something like this                                 so you you see uh this it's nothing new                                 it's just                                 super imposing on that actual graph so                                 that's my knife forecasting                                 now we move on to moving average so                                 in moving average what happens we try to                                 find the mean                                 of the we try to find the mean of the                                 data                                 and try to forecast it five days later                                 so if you see the code of moving average                                 we have its same series plus                                 a window size hello i think there is a                                 delay in                                 uh you're just switching the slides and                                 that's what people are talking about                                 [Music]                                 yeah so if you see the code difference                                 between live forecasting and moving                                 average                                 you will see there's a window size                                 available over here                                 so this window size is the number of                                 days you want to predict in the future                                 maybe five days maybe                                                   want to predict                                 on a plot a graph on the coronavirus                                 data set                                 it looks something like this your blue                                 is your actual line and your orange is                                 your predicted line                                 so you see there's a distortion over                                 here so this                                 distortion is the same as the window                                 size you have                                 applied over here uh it is following the                                 trend                                 but we cannot say is we still cannot say                                 it is forecasting                                 and uh there is a lot of difference                                 between what actual is and                                 what it has predicted so let's move on                                 to the machine learning algorithm and                                 see how they are performing                                 so the first machine learning algorithm                                 is your linear regression                                 uh if we want to                                 uh so if we want to uh vector like                                 in a vector form if we want to uh say                                 what is linear regression that                                 then it is theta t theta transpose                                 dot x where theta is a parameter and x                                 is your data                                 if we graphically want to know what is                                 linear regression                                 then it can we can say that a line which                                 is                                 going through maximum number of points                                 so here                                 the red line is the linear regression                                 line and your blue dots are your data                                 sets                                 now how we train the linear regression                                 model so to train linear                                 regression model you need to find the                                 value of                                 theta that minimizes the root mean                                 square                                 error so here what we are doing we are                                 tweaking theta                                 x and y are your data sets we are                                 tweaking theta so that your                                 minimum square error minimizes                                 so training a model means setting its                                 parameter so that the model fits the                                 training set                                 now if we want to code the linear                                 regression                                 uh we can take great wise data sets from                                 the confirmed                                 data sets days device and                                 confirm cases then we can divide the                                 data set into training data set and                                 valid data set                                 and then we can import the library of                                 linear regression from sklearn                                 there is a sqlr library called just                                 linear regression                                 now what we can do we can just fit the                                 uh the points of days and confirm cases                                 so the the fitting has been done linear                                 regression dot                                 fit now if we want to predict where we                                 will predict                                 we will predict in the valid machine                                 learning days                                 so the graph looks something like this                                 you want to perform the graph                                 so your actual uh cases are your blue                                 lines and you can                                 predict it confirm cases your is your                                 black line                                 so still we can see it is trying to pass                                 to the maximum number of points                                 but there's still a lot of difference                                 between what actual case is and what                                 predicted value came out                                 so let's make it uh let's make it a                                 little bit complex                                 from linear regression we can move on to                                 your                                 curve fitting or uh like we can increase                                 the order                                 of the line                                 so for that we can use support vector                                 machine so support vector machine works                                 in the hyper clean level                                 now what is hyper plane so hyper plane                                 uh                                 to understand hyper plane we have to                                 understand what is line                                 and plane so line is a                                 so line is a point with the direction                                 and what is plane                                 a plane is aligned with the direction so                                 now what is a hybrid plane                                 is n minus one direction in n vector                                 spaces                                 so it's not only one line it is spread                                 across n                                 minus one directions now if we talk                                 about support vector machine                                 so every neural network has one node so                                 every node represents                                 a kind of support vector a kind of                                 hyperplane                                 support vector has three steps to follow                                 i'll get into each every step the first                                 step                                 is to maximize the distance between your                                 hyperplane                                 and your points so support vector so                                 whenever there is coming to be one point                                 and                                 the hyper plane you have to maximize the                                 distance                                 the second point to consider is to                                 minimize the number of misclassification                                 so whenever there is misclassification                                 happening                                 uh between positive and negative points                                 you have to minimize the distance                                 between them                                 the third point is taking the points                                 in the three dimension so if you see                                 there's a non-linear                                 distribution of data you cannot                                 differentiate with a line or a plane                                 so you can project it in                                             we can see a demo over here                                 if we want to differentiate it we cannot                                 differentiate it                                 basically without projecting so we just                                 project it in the                                 three dimensional now we can easily                                 classify them with the plane                                 so now if we have to code support vector                                 machine                                 uh it's a very good search cv is a                                 sql library so you can easily import                                 that                                 and you can initialize the svr model                                 with a hyper                                 uh parameter so these are the hyper                                 parameters                                 your kernel so uh the the projection of                                                                    into                                                                     trick                                 so you have to define what kind of uh                                 white kind of differentiation it will be                                 following it will be linear                                 or calling c is your regularization                                 function                                 so regularization is a parameter is for                                 uh stopping exploding or vanishing                                 gradient                                 so yeah you you cannot you can keep them                                 default                                 so even if you leave them uh the library                                 will take some numbers by default                                 uh yeah so here you can see your grid                                 search cv                                 you just give an estimator that you want                                 to perform that is svm support vector                                 machine                                 and you give your cv                                            validation number                                 uh then you fit the points between                                 training uh                                 training uh training days and confirmed                                 training uh the the test uh the training                                 set that we formed                                 was training and validation so whenever                                 we are fitting the curve                                 we have to do it in the training uh data                                 set and                                 whenever we are predicting we have to do                                 it the well in the value data set                                 so here we have taken training data sets                                 of days and confirmed cases                                 uh we have performed the best estimator                                 we have given                                 all the parameters that it might need                                 and then we predict in your valid                                 machine learning                                 data so what we see                                 through the plot is it's for far                                 better than linear regression it is                                 following the trend                                 as well as accuracy is also good                                 but we are not sure that in future it                                 will be                                 performing this well to overcome                                 that we can go into neural networks                                 okay now we can go into neural networks                                 so why rnn we have chosen uh                                 rn in one second so either                                    enables us modern time dependent and                                 sequential data tasks                                 such as stock market machine translation                                 text generation and many more so suppose                                 there are two sentences                                 beer girls runs a show and run away from                                 the bear                                 in both the sentences beard is different                                 it is a person and an animal but unless                                 and until we reach to the first stop                                 we are not able to find which pair it is                                 referring to                                 so rnn cannot work until you have given                                 the whole                                 uh data set to be a whole sentence to be                                 given or whole data sets                                 so however our rnn suffers from a                                 problem of vanishing gradient so we will                                 see what                                 problem are iron and performing so this                                 is the basic                                 architecture of rnn you can see at                                 every unit there is input there is                                 output there is activation function                                 going from                                 each cell to another                                 one second so this could perform                                 a better prediction but there's spanish                                 ingredient problem                                 now what is vanishing gradient uh so                                 vanishing gradient hampers learning of                                 long data sequences                                 where wherever there's elongated                                 sequences there will be a problem of                                 vanishing gradient                                 the gradients carry information used in                                 the rnn parameters                                 update and when grading becomes smaller                                 and smaller                                 the parameter updates become                                 insignificant                                 which means there is no real learning is                                 done                                 what does this mean this means that                                 whenever we                                 uh perform a learning in the neural                                 network there is some kind of                                 loss coming at a via neutral network                                 and we need to back back propagate it so                                 that we can divide the weightage                                 amongst the neural network but in                                 ireland what happens when you back                                 propagate it                                 uh the error becomes so insignificant                                 that nothing uh that there's new new                                 learning happening in the initial neural                                 networks                                 so because these sequences are so long                                 uh the the error is not reaching to the                                 initial                                 uh networks so that is the whole problem                                 of                                 vanishing gradient and how do we                                 overcome the vanishing gradient                                 we overcome by using units of phallus                                 steam                                 now what is lstm long shirt long short                                 term memory                                 so what happens here is learning                                 is happening at every unit and every                                 unit                                 is for getting updating some points                                 from the error so an lst network has                                 three kids that update and control the                                 cell states                                 these are forget input gate and output                                 gate                                 and the gates are using hyperbolic and                                 tangent function                                 to keep the activation function afloat                                 so keeping the error                                 so that it doesn't become insignificant                                 there is activation function going on                                 so the forget gate controls what                                 information in the cell state to forget                                 the input gate controls what information                                 will be                                 encoded in the next cell and the output                                 kit control what information encoded in                                 the cell                                 is to send to the network as input in                                 the following time steps                                 so you can see the various gates and                                 what are they doing here                                 uh they all are they all are giving one                                 uh                                 activation function and they all are uh                                 for getting some insignificant data and                                 remembering uh some important data so a                                 memorization is happening at                                 every step so it's very easy to                                 code a lstm you can import a keras model                                 in the sequential form and you can give                                 two layers of lstm                                 over here and then two layers of your                                 activation function                                 remember uh providing active activation                                 function is important here to                                 minimize your vanishing gradient                                 vanishing gradient is happening because                                 the loss is getting smaller and smaller                                 so activation function is always                                 important to keep it uh                                 becoming insignificant you can give an                                 optimizer over here                                 stochastic gradient descent you can                                 compile                                 uh the whole model you can give what                                 kind of                                 metrics you want optimizer loss                                 functions you want                                 and you can just fit the data so                                 uh while making the plot                                 uh you can just forecast save the                                 results                                 append the forecast and make it                                 in the form of results and it looks                                 something like this so here you can say                                 it is also following the trend and it is                                 kind of                                 uh maintaining a minimum distance from                                 the actual and the predict                                 like there is a minimum distance between                                 them                                 so after that uh still we can say                                 that it's uh it's it's better than the                                 previous algorithms                                 but uh we can still make it better                                 so for now we can use aroma                                 so in adama you can use stats model                                 statsmodel.tsa that that is from where                                 you                                 get imported you can                                 fit you can make the series you can fit                                 and you can predict on the valid states                                 and then you can see the plots so here                                 you can see                                 the model prediction set                                 and your validations that are quite uh                                 like very accurate and it is also                                 following that trend that it should                                 uh now something about profit                                 so profit is a library of facebook uh                                 so you can import it from fb profit                                 import                                 profit now you can make the fit                                 profit dot fit and then you can give the                                 data of your                                 every way device confirm cases and days                                 and you can predict uh using forecast c                                 here make future data data frames                                 uh if you if if you plot it it looks                                 something like this                                 so your thought blacks uh black dots are                                 your predicted and                                 blue are your actual data set so now                                 uh we will con we will compare                                 all the algorithms so moving average                                 perform rmsa is                                        linear regression                                                      machine perform better                                                                                    rmr                                                       so clearly the winner on this data set                                 is avima                                 and thank you so if you need any                                 help you can contact me through the                                 email i get                                 the codes are available at my github                                 account sony pankish                                   and you can follow me on twitter at the                                 red banker                                 thank you everyone uh i am open for the                                 questions                                 or i will be available through this                                 have yeah some questions so one of the                                 things is uh i think                                 some comments here are uh like i                                 understand where they're coming from                                 but um the thing is the audience here is                                 a bit                                 uh wider than um                                 what individual people are expecting it                                 to be                                 all right okay uh i can take the chats                                 uh                                 i mean if there's more doubts i can take                                 it on that                                 right right no i i was trying to make a                                 point here                                 so i i um i request                                 people to be a bit more diplomatic in                                 their                                 uh chats comments right because the                                 audience here is wider than an                                 individual                                 and the second thing is whatever you                                 have please                                 phrase it constructively it is not                                 helping                                 okay so one question that                                 seems to come up is that is the training                                 set                                 and i feel like people feel like there                                 is a bit of                                 information that is still required so is                                 there                                 is there some more notebooks that you                                 have that                                 might provide more information on this                                 because i understand that                                 given the time constraint uh this topic                                 is a bit wider than                                 what you can have so                                 there are more references you can                                 provide                                 yes references uh uh i mean you can go                                 on my github                                 there are data sets available over there                                 itself                                 uh the data sets i have taken is from                                 canva                                 uh confirmed coronavida status                                 all of you will find information there                                 surya prakash                                 asks how to use multiple variables in                                 arima                                 multiple variables                                 yes one second                                 this was univariant so uh                                 if you want to import it uh there's just                                 one one second                                 so here it was the valid set that was uh                                 being predicted so here that everything                                 is univariant                                 uh i i'll take it offline and maybe i'll                                 get back to him sure sure okay                                 then uh thank you for the talk uh cn uh                                 and other people                                 should be available on july for                                 questions                                 on the uh yeah any stage um                                 so cnn asks what was your learning from                                 testing out                                 all these different models is that a                                 question is ending up now                                 yeah so the learning is parameters                                 uh you can you know                                 always try to find what problem                                 uh you are like uh how to                                 make it better every time so suppose                                 linear regression was not performing                                 well i can                                 take it to uh to other algorithm like                                 svm or i can take it to neural network                                 so uh i didn't use cnn here because i                                 knew that                                 it might not be the right choice of                                 algorithm                                 so choose algorithm according to the                                 question because it's a data sequential                                 question                                 question you can use rna easily and iron                                 will give you the right                                 kind of like answers because iron                                 is performed uh basically better in that                                 kind of question so uh choose algorithm                                 accordingly                                 and uh whichever is better for that                                 particular scenario                                 right okay and uh somebody says                                 the code is not there on github can you                                 please make that accessible                                 um i think there are a lot of questions                                 you see and you've also asked                                 like what are the other options compared                                 to arima i don't know some forecasting                                 techniques as well i can make that                                 available                                 in the chat um yeah sir                                 feel free thank you yeah                                 yeah that's what i'm going to bring you                                 down from the stage but thank you so                                 much for presenting                                 sure thank you                                 you
YouTube URL: https://www.youtube.com/watch?v=74aGOTlsYKY


