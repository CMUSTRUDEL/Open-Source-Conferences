Title: Virtual EmberConf 2020: Talking to Your Dog with Ember by Robert Wagner
Publication date: 2020-03-26
Playlist: EmberConf 2020
Description: 
	Talking to Your Dog with Ember by Robert Wagner

Have you ever wished you knew what your dog was saying when they were barking? Now you can! We'll use Ember and the Web Audio API to decipher different dog barks and translate them into something more meaningful.
Captions: 
	                              [Music]                               hey guys I'm Robbie Wagner and today I'm                               gonna be talking to you about talking to                               your dog with ember so Who am I I'm CEO                               of shipshape we're a Ember consulting                               company that also does other various                               JavaScript things as well any kind of                               apps you might need we're always around                               to talk to ember if you want you can see                                my email there is Robbie shipshape Dao                                feel free to shoot me a line                                always happy to check also on the Ember                                learning core team and written several                                ember add-ons you might have used ember                                math helpers and amber Shepherd or some                                of the more popular ones Shepherd is a                                site tour an apt or library that lets                                you have users check out all your                                features and show them how to use your                                app and a huge part of my life is I love                                all dogs you can see me here on the                                couch with Odie and his uncle socks just                                chillin Odie has an Instagram O'Neil a                                Frenchie so if you're so inclined to                                follow him check it out some good stuff                                on there and I'm RW Wagner                                          much everywhere across the internet so                                Twitter github anything like that feel                                free to drop me a line any of those                                places as well so the motivation behind                                this talk is I always thought it would                                be cool to understand what ot                                    barking about and he barks a lot he                                barks that people coming in the house he                                barks at his ball which you'll see here                                playfully and all of them are just crazy                                random barks sometimes and you don't                                know what he's doing so here's an                                example so as you can see he squeaks his                                toy and barks along with it like he's                                singing or playing or something here so                                gonna give you a brief demo of our                                prototype here it's built in ember on                                octane of course using glimmer                                components all that good stuff                                so the site is wolf that plus and it                                supports both file uploads and                                microphone input so you can go to file                                upload and you can upload the same video                                that I just showed you with the                                squeaking of the toy and you can see it                                results in a playful result so what                                about something that's less playful                                how about hoodie barking at the mailman                                dropping mail through the slot so this                                one says alert your dog maybe alerting                                you to a potential problem or intruder                                nearby so you can also use microphone                                input because it's not super practical                                to have an audio or video file handy all                                the time so you can hit start recording                                here and you can see that it says this                                is a greeting if there's one spike bark                                instead of for a long bar so it's                                frequently in greeting and the code for                                this is all open source it's on github                                would love to have some people                                contribute to it with us help us make it                                better it's all amber all web audio api                                as well check it out give us some                                feedback hope to work with you                                so back to the idea for this talk I was                                sitting around with Chuck our CEO oh and                                we were talking about the Ember cough                                CFP that had just opened up and what                                ideas we could submit for talks and this                                immediately came to mind because Chuck                                had just met od that day and he had had                                lots of different marking encounters                                with him both aggressive and playful and                                saw all the different signs of OD sparks                                and we were just thinking wow it would                                be nice to be able to decode these and                                you know kind of talk to him and know                                what he's thinking so that was the idea                                for the app so the process was to first                                investigate Web Audio API which is an                                API for working with audio and video and                                JavaScript and then determine different                                dog bark types and studies have shown                                that both dogs and humans can tell the                                difference between several different                                bark types and even different ones from                                dogs they know and are familiar with                                versus others so there's definitely                                something to these barks that is in the                                data that we could get out and decipher                                to try to determine what the different                                meanings are but the problem is never                                 used Web Audio API before and not really                                 sure if it does exactly what we need or                                 how to use it to get the data we want                                 out let cetera so first thing we do is                                 Google it to see if it'll work so I                                 googled Web Audio API analyze sound and                                 got a lot of good stuff actually there                                 were several real-time analysis examples                                 and of course the official docs from                                 Mozilla and some Stack Overflow posts                                 that kind of helped explaining what the                                 docs were talking about because they're                                 a little terse and helped connect that                                 with the examples and really give me a                                 better understanding of the types of                                 things that Web Audio API could even do                                 so some of the things it does do                                 the main thing we were focusing on here                                 because we're analyzing sound is                                 appropriately named the analyzer node                                 and the analyzer node at its core just                                 lets you get frequency and time domain                                 data now frequency is essentially the                                 pitch the higher the frequency the                                 higher the pitch and the time domain                                 data is the wavelength which the higher                                 the amplitude or the top of the wave the                                 louder it is so time domain waveform                                 amplitude all mean basically loudness so                                 there's two methods to get this type of                                 data from your audio or video files and                                 they're appropriately named gift by                                 frequency data and get by time domain                                 data and these both give you similar                                 data that's an array of numbers telling                                 you the decibels or wav values of your                                 frequency and time domain data and it                                 does a lot of other fancy stuff too that                                 I didn't fully understand like lets you                                 use fast Fourier transforms stuff like                                 that but basically that just lets you                                 set how many samples of data you want to                                 get so your frequency bend count is half                                 of that and that says I want X number of                                 samples from my audio so for my first                                 attempt I was kind of naive and I                                 thought I've heard of video and audio                                 elements in HTML so maybe we should just                                 use that and populate the source with a                                 video or audio file and that is                                 supported by Web Audio API and there is                                 a method create media element source                                 which basically lets you take source                                 data from and honey over video file and                                 use that in Web Audio API the problem is                                 it has to be playing when you use the                                 methods on it or it's not going to get                                 any data and you have to call it a whole                                 bunch of times make sure it's playing                                 start stop do a bunch of different stuff                                 to get all                                 the data you actually need from the                                 source it also was only giving frequency                                 data at first I wasn't really sure if I                                 needed frequency or wavelength or what                                 they did differently and so the                                 frequency data I was getting was only                                 while the file was playing I would take                                 a small sample of frequency data which                                 would basically just tell me the pitch                                 of a tiny tiny little section of the                                 file which isn't super helpful for                                 determining dog barks and types so these                                 small data snippets weren't super useful                                 and even when we got them and they were                                 reliable data wasn't really sure how to                                 use that data to its fullest potential                                 so I did some more googling played with                                 the API some more tried to figure out a                                 better way to do this so the thing I                                 learned from attempt one to attempt to                                 was playing the file while you're                                 analyzing it is not ideal because you                                 don't want it to just be playing the                                 whole time and say it's a twenty second                                 final you have to wait                                                   to finish playing to fully analyze it                                 it's just kind of clunky and not my deal                                 so Web Audio API gives you a thing                                 called offline audio context which is                                 much better because then instead of just                                 playing the file and taking little                                 samples you can load the entire file                                 into a buffer and then you can take that                                 buffer and use get by time domain data                                 so you're basically getting the loudness                                 of your sample across time and you do it                                 for the whole thing for the whole buffer                                 so then you can see where it spikes                                 there are barks potentially because it's                                 spiked which means it's louder so there                                 might be a bark there we also hooked up                                 the ability to upload files using a                                 really helpful add-on umber file upload                                 and it makes it super easy to upload                                 files to drag-and-drop to upload files                                 all this good stuff and we also built in                                 the ability to use the microphone so you                                 can use getusermedia to get the                                 microphone data and started exploring                                 visualizations heavily borrowing from                                 this visualizing audio series that has a                                 lot of great examples showing how to do                                 a bunch of these different things I'm                                 going to show you a little bit about                                 what we've been doing to do some of this                                 stuff so everything is a glimmer                                 component and the audio capturer as I                                 just mentioned uses this getusermedia                                 method so basically this thing just uses                                 a built-in method grab some audio from                                 your microphone and passes that into the                                 audio analyzer so on the flip side you                                 can use the audio uploader which is                                 basically just a wrapper for Amber file                                 upload and it's gonna do the same thing                                 when you add a file it's gonna pass all                                 that data to our service and the service                                 is where the magic happens it's this                                 audio analyzer service and it is                                 essentially just rapping vanilla                                 JavaScript so there's no crazy stuff to                                 do here that's amber specific or                                 anything that would trip you up it's                                 essentially you can just tie all these                                 things together in the various                                 components into this one service and get                                 a nice neat package that amber provides                                 to help wrap this thing we're doing here                                 and the magic is this analyze audio                                 function which takes the thing I just                                 mentioned the offline audio context                                 which is just a fancy way of saying we                                 have a buffer of audio and                                 we want to take that audio and pass it                                 into a function while it's being                                 processed so that we can get the data                                 out that we need to determine the dog                                 works and that's provided down here so                                 you can see as it's processed we do some                                 different things to get data album and                                 we'll talk more about those later so the                                 next part is actually figuring out dog                                 bark science and I am NOT an expert in                                 dog parks this project is based off of                                 several different scientific studies                                 where they are experts in this but it's                                 based on my personal interpretation of                                 these results so if you find anything                                 that's not super accurate please let me                                 know we would love to keep improving it                                 so these studies that I mentioned they                                 found that dog barks are somewhere in                                 the                                                                  shelters they just measured out Poteau                                 dogs barking as shelters got that data                                 and they also determined that all breeds                                 have some part of their bark that's in                                 the                                                                   can be sure that within those ranges and                                 somewhere in the                                                         from about five meters away is all kind                                 of the spectrum of dog bark data and                                 anything outside of that can be mostly                                 thrown out so there are three to four                                 buckets of bark types we're gonna focus                                 on for this project and the first one is                                 more of an alert style bark which could                                 be rapid barking at a mid-range pitch                                 and it can signal to the pack that                                 there's a problem and what the pack                                 leader to come check it out or maybe                                 there's an intruder coming in or things                                 like that then there are happier ones                                 like greeting or playful so it might be                                 one mark for a greeting or for playful                                 it could be like stunner bark or                                 various different happier parts and for                                 distress barking that kind of is a broad                                 category for now but it kind of would be                                 if they're lonely or in need of                                 companionship or even if they were hurt                                 or scared or things like that but even                                 with just these few buckets and the                                 small amount of data that we have there                                 seemingly infinite combinations of                                 different nuanced dog bark types so                                 we're just gonna focus on these as broad                                 categories for now so as I mentioned                                 dog barks are only in the                                             Hertz range so anything above that we                                 can go ahead and take out because we                                 don't need that anymore                                 we only care about the stuff in the                                 range that a dog bark could be in so                                 once we know the limit of pinches                                 essentially they're from the frequency                                 we want to find wearing spikes so if                                 there is a spike we know and going                                 probably barked there so if the loudness                                 goes up really sharply and then Falls                                 and then there's another really sharp                                 loudness because soon maybe there's two                                 barks there so we're gonna take all of                                 the data from that and essentially get                                 the averages or the modes also sometimes                                 of these things to decide whether it's a                                 low mid or high-pitched bark and then                                 we're gonna take that data and map it                                 further to determine how many barks                                 there were and exactly the nuanced                                 meaning behind the mark so we've talked                                 a lot about vanilla JavaScript and the                                 Web Audio API here and that's by design                                 this what we use the most other than                                 this but I think it really shows that                                 ember can shine as a great building                                 block and starting point for projects                                 like this pretty                                 anything you want to do can be built                                 into ember and ember has strong                                 conventions that help you structure the                                 way your files are laid out and has                                 things like add-ons that you can install                                 which make working with different                                 functionalities super easy you don't                                 have to worry about all the plumbing it                                 just kind of works and glimmer                                 components are great for all the power                                 glimmer provides and all the tracked                                 properties now and all that stuff a lot                                 closer to vanilla JavaScript                                 implementations and if you haven't                                 checked it out you should definitely                                 check out the new stuff but the main                                 things that we got here are amber                                 serviceworker which allows our app to                                 work offline and ember web app which                                 allows our have to be installed so you                                 can install it anywhere progressive web                                 apps can be installed so chrome phones                                 etc so give it a little look into that                                 here so if you see this little plus                                 button you can click that and install it                                 and then you can run it as essentially                                 an app on your computer that's wrapped                                 around Chrome obviously but it's pretty                                 cool and you can have it on your home                                 screen on your phone and things like                                 that too so that stuff is driven by just                                 those couple add-ons in verse                                 serviceworker and ember web app and you                                 pretty much just install those an ember                                 serviceworker has a lot of different                                 packages we're using the prim BIR                                 package here so that we can do fast food                                 and prim BER and everything is Jam stack                                 static stuff and                                 so there's a manifesto j/s that you can                                 do with ember web app which lets you set                                 your name of your app and description                                 and your different icons and things so                                 that when you go to install it on                                 various devices it looks and feels and                                 behaves like you expect it to                                 so let's look at some of the bark type                                 utilities here and things that we're                                 using to get some of the more specific                                 bark data so the methods that matter the                                 most here are this determined bark                                 occurred which basically just checks the                                 different loudness values and tells you                                 if a bark occurred in that segment or                                 not and there's a determined bark pitch                                 which is basically gonna tell you was                                 the bark low mid or high pitch so we can                                 use those to then go into this                                 determined bark type function and kind                                 of check how many there were what their                                 pitches were and map it to those types                                 of barks we were talking about earlier                                 so if there's one bark and it's high                                 it's an alert if there's one bark and                                 it's low its distress and otherwise if                                 it's kind of mid-range is probably just                                 a greeting and if it's two it's usually                                 a greeting and then for more than two                                 you've got if it's has some mid                                 frequencies its playful and other ones                                 can also be playful but if it's all low                                 it's usually alert that's more                                 aggressive low repeated barks so that's                                 kind of how we're getting the data to                                 map to the bark types there and in the                                 future there are several things we could                                 do we can add more bark types we                                 basically have only those three to four                                 ruff categories now but there are at                                 least                                                               could support those the one that's most                                 interesting to me would be to support                                 the lonely bark where it's a string of                                 barks followed by a long period of                                 silence followed by more barks because                                 that's kind of saying                                 is anyone there lonely and that would                                 help you identify episodes of separation                                 anxiety for dogs that have problems with                                 that                                 and we could also refine the frequency                                 ranges a bit because right now we just                                 have the three buckets the low mid and                                 high and we could have a mint high mid                                 low etc and I would help us kind of                                 refine even more which maps to which                                 frequency and the most the coolest part                                 of the new features is we could add a                                 talkback feature which I think would be                                 the standout feature of this app so if                                 your dog says something to you and then                                 you recording to get a response                                 it could take various dog barks that                                 defines that would respond in the way                                 you want to respond to that Park and                                 build a custom mark to respond to them                                 of the exact frequency and number of                                 barks for the response and then you                                 could kind of go back and forth and                                 maybe communicate things with them and                                 you know kind of tell them what to do                                 and how you feel and that would help                                 break down barriers between the normal                                 communication of you and your dog so the                                 demo that we played with is out on wolf                                 dot plus-- right now you can try it out                                 please do please let us know if you                                 encounter any issues these are some of                                 the sources we use the Web Audio API                                 Doc's Stack Overflow posts articles                                 about dog barks and visualizations and                                 things in the Web Audio API and thank                                 you for listening and for your attention                                 again I'm Robbie Wagner you can always                                 chat with me about ember                                 please do in discord or via email or                                 however you want to reach out our W                                 Wagner                                                                   there pretty much all the time and you                                 can email me at Robbie at shipshape                                 today I would love to talk with you                                 thanks for your time                                 you
YouTube URL: https://www.youtube.com/watch?v=Kw0V9HvMpI4


