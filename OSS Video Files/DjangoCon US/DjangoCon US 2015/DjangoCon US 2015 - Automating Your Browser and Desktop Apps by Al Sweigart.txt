Title: DjangoCon US 2015 - Automating Your Browser and Desktop Apps by Al Sweigart
Publication date: 2017-11-03
Playlist: DjangoCon US 2015
Description: 
	Automating Your Browser and Desktop Apps by Al Sweigart

This talk is an introduction to using the Requests, Beautiful Soup, Selenium, and PyAutoGUI modules in order to automatically grab data from the web or interact with desktop applications.

Attendees will learn:

How to download files and pages from the web
How to use CSS selectors to find content in a web page
How to control a web browser from Python using Selenium
How to programmatically control the keyboard and mouse
The content from this talk is derived from Al Sweigart's book, Automate the Boring Stuff with Python, which is freely available under a Creative Commons license at http://automatetheboringstuff.com

Help us caption & translate this video!

http://amara.org/v/HHCL/
Captions: 
	00:00:00,000 --> 00:00:36,090
I know it's great to be back in Austin I

00:00:34,200 --> 00:00:38,940
actually grew up in Texas and I went to

00:00:36,090 --> 00:00:47,610
UT Austin so even though I lived for the

00:00:38,940 --> 00:00:49,110
last decade in San Francisco I'll take

00:00:47,610 --> 00:00:52,590
this off of a slightly controversial

00:00:49,110 --> 00:00:53,820
opinion I like programming there are

00:00:52,590 --> 00:00:55,620
several things I like about programming

00:00:53,820 --> 00:01:00,359
most thing that it requires a keen

00:00:55,620 --> 00:01:02,340
attention to detail so much that I want

00:01:00,359 --> 00:01:04,409
to teach other people's programs so I

00:01:02,340 --> 00:01:05,670
wrote a programming book it's called

00:01:04,409 --> 00:01:08,430
automate the boring stuff at the

00:01:05,670 --> 00:01:09,810
pipeline and it's available under a

00:01:08,430 --> 00:01:11,580
Creative Commons license so you can read

00:01:09,810 --> 00:01:14,580
it for free at automate the boring stuff

00:01:11,580 --> 00:01:16,759
comm and I really encourage you to use

00:01:14,580 --> 00:01:19,770
Creative Commons as the licenses

00:01:16,759 --> 00:01:21,840
available it has a lot of advantages but

00:01:19,770 --> 00:01:24,150
main advantage I found is that having it

00:01:21,840 --> 00:01:27,119
online I can use analytics to look at

00:01:24,150 --> 00:01:29,340
what people are paying attention to and

00:01:27,119 --> 00:01:32,130
which chapters are the most read and so

00:01:29,340 --> 00:01:34,110
the chapters on web scraping and GUI

00:01:32,130 --> 00:01:35,280
automation are the most popular chapters

00:01:34,110 --> 00:01:39,140
in this book so that's what this

00:01:35,280 --> 00:01:39,140
presentation is about so

00:01:55,080 --> 00:02:03,150
you have about 10 minutes before people

00:01:57,300 --> 00:02:05,040
start recording and so when we start

00:02:03,150 --> 00:02:15,420
writing programs that can go onto

00:02:05,040 --> 00:02:17,520
websites also kind of requires all this

00:02:15,420 --> 00:02:24,150
technical knowledge about networking

00:02:17,520 --> 00:02:27,770
protocols and connectivity in this next

00:02:24,150 --> 00:02:29,370
slide right here okay

00:02:27,770 --> 00:02:30,600
unfortunately though you don't actually

00:02:29,370 --> 00:02:37,320
have to know any of that information

00:02:30,600 --> 00:02:39,750
there's a selenium all that will launch

00:02:37,320 --> 00:02:41,820
a browser that you can programmatically

00:02:39,750 --> 00:02:43,980
control so if you have to write

00:02:41,820 --> 00:02:46,980
automated tests for your web app and you

00:02:43,980 --> 00:02:48,480
don't want to just download the HTML one

00:02:46,980 --> 00:02:51,120
beautiful scoop on it or some other

00:02:48,480 --> 00:02:53,310
person if she wants to run as it would

00:02:51,120 --> 00:02:55,740
for a user running olden JavaScript on

00:02:53,310 --> 00:02:59,220
the page and setting up all that state

00:02:55,740 --> 00:03:03,620
selenium is great you it's really simple

00:02:59,220 --> 00:03:08,850
to install just hit install selenium any

00:03:03,620 --> 00:03:12,030
figured out for the first time I heard

00:03:08,850 --> 00:03:15,930
about this my companies QA department

00:03:12,030 --> 00:03:18,900
was oh well that sounds great but it all

00:03:15,930 --> 00:03:20,940
sounds really complicated it's actually

00:03:18,900 --> 00:03:24,120
really dead simple I can fit it into a

00:03:20,940 --> 00:03:26,250
45 minute presentation along with the

00:03:24,120 --> 00:03:28,260
automation there's really only about

00:03:26,250 --> 00:03:31,709
half a dozen things that you need to

00:03:28,260 --> 00:03:34,769
know and roll along this slide hey that

00:03:31,709 --> 00:03:35,850
worked so I mean it's not that

00:03:34,769 --> 00:03:38,400
complicated there's a whole bunch of

00:03:35,850 --> 00:03:40,830
bullet text go ahead and ignore that but

00:03:38,400 --> 00:03:41,580
using selenium excusable you import the

00:03:40,830 --> 00:03:43,650
module just

00:03:41,580 --> 00:03:45,690
and the other bathroom you call this

00:03:43,650 --> 00:03:48,900
Firefox function and this will actually

00:03:45,690 --> 00:03:51,180
launch an instance of Firefox on your

00:03:48,900 --> 00:03:52,950
computer you will see the everything and

00:03:51,180 --> 00:03:55,260
that gives you a browser object you can

00:03:52,950 --> 00:03:57,810
call this get nothing by mutual website

00:03:55,260 --> 00:04:00,630
and then you can use CSS selectors to

00:03:57,810 --> 00:04:01,350
find some particular skin element on

00:04:00,630 --> 00:04:03,750
that web page

00:04:01,350 --> 00:04:10,650
kind of like you know a link or check

00:04:03,750 --> 00:04:17,960
box and call the quick method and the

00:04:10,650 --> 00:04:17,960
present both quick and you can so long

00:04:20,750 --> 00:04:26,550
so that's a whole bunch of telling and I

00:04:24,300 --> 00:04:28,860
should be showing so I'm going to do

00:04:26,550 --> 00:04:33,750
something that is incredibly ill-advised

00:04:28,860 --> 00:04:36,770
and that is a live demo yes all tapping

00:04:33,750 --> 00:04:42,840
out a power point and running idle

00:04:36,770 --> 00:04:44,310
anything can go wrong live demo okay so

00:04:42,840 --> 00:04:45,990
also I just wanted to show that it is

00:04:44,310 --> 00:04:48,180
possible to keep all of this but we

00:04:45,990 --> 00:04:50,400
selenium stuff inside your head at the

00:04:48,180 --> 00:04:55,530
same time so let's go ahead and import

00:04:50,400 --> 00:04:57,570
this module so from important driver so

00:04:55,530 --> 00:04:59,160
first bit of weirdness about selenium

00:04:57,570 --> 00:05:01,190
that you should know is that you

00:04:59,160 --> 00:05:04,230
actually have to do this exact same

00:05:01,190 --> 00:05:05,580
syntax you have to type from selenium

00:05:04,230 --> 00:05:07,950
import webdriver you can't just have

00:05:05,580 --> 00:05:10,380
import selenium or anything like that a

00:05:07,950 --> 00:05:12,570
weird little thing that's about this

00:05:10,380 --> 00:05:15,650
mean that you should be aware of so next

00:05:12,570 --> 00:05:19,080
let's go ahead and create that browser

00:05:15,650 --> 00:05:20,910
so Firefox works out right out of the

00:05:19,080 --> 00:05:23,160
package if you want to have Chrome or

00:05:20,910 --> 00:05:26,550
Safari or something else you can there's

00:05:23,160 --> 00:05:29,220
a little bit of setup but this will

00:05:26,550 --> 00:05:31,320
actually go ahead and launch Firefox and

00:05:29,220 --> 00:05:34,700
you can see it up here on the screen so

00:05:31,320 --> 00:05:34,700
I'm gonna have this off to the side

00:05:36,650 --> 00:05:41,600
and we'll just call that get method to

00:05:39,380 --> 00:05:43,910
send it to a website and I kind of

00:05:41,600 --> 00:05:46,010
wanted to plug my book some more so

00:05:43,910 --> 00:05:49,550
we'll just go to the waterborne stop

00:05:46,010 --> 00:05:51,440
calm and you can see now I have

00:05:49,550 --> 00:05:54,890
programmatic control I'm controlling the

00:05:51,440 --> 00:05:56,020
browser from a Python script so this is

00:05:54,890 --> 00:05:58,610
really nice

00:05:56,020 --> 00:06:00,590
that's the website and you know if

00:05:58,610 --> 00:06:02,150
you're sitting up in automated tests you

00:06:00,590 --> 00:06:05,380
all have to go through and figure out

00:06:02,150 --> 00:06:07,760
what exactly your test should click on

00:06:05,380 --> 00:06:09,620
where you can expect applying that so

00:06:07,760 --> 00:06:11,900
let's just do that here you're going to

00:06:09,620 --> 00:06:16,450
have to get an element object so some

00:06:11,900 --> 00:06:16,450
HTML element from that page like how

00:06:18,490 --> 00:06:29,870
long like when they were handing out

00:06:27,770 --> 00:06:31,790
words to use in method names I think

00:06:29,870 --> 00:06:34,850
this method was at the front of the line

00:06:31,790 --> 00:06:38,090
so yes I'll take them all so kind of

00:06:34,850 --> 00:06:41,090
verbose but it works and then you just

00:06:38,090 --> 00:06:43,100
end it in the CSS selector so if you use

00:06:41,090 --> 00:06:44,840
CSS you might be familiar with this or

00:06:43,100 --> 00:06:49,460
if you used something like beautiful

00:06:44,840 --> 00:06:51,020
soup but it can be it's a selector is

00:06:49,460 --> 00:06:53,330
kind of like a regular expression from

00:06:51,020 --> 00:06:56,150
HTML it allows you to specify some

00:06:53,330 --> 00:07:00,080
particular parts of that HTML document

00:06:56,150 --> 00:07:01,730
or that web page and you could learn all

00:07:00,080 --> 00:07:03,260
the syntax for that so you'd be able to

00:07:01,730 --> 00:07:05,600
write it yourself or you can cheat by

00:07:03,260 --> 00:07:07,460
using the browser to calculate that for

00:07:05,600 --> 00:07:09,710
you I'm gonna click on this introduction

00:07:07,460 --> 00:07:11,030
link so I'm gonna get the selector for

00:07:09,710 --> 00:07:12,680
that so I'll just right click on it you

00:07:11,030 --> 00:07:14,570
can select inspect element that'll open

00:07:12,680 --> 00:07:18,880
up the browser tools every modern

00:07:14,570 --> 00:07:18,880
browser has some form of developer tools

00:07:26,489 --> 00:07:30,849
there we go

00:07:27,909 --> 00:07:33,189
so you can see it there's the HTML for

00:07:30,849 --> 00:07:35,499
this column and now I just want the

00:07:33,189 --> 00:07:37,599
selector for this particular wing so I'm

00:07:35,499 --> 00:07:39,939
gonna right click on that and select top

00:07:37,599 --> 00:07:42,579
unique selector so in various browsers

00:07:39,939 --> 00:07:44,859
this might be copy CSS selector or copy

00:07:42,579 --> 00:07:46,509
CSS path or something but old browsers

00:07:44,859 --> 00:07:51,279
have something like this so you can just

00:07:46,509 --> 00:07:53,199
copy that paste it in there this

00:07:51,279 --> 00:07:57,369
selector is really particular it'll

00:07:53,199 --> 00:07:59,439
match this one link uniquely but you can

00:07:57,369 --> 00:08:03,459
also more general selectors to match

00:07:59,439 --> 00:08:06,249
several different elements so and that

00:08:03,459 --> 00:08:15,069
gives us this element object and then if

00:08:06,249 --> 00:08:18,579
we want so we need to click on that easy

00:08:15,069 --> 00:08:26,499
now we click on introduction part right

00:08:18,579 --> 00:08:28,599
there so that's pretty handy find

00:08:26,499 --> 00:08:30,999
element my CSS selector is the method

00:08:28,599 --> 00:08:34,000
that you'll use about 80% of the time

00:08:30,999 --> 00:08:35,529
there's also find elements plural so if

00:08:34,000 --> 00:08:37,329
you specify general selector and

00:08:35,529 --> 00:08:39,430
actually several different elements and

00:08:37,329 --> 00:08:42,029
it'll return a list of all the matching

00:08:39,430 --> 00:08:45,759
elements there's also find element by

00:08:42,029 --> 00:08:47,439
link text find element by ID but find

00:08:45,759 --> 00:08:51,939
element by CSS selector is the most

00:08:47,439 --> 00:08:53,230
useful one so there and then there was

00:08:51,939 --> 00:08:55,809
the once you have that element object

00:08:53,230 --> 00:08:58,240
you can click on things get also sent or

00:08:55,809 --> 00:09:02,559
key so if it's the element for a text

00:08:58,240 --> 00:09:04,059
field you can take something in let me

00:09:02,559 --> 00:09:07,540
just push my life down little buffer

00:09:04,059 --> 00:09:08,920
even further so let's say you know I

00:09:07,540 --> 00:09:11,379
figured out the selector for that I can

00:09:08,920 --> 00:09:13,240
clicked on that and now I want to run

00:09:11,379 --> 00:09:16,079
some automated test by entering

00:09:13,240 --> 00:09:16,079
something into the search field

00:09:22,440 --> 00:09:30,670
this search element and then yes so

00:09:28,060 --> 00:09:35,010
these CSS selectors are really massively

00:09:30,670 --> 00:09:35,010
huge all the time except for this one I

00:09:36,300 --> 00:09:44,740
can just send it some keys

00:09:38,320 --> 00:09:49,300
I'll just want to search for Sophie that

00:09:44,740 --> 00:09:50,770
just takes it in there and then to

00:09:49,300 --> 00:09:51,970
submit this search field you know you

00:09:50,770 --> 00:09:53,980
can have a newline character that

00:09:51,970 --> 00:09:55,480
simulates press enter we can find the

00:09:53,980 --> 00:09:58,150
selector for a submit button

00:09:55,480 --> 00:10:00,960
but selenium has a nice little feature

00:09:58,150 --> 00:10:03,730
where if you have the element for some

00:10:00,960 --> 00:10:07,420
elements inside of an HTML form and then

00:10:03,730 --> 00:10:08,830
invoke that deforms submit action just

00:10:07,420 --> 00:10:13,360
by colleagues today on any element

00:10:08,830 --> 00:10:15,610
inside that that submits the search and

00:10:13,360 --> 00:10:20,080
now here are all the WordPress search

00:10:15,610 --> 00:10:22,330
results from that so Sophie is the name

00:10:20,080 --> 00:10:24,940
of my cat and I got a photo of her that

00:10:22,330 --> 00:10:28,660
features prominently in the image

00:10:24,940 --> 00:10:30,400
manipulation chapter of this book she's

00:10:28,660 --> 00:10:33,480
kind of chubby but the camera adds ten

00:10:30,400 --> 00:10:33,480
pounds and that's a lot

00:10:35,059 --> 00:10:48,079
oh okay so I mean this is fine for you

00:10:46,849 --> 00:10:50,569
know keyboard keys aren't easy to

00:10:48,079 --> 00:10:52,369
represent us single letters of a screen

00:10:50,569 --> 00:10:54,589
but say if you wanted to impress the

00:10:52,369 --> 00:10:57,429
page down button or the escape button

00:10:54,589 --> 00:10:59,629
you have to one button

00:10:57,429 --> 00:11:02,259
here's another wall of text I don't

00:10:59,629 --> 00:11:04,699
actually expect you to read selenium has

00:11:02,259 --> 00:11:07,669
constants that you can use for those

00:11:04,699 --> 00:11:09,739
special keys keys stuck down for the

00:11:07,669 --> 00:11:13,999
count arrow and he's not home they're

00:11:09,739 --> 00:11:17,179
all inside this one module which has an

00:11:13,999 --> 00:11:18,529
unfortunately verbose name let's see if

00:11:17,179 --> 00:11:27,009
I can actually remember from

00:11:18,529 --> 00:11:30,439
selenium-webdriver webcomic duckies

00:11:27,009 --> 00:11:32,539
import keys with a capital K you have to

00:11:30,439 --> 00:11:34,879
get all this right so yeah just have a

00:11:32,539 --> 00:11:39,829
handy little cheat sheet chichi off to

00:11:34,879 --> 00:11:42,799
the side and then that he's contains all

00:11:39,829 --> 00:11:46,429
of the names for special keyboard

00:11:42,799 --> 00:11:49,879
characters that you might want to use so

00:11:46,429 --> 00:11:51,799
I mean yeah this name when when play

00:11:49,879 --> 00:11:54,019
Khan has this Zen a Python comb that

00:11:51,799 --> 00:11:56,029
flattens better than nested this is what

00:11:54,019 --> 00:11:59,419
they mean don't have a name like

00:11:56,029 --> 00:12:02,269
selenium-webdriver comic cheese it's

00:11:59,419 --> 00:12:03,949
like the code that you write yeah I have

00:12:02,269 --> 00:12:10,069
to like shrink it down so much that

00:12:03,949 --> 00:12:12,289
nobody can actually even yeah so that's

00:12:10,069 --> 00:12:13,909
you know clicking on things typing into

00:12:12,289 --> 00:12:16,009
forms that's basically what most web

00:12:13,909 --> 00:12:18,499
surfing is and that's all your automated

00:12:16,009 --> 00:12:20,479
scripts will have to do but you can also

00:12:18,499 --> 00:12:22,369
not only interact with the things inside

00:12:20,479 --> 00:12:24,660
the browser but you can also control the

00:12:22,369 --> 00:12:28,500
browser itself you'll probably never

00:12:24,660 --> 00:12:33,180
these methods - they click on feedback

00:12:28,500 --> 00:12:34,980
forward and refresh keys and then so

00:12:33,180 --> 00:12:37,019
once you have gone through and

00:12:34,980 --> 00:12:38,790
navigating through your web app you'll

00:12:37,019 --> 00:12:41,279
want to check to make sure it's actually

00:12:38,790 --> 00:12:43,050
displaying the correct things so in

00:12:41,279 --> 00:12:43,560
order to read the text that's on the

00:12:43,050 --> 00:12:45,449
webpage

00:12:43,560 --> 00:12:48,060
currently you will have to take that

00:12:45,449 --> 00:12:51,720
element object that you find and look at

00:12:48,060 --> 00:12:53,579
its text or its text member which is

00:12:51,720 --> 00:12:55,769
really simple it's nice and refreshing

00:12:53,579 --> 00:12:58,139
so again have some paragraph element

00:12:55,769 --> 00:13:00,839
where a div element you just look at dot

00:12:58,139 --> 00:13:04,199
text and as a spring they'll have the

00:13:00,839 --> 00:13:06,689
entire content for that page or for that

00:13:04,199 --> 00:13:09,149
for that one element and if you want to

00:13:06,689 --> 00:13:11,009
get a particular attribute from that

00:13:09,149 --> 00:13:12,600
element saying you have a link element

00:13:11,009 --> 00:13:14,550
you want to make sure that it's pointing

00:13:12,600 --> 00:13:17,459
to the right page and take a look at its

00:13:14,550 --> 00:13:19,589
href attribute now we're trying to

00:13:17,459 --> 00:13:24,720
spring with the content that it has if

00:13:19,589 --> 00:13:27,420
you want to get a list of get attributes

00:13:24,720 --> 00:13:29,759
plural and it turns out that's not the

00:13:27,420 --> 00:13:31,470
case in fact there is no way to get a

00:13:29,759 --> 00:13:33,839
list of all the attributes the hack

00:13:31,470 --> 00:13:37,380
around that so if the outer HTML

00:13:33,839 --> 00:13:40,920
attribute I mean you have to look it's a

00:13:37,380 --> 00:13:42,240
return the entire HTML tag and all the

00:13:40,920 --> 00:13:43,829
content inside of it and you can't

00:13:42,240 --> 00:13:45,860
assume use regular expressions or some

00:13:43,829 --> 00:13:51,329
convoluted way so that's another

00:13:45,860 --> 00:13:54,750
selenium weirdness but that's basically

00:13:51,329 --> 00:13:56,939
it so yeah that's it's actually a

00:13:54,750 --> 00:14:00,329
surprisingly simple tool there's not a

00:13:56,939 --> 00:14:02,550
lot to it it's just opening the browser

00:14:00,329 --> 00:14:04,589
getting element objects using CSS

00:14:02,550 --> 00:14:06,750
selectors clicking on things and then

00:14:04,589 --> 00:14:09,319
using semi keys to type stuff in and

00:14:06,750 --> 00:14:11,160
then reading what the text is by a

00:14:09,319 --> 00:14:14,160
variable that's great

00:14:11,160 --> 00:14:16,199
so give me automation graphical user

00:14:14,160 --> 00:14:18,240
interface automation that sounds really

00:14:16,199 --> 00:14:20,490
complicated also it basically just means

00:14:18,240 --> 00:14:22,559
controlling the mouse and keyboard from

00:14:20,490 --> 00:14:24,870
from your program so having a place on

00:14:22,559 --> 00:14:29,440
script that can move the mouse around on

00:14:24,870 --> 00:14:32,680
its own so for this I'm going to cover

00:14:29,440 --> 00:14:34,810
my team which you can install with kik

00:14:32,680 --> 00:14:37,120
install tile GUI and it works on play on

00:14:34,810 --> 00:14:38,980
to an iPhone 3 it also works on Windows

00:14:37,120 --> 00:14:42,430
Linux and Mac and has the same simple

00:14:38,980 --> 00:14:43,360
API which is documented I'm gonna read

00:14:42,430 --> 00:14:46,689
the docs type org

00:14:43,360 --> 00:14:50,259
so ok income equality X because I just

00:14:46,689 --> 00:14:53,040
want to slightly cover all the various

00:14:50,259 --> 00:14:56,319
functions on it don't glance over this

00:14:53,040 --> 00:14:58,860
so mouse control yeah so that's a huge

00:14:56,319 --> 00:15:01,180
wallet X let's do something more fun

00:14:58,860 --> 00:15:02,829
that will possibly blow up in my face

00:15:01,180 --> 00:15:06,209
and that's always entertaining to the

00:15:02,829 --> 00:15:11,850
audience and let's do another live demo

00:15:06,209 --> 00:15:13,629
so import I love GU first function

00:15:11,850 --> 00:15:15,759
position you want to find out where the

00:15:13,629 --> 00:15:18,100
mouse cursor is on the screen so this

00:15:15,759 --> 00:15:19,689
right here just returns a simple XY

00:15:18,100 --> 00:15:21,879
coordinate these are the same XY

00:15:19,689 --> 00:15:24,730
coordinates that are commonly used in

00:15:21,879 --> 00:15:26,290
programming where the origin 0 0 is in

00:15:24,730 --> 00:15:28,779
the upper left corner of the screen and

00:15:26,290 --> 00:15:32,379
x increases going to the right and y

00:15:28,779 --> 00:15:34,959
increases going down if you want to find

00:15:32,379 --> 00:15:40,089
out the full size resolution on the

00:15:34,959 --> 00:15:41,759
screen you can just call size currently

00:15:40,089 --> 00:15:44,110
play auto GUI doesn't really work on

00:15:41,759 --> 00:15:46,980
multi-monitor setups well it kind of

00:15:44,110 --> 00:15:49,149
works but its behavior is undefined

00:15:46,980 --> 00:15:54,250
that's my favorite euphemism in

00:15:49,149 --> 00:16:00,220
programming and then okay well we can

00:15:54,250 --> 00:16:01,660
just have send a click and cause the

00:16:00,220 --> 00:16:02,860
mouse to click itself wherever it

00:16:01,660 --> 00:16:05,949
happens to be so I'm gonna position it

00:16:02,860 --> 00:16:08,040
over this file menu right here which

00:16:05,949 --> 00:16:10,449
probably nobody in the back row can see

00:16:08,040 --> 00:16:12,100
well when I run that code it just sends

00:16:10,449 --> 00:16:15,490
it automatically sends that virtual

00:16:12,100 --> 00:16:16,930
mouse click right there and so say I

00:16:15,490 --> 00:16:18,430
wanted to figure out you know I'm

00:16:16,930 --> 00:16:21,009
writing some script that's gonna

00:16:18,430 --> 00:16:22,269
automatically test link desktop app so I

00:16:21,009 --> 00:16:24,160
need to find figure out where exactly

00:16:22,269 --> 00:16:28,660
this file menus going to be so I'll just

00:16:24,160 --> 00:16:30,399
call position okay it says 67 69 it'll

00:16:28,660 --> 00:16:32,040
just pass those coordinates to the click

00:16:30,399 --> 00:16:34,470
function now it doesn't matter where the

00:16:32,040 --> 00:16:38,550
else's it was just automatically move

00:16:34,470 --> 00:16:41,370
there click so that's you can just have

00:16:38,550 --> 00:16:49,350
that Mouse move to those coordinates as

00:16:41,370 --> 00:16:54,230
well with move to and I'll just

00:16:49,350 --> 00:16:57,300
instantly zoom the mouse back over there

00:16:54,230 --> 00:16:59,399
but if you also just want to mimic what

00:16:57,300 --> 00:17:01,259
a human does and just how to gradually

00:16:59,399 --> 00:17:03,899
move over there you can specify a

00:17:01,259 --> 00:17:05,819
duration keyword let's say let's move it

00:17:03,899 --> 00:17:08,250
over there in over thousand two seconds

00:17:05,819 --> 00:17:11,549
so starting from here back to a file

00:17:08,250 --> 00:17:12,809
menu and it's moving oh if you're just

00:17:11,549 --> 00:17:14,220
paying attention to the screen and not

00:17:12,809 --> 00:17:21,270
noticing that I'm not controlling the

00:17:14,220 --> 00:17:22,890
mouse here we go okay let's say you

00:17:21,270 --> 00:17:24,419
don't really care about moving to some

00:17:22,890 --> 00:17:26,040
absolute coordinates you just want to

00:17:24,419 --> 00:17:29,070
move to some relative position say you

00:17:26,040 --> 00:17:31,169
know 200 pixels to the right wherever it

00:17:29,070 --> 00:17:35,429
currently is we can just start it right

00:17:31,169 --> 00:17:38,370
there and go sleep over precisely two

00:17:35,429 --> 00:17:44,909
seconds so not quite like a human

00:17:38,370 --> 00:17:47,070
because but yeah so you can move on the

00:17:44,909 --> 00:17:49,380
screen click the mouse you can also give

00:17:47,070 --> 00:17:50,640
a drag to and drag rattle which do the

00:17:49,380 --> 00:17:53,970
exact same thing except hold the mouse

00:17:50,640 --> 00:17:56,370
button down if you're trying to plot out

00:17:53,970 --> 00:17:57,929
your automated test I'm gonna have to

00:17:56,370 --> 00:18:01,790
bring the terminal because this doesn't

00:17:57,929 --> 00:18:01,790
display correctly in

00:18:10,740 --> 00:18:13,860
so there's a function display mouse

00:18:12,120 --> 00:18:16,260
position so if you're plotting out what

00:18:13,860 --> 00:18:18,090
exactly you have to click on in your

00:18:16,260 --> 00:18:19,770
program you just run this function and

00:18:18,090 --> 00:18:22,110
it provides a handy little tool to

00:18:19,770 --> 00:18:23,460
figure out where exactly the mouse sits

00:18:22,110 --> 00:18:26,880
at any given time it also gives you the

00:18:23,460 --> 00:18:28,260
RGB color belying of whatever pixel is

00:18:26,880 --> 00:18:30,600
underneath and now so you can see over

00:18:28,260 --> 00:18:35,060
black that's just zero and I okay this

00:18:30,600 --> 00:18:35,060
green part of the green value shoots up

00:18:35,150 --> 00:18:42,960
and just takes it out of that and then

00:18:40,140 --> 00:18:44,370
people control also really simple the

00:18:42,960 --> 00:19:04,470
main function you'll use there is type

00:18:44,370 --> 00:19:07,310
right hello world oh right so this will

00:19:04,470 --> 00:19:09,840
send virtual key presses to wherever

00:19:07,310 --> 00:19:13,410
whatever text field or window currently

00:19:09,840 --> 00:19:16,110
has focus something I just call click to

00:19:13,410 --> 00:19:17,610
make sure it clicks on this before

00:19:16,110 --> 00:19:20,610
typing so I'll just move the mouse over

00:19:17,610 --> 00:19:22,590
this file editor and when I run that it

00:19:20,610 --> 00:19:24,750
instantly types it out of course if you

00:19:22,590 --> 00:19:27,450
don't want it to be instant it just

00:19:24,750 --> 00:19:29,250
passed this interval keyword argument

00:19:27,450 --> 00:19:30,960
let's say I just want to pause for a

00:19:29,250 --> 00:19:36,630
fifth of a second in between each key

00:19:30,960 --> 00:19:39,680
press and okay so one error bar in this

00:19:36,630 --> 00:19:43,490
live demo position this once again okay

00:19:39,680 --> 00:19:46,320
and I'll just slowly type everything out

00:19:43,490 --> 00:19:49,020
so you know kind of like a typewriter of

00:19:46,320 --> 00:19:51,470
that for those of you who don't know a

00:19:49,020 --> 00:19:51,470
typewriter

00:19:52,710 --> 00:19:59,710
paper and if you just want to press the

00:19:57,880 --> 00:20:01,690
single key there's pretty obvious names

00:19:59,710 --> 00:20:04,360
for them like the page up key to send

00:20:01,690 --> 00:20:06,670
press a string this is page on all of

00:20:04,360 --> 00:20:15,540
those keys are documented here in the

00:20:06,670 --> 00:20:17,770
keyboard keys list keyboard keys

00:20:15,540 --> 00:20:19,090
they're all just lowercase and pretty

00:20:17,770 --> 00:20:20,710
much what you expect if you don't get

00:20:19,090 --> 00:20:22,600
them the first time you can just look

00:20:20,710 --> 00:20:24,580
through this list and then if you just

00:20:22,600 --> 00:20:26,470
want to plot key combinations you know

00:20:24,580 --> 00:20:28,900
there are getting particularly key press

00:20:26,470 --> 00:20:30,750
it down and keep pressing things to

00:20:28,900 --> 00:20:54,130
simulate that but for just doing like a

00:20:30,750 --> 00:20:56,890
keyboard combination completely alright

00:20:54,130 --> 00:20:59,320
that is - hair so far during all my live

00:20:56,890 --> 00:21:03,090
demos let's see if we can keep it at

00:20:59,320 --> 00:21:06,490
least in the double digits okay so hey I

00:21:03,090 --> 00:21:08,620
completely did not do that and three did

00:21:06,490 --> 00:21:12,960
not press ctrl oh I had the program do

00:21:08,620 --> 00:21:15,280
it for me so that's really nice you can

00:21:12,960 --> 00:21:16,480
you know this is like okay all these

00:21:15,280 --> 00:21:18,310
functions yeah they have a pretty

00:21:16,480 --> 00:21:21,970
typical dance that's kind of boring so

00:21:18,310 --> 00:21:25,660
let's do another live demo and see what

00:21:21,970 --> 00:21:28,420
else could go wrong okay close this I'm

00:21:25,660 --> 00:21:31,440
going to open the best thing that's ever

00:21:28,420 --> 00:21:31,440
come from Microsoft

00:21:32,290 --> 00:21:42,250
and I have this program that will draw

00:21:38,169 --> 00:21:44,740
out a little square spiral shape you can

00:21:42,250 --> 00:21:46,210
see it just uses those drag rails to

00:21:44,740 --> 00:21:49,000
drag the mouse around I'm just kind of a

00:21:46,210 --> 00:21:51,790
drag around here to draw out a little

00:21:49,000 --> 00:21:53,290
square spiral so make sure that's in

00:21:51,790 --> 00:21:55,000
focus I'm gonna position the mouse like

00:21:53,290 --> 00:22:14,260
right about here and then press you're

00:21:55,000 --> 00:22:16,660
fine to write it because there are

00:22:14,260 --> 00:22:18,010
things like the pill module pillow and

00:22:16,660 --> 00:22:20,950
you can just programmatically generate

00:22:18,010 --> 00:22:22,780
all of these you know square spiral

00:22:20,950 --> 00:22:24,640
shapes that you want but the nice thing

00:22:22,780 --> 00:22:26,860
about controlling the mouse to control

00:22:24,640 --> 00:22:30,040
other programs to do so you get to make

00:22:26,860 --> 00:22:33,730
use of all of em s paints many many

00:22:30,040 --> 00:22:36,010
abundant features but no it seriously

00:22:33,730 --> 00:22:38,530
has like oh nice brushes like break

00:22:36,010 --> 00:22:42,669
feeling something like that

00:22:38,530 --> 00:22:44,950
so now using that exact same program we

00:22:42,669 --> 00:22:46,510
just run this and now I'm drawing you

00:22:44,950 --> 00:22:48,309
know squares federal but it looks a

00:22:46,510 --> 00:22:50,559
little bit fancier and reproducing

00:22:48,309 --> 00:22:52,690
something like that using pillow would

00:22:50,559 --> 00:22:54,220
be a non-trivial task so that's kinda

00:22:52,690 --> 00:22:57,130
nice you can actually start writing

00:22:54,220 --> 00:22:59,470
programs that control other programs

00:22:57,130 --> 00:23:08,049
which of course is how the robots will

00:22:59,470 --> 00:23:10,330
take over Disney movie Fantasia and

00:23:08,049 --> 00:23:13,630
there's a scene where Mickey Mouse is

00:23:10,330 --> 00:23:15,669
the sorcerer and he's given the task to

00:23:13,630 --> 00:23:17,590
fill up this bathtub full of water so we

00:23:15,669 --> 00:23:19,540
get chance a broom to do a form in this

00:23:17,590 --> 00:23:21,970
room is mindlessly carrying out this

00:23:19,540 --> 00:23:23,559
task and lube up fill up the bucket dump

00:23:21,970 --> 00:23:25,390
it into the tub but it keeps doing that

00:23:23,559 --> 00:23:28,299
even to the point where the tub starts

00:23:25,390 --> 00:23:30,190
overflowing and Mickey the wizard can't

00:23:28,299 --> 00:23:32,410
really stop this program and so when

00:23:30,190 --> 00:23:34,840
you're writing programs that can control

00:23:32,410 --> 00:23:37,840
the mouse and keyboard it kind of makes

00:23:34,840 --> 00:23:39,049
it hard to move the mouse over to stop

00:23:37,840 --> 00:23:43,070
that program there's something

00:23:39,049 --> 00:23:46,690
going horrifically long so pilot abui

00:23:43,070 --> 00:23:49,159
has a few fail-safes built in one is if

00:23:46,690 --> 00:23:51,799
at any point you can just slam the mouse

00:23:49,159 --> 00:23:53,899
up to the top left corner and it detects

00:23:51,799 --> 00:23:55,369
during any pie out of gooey caramel if

00:23:53,899 --> 00:23:57,799
it's up there at 0-0

00:23:55,369 --> 00:24:00,409
it'll just raise his failsafe exception

00:23:57,799 --> 00:24:02,149
and stop what it's doing and also after

00:24:00,409 --> 00:24:04,489
every single call it has a tenth of a

00:24:02,149 --> 00:24:06,649
second pause at the end of it so it

00:24:04,489 --> 00:24:08,299
doesn't run immediately there's a slight

00:24:06,649 --> 00:24:10,460
pause there you can change that into one

00:24:08,299 --> 00:24:11,809
I don't recommend it but that will

00:24:10,460 --> 00:24:14,029
probably buy you enough time to just

00:24:11,809 --> 00:24:17,269
slam the mouse up and to the left to

00:24:14,029 --> 00:24:21,580
stop it so let's do it like a live demo

00:24:17,269 --> 00:24:24,529
of that yeah so let's do a live demo of

00:24:21,580 --> 00:24:31,759
GUI automation so it takes away control

00:24:24,529 --> 00:24:33,619
of the mouse from me of a program okay

00:24:31,759 --> 00:24:35,840
so I'm gonna run this and I slam the

00:24:33,619 --> 00:24:38,570
mouse up into the left find out a GUI

00:24:35,840 --> 00:24:40,820
will hopefully detect that and then stop

00:24:38,570 --> 00:24:44,200
it otherwise you're all gonna watch is

00:24:40,820 --> 00:24:44,200
like pull the battery out of my lap

00:24:45,279 --> 00:24:50,980
still increase any of stuff okay hey

00:24:48,259 --> 00:24:53,299
okay yes just slam the mouse up there

00:24:50,980 --> 00:24:56,749
you see fail-safe exception has been

00:24:53,299 --> 00:24:58,159
raised so yeah nice handy little trick

00:24:56,749 --> 00:24:59,629
to keep track your program this is

00:24:58,159 --> 00:25:00,859
definitely something that you have to

00:24:59,629 --> 00:25:03,109
keep in mind when you're writing these

00:25:00,859 --> 00:25:05,299
automated tasks the first few times you

00:25:03,109 --> 00:25:07,639
run that automated test you might want

00:25:05,299 --> 00:25:09,950
to babysit it just to make sure it's you

00:25:07,639 --> 00:25:15,980
know not launching missiles at rush

00:25:09,950 --> 00:25:18,049
hours so it's somehow not really control

00:25:15,980 --> 00:25:20,659
Mouse can control the keyboard but it's

00:25:18,049 --> 00:25:23,570
kind of doing this blind please if you

00:25:20,659 --> 00:25:25,760
mention a robotic welding arm in a car

00:25:23,570 --> 00:25:28,010
factories just like

00:25:25,760 --> 00:25:29,330
well here and then repeat that over and

00:25:28,010 --> 00:25:31,280
over Danny it doesn't actually know if

00:25:29,330 --> 00:25:32,690
there's a car in front of it they just

00:25:31,280 --> 00:25:34,730
know as I should well here well here

00:25:32,690 --> 00:25:36,710
well here same thing with your pile of

00:25:34,730 --> 00:25:40,100
gooey scripts is just click here click

00:25:36,710 --> 00:25:42,260
here click here that but that doesn't

00:25:40,100 --> 00:25:45,800
actually tell it what it's clicking on

00:25:42,260 --> 00:25:49,670
so hyoe degree also has a few screenshot

00:25:45,800 --> 00:25:52,160
and image recognition capabilities they

00:25:49,670 --> 00:25:54,860
mostly rely on pillow which is installed

00:25:52,160 --> 00:25:55,910
as a dependency with pilot agree but if

00:25:54,860 --> 00:25:58,400
you're on Linux you'll also have to

00:25:55,910 --> 00:26:01,670
install this program prompt to do

00:25:58,400 --> 00:26:03,950
screenshots so the first one is really

00:26:01,670 --> 00:26:04,580
simple it's just pick selected XY

00:26:03,950 --> 00:26:07,550
coordinates

00:26:04,580 --> 00:26:09,080
I'll return an RGB color value of what

00:26:07,550 --> 00:26:10,850
the color of that pixel is at that

00:26:09,080 --> 00:26:12,710
particular coordinate so if you're

00:26:10,850 --> 00:26:14,420
descriptives clicking on a grey submit

00:26:12,710 --> 00:26:16,130
button we can add a little check to see

00:26:14,420 --> 00:26:18,560
you know is that actually grey right

00:26:16,130 --> 00:26:22,460
there so that's a nice you know kind of

00:26:18,560 --> 00:26:25,010
dumb way of just having a sanity check

00:26:22,460 --> 00:26:27,350
right there you can also just take

00:26:25,010 --> 00:26:29,000
screenshots just to have a sort of

00:26:27,350 --> 00:26:31,610
visual log of what the program is doing

00:26:29,000 --> 00:26:33,440
and what the screen looks like at any

00:26:31,610 --> 00:26:36,170
given moment during their program the

00:26:33,440 --> 00:26:38,630
main thing that is really nice is this

00:26:36,170 --> 00:26:40,520
locate on-screen function so if you have

00:26:38,630 --> 00:26:42,620
an image of something you wanted to

00:26:40,520 --> 00:26:44,420
click on you can just pass that to

00:26:42,620 --> 00:26:47,420
locate on screen and that will return

00:26:44,420 --> 00:26:49,780
the portent for where it found that so

00:26:47,420 --> 00:26:53,210
I'm going to do yet another live demo

00:26:49,780 --> 00:26:59,510
let's launch Microsoft's other create

00:26:53,210 --> 00:27:02,240
application calculator and I already

00:26:59,510 --> 00:27:05,510
took a screen shot of a 70 so this is

00:27:02,240 --> 00:27:10,940
just it's own little kingi file and I'll

00:27:05,510 --> 00:27:17,510
just have idle try to find that on the

00:27:10,940 --> 00:27:20,490
screen so oh do we locate on screen and

00:27:17,510 --> 00:27:25,090
then pass it that image file name

00:27:20,490 --> 00:27:26,410
Kichi so two things you should know

00:27:25,090 --> 00:27:28,210
about this function one it's kind of

00:27:26,410 --> 00:27:30,490
expensive to run it takes like a full

00:27:28,210 --> 00:27:32,290
second to actually be fine because it's

00:27:30,490 --> 00:27:33,820
basically be checking every pixel on the

00:27:32,290 --> 00:27:35,230
screen and there's some way to be

00:27:33,820 --> 00:27:36,940
looking the documentation to speed that

00:27:35,230 --> 00:27:40,330
up a little bit if you really can't use

00:27:36,940 --> 00:27:41,559
it for sort of legal time like you have

00:27:40,330 --> 00:27:43,240
some video game that's playing and

00:27:41,559 --> 00:27:44,679
changing the screen really fast or some

00:27:43,240 --> 00:27:47,110
movie or animation that's playing it's

00:27:44,679 --> 00:27:49,750
not gonna work for that and also this

00:27:47,110 --> 00:27:52,330
has to be an exact pixel perfect match

00:27:49,750 --> 00:27:55,860
of the image that you passed it so if I

00:27:52,330 --> 00:28:09,340
have that seven key just even slightly

00:27:55,860 --> 00:28:11,290
overlap right there so if you have that

00:28:09,340 --> 00:28:14,140
just like slightly covered up it's not

00:28:11,290 --> 00:28:16,660
gonna find anything and just return done

00:28:14,140 --> 00:28:18,880
oh yes so this is just a tool for

00:28:16,660 --> 00:28:20,559
integers it's just the top and left is

00:28:18,880 --> 00:28:22,750
the young the XY coordinates of the

00:28:20,559 --> 00:28:25,000
top-left corner and then the width and

00:28:22,750 --> 00:28:27,270
the height of where founded but

00:28:25,000 --> 00:28:30,700
something you'll probably want to use is

00:28:27,270 --> 00:28:34,000
locate Center on screen and it'll just

00:28:30,700 --> 00:28:39,250
return the center XY coordinates of that

00:28:34,000 --> 00:28:40,750
region so yeah a second to run what's

00:28:39,250 --> 00:28:46,290
really nice about this is then you can

00:28:40,750 --> 00:28:48,250
just pass it to putter GUI Claire and

00:28:46,290 --> 00:28:53,260
that'll just apply it with the X&Y

00:28:48,250 --> 00:28:54,669
coordinates to click on and so this will

00:28:53,260 --> 00:28:58,929
click on the seven you know no matter

00:28:54,669 --> 00:29:01,419
where this window is on the screen so

00:28:58,929 --> 00:29:05,440
nice thing to have as part of your GUI

00:29:01,419 --> 00:29:06,910
automation test so yeah what is good we

00:29:05,440 --> 00:29:08,530
are conditioned use for I probably

00:29:06,910 --> 00:29:12,580
should have put this slide towards the

00:29:08,530 --> 00:29:14,140
beginning instead of at the end but so

00:29:12,580 --> 00:29:16,000
selenium is really great at automating

00:29:14,140 --> 00:29:17,890
browsers and web apps and

00:29:16,000 --> 00:29:20,290
inside that so the definition is great

00:29:17,890 --> 00:29:22,060
for automating everything else some

00:29:20,290 --> 00:29:25,360
desktop application that you need to run

00:29:22,060 --> 00:29:27,640
and you Python GUI to control the mouse

00:29:25,360 --> 00:29:30,100
and keyboard but even inside the browser

00:29:27,640 --> 00:29:34,150
you get something like flash or html5

00:29:30,100 --> 00:29:36,190
canvas and you need to click on

00:29:34,150 --> 00:29:38,340
somewhere inside of that and use peyote

00:29:36,190 --> 00:29:40,750
GUI to click on something in particular

00:29:38,340 --> 00:29:43,420
inside the browser that's not an HTML

00:29:40,750 --> 00:29:45,430
element but the best thing I think for

00:29:43,420 --> 00:29:50,950
using the GUI automation is to write box

00:29:45,430 --> 00:29:53,470
that will keep that flash games so last

00:29:50,950 --> 00:29:58,240
and also most ambitious live demo of

00:29:53,470 --> 00:30:02,110
this entire presentation is this one

00:29:58,240 --> 00:30:04,360
coming up right now so I have there's

00:30:02,110 --> 00:30:08,860
this flash game called sushi go round

00:30:04,360 --> 00:30:11,320
and it's like a really dumb game like

00:30:08,860 --> 00:30:12,760
all flash games are the other customers

00:30:11,320 --> 00:30:14,230
that come in and they order sushi you

00:30:12,760 --> 00:30:15,850
need to click on all the ingredients

00:30:14,230 --> 00:30:17,470
reserve them and they're constantly

00:30:15,850 --> 00:30:19,930
coming in and out and you need to order

00:30:17,470 --> 00:30:21,340
ingredients as they run low and it takes

00:30:19,930 --> 00:30:30,550
a lot of practice to get good at this

00:30:21,340 --> 00:30:35,730
game this is up on my github or you can

00:30:30,550 --> 00:30:40,620
just google for sushi go round by so

00:30:35,730 --> 00:30:40,620
totally automated sushi go round player

00:30:41,130 --> 00:30:48,970
ok let's see if this actually works

00:30:45,810 --> 00:30:50,920
ok get everything set up sacrifice a

00:30:48,970 --> 00:30:54,640
chicken behind the podium to appease the

00:30:50,920 --> 00:30:56,350
gods and let's go totally hands-off it's

00:30:54,640 --> 00:30:58,690
gonna play this game for us so it uses

00:30:56,350 --> 00:31:01,540
image recognition to plank where on the

00:30:58,690 --> 00:31:03,610
screen it is and I pre-programmed the

00:31:01,540 --> 00:31:06,790
locations of all the sushi ingredients

00:31:03,610 --> 00:31:07,909
so it can detect what what the customer

00:31:06,790 --> 00:31:11,629
wants

00:31:07,909 --> 00:31:13,219
send that out hitting low on supplies

00:31:11,629 --> 00:31:16,789
it'll kick up the phone and start

00:31:13,219 --> 00:31:21,919
ordering all these ingredients yeah so

00:31:16,789 --> 00:31:24,139
there's it's not perfect come out and

00:31:21,919 --> 00:31:26,419
you can sort of get confused at times

00:31:24,139 --> 00:31:28,309
but it gets a high score that's way

00:31:26,419 --> 00:31:31,690
higher than anything I've ever gotten

00:31:28,309 --> 00:31:31,690
playing this game by myself Oh

00:31:32,389 --> 00:31:36,679
so I've already taken like screenshots

00:31:34,279 --> 00:31:38,029
of all the little bits of sushi that are

00:31:36,679 --> 00:31:40,429
floating above their head so it just

00:31:38,029 --> 00:31:42,469
checks that region or you know like

00:31:40,429 --> 00:31:44,449
other were they ordering this like when

00:31:42,469 --> 00:31:46,129
you sushi or something interest checks

00:31:44,449 --> 00:31:48,739
to see which image is floating in that

00:31:46,129 --> 00:31:50,839
in that region and then it knows I

00:31:48,739 --> 00:31:54,829
pre-programmed all these recipes for

00:31:50,839 --> 00:31:57,049
everything else there yeah although I

00:31:54,829 --> 00:31:58,909
will note that the top players in the

00:31:57,049 --> 00:32:01,699
high score for this game or have like

00:31:58,909 --> 00:32:06,669
double the score of this bot which is

00:32:01,699 --> 00:32:06,669
really impressive and hypothetical

00:32:07,870 --> 00:32:11,780
great okay so when I want to stop this I

00:32:10,580 --> 00:32:15,700
can just trigger the failsafe by

00:32:11,780 --> 00:32:15,700
slinging the mouse up and to the left

00:32:27,570 --> 00:32:32,320
that's how you install a man peyote GUI

00:32:30,370 --> 00:32:33,639
the book again is automate the boring

00:32:32,320 --> 00:32:36,039
stuff with Python that you can read for

00:32:33,639 --> 00:32:39,419
free online there's my twitter that

00:32:36,039 --> 00:32:39,419

YouTube URL: https://www.youtube.com/watch?v=IJewV7o1bwU


