Title: Modern Email Security - Fredrik Söderblom
Publication date: 2019-04-17
Playlist: foss-north 2019
Description: 
	In times when a major infection vector is email, it is relevant to use existing protection mechanisms (SPF, DKIM, DMARC, DNSSEC, STARTTLS etc) to protect your company and your company's customers. This presentaion by Fredrik Söderblom from StoredSafe will show how you can protect incoming and outgoing emails with relatively simple means, as well as run you through emerging techniques such as MTA-STS, TLS-RPT, ARC etc.

---

Fredrik has been working in the IT industry for more than 25 years, and has been involved with the Internet and security since 1992, when he designed and implemented the first firewall for Hewlett Packard in northern Europe.
Fredrik joined HP as a systems engineer at the Swedish customer response center in 1991, working mainly with compiler and kernel support. In 1995 he joined the Professional Services Organization as a senior security consultant, where he was part of forming the network security consultant group for Europe. Prior to joining HP, he worked 7 years as a programmer for Databolin, a Swedish software company.
He has designed and implemented various network perimeter security solutions in Europe and the United States, as well as performed numerous security audits.

https://foss-north.se/2019/speakers-and-talks.html#fsoderblom
Captions: 
	00:00:15,519 --> 00:00:18,539
yeah hi

00:00:18,630 --> 00:00:23,179
sarvam I'm from a company called stored

00:00:20,550 --> 00:00:28,439
safe I'm here to talk to you about

00:00:23,179 --> 00:00:32,489
modern email security so let's do a

00:00:28,439 --> 00:00:36,390
raise of hands how many of you are

00:00:32,489 --> 00:00:41,420
actually involved in administrating an

00:00:36,390 --> 00:00:46,589
MTA today 10 people thank you

00:00:41,420 --> 00:00:49,649
how many of you have SPF set up all of

00:00:46,589 --> 00:00:50,760
you and keep your hand raised if you

00:00:49,649 --> 00:00:55,729
have set it up correctly

00:00:50,760 --> 00:00:59,009
I have statistics that says you haven't

00:00:55,729 --> 00:01:02,360
how many of you are using D key I BK I

00:00:59,009 --> 00:01:07,519
am for signing in email good

00:01:02,360 --> 00:01:07,519
anybody in here using office 365 oh

00:01:07,520 --> 00:01:15,119
that's ok anybody in here having

00:01:11,070 --> 00:01:17,869
customers using office 365 cool I'll

00:01:15,119 --> 00:01:21,390
give you a couple of hints at the end

00:01:17,869 --> 00:01:23,609
why most likely most of their email will

00:01:21,390 --> 00:01:30,030
get reacted when they'll start using D

00:01:23,609 --> 00:01:36,990
mark due to some for sites or mishaps

00:01:30,030 --> 00:01:41,009
and how to fix it so that's me

00:01:36,990 --> 00:01:45,749
I started out running my own company so

00:01:41,009 --> 00:01:47,850
let's see 2002 XP D we focus on IT

00:01:45,749 --> 00:01:52,139
security so that's basically my main

00:01:47,850 --> 00:01:54,499
line of work we've been doing audits in

00:01:52,139 --> 00:01:58,560
the US and Europe I do security audits

00:01:54,499 --> 00:02:01,139
which basically led us to creating a

00:01:58,560 --> 00:02:03,840
Swedish startup that deals with crypto

00:02:01,139 --> 00:02:06,359
cryptography because basically this was

00:02:03,840 --> 00:02:08,399
one of the things that we see all the

00:02:06,359 --> 00:02:11,220
time when doing audits especially in the

00:02:08,399 --> 00:02:15,240
u.s. that people really don't have a

00:02:11,220 --> 00:02:18,030
good way of sharing and storing secrets

00:02:15,240 --> 00:02:20,040
like passwords so typically we hit the

00:02:18,030 --> 00:02:22,080
customer and they have the same

00:02:20,040 --> 00:02:26,069
passwords on three hundred routers and

00:02:22,080 --> 00:02:27,960
switches so basically we made a Swedish

00:02:26,069 --> 00:02:28,440
startup that basically solved this

00:02:27,960 --> 00:02:33,530
problem

00:02:28,440 --> 00:02:33,530
an empty enterprise-wide password

00:02:33,629 --> 00:02:40,510
but today's agenda is not about that

00:02:36,430 --> 00:02:44,680
it's about email I'll try to give you a

00:02:40,510 --> 00:02:46,840
bit of motivation why this would be at

00:02:44,680 --> 00:02:48,340
least on the top spot

00:02:46,840 --> 00:02:50,620
of the agenda of some of your companies

00:02:48,340 --> 00:02:52,780
that you're working with or your

00:02:50,620 --> 00:02:56,470
customers we'll talk a little bit about

00:02:52,780 --> 00:03:02,109
mitigations how can you actually try to

00:02:56,470 --> 00:03:05,019
stop the evilness that can happen

00:03:02,109 --> 00:03:08,079
a little bit about future well as you

00:03:05,019 --> 00:03:10,060
can see there's a lot of problems we'll

00:03:08,079 --> 00:03:14,829
talk about them I'll try to highlight

00:03:10,060 --> 00:03:17,650
them but there's also the situation

00:03:14,829 --> 00:03:20,620
today as we see them with phishing

00:03:17,650 --> 00:03:23,799
wailing malware it's not really

00:03:20,620 --> 00:03:26,139
necessary there has been means to stop

00:03:23,799 --> 00:03:29,560
it rather effectively or at least

00:03:26,139 --> 00:03:33,189
minimize the problems of it for several

00:03:29,560 --> 00:03:37,359
years now people just don't use it and I

00:03:33,189 --> 00:03:41,739
also propose an action plan to actually

00:03:37,359 --> 00:03:42,870
mitigate the situation so what's the big

00:03:41,739 --> 00:03:49,989
fuss

00:03:42,870 --> 00:03:53,879
it's just male right the problem this is

00:03:49,989 --> 00:04:00,040
the problem there's 100 billion emails

00:03:53,879 --> 00:04:07,690
every single day 100 billion that's a

00:04:00,040 --> 00:04:10,949
lot of emails well just mail well the

00:04:07,690 --> 00:04:14,319
problem is it is has been and still is

00:04:10,949 --> 00:04:16,299
one of the major threat vectors this is

00:04:14,319 --> 00:04:19,690
why this is interesting for me doing IT

00:04:16,299 --> 00:04:22,479
security this is the main reason for my

00:04:19,690 --> 00:04:25,720
companies my customers to get infected

00:04:22,479 --> 00:04:28,389
and to have problems problems that can

00:04:25,720 --> 00:04:31,870
range from a single workstation not

00:04:28,389 --> 00:04:36,610
working could be okay unless it's some

00:04:31,870 --> 00:04:39,099
part of a SCADA system or it could

00:04:36,610 --> 00:04:43,919
actually be like mask where they had to

00:04:39,099 --> 00:04:45,700
reinstall 4,500 servers 15,000 clients

00:04:43,919 --> 00:04:49,600
over 10 days

00:04:45,700 --> 00:04:54,790
they lost 300 million dollars over those

00:04:49,600 --> 00:04:57,370
10 days and that was just for malware

00:04:54,790 --> 00:05:00,130
that basically in a few couple of

00:04:57,370 --> 00:05:07,000
minutes wiped out their network or the

00:05:00,130 --> 00:05:09,910
service what the real problem is as you

00:05:07,000 --> 00:05:14,380
all are already familiar with the

00:05:09,910 --> 00:05:17,310
problem is this our users are customers

00:05:14,380 --> 00:05:20,940
their clients Lisa

00:05:17,310 --> 00:05:24,430
Henrick working over at economics or

00:05:20,940 --> 00:05:28,120
order entry or a sales guy they can't ID

00:05:24,430 --> 00:05:32,110
they can't spot the fake it's getting

00:05:28,120 --> 00:05:37,980
increasingly harder as well but this is

00:05:32,110 --> 00:05:41,670
basically the problem we are throwing

00:05:37,980 --> 00:05:44,500
the cool the fun stuff at the problem

00:05:41,670 --> 00:05:46,420
all the stuff over here electronics and

00:05:44,500 --> 00:05:50,950
stuff but the problem is really this

00:05:46,420 --> 00:05:54,460
human error so the short version of

00:05:50,950 --> 00:05:58,060
today's talk was basically be that if we

00:05:54,460 --> 00:05:59,800
could educate our users none of this

00:05:58,060 --> 00:06:01,390
would have been necessary at all you

00:05:59,800 --> 00:06:03,100
would need to have any type of

00:06:01,390 --> 00:06:04,930
anti-malware or anything on your

00:06:03,100 --> 00:06:06,520
computers more or less if you could

00:06:04,930 --> 00:06:10,240
educate your users correctly

00:06:06,520 --> 00:06:12,190
that's a nutopia so basically what I'm

00:06:10,240 --> 00:06:14,440
trying to suggest is that you always

00:06:12,190 --> 00:06:18,610
have to have a mix of Education and

00:06:14,440 --> 00:06:21,730
Technology we tend to ignore the people

00:06:18,610 --> 00:06:28,810
fact but that's very very important part

00:06:21,730 --> 00:06:31,240
of it and this is from HIPAA giorno hip

00:06:28,810 --> 00:06:36,610
how many is all familiar with hip pain

00:06:31,240 --> 00:06:39,880
here of you working in healthcare ok

00:06:36,610 --> 00:06:46,900
it's basically an act in the u.s. that

00:06:39,880 --> 00:06:49,440
says that if a hospital loses one single

00:06:46,900 --> 00:06:56,160
piece of electronic health information

00:06:49,440 --> 00:06:56,160
patient data they take the IT manager

00:06:56,420 --> 00:07:01,700
lift them up and drop him down on Riker

00:06:59,060 --> 00:07:04,490
island for three years of prison that's

00:07:01,700 --> 00:07:06,470
how you deal with bad email or bad

00:07:04,490 --> 00:07:09,200
security in the u.s. when it comes to

00:07:06,470 --> 00:07:12,200
hospitals I did what is over in the u.s.

00:07:09,200 --> 00:07:15,740
back in 2003 before HIPAA was in effect

00:07:12,200 --> 00:07:17,990
and for them it really worked because

00:07:15,740 --> 00:07:22,120
the difference for US hospitals before

00:07:17,990 --> 00:07:25,940
and after HIPAA is an order of magnitude

00:07:22,120 --> 00:07:29,360
but as HIPAA journal confirms email is

00:07:25,940 --> 00:07:32,830
still the top attack vector if you can

00:07:29,360 --> 00:07:35,810
see from sons a little snippet here

00:07:32,830 --> 00:07:38,560
email Brodie's most of the malware into

00:07:35,810 --> 00:07:38,560
organization

00:07:42,590 --> 00:07:47,900
this is kind of interesting we kind of

00:07:45,290 --> 00:07:51,020
use that we tell people oh watch out for

00:07:47,900 --> 00:07:52,910
the attachments are you email well

00:07:51,020 --> 00:07:55,460
what's been on the rise lately is

00:07:52,910 --> 00:07:58,400
basically not that it's fishing or

00:07:55,460 --> 00:08:02,510
whaling and that type of stuff and you

00:07:58,400 --> 00:08:05,030
can see from 2000 and second quarter

00:08:02,510 --> 00:08:08,240
third quarter in 2018 it's slightly old

00:08:05,030 --> 00:08:13,010
figures and these figures are actually

00:08:08,240 --> 00:08:15,980
from proof point so fishing through

00:08:13,010 --> 00:08:18,800
email has been only rice it looks like

00:08:15,980 --> 00:08:22,280
this so the red one is basically

00:08:18,800 --> 00:08:29,240
malicious attachments and the blue one

00:08:22,280 --> 00:08:30,620
is malicious URL messages so something

00:08:29,240 --> 00:08:34,729
is happening here we're still using

00:08:30,620 --> 00:08:38,120
email as an attack vector this is also

00:08:34,729 --> 00:08:40,880
kind of very interesting figures the

00:08:38,120 --> 00:08:43,550
gray the red area here is what you think

00:08:40,880 --> 00:08:49,310
you're protecting your users from with

00:08:43,550 --> 00:08:52,870
anti-malware that's just ten percent of

00:08:49,310 --> 00:08:55,130
the blocked attacks contains the type of

00:08:52,870 --> 00:08:57,320
threat to your organization

00:08:55,130 --> 00:09:00,560
ninety percent of the blocked attacks

00:08:57,320 --> 00:09:05,150
actually contains impersonation whaling

00:09:00,560 --> 00:09:09,070
spearfishing the w-2 fraud is that the

00:09:05,150 --> 00:09:09,070
US tax form

00:09:09,330 --> 00:09:17,160
so typically what can we see we see

00:09:13,380 --> 00:09:20,610
emails coming out to you me your

00:09:17,160 --> 00:09:27,060
customers your want your parents with

00:09:20,610 --> 00:09:30,950
links to fill in information so that's

00:09:27,060 --> 00:09:33,900
that's one of the major problems okay so

00:09:30,950 --> 00:09:37,320
let's talk through the mitigation so how

00:09:33,900 --> 00:09:40,170
can we actually get try to mitigate it

00:09:37,320 --> 00:09:46,980
try to stop it as early as possible make

00:09:40,170 --> 00:09:49,880
it harder to fool people yeah

00:09:46,980 --> 00:09:55,440
so this is typically what I show to

00:09:49,880 --> 00:10:01,050
management type of board etc to explain

00:09:55,440 --> 00:10:05,790
the stupidity of the SMTP protocol hands

00:10:01,050 --> 00:10:08,430
up for anybody that loves SMTP know it's

00:10:05,790 --> 00:10:12,450
a really stupid protocol it's in the

00:10:08,430 --> 00:10:15,350
order of it your today as si the SIP

00:10:12,450 --> 00:10:19,710
protocol is really extremely stupid

00:10:15,350 --> 00:10:25,230
designed back when everybody was good

00:10:19,710 --> 00:10:28,590
more or less a good example that would

00:10:25,230 --> 00:10:32,280
be like the 6e back back Torian to send

00:10:28,590 --> 00:10:34,800
mail that era Kelman hadn't back back in

00:10:32,280 --> 00:10:37,290
the original source code that really

00:10:34,800 --> 00:10:39,390
wouldn't work that well today so this is

00:10:37,290 --> 00:10:41,250
basically overview of the main problem

00:10:39,390 --> 00:10:44,520
the main problem with SMTP is that we

00:10:41,250 --> 00:10:47,550
have different types of sender from

00:10:44,520 --> 00:10:51,510
addresses so we are one on the actual

00:10:47,550 --> 00:10:54,390
envelope it's called RFC 5321 mail from

00:10:51,510 --> 00:10:57,720
field and we have a different from

00:10:54,390 --> 00:11:02,670
within the actual email the RFC 5322

00:10:57,720 --> 00:11:05,820
address I'll just you I'll just move

00:11:02,670 --> 00:11:08,970
that out the side you are just the

00:11:05,820 --> 00:11:10,680
tester or change the camera IDs so in

00:11:08,970 --> 00:11:12,120
more technical details because I think

00:11:10,680 --> 00:11:15,180
this is more of a technical audience

00:11:12,120 --> 00:11:18,320
this is what we see so typically in the

00:11:15,180 --> 00:11:20,310
SMTP protocol we have one mail from

00:11:18,320 --> 00:11:21,240
that's part of the protocol

00:11:20,310 --> 00:11:24,720
specification

00:11:21,240 --> 00:11:30,869
and then you have another from which is

00:11:24,720 --> 00:11:33,899
within the actual email body so parts of

00:11:30,869 --> 00:11:38,759
the mitigations and we'll talk through

00:11:33,899 --> 00:11:41,040
all of these so let's start by examining

00:11:38,759 --> 00:11:42,920
problem or actually two problems at the

00:11:41,040 --> 00:11:45,360
same time this is actually bound for

00:11:42,920 --> 00:11:50,819
Destruction doing two things at the same

00:11:45,360 --> 00:11:54,990
time so can every can you see at the

00:11:50,819 --> 00:11:57,769
back Rheda text okay good so this is

00:11:54,990 --> 00:12:00,389
basically just using something similar

00:11:57,769 --> 00:12:02,850
netcat total nut you can speak to any

00:12:00,389 --> 00:12:05,129
smtp server out there this is more of a

00:12:02,850 --> 00:12:11,269
surprise for other type of audience but

00:12:05,129 --> 00:12:13,920
let's walk through it anyway so SMTP is

00:12:11,269 --> 00:12:16,170
a nice protocol in terms that you can

00:12:13,920 --> 00:12:18,779
simulate it with telnet or netcat it's

00:12:16,170 --> 00:12:22,499
not like h.323 or something that's a

00:12:18,779 --> 00:12:27,209
binary protocol so here's an evil guy

00:12:22,499 --> 00:12:31,129
he's contacting the mail server at SMTP

00:12:27,209 --> 00:12:34,199
Corp comm he says that the mail is from

00:12:31,129 --> 00:12:37,379
basically zone address this is kind of

00:12:34,199 --> 00:12:41,399
fine because that address won't be used

00:12:37,379 --> 00:12:45,149
for anything besides checks he says that

00:12:41,399 --> 00:12:48,799
the mail should go to Tom and the mail

00:12:45,149 --> 00:12:52,490
services yeah sure go ahead

00:12:48,799 --> 00:12:55,519
so that's describing the first problem

00:12:52,490 --> 00:12:58,350
and the second problem is basically this

00:12:55,519 --> 00:13:02,069
transmitting stuff in clear text this is

00:12:58,350 --> 00:13:04,829
clearly not good if you are dissident

00:13:02,069 --> 00:13:09,299
working in China or North Korea or

00:13:04,829 --> 00:13:11,459
something so any chain I could easily

00:13:09,299 --> 00:13:14,189
understand that all of this text could

00:13:11,459 --> 00:13:16,879
have easily been manipulated by a man in

00:13:14,189 --> 00:13:19,889
the middle so that's the second problem

00:13:16,879 --> 00:13:25,799
so let's look at the first problem so

00:13:19,889 --> 00:13:27,660
basically the evil guy he started by

00:13:25,799 --> 00:13:30,149
using the mail from up here he said

00:13:27,660 --> 00:13:32,490
who's the mail to and then when he's

00:13:30,149 --> 00:13:34,570
formulating the email he says the mail

00:13:32,490 --> 00:13:36,730
is actually from John Doe

00:13:34,570 --> 00:13:38,260
John at corporate calm and this is

00:13:36,730 --> 00:13:42,610
actually the address that will be shown

00:13:38,260 --> 00:13:44,290
in the email telling client and oh well

00:13:42,610 --> 00:13:47,350
Tom what's your stance on new employee

00:13:44,290 --> 00:13:50,820
benefit program and a link probably

00:13:47,350 --> 00:13:52,870
giving an opportunity to two entries

00:13:50,820 --> 00:13:54,910
account details or something or

00:13:52,870 --> 00:13:57,910
authentication so we can steal it

00:13:54,910 --> 00:13:59,290
this is actually almost part of a real

00:13:57,910 --> 00:14:02,020
campaign that we've been using at

00:13:59,290 --> 00:14:04,090
customers can you can somebody guess how

00:14:02,020 --> 00:14:12,690
many people will actually click this

00:14:04,090 --> 00:14:20,500
link when it looks like this there yeah

00:14:12,690 --> 00:14:23,470
half higher 70% clicks this link 70

00:14:20,500 --> 00:14:28,960
percent we've done it on hospitals with

00:14:23,470 --> 00:14:31,900
over 10,000 employees say again oh okay

00:14:28,960 --> 00:14:36,430
so as you can see that the effect of

00:14:31,900 --> 00:14:38,980
such an EC spoofing is kind of scary for

00:14:36,430 --> 00:14:45,970
- Tom this actually looks like a perfect

00:14:38,980 --> 00:14:49,570
email from his body John so to fix the

00:14:45,970 --> 00:14:55,810
second problem where we had clear text

00:14:49,570 --> 00:15:00,100
we have start TLS almost anyone running

00:14:55,810 --> 00:15:04,420
a fairly modern MTA today has supported

00:15:00,100 --> 00:15:06,400
or TLS so start TLS is something that

00:15:04,420 --> 00:15:11,770
the server can announce that I support

00:15:06,400 --> 00:15:13,780
TLS if it's supported we can use it the

00:15:11,770 --> 00:15:17,470
client can say ok let's switch to a

00:15:13,780 --> 00:15:22,480
binary encrypted protocol and no one can

00:15:17,470 --> 00:15:24,670
see the text and one can mess with it so

00:15:22,480 --> 00:15:28,810
this is the right type of audience

00:15:24,670 --> 00:15:31,680
what's the cardinal error with this

00:15:28,810 --> 00:15:31,680
setup

00:15:33,930 --> 00:15:38,570
perfect

00:15:35,649 --> 00:15:40,339
so the answer was you can man little

00:15:38,570 --> 00:15:44,029
needle because this is clear text and

00:15:40,339 --> 00:15:52,209
you can remove the 250 start TLS and

00:15:44,029 --> 00:15:54,800
then the client will just do paint X so

00:15:52,209 --> 00:15:57,560
start TLS to care the encryption problem

00:15:54,800 --> 00:16:00,260
sort of it's not a perfect solution

00:15:57,560 --> 00:16:04,370
there's remedy to that as well coming

00:16:00,260 --> 00:16:07,399
later sadly though spot or still in

00:16:04,370 --> 00:16:12,440
draft mode but at least it looks a bit

00:16:07,399 --> 00:16:14,959
brighter on the horizon so but why why

00:16:12,440 --> 00:16:17,139
on earth can anyone send email from any

00:16:14,959 --> 00:16:21,050
domain well

00:16:17,139 --> 00:16:26,660
SPF to the rescue SPF is published in

00:16:21,050 --> 00:16:31,180
DNS very shortly this is just doing dig

00:16:26,660 --> 00:16:31,180
on the SPF records for evildoer calm

00:16:31,329 --> 00:16:38,380
basically this record says something

00:16:35,000 --> 00:16:38,380
what does it say

00:16:52,110 --> 00:16:58,690
so basically says anybody that actually

00:16:56,260 --> 00:17:03,010
is part of the MX record for this domain

00:16:58,690 --> 00:17:08,470
are authorized to send email as evildoer

00:17:03,010 --> 00:17:10,650
calm the - all at the end what does it

00:17:08,470 --> 00:17:10,650
mean

00:17:17,429 --> 00:17:24,399
yeah until they all if you have a tilde

00:17:22,299 --> 00:17:30,639
and all or a question mark isn't that

00:17:24,399 --> 00:17:33,609
the same yep so this is the proper way

00:17:30,639 --> 00:17:36,609
of doing it - all this is the way it

00:17:33,609 --> 00:17:39,489
should look like that's a hard fail so

00:17:36,609 --> 00:17:42,989
if an email arrives it can't pass

00:17:39,489 --> 00:17:46,539
validation - all ensures a hard fail

00:17:42,989 --> 00:17:51,159
anything else is crap should be used for

00:17:46,539 --> 00:17:53,710
a limited time for testing so that this

00:17:51,159 --> 00:17:57,639
is the sorry state of SPF in Sweden on

00:17:53,710 --> 00:17:58,869
the SD domain this is data from late

00:17:57,639 --> 00:18:01,330
00:17:58,869 --> 00:18:06,849
this is doing on almost 1 million

00:18:01,330 --> 00:18:11,019
domains so only 160,000 of those domain

00:18:06,849 --> 00:18:16,109
deployed SPF the rest were out didn't

00:18:11,019 --> 00:18:21,029
have an SPF record out of those 16%

00:18:16,109 --> 00:18:23,919
how many managed to actually create a

00:18:21,029 --> 00:18:26,619
correct SPF record it wasn't all that

00:18:23,919 --> 00:18:28,779
complicated was it you saw it in the

00:18:26,619 --> 00:18:32,799
previous example how many I guess well

00:18:28,779 --> 00:18:39,070
guess 1% that's too low that's just evil

00:18:32,799 --> 00:18:40,330
but I like it another guess 160,000

00:18:39,070 --> 00:18:44,080
domains how many are correctly

00:18:40,330 --> 00:18:50,710
configured no sorry

00:18:44,080 --> 00:18:53,559
- I 6% sorry 6% out of those hundred and

00:18:50,710 --> 00:18:57,729
sixty thousand out of those 16% only 6%

00:18:53,559 --> 00:19:02,859
have had a correct SPF records the other

00:18:57,729 --> 00:19:05,109
contained errors or had soft fail so

00:19:02,859 --> 00:19:07,450
this is stuff that's been out there for

00:19:05,109 --> 00:19:09,999
a very very very long time it's not

00:19:07,450 --> 00:19:11,460
complicated to set up still people don't

00:19:09,999 --> 00:19:17,409
get it right

00:19:11,460 --> 00:19:19,509
anyone from post node in here no sorry

00:19:17,409 --> 00:19:21,369
I'll try to do that on every occasion I

00:19:19,509 --> 00:19:24,009
can because basically if you look at

00:19:21,369 --> 00:19:28,679
post no comm if you have your fines up

00:19:24,009 --> 00:19:28,679
to a dig tell me what you see

00:19:29,170 --> 00:19:34,040
I'll tell you what they see they'll see

00:19:31,910 --> 00:19:37,030
post no calm actually announced an SPF

00:19:34,040 --> 00:19:40,850
record that tells people that over

00:19:37,030 --> 00:19:46,400
100,000 email id addresses can mail at

00:19:40,850 --> 00:19:50,140
as post neucom who was the main

00:19:46,400 --> 00:19:55,640
perpetrator behind forged email

00:19:50,140 --> 00:19:58,910
2016-2017 post note what did they end

00:19:55,640 --> 00:20:00,500
their SPF record with we don't know they

00:19:58,910 --> 00:20:02,660
have a question mark wall which

00:20:00,500 --> 00:20:05,060
basically says well these are the

00:20:02,660 --> 00:20:07,100
hundred and ten or hundred and fourteen

00:20:05,060 --> 00:20:10,940
thousand IP addresses that can mail as

00:20:07,100 --> 00:20:13,820
post no calm but just to be sure we

00:20:10,940 --> 00:20:16,430
really don't know it could be more so

00:20:13,820 --> 00:20:18,980
you should let anybody else email at

00:20:16,430 --> 00:20:23,200
post not calm as well that's that's what

00:20:18,980 --> 00:20:26,780
I call a double facepalm basically so

00:20:23,200 --> 00:20:29,030
why could anybody Forge email from my

00:20:26,780 --> 00:20:32,420
domain from core calm how is that

00:20:29,030 --> 00:20:37,400
possible well basically the first try

00:20:32,420 --> 00:20:42,920
was SPF with CM I failed I'd say with

00:20:37,400 --> 00:20:46,340
six percent kind of well yes another

00:20:42,920 --> 00:20:52,460
standard came along this is actually a

00:20:46,340 --> 00:20:57,050
mix between two two main key and DKIM

00:20:52,460 --> 00:21:01,310
came out of that basically it's rather

00:20:57,050 --> 00:21:03,530
clever on the MTA side on the sending

00:21:01,310 --> 00:21:05,360
side you create a public key and a

00:21:03,530 --> 00:21:08,480
private key you keep the private key to

00:21:05,360 --> 00:21:12,320
yourself you publish the public key in

00:21:08,480 --> 00:21:18,440
DNS you use the private key to sign

00:21:12,320 --> 00:21:23,960
certain headers of the RFC 5322 body so

00:21:18,440 --> 00:21:27,230
to say so this is DKIM signature what it

00:21:23,960 --> 00:21:30,110
gives us is a perfect opportunity when I

00:21:27,230 --> 00:21:32,590
receive email I can actually check the

00:21:30,110 --> 00:21:38,720
signature by retrieving the public key

00:21:32,590 --> 00:21:42,260
from DNS and just see okay so this is

00:21:38,720 --> 00:21:45,380
what he's been checksumming or signing

00:21:42,260 --> 00:21:50,480
just basically check the signature so

00:21:45,380 --> 00:21:53,510
perfect isn't it so really good it

00:21:50,480 --> 00:21:56,360
ensures that the D domain part of the

00:21:53,510 --> 00:22:02,570
decal DKIM signature is the same as the

00:21:56,360 --> 00:22:07,970
from address we store the public key in

00:22:02,570 --> 00:22:14,630
DNS the world's largest database as ml

00:22:07,970 --> 00:22:16,760
used to say it's true I love DNS so yep

00:22:14,630 --> 00:22:19,730
and if you want to check it on your own

00:22:16,760 --> 00:22:21,890
basically you need two parts you need to

00:22:19,730 --> 00:22:25,760
know the domain obviously but you also

00:22:21,890 --> 00:22:27,620
need to know the selector so if you have

00:22:25,760 --> 00:22:29,330
the selector and you can only get it if

00:22:27,620 --> 00:22:30,920
you get an email from me or from the

00:22:29,330 --> 00:22:33,800
domain you're interested in you

00:22:30,920 --> 00:22:36,470
basically has to dig on the selector dot

00:22:33,800 --> 00:22:40,390
underscore domain key dot domain and you

00:22:36,470 --> 00:22:42,970
will actually get out the public key

00:22:40,390 --> 00:22:49,360
easy easy

00:22:42,970 --> 00:22:54,110
so any issues for this you're silently

00:22:49,360 --> 00:22:58,070
well here's what I was crying about

00:22:54,110 --> 00:23:03,830
initially we are the RFC 5321 mailed

00:22:58,070 --> 00:23:06,830
from up here yeah we have RFC 5322 from

00:23:03,830 --> 00:23:09,830
down there use you all seen it

00:23:06,830 --> 00:23:11,920
well are you you're beginning to see the

00:23:09,830 --> 00:23:17,770
light now or the problem so the clouds

00:23:11,920 --> 00:23:25,480
SPF only restricts RFC 5321

00:23:17,770 --> 00:23:25,480
DK I am only Shakes the RFC 5322 from

00:23:28,120 --> 00:23:34,300
here be dragons

00:23:30,490 --> 00:23:39,520
this is clearly a problem this is also

00:23:34,300 --> 00:23:40,710
double-faced ball you're supposed to be

00:23:39,520 --> 00:23:46,660
laughing here

00:23:40,710 --> 00:23:47,880
good so at the third attempt we're

00:23:46,660 --> 00:23:51,490
getting somewhere

00:23:47,880 --> 00:23:56,500
how many in here is deploying a Demark

00:23:51,490 --> 00:24:01,030
policy one two three four five six

00:23:56,500 --> 00:24:06,570
how many of you still is at P equals

00:24:01,030 --> 00:24:06,570
none okay how long have you been there

00:24:08,460 --> 00:24:14,650
okay

00:24:09,790 --> 00:24:17,590
are you looking at the reports okay I

00:24:14,650 --> 00:24:18,400
will get in we'll get more into that

00:24:17,590 --> 00:24:25,410
later

00:24:18,400 --> 00:24:28,780
okay Demark checks the SPF results check

00:24:25,410 --> 00:24:31,150
so Demark in itself is just basically a

00:24:28,780 --> 00:24:34,260
subset of two different standard in it

00:24:31,150 --> 00:24:39,130
adds a snitch part of it to it

00:24:34,260 --> 00:24:42,700
damar checks the DKIM result and it

00:24:39,130 --> 00:24:49,080
actually compares the RFC trent 53:21

00:24:42,700 --> 00:24:50,950
from and RFC 5322 from if they match or

00:24:49,080 --> 00:24:53,350
semi-matte you can have it like a

00:24:50,950 --> 00:24:56,650
relaxed or strict check but they still

00:24:53,350 --> 00:24:58,110
have to be the correct apex of the

00:24:56,650 --> 00:25:01,810
domain but you could have like

00:24:58,110 --> 00:25:07,120
example.com if you're doing a relaxed

00:25:01,810 --> 00:25:11,530
chicken so in this case the mark will

00:25:07,120 --> 00:25:18,070
look for a match and this two won't

00:25:11,530 --> 00:25:20,080
match so this is remake Demark fail so

00:25:18,070 --> 00:25:23,590
we could actually stop this crappy email

00:25:20,080 --> 00:25:29,740
at our external border wouldn't this be

00:25:23,590 --> 00:25:31,540
perfect yeah the problem is we still

00:25:29,740 --> 00:25:35,380
need to make sure that our customers

00:25:31,540 --> 00:25:38,500
deploy Demark and you can do it in a

00:25:35,380 --> 00:25:40,510
sane way and we'll get into that as well

00:25:38,500 --> 00:25:44,080
d-mort the snitch this is my favorite

00:25:40,510 --> 00:25:45,600
part built into the protocol is also

00:25:44,080 --> 00:25:49,919
report

00:25:45,600 --> 00:25:53,590
so this is how you check a Demark record

00:25:49,919 --> 00:25:55,630
so well first you have like a version

00:25:53,590 --> 00:25:59,860
identification then you have your policy

00:25:55,630 --> 00:26:02,350
so if the Demark checks fails expedite

00:25:59,860 --> 00:26:04,840
tells people that you should react email

00:26:02,350 --> 00:26:07,600
that purports to be from expedited OTC

00:26:04,840 --> 00:26:09,640
if it doesn't pause the demo check you

00:26:07,600 --> 00:26:15,370
can throw it away we don't care because

00:26:09,640 --> 00:26:19,440
it's not from us the other part is if

00:26:15,370 --> 00:26:22,350
you well you are received emails from us

00:26:19,440 --> 00:26:26,649
either if they're successful or failed

00:26:22,350 --> 00:26:31,960
please send an aggregate report to this

00:26:26,649 --> 00:26:36,429
address so every typically the default

00:26:31,960 --> 00:26:39,340
is actually once a day so once per day

00:26:36,429 --> 00:26:42,580
there will actually be an XML sift XML

00:26:39,340 --> 00:26:45,309
file with reports coming in to these

00:26:42,580 --> 00:26:47,950
addresses from all over the world the

00:26:45,309 --> 00:26:50,529
cool part about this is it will give

00:26:47,950 --> 00:26:53,350
your customers insight in to how their

00:26:50,529 --> 00:26:57,010
domain is used without them being

00:26:53,350 --> 00:27:01,260
involved so if you have a democritus for

00:26:57,010 --> 00:27:03,669
Volvo and someone in Brazil is trying to

00:27:01,260 --> 00:27:07,870
send phishing emails to someone in

00:27:03,669 --> 00:27:09,490
Australia actually in Australia if

00:27:07,870 --> 00:27:12,240
someone is using the mark they will

00:27:09,490 --> 00:27:15,100
actually report that back to Volvo a

00:27:12,240 --> 00:27:18,039
situation was completely undetectable

00:27:15,100 --> 00:27:20,919
before so this is the third really

00:27:18,039 --> 00:27:27,179
really good thing with the market do you

00:27:20,919 --> 00:27:30,399
mark the snitch is your friend if you

00:27:27,179 --> 00:27:33,210
either you purchase services like I do a

00:27:30,399 --> 00:27:36,120
lazy guy or you can write it yourself

00:27:33,210 --> 00:27:38,950
there's some code out there to do this

00:27:36,120 --> 00:27:41,230
this is actually post but this is

00:27:38,950 --> 00:27:45,010
purchase service I buy from a company

00:27:41,230 --> 00:27:49,120
called e marking in Holland and you get

00:27:45,010 --> 00:27:55,000
really nice stuff regarding your email

00:27:49,120 --> 00:27:58,130
flow and this is also an IOC more or

00:27:55,000 --> 00:28:03,530
less so for this customer all of us

00:27:58,130 --> 00:28:09,200
on this day they had 2700 reacted emails

00:28:03,530 --> 00:28:11,660
so that wasn't a phishing campaign so it

00:28:09,200 --> 00:28:13,820
also gives you other insight that you

00:28:11,660 --> 00:28:17,270
could feed back to your eyes team or log

00:28:13,820 --> 00:28:22,370
team or ops team or sock so Demark is

00:28:17,270 --> 00:28:25,280
good the reporting stuff also makes it

00:28:22,370 --> 00:28:34,580
possible for you to to roll out Demark

00:28:25,280 --> 00:28:39,770
in the same way yep so the

00:28:34,580 --> 00:28:42,440
recommendations are ensure that you move

00:28:39,770 --> 00:28:44,090
all third-party senders aren't quite

00:28:42,440 --> 00:28:45,950
sure that you don't have any third-party

00:28:44,090 --> 00:28:50,030
centers on your domains but your

00:28:45,950 --> 00:28:52,700
customers most likely have up sees or

00:28:50,030 --> 00:28:57,169
someone else emailing out newsletters or

00:28:52,700 --> 00:28:59,230
anything from them don't do that stop

00:28:57,169 --> 00:29:03,549
doing that

00:28:59,230 --> 00:29:07,220
move them from the customers domain

00:29:03,549 --> 00:29:13,220
Volvo put dot SC to AB C's dot Volvo dot

00:29:07,220 --> 00:29:16,340
se and ensure that you have a clean SPF

00:29:13,220 --> 00:29:20,240
on the up X only you and your employees

00:29:16,340 --> 00:29:24,530
should be able to mail from your objects

00:29:20,240 --> 00:29:27,860
of your domain set up the mark reporting

00:29:24,530 --> 00:29:29,630
and use it monitor it because it will

00:29:27,860 --> 00:29:35,870
give you benefits that you didn't have

00:29:29,630 --> 00:29:40,880
before do a phased rollout or D mark

00:29:35,870 --> 00:29:44,090
it's in the protocol you can publish a

00:29:40,880 --> 00:29:46,880
policy of none keep it like that for a

00:29:44,090 --> 00:29:50,179
couple of months or year and watch the

00:29:46,880 --> 00:29:55,910
reports coming in it will help you with

00:29:50,179 --> 00:30:02,360
what it can help you

00:29:55,910 --> 00:30:04,760
just yeah so you might have forgotten

00:30:02,360 --> 00:30:07,970
that you have oh our gitlab server

00:30:04,760 --> 00:30:10,130
actually also sends out email he needs

00:30:07,970 --> 00:30:12,920
to out either be reconfigured to send it

00:30:10,130 --> 00:30:17,150
to our main smart host we need to add

00:30:12,920 --> 00:30:19,850
him to the SPF records we need DKI I am

00:30:17,150 --> 00:30:23,180
signing to that host so the reporting

00:30:19,850 --> 00:30:26,300
the policy none use that to gather data

00:30:23,180 --> 00:30:29,930
on your legal traffic and then you can

00:30:26,300 --> 00:30:31,760
roll out quarantine and there you can

00:30:29,930 --> 00:30:35,450
actually in the protocol say that how

00:30:31,760 --> 00:30:38,900
many of the emails should be judged by

00:30:35,450 --> 00:30:41,690
the policy and you start with 1% you go

00:30:38,900 --> 00:30:43,700
to 50% of the two weeks you use 50%

00:30:41,690 --> 00:30:47,780
quarantine for two weeks and then you go

00:30:43,700 --> 00:30:52,010
to 100% campaign for the weeks and then

00:30:47,780 --> 00:30:54,560
you move to 1% react 50% react 100%

00:30:52,010 --> 00:30:56,270
react and then you're in there I'll take

00:30:54,560 --> 00:31:06,020
you three months but it'll give you a

00:30:56,270 --> 00:31:12,530
clean exit oh I gave that way huh trust

00:31:06,020 --> 00:31:18,710
issues so can anyone give me the name of

00:31:12,530 --> 00:31:21,650
a CA that they would trust come on let's

00:31:18,710 --> 00:31:29,350
let's encrypt huh I see that you

00:31:21,650 --> 00:31:35,720
wouldn't trust the unit or anything else

00:31:29,350 --> 00:31:36,110
how's your memory hadn't heard of that

00:31:35,720 --> 00:31:41,570
one

00:31:36,110 --> 00:31:42,050
I was thinking of Symantec does it ring

00:31:41,570 --> 00:31:51,560
a bell

00:31:42,050 --> 00:31:53,600
and the worst of them all yeah

00:31:51,560 --> 00:32:00,910
they really not bad more bad than Komodo

00:31:53,600 --> 00:32:03,740
but Komodo is these guys went bankrupt

00:32:00,910 --> 00:32:06,760
these guys were thrown out of dross

00:32:03,740 --> 00:32:11,270
fruit from chrome and were brought up by

00:32:06,760 --> 00:32:16,100
desert these guys are stealing selling

00:32:11,270 --> 00:32:19,940
certificates very very cheaply why why

00:32:16,100 --> 00:32:23,480
didn't they file for bankruptcy too big

00:32:19,940 --> 00:32:28,570
to fail basically these guys were the

00:32:23,480 --> 00:32:32,780
ones that had a hacker issue store.com

00:32:28,570 --> 00:32:36,710
certificates and at that time when it

00:32:32,780 --> 00:32:38,840
was revealed they were issuing 25% of

00:32:36,710 --> 00:32:42,140
all the ssl certificates in the world so

00:32:38,840 --> 00:32:48,160
that were just too big to fail avoid at

00:32:42,140 --> 00:32:51,080
all cost so meet dane or TLS a i'd say

00:32:48,160 --> 00:32:54,230
your copies in here today no okay

00:32:51,080 --> 00:32:55,940
I usually tend to point to him for

00:32:54,230 --> 00:33:00,020
questions because he was part of writing

00:32:55,940 --> 00:33:01,820
the standard so Dane or TLS a is more or

00:33:00,020 --> 00:33:07,850
less just a way that you can publish

00:33:01,820 --> 00:33:12,830
your CA in DNS so what is more sane for

00:33:07,850 --> 00:33:15,980
you as a customer trust Komodo semantic

00:33:12,830 --> 00:33:19,100
or thought that your bank's certificate

00:33:15,980 --> 00:33:21,770
is correct or is it more sensible for

00:33:19,100 --> 00:33:24,290
you to actually trust your bank that

00:33:21,770 --> 00:33:27,620
they say that this certificate is signed

00:33:24,290 --> 00:33:30,040
by a CA that we trust most likely the

00:33:27,620 --> 00:33:30,040
last part

00:33:30,800 --> 00:33:36,700
so that's TLS a you can do a bunch of

00:33:34,100 --> 00:33:44,030
other cool stuff with TLS a you can do

00:33:36,700 --> 00:33:47,480
publish PDP keys as monkeys CA a how

00:33:44,030 --> 00:33:51,980
many in here has to see a a record come

00:33:47,480 --> 00:33:55,790
on - okay cool so CA a is basically a

00:33:51,980 --> 00:33:59,570
way that you tell any CA that's part of

00:33:55,790 --> 00:34:02,530
ceiebrate see a browser forum that they

00:33:59,570 --> 00:34:04,940
this is a gentleman check they're

00:34:02,530 --> 00:34:07,400
basically publish

00:34:04,940 --> 00:34:10,730
what CAS can be used to issue

00:34:07,400 --> 00:34:14,090
certificates for my organization it

00:34:10,730 --> 00:34:16,850
costs you nothing to set up check

00:34:14,090 --> 00:34:21,110
certificate transparency if you're

00:34:16,850 --> 00:34:24,650
unsure what CAS you're using setup make

00:34:21,110 --> 00:34:28,190
sure that you add snitch address

00:34:24,650 --> 00:34:30,020
basically the CAS are required to mail

00:34:28,190 --> 00:34:31,790
to this address if someone else is

00:34:30,020 --> 00:34:36,140
trying to issue certificate for your

00:34:31,790 --> 00:34:39,650
customer or your organization CAA quite

00:34:36,140 --> 00:34:49,010
easy to set up how many in here hates

00:34:39,650 --> 00:34:52,100
DNS SEC this one okay we have quite a

00:34:49,010 --> 00:34:56,060
nice adoption rate in Sweden

00:34:52,100 --> 00:34:59,240
I like the intersect

00:34:56,060 --> 00:35:01,070
I don't mind other solutions but I think

00:34:59,240 --> 00:35:07,600
it makes sense to do something that you

00:35:01,070 --> 00:35:10,580
can trust DNS data DNS SEC is actually

00:35:07,600 --> 00:35:12,530
not mandatory for most of the stuff I

00:35:10,580 --> 00:35:19,160
talked about but it's really really

00:35:12,530 --> 00:35:23,480
recommended the future or actually it's

00:35:19,160 --> 00:35:27,170
almost here already I think the two top

00:35:23,480 --> 00:35:32,360
parts are actually already RFC's the MTA

00:35:27,170 --> 00:35:35,240
STS the TLS or PT the two below ones

00:35:32,360 --> 00:35:41,780
require TLS a narc is still in draft

00:35:35,240 --> 00:35:45,650
I think so MTA STS this is another way

00:35:41,780 --> 00:35:49,580
of ensuring that you only get encrypted

00:35:45,650 --> 00:35:51,860
email this could get away with the start

00:35:49,580 --> 00:35:54,800
TLS problem so basically you publish a

00:35:51,860 --> 00:35:57,520
policy in DNS and then you publish a

00:35:54,800 --> 00:36:01,310
file a text file at a well-known place

00:35:57,520 --> 00:36:03,530
thank you that basic tells you what mode

00:36:01,310 --> 00:36:06,410
and what server and with this way you

00:36:03,530 --> 00:36:08,240
could actually get away with this is a

00:36:06,410 --> 00:36:11,750
way to combat the man-in-the-middle

00:36:08,240 --> 00:36:14,510
problem we talked about earlier the TLS

00:36:11,750 --> 00:36:18,050
RPT goes hand-in-hand with that because

00:36:14,510 --> 00:36:20,900
if I as a sender can't establish SLP

00:36:18,050 --> 00:36:22,880
our server I need a way to snitch I need

00:36:20,900 --> 00:36:25,370
a way to tell you that someone is

00:36:22,880 --> 00:36:29,690
probably trying to off the traffic

00:36:25,370 --> 00:36:33,550
between us this one is interesting you

00:36:29,690 --> 00:36:37,160
require TLS it's still in draft it's

00:36:33,550 --> 00:36:41,150
announced by the server on the male

00:36:37,160 --> 00:36:45,040
client you'll add to require TLS verb

00:36:41,150 --> 00:36:47,870
and this basically tells your MTA that I

00:36:45,040 --> 00:36:50,840
absolutely need to have transport layer

00:36:47,870 --> 00:36:55,310
encryption all the way from my edge to

00:36:50,840 --> 00:36:57,200
the other edge this is nice stuff orc is

00:36:55,310 --> 00:37:01,220
a way to try to get around problems with

00:36:57,200 --> 00:37:04,070
Demark so obvious problems with DeMarcus

00:37:01,220 --> 00:37:08,870
for example forwarding on email or

00:37:04,070 --> 00:37:11,600
mailing lists state of the nation or

00:37:08,870 --> 00:37:14,510
state of Sweden this is from hard and

00:37:11,600 --> 00:37:16,010
ice anybody is not familiar with how

00:37:14,510 --> 00:37:19,280
nice this is

00:37:16,010 --> 00:37:24,140
even ristic stuff even wrote most of the

00:37:19,280 --> 00:37:28,060
SSL tests for SSL labs Qualis so this is

00:37:24,140 --> 00:37:30,230
his new project it's really really nice

00:37:28,060 --> 00:37:32,600
and you can see the solar state of

00:37:30,230 --> 00:37:34,520
sweden is here at only 20% of the web

00:37:32,600 --> 00:37:37,340
servers of the 800 monitored

00:37:34,520 --> 00:37:39,320
organizations are in a good state but

00:37:37,340 --> 00:37:44,090
only 50% of the mail servers are in the

00:37:39,320 --> 00:37:47,750
good state so this is for sweden this is

00:37:44,090 --> 00:37:51,470
data from organized 93% supports 30 less

00:37:47,750 --> 00:37:55,310
83% SPF of these 800 domains they've

00:37:51,470 --> 00:38:00,170
been put in there should I just be

00:37:55,310 --> 00:38:02,990
standing like this only 13% of those 800

00:38:00,170 --> 00:38:06,050
those 800 are typically financial

00:38:02,990 --> 00:38:10,970
institution banks governments at 13

00:38:06,050 --> 00:38:14,840
percent supports Demark and 1% Dane so

00:38:10,970 --> 00:38:19,700
this is the deep hora noise report on a

00:38:14,840 --> 00:38:24,190
Swedish government agency it should not

00:38:19,700 --> 00:38:24,190
look like this this is utter crap

00:38:35,640 --> 00:38:38,710
[Music]

00:38:51,420 --> 00:38:55,750
[Music]

00:39:03,050 --> 00:39:06,199
[Music]

00:39:17,610 --> 00:39:20,649
[Music]

00:39:39,440 --> 00:39:45,900
well if I can snoop on your DNS traffic

00:39:42,359 --> 00:39:50,489
from the mail server most likely can

00:39:45,900 --> 00:39:56,009
deduct some quite nice information it's

00:39:50,489 --> 00:39:58,640
kind of a different set of standards

00:39:56,009 --> 00:39:58,640
doing

00:40:02,060 --> 00:40:05,199
[Music]

00:41:00,950 --> 00:42:36,090
so I the major problem is what office

00:42:32,880 --> 00:42:49,620
365 your policy of reject or foreign

00:42:36,090 --> 00:42:55,970
thing is the same will fail if you don't

00:42:49,620 --> 00:42:55,970
adjust it is

00:43:00,120 --> 00:43:03,210
[Music]

00:43:14,930 --> 00:43:32,529
and you can read a lot over here sorry

00:43:35,540 --> 00:43:41,699
[Applause]

00:43:46,560 --> 00:43:48,620

YouTube URL: https://www.youtube.com/watch?v=gNmZnF7xZvI


