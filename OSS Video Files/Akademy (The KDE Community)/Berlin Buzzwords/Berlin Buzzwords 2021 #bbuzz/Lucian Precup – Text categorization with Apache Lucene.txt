Title: Lucian Precup – Text categorization with Apache Lucene
Publication date: 2021-06-24
Playlist: Berlin Buzzwords 2021 #bbuzz
Description: 
	As many text mining applications, automatic text categorization is usually implemented with flavors of Machine Learning algorithms, which are trained with an appropriate training set to build the model. This model contains the statistical data based on training set texts that will later allow the system to match an input document with the corresponding category. 

But wait… statistical data on text documents? Doesn’t it remind you of our dear improved inverted index at the core of Apache Lucene? Maybe we could consider the index containing the training set documents as our trained model? And maybe a simple query against this index could give us the category (or categories) more likely to apply to a given document?

In this talk, we will demonstrate this approach and show that it can perform well and possibly "for free", as we sure all have Lucene based tools in our application portfolios!

Speaker: 
Lucian Precup – https://2021.berlinbuzzwords.de/member/lucian-precup

More: https://2021.berlinbuzzwords.de/session/text-categorization-apache-lucene
Captions: 
	00:00:08,480 --> 00:00:11,920
uh

00:00:08,960 --> 00:00:14,240
here we go again we we will talk about a

00:00:11,920 --> 00:00:17,039
text categorization

00:00:14,240 --> 00:00:18,400
and we will use a i uh oh sorry uh

00:00:17,039 --> 00:00:20,960
apache lucy

00:00:18,400 --> 00:00:22,000
uh so actually i don't have slides for

00:00:20,960 --> 00:00:25,279
this we will uh

00:00:22,000 --> 00:00:28,560
move to the demo uh and i also will

00:00:25,279 --> 00:00:31,599
browse some websites uh that are uh

00:00:28,560 --> 00:00:33,200
needed for for what i want to explain

00:00:31,599 --> 00:00:37,120
and for for credits

00:00:33,200 --> 00:00:40,640
uh so the objective here is to take some

00:00:37,120 --> 00:00:44,079
random text text and to categorize it

00:00:40,640 --> 00:00:45,360
and we will use apache scene for this we

00:00:44,079 --> 00:00:48,480
will not even use

00:00:45,360 --> 00:00:51,680
linear regression no ai just pure

00:00:48,480 --> 00:00:54,399
apache lucy just to give some credits

00:00:51,680 --> 00:00:56,239
uh this talk was first presented by my

00:00:54,399 --> 00:01:00,000
colleagues at a meetup that we

00:00:56,239 --> 00:01:03,359
held here in paris and it was

00:01:00,000 --> 00:01:05,600
in french and on solar this one is in

00:01:03,359 --> 00:01:07,840
english and on elasticsearch

00:01:05,600 --> 00:01:09,840
but just to say that it's actually a

00:01:07,840 --> 00:01:11,040
apache you've seen that does the job so

00:01:09,840 --> 00:01:15,119
you can do it with a

00:01:11,040 --> 00:01:18,640
solar or elasticsearch all of those work

00:01:15,119 --> 00:01:19,680
still credits for this really great data

00:01:18,640 --> 00:01:23,200
set

00:01:19,680 --> 00:01:26,240
which contains uh 2225

00:01:23,200 --> 00:01:28,960
documents from the bbc news website in

00:01:26,240 --> 00:01:31,680
2004 and 2005 and they are

00:01:28,960 --> 00:01:34,560
categorized manually categorized in

00:01:31,680 --> 00:01:38,560
these categories

00:01:34,560 --> 00:01:41,920
this data set is actually used in some

00:01:38,560 --> 00:01:42,240
scientific publications and we will use

00:01:41,920 --> 00:01:46,079
it

00:01:42,240 --> 00:01:47,439
uh uh to we will index it in with lucien

00:01:46,079 --> 00:01:49,920
and we will use it for text

00:01:47,439 --> 00:01:53,280
categorization so here it is

00:01:49,920 --> 00:01:53,280
we have the 2

00:01:53,840 --> 00:01:56,960
documents there's one missing i don't

00:01:55,439 --> 00:02:00,000
know why but it

00:01:56,960 --> 00:02:02,159
will still work and uh here's the

00:02:00,000 --> 00:02:03,200
definition of the index that we created

00:02:02,159 --> 00:02:05,200
with this

00:02:03,200 --> 00:02:06,240
pretty straightforward i mean nothing

00:02:05,200 --> 00:02:08,399
fancy

00:02:06,240 --> 00:02:10,959
you have the category which is a keyword

00:02:08,399 --> 00:02:14,080
and you have the text

00:02:10,959 --> 00:02:14,800
and here's the tricky part this one does

00:02:14,080 --> 00:02:18,000
the magic

00:02:14,800 --> 00:02:18,400
uh so we will talk about this later but

00:02:18,000 --> 00:02:21,760
just

00:02:18,400 --> 00:02:24,160
keep in mind this line okay so

00:02:21,760 --> 00:02:26,239
again some verifications here we have

00:02:24,160 --> 00:02:28,480
the number of documents all there

00:02:26,239 --> 00:02:29,760
uh we also have them grouped by

00:02:28,480 --> 00:02:32,239
categories

00:02:29,760 --> 00:02:34,480
the five categories that we mentioned so

00:02:32,239 --> 00:02:36,640
yeah they are kind of

00:02:34,480 --> 00:02:37,599
equally ventilated through the

00:02:36,640 --> 00:02:40,560
categories

00:02:37,599 --> 00:02:41,519
and here's how a document look you have

00:02:40,560 --> 00:02:43,599
the category

00:02:41,519 --> 00:02:44,879
and then the text which is the bbc

00:02:43,599 --> 00:02:47,920
article from

00:02:44,879 --> 00:02:50,480
for from 2004 2005.

00:02:47,920 --> 00:02:51,519
now how we will categorize text we'll

00:02:50,480 --> 00:02:54,560
actually use

00:02:51,519 --> 00:02:56,480
a query like this which is the more like

00:02:54,560 --> 00:03:00,159
this query

00:02:56,480 --> 00:03:02,840
and here we will uh here we will plug

00:03:00,159 --> 00:03:04,560
the text that where we want to

00:03:02,840 --> 00:03:08,720
categorize

00:03:04,560 --> 00:03:11,200
and we will also do an aggregation

00:03:08,720 --> 00:03:12,400
so of course it's uh it's sorted by the

00:03:11,200 --> 00:03:15,040
score but we also

00:03:12,400 --> 00:03:15,920
will do an aggregation that will display

00:03:15,040 --> 00:03:19,440
the

00:03:15,920 --> 00:03:22,159
most likely categories they

00:03:19,440 --> 00:03:23,040
they are ordered by a pipeline

00:03:22,159 --> 00:03:26,400
aggregation

00:03:23,040 --> 00:03:28,400
on average score okay so this is another

00:03:26,400 --> 00:03:29,519
trick that does the magic so nothing

00:03:28,400 --> 00:03:32,879
fancy but yeah

00:03:29,519 --> 00:03:36,400
this this is a useful for the next so

00:03:32,879 --> 00:03:38,879
here we go let's take a uh an article

00:03:36,400 --> 00:03:40,159
a random article from from the berlin

00:03:38,879 --> 00:03:43,360
baswell's website so

00:03:40,159 --> 00:03:45,840
actually this one is my colleague that

00:03:43,360 --> 00:03:47,280
shares a success story so thank you

00:03:45,840 --> 00:03:49,519
berlin browsers for

00:03:47,280 --> 00:03:50,799
promoting diversity so we just copied

00:03:49,519 --> 00:03:53,920
and pasted this

00:03:50,799 --> 00:03:56,400
article into the

00:03:53,920 --> 00:03:57,200
the placeholder here and here we go

00:03:56,400 --> 00:04:00,400
let's see

00:03:57,200 --> 00:04:01,599
how it goes so we see that we have some

00:04:00,400 --> 00:04:04,159
category tech

00:04:01,599 --> 00:04:04,959
some category attack again some politics

00:04:04,159 --> 00:04:06,640
here

00:04:04,959 --> 00:04:08,879
yeah you might understand so it's

00:04:06,640 --> 00:04:09,680
actually boring buzzwords so it stuck it

00:04:08,879 --> 00:04:12,080
talks about

00:04:09,680 --> 00:04:13,120
tech but you also have politics because

00:04:12,080 --> 00:04:16,639
of the

00:04:13,120 --> 00:04:18,400
feminism and all that so uh

00:04:16,639 --> 00:04:20,799
in the aggregations we have tech on the

00:04:18,400 --> 00:04:22,639
first position and then we have some

00:04:20,799 --> 00:04:24,560
sport entertainment i don't know why but

00:04:22,639 --> 00:04:27,759
yeah it's an article about

00:04:24,560 --> 00:04:28,000
tech definitely okay this is great let's

00:04:27,759 --> 00:04:29,919
go

00:04:28,000 --> 00:04:32,160
further i took another article so

00:04:29,919 --> 00:04:33,199
everything all these articles are kind

00:04:32,160 --> 00:04:36,560
of fresh so

00:04:33,199 --> 00:04:37,280
the other one is from reuters and it was

00:04:36,560 --> 00:04:40,400
yesterday

00:04:37,280 --> 00:04:43,680
was talking about jet subsidy pact

00:04:40,400 --> 00:04:46,000
and so about china so i imagine this

00:04:43,680 --> 00:04:47,360
would be something like business and

00:04:46,000 --> 00:04:50,240
politics let's see

00:04:47,360 --> 00:04:52,400
how the software works yeah we have

00:04:50,240 --> 00:04:55,440
business here we have business again

00:04:52,400 --> 00:04:58,880
business politics and politics and

00:04:55,440 --> 00:05:00,960
on the aggregations we have business

00:04:58,880 --> 00:05:03,039
and next we have politics so it's an

00:05:00,960 --> 00:05:06,800
article about business

00:05:03,039 --> 00:05:07,440
pretty pretty neat some other examples

00:05:06,800 --> 00:05:10,560
here

00:05:07,440 --> 00:05:11,440
this one is from sports uh yeah you

00:05:10,560 --> 00:05:15,280
imagined and

00:05:11,440 --> 00:05:19,039
so this is from france france 24

00:05:15,280 --> 00:05:21,440
and it talks about the euro 20

00:05:19,039 --> 00:05:23,840
no suspense i think it will be

00:05:21,440 --> 00:05:25,600
categorized as sport so here it is

00:05:23,840 --> 00:05:28,639
sports sports sports and

00:05:25,600 --> 00:05:30,800
aggregations the sport come first

00:05:28,639 --> 00:05:33,440
it's also some something about tech and

00:05:30,800 --> 00:05:33,440
entertainment

00:05:33,840 --> 00:05:39,199
pretty neat uh yeah we

00:05:37,120 --> 00:05:40,960
also took some other examples i will go

00:05:39,199 --> 00:05:43,440
faster through those

00:05:40,960 --> 00:05:44,080
this is one taken from washington post

00:05:43,440 --> 00:05:46,639
just to be

00:05:44,080 --> 00:05:48,080
like i have diverse sources so this one

00:05:46,639 --> 00:05:51,440
is is from the

00:05:48,080 --> 00:05:54,720
actually from the books sections

00:05:51,440 --> 00:05:57,680
which is under arts and entertainment

00:05:54,720 --> 00:05:59,039
we took an article from there let's see

00:05:57,680 --> 00:06:02,080
how it goes

00:05:59,039 --> 00:06:02,960
test another category so it's

00:06:02,080 --> 00:06:06,160
entertainment

00:06:02,960 --> 00:06:09,600
so yeah it works pretty well just

00:06:06,160 --> 00:06:13,120
pure apache leucine so how does it work

00:06:09,600 --> 00:06:17,199
actually so

00:06:13,120 --> 00:06:17,199
well it uses something that's called

00:06:17,600 --> 00:06:21,440
term vectors and before we go into that

00:06:20,160 --> 00:06:23,199
we just need to know

00:06:21,440 --> 00:06:24,960
what happens with a document that's

00:06:23,199 --> 00:06:27,759
indexed into a leucine

00:06:24,960 --> 00:06:28,319
uh index so sorry for this is this this

00:06:27,759 --> 00:06:31,039
one is

00:06:28,319 --> 00:06:32,240
in french it's taken from from a blog

00:06:31,039 --> 00:06:36,000
that's on the

00:06:32,240 --> 00:06:38,960
elasticsearch website uh so um

00:06:36,000 --> 00:06:40,479
the documents that we send to to apache

00:06:38,960 --> 00:06:42,880
lucine are actually

00:06:40,479 --> 00:06:44,639
transformed and they get into the index

00:06:42,880 --> 00:06:46,319
in some different manner

00:06:44,639 --> 00:06:48,000
in this case we have an agendagram

00:06:46,319 --> 00:06:52,080
transformation but we also

00:06:48,000 --> 00:06:53,199
have the term vectors in here so the

00:06:52,080 --> 00:06:55,280
index will contain

00:06:53,199 --> 00:06:56,319
something that's called term vectors

00:06:55,280 --> 00:06:59,360
that you can see

00:06:56,319 --> 00:07:02,160
here so here is for example a document

00:06:59,360 --> 00:07:04,479
that i have in the index

00:07:02,160 --> 00:07:06,160
and these are the term vectors so this

00:07:04,479 --> 00:07:09,199
is the word

00:07:06,160 --> 00:07:12,560
okay so you have plenty of words here

00:07:09,199 --> 00:07:16,880
uh yeah let's take something

00:07:12,560 --> 00:07:17,759
more meaningful so a lot of walls again

00:07:16,880 --> 00:07:21,199
they are like

00:07:17,759 --> 00:07:22,160
add adjust and also the properties that

00:07:21,199 --> 00:07:24,319
they have here

00:07:22,160 --> 00:07:26,160
these are the term vector term vectors

00:07:24,319 --> 00:07:29,360
and when you come with this text

00:07:26,160 --> 00:07:31,680
this one is a text will actually

00:07:29,360 --> 00:07:33,680
it will get translated into the same

00:07:31,680 --> 00:07:36,800
structure so you have the words here

00:07:33,680 --> 00:07:38,000
so this is a text coming from berlin

00:07:36,800 --> 00:07:41,039
buzzwords

00:07:38,000 --> 00:07:44,560
and it is also translated into this

00:07:41,039 --> 00:07:47,360
vector space model so

00:07:44,560 --> 00:07:48,240
the term vectors exist in elasticsearch

00:07:47,360 --> 00:07:50,319
as i said

00:07:48,240 --> 00:07:51,680
it's actually lucinda's that that does

00:07:50,319 --> 00:07:55,680
the trick so it also

00:07:51,680 --> 00:07:59,039
it's also available in uh in solar

00:07:55,680 --> 00:08:01,280
just to give credit for that and

00:07:59,039 --> 00:08:02,720
it kind of looks like this and i

00:08:01,280 --> 00:08:05,440
actually have a slide

00:08:02,720 --> 00:08:07,199
that i will show now and i would also

00:08:05,440 --> 00:08:11,120
like to thank my colleague

00:08:07,199 --> 00:08:14,960
vince van van sombosk for this

00:08:11,120 --> 00:08:16,400
um so he thought it would be more uh

00:08:14,960 --> 00:08:18,800
you will understand better with this

00:08:16,400 --> 00:08:20,960
slide so actually the vector space

00:08:18,800 --> 00:08:23,120
uh here is very simple it is very

00:08:20,960 --> 00:08:25,440
simplified it's just two dimension but

00:08:23,120 --> 00:08:27,599
actually it has a lot of dimensions

00:08:25,440 --> 00:08:29,599
and you have the words here and then you

00:08:27,599 --> 00:08:32,159
have the documents that are kind of

00:08:29,599 --> 00:08:34,000
spread into this vector space and when

00:08:32,159 --> 00:08:37,039
you come with a new document

00:08:34,000 --> 00:08:39,200
you see here the the question mark will

00:08:37,039 --> 00:08:41,279
actually the system will figure out

00:08:39,200 --> 00:08:43,120
which are the documents that are the

00:08:41,279 --> 00:08:46,240
closest to this one

00:08:43,120 --> 00:08:49,680
and this is how it gets categorized

00:08:46,240 --> 00:08:54,000
simply with this vector space model

00:08:49,680 --> 00:08:56,560
okay just to finish the

00:08:54,000 --> 00:08:57,040
the presentation uh i would also like to

00:08:56,560 --> 00:08:59,920
thank

00:08:57,040 --> 00:09:01,519
uh my other colleague uh vince van

00:08:59,920 --> 00:09:04,399
sombren

00:09:01,519 --> 00:09:06,560
that has also a talk that we did at uh

00:09:04,399 --> 00:09:08,880
the elastic communities conference about

00:09:06,560 --> 00:09:10,000
the percolator and it actually uses the

00:09:08,880 --> 00:09:12,160
same technique

00:09:10,000 --> 00:09:13,360
in a different context so if you want to

00:09:12,160 --> 00:09:16,080
dig in further

00:09:13,360 --> 00:09:16,880
you can go and see this uh this

00:09:16,080 --> 00:09:19,120
presentation

00:09:16,880 --> 00:09:20,800
still a lightning lightning talk it

00:09:19,120 --> 00:09:23,040
takes six minutes

00:09:20,800 --> 00:09:24,560
and what we have here yeah we also have

00:09:23,040 --> 00:09:27,600
a blog post on about the

00:09:24,560 --> 00:09:28,480
the same the same subject if we wanna go

00:09:27,600 --> 00:09:31,680
further

00:09:28,480 --> 00:09:33,839
and last but not least just to show you

00:09:31,680 --> 00:09:37,040
that it's there's no trick there we are

00:09:33,839 --> 00:09:38,880
live uh today let's see

00:09:37,040 --> 00:09:41,120
something because the articles that i've

00:09:38,880 --> 00:09:43,920
showed you late from yesterday

00:09:41,120 --> 00:09:44,399
this one is really live because we have

00:09:43,920 --> 00:09:46,320
a

00:09:44,399 --> 00:09:48,480
football game that's going and this is

00:09:46,320 --> 00:09:48,959
the live reporting from bbc to give them

00:09:48,480 --> 00:09:52,000
credit

00:09:48,959 --> 00:09:54,959
again for the data set and uh

00:09:52,000 --> 00:09:56,399
yeah you have the score here i think

00:09:54,959 --> 00:09:58,880
this is live yeah okay

00:09:56,399 --> 00:10:01,360
so it's it goes live let's take the

00:09:58,880 --> 00:10:04,399
summary here

00:10:01,360 --> 00:10:05,120
uh i don't know why can i yeah okay so i

00:10:04,399 --> 00:10:08,560
will just

00:10:05,120 --> 00:10:09,600
copy and paste the summary and hope for

00:10:08,560 --> 00:10:13,279
the best i hope

00:10:09,600 --> 00:10:16,959
i don't have a demo effect here

00:10:13,279 --> 00:10:20,640
let's see what does this text

00:10:16,959 --> 00:10:24,240
talk about sports okay so

00:10:20,640 --> 00:10:25,519
no demo effect we have sports and some

00:10:24,240 --> 00:10:28,079
tech there

00:10:25,519 --> 00:10:29,519
so this is it pure apache you've seen

00:10:28,079 --> 00:10:32,640
that use

00:10:29,519 --> 00:10:35,760
is used to categorize any

00:10:32,640 --> 00:10:38,959
random text that you throw at it just

00:10:35,760 --> 00:10:41,680
2 200 documents from bbc

00:10:38,959 --> 00:10:43,040
and that's it thank you lucian i just

00:10:41,680 --> 00:10:44,320
had uh one question for you

00:10:43,040 --> 00:10:46,000
we're a little short on time now heading

00:10:44,320 --> 00:10:47,120
into our final lightning talk but my one

00:10:46,000 --> 00:10:50,480
question would be

00:10:47,120 --> 00:10:52,160
um yeah further to what cedric said like

00:10:50,480 --> 00:10:53,600
what's a scenario where this should

00:10:52,160 --> 00:10:55,680
perhaps not be used where

00:10:53,600 --> 00:10:57,360
term vectors are not best applied or

00:10:55,680 --> 00:11:01,360
where they're they produce the

00:10:57,360 --> 00:11:04,640
the least effective results

00:11:01,360 --> 00:11:06,320
um yeah so great question thank you

00:11:04,640 --> 00:11:09,120
thank you for this for this question

00:11:06,320 --> 00:11:09,440
uh of course uh there are some drawbacks

00:11:09,120 --> 00:11:12,880
and

00:11:09,440 --> 00:11:14,079
there are some some some things that are

00:11:12,880 --> 00:11:17,279
not working

00:11:14,079 --> 00:11:19,920
uh i didn't show them because yeah

00:11:17,279 --> 00:11:20,640
with this example it works pretty well

00:11:19,920 --> 00:11:24,079
um

00:11:20,640 --> 00:11:26,320
when the text is really short

00:11:24,079 --> 00:11:27,600
it's kind of tricky to to figure out

00:11:26,320 --> 00:11:30,240
what it is so you

00:11:27,600 --> 00:11:31,200
this is actually suited for like

00:11:30,240 --> 00:11:35,040
unstructured

00:11:31,200 --> 00:11:36,320
text that are kind of articles coming

00:11:35,040 --> 00:11:39,600
from the media

00:11:36,320 --> 00:11:43,279
or or word documents or stuff like that

00:11:39,600 --> 00:11:43,600
and uh yeah it's this is mostly suited

00:11:43,279 --> 00:11:46,959
for

00:11:43,600 --> 00:11:50,560
for rather large

00:11:46,959 --> 00:11:57,839
pieces of of of text

00:11:50,560 --> 00:11:57,839
got it thank you

00:12:11,760 --> 00:12:13,839

YouTube URL: https://www.youtube.com/watch?v=3BeH2alq8S0


