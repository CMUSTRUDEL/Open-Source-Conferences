Title: #bbuzz: Uwe Schindler - Ask Me Anything: Lucene 9
Publication date: 2020-06-24
Playlist: Berlin Buzzwords | MICES | Haystack â€“ Joint Virtual Event 2020
Description: 
	More: https://berlinbuzzwords.de/session/ask-me-anything-lucene-9

Uwe Schindler is deeply involved in the development of Apache Lucene and is happy to answer all your questions about the upcoming Lucene 9.
Captions: 
	                              hi everyone                               uh welcome to the ama session                               with uber schindler uh about                               what's new in lucie                                     ube is a committer and pmc member of the                               apache                               lucene and solar project he's worked on                               a lot of interesting leucine features                               like the fast numerical search and is                                maintaining the new attribute                                based uh text analysis api                                he works as the managing director for sd                                data solutions in bremen                                that provides consulting and support for                                apache lucien solar and elasticsearch                                he also works for pangaea uh where he                                implemented the portal's geospatial                                retrieval functions                                with uh with lucy so                                [Music]                                welcome hi                                uh so thank you for the introduction and                                i'm glad                                to answer all your questions today that                                you could imagine                                about um                                lucy nine so in general                                um maybe the first thing that i want to                                start with is before                                the questions i hope they are coming in                                already                                um is to talk and give you some some                                short overview what will come with lucie                                                                 and maybe also some a little bit of                                short background of losing                                                                                                       lucie                                  in short if you would say it there are                                two                                new main features which uh                                which are the important changes one is                                moving to java                                                       one is                                they are currently going on to implement                                gradle as um as the build system                                so that's something which is more                                interesting for the                                for the developers so that are the most                                often seen new features the other ones                                which                                are also included in most cases also                                backported to the lucian                                                                                                   eight                                so in most cases when we have a new                                using version it's just                                uh the breaking changes coming in and                                more or less the breaking change here is                                that you have to switch to java                                   and for the developers it's great but we                                also updated a lot of stuff                                like for example analyzers                                we have new snowball analyzers                                for new languages and although the old                                ones were updated so they should be                                faster now                                because the auto generated code was                                updated                                and that are some changes but because                                they are breaking backwards                                compatibility                                they are new but most of the other stuff                                was already back ported                                to java                                  and one of the main features and no                                sorry lucien                                  and one of the main features so there                                are three things                                that you can ask questions today too                                about the                                the so-called early circuits of queries                                which is called the block max                                round which is                                if you don't need the exact number of                                results                                of a query you can short circuit if you                                know that some of the documents will                                never match                                because they cannot be in the top ten so                                that's a new feature which is steadily                                involved                                to affect more queries and                                that's very very important                                the second step is which is an ongoing                                process in losing                                eight is step by step moving away                                the index parts that are currently                                mostly or in previous versions were                                 mostly                                 located on the heap to move them off                                 heap so that means                                 the index files are only memory mapped                                 and                                 to run for example your solar or                                 elasticsearch cluster                                 you only need very few heat space                                 mainly you only need the heat space for                                 for managing your cluster like the the                                 cluster state and all that stuff                                 but for executing queries and um                                 doing aggregations or faceting the                                 the amount of heap it gets reduced and                                 another                                 new feature in scene                                                    trends                                 so and um                                 i also have something because there are                                 also some zola                                 users here so the next version                                 of solar will not be solar                                              solar in resin                                                        smaller changes as said before the block                                 max                                 indexing is now finally also coming to                                 zola so                                 the short secreting of queries is coming                                 and you also have some minor stuff like                                 a security info panel in the admin                                 ui which is now important because we got                                 a lot of security requests                                 for non-secured solar cluster so                                 you see a little bit more information                                 and there are also some streaming api                                 improvements coming                                 and um                                 so here yeah sorry i forgot about that                                 but i think we are now                                 with the introduction that's almost all                                 and now i want to get                                 some queries from you and i hope i'm                                 already have detected some in the                                 section yeah                                 so uh we're i'm gonna get back to the                                 new features                                 in a bit uh and all of them look really                                 interesting                                 uh but uh with the new version                                 what does it really mean for uh for                                 existing users                                 is there something that they should look                                 out for uh                                 prepare themselves for is there                                 something you want to highlight                                 yes so when you're upgrading to a new                                 new lucine version but it's same applies                                 to zola in elasticsearch                                 um there are of course some breaking                                 changes and one of those                                 is of course you have to upgrade to java                                                                     i hope most of you already did that um                                 for for the current clusters because                                 that's the last uh last chance to do                                 that but you                                 have to also keep in mind some other                                 stuff so for example                                 if you have older indexes that you                                 haven't re-indexed for a longer time                                 it might happen that you can use them                                 with the new                                 versions of solar or lucien                                 because the backwards compatibility                                 layer only allows                                 to beat indexes from previous versions                                 so that means once you have mic once you                                 migrate to                                 c                                                                       which was                                 originally created and that's very                                 important originally created                                 with java                                                             new uh since lucien seven                                 and made hot and somehow we using eight                                 so                                 actually uh previously it was possible                                 to simply                                 merge some index or optimize it to get                                 it to the                                 almost latest version but there were                                 some changes                                 between losing six and blue seven and                                 cuisine eight                                 that had some internal statistics uh                                 that were used for the scoring and so on                                 and also offsets                                 which were partly negative in older                                 indexes and because of that                                 um we have to put some                                 some stopping in it you cannot upgrade                                 those old indexes you you can still                                 upgrade them to lucien version                                   but the problem is lucy                                              reject to open that index                                 because uh somewhere in the indexes also                                 the original version                                 with which it was created stored in the                                 index                                 and if lucine on opening the index                                 figures out that                                 the index was created and with a very                                 old version and just upgraded                                 sequentially from conversion to version                                 it                                 it will complain to open it                                 there are some workarounds available but                                 that need manual                                 work so you have to somehow                                 change the index files uh on your own by                                 hacking something into zine but in                                 general that sort of supported                                 configuration so                                 you should be prepared to update and                                 um that's that's mainly uh                                 what affects all the major museum                                 versions and then you have to install                                 the other                                       possibly later and when you're upgrading                                 solar                                 you should you you                                 should yeah the steps from losing                                 uh from zola a to lusoder                                              complicated                                 like they were from um                                 solar                                                                    take care of the hdp version                                           so you can easily do a holding upgrade                                 if i'm not                                 right here i'm sure you may correct me                                 that sounds absolutely right uh but                                 just to summarize there's no easy way to                                 do this but anyone who's on solar                                 or lucien or elastic version                                 elasticsearch version that uses prior to                                 a lucien                                                                                                       everything                                 and making it work                                 i yeah as i said there are some other                                 possibilities                                 but it needs hacking and um writing some                                 lucien code on your own                                 so it's very funny you sometimes have                                 customers which have really really old                                 indexes they still want to                                 to get into newer versions and then it                                 really gets funny                                 so yeah that's uh that's something                                 we can talk another time about that yes                                 so we were getting questions on the                                 channel so                                 the question says hey i was attending                                 ecir                                 this year and they discussed about how                                 great it is to see block max band                                 implemented in lucine but they also                                 discussed                                 on why it takes so long for researchers                                 to see their ideas                                 implemented in real-world products or                                 what's your take on this                                 that's an interesting question i was                                 expecting i should explain                                 how that works                                 feel free to we can take that offline                                 i can do that later so but basically um                                 basically uh it started already                                 um in i think loser                                               i'm not                                                   he had a talk here at berlin buzzwords                                 uh                                 where there was a first version                                 of of blog max already proposed                                 and and that was already before lucy                                 [Music]                                 what i think it was with lucene                                        maybe at the early time of louisiana                                   and yet those new codex at that time so                                 there were already some ideas how to                                 implement that                                 but the biggest problem was as always                                 with                                 theoretical stuff                                 in theory it's in most cases it's quite                                 easy to implement because you have                                 something like an iso-related problem                                 uh that that                                 where you can create your index just                                 based on                                 on the requirements for that features                                 but because you know                                 lucine has a lot of more features than                                 only                                 scoring documents um so so you                                 you know you have numeric fields and all                                 that stuff                                 that also are used in the scoring                                 and the other thing is in lucine it's                                 possible to easily                                 change uh the scoring model that you're                                 using so for example                                 in the past we were using tf ief but now                                 the default is pm                                                      other                                 scoring algorithms that you can exchange                                 and that works without                                 reindexing the whole index and because                                 of that                                 the encoding of the index so the                                 approach                                 at that time was called max score so                                 that was to store the maximum score of                                 every document                                 somehow in the in the posting list and                                 the idea was                                 unfortunately to calculate the score you                                 need to know                                 the the scoring algorithm that you want                                 to use                                 and if you save that statistics in the                                 index you cannot switch it afterwards                                 and that                                 was something what we have to change and                                 also from the index file format if you                                 wanted to create the max score index you                                 had to do that globally                                 so merging was not working because there                                 was no easy way                                 to save that information and so                                 that's basically the reason why it took                                 so long and then                                 uh i think it was adrian grant and some                                 other people                                 a few uh two or three years ago were                                 reading some newer papers                                 about that where people trying that old                                 block max                                 stuff and tried                                 uh to implement it but actually the                                 implementation in lucien                                 is still different than what was                                 originally proposed                                 there because they were still using                                 something like scores                                 and and to store them in the index and                                 our approach was                                 uh to make it easier and also we figured                                 out that the index file for microfluid                                 is perfectly                                 to put a second step on top of this                                 maxscore algorithm                                 which is those block stuff and because                                 of that                                 it's a block max and the block max                                 algorithms were proposed much later than                                 the max score so                                 but we now implemented that and it's                                 it's                                 part of the russian code base and                                 because the russian index already has                                 something like a block structure in the                                 postings                                 so it was very very easy to add that the                                 more complicated work was to change the                                 queries                                 and yes it's still ongoing work to                                 change                                 more and more queries uh to to use                                 the block marks stuff so there's this                                 fun quest and all that stuff which are                                 still have to be reflected and changed                                 great thank you so much um so                                 uh maya sharipova uh is also the                                 newest uh the scene computer now                                 has a question uh has a question                                 can you discuss how lucid is taking                                 advantages of                                 simd and processors that support this                                 uh what type of roses ah okay ah yeah                                 that's also something new                                 you can uh that's something new                                 unfortunately it's uh it's still not a                                 new feature you can already try it out i                                 think                                 i'm not sure in which version it came so                                 maybe she can answer the question on her                                 own but                                 um so the new instructions in the cpus                                 we can                                 use them in louisian but                                 at the moment we cannot do that directly                                 that's one of the back sides of using                                 java as                                 your your back-end system because we                                 don't have any                                 any possibilities to control how the                                 how the how the compilation of the                                 java code um in the hotspot built                                 engine is doing when it creates machine                                 code out of it                                 so um but recently in your                                 new java versions there were significant                                 improvements                                 i'm not sure about which java version                                 you have minimally used                                 so it might be that it don't work with                                 java                                       quite sure about that but with java                                    you can be sure that the code is                                 combined in a better way and the trick                                 here was                                 to the usual lucien trick i don't want                                 to get                                 too much into the details uh so                                 it was also adrian grant um i i'm                                 not sure if he's also here on the berlin                                 buzzwords                                 but he started to work together                                 and try to optimize the                                 code the index format a little bit                                 and also the algorithms so the virtual                                 machine the java virtual machine is able                                 based on the structure of the other code                                 to convert that into                                 into those new instructions so                                 we have to look at our compression                                 algorithms that they are compatible to                                 that                                 sometimes uh the vp had to                                 to uh to to uh change a little bit the                                 encoding on disk uh to need a little bit                                 more space so if longs and all that                                 stuff and also in memory                                 we are using now bytebuffers to to                                 in to to load those posting lists but in                                 that case                                 you can parallelize a lot of stuff this                                 is something like an ongoing process it                                 doesn't                                 work this oil cpus                                 that are currently on market but luckily                                 we don't need to compile our code we are                                 hoping that                                 the jdk is doing that and in the past                                 this was already done for example                                 a lot of code like filters where we are                                 working with split sets                                 is already highly optimized to work with                                 those                                 new instructions also in older versions                                 it started with java                                   and just some funny backgrounds                                 those horrible bugs in java                                        exactly caused by                                 the virtual machine doing the wrong                                 stuff in that                                 regard and creating assembly code which                                 was not correct                                 so and this happened to lead to those                                 crashes on some platforms or                                 corrupt indexes and all that stuff so                                 that's something we need                                 two parts we need to optimize our code                                 and the new code                                 but there's also something else which                                 might come a little bit later                                 and that's going into project panama                                 um that's a new project of the                                 of open jdk that allows to have                                 to call non-java methods from inside                                 java so it's possible to create a method                                 handle to call something like a                                 librarian                                 that is compiled in c code and that                                 might be                                 another possibility so we can ship                                 lucine optionally with some                                 pre-compiled binary blocks                                 in the char file that can be directly                                 accessed without speed                                 so the problems you can still do that at                                 the moment with                                 java but the problem is the switch from                                 the java                                 to um to the c code is very very slow                                 at the moment and with the new apis like                                 metal tenders                                 on c code looks like promising in that                                 case and this                                 i also talked about that already on on                                 on the backhand this will also improve                                 the memory map directory hopefully                                 but this is something which is may take                                 one year more i think i would expect                                 java                                                           coming in um                                 there's a question with the new panama                                 new java abilities to call c code uh                                 just a curious question and when can                                 we see lucine on gpu                                 um i i didn't can you repeat                                 with the new panorama java abilities to                                 call c code                                 uh yeah the question is like when can we                                 see the scene                                 uh working on gpus                                 oh god yeah i                                 i think there are some issues open but                                 as always the answer to all these                                 questions is                                 nobody's working at the moment for it                                 but if you're interested                                 and you have the infrastructure to do                                 that with your younger versions                                 then just step in and                                 i hope if you have some good ideas in                                 your experience                                 in using gpus                                 then write some code which is the c code                                 layer that we might use and then                                 we can see how to include that                                 perfect yes uh i would have guessed so i                                 just asked that question because it                                 it just came up and had like a ton of                                 interest                                 a lot of people just said yes we want to                                 ask the same question                                 um so okay now                                 i already posted uh the lucine issue                                 with the gpu                                 yeah it's a long discussion issue it has                                 lucine                                                  it seems to be four or five years old                                 yeah                                 um so the next question                                 is from matteo uh please explain bm                                 of beer man                                 so um i i think i can do                                 that because i have some slides for that                                 already prepared                                 because that's not so easy to explain                                 this just talking so                                 okay the slides are coming in so                                 that's ten times faster queries so                                 what's going on there i                                 i will not go too much into the details                                 because i think                                 most people here will stop uh thinking                                 and just touching their beers and                                 drinking too much of that so                                 um uh the                                 the main changes as said before uh                                 but what what's the background of be                                 happy of the block marks                                 run this the idea is to short circuit                                 all the queries                                 where the total count is not needed so                                 you might know that already from google                                 so for example if you're searching in                                 google                                 you see on top of your documents                                 some information like we found a lot of                                 documents sometimes                                 it's an exact number like we found                                     documents which is very seldom in most                                 cases but if you're very specific with                                 keywords                                 it works but at some point it will                                 simply tell you                                 we found a lot of documents we don't                                 tell you exactly how many there                                 are and the reason for that is because                                 currently when luzine is running                                 and executing a query the problem is to                                 actually get                                 the top documents the top                                              that you're displaying in your search                                 results it has to process                                 all the hits because it has to calculate                                 the score and put                                 the document into a priority queue                                 and the priority queue so whenever a new                                 document comes in it just puts it into                                 the priority queue and at the end                                 only the top ranking documents are left                                 over because everything that's not part                                 of the priority                                 key eq is falling out                                 at the end there are already something                                 some optimizations in that process so                                 for example if it figures out                                 the calculated score is too low already                                 it doesn't even                                 try to insert it into the priority queue                                 and just throws it away immediately but                                 you still have to calculate the score of                                 the document                                 and the idea here is how can we                                 make losing ignore                                 and not ignore ignore those hits which                                 are not competitive at all                                 and the idea as told before was                                 to put some additional information into                                 the index                                 so during execution of the query you can                                 figure out without actually calculating                                 the score and collecting the hit                                 er that that a bunch of documents                                 which in most cases somehow in a block                                 together in your index                                 so you see something like the posting                                 list consists of blocks of                                               for example                                 you can say okay the next one of the                                 documents are not interesting at all                                 because the score that would be                                 calculated based on the statistics                                 of that block is too low and though i                                 can                                 just jump over the block and                                 this new change was implemented for some                                 queries                                 like the term query uh which is                                 easy you're just jumping into a term and                                 then you're consuming the posting list                                 but all the other stuff like uh the w                                 in the one block marks is then                                 related to boolean query and that's very                                 important for these junctions                                 if you have a conjunction in most cases                                 it's not so bad because um yeah                                 you're just ending together in your                                 terms but if you are having an                                 awkward value                                 it's enough to have something like a                                 stop word in your query                                 and that's also the reason why in the                                 past most people said you don't want to                                 have stock words software's in your                                 index                                 because on an awkwary uh that gets                                 horrible horrible slow because you have                                 to iterate the posting list of all those                                 gravies                                 and then it takes very very long time so                                 you have queries taking two three four                                 seconds sometimes for large indexes if                                 you're asking for a stop word                                 and also for phrase queries and there                                 was also recently addition of consensual                                 ways but how                                 uh how does it work now so what we are                                 doing is we                                 we add not something like this score to                                 our                                 um to our um                                 to our uh posting lists so that was the                                 original proposal                                 uh and this is why it took a little bit                                 longer to do that the idea here is                                 because we still want to have                                 the information and change uh                                 change for example the scoring model                                 like from t from tf idf we want to                                 switch to pm                                                           different                                 and because of that we did not store                                 something like a single value                                 in the in in our posting list but                                 instead via score                                 is storing the maximum term frequency                                 for block                                 in the posting list and we are                                 putting in the norm and with that                                 information for our role block you can                                 of course calculate                                 the score the maximum score of that                                 block and then can say okay                                 those documents are not interesting and                                 we just                                 skip over them and because of that                                 there are still some requirements on                                 that so for example                                 you are not completely free with your                                 scoring algorithm so for example                                 if the tf raises so if the tf goes up                                 monotone                                 it must the score must also go up                                 monotone so if you have something like a                                 scoring algorithm                                 which uh which has uh                                 it was interestingly yesterday in the                                 evening in the talk there was some                                 discussion about that maybe people                                 having putting repeating their words                                 should be                                 should get a bad score at the end                                 because you know in                                 in some shops this bed but if you have                                 something like that you cannot use                                 that approach so that if it if it goes                                 up                                 uh the that must be same and for the                                 norm                                 it's very similar um to do that so                                 the document frequency and all that                                 stuff need to be somehow                                 predictable so it must be monotone so                                 the score is expectable                                 because otherwise the algorithm would                                 not work and the cool thing now with the                                 block                                 stuff is that is um                                 this can also be done on a multi                                 multi-level approach                                 and if you see that multi level you can                                 think of story as doing that                                 in the skip list and that was a great                                 idea that                                 that we had at that time                                 um so the original paper for that was i                                 think                                 not long ago i think it was in cigar                                    using block max indexes and                                 so how does it work at all so basically                                 what is a skip list                                 so then and that's the main slide                                 which hopefully explains what what is                                 happening so                                 uh what you see here you have a you have                                 for example a skip list for lucien                                 and for search so we do you have a                                 lucien search that's your favorite                                 and you're searching uh then you're                                 first looking up lucine and search in                                 your                                 dictionary and then you get a list the                                 posting list                                 and in the posting list it's just a list                                 of numbers so in that case lucine is                                 included in documents                                                                                                                                something like that and as the same is                                 for the search query                                 for search for the search term you also                                 have some document numbers so there are                                 two possibilities                                 a lot of people know for end queries you                                 have uh                                 those deep rock approach so you're                                 jumping going forward in the list                                 and that's why the skip list is there so                                 for example for an                                 end query you want to find the overlap                                 so that means the first                                 hit is the number seven where both are                                 inside so                                 that means you are you're first moving                                 the lucine iterator forward and then you                                 are one on seven                                 but then you are asking the other                                 iterator please go                                 forward but the minimum document i'm                                 interested in would be document number                                 seven                                 and then the second iterator which is                                 positioned on search                                 is moving forward and um                                 so it skips already the four uh the four                                 five uh the four and the five document                                 so for example and then once they both                                 landed on seven                                 the next one is a                                                   jumping sometimes it would help with                                 that jumping                                 you have those skid lists so when                                 something is in the first block which is                                 on three                                 there is information that you can jump                                 to document number fifth and by just                                 going there and so it can skip over all                                 those documents                                 because they are somehow compressed and                                 the size of this compression is not                                 known                                 so it knows where to go and then it uh                                 it's it's on the                                             and um the idea here now is                                 uh to add to that skip list                                 although that information and now from                                 the multi skip list levels this also be                                 offered in multiple levels                                 so if somebody's on the first block he                                 can also say okay i need to go to                                 document                                    so it can just jump over everything and                                 then it lands on                                                   and then from there it can iterate                                 further and you see here that's an easy                                 way to skip                                 and now what's coming on here is what we                                 are doing here is we are simply storing                                 the term frequency the maximum term                                 frequency                                 for those information lie inside that                                 skip list                                 so we know that the maximum term                                 frequency                                 of the leucine in documents                                              no                                                   so that means if we are already during                                 collecting the documents                                 we know that the score is for example                                 the current score is something                                                                                                        need a minimum term frequency of three                                 then we can say okay i'm asking this uh                                 there's the skip list and say                                 okay let's jump forward get me to a                                 document                                 where the term frequency is greater than                                 three                                 and in that case it can also use the                                 multi-level skip list in that case it                                 can jump to document                                    and jump over two blocks already and                                 in that case it's then uh possible                                 to uh to skip over those documents the                                 only information that you lose of course                                 is the total number of documents that                                 were hit                                 and that's why uh by sometimes you                                 cannot use                                 that at all but for example if you are                                 not interested in the top number                                 of documents you can quickly uh                                 go over them yeah so                                 um if there are any other questions we                                 can also think about that later                                 so thanks uv for that great explanation                                 uh super useful uh                                 there is a question about do you have to                                 change                                 uh the version in config.xml for                                 solar to                                            in order to use uh                                 this feature does the config and solar                                 require                                 any changes uh in terms of explicitly                                 specifying the version                                 to use that um no not necessarily                                 um so so basically this in most cases a                                 problem with upgrading zola                                 so that's maybe some addendum to what i                                 said before                                 and i think um i think uh                                 anshum you will confirm that so whenever                                 you are upgrading zola you should look                                 into the version numbers                                 of your schema xml because sometimes if                                 you're keeping the old version                                 you get very very bad defaults so i have                                 a lot of customers                                 with very very old schemas and where the                                 default is to not enable dock values on                                 their indexes and then they are                                 complaining                                 that their heap space overflows because                                 they just upgraded lucien they're hoping                                 that dog values are enabled and                                 everything works and then                                 they get get a deep space out of memory                                 and all that stuff so basically but for                                 that features you don't need to change                                 anything you just need to upgrade                                 the new loosened version and so for the                                 block max                                 stuff to get that feature in                                 zola you have to wait for                                                hopefully soon                                 and then it will be enabled i think the                                 default is still                                 that all the results are counted and the                                 runner wasn't sure about that                                 but the result format will also change a                                 little bit so you get the information                                 about the number of hits collected and                                 some                                 information if it's an exact exact                                 number or if it's not exact so it's                                 something like a boolean                                 and i think you can only also tell him                                 during                                 the                                                                    not sure if this is yet                                 implemented already i think the default                                 is one thousand                                 uh so yeah yeah                                 i don't yeah i i think that it was                                 supposed it's supposed to be done it's                                 not done yet                                 it's not that done yet yeah so so                                 basically you can simply say i want to                                 get exact numbers up to                                 maybe                                                                the ten thousand documents are collected                                 it simply                                 stops uh stops uh counting exactly and                                 then it will use                                 the skip list to jump over uh the                                 documents                                 so but that's something you have to                                 explicitly enable                                 and you need to explicitly enable that                                 because                                 it doesn't work with all types of query                                 so for example if you enable faceting on                                 your queries                                 it won't work because then you will also                                 get incomplete fuzz accounts and all                                 that stuff                                 so which is not really wanted but                                 in that case you have to think a little                                 bit about how to do that                                 in your code so one recommendation would                                 be to just execute the query without                                 facets                                 show the results very very early and                                 then in the background                                 calculate the facets and deliver it to                                 your website                                 might be there's an ayax caller                                 something like that and                                 that would be some possibility how to do                                 that but in general                                 i think everything keeps the default                                 yep um                                 we have another question i remember some                                 discussion                                 about vector a n search in                                 a jira issue is there anything in the                                 works for lucy                                     or is this still being discussed uh                                 happy to get an update about the ongoing                                 discussions as well                                 oh no vector                                 so basically the discussions are still                                 going on                                 um and it's very very funny the issue is                                 open one                                 year and there's recently came in the                                 new approach to do the same                                 and i know for example that                                 elasticsearch has its own approach at                                 the moment they                                 so they are also doing                                 [Music]                                 doing doing something like indexing of                                 vectors but they have a different                                 approach and everything is somehow                                 waiting for a leucine internal                                 implementation                                 but currently people are discussing so                                 there's an issue of monsola                                 on the solar issue there's a proposal to                                 implement it only in zola                                 which is somehow similar to what happens                                 in elasticsearch and then                                 the people from from around nightmare                                 candles                                 and mike the two bikes from                                 amazon are looking into that issue and                                 they already implemented something                                 and the final step now is as always                                 it sounds cool in in                                 in isolation but at the end you want to                                 have something like genetic how we                                 how we want to index those                                 vectors and the newest issue now opened                                 i think on may                                                           was about                                 we need something like an abstract api                                 for the posting format                                 and an api and something like a standard                                 interface                                 to access posting formats so we can                                 implement both proposals                                 of posting formats and so we need to see                                  something in the overlap so                                  we don't have to be that too much                                  glued into the queries somehow so we                                  need something like the queries                                  and so they need to be something like                                  that because the current approach                                  that was posted on regime is                                  is not a new index format the                                  the original version i think that was                                  one year ago                                  was using payloads and dock values but                                  i'm not going to message you i think                                  because payloads or top values                                  i think dock values in that case and i                                  think the the elasticsearch version is                                  also using top values for that                                  um which is which is just a workaround                                  to store that information but it has                                  some overhead on the credit time                                  so in that case uh we would need                                  something like a special                                  index format um so something that                                  describes                                  the index format and then api to access                                  those structures                                  on the lower level so it's hot at the                                  moment again                                  but um i would not expect that to come                                  for                                  lucien                                                    help us help us with that and                                  i think there are a lot of problems to                                  solve                                  like for example luzine is using this                                  segmented index structure so merging                                  gets it gets very very expensive and all                                  that stuff so                                  we have to find solutions for that so                                  and we were also discussing yesterday                                  in the other question round                                  [Music]                                  where it was already discussed so it                                  would be good to have the                                  the vectors in leucine but you cannot                                  simply carry only on the vector so you                                  always need something like a                                  combined approach so that looks like                                  learning learning to rank or something                                  like that so you're first getting                                  something like                                       top ranking results by conventional                                  search and then                                  the top                                                                use                                  the vectors in the index to get the                                  final top                                                               doing that on the whole index is likely                                  to blow up you                                  i think does this explain a little bit                                  yes yes sounds good to me um                                  i'm gonna switch some track and uh ask                                  you about the build system                                  considering a lot of effort has gone                                  into switching over                                  from and that's something that we've                                  been using forever                                  uh over to cradle uh where does it stand                                  right now uh and what does it mean for                                  the users                                  yeah as i said i hope it will come to                                  losing nine                                  they are really uh very very info                                  very they putting that in because                                  there are some other questions i have                                  seen another question coming a little                                  bit later                                  which is also related to that and it                                  also                                  somehow links together so in in very                                  short                                  we have a working gradle build at the                                  moment so                                  um the only thing that doesn't work yet                                  is you cannot build a release out of it                                  but a lot of other stuff is already                                  working so it is for the daily work of a                                  developer so for example                                  if you want to submit a new feature into                                  losing                                  and you have a patch and a pull request                                  and                                  when you're developing that i would                                  really recommend you                                  to use the new gradle build so you just                                  have to                                  call it gradle w um                                  and then you you can run everything we                                  already have pre-commit and all that                                  stuff                                  and you will see a significant                                  improvement                                  in test running times because you know                                  great also the lucine bull was doing a                                  lot of stuff in parallel when                                  executing the tests but if you have                                  looked at the lucy builds especially                                  when you're doing zola                                  it takes something like two minutes                                  until it starts to compile zola                                  although it does nothing on the                                  louisiana at all it just                                  iterates all the ant projects                                  which all find out there's nothing to do                                  and compile and then it starts to                                  maybe take compile one file and zola so                                  this should be really really fast                                  because and does not really work so                                  um developing this radar should be a fun                                  now again we also have some new checks                                  already which are only implemented in                                  greater                                  so for example in zola if you have wrong                                  locker usage                                  so eric erickson committed something                                  that immediately wants you like with a                                  forbidden apis                                  for example to not contact strings in                                  your log messages                                  and instead use those curly brackets                                  and parameters or you sort of never ever                                  call a method in those                                  logging parameters and all that stuff so                                  that's something                                  because that was already slowing down so                                  that's something which is a new check                                  only working with greater                                  but you cannot do a release at the                                  moment so because the packaging is not                                  yet working                                  but i was working on the javadocs                                  for something like two uh two weeks ago                                  or three weeks ago and that's already                                  very very                                  fine so i think the packaging is more or                                  less the last step                                  and then we can release                                  so okay i would would suggest just try                                  it out                                  there's also the other problem is with                                  back porting patches to                                  earlier versions and that's something                                  because at some point we want to change                                  the build infrastructure a little bit so                                  this                                  directory structure so we to be more                                  aligned                                  to greater builds which we cannot do at                                  the moment because                                  process at the same time in the build                                  system so there's a lot of customization                                  in gradle at the moment                                  so if you import it into your                                  into your favorite ide you might get                                  some problems with it so yeah                                  okay great um i have two questions on my                                  mind right now                                  uh and one of them is the hard one the                                  other one                                  not so much uh i'll put the hard one out                                  there first so that we can use                                  all of the rest of the time for the                                  other one um                                  so what is the background behind the                                  plan to take up with                                  lucien with solar is this now the simple                                  or the hard one                                  this is the hard one the other one is a                                  nice little one yes                                  okay yeah so that's really                                  some something so um i can                                  i can only so please excuse in some                                  cases i'm also a little bit biased                                  because                                  uh everybody has its own personal                                  opinion about that                                  so actually if i i'm quite open and i                                  also voted plus one                                  for the split of louisiana and zola but                                  actually                                  i'm somehow in between to me i was                                  working on the greater bill                                  it doesn't matter to me but actually the                                  whole thing                                  started like that so you could also ask                                  why was new zealand's all are put                                  together                                  half a year now                                                       we are suddenly trying to split from                                  each other that's very very hard to                                  explain to somebody                                  so i was already expecting that this                                  question                                  will come here and i can tell you                                  uh one thing it won't happen the split                                  before                                  zola                                                  and losing                                                               will make it even more complicated and i                                  think it                                  will also wait a little bit until the                                  gradle build is finished                                  so that's but that's only my personal                                  opinion of that case                                  but most of the other committers agree                                  with that but how did it happen so                                  the reason for that by the question came                                  up again so it came up                                  already in                                                               sitting in the restaurant                                  after some earlier burning buzzwords in                                                                                 and we were discussing about                                  that lucine and zola might split or                                  might not split                                  so of course there are always some                                  people who don't like solar                                  so they they want to split on the other                                  hand                                  uh zola is really something which is                                  also                                  good for using because we do have more                                  extensive testing so there were always                                  those conflicting parties and i was                                  saying                                  i would would have lucine and zola                                  together                                  but what happened is when we started to                                  do the grader build which is already                                  working on lucine and zola                                  perfectly so i have no problem i see no                                  reason to split because of the gradable                                  but the griddle build very very clearly                                  showed                                  that lucine and zola although they are                                  the same project have a completely                                  different                                  style of first building the project so                                  there was nothing so in in fact what                                  happens that's                                  also one reason why the aunt will take                                  so long the first thing that happens is                                  and is iterating all their projects                                  generates all the char files and then                                  the char files are copied over to the                                  solar directory                                  and then they are consumed from there to                                  build um                                  to build solar so that really looks on                                  the first                                  thing like yeah that's somehow separate                                  and when you look closer into the                                  greater build                                  and when you're doing a lot of stuff you                                  see there are other checks in it                                  so it's really separate and then there                                  were also some                                  some some statistics done a little bit                                  later like the number of persons                                  who are working on that and figured out                                  there a lot of the                                  a lot of committers working on both                                  projects                                  some of them are only for us for us to                                  work on both projects so                                  in that case if you do a backwards                                  incompatible change in routine of course                                  you have to touch the solar code                                  so um so this is not really an argument                                  but it has shown that now in the newer                                  time most develops                                  meant are really separate from each                                  other so                                  so solar and solar has its own                                  uh iteration of new features you also                                  see                                  for example as i said before the block                                  max one was first there in business                                  came out with version                                          i would have wished that with version                                                                       a                                                                    would have been appeared in zola                                  because if you look at the patch it's                                  not really complicated                                  so but unfortunately it took till                                      and it's still not out                                  to get that very short circuit stuff                                  into zola so you see here                                  if it would really be one project that                                  would have been one single commit uh                                  changing louisiana and zola at once                                  somehow okay that's a little bit ideal                                  but                                  in in that case but now the question why                                  did we move together in                                               reason for that was a little bit                                  different contrary the problem at that                                  time was                                  that uh solar and bluezine were from two                                  completely different persons and they                                  had a completely different                                  history and before solar even joined                                  the apache software foundation they have                                  a lot of                                  implementations that should have been                                  better placed in louisiana                                  at that time they were going to zola                                  and this didn't stop at that time it was                                  all the time so it was starting to                                  we only developed that in zola but it                                  was not somehow merged or not even                                  thought of                                  to do that in lucine because of the                                  release schedule because you seen at a                                  very very slow release schedule i think                                  and zula was faster                                  could also be the other way around i                                  don't remember that                                  and because of that some of the stuff                                  was implemented in zola                                  mostly and one famous example is in zola                                  there was                                  tons of analyzers for different                                  languages                                  and one example is worth the limited                                  filter which you see people still hate                                  but um and because of that                                  so at some point and of course all those                                  stuff was not usable for                                  for projects outside of                                  although it's only loosing internal                                  features because an analyzer has nothing                                  to do with zola                                  so the idea here was to clean up the                                  whole code base                                  move the stuff where it belongs so for                                  example function queries                                  were moved to luzine analyzers were                                  moved to luzine                                  and that really helped to clean up the                                  whole project                                  and it also was a great success for                                  other people                                  using new scenes or a lot of customers                                  of mine were really happy                                  to not no longer need to import                                  solar dependencies just for your own                                  museum implementation just to get the                                  analyzers and of course                                  also for this was a good step forward                                  for                                  elasticsearch because elasticsearch was                                  able to use                                  all those analyzers so you can see that                                  from both cases                                  so um yeah vertically better filter                                  wdf it means vdf                                  in german yeah funny uh yeah                                  so um but ellen also hates it i think                                  yeah i was just looking here into there                                  yes so that that's some reasons and now                                  we are at a state                                  where the whole thing is really good of                                  course there are still the risk                                  that it can diverge anyways so                                  the same can happen but um                                  there's also the other thing because now                                  the lucy the committee                                  committers we're getting more and more                                  committers it's a good time to split                                  but it's not only splitting the projects                                  so we could do the same we could just                                  fork                                  and both will be under the same loosen                                  top level project but the idea here is                                  to make it a                                  own apache software foundation top level                                  project so at the end it will also be                                  solar dot                                  org and all that stuff so that's a good                                  way                                  forward and about the dependencies i                                  think the approach will be very similar                                  to                                  what what elasticsearch is currently                                  doing so                                  uh because a lot of people were                                  complaining about yeah if                                  not everything from lucine is                                  immediately tested in zola                                  uh that will be very very hard so that                                  means                                  in contrast to the early versions of                                  solar where this was not the case                                  we must go some wood to say okay                                  we are using snapshot versions from some                                  shared repository like the apache                                  snapshot repository                                  just with some date code and it's                                  regularly updated and something like                                  that                                  so that's approach which elasticsearch                                  is doing and i think                                  uh that might also happen with solar and                                  the other thing is if we want to align                                  major releases or not                                  my personal opinion is we won't align                                  minor releases anymore because if                                  there's a                                  new zealand version                                                 doesn't matter at all                                  it can still be zoola                                                                                                              the major version changes                                  there needs to be a communication                                  because you remember from my                                  earlier talks we are only backwards                                  convertible                                  to the major version before so that                                  means with the loose e                                                leave                                  losing eight indexes and so there's                                  somehow a problem so                                  it this means we also at least need                                  at least and need at least need                                  something like as major version update                                  also in zola                                  some point so i would think of it will                                  stay                                  the same major versions will stay                                  aligned but the minor version is not                                  so i think that's everything i can say                                  about say about                                  the split here and i would tend                                  to wait a little bit until                                  lucie                                                                    of losing                                                                                                        only                                  backwards compatible changes at that                                  point i think the split will happen                                  so that's my best guess but as always                                  it's never true                                  you are silenced oh sorry                                  yeah um                                  so the last question that uh you covered                                  the previous one pretty well                                  uh so do you have                                  considering lucine is a rather complex                                  system                                  uh do you have any pointers or                                  suggestions on how                                  new contributors could engage                                  and contribute                                  to the project and to the community                                  um yeah so so i                                  i i think for for some new contributors                                  it's really really hard because                                  there is not too much going on on the                                  development mailing list mostly is done                                  in                                  tierra tickets and you're flooded by                                  cheera tickets                                  we split those mailing lists not long                                  ago                                  because of that so the real discussions                                  are now going on on the development list                                  and the theory issues are all                                  going and the github requests are going                                  to another mailing list so                                  that helps a little bit so it makes it                                  easier for our new                                  uh new committees but                                  there's still the problem that most                                  people                                  uh because it's a huge really huge                                  project you don't know where to start                                  and because of that                                  and we have something like tagging on                                  our cheer issues                                  which are useful for beginners and                                  mostly this is                                  this was done also for uh for google                                  summer of                                  uh code but something similar so there                                  are some                                  issues which are a little bit easier                                  to start with and just start and submit                                  the pull request which which is much                                  easier than                                  before now that apache software                                  foundation has included                                  full support for github so you don't                                  need to                                  mark with git repositories by the asf                                  just call it on github and send a pull                                  request and                                  and we can also merge it for you then                                  the committers                                  very very easily so i think it's much                                  easier to do that so just come there                                  and submit a pull request but of course                                  don't forget to                                  register for the mailing list and                                  and ask your questions there though you                                  can also talk                                  the talk in discussions or maybe go to                                  other issues and talk with us                                  so that's that should be something and                                  if you have something which was really                                  useful for you                                  just give it to us we are happy                                  uh to see something like the recent                                  contributions like they talked before                                  about those                                  um about those new posting formats                                  for those indexes with many many fields                                  and that                                  which is really something a few people                                  need                                  but that was really something and the                                  person is now also committed who                                  proposed it originally so                                  that's also something you can keep in                                  mind if you are                                  working together with us we are all                                  friendly                                  sometimes we are a little bit harsh and                                  the policeman is arguing this                                  is about the bad code you are writing                                  but don't take that too serious                                  great yes that uh i hope that                                  that's gonna motivate enough people to                                  come in and start contributing                                  uh to the projects uh let me try to see                                  um okay uh i think                                  we don't have any more questions we're                                  also out of time so thank you so much                                  away for answering all those                                  hard and not so hard questions uh all                                  sorts of them                                  uh so yes thank you so much                                  you
YouTube URL: https://www.youtube.com/watch?v=RvoH_pVvXz0


