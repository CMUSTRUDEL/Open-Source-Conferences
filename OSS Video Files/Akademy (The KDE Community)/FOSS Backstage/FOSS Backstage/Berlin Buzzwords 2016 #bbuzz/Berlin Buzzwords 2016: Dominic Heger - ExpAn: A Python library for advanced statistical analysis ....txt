Title: Berlin Buzzwords 2016: Dominic Heger - ExpAn: A Python library for advanced statistical analysis ...
Publication date: 2016-06-12
Playlist: Berlin Buzzwords 2016 #bbuzz
Description: 
	Find more information here: https://berlinbuzzwords.de/session/expan-python-library-advanced-statistical-analysis-ab-tests

A/B tests, or randomized controlled experiments, have been widely applied in different industries to optimize the business process and the user experience. Here we'll introduce a Python library, ExpAn, intended for the statistical analysis of A/B tests.

The input data to ExpAn has a standard format, which is defined to interface with different data sources. The main statistical functions in ExpAn are all standalone and work with either the library-specific input data structure or some Python built-in data types. Among others, the functions can be used to assess whether the randomization is appropriate, and measure the expectation and error margin of the uplift due to the treatment. We also implemented a robust discretization algorithm to handle typical heavy-tailed distributions in the real world. Finally, a generic result structure is designed to incorporate results from different types of analyses.

One can easily feed data from other domain-specific data fetching modules into ExpAn. Other advanced algorithms for the analysis of A/B test data can be implemented and plugged into ExpAn, eg. a Bayesian hypothesis testing scheme instead of the frequentist approach. The generality of the result structure also makes it handy to apply different kinds of visualization on top of the data.

This is a talk sponsored by Zalando.

Website: https://berlinbuzzwords.de/
Twitter: https://twitter.com/berlinbuzzwords
LinkedIn: https://www.linkedin.com/showcase/berlin-buzzwords/ 
Reddit: https://www.reddit.com/r/berlinbuzzwords/
Captions: 
	                              hi everyone can you hear me well so                               great so I'd like to talk about expand                               which is a new library that we are                               developing at zalando and it's all about                               the statistical analysis of AP tests so                               few questions who view has worked with a                               be testing before okay that's great                               because our library is really convenient                               for for users and Who am has worked on                                developing tools for a be testing okay                                just a few so this is really great we                                are open source and maybe you have                                something to contribute and we would                                love to see that so yeah but let me                                first tell you a little bit about my                                story so I'm with Solano only for three                                months now so I'm pretty in you and                                before that I've been a research                                assistant working on the analysis of                                brain activity and brain computer                                interfaces so what researchers are                                concerned about is the brain and how it                                works and it's really like there's a lot                                of complex behavior there and nobody                                really understands how it works and what                                researchers do is they do experiments                                and these experiments are like we invite                                people to our lab glue electrodes on                                their heads and measure brain activity                                when we expose them to an experiment                                that we've designed for given hypothesis                                so this is usually done with a very                                small number of subjects we have because                                it's super time-consuming and yeah                                costly therefore but after measuring                                these brain activity is we do                                statistical analysis of that and that's                                the exciting part and because there you                                can really get all the in                                sites and come up with new hypothesis to                                do new experiments so this is scientific                                experimentation and we can pretty much                                transfer that to the business world so                                we want to do experiments there but we                                are not really interested in how the                                brain works but a lot of what we are                                doing is about our customers and how                                about how we can do our services as best                                as possible to fit their needs so we                                want to gain insights from their complex                                behavior so they are really super                                diverse and a lot of things play into                                that like emotions and and things like                                that and so and we want to do                                experimentation and we are in a                                fantastic situation here because and we                                can easily expose things that we want to                                try in experiments to a lot of people so                                this is really great from a statistical                                point of view because we get great                                statistical validity but also these                                results and have some real world meaning                                and we can expect that the things that                                we are trying and experimenting are                                really working out in the real world so                                again this is the statistical analysis                                is really the exciting part and because                                here we can get new insights and drive                                our processes to build better and better                                project or product and so we come up                                with new hypotheses from what we've                                learned and this can be a lot of                                different stuff here so and of course                                typically a/b testing is changing the                                front end for example the color of a                                button in a nap or and but it can also                                be something like Becca and algorithm                                and the x-band that I want to talk about                                now is all about this statistical                                analysis of these tests or experiments                                that we are doing and yeah there                                you can can use that for all different                                kinds of experiments so the x-men                                library is a library for statistical                                analysis of these randomly control                                trials and you can use that for a be                                testing and multivariate testing and it                                supports all different kinds of                                mattresses and metrics that you want to                                include in these analysis like                                categorical variables and continuous                                well bones and things like that and it's                                open source now released under the MIT                                license and available on github and                                written in Python so what it's excellent                                not it's not a complete a be testing                                framework so it's not about the                                assignment of the different entities                                like the the customers to the different                                 variants and it's also not about how you                                 get your business data in for for the                                 analysis I think for the first point for                                 the random assignment there are nice                                 projects on github I did a little bit of                                 research about that and I think they                                 would greatly work together with x-men                                 and for the data retrieval process you                                 might want to have your custom developed                                 processes there yet just to retrieve                                 your business relevant metrics so I'd                                 like to talk about three parts of the                                 library and that's the experiment object                                 and that's the most important thing for                                 the user to interact where you can do                                 all the analysis from that and I will go                                 into a bit of a detail on what goes into                                 this experiment object and how you can                                 use it then I will talk about the                                 analyses and in the end show you our                                 results structure and yeah what you get                                 out of that so                                 to create an experiment object you need                                 three kinds of ingredients its metadata                                 features and key performance indicators                                 and I will go shortly into a bit of                                 details about that so metadata is quite                                 simple key value pairs and that give you                                 additional information about the                                 experiment so this is very simple but                                 it's very important as well so to have                                 information about the experiment ID the                                 experiment names the different data                                 sources involved different units timings                                 and things like that and that you want                                 to store together with with the data to                                 ya be able to make good analyses the                                 second thing is features and this is all                                 about properties of the entities that                                 you are investigating so for example                                 demographic properties about your                                 customers that you know and here we have                                 for example this guy and we know he is                                 male                                                                     so things like that and can go into the                                 features and these features are and                                 don't change during the experiment and                                 they are there for you like measured                                 before the treatment start and you can                                 represent that in such a table where you                                 have like an idea of the entity here and                                 all the features over there and the                                 third part is kpi's key performance                                 indicators and it is yeah the measures                                 of the effects that you you want to see                                 so this is about your business metrics                                 for example but can also be like                                 conversion rates and we can have several                                 of them and they are typically measured                                 of course after the treatment star                                 yeah when this experiment runs or                                 afterwards if you can reduce them and                                 they also can be time resolved so for                                 example here we see we have the with two                                 different entities here and we can                                 represent that kpi's in such a table so                                 we have the variants that were exposed                                 and this is like a time resolution that                                 can be in days or months or hours or                                 whatever and then we have some kpi's i'm                                 showing like revenue or whatever other                                 metric you want to have for your                                 analyses so if you want to load that                                 into x-band we want to create an                                 experiment object and this is really                                 just a one liner in Python code so what                                 we provide is the baseline variant this                                 is where against we do all the analysis                                 like the existing system for example                                 when we when we do some changes then the                                 metrics which are the KPI and the                                 features and the third thing is the                                 metadata and when you execute that you                                 will see that some initial checks are                                 performed and then you most likely will                                 get an output let's s summary of what                                 you put in like here we have my fancy                                 experiment from the metadata which has                                 two features for KPIs and the primary                                 KPIs revenue we have like a million                                 entities here and two variants where a                                 is the yeah the baseline variant okay so                                 let me talk about the analysis we are                                 currently providing we have three                                 different kinds of yeah basic analysis                                 that we currently include in the library                                 the first one is maybe the most common                                 analysis when you think about a/b tests                                 identify significant differences between                                 the different variants so what you what                                 you experience when you perform such an                                 experiment is that for two variants like                                 a and B the red one and blue one and you                                 will encounter yet a distribution of                                 values for for the four KPI so what we                                 are interested in here is the difference                                 between those two so the Delta KPI and                                 we want to find out if this is                                 significantly different from zero so we                                 have some variance of course in this KPI                                 for each of the two variances and we                                 want to perform a statistical test that                                 shows that and we can specify then                                 confident thresholds there so that we                                 can say for example we've won a                                 ninety-five percent certain that the                                 observed the Delta M is within an                                 interval and what comes out of that is                                 something like this so we have here the                                 observed Delta and a confidence interval                                 and if it looks like this so the you                                 observe and the interval is way above                                 the zero line then any we are good and                                 then it's significant difference and you                                 new version of variance is working                                 better than the baseline variant and it                                 looks like this then it crosses the                                 boundary and then we cannot or such a                                 conclusion so this is the basic Delta                                 and you can do that with the experiment                                 object executing the Delta method                                 there's a second analysis that we                                 provide is the trend analysis and then                                 here we add in another dimension which                                 is time so                                 for the delta that we have we provide at                                 the time resolution and also so they                                 existed how the delta progresses and the                                 corresponding confidence interval and we                                 can use that for recognizing patterns in                                 the data over time like seasonal                                 patterns for example but also recency                                 effects or long-term effects of that                                 yeah the treatment that we are doing and                                 the third analysis is to quantify the                                 differential treatment effects of                                 subgroups so this is about digging into                                 the data and I'm identifying yeah                                 customer groups that might perform                                 better or worse and yet we have a                                 breakdown according to the features that                                 we also provide and and here for example                                 and you can see we are doing this                                 subgroup analysis on the future age and                                 it was and we have a pinning algorithm                                 in our library that can and split this                                 continuous variable into chunks so we                                 have a young customer group here from                                    to                                                                     group here above twenty four years and                                 we see that for this KPI that we are                                 investigating in this example it works                                 really well for the young customers but                                 not for the older ones and you can use                                 such insights for example to do                                 personalization and just expose your                                 changes or your new variant to subgroup                                 of your customers so the third thing i'd                                 like to go into is the result and here                                 we have a result object that is a really                                 generic structure for all the analysis                                 we provide currently with the experiment                                 object and um it looks like this it's                                 based on a panel data frame and there's                                 also the metadata included but I show                                 here only the data frame and so we have                                 the metrics here in the first column and                                 you can imagine that you can have                                 different metrics as well and and what                                 we can see is here we we show the sample                                 sizes for weary and a we have thousand                                 for variant p we have five thousand and                                 also the variant meaning result for this                                 kpi and which is                                                        makes an uplift of                                                     show here the confidence intervals here                                 is the                                                                   of course add additional percentage to                                 really display a distribution and so                                 this is for the basic Delta and for the                                 subgroup analysis you can imagine just                                 to copy that whole table over and show                                 that for the different subgroups like                                 for age in subgroup                                                     similar analysis than that and you can                                 have that for different subgroups of                                 course and you can also have that for                                 different time points for the trend                                 analysis so that's basically it for the                                 result structure and to put it in a                                 nutshell and we have just released                                 expand on github as a new library for                                 the analysis of a/b tests we provide                                 some standardized input output formats                                 so far and a basic battery of                                 statistical analysis methods                                 but this is really part of yeah Solano's                                 open source strategy so yeah this is an                                 early release and we want to want to put                                 in a lot of more stuff and you are more                                 than invited to contribute and the                                 library currently uses parametric                                 statistics but also if your data is not                                 normally distributed you can use                                 bootstrapping and you can use it as a                                 human in an eye Python notebook for                                 example but also in a micro service so                                 if you want to run that in the back end                                 and that's totally fine and as I said                                 available on github and pi PI so next                                 steps are for example we're working on                                 the visualization and we are thinking                                 about putting some patients tatiseigi                                 come so that's probably my last slide                                 but i also have a python notebook that i                                 want to show you and just to get a bit                                 more of the code but let me first finish                                 that up so this is again the URL if you                                 want to reach out i'm here at the                                 conference and Zhi Bao is also here at                                 the conference and so please come to us                                 talk to us send us an email and again I                                 with the company only for three months                                 so I did only a tiny bit of the work                                 that I've i'm showing you here and these                                 people all contributed i guess a lot                                 more than me but yeah so then i'd like                                 to switch over to the to the notebook                                 and this is by the way also i'm on                                 github                                 so you can just download that and yeah                                 walkthrough by yourself if you wanna if                                 you are interested so can also install                                 it simply with pip install of course and                                 and to provide some data so first of all                                 we we generate some random data here to                                 to just show a few things of the library                                 this looks like this so we have quite a                                 number of metrics here and they are                                 normally distributed and shifted things                                 like that and we provide the metadata as                                 a Python dictionary by the way yeah this                                 is just upon us data frame none here we                                 have a Python dictionary and so what we                                 can do now is as I have seen on the                                 slide if you've seen on the slide and                                 just execute or create an experiment                                 object where is it yep like this and                                 just the baseline very end the data and                                 the metadata and then we can use that                                 for all different kinds of analytics we                                 want to do for example here the Delta                                 for the KPI normally equal unequal                                 variance and it will output something                                 like I've shown on the slide this                                 results table and and yeah we can also                                 do that with bootstrapping if we just                                 provide the parameter assume normal is                                 false and then the results are in this                                 case pretty much the same but it takes                                 longer and also here is yeah the results                                 off of the whole different kinds of                                 metrics that we are currently in the                                 half in this simulated data set and                                 and we also have an example of the                                 subgroup analysis here so I guess that's                                 it thank you very much for your                                 attention and I'm glad to answer                                 questions maybe bio can wave his hand so                                 that people can reach out to him after                                 the session so thank you for the                                 presentation my question is do you have                                 any possibility of persisting this data                                 or is it just on demand when you want a                                 report to be generated I'm not sure if I                                 got the question right so what do you                                 mean by possibility to process this                                 litter cysts like stories in a database                                 or anything do you do this for like                                 long-term analysis or something like                                 that I'm sure we can just store that                                 data in files or databases wherever you                                 want it so it's it's a panel data frame                                 in principle and a Python dictionary so                                 yeah it's really easy to to yeah have                                 that stored but it's not into integrated                                 um yeah it's partly integrated so I                                 think we can we can write into file                                 easily from from pandas for example and                                 yeah but I think if you have your custom                                 database at your business then yeah you                                 want to include something that's very                                 specific to your your business and then                                 you want to just implement that on your                                 own but I guess it's pretty easy and                                 maybe a second question about                                 scalability so                                 what what scenarios have you tried like                                 how much data for how long okay very                                 good question so I'm with the company                                 for very short time so I'm not really                                 super experience but it's like we are                                 running big tests with that currently                                 there are on our website and yeah this                                 really scales in that sense but I think                                 a key point is here that a lot of the                                 data that you gather and can be                                 aggregated for these tests because you                                 yeah probably depending on your                                 experiment and don't want to include all                                 tracking data that you you have from a                                 user on the website for example so maybe                                 it's just that you want to have one                                 event if a person converges that was                                 exposed to experiment or not and so this                                 is not really usually a huge amount of                                 data so that scales well in this terms                                 okay thank you hello and so a quick                                 question does does your library contain                                 any consistency check support for                                 example if two experiments run at the                                 same time and we think that the metrics                                 are not didn't affect a very independent                                 but in reality at least on websites but                                 I don't know many experiments that are                                 completely independent a click can                                 affect something else so are there any                                 checks in that respect or some                                 statistical methodologies that yeah as                                 we currently include checks about the                                 features so that the different variants                                 are independent for example and and we                                 also and yeah have things planned to                                 check if different experiments                                 interfere with each other but this is                                 currently not in the library yet thank                                 you any more questions oh sure okay so                                 one more than do you there are                                 situations where Iran experiment and the                                 amount of change is so small that the                                 control and the treatment kind of they                                 don't show any significant difference                                 but there is when there is this very                                 very small change is that capture by I'm                                 talking about trigger logging if you                                 know what I'm like triggering triggering                                 like it's an event that happens                                         not in person                                                          but we think that zero point five                                 percent of the cases it affects the                                 results so you don't see it often but                                 when you see it it's significant and I                                 don't know if that's captured by I mean                                 libraries that are generally i generally                                 built on okay so i'm not quite true if i                                 can answer that correctly but i think                                 and we have no special mechanism                                 currently to deal with that in the                                 library and you can try maybe to use the                                 subgroup analysis for that if you can                                 really specify that as a feature when                                 this event happens and then you don't                                 have to investigate your whole an                                 experiment based just to see some small                                 effect that is only yeah interesting for                                 a specific subgroup yeah but if you have                                 a good algorithm for that or any idea                                 you're more than welcome to contribute                                 thank you we have one more question                                 probably the last one put the session                                 I thanks for your presentation just                                 python has a lot of very good modules                                 for statistical analysis and machine                                 learning and so on so I was curious how                                 much did you have to call yourself and                                 what libraries did you use and yeah                                 great question I think yeah you can                                 download the code of course and look at                                 it so we are using syfy a numpy and that                                 i really like convenient to do these                                 things and they also include basic                                 statistical tests I for example like                                 choice square tests and that we are                                 using and but this is the library is                                 more like the framework around and so                                 that we have these data structures that                                 we yeah can really like provide analyses                                 specific for these AP tests that we want                                 to do and this becomes then quite some                                 code and yeah there are a lot of things                                 planned and also in the library that are                                 not covered by these basic libraries                                 that are available in Python but yeah we                                 want to of course use saipin Empire                                 stuff as much as possible and also panos                                 is part of what we are using do you want                                 to take one more question any any more                                 questions all right                                 hi you show that the software was about                                 analysis of the AP test however usually                                 the analysis is also input for defining                                 the new ib tests for instance how long                                 should a test be run especially on your                                 size with so much diversity is that                                 something you guys do in a different                                 framework or could you tell me something                                 about setting up the new ib tests for                                 tomorrow mmm okay yeah so I think there                                 are different questions one is of course                                 how to come up with new good hypotheses                                 and this is yeah something where for                                 example the subgroup analysis provide                                 some insights maybe but yeah there they                                 go in a lot of other things and a lot of                                 domain knowledge just to set up the next                                 good test and the other question is                                 about sample size I guess a sample size                                 duration of the test yeah so that's                                 another thing that's currently not                                 completely covered with our library we                                 are doing that currently and yeah                                 manually or with other tools and yeah                                 but may this is maybe a good thing to                                 include next future yeah because the the                                 analysis framework know so much about                                 previous experiments and therefore these                                 results can give you some input about                                 the new experiments hmm or do you wait                                 until it converges and then stop the                                 test sometimes people just stop the test                                 when it converges when they like the                                 output and they stop yep okay okay                                 thank you so much Dominic thank you very                                 much Kiki
YouTube URL: https://www.youtube.com/watch?v=5q8RNX9Mbhs


