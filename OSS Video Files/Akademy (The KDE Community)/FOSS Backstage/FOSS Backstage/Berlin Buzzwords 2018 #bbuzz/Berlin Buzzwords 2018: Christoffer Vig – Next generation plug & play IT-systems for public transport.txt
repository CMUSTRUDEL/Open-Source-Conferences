Title: Berlin Buzzwords 2018: Christoffer Vig – Next generation plug & play IT-systems for public transport
Publication date: 2018-06-18
Playlist: Berlin Buzzwords 2018 #bbuzz
Description: 
	Christoffer Vig talking about "Transport-as-a-Service (TaaS) - How we build next generation plug-and-play IT-systems for public transport (ITxPT) at Ruter"

The digitalization of everyday life, where the average bus passenger would rather ignore the surroundings and stare blankly into his phone for snapchat updates, creates great opportunities for digitalization of public transport, as well as some challenges. Ruter, Norway’s largest public transport authority, is putting significant effort into improving digital services for customers.  However, the current technology stack behind Ruter's operations, is not able to provide the necessary real-time information.

In this talk I will explain how Ruter is participating in the development of new European standards for information technology for public transport (ITxPT), and how Apache Kafka and Kafka streams serve as the core components in building "Transport-as-a-Service".

Read more:
https://2018.berlinbuzzwords.de/18/session/transport-service-taas-how-we-build-next-generation-plug-and-play-it-systems-public

About Christoffer Vig:
https://2018.berlinbuzzwords.de/users/christoffer-vig

Website: https://berlinbuzzwords.de/
Twitter: https://twitter.com/berlinbuzzwords
LinkedIn: https://www.linkedin.com/showcase/berlin-buzzwords/ 
Reddit: https://www.reddit.com/r/berlinbuzzwords/
Captions: 
	                              I'm here today to talk about how are you                               today Norway's largest Transport                               Authority is creating a new digital                               platform for improving their customer                               services and also to get better control                               of their data so the agenda today is I                               will explain a little bit about what                               Ritter is and what they do how they were                               engaged in the ITX PT project which                                tries to create a new european standards                                for information technology in public                                transport so this relates to toss or                                transport as a service which is the team                                I'm working in at Ritter so aperture                                kafka is the main technology and the                                core system we're using and now try to                                expand what about Kafka that makes it                                obvious that it's the best choice for us                                so you twist the largest public                                transport authority in Norway they serve                                about three hundred and seventeen                                million passengers last year and they're                                based in Oslo and serves the surrounding                                so it's about one and a half million                                people in there it retails owned by the                                county of Oslo and our courses so it's a                                public company they get get money from                                the public                                are any of you and the users of public                                transport or under Dean not using public                                transport I guess this is something that                                most of us tend to use almost every day                                so what what do you think about it our                                offense you like your public transport                                services yeah so you like it good well                                sometimes it tends to not to be good as                                well you have to find out where to enter                                the bus or the vehicle you have to stay                                in hotel noisy places and it's kind of                                somebody else who defines the schedule                                you can if you're a bit strict you can                                say that public transport is the                                opposite of the freedom freedom of                                movement is one of the key human rights                                Liberty to travel and Ameri about you                                please without impending the liberty of                                others of course and the ultimate                                embodiment of this used to be to own a                                car when you own a car can drive                                wherever you want when whenever I'm                                public transport is just the opposite of                                this however nowadays owning a car                                driving to work or to school or wherever                                you want to go more and more looks like                                this picture you're in the traffic jam                                you don't know where to park and it's a                                large costs it's a big hassle                                so car ownership ownership again turns                                into something resembling the opposite                                of freedom routed along with several                                other public transport companies are                                working towards a vision of something                                they called mobility as a service which                                again will turn public transport into                                something that is inducing inducing                                freedom so mobility as a service is an                                extended version where you not only have                                the regular buses and trams and trains                                but you add add in rental cars and                                bicycles taxis all kinds of transport                                and they're all combined in the same                                digital platform and they're accessible                                in your smartphone and that makes it                                very easy to just tap into a solution                                tap into an app select where you want to                                go of course you have to might have to                                walk a little bit that's very good for                                you but the idea is that you have a very                                immediate solution to create a route                                from A to B now sorry transport as a                                service which I'm talking about I will                                soon get to these pictures it's a subset                                of mobility as a service so transport as                                a service is something that will be a                                neighbor for a mobility as a service                                platform where we have ability to gather                                all kinds of transport means and no to                                illustrate why this is necessary I want                                to tell you a little story from my life                                and here comes the dog so this is my dog                                his name is Miro it's a Japanese Spitz                                it's a puppy of five months and he needs                                to be taken out in the middle of the day                                and this somebody is quite often me it                                takes him out                                so luckily I work and live in the center                                of Oslo so it's possible to take public                                transport to get home I'm back again and                                when I do that I try to do it in just                                 one hour so I can just use one ticket                                 because I live so close that I would                                 rather walk but I don't want to be away                                 too much at the middle of the day from                                 work sorry so this is where a map of the                                 center of Oslo the typewriter is where I                                 sit and type code and the picture of the                                 dog is where me and my dog lives and the                                 green and white lines those are two                                 different tram lines so now I want to go                                 home I can take any of these and I want                                 to figure out which one is the fastest                                 and can take me home the first so this                                 is a screenshot from Mandira                                 app which shows the planned timetables                                 from my work and not unto home                                 you see there are three different charms                                 I can take trend number                                                 the departure times it's at                                                                                                             real-time data so what is just ER this                                 is kind of in the middle of the day this                                 is not correct the trams will be delayed                                 luckily there's another screen and this                                 app we can look up the estimated                                 departure times                                 this shows on the list of all liens                                 trafficking a stop and the one I would                                 take is number                                                           just that it is it will be at a stop in                                 one minute so we can                                 first asset it's five minutes till                                 number eleven is there and this one says                                 one so you can see this big difference                                 and once I go to the actual stop the                                 tram is all together at the stop place                                 there are also signs that show                                 information and these signs are even                                 more accurate than the app but still                                 they are inaccurate in my example it was                                 just one minute off but very often it's                                 a lot more so it's a lot of misleading                                 information the current situation is                                 that the trip planning apps that don't                                 use real-time data have some real time                                 that are supposed to be real-time in the                                 departure times the physical signs have                                 even better real time data with Seagram                                 and it makes the dog works too short                                 it's a big problem so what does what is                                 the reason for this what has happened                                 the reason is that we just not own the                                 data they don't own the buses editor ISA                                 and authority to hire others to to run                                 the services and they cannot directly                                 access data from vehicles the real-time                                 data we have available is coming from a                                 third party which is m                                               national body that collects all public                                 transport information so the problem is                                 that the operators control all the                                 vehicles on the data at the same time so                                 now we'll have to explain to you the                                 difference between a PTI and a PTO in                                 the public transport language a PTH at                                 cetera theater is the one who's                                 responsible towards the public and watch                                 the government for public transport in                                 an area they create all the timetables                                 they do marketing like credit apps and                                 websites and they order services from                                 the PTO the PTO are the ones that                                 actually own own                                 the vehicles and they hire the drivers                                 this is a map showing this is from the                                 ITEX PT website I don't want to go into                                 detail on this which it just shows that                                 you have the various colored areas those                                 are representative of a geographic area                                 and a PTI often has one area while a PTO                                 the operators with the vehicles they can                                 have several at the can work for several                                 treaties so it's a management                                 relationship here and as I said normally                                 the operators sit on the data there's                                 not much exchange so we didn't actually                                 wanted to fix the situation with missing                                 data so in                                                            with collecting automatic passenger                                 counts or APC data these are sensors                                 that sit right beside the doors inside                                 of the buses and they can count how many                                 are entering a bus on how many are                                 exiting some of them can see the                                 difference between child and adult                                 someone can see if there's a wheelchair                                 or a bicycle they're installing                                     buses now                                 so what happen is that there were three                                 different actually several different                                 vendors that created these systems and                                 we have a situation where all vendors                                 chose their own way of implementing in                                 this then they're our own data formats                                 and their own way of doing it so like no                                 be enough for instance they want to have                                 data sent to their back-end and from                                 their interpreter                                 and some of them wanted to push data                                 using a rest service some of them are                                 pushing data to MQTT the data format is                                 of course very different from every one                                 of them and on some they're counting                                 from starting from the beginning and                                 just adding up till you till you're at                                 the end so did ya there's just different                                 meanings of the four data since nothing                                 has been predefined they can just figure                                 out or do whatever to go                                 so as you understand their need for                                 Standardization yes sir and this answer                                 is the ITX PT projects information                                 technology for public transport this is                                 a European initiative I tried to create                                 a so-called plug-and-play system for                                 information technology for public                                 transport they're actually having a big                                 meeting today in Paris we're discussing                                 how they should proceed these are some                                 of the members of IT for PT well if you                                 can see any Germans in there but there's                                 a mixture of public transport operators                                 authorities and people creating the                                 technical solutions all we have an                                 interest in how the standard should be                                 are taking part and there are very                                 active discussions there are                                            groups who all have their say in various                                 parts of the standard IT for PT has                                 created four standard documents of which                                 the installation requirements is talking                                 about how they did the electrical                                 current should be inside of the bus it's                                 it's nothing that we care about the                                 on-board architecture is about what kind                                 of components a bus should have it                                 should be present recording GPS and so                                 on I will go into it later the back                                 office architecture is what happens on                                 the back of in the                                 of a side that means how we handle                                 traffic from the bus and how we handled                                 the timetable plans the ovary                                 architecture is about how to bridge data                                 from buses to back-office so it's about                                 a data transport okay and it's also a                                 little bit snug but so this is a picture                                 of the situation before I takes pity a                                 bus has several components in this                                 picture each of them has their own                                 network connection and they all                                 communicate with each other using                                 probably wires from one box to another                                 or if there's an network I don't know                                 and the driver screen is for different                                 displays from four different boxes so it                                 I takes pity you get a much cleaner                                 picture there's one network connection                                 all the components talk together in one                                 in one network some of the components is                                 Auto this is the display information                                 it's the advanced vehicle monitoring                                 system the system will not keep track of                                 how the bus is progressing on its                                 journey                                 there's the APC which I mentioned the                                 automatic passenger counts the GPS that                                 is the one that keeps track of the                                 location the Midd is the driver terminal                                 so the DP I module is the one that's                                 responsible for creating information to                                 the passengers so you can see on the                                 left-hand side there's a box a front                                 side display this one has to be very                                 visible so we are very limited in what                                 you really can do and on the right hand                                 side we see some other displays that we                                 have been created in the Ritter project                                 we will see this clear later on                                 so the AVMs advanced vehicle monitoring                                 system is to enact keeps track of the                                 progress and it informs to displace with                                 information back-office several                                 standards netflix is for plan data this                                 is the thing that editor is doing you                                 know figuring out where should the                                 routes go how many buses to be needed                                 here and there and it's an ethics data                                 series data                                 that's the real-time data which is                                 continuously updated as when the bus is                                 driving I say bus but it's also tram and                                 whatever and the over-the-air                                 specification talks about how                                 communication between vehicle and back                                 office should handle the specification                                 talks about using an mqtt bridge which                                 practically makes it possible to have                                 all information from the bus may route                                 into the back office and also you can                                 Meerut sent information from higher                                 office into the bus so transporters are                                 serviced is the research way of doing IT                                 xpt the concrete background between us                                 creating this project was that the                                 reader has to deliver has to get four                                 hundred new buses available in                                           created a attender with specifications                                 based upon eight x bt we had specified                                 how they wanted the traffic to be                                 between the buses and back office this                                 was created by some people in my team                                 based upon IT Expedia where of course we                                 had senator has a policy to prefer                                 open-source components wherever possible                                 and the reason is that they don't want                                 to be tied up to one vendor one                                 assumption that return makes on the item                                 check at expertise under is that all                                 vehicles are always online this has the                                 implication that we can always                                 communicate with the bus and update                                 information inside the bus in the ITEX                                 pta standard there are several there                                 it's a it's a standard in development so                                 there are several different ways to do                                 it normally or in the old style of doing                                 public transport you have the a VMS                                 system loaded with data when the bus                                 starts and it keeps track of progress at                                 it as it goes reads it this progress                                 from the odometer which just counts                                 Amanda metres the buses driven and the                                 figures out however it is at a route                                 from this so what you do in route is to                                 since we are always online we don't have                                 to have an IV mess inside of the bus we                                 pick out there                                 FMS and do all the processing in the                                 back office which of course has some                                 advantages this means we can do machine                                 learning we can figure out how long does                                 the delay used to be on this point at                                 this point of the road at this time and                                 we were very flexible with how we create                                 the information and also have it create                                 at this place so this of course makes                                 for a continuous stream of updated data                                 back in to the vehicles and it also                                 makes it easier to have the unexpected                                 changes                                 so this is a schema of the main data                                 interactions in transporters of service                                 so she's starting from the bus you have                                 some interactions with streaming                                 platform we're passing on the location                                 the passenger counts and the sign on                                 messages and there's so many information                                 that is created handled onto the                                 operator the operators of course have                                 their own interests in in data from the                                 bus this is not something that I'm                                 talking about but an operator would                                 probably have a whole different story                                 about how this data is running the                                 operator is responsible for a driver so                                 he has to texture make sure that the                                 driver has the correct information while                                 a true trivia are we care about the                                 passengers so we must provide                                 information to the passengers so what                                 happens when a driver science into a bus                                 he passes on to the streaming platform                                 Vox journey he is on we combine the data                                 from our planning system the TPS at the                                 bottom of the picture so we can figure                                 out what route is on I can come can                                 monitor the journey                                 so the interaction between the operators                                 and the authorities are happening                                 because we know how the list of service                                 journeys are are created to have the                                 complete route for a bus for one day and                                 this makes it possible to know in                                 advance if a bus is delayed on one line                                 it will be delayed also on the next                                 [Applause]                                 so the streaming come from at the middle                                 of the picture is apart you cough cough                                 so cough cough you may have heard about                                 have some properties that make it very                                 suitable for real-time processing so                                 this is something I copied from the                                 website through a problem or many times                                 before but we use cough got to put these                                 producers pushing and data to cough come                                 and we have stream processors modifying                                 the data inside and we have several                                 consumers and we will use a lot of                                 stream processing to enrich data coming                                 in I will more about this later so the                                 traffic Tran system is where we keep                                 track of its our master database for all                                 the journeys so this is something that                                 we actually if all vehicles were on time                                 we wouldn't need anything other than                                 this                                 this contains plan timetables and it is                                 the same as thing I showed you at the                                 beginning which says that the Sharma is                                 departing at                                                 unfortunately delays happen all the time                                 and certain facts of life TPS is                                 available in a graph QL interface which                                 is very nice to explore the data this is                                 an ethics model and it's extremely                                 complicated it has a little justice key                                 among some of the structures so what we                                 do is to make it easy for ourselves we                                 publish data from GPS into Kafka using a                                 batch job every night that publishes all                                 da all the journeys that we are supposed                                 to run on the current day so we set                                 these topics with a clean up policy                                 compact so we can just keep the latest                                 item it's easy to manage us a table so                                 let's have a look at some how the data                                 flows inside of this system this is this                                 is our demo bus we actually have a                                 physical bus that we have installed all                                 the components it's made for our users                                 so it has just the things we need so                                 let's pretend to be on board the palace                                 bus and the first thing I have to do is                                 to sign onto a vehicle we publish a sign                                 on message to the MQTT topic pulsing on                                 the number of the vehicle and the                                 journey ID for the vehicle and this is                                 my colleague perova doing a sign on to                                 see his is holding an iPad or something                                 and which is so perhaps not exactly what                                 the driver will use but this is our demo                                 and they've all made all things as a web                                 service and it's very easy configurable                                 with screens getting their information                                 from Android things using raspberry PI's                                 which makes the whole system is very                                 easily reconfigure figural and this this                                 way of during the digital dynamic                                 passenger information is something that                                 we are bringing into ITEX pity to try to                                 make them work towards a system that is                                 very dynamic and not locked up to to the                                 old ways of doing things                                 the the sign on message must be matched                                 towards the service journey from TPS so                                 this is a little dump from that system                                 where I just don't highlighted the ID                                 combining sign on with service journey                                 happens in a Kafka stream application                                 using a global kettle for the service                                 journeys since the key first sign on                                 would be a vehicle and the key for                                 global the service journeys don't have                                 any information on vehicles so what's                                 interesting now is when we get the GPS                                 signal just contains lots of information                                 also the speed and so on joining this                                 together we can figure out the location                                 of the bus on a journey on the next stop                                 in combining this with the departure                                 times we can make estimates these are                                 some of the images inside of the bus                                 someone in this place                                 so for a company like Rooter who cares                                 about the passenger                                 but fair on the passenger satisfaction                                 it's very important to have a full                                 control of the displays this is                                 something that we have created in in our                                 system so as you can see the ITX PT                                 standard combined with kafka enables                                 real-time data processing for public                                 transport and makes it possible to get a                                 better estimate of the times something                                 is supposed to be there and more                                 importantly using cough-cough we are                                 ready to handle any kind of producers so                                 since we now have only our own system to                                 get data from it works for the register                                 but it can easily extend this to several                                 other producers it can be small                                 companies just publishing their service                                 journeys into Kafka and we could get the                                 GPS signal from all the sources as well                                 and just do the same for other so we are                                 ready to handle the mobility as a                                 service the platform is ready only thing                                 that's lacking is everything else so we                                 have decoupled data from the producer so                                 the conclusion is that mobility as a                                 service improves animal welfare thanks                                 for listening                                 [Applause]                                 any questions                                 I am the data that you are using to like                                 sending between the central systems and                                 the buses and is this data also                                 available for third parties could you                                 add like an application into it and like                                 do something with it yes most of the                                 data is accessible to public parties and                                 this is the AMT which I briefly                                 mentioned the globe national a company                                 which keeps all the information for                                 public transport companies I guess you                                 have something similar in Germany as                                 well so they have all information except                                 for the blocks blocks is the list of                                 service journeys and the list of                                 journeys and that is very tightly                                 coupled with the vehicles and this is                                 not something that the public is                                 interested in but it should be like if                                 you want to create very good estimate                                 secured use this information as well but                                 it is very hard to know you wouldn't get                                 information on what to vehicle runs                                 what's a journey for us well at least                                 and this data is something that may be                                 available in the future - yes about the                                 the equipment's and the buses what's who                                 codes like what's the code running on                                 that like what languages and who                                 programs them as well well their program                                 by different vendors so this is kind of                                 not something I have control over so it                                 could be anything                                 cool I also have another question in                                 terms of changes in the schedule for                                 example there's a construction work and                                 a big a beam or something how does the                                 communication back to the operators of                                 like you know                                 a detours or other spot or the stops at                                 the bus have to make and how does the                                 communication work backwards is that all                                 automated as well or is something manual                                 that you know people have to adapt to                                 the information about deters is also                                 something that will be automated but of                                 course we also have possibility to send                                 manual messages to drivers so this is                                 something that is who is responsible for                                 this is the operator or the authority it                                 depends but sometimes you just have to                                 divide it it works today is that                                 sometimes they just draw on a map on a                                 good night or something and brighten                                 your route and send it to the drivers by                                 email but of course this will be                                 automated sometime but it is probably                                 not the first thing yes                                 any questions more                                 when you're dealing with always online                                 do you then care about the event time                                 you're sending or to your process on a                                 ingestion time very good question thank                                 you the in the contract with the                                 operators we need the month that data                                 should be no more than I think two                                 seconds delayed or something so it has                                 to be if this is something that's                                 defined in the contract so that we have                                 to what to do is really in practice this                                 of course doesn't happen                                 events are delight sometimes with                                 several minutes so we in the back back                                 office to be much much back with the                                 correct location very much very much the                                 passenger counts back to the correct GPS                                 location yes                                 [Music]                                 lise with our local transport systems                                 you learn fast which lines and transport                                 options are unreliable you know as an                                 individual you know that bus sucked so                                 you will know that from your data as                                 well won't you will you be sharing that                                 so he said I want a connection from here                                 to there they'll don't go that one                                 because you'll probably miss it do you                                 plan to be honest basically well that's                                 interesting I don't think we would share                                 this ad so please avoid this bus or this                                 driver but more this bus at this time of                                 day                                 yeah the answer is that we will of                                 course use this information to improve                                 the services and I don't think there                                 will be a plain site where you can go                                 and see what where to when on the way to                                 avoid certain stop services no okay                                 thanks                                 that's a good idea                                 okay if there's no more questions and                                 thank y'all for coming and thank you                                 Chris                                 [Applause]
YouTube URL: https://www.youtube.com/watch?v=QapOox1XXTk


