Title: Mixing and Matching - Part 4 - Andreas Wagner - Learning to Diversify Search Results
Publication date: 2020-07-02
Playlist: Haystack - Joint Virtual Event 2020
Description: 
	More: https://berlinbuzzwords.de/session/mixing-and-matching-diversifying-search-results

Imagine a shopper searches for "coffee". The search results mindlessly repeat brand name, ground coffee over and over. Technically relevant. But not very useful. Not mixed in are results appealing to a different kind of "coffee" searcher:  organic coffee, whole bean, espresso, or related coffee equipment. 

Beyond relevant results is Result Set Diversity: providing not just technically correct answers, but a diverse (though still relevant) view of what's possible in the search system. Showing our grocery searcher that we might, after all, have something they want.

In this panel, we'll discuss Result Set Diversity in search. We'll hear from teams working to summarize for users the diverse array of options available to them given their query. An ideal search experience helps provide next steps, broaden the user's understanding of the content related to keywords, and cover the user's possible, unspoken intent.

Join host Doug Turnbull and search practitioners, Andreas Wagner, Felipe Besson, and Lev Gershenzon, as we hear experiences measuring & solving Results Diversity, with a panel discussion on the Result Search Diversity problem.
Captions: 
	                              yeah hi so hope you can hear me well                               thanks for the                               and thanks for setting the scene                               from the other guys so in my talk I want                               to really cope with let's say the                               situation where autosuggest                               or the way the user comes to decider to                               the search result yeah I haven't been                               specified or couldn't be be more precise                                so it's really about how we could help                                the user to cope with large search                                results that have a lot of diversity in                                it yeah I as I said earlier said earlier                                I am working at CSP and such a bio and                                yeah happy to get some some direct                                messages you can find me in Twitter yeah                                just one slide about the companies so                                economist experts this is a search and                                discovery this consultancy so here we                                have people that that yeah to optimize                                design deploy and operate such platforms                                for their living all of us have more                                experience than                                                         would say mainly in e-commerce a couple                                of projects of this domain but most is                                in Indy commerce and because we were                                tired of solving issues over and over                                again at each and every customer we                                build search up and search up is a query                                intent clustering pre-processing means                                we write motivate optimization platform                                and the cool thing about this is it                                works with any search solution so you                                can just hug it plug it in as a kind of                                proxy and it helps you to automate your                                search but now let's go back to the                                topic of diversification so I'm a really                                data-driven guy and I was only always                                thinking yeah we can approach the                                problem of relevancy and an optimizing                                e-commerce search purely by by data but                                let's say since a couple of months                                I turned this a little bit because data                                only represents                                what was and never tells you what could                                be so yeah this is a this is a I think a                                really nice yeah or to put it in one                                sentence if you are data-driven you are                                very likely to be locked in a local                                market maxima and you're not really                                exploring so products that are bought                                very often will be bought very often but                                you have potentially a lot of                                interesting products for some of your                                customers which essentially will never                                be seen so or explored so in my opinion                                from from from the relevance perspective                                relevance at least for now                                doesn't directly address a                                attractiveness or ambiguity or biases so                                search result diversification can really                                help and especially when a quantity of                                relevance is not enough we can diversify                                if the search content is ambiguous let's                                say garden furniture it doesn't really                                look ambiguous but what types over there                                are different types of garden furniture                                and what would you say would it should                                we include balcony furniture as well so                                I've picked an example here of course on                                the left hand side there's a lot of                                let's say stuff for accessories around                                garden furniture but even if this would                                be a perfect garden furniture product                                list so full width let's say some sofas                                and and and and things like that I think                                the right side is helps me way more in                                finding potentially the right product                                because garden furniture is a broad                                query so maybe I am not really sure what                                I wanna buy yet and I want to get some                                some information or I want to be guided                                and I think the right-hand side can do                                it not saying it's it's particularly                                nice or or shiny but it essentially can                                help the next part is when users want to                                be inspired                                so women's shoes it's it's it                                a nice example I've always picking out                                the last year too but this time from a                                different angle so there might be                                different types of shoes and different                                types of styles of shoes so when you                                look on the left it's just a list of                                kind of randomly sorted products and on                                the right these products are kind of                                grouped by different attributes so let's                                say here that on the first row it's                                about a special style the second one is                                 about a special type of boot the third                                 one I don't know to be honest how these                                 Crocs made it in there but I guess it's                                 more kind of the leisure issues and then                                 of course the heels and the cool thing                                 about it is that this directly gives a                                 customer or potential customer an                                 overview of what is in there and it                                 gives you the opportunity to to browse                                 through kind of different categories or                                 a facets without having to reload the                                 page so here I can directly see a broad                                 assortment or care together over look                                 over the broad assortment without having                                 to refine it and wait until the page                                 loads again and then go back if it's not                                 what I want to see additionally we can                                 diversify when users could and should be                                 treated differently so let's say I'm                                 searching for power drills and then                                 there might be the question yeah but                                 what it can can the result be different                                 or should this a result be different for                                 different types of users and yeah it can                                 so like on the on the left hand side we                                 we see a sorting it's not particularly                                 well grouped in terms of visuals but                                 here it's kind of the basic what sells                                 best gets the first place and on the                                 right side when I know it's it's a                                 professional craftsmen I know that yes                                 special needs about the power drill so                                 here                                 a special products come on top let's say                                 the the professional line or specific                                 brands so it was mentioned earlier but I                                 think what one additional part is                                 missing and how to spot these things and                                 information entropy for me is the                                 data-driven way of spotting these types                                 of queries but to add this onto a panel                                 I think we don't have a single a single                                 entropy so of course we can just use the                                 categories but essentially it's a set of                                 entropies                                 so it might be interesting to look at                                 different product attributes the price                                 ranges or whatever kind of information                                 we have about the products so that's why                                 I would strongly recommend to look at                                 the product customers interact after a                                 search and then find different                                 distributions or entropy entropy s for                                 different kinds of metadata information                                 so let's say attributes and things like                                 that and then you can really spot things                                 that may be interesting and may help                                 users to directly find what they're                                 looking for and another really important                                 thing and I am I I really always tell                                 our customers to go in the way this go                                 to people in in your in your company and                                 especially if you're coming from foreign                                 for read from read retail there are a                                 lot of people that have an immense                                 knowledge about how to visualize how to                                 group products how to make them stand                                 out and ask them about their jobs and                                 and then how they approach these things                                 because this is essentially for free                                 everything that is data driven cost time                                 cost money and can potentially be wrong                                 if a person does this already for                                    years it might help you essentially this                                 for spotting different types of                                 audiences again you could use                                 information entropy again it's it might                                 be a set of different                                 entropies and additionally mark a                                 marketing team if you have a marketing                                 team go there ask them about different                                 audiences because it's their job to talk                                 to these audiences and shape information                                 and and and output marketing towards                                 them okay so now I want to really get                                 into how the we could diversify things                                 and different strategies to do so so if                                 you look inside a store I I've never                                 I've never asked this question when I                                 went to so well when I was confronted                                 with this diversity problem this                                 question came up and I asked a personal                                 working in such a store and the person                                 told me that none of these products you                                 currently see here on this picture has                                 its place by coincidence it's planned                                 months before and there is a lot of data                                 and and just knowledge from people and                                 inspiration from people that tells ma                                 that they should put these kind of                                 products together in the same area and                                 this kind of inspiration to look at it                                 like this so on the left side we have me                                 might have a broad theory and this might                                 be the result so we have some common                                 attributes or or common types of                                 products represented in different color                                 and on the right side I added a little                                 bit of structure so I kind of sorted                                 them or group them and by I think                                 directly visually you can see that by                                 adding structure it really helps you to                                 navigate faster through this kind of set                                 but on the other hand                                 it changes the problem so now we don't                                 have a single ranked list anymore it's                                 several ranked lists and this this                                 picture and this sentence comes from an                                 open book so this this book is open                                 available and it's called visual                                 merchandising and the interesting thing                                 is that he really points out that we                                 should group product sets in in visually                                 let's say related content concepts                                 because people can process and and use                                 visual information sixty five sixty                                 thousand times faster than text and that                                 really helps so there are already                                 companies that are doing these kind of                                 they call it visual merchandising I                                 would call it diversification but here                                 is a very cool example in my in my                                 opinion so this not only works for                                 search results                                 this works for categories as well so                                 let's say you have this nice women's                                 accessories category and accessories is                                 always a mess how would you rank these                                 kind of things and and here it's really                                 that idea is to have to use different                                 rows and to use different let's say                                 campaigns or or goals for each and every                                 particular row and now the business sort                                 team or what the business goal that is                                 behind it is not shown by the initial                                 let's say yeah ranking in the search                                 result it's how you rank the results per                                 row so let's say in the first row we                                 have scars and smooths and and they                                 might be sorted by top sellers then on                                 the second row we have hats and and                                 there might let's say on bra and might                                 be pushed and then we have gloves where                                 a different kind of strategy might come                                 in and I really think that this is a                                 very nice way of of giving an entry                                 point for a user which comes to the                                 women's accessories aisle because yeah I                                 mean there's tons of stuff a customer                                 could could potentially want and here                                 you can directly guide him and well what                                 I what I want to point out here is I                                 don't have an example of a web app but                                 if you if you would imagine looking at                                 this site from and from a mobile a point                                 of view what is really interesting is                                 you could let's say swipe left and                                 and each and every road to to have a                                 look at now the the scars and then swipe                                 swipe up if you're not really into                                 scarfs maybe you're more into gloves and                                 once you see a glove then swipe left and                                 right and again you don't have to have                                 an additional page request you just are                                 directly into the products and the                                 assortment and I think that's that's                                 fantastic                                 yeah one one pro tip so essentially we                                 are we are making a little bit a little                                 bit more complex so we are breaking and                                 learning to rank problem in multiple                                 learning to rank problems so we could                                 learn to rank each and every row but we                                 could essentially we also learn how to                                 rank the different rows um the next                                 thing I want to talk about is the real                                 let's say search result diversification                                 and and here it's really about the                                 ranking for the diversified rows so and                                 and in my opinion this is the way where                                 we can really find the balanced match                                 between the shopper interest to buy and                                 the business interest to sell so in a                                 lot of cases when I am at the customer                                 the customer tells me so my customer is                                 the shop owner yeah but I don't want to                                 sell this product because the margin is                                 lower than others so please push all my                                 products that are for my brand always                                 high margin on top and then I tell them                                 yeah well this might work but                                 potentially the customers don't just                                 just don't want to buy this product and                                 it's really hard with a single ranking                                 to to to to to balance different kind of                                 strategies so that's why a robust                                 ranking diversification can help so I                                 said earlier you can essentially give                                 every row a different ranking and really                                 play with it it's not only about giving                                 them just the different ranking but you                                 can you can then explore and experience                                 how people behave when they see these                                 things and how they interact with it and                                 then reshape all of that                                 yeah and since we really I mean in such                                 Evan and income aspects that we really                                 try to solve things one time for all of                                 our customers and since at least for now                                                                                                      open source tools or open source systems                                 we said okay we need to build something                                 to help them diversify their our search                                 results or category results and this                                 solution needs to work with each and                                 every answer solution so from from a                                 business perspective so what I                                 essentially want is I want to have a                                 kind of yeah SQL language where I can                                 say yeah please group me products by a                                 specific amount of attributes and then                                 assign a specific ranking for it you you                                 don't have to do this manually I mean                                 you you can essentially learn all of                                 this pretty much automatically but still                                 there might be a lot of cases where                                 people are just let's say creative and                                 have really bright minds and want to try                                 things so you really we said we really                                 need to to help them to do that and and                                 and and to ship these kind of                                 experiments because in my opinion it's a                                 kind of an experience yeah and to get                                 these collections of items was a really                                 hard engineering problem so I already                                 had the idea a couple of years ago and                                 and really tried to achieve this in in                                 in a search engine even in the                                 e-commerce space that tried it with                                 elastic and solar and I mean you could                                 achieve it but it was always a mess and                                 it was always pretty slow so that's why                                 I said okay we need to find another way                                 where we can define and and get these                                 collections so what we what we said we                                 need then is okay we have this this                                 query API we have the search engine                                 results and then we want to in                                 in an artificial way documents or                                 document IDs it doesn't really need to                                 be the ID it could be the complete data                                 that is needed to render on the                                 front-end and then we need some kind of                                 result blendering a blender that pushes                                 these products on the right positions or                                 building blocks and then the result api                                 and yeah of course the system to define                                 these groupings and rankings there is a                                 whole data pipeline thing around this                                 which i don't want to cover here because                                 this might be different for each and                                 every customer but essentially with this                                 system here and if you would manually                                 build these rules you could directly use                                 it we have some building blocks that we                                 need for that so first of all we need a                                 very fast and flexible way of grouping                                 items and getting let's say the top-end                                 products out of it                                 so as I said as I have shown earlier and                                 is in the image give me all the scars                                 and maybe that contain winter and have a                                 specific color and and and just put them                                 somewhere then we have this item ranking                                 on top so where I said yeah well now I                                 have to set but I want to rank it by I                                 don't know margin top sellers and                                 another metric that might be there and                                 then for exploration I said okay but on                                 top of that because we need some kind of                                 randomization in there as well because                                 otherwise we are we are stuck in the                                 same potential local optimum as well we                                 need some kind of really fast weighted                                 sampling so there what we would do is we                                 would go in in in these groups of                                 products which might be let's say                                    products we only show four of them but                                 how to pick the four out of the                                         will be done by weighted sampling so by                                 that we can in may we can ensure that                                 new Prada                                 or products that have never been seen                                 yet are injected there and have a chance                                 to to be clicked bought and whatnot and                                 then we need this feature that takes                                 this set of products and pins it on top                                 of the the the results list and of                                 course in a deed applicated way I don't                                 want to show the same products I say                                 twice or or even more okay so this is                                 how we solved it so the first part was                                 it was the really hard part                                 engineering problem but fortunately and                                 we found somebody who already solve this                                 so we really tried a lot of approaches                                 different databases used our own data                                 structures to get this fast and then but                                 then I buy by a coincidence I stumbled                                 about yeah a project which is called                                 collection query engine and the                                 performance of this thing and the usage                                 and the solidness is just mind-blowing                                 so that's why I put it here I mean we                                 will put it together in in this kind of                                 diversification package for search but                                 still have a look at this repo it's                                 really amazing so with that we would do                                 the grouping and we would do the initial                                 ranking then we had to solve this fast                                 top K weighted sampling thing again                                 there were a couple of implementations                                 but all implementations at least I found                                 were too slow                                 so by puppet by just a simple trick and                                 we were able to really reduce this and                                 and and now you could let's say for for                                 one page where we have let's say five                                 different rows you could do this                                 weighted sampling in less than a                                 millisecond so essentially you have done                                 four times or maybe or five rows four                                 rows where you might want to use this                                 might sampling and it's it's so fast                                 that you can't even measure it and on                                 the on and                                 then the last one is the pinning so we                                 we are thinking about having a way of                                 injecting these products on top of let's                                 say the normal result set because we                                 want to make sure that all the facets                                 and and stuff are still working                                 perfectly but unfortunately yeah                                 the pandemic infected our release                                 schedule so stay tuned we will update                                 our open commerce search project and it                                 will find its way in there as well yeah                                 so um my is essentially my last                                 important slide so let's start balancing                                 the match between the shopper interest                                 to buy and the business interest to sell                                 and and and it really makes some big                                 progress there because I still feel that                                 yeah these these we don't have a                                 balanced match yet it might be                                 data-driven but we are not trying to do                                 the best we can for both of the the                                 audiences yeah thanks and if you have                                 any questions and if there are some                                 developers or people that just want to                                 work on these kind of areas join our                                 team Thanks                                 you
YouTube URL: https://www.youtube.com/watch?v=QU0ndZvM_LQ


