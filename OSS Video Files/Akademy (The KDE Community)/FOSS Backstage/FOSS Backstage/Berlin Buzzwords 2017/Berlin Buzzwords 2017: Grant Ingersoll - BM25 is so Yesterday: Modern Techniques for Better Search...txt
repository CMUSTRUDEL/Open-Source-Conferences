Title: Berlin Buzzwords 2017: Grant Ingersoll - BM25 is so Yesterday: Modern Techniques for Better Search..
Publication date: 2017-06-15
Playlist: Berlin Buzzwords 2017
Description: 
	Grant Ingersoll talking about "BM25 is so Yesterday: Modern Techniques for Better Search Relevance".

Modern relevance in search engines has come a long way since the early days of information retrieval, when the likes of TF-IDF and BM25 scoring models first came on the scene. And while those core models are still good for a first pass retrieval, more and more search engines are employing machine learning, natural language processing and sophisticated re-ranking techniques to fine tune relevance. 

This talk will provide a review of current best practices in relevance tuning, including what to measure and how to measure it. We’ll then give details on how to use techniques like learning to rank and query intent classification to improve results, with examples in Apache Solr. We’ll finish with a sneak peak into using deep learning and word2vec in a search context.

Read more:
https://2017.berlinbuzzwords.de/17/session/bm25-so-yesterday-modern-techniques-better-search-relevance

About Grant Ingersoll:
https://2017.berlinbuzzwords.de/users/grant-ingersoll

Website: https://berlinbuzzwords.de/
Twitter: https://twitter.com/berlinbuzzwords
LinkedIn: https://www.linkedin.com/showcase/berlin-buzzwords/ 
Reddit: https://www.reddit.com/r/berlinbuzzwords/
Captions: 
	                              hello and welcome back uh here at Casa                               house our next speakers grunting is Oh                               co-founder and CTO of lucid works and                               his works title is BM                                          yesterday are better ways to do search                               ah you go microphone yer data deals                               alright first talk after lunch does                               everybody awake all right how many of                               you are actually search developers and                                you spend a lot of time on relevance                                alright so let's get started and let me                                see if this fits with what your life                                looks like user comes in on your site                                type in iPad case and they do a search                                and you being the good engineer that you                                are whether using solar or elastic or                                any other search engine out there you                                probably do some things query parsing                                etc and you might generate a query that                                looks something like that lots of                                variations on this thing I could make it                                harder I can make it easier all of those                                kinds of things but since you underneath                                the hood you're doing something like                                that and then your engine goes off and                                if you were in earlier talks you can                                kind of learn about what's happening                                underneath the hood and loosening your                                engine goes off and it comes back with                                these two results now I'm actually not a                                German football fan but I looked up a                                few the very first one Darmstadt I                                looked up the stats for this year's                                season there in last place                                whereas Munich is in first place but you                                can see in the search engine Darmstadt                                come up count comes up as number one and                                munich comes up as number                                          course we've got some fans of Darmstadt                                over here but the reality is your                                marketing team your boss your customers                                they really don't like Darmstadt right                                they want munich to be at the top in                                fact when your marketing team comes and                                talks to you they say munich outsells                                darn                                stat like a hundred to one could you                                please make Munich be at the top of the                                list just like they're at the top of the                                standings no offense and so as a good                                engineer you start to dig in what would                                you do you start to dig in where do you                                start well you go read the manual we've                                seen solar all these engines they have                                pretty good manuals out there the beauty                                of open source is you could actually                                even look in the open source maybe you                                start to dig in and you realize oh well                                what I'm going to do is when that                                document comes in for Munich I'm going                                to hard-code a hundred as a boost on                                that document and that's going to make                                Munich come up at the top or maybe a                                query time I'm going to be even smarter                                and I'm going to take my main query and                                I'm going to order together with                                something else and now all of a sudden                                whenever somebody searches for football                                are sorry yeah football I keep wanting                                to say soccer no offense                                when somebody searches for a particular                                team etc we can make sure that Munich                                comes up at the top maybe that doesn't                                work right people have tried that                                sometimes it works most of the time it                                works sometimes it doesn't so then I                                heard about this thing a new scene                                called explains or debug query if you're                                a solar user or whatever other engine                                you're using has similar functionality                                and you get something that looks like                                that it's an eye chart don't worry I                                don't expect you to read it but it tells                                you all of the gory details about why                                that document scored the way it does in                                fact I've used this a lot of times in my                                career is to figure out what the heck is                                going wrong with search still maybe you                                don't figure it out and you go get                                Doug's book or you go get my book or you                                go get Trey and Tim's book and you say                                I'm going to really learn this stuff I'm                                going to dig in I'm going to figure out                                all the theoretical stuff I'm going to                                learn what tf-idf and document length                                normalization and all of these kinds of                                things are maybe I'm going to figure out                                what the heck that thing is that's B m                                  hence the talk title                                 and this stuff is all really good you                                 should definitely learn this as a search                                 engineer not here to try to dissuade you                                 out of that but what I really want to                                 talk about with this talk is how do we                                 put this kind of stuff in the                                 perspective of what you're seeing out of                                 more modern search approaches so first                                 off after you've done all that low-level                                 stuff you might have this brilliant idea                                 that says well how do I really know                                 whether this stuff is working so you                                 read these books and you start to say oh                                 well we need to measure things right so                                 maybe the first thing you do is you just                                 start asking your colleagues hey what do                                 you think of this result for this query                                 this is our most popular query what do                                 you think of these results and you could                                 go and do that with additional users you                                 can maybe set up some focus groups with                                 your customers if you've ever heard of                                 something like Trek you can actually go                                 download like a whole data set from the                                 academics that will help you judge how                                 your search results are doing maybe just                                 maybe if you have enough people on your                                 team you might have a company gold                                 standard for your content so you can                                 actually measure your own relevance you                                 tend to only see that at companies that                                 are really big and have like                                            person teams who do nothing but work on                                 relevance in fact those companies                                 usually are monetizing their search                                 results which is why they spend so much                                 time on this and you might dig in and if                                 you were at the earlier learning to rank                                 talk you can see details around some of                                 these metrics you might care about                                 precision recall NDC g-m are are all of                                 those fun terms and then just like how                                 your shampoo recommends that you lather                                 rinse repeat you're going to keep doing                                 this and this is basically job security                                 for you because you're the relevant                                 person at your company and you're really                                 smart and so you're going to keep doing                                 this and doing this and doing this and                                 doing this and in fact I've been doing                                 this for too long to remember the                                 reality is it's a lot of work right it's                                 a lot of hard work and if maybe there's                                 some better ways and so as a developer                                 you have a brilliant idea and you ask                                 yourself what would Google do                                 and what Google would do is say let's                                 make you do all the work and then I'm                                 just going to harvest the information                                 from all of the users that are                                 interacting with it I'm going to build                                 out this fancy machine learning and AI                                 and all of those kinds of stuff and so                                 that's kind of where we end up and so                                 now to kind of put this stuff in                                 perspective in terms of thinking about                                 the bigger picture around relevance is                                 if you take is kind of a stack here this                                 core information theory here that's                                 leucine solar elasticsearch you name it                                 that's kind of that core cosine                                 similarity tf-idf be m                                              reality is is that's good for getting                                 you somewhere between                                                   of the way when it comes to relevance                                 depending on who you talk to I once sat                                 next to the CTO of Yandex at a workshop                                 and he told me in his opinion at the                                 time Corby m                                                             the way in terms of relevance at the                                 stage like a large-scale web search                                 engine and then you know over the years                                 all of these engines have built tools to                                 help you better navigate this content so                                 things like facets did you mean all of                                 that kind of stuff highlighting and then                                 obviously you have some business                                 specific things that you're doing so you                                 know you start adding in rules you start                                 hard coding things like Munich gets a                                 hundred and Darmstadt gets negative                                    all of those kinds of things but the                                 reality is these days to kind of get to                                 that next level                                 most people are starting to adopt this                                 approach of learning from your users and                                 learning from the content at a much                                 deeper level applying machine learning                                 across the stage here doing things like                                 personalization crowdsourcing user                                 feedback etc to help you better                                 understand what's going on with the                                 content I mean my best New York accent                                 that last bit of getting perfect results                                 well forget about it as they say in New                                 York because you're never going to get                                 there so when your boss is yelling at                                 you about why not everything                                 perfect you can just tell them well I've                                 done everything else grant said in the                                 stack but there's always going to be                                 some queries we just can't make be the                                 best they can be so what is this stuff                                 start to look like when I think about                                 the bigger problem I tend to think about                                 relevance going across three different                                 dimensions the first one is the content                                 side of the things this is the stuff                                 you're all used to as search developers                                 working on right and it's still really                                 important it's still good for you to                                 make sure you understand what fields                                 you're searching on make sure you                                 understand how we've seen and solar are                                 doing their things make sure you've got                                 your faceting and business rules and all                                 of that kind of stuff but these days I                                 spend most of my time that's kind of a                                 given if you will with solar spend most                                 of these times on things like                                 collaboration and context and how do we                                 leverage what information we know about                                 what other users like you have done as                                 well as who you are where you are what's                                 the context of your situation in this                                 particular case so what does this look                                 like as we dig into the real world well                                 so first off on the indexing side you                                 often see more and more things like                                 machine learning taking a look at                                 building up a conceptual model of all of                                 your data so for instance if you've                                 heard the word word to vac or if you do                                 named entity recognition if you're doing                                 topic detection all of those kinds of                                 things start to factor in you've built                                 these offline models that you're                                 injecting in at indexing time such as                                 contents coming through you're taking                                 that up you're enriching it all of those                                 kinds of things you've been doing that                                 for a number of years                                 the cool thing these days is there's a                                 lot of new technology out there that                                 makes this stuff even better you might                                 have your domain rule still and then you                                 output all of that content the solar                                 what you're starting to see now more and                                 more is take a tool like spark bring in                                 the data is kind of this continuous                                 model now where you're constantly                                 improving these models I kind of think                                 about it as your search engine is your                                 real-time best known state of your data                                 and then offline you're constantly                                 trying to improve that state of the data                                 right such that then for                                 anyways we put all of those models back                                 into solar and you'll see some of this                                 here as a demo later and then just                                 continue on lather rinse repeat takes on                                 a new meaning here because instead of                                 you spending your time hard-coding your                                 rules you're spending your time figuring                                 out how to make better models that scale                                 better that are more representative more                                 generalizable all of that kind of stuff                                 what's the query side look like well we                                 got our happy user over here or                                 hopefully a happy user one of the first                                 things you start to see coming into play                                 above and beyond what people typically                                 do when they have solar is one of the                                 first questions you want to ask yourself                                 is what does this user actually mean by                                 this query and do you even need to                                 search right we assume as search                                 developers that because people put in a                                 query to your search engine that you                                 damn well better hit the search engine                                 because that's why I'm doing this all                                 for but the reality is is you don't                                 necessarily need to do that if a user                                 comes onto your site and says how do I                                 open a new account they don't want to                                 see                                                                     you they want you to take them right to                                 the account opening page or they say how                                 do I make a return again don't show them                                                                                                         in them take them to the page that says                                 here's how you make a return right so                                 you don't always have to be in this                                 mindset of search so you want to think                                 then about a couple of different things                                 with query intent I tend to break it                                 down into a couple pieces the strategic                                 side of it is what is the overall intent                                 is this user looking for a product are                                 they looking for help are they you know                                 teenagers being stupid and giving you                                 spam etc etc the tactical part of that                                 then is what are the key parts of that                                 query that I can then leverage to make                                 for a smarter query somebody comes in                                 and searches for iPad well that's a                                 brand it's also a tablet it's a product                                 they might say                                                         brown leather case in which case you                                 have a brand and then you have a bunch                                 of attributes or they might spell things                                 wrong etc so you have all these tactical                                 bits that you want to                                 if I as part of that intent and then you                                 could feed that into semantic engines                                 next thing I often do is think about how                                 does this query relate to all the other                                 queries that I've seen before especially                                 if you're in a consumer facing search                                 site you often have a power-law                                 distribution for your queries you know                                                                                                          your queries represent                                                   that kind of stuff and so you might                                 start to look at how am I going to                                 leverage what I know about what are                                 called my head queries my most popular                                 queries to help answer what do I what I                                 know about my tail queries my less                                 frequent queries right and there's often                                 actually a lot of really interesting                                 relationships there in fact I was just                                 working with a pretty largest of the top                                                                                                 something like                                                           are one of two things they're either                                 spelling misspelling or their attributes                                 on a head query                                                      that's that really long lock tail and                                 the reality is is most people are really                                 good at tuning their head queries                                 especially at really large scale so if                                 you can help them improve                                              tail they're going to thank you quite a                                 bit because they're laughing all the way                                 to the bank as they say the other                                 interesting thing about this is all of                                 this data this clickstream data this is                                 the same day that makes for better                                 search it's the same data that makes for                                 recommendations it's the same data that                                 makes for personalization and it's the                                 same data that makes for analytics and                                 yet all too often I see companies who                                 have those things all spread out in a                                 lot of different places so for instance                                 they put up the site users start                                 clicking that goes off into Omniture                                 Omniture over to the data science team                                 data science team goes and builds some                                 fancy model the engineers get that fancy                                 model and say wow that's great we get a                                 lot of uplift off of this model but gee                                 that's too bad it's going to take us                                 four months to actually get it into                                 production because it's built an r and                                 it's slow as can be right                                 we want to solve those kinds of problems                                 other things you might start to factor                                 in is what user factors you have in the                                 query are these young old male female                                 green brown blue whatever it is that you                                 use as factors for understanding your                                 users then you want to start to bring                                 those in things like their history their                                 profile does this user prefer luxury                                 brands or do they prefer value brands                                 how do you use those things to bring                                 into your search world as well as things                                 like security if this is behind the                                 firewall who can access what data all of                                 that kind of stuff on and on we could go                                 from there                                 we could apply our domain-specific rules                                 we hit solar I'll show you what kind of                                 this query looks like here in a minute                                 and then this is where it gets really                                 interesting these days I think a lot of                                 people who have been in the lucina's                                 Solar land they tend to think about oh                                 well I hit solar I do one query and then                                 I get back my results maybe you've heard                                 about the rear anchor or the rescore as                                 it's called and leucine and so maybe you                                 might think about how do I do some of                                 that kind of stuff the reality is if you                                 look at the top tier of search engines                                 these days they actually are doing a                                 whole cascading set of rear anchors such                                 that something like a leucine based                                 engine is you can kind of think about it                                 that's my coarse-grained search results                                 it's the one that more or less matches                                 and then you apply a series of rear                                 anchors on top of that I know some                                 companies who have a single model just                                 for scoring number one versus number two                                 in the search results think about that                                 right a lot of companies - like if you                                 heard the Bloomberg talk earlier they                                 talked about how you know you might have                                 solar and then you might apply machine                                 learning model that does the top                                         top five under the top                                                   of just continue on down from that and                                 reality is it kind of depends on how                                 much do you care about these things                                 right as to how much you're going to                                 invest in that again if you're making                                 all of your money off of search you                                 probably should care about it and you                                 might want on                                 number one versus number two or at least                                 a top ten versus top                                                    other things you can do here is for                                 instance if you take your query intent                                 one of the things the query intent might                                 do is say this search belongs to this                                 particular category you might have a                                 category per model in fact I was at a                                 academic conference last year that                                 Amazon presented that and they have                                 something like                                                         exact number different models depending                                 on what category you know so jewelry                                 might have its own model and you know                                 snowblowers might have its own model                                 right kind of again depends on where you                                 make your money as to how much time you                                 would invest in there you might also do                                 things like put in bias Corrections                                 there if you're not up on the latest in                                 search all things equal most people will                                 pick the number one item regardless of                                 what's there versus number two so you                                 might have some functionality in your                                 system that allows you to perturb those                                 results make number one solar and all                                 this stuff tells you it's number one you                                 might just make it number two and test                                 to see how that works right because it                                 could just simply be that because of                                 that first click or that first result                                 bias something that actually deserves to                                 be higher up is not getting enough                                 signals or clickstream or any of those                                 kinds of things in order to surface up                                 to the top so and then of course you can                                 apply your results transformations all                                 of that kind of stuff a little bit on                                 the learning to rank side there was a                                 talk earlier by the bloomberg folks go                                 listen to that one if you want all the                                 gory details the cool thing is solar has                                 got this built in these days and it's                                 quite easy to use and in fact it also                                 has some really nice tools around                                 helping you with feature selection and                                 those kinds of things the one caveat                                 right now is you have to do your model                                 training offline but you can use kind of                                 standard training libraries like Lib                                 linear Lib s V M lambda Mart all these                                 ones that if you read the academic                                 literature are commonly cited as the                                 best performing system so                                 I'm not going to go into too much                                 details I'll show you a little bit of                                 this in action in the demo oops forgot                                 my animations here sorry about that                                 if we look at the user side of all of                                 this we got to capture what users are                                 doing yet again this is you if we go                                 back to that hey this stuff is really                                 expensive or it's really convoluted by                                 the time it all fits one of the things                                 we just do at loser works is put all                                 that data right back in solar it's very                                 good at tracking events or signals as we                                 call it so I've kind of given away the                                 punchline here but these days what we do                                 is we put in solar then we load it up                                 via a spark we build our clickstream                                 models we do things like our head tale                                 analysis here we build out recommenders                                 and personalization and all that kind of                                 stuff                                 and again the documents just end up back                                 in solar as models and then forwards                                 back into that query Edition that we                                 talked about that's all well and good                                 what does that query often look like                                 this is kind of pseudo leucine solar                                 syntax your mileage may vary there's                                 lots of other things you could do with                                 it I tend to think this is kind of how I                                 can sexually think about what all this                                 stuff looks like as more or less a query                                 to the engine right it's not                                 mathematically precise but I kind of                                 think about it is those first two the                                 exact original and the sloppy phrase                                 that's kind of like my really high                                 precision content-based matches that's                                 what's going to get me a highly accurate                                 set of results right and of course all                                 of those weights that I have on there                                 those can be learned or you can guess at                                 them try them out and then I'll do                                 things like ands and ORS just to make                                 sure that I'm getting everything the or                                 really becomes your recall query to make                                 sure that you at least retrieve                                 something that resembles what your user                                 asked for many of you are probably                                 already doing this with things like the                                 EDA smacks or whatever other Lucien's                                 disjunction whatever it's named                                 query underneath the hood but probably                                 these other things are new to you so in                                 fact you can think about it how do we                                 bring                                 in expansions our clique our head-tail                                 relationships all of those as queries                                 you can bring in your personalization                                 biases you can bring in learning to rank                                 all of these things start to seamlessly                                 work together and outcomes your search                                 results naturally you can apply your                                 filters your hard filters across all of                                 that as well with your filter queries a                                 couple of interesting things here you                                 know like I said one of it is you have a                                 lot of knobs and dials so if in your                                 particular application you don't have a                                 lot of confidence in the quality of your                                 click data for instance then maybe you                                 know that why why there is lower than if                                 you have a lot of confidence in that                                 data depending on how you do your                                 learning to rank some of these things                                 you maybe would push down into your                                 learning to rank model if you wanted                                 there's some trade-offs there in terms                                 of your essentially hard coding into a                                 model that you then have to reload                                 anytime you want to change it whereas if                                 you do it at query time you have a                                 little bit more flexibility and trying                                 things out there and then you know                                 things like your personalization biases                                 of course you need to be aware of what                                 you're doing what choices you're making                                 when you personalize you want to make                                 sure that you're not doing bad or                                 encoding your own personal biases into                                 those kinds of things so this is just a                                 quick solar syntax example I'll leave it                                 up there you can look at it later but                                 essentially at the top that's your main                                 query things like filters are your query                                 intents like in this particular query                                 i'm classifying it as computers and                                 tablets                                 i've got a learning to rank model in                                 there i don't know why i have all the                                 stuff URL encoded but it is and then                                 things like my boost and all that stuff                                 is at the bottom there that's all great                                 right but at the end of the day don't                                 take my word for all this one of the key                                 things to modern relevance is you adopt                                 an experimentation mindset right what                                 you want to do is within your company                                 drive down the cost of running an                                 experiment most people don't know this                                 but most of the                                 search engines the big search engines                                 they run hundreds if not thousands of                                 experiments a year right at any given                                 time it may be the only                                             users ever see what that engine                                 considers to be the best version of the                                 engine everything else is an experiment                                 some experiments are going to be really                                 good your marketing team will be really                                 happy with you most experiments are                                 going to be flat at best and some of                                 them are going to be really bad losers                                 so make sure you kill them when                                 appropriate as fast as possible if you                                 want to learn more about that ronnie                                 koha vini                                 I always butcher his name as a really                                 good talk on how Microsoft runs their                                 experiment management framework and then                                 you know at the end of the day we still                                 have that                                                              of rules of saying I want Munich to be                                 boosted this high up in the results you                                 can use things like the query elevation                                 component or other rule-based systems I                                 just try to encourage everyone when                                 they're thinking about rules is to make                                 sure they put the rules in the context                                 of an experiment and they make sure that                                 their rules have a lifespan I can't tell                                 you the number of places I've gone in                                 where a customer will have                                             rules and you say oh that rule right                                 there what's that do and you'll get this                                 blank stare back at you Joe wrote that                                 like I've never met a Joe I've been                                 working with you for six months now                                 where's Joe Oh Joe quit five years ago                                 like why is it still there well Joe                                 wrote it you said it works and on you go                                 next thing you know you've got                                        rules you might as well not even have a                                 search engine just have the rules return                                 the documents right so just make sure                                 you put rules in the context of the                                 bigger picture that you're trying to do                                 and think about how do they how do you                                 actually measure them for effectiveness                                 and how do you make sure you continue to                                 measure for effectiveness all right cool                                 what does this stuff actually look like                                 I'll show you a demo of it a couple of                                 things there are                                 texture I'm not going to spend a lot of                                 time on it but spark and solar are the                                 key pieces here and then we've got some                                 machine learning bits we're going to                                 focus in on and in fact the couple of                                 key things going on here on the solar                                 side we've got all this extensive text                                 ranking stuff I don't want you to throw                                 any of that out that's still good stuff                                 and you've worked hard to learn that                                 kind of stuff things like your different                                 similarity models BM                                                    it is you want to use underneath the                                 hood things like function queries boost                                 the block the re-ranking capabilities                                 learning to rank all that kind of stuff                                 on the spark side primarily there's a                                 lot of machine learning stuff you could                                 also use mehat you could use any engine                                 out there you want but essentially we                                 need something that allows us to take                                 all of these this raw data all of these                                 signals these cliques etc and turn that                                 into a better search result so what I'm                                 going to do then is demo this ecommerce                                 data set one in a                                                       more interesting thing is out of this                                 data set you've got one month of query                                 logs that's really the gold that stuff                                 that you used to throw away that's what                                 you're keeping now I've done the offline                                 training of the models offline if you                                 want to see how all of that gory details                                 works                                 go watch the Bloomberg talk etc but I                                 essentially just build it did I took the                                 signals I rolled up on the user ID and                                 the query are not the user ID on the                                 query and output the counts of the query                                 document pairs and I use that as a rough                                 estimate of relevance in terms of                                 feeding that into the learning the rank                                 module and then I'm using fusion which                                 like I said the key parts here SPARC                                     and solar                                                                top of it as well so all things willing                                 live demo on my local laptop let me                                 login                                 a couple of different things I'll                                 highlight here first off everything you                                 see here is going to be done by                                 searching against solar I've calculated                                 a bunch of stuff offline and spark and                                 installed that back into the end of the                                 engine first thing to note I talked                                 about a/b testing you saw how that                                 changed from tablets to TVs one of the                                 things that we just build in is the                                 ability to do those experiments by                                 essentially injecting parameters into                                 the solar query to say I want to search                                 this way or I want to search that way                                 this particular one I've set up a very                                 simple experiment that's just going to                                 say TVs versus tablets and as the user                                 interacts with those with that landing                                 page it will then auto level if TVs are                                 performing better than tablets those                                 will be shown more shown more if tablets                                 are getting more of the users then we'll                                 move that up and in fact though it has                                 ways of if TVs happen to be having a bad                                 day one day it will still show TVs                                 enough such that over time it figures                                 out who's best the other thing that's                                 interesting here is just using all of                                 that signal data on the product catalog                                 just doing a search against solar                                 getting back recommendations done some                                 more advanced things underneath the hood                                 using some of the more modern recommend                                 a recommender engine capabilities like                                 alternating least squares and all that                                 kind of stuff but essentially I've got                                 user based recommendations that's part                                 of understanding that user and now the                                 moment of truth if I come in here and I                                 do a search for iPad                                 what I've got here is a way of getting                                 started is some very basic results this                                 is me doing a little bit of solar tuning                                 I think you would agree with me a search                                 experts there all right if you actually                                 look at the data you can see why those                                 first ones match they've got the word                                 iPad in there I'm essentially doing                                 keyword matching here the reality is and                                 I've also I'm looking at a title                                 description and there's like this sales                                 rank data in there and in fact those top                                 three accessories for ipad are all                                 highly purchased items                                 so perhaps I'm boosting a little bit too                                 much on that sales rank and I could                                 spend some time on it but you know the                                 lats a fourth one there is the iPad but                                 the reality is I think you would agree                                 with me these results are just ok I'm                                 going to show you fusion just because                                 it's mainly easy way for me to edit all                                 of this stuff let me make sure I'm                                 logged in here but essentially what and                                 I'll show you the underpinnings they                                 just output parameters I'm just                                 outputting parameters of solar I've got                                 a particular pipeline set up here that's                                 just doing solar queries I'll show you                                 that in a second but let's get to the                                 punchline first I'm going to switch to                                 one that uses signals and then beyond                                 that I'll show you one with learning to                                 rank so now what I did is same query                                 doing the same search against solar but                                 now I've overlaid that single                                 information on there I think you would                                 agree with me these results are a lot                                 better but you can still see that things                                 like those accessories still show up                                 here because people in fact when they                                 search for iPad are buying these                                 accessories if you look in the raw data                                 it's in there but you know your                                 expectation here would be that we're                                 finding the iPad so that's all well and                                 good a couple of other things to note                                 built out I've shown you one recommender                                 user for item recommenders the query                                 there is the user ID the second one this                                 related searches the query for that                                 recommender is the query so I'm doing                                 query for query recommendations if I                                 click through on a particular item got                                 now item for item recommendations yet                                 another collection in solar this time                                 key buy items and getting back results                                 for those things                                 the cool thing like I said here is all                                 that same data that signal data that                                 clickstream data can be used to measure                                 or implement all of these things and you                                 have a much simpler deployment and all                                 of that kind of stuff                                 digging in a little deeper let's                                 actually look at what this stuff looks                                 underneath the hood load up my query                                 view here I've got that default may be a                                 little bit hard to read there in the                                 back let me make that a little bit                                 bigger for those of you who are solar                                 Lucene devs this is just bait                                 sickly a little bit of an interface over                                 the top of the EDA Smacks query you can                                 see like this is where I spent some time                                 early on like oh I think names are                                 boosted by                                                              all of that kind of stuff right and on                                 down the chain we could go and we get                                 those results we saw first if I load up                                 that other pipeline the one with the                                 signals on a little bit different look                                 to this one the very first thing we do                                 here is actually go query another                                 collection called the signals                                 aggregation collection I built that                                 offline it essentially has a time                                 decayed based model off of what users                                 are doing with this data such that                                 things that are popular today aren't                                 necessarily popular tomorrow right I do                                 that query then I make decisions about                                 how much do I care about how much do                                 users care about the documents that's                                 what these roll-ups and boosts are and                                 then I'm applying rules I'm not going to                                 show you the rules engine here today in                                 the interest of time but I hook in the                                 rule stuff so that's kind of that next                                 level first level with solar next level                                 is I'm using clickstream things the last                                 level here I can show you today is                                 essentially one with the full shebang if                                 you will the first stage I've got in my                                 process of a request coming in is I'm                                 actually I've trained offline infusion                                 and spark off of that same data I've                                 trained a classifier that tries to                                 predict what category does this query                                 belong to and I'm just loading that up                                 as a model in fact I'm loading it right                                 out of solar as a model and then the                                 query comes in it looks in the cue field                                 and then it's going to output into the                                 request pipeline a field called                                 predicted query category okay the next                                 thing I'm going to do here then and you                                 could do a lot of things now I've chosen                                 to do one very simple thing namely I                                 have a little bit of a condition that                                 here that says basically if this query                                 category is anything other than other                                 then apply a filter                                 to this content okay you could do boosts                                 off of that you could change your                                 learning to rank model you could do lots                                 of different things here and then you                                 know I've done things like I turn on                                 learning the rank and then all the rest                                 of this is the same let me come back                                 here and I'll just show you what this                                 looks like right here instead of going                                 back to the main UI you can see so for                                 instance let me turn off the filter                                 query you can see there's AG Apple iPad                                 yada yada those are promoted up if I and                                 there is                                                                 back there there's                                                       there if I turn on that filter it now                                 filters down is essentially categorizing                                 iPad as a computer or tablet I'm                                 applying that as a filter query against                                 the category name and now I've only got                                                                                                          interesting results here at the top                                 those are in fact built off the learning                                 to rank model if I turn those off I can                                 get those results the learning to rank                                 model I just did a very simple set of                                 features there things like the price and                                 a few other pieces off of there I didn't                                 spend a lot of time on making sure the                                 learning to rank model is the absolute                                 best learning to rank model I just spent                                 time on making sure all the plumbing                                 works if you want to you have to spend a                                 lot more time on the features and all of                                 that kind of stuff so that's the demo if                                 you want ah there's some resources I                                 think we've got a couple of minutes left                                 for questions thank you                                 other questions in the audience there's                                 one in the middle                                 give me a second hi there so on your                                 perfect queries like you mentioned all                                 the different boosts the X the Y the set                                 and so on and said hey all of them can                                 be learned and now I was wondering                                 what's coming up to learn the very first                                 the X that you give basically to the                                 p.m.                                                                learn them already as well in the                                 context of LTR yeah exactly that's kind                                 of what the ltr' stuff does you know you                                 can essentially if you look at the ltr'                                 stuff it's great question you could                                 factor in a lot more of these things as                                 part of the LTR model right yeah so in                                 fact the question was are they available                                 to the offline learning if you look at                                 the the example that solar ships with                                 there's this little Python program in                                 there and it basically as its training                                 its taking in the set of relevant                                 results that you gave it and then it's                                 hitting the features in getting the                                 content back from solar to get that                                 offline to get the information for                                 training so it's essentially saying oh                                 I've got this relevant information match                                 it up with the documents that are in                                 solar already and then learn a model off                                 of those features so yeah you definitely                                 could represent some of those things as                                 part of as part of the offline learning                                 to rank stuff right the caveat with you                                 know we use learning rank for a lot of                                 these things there's also these other                                 places where you want machine learning                                 like your query intent and all of that                                 kind of stuff that maybe or maybe not                                 belong in the inner loop or the near                                 inner loop of a learning to rank model                                 so depending on what kind of flexibility                                 you want you may decide to do some of                                 this classification stuff up front or                                 some of it in the learning to rank area                                 yeah Oh a dog is going to ask me a tough                                 question                                 I was curious in your experience if you                                 viewers used learning to rank directly                                 as a recommendation solution and how it                                 compares versus like ALS or other                                 traditional offline methods that's a                                 great question I actually haven't                                 compared those two you certainly could I                                 mean essentially a search engine the                                 math is roughly maybe not the same as                                 like an ALS or some of these latent                                 models that are doing like latent                                 factorization that kind of stuff but you                                 probably could get reasonably close in                                 terms of performance and you don't have                                 this offline step if you don't want to                                 which you know may or may not kind of                                 again there's always this threshold in                                 my mind of like how much time do I want                                 to invest in and that threshold is                                 almost always based off of how much                                 money do you make off of your search                                 engine and how many people do you have                                 on your team right so just doing a pure                                 soul or peer whatever leucine you can                                 certainly get a good model taking it to                                 that next level I didn't really show it                                 here but you know for instance all of                                 those models like right here this is                                 your output from my learning my offline                                 ALS model is just item ID and other item                                 ID right the related searches is I don't                                 know why I'm looking up there when I can                                 look here the related searches same kind                                 of thing here you know people who search                                 for Bower and Wilkins also search for                                 workaholics those kinds of things the                                 cool thing here right is all your data                                 is just right back in solar right and so                                 you can take and you don't have to have                                 this big long trip you know between                                 armature and all those other pieces all                                 right oh let's think gaunt again thank                                 you                                 [Applause]
YouTube URL: https://www.youtube.com/watch?v=CRZfc9lj7Po


