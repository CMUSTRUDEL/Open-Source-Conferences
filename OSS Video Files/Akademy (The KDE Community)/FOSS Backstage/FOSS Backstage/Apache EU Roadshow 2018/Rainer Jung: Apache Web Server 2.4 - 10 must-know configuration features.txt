Title: Rainer Jung: Apache Web Server 2.4 - 10 must-know configuration features
Publication date: 2018-12-05
Playlist: Apache EU Roadshow 2018
Description: 
	The Apache web server 2.4 provides many very useful configuration features that most admins still do not know well enough. Examples are the powerful configuration expression language that allows dynamic configuration, a macro language that makes it possible to reduce configuration repetition in big configurations and very fine grained control of logging. The talk shows the most important such features based on real-world configuration examples.
Captions: 
	                              I think it's time for me to start second                               talk there's quite some overlap but but                               not too much I hope and for the parts                               that overlap at least you get the                               feeling that we both think they are                               important although sometimes it's small                               features it's very helpful features as                               with Jim if you have questions simply                               ask them don't wait until the end of the                                talk there might be no time at the end                                ask your questions and we'll see how it                                goes so first of about me my name is                                Renee young I'm also part of the project                                and a member of DMS I'm doing lots of                                performance analysis and other                                troubleshooting so I do have contact a                                lot with reproduction environments                                what's the goal of this talk I will show                                nice little tricks not the big picture                                and most of the tricks are many of those                                tricks are not well known and and you                                should try them and see how they help in                                your work I will not describe general                                best practice this is really picking                                some small things that might be useful                                none of the features need any                                third-party module anything comes with                                Apache                                                                  going through define I'll maybe have                                some different examples and some                                additional information mod macro per                                module lot levels then something about                                access locks and what you should or can                                configure there to help correlation ID                                forwarding matlock debug if with                                expressions location match and                                especially for location match named like                                references then what remote IP and some                                special mode SSL configuration directive                                that's the list of the my                                               I want to show you so first number one                                define define defines global config                                variables many of you will use for                                instance mod rewrite to define request                                environment variables those are per                                request variables define defines global                                variables that are configured for all of                                the runtime                                of the server and the syntax is just                                defined and the variable name and then                                the value and you can use the variable                                anywhere in your configuration with the                                notation dollar and then parentheses and                                the name of the variable inside so for                                instance proxy path slash F HTTP and                                then I add this dollar stage there you                                could also some people know this                                notation dollar parenthesis from old                                times where you could reference                                operating system environment variables                                like this but there's an important                                difference an operating system                                environment variable you cannot change                                during runtime because it's inherited                                from the starting process so even doing                                a restart or a graceful you cannot                                change the operating system environment                                variable in your envoie you can change                                it but it won't make the way into the                                process define variables you can define                                inside the config so you can change it                                to a graceful and then the new value                                immediately gets effective so typically                                you would factor out names or sizings                                that occur at multiple places in your                                configuration and then in which you                                would change for instance if you have                                different values on different stages                                then you can factor it out replace it by                                variables your configuration files get                                constant and you move all the defines                                into a specially included a file where                                you have an immediate overview of the                                the varietals that you are using if you                                need to undefined a very yes if it                                yes it's an empty string then it's an                                empty string or no it's actually it's                                throwing an error I think                                it's throwing a warning that the                                variable doesn't exist                                it's rowing a warning that it doesn't                                exist yes yes you can undefined                                a variable that's an unusual thing to do                                and you can check for the definition of                                a variable not for its value                                unfortunately we come back to this point                                later but for whether a variable is                                defined or not you can do a conditional                                configuration with if define if defined                                 people used even in previous versions                                 they define variables with the minus D                                 flag on startup but with minus D you can                                 only set a variable but not to a value                                 it's defined it's there but you cannot                                 change you cannot assign it a value with                                 define you can assign an actual value                                 and a negation for if defined you at the                                 exclamation mark so for instance here's                                 a configuration snippet similar to                                 chimps where the minus de and the define                                 notations are combined with the minus D                                 test during startup you decide which of                                 the two blocks get active and then in                                 the two blocks we define variables which                                 we use for run in the configuration so                                 number two is mod macro using templates                                 a macro is a config snippet with                                 parameters so again it's the V host mark                                 rule similar to what Tim does because                                 that's boilerplate code that you have a                                 lot in your configurations so you want                                 to shorten that and be careful using too                                 many macros might make your                                 configuration hard to read for newcomers                                 but sometimes it makes it more                                 expressive because you can remove the                                 boilerplate part of the of the                                 configuration and condense it down into                                 a single token with parameters yeah so                                 you have to be careful doing it in in                                 the right amount                                 not because Apache complains but because                                 you still need to understand your                                 configuration so Apache expands all of                                 these macros and defines during config                                 in passing it's not done Turing request                                 processing it's done at startup time                                 during configuration parsing so and then                                 you actually include the macro as an                                 active part of your configuration with                                 the use command like this slight change                                 to to your template is Jim included                                 virtual host lines in the McCoy and I                                 excluded them to be able to add more                                 lines to the virtual host block so it's                                 adjust to your needs yeah as always so                                 what's the difference I mean define is                                 especially useful if the same value is                                 used in several places and you want to                                 factor out this value in a central place                                 to control it easily there mark hole is                                 more useful if you have a complex block                                 of configuration then repeats but has                                 slightly changed values this you then                                 inject via the parameters so both help                                 you reorganize a configuration but for                                 slightly different targets number                                   promote your LOC levels in the past you                                 could only change the lock level                                 globally for the server and then for                                 instance if you had proxy or SSL running                                 and you change your lock level to debug                                 you got flooded by a by a by LOC lines                                 because they locked                                 a lot on the debug log level there was                                 no chance doing it in production now you                                 can do the module conflicted the lock                                 configuration on the per module basis                                 for instance you could say my lock level                                 is info but for a rewrite module I'll                                 want to see everything because I need to                                 debug some rules I did make with the                                 Swiss Army knife but they are not                                 working as expected and there's some                                 other thing hidden in this                                               people will remember that they had the                                 rewrite lock directive rewrite lock                                 level directive with which you could                                 only form what rewrites had already set                                 an individual lock level the rewrite                                 locked level directive is gone and the                                 lock levels                                                          mapped to the new lock levels debug to                                 trace                                                         so and you can do that as Jim already                                 said even in a in a virtual house or                                 directory context and you can do it even                                 more specific I'll come back to that                                 later so number four and I think that's                                 that's one of the small things that are                                 really useful                                 by default the time stems in the excess                                 locks are on the second basis you have                                 to the hour minute and a second but you                                 don't have a finer time granularity the                                 web server does have it but it doesn't                                 put it into the XS lock and for                                 compatibility reasons and this old                                 common log format definition cetera we                                 didn't change the default format but I                                 would encourage you to change it to                                 include sub second granularity to your                                 start time stems and the way to do it is                                 looks a bit ugly it's here and typically                                 in your lock format access log format                                 there is somewhere a percent T that's                                 the time stem and what you can add now                                 is you can add with curly braces some                                 terminology that determines what is                                 written for this time stem what part of                                 the time stem in which format and most                                 of it like here there is a percent curly                                 braces then some string end of the curly                                 braces T this string is come from the                                 definition of the C function string                                 format time esta ref time it already                                 exists and it has lots of characters                                 where you define whether you want to                                 have a numeric for a month format a                                 string month format a short one                                 localized one etc you can use all of the                                 characters here that your strf time                                 implementation supports and we edit                                 because strf time is also very old it                                 doesn't know about sub second                                 granularity it ends with a second so we                                 added some proprietary definitions and                                 this is the one here for instances at                                 the fraction or behind a second in                                 microseconds so this will at a sixty two                                 it sub second time stem and the set is                                 just for the                                 zone so this will print a time format                                 like you are used to except that after                                 the seconds there's a dot and then the                                 six six digits microseconds so and I                                 should say all of that is also in the                                 documentation this is not like we just                                 tell it people all of the patterns are                                 listed and you can you can look at that                                 so more on access lock time stamps one                                 thing is if you have httpd as a reverse                                 proxy for instance in front of a tomcat                                 then by default httpd locks the request                                 begin time as the timestamp in the XS                                 lock Tomcat by default locks the end                                 time as the timestamp in the XS lock                                 yeah that's due to historic reasons for                                 the implementation nowadays you can                                 switch it for HTTP D and also for Tomcat                                 you can impose you can choose whether                                 you want to lock the beginning or the                                 end time you can also lock both if you                                 like to and for this there is a little                                 token you can add in front of the the                                 pattern that determines that you                                 actually want the end time to get locked                                 and not the begin time and it works very                                 similar into Tomcat world so more about                                 access lock not included by default but                                 I would very much hurt you to edit is                                 percent upper case D that's the request                                 duration in microseconds and it's not                                 that we do it's not expensive                                 you should always edit once you run into                                 problems it's so important to understand                                 what takes long which type of request is                                 it is it specific IP specific user agent                                 specific your eyes so please add percent                                 D to your to your access log lines                                 that's very important another token                                 that's very important is percent l                                 that's a correlation ID that's a unique                                 ID it changes every time it's printed                                 and whenever there's an error log line                                 written for a request the error log line                                 contains the same unique ID so it's easy                                 to correlate between the error log and                                 the access log if an error is written to                                 the error log you grab the correlation                                 ID you grab your access lock you get                                 exact                                 one hit and that's the request that had                                 the arrow yeah so but the correlation                                 idea is only filled if anything is gets                                 written to the error log so as long as                                 nothing gets written it's just an empty                                 position in the in the log file say                                 again please yes it's always unique it's                                 always unique and to improve you should                                 actually activate much unique ID then                                 the percent l is the unique ID generated                                 by mote unique ID it's not your ID okay                                 and if you like you can also add the                                 like the unix timestamp of the request                                 but with a microsecond resolution                                 because that's easier to do calculations                                 on than a formatted timestamp you know                                 if you'd like to do calculations on the                                 request begin times end times etc in a                                 numeric way and sometimes it's easier to                                 have the time since like this and you                                 can add multiple of those it's not that                                 you need to choose between a formatted                                 and numeric you can add all of them if                                 you like so some of my additional                                 favourites percent uppercase P and T IDP                                 that's the process ID and the thright                                 ide sometimes that's interesting how the                                 requests behave with respect to                                 distribution on processes or threads and                                 % k % x that's K is a number that's how                                 many keep alive requests have been done                                 on the current connection and the other                                 at the X is what's the connection what                                 will the web server do with the                                 connection next will it close it will it                                 keep it open it's just a single                                 character that indicates the connection                                 statures at the end of the request                                 number                                                             sometimes you want to correlate                                 something happening or some measurement                                 on your web server with a proxy back-end                                 that's behind the web server if you want                                 to correlate not only statistically but                                 instead on a per request basis then you                                 need to have some ID to match                                 you cannot just use the timestamp you                                 have thousands requests per second and                                 the timestamp is not working as a                                 correlation method so what we want to                                 have a correlation ID what we can easily                                 do is we should generate an ID and send                                 it to the backend so the question is how                                 to how do we generate a unique request                                 ID and there's already an old module in                                 there that does it it's not unique ID                                 you'll simply load it and then it                                 generates automatically a request ID and                                 the request ID is put into a environment                                 variable by mote unique ID automatically                                 that's this environment variable request                                 environment variable so if you want to                                 log it in the webserver just add it to                                 the XS log format percent                                 Francie's unique ID e that's yes it not                                 unique ID will create a unique ID for                                 every request that hits the Apache for                                 every request independent of whether                                 you've serve it from the disk or whether                                 you proxy it to somewhere yeah that's                                 the next step that's a next step next                                 next slide so this the first step is we                                 need a request ID we generate it like                                 this now what do we do locally we log it                                 and remember % L will then have the same                                 value the error log will also contain                                 this unique ID and how do we forward it                                 to the backend yeah                                 since we're typically talking HTTP and                                 an extensive is it is an extensible                                 protocol we can add a custom header we                                 just choose some conflict-free header                                 name like x request ID and then we use                                 mod headers to forward our request ID or                                 a unique request ID in this header to                                 the backend and as you can see not                                 request mod headers supports using                                 variables in the value string yeah so it                                 evaluates the string at runtime so ok so                                 now we already send it to the backend                                 what to do on the backend the next thing                                 is on the backend we can also add the                                 header to the access log if you have an                                 excess log here for instance if it's                                 another HTP or a tomcat or something                                 similar of that notation is sufficient                                 to add it to the XS log there but often                                 you want to have it in application log                                 files and for this I can only give you                                 hints typically M epic Asian logging                                 frameworks like log                                               concept called MDC map diagnostic                                 context this is like a hash map where                                 you can save values under a key at some                                 point in processing and then you can                                 edit to every lock line that's written                                 yeah and it's very easy to inject code                                 for instance in Java web applications                                 without changing the application itself                                 it's just a snippet that you can add as                                 an independent component that picks up                                 the request ID from the header and                                 copies it into this hash table of the                                 log framework that's all you need to do                                 and automatically it will show up in                                 every lock line of the application you                                 don't have to touch your application                                 code okay                                 number                                                              lines that's one thing I've found                                 helpful in some cases because sometimes                                 you want to count things happening and                                 you know it's always when the request is                                 coming from IP such-and-such and there                                 was no session and a you look like this                                 and then you start scripting and and                                 evaluating your log files funnily you                                 can also configure your web server to                                 log a line if such conditions are true                                 so it's much easier to evaluate the log                                 and what you do is first of all you need                                 to make sure that mod log debug is set                                 to lock level at least in                                                people run their web server with one                                 lock level and then all of the output of                                 matlock debug cannot be seen in the log                                 file because it locks on info log level                                 so make sure you have actually at least                                 info lock level activated and then this                                 is the trivial example if someone hits                                 the Uriah a honeypot we lock a specific                                 lock message that's the hello world                                 example but we can improve the example                                 first of all if you like to get more                                 information about the timing of the                                 processing in the web server we can                                 choose here at what time during                                 processing of the request the message                                 actually gets locked the web server                                 processes my requests in                                 hooks and you can choose the hook and                                 all means lock at every hook so you                                 won't get one message per honeypot                                 request but like                                                       hook once so then you can use variables                                 we replace our static lock line by a                                 dynamic lock line where we include the                                 IP of the client so like mod headers                                 this also allows to use variables in                                 this in the text so it's getting more                                 expressive and then we can do more                                 complex stuff like we use mod rewrite to                                 check whether the cookie header contains                                 some chase session ID and then we                                 capture the chase session ID and put it                                 in an environment variable so this mod                                 rewrite doesn't rewrite the request it's                                 only used for the side-effect                                 this means it matches everything don't                                 change it but set an environment                                 variable okay and now we include the                                 environment variable here and I use the                                 notation that I will explain in a minute                                 that again comes from the general                                 expression parser that Jim already note                                 mentioned and used several times so we                                 can get pretty creative here so what is                                 this notation request ends we have a                                 unified expression parser traditionally                                 we had some kind of expressions in the                                 config in several places like in rewrite                                 cond you could do expressions inside and                                 if in SSL require in a loud denied but                                 all of these expressions will handcraft                                 it and implement it in different ways                                 there were some analogies but you                                 couldn't rely on things working in one                                 directive to also work in other                                 directives for instance allowed in IE                                 you could always use net masks it was                                 important                                 describing networks not by regular                                 expressions but by net masks but it                                 wasn't working for instance in rewrite                                 rules                                 you had to rephrase your network                                 conditions as regular expressions that's                                 really ugly so we had the code for using                                 net masks                                 but it was strictly related to some                                 directives nowadays a universal                                 expression parser that's connected to                                 all of the directives where you can use                                 it so every thing every expression that                                 works in one place works in all places                                 so we put more energy into it so there's                                 far more expressions now then you can                                 then you can use then the sum of all the                                 expressions before every expression                                 feature works in all places and two nice                                 things sometimes people actually still                                 code extensions to the web server and                                 this expression parser has two api's                                 first of all if you need some very                                 specific function you can code that                                 function and tell the expression parser                                 to make it available so you define your                                 function name like my username and then                                 you derive the user name from some                                 header value in some internal way and                                 then you can use the function my user                                 name everywhere in the web server for                                 this you need to write a little bit of C                                 code but it's pretty easy this part so                                 you can extend the available functions                                 by yourself and the other thing is if                                 you're writing a module you can use                                 expressions by just calling the                                 expression parser so you can define your                                 own module directives that contain                                 expressions without needing to pass the                                 expressions it's all done by the                                 expression parser you just call it and                                 it tells you whether the result was true                                 or false for instance so the expression                                 parser has two modes the traditional                                 mode the first mode that was used was a                                 boolean mode so the return was always                                 always just true or false and you used                                 it as a condition in your configuration                                 nowadays there's more and more use of a                                 second mode namely it returns a string                                 like we had in mode lock debug where I                                 said please lock the value of this                                 environment variable it's a text that it                                 gets locked so there's two modes and the                                 syntax were eyes a little bit on whether                                 you want to get a boolean or a string                                 and finally the example we had this is                                 just saying take the request environment                                 variable named my var and                                 return the value of it as a string so                                 back to custom logging what we can also                                 do we can add a boolean expression which                                 triggers the logging so here I say do it                                 only if the request comes from this                                 network yeah and then I get this message                                 so number seven if with expressions this                                 is now the difference                                 for instance here I could also say this                                 is only done if this expression is true                                 but this means it's an extension to an                                 existing directive and it only is                                 connected to this specific directive                                 here I define a whole block of                                 configuration lines and all of these                                 configuration lines are only activated                                 if the expression is true and the                                 configuration lines do not need to know                                 anything about expressions yeah so this                                 is a whole block of expressions for                                 instance I say I have a location                                 internal if the request comes from this                                 network then I set options indexes then                                 I allow directory listings and else I                                 deny access something like this so there                                 is an if there is an else and there is                                 also an else if now of course these                                 directives here can only get effective                                 once we have the data for the expression                                 so often you need to have some data from                                 the request in the expression some                                 header line something like this that                                 means during the very early phases of                                 request processing we don't have that                                 available so all of the configuration                                 lines between the if blocks will not be                                 active during this very very early                                 phases because we the first need the                                 data to check the condition before we                                 can decide about the contents of the                                 block so some ideas about the abilities                                 of the expression parser you can check                                 whether something is in a list of words                                 you can do regular expression matching                                 also case independent you can do IP                                 matching string matching string case                                 case less matching                                 fine name matching so like lops you can                                 put header values request and response                                 header values environment variables you                                 can convert strings from uppercase to                                 lowercase percent-encoding md                                         there's lots of stuff you can use you                                 can directly use in your expressions and                                 it's growing so if expression is also                                 nice for debugging for instance we can                                 increase the lock level just when only                                 when the request comes from a specific                                 network yeah so that's that's very                                 helpful and and you can you can do other                                 things as well like looking for a                                 specific user H and/or some other values                                 or session IDs or whatever so then                                 something which is I'll have to look for                                 the time actually Oh lots of time                                 something that's not well known is named                                 Peck references when this was committed                                 I first learned about impact references                                 didn't know about it there is three                                 directives name with the name location                                 match files match and directory match                                 they're very similar to location                                 directory and file size sure most of you                                 will know these directives match                                 first of all indicates it's not about                                 just prefixes you can do any regular                                 expression match inside these directives                                 but they have an interesting side effect                                 sometimes in the block that's denoted by                                 a location match you want to use the                                 match that happened inside your                                 configuration directives and typically                                 in the mod rewrite style you would try                                 to use dollar one dollar two to back                                 reference something that's in another                                 line but that will not work because                                 there is no direct relation between                                 location match and what's inside but                                 there is a notation to do it how would                                 you do it regular expressions come with                                 the ability to give bracket groups names                                 so this question mark and then the                                 hmm lower than bigger than sign denote                                 the name I have chosen the name context                                 that's some name I have given and                                 whatever is matched here will be put                                 into a group named context by regular                                 expression mechanisms so what is it                                 that's matched here it's just the first                                 part segment yeah I have a slash and                                 then any character before the next slash                                 that's put into the group name context                                 and then I use this group inside here in                                 a totally different directive for                                 instance this says we require some LDAP                                 group so we make user checks wire held                                 up and we require some elder probe and                                 in the group name in the common name I                                 use the value of the context variable                                 here it's not a variable of the context                                 group and this is just by by definition                                 we put a named group into an environment                                 variable with the name match underscore                                 and then the uppercase of the group name                                 that's just by definition so if I would                                 have put here a path then it would have                                 been match path so that way you can use                                 any groups that you define in location                                 match directory match your files match                                 inside                                 I think it's for making it unambiguous                                 for instance assume you have rewrite                                 rules inside the block and then what                                 does dollar                                                             to the rewrite rule left side so dollar                                                                                                         close and if we have you would have used                                 it we would have run into conflicts with                                 other uses of of it but that but but                                 that would have been an argument to                                 change it in many more places we didn't                                 I think it was driven by reducing                                 conflicts I'd say no I would say no                                 marabous are not deleted yes yes it puts                                 it into the environment table I would be                                 surprised if it would be deleted at the                                 end but I'm not sure but I would be say                                 yes yes ok then something Jim also                                 mentioned it's not remote IP getting                                 declined IP address right this is                                 something that happens very frequently                                 and this is not about your web server                                 being a proxy this is about in front of                                 your web server being another proxy like                                 often nowadays load balancers are                                 running in a reverse proxy mode to save                                 connections so they hide the original                                 client IP address from your precious web                                 server and all you get in your excess                                 log is the IP address of the load                                 balancer that's not very fascinating                                 that's what you know but sometimes you                                 need to know the client IP address to                                 make analysis and correlations etc so                                 how do you get it and of course first of                                 all the system in front needs to pass it                                 in some way along to you now we're                                 talking HTTP it's extensible so there                                 should be a header which contains the                                 original IP address do we need to invent                                 something you know                                 actually which actually there is a more                                 or less than that header I will show in                                 a minute but first of all the idea of                                 multimode ID is it looks at some header                                 coming from the web server in front of                                 you and picks the the requests that I                                 declined IP from there and then it adds                                 it to several places where Apache uses                                 client IP addresses and what immediately                                 comes probably also to your mind is the                                 excess log where you log client IP                                 addresses and also if you do IP based                                 access checks require IP yeah where you                                 say only allow access if the client is                                 in some network yeah no no it's                                 it is about x                                                           the next slide                                 it is about x-forwarded-for I'll come to                                 that point in a second your question                                 your question right yeah                                 yes yes that depends on your                                 jurisdiction also it might depending on                                 on your jurisdiction logging is okay but                                 you need to get rid of it quickly enough                                 it's a question of on how long you keep                                 it for instance you can at least in                                 Germany currently it's considered                                 recurrent enough to drop the last byte                                 although we know that the last byte may                                 might not be enough but it's considered                                 to be state-of-the-art dropping the last                                 byte and then you can keep it for a                                 longer time but keeping it short time                                 should be okay but you need to decide of                                 course yeah and now what is this                                 x-forwarded-for so there is some semi                                 standard header called x-forwarded-for                                 most reverse proxy automatically said it                                 and even for instance if a pecch                                 itself is a reverse proxy it                                 automatically sets it so if the website                                 in front of you is an Apache it will                                 already set a header called                                 x-forwarded-for and include the client                                 IP address there and all of the reverse                                 other reverse proxies I know for                                 instance load balancers have very easy                                 ways to set that so if the admin people                                 there look at their knowledgebase                                 x-forwarded-for they immediately find a                                 recipe how to activate that so you can                                 use any header you like but mostly                                 x-forwarded-for gets used because it's                                 very easy to set it so typically you get                                 an X for it for header that already                                 contains the client IP address in                                 reality it can concur it can contain a                                 list of addresses because if you have a                                 chain of proxies in front of you                                 everyone might add another address there                                 so what do we do we have some security                                 implications headers can be set by any                                 client yeah you can you can easily set                                 an arbitrary HTTP header but we want to                                 use a header value to do IP based access                                 control or lock it in our access lock so                                 better it's the truth that's in there                                 and not something your user invented so                                 what's important is                                 that you only use this machinery if you                                 know that the proxy in front of you                                 overrides the header controls - Helen                                 does not just pass through the garbage                                 it gets that means for us to be on the                                 safe side we should only evaluate the                                 header if the request actually comes                                 from the proxy so that's what we need to                                 configure so we have a very simple                                 configuration this I command it out                                 because it's already the default value                                 just to show you you can use another                                 header as well yeah and this is which                                 header we look at and this here is a                                 list of IP addresses                                 from which the connection should come in                                 so that we actually activate this                                 procedure yeah if the request comes from                                 another peer we do not trust the value                                 the client IP that's taken from the list                                 is removed from the list okay and and                                 what I forgot to say but I had it on the                                 slide the right pattern in the XS log                                 format is % AE for address the default                                 access log format has a % h                                            of the client age means it writes the IP                                 address if no host name resolution is                                 active which is the default if host no                                 resolution would be active it would                                 write the name the resolve name of the                                 client but age doesn't have the remote                                 IP logic inside so a is the right                                 pattern to use it age only tries to                                 resolve but only if you activate                                 resolution not by default okay number                                    it's also a funny thing that I learned                                 when someone committed it SSL open SSL                                 command that's probably the most word                                 directive name that was created for                                 Apache the point is the SSL TLS world                                 has lots of options and whenever open                                 SSL or the Thiele standards create new                                 ways to influence what's happening                                 we need to create a new directive to                                 wire that to our configuration file yeah                                 and if you look at motifs SL it has a                                 long list of options to influence what's                                 happening but sometimes the things are                                 very simple it's like setting a binary                                 flag or or giving a file with some                                 content to tomate SSL so the same                                 problem was occurring for any                                 applications that were using SSL and an                                 open SSL as an implementation they all                                 had just the problem of constantly                                 creating new directives so finally the                                 open SSL team itself decided to help and                                 they created a generic configuration API                                 where they said just throw us a string                                 into this API we will pass it and know                                 what how to behave so we will have our                                 own configuration language yeah so the                                 consist there's a new configuration                                 language it's not any more apache                                 directive but the process whenever they                                 create something new and you use the                                 newest version you can already use the                                 configuration for this new stuff you                                 know so the up-to-date list of commands                                 that is available can be found under                                 this URL is just three ones because                                 every major version brings new stuff                                 with it and as an example this is the                                 directive and then this is the the name                                 of the configuration command these names                                 are listed in the OpenSSL documentation                                 they have a lift list of such names and                                 this is the value that we that we pass                                 over so the API is not just one string                                 it's a key value API and what does it do                                 in this specific case it disables                                 session tickets and enables preference                                 of the server configuration so actually                                 these two existed before SSL session                                 tickets off is a specific directive it                                 has nothing else than just this here it                                 was just created to switch the support                                 for session tickets off and serve a                                 preference parts of what it does is done                                 by SSL on                                 Seifer order on so you could say you                                 don't need it but you will need it for                                 newer features because I guess when the                                 demand occurs to create even more                                 directives for SSL we will have a look                                 on whether the open SSL API already                                 supports passing it away along in this                                 way and not implement every flag by                                 itself and for instance this one didn't                                 exist for a long time there was a patch                                 around for a long time until we actually                                 noticed and committed it okay                                 [Music]                                 bonus that's number                                                   have enough time and we do have the time                                 the bonus is there some support minor is                                 coming with the Apache like HT pass VD                                 or a rotate the passwd or rotate locks                                 and also these boundaries sometimes get                                 nice improvements and one of the nice                                 improvements in the HT passwd binary is                                 it supports bcrypt hashing nowadays so                                 if you still have your old crypt hashed                                 password files lying around in the                                 Apache web server think about                                 modernizing them there is some nice way                                 to get more security there and the other                                 thing is rotate locks got some features                                 like it also it has time and size based                                 rotation configuration and you can                                 combine them so you can say for instance                                 rotate every                                                       rotate daily so then at the end of the                                 day all of your log data will have been                                 rotated away but none of the of the                                 chunks will be bigger than                                              so you can combine these there's an                                 option to create a stable link like your                                 log file always has a timestamp behind                                 but in addition there is a hard link                                 without a time stem that always points                                 to the last log file that's something                                 that makes looking at the last log file                                 easier and there's optional post rotate                                 processing for instance you can define                                 that after rotation                                 processes fork that compress compresses                                 to the log file okay that's it we still                                 have time for a few questions yes yeah I                                 asked you organizers they said please                                 send it to us we will publish them but I                                 don't know where they will publish them                                 so in the meantime take this address and                                 I will send it to you I won't do                                 anything with your email address it's                                 just you have you haven't signed new                                 European needs so I can't do anything                                 with your email address so any more                                 question no so then thanks for listening                                 and have fun with the web server                                 [Applause]
YouTube URL: https://www.youtube.com/watch?v=MRx0PZilMBY


