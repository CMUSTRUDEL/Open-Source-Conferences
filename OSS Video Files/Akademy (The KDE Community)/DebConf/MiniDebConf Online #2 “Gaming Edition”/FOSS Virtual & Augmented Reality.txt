Title: FOSS Virtual & Augmented Reality
Publication date: 2020-11-24
Playlist: MiniDebConf Online #2 “Gaming Edition”
Description: 
	by Tim Jakob Bornecrantz

At: MiniDebConf Online #2 "Gaming Edition"
https://mdco2.mini.debconf.org/talks/2-foss-virtual-augmented-reality/

In this talk will cover Monado and Khronos' OpenXR standard, and give an overview about the current state of open source VR and what lies ahead. Also go into some details of how tracking is done inside of Monado and show of the current state.

VR took off for the consumer with the release of Oculus consumer hardware. But the hardware lacked open source drivers and Linux support in general. The consumer VR space has now grown from a kickstarter campaign into a large industry. But this growth has its down sides, multiple companies have their own APIs competing. Luckily these companies have agreed to work on a single API under the Khronos umbrella. Now that OpenXR has been released and and the Monado project has been getting more stable it is now possible to do good VR on a completely open stack.

Room: Main
Scheduled start: 2020-11-21 19:30:00
Captions: 
	                              hello everybody                               and welcome to the fourth virtual and                               augmented reality talk                               with team jacob barney krantz                               and jacob works for collaborate with                               graphics and virtual reality                               x air lead at labora and a member of the                               open xl working group                               he has worked with linux graphics since                                                                    starting with tungsten graphics and                                moving into being well                                in                                                                    the open hmv                                project then in the spring of                                     was involved in launching bot monado and                                open openedx here at                                gdc please welcome him                                thank you very much uh yeah as i said um                                as i said i'm jacob ponocrats and                                today um this is what i'm going to talk                                about i'm going to give a short                                introduction to what ar and vr is                                talk a little bit about openxr and                                then the monado project uh going in a                                little bit in                                onto technical details there and for                                those that are interested                                uh and some more status on                                monado and a little bit on open x as                                well and then wrap the whole thing up                                um yeah uh                                it reintroducing myself here uh first                                uh jacob warner krantz these are my                                contact links i will upload the                                pdf somewhere uh so you can get all of                                them links so you don't have to                                type them down or something with that                                and please after                                talk uh feel very feel very free to talk                                to me about                                all this stuff or just other stuff in                                general like xrvra or in general                                [Music]                                open source in general and also                                especially about joining calabra                                we are always looking for people to join                                even in these times                                so starting off what is a or and vr                                what is augmented reality um                                so you know a simple definition                                definition of the word                                augmented means make things greater or                                add                                to it so that's what ar is                                and this is like a ur case or a example                                of ar                                um where the hardware is                                daiquiri they had                                afforded they have gone under but they                                had a very cool product                                where you would put on these headsets um                                and a operator somewhere else in the                                world could call into the headset and                                you would                                see like he's seeing in this picture and                                the                                the face of the operator uh talking to                                him and                                they could all the operator could see                                what he was seeing                                and and you can also get some could also                                draw onto                                reality so if you see uh this little red                                circle here                                that is actually drawn by this guy in                                his in this guy's view                                so he's actually seeing it so one of the                                use cases there                                had a could have like you have this very                                complex machinery and there's like two                                guys in the world that could prepare it                                uh but you know you can call this guy                                and the guy that actually is on the                                scene could                                put on this headset and the guy crusades                                screw this bolt like                                this bolt and do not screw this bolt                                because then the whole thing                                blew up uh or something similar or like                                more you know sensible pull this hard                                disk                                don't pull this hard risk because then                                the server goes down or something like                                that                                so that's that's an actual uh work                                use case i would say for ar um                                but what we are more known uh                                you know this since this is a gaming                                 uh focused conference and we're more                                 more into games                                 and i think the most widespread                                 let's see commonly thought ar game                                 out there is pokemon go which is                                 a lot of people say you know that's not                                 really ar but it's                                 the you know most common ar game that                                 like everybody has actually used uh even                                 though it's very limited in in                                 arness uh of the world but that's still                                 in                                 as aor and what is virtual reality                                 uh i really like this quote uh i had                                 actually had to look it up                                 because i thought so first thought it                                 was something that adam savage says but                                 it's actually from                                 a movie called dungeon master um                                 and that's adam sandwich very famous                                 quote i react reality and substitute is                                 my own                                 and that's basically what virtual                                 reality so you                                 completely replace the reality around                                 you with                                 something else and and again the most                                 common use case here                                 that most people have run into is games                                 and this is job simulator                                 but if you're looking at the absolute                                 strict definition of                                 ar or vr and this is also vr                                 even though it's not as immersive it's                                 still completely replacing the reality                                 with something else or you know a                                 generated reality so even doom                                 back in                                                was actually vr even though                                 that's not how it's you know vr is used                                 anymore                                 so that was quick about                                 what a or in vr is um                                 so i'm going to talk about a little bit                                 about                                 vedicsr so how do we do                                 vr or ar or xr as they                                 both commonly known together and                                 you have your program you have a sort of                                 a                                 software platform that sits in between                                 and you then you have your hardware that                                 um you know you that platform talk to so                                 you have your drivers you have                                 all that stuff uh an example of                                 platforms or oculus quest or steamvr                                 and you know between the program and the                                 platform there's an api                                 and in the past there was a lot of                                 different apis                                 and all if you wanted to write your game                                 or                                 your or even on webxr or something like                                 that                                 you know the browsers or the games or                                 the applications had to support                                 all of these uh apks if they all of                                 these different apis if they wanted to                                 support                                 lots of hardware which just resulted in                                 people that is supporting us one or two                                 and a lot of you know platforms didn't                                 get                                 as widespread usage support as they                                 could have                                 so the solution to this is uh creating a                                 new api                                 not like the xcd comic                                 um uh where you know                                 we have openxr where there's one unified                                 application interface that all of these                                 platforms                                 um provide and you can write portable                                 applications                                 that can now support multiple hardware                                 and participation in this openxr                                 there's a lot of companies and so                                 there's actually                                 all of the important planes over there                                 uh yeah it's like even you know blender                                 uh                                 blender and uh where are we                                 yeah so                                 so what is cool about openxr                                 it's just like opengl and vulcan it's                                 made by chronos                                 it is out now you can actually use it um                                 it's action based and that's a different                                 interpretation of                                 how to do inputs and i will go a little                                 bit into that and there are four sort of                                 implementations                                 which i will talk about a little bit                                 later um but                                 yeah the the key important piece here is                                 that anybody can implement it                                 and in just like opengl and vulcan it                                 allows applications to be portable                                 so what does uh action based mean                                 in this um for the api                                 so a lot of in the past i you would                                 you know look on a controller like                                 the is the user pressing the a button or                                 is the user pressing the b button or you                                 know pressing forward or moving forward                                 or you know angling there you're                                 sticking certain ways                                 and those inputs will be in                                 very tight to the type of controller                                 because of that and                                 so instead of and that makes it hard to                                 add new                                 type of controllers or you know which                                 resulted in                                 in the past that basically every                                 controller now looks like the                                 xbox controller because that's the                                 controller that most                                 games were written for um but instead if                                 you                                 think of inputs as                                 actions so you would um                                 an application would create an action                                 saying teleport or fire a gun                                 and then just say maybe you can use the                                 a button for this or maybe you can use                                 the b button for this                                 and this up to you                                 you have a lot more greater flexibility                                 in remapping inputs                                 and also a lot greater flexibility                                 of contextually changing the mappings so                                 say if you have                                 a disability uh where you can't really                                 where depending on what you're doing in                                 the application you might not want to                                 press                                 the a button in the same way and with                                 actions                                 the applications say now i'm doing these                                 actions                                 like i'm firing you know holding a gun                                 uh but if                                 you don't change your weapons to say a                                 sword they can now                                 the game cannot say i'm not holding a                                 sword and you can then remap the                                 actions two different inputs                                 for allow for a lot a lot better                                 both for new hardware no hardware and                                 for                                 allowing more accessibility options                                 so and i think that's a really good                                 thing                                 yeah so i'm going to talk about monado                                 and deep dive there                                 and this is the fast implementation part                                 of                                 open xr that i had on the slide before                                 so aga so going back again so how do we                                 do xr                                 we you have your program you have a                                 platform and you have your hardware                                 and monado is a platform um                                 yeah so it's a collection of drivers and                                 software that allows you to run a xr                                 application                                 basically up to your application on your                                 computer or on                                 specific hardware                                 so diving in a little bit in uh into                                 monado uh splitting up all of the                                 components                                 into fairly um broad terms                                 as you might say you have the open exo                                 state tracker                                 that sits on top and that takes care of                                 the                                 all of this state and all of the                                 application interactions with the                                 hardware                                 and abstracts away and simplifies them                                 and also do all of the error checking                                 and all that stuff that's needed                                 on behalf of yeah on behalf of the                                 drivers                                 and then it calls down into monado                                 itself the hardware drivers                                 the v compositor and                                 the platform code                                 but yeah that picture that i showed                                 before is                                 simplified as i said and even this                                 picture is kind of simplified but                                 you can see that the drivers need to                                 talk to the platform code that you know                                 that                                 exactly the way they operate since then                                 there are various levels of compositors                                 so we need to be able to support both                                 opengl and vulkan                                 graphics api and the compositor is                                 basically graphics                                 graphics api dependent so those                                 interfaces are different there um                                 yeah and the compositor just needs to                                 talk to the                                 drivers in order to know how to do the                                 hardware distortion on                                 the hmds and there's a whole bunch of                                 auxiliary code here on the side of the                                 drivers and                                 all of the other parts talk to                                 and stuff like that so                                 analyzing it a little bit more on a                                 little bit different site                                 you can see that there the these are the                                 interfaces                                 and that there are certain interfaces in                                 the stack so                                 you have your open xr here you have the                                 prober which we kind of a misnamed but                                 it's called that                                 and you that mostly probes for devices                                 and that talks through the various                                 platform codes you have your                                 xrt device which is a device and                                 that the drivers implement you have the                                 xrt uh compositor which                                 i introduce the compositors and talk to                                 both hardware via vulcan and opengl                                 uh and also you know the online system                                 so it you know talks to x or railand in                                 order to get access to                                 the display display system                                 there's also adding more complexity to                                 this                                 there's also an ipc layer that we insert                                 between all of this                                 so you can run multiple applications                                 and so you run the composite in one                                 process and then                                 connect to it via the ipc layer                                 and there basically just in implements                                 the same interfaces as the system                                 underneath so it's sort of like                                 invisible                                 to the open access state tracker that                                 sits on top of it                                 so it's just a sort of layer basically                                 and what was all this xrt i kept talking                                 about and                                 in monado we have the xrt interface or                                 the monolith interfaces                                 so those are the you know all of these                                 xrt devices the                                 things that sits between the different                                 components                                 it's purely c is not stable                                 and this is if you ever seen a talk                                 about mesa talking about the gallium                                 interfaces                                 is basically the same thing but for xor                                 its                                 design is heavily drawn from                                 gallium and as i                                 came from tungsten graphics and i was                                 sliding                                 on had a little bit of a hand in the                                 gallium interfaces as well so                                 yeah um i drew we drew a lot of                                 inspiration from that and i just in                                 general                                 mindset about it and again it's                                 not stable by design because our                                 understanding of hardware                                 will change as we go along like                                 i never claimed to know everything about                                 xr hardware                                 in the past and i'm not doing claiming                                 that now and                                 we you know we cannot still we cannot                                 predict the future                                 so we need to be able to change the                                 interfaces as we go along                                 but but luckily we have the open xr                                 interface that sits on top                                 that is stable and so application                                 doesn't you know have to rewrite                                 every five months or so                                 so i'm deep timing a little bit more                                 into all of these various interfaces                                 just to give some more meat on the bone                                 we have the xrt device which is                                 basically the most central thing because                                 this                                 is the thing that's the extra hardware                                 you have hmds you have controllers                                 uh it uses some more exp aspect patterns                                 instead of regular um                                 uh inheritance model like you would                                 expect from                                 java so you can sort of uh an                                 uh hmd or like a device can be an agency                                 and also have                                 inputs it could have hand trackings and                                 being hmd and it doesn't have to have                                 any hmd so there's no                                 they just have different aspects that                                 they can implement                                 there's various functions which allow                                 you to in synchronize the input                                 get the input uh set output so when you                                 can vibrate your controller                                 you can retrieve retrieve the positional                                 tracking                                 and we also just recently added hand                                 tracking so you can get that from the                                 device and you also have like a                                 fixed set of                                 information about the hardware so you                                 can get the screen position this                                 distortion                                 what origin it is in the tracking system                                 or the yeah there you can have various                                 tracking system                                 uh all combined so this is also an                                 information that's there                                 there we have the compositors not to be                                 if you're coming from like an accent uh                                 wayland uh                                 world it there's a lot of things called                                 compositors nowadays                                 um but it really only                                 it does the same thing but it's not all                                 also                                 yeah not designed to be uh                                 user implementable in a way uh it's                                 more of a i have all of the i have this                                 hardware and this hardware looks                                 differently and having to add support                                 for all of these various                                 weird hardware and uh is really hard so                                 we actually need to                                 push some of the compositing into                                 the hardware                                 and you have a base class and then                                 the various classes for                                 [Music]                                 the different types of apis and fd                                 so you have yield your vulcan and you                                 also have ft which is                                 the uh basically dma buff                                 or how to just draw buffer                                 going over yeah                                 and as we said the aft compositor is the                                 real compositor                                 there's also swap chains which                                 correlates basically want one to this                                 option such as in the open xr api                                 it has more functions it's more explicit                                 again because the open xr state tracker                                 that sits above this take care of                                 any implicit states and turn them into                                 explicit states or call function calls                                 which makes it easier to                                 call implemented compositor and we push                                 all the complexity up into the                                 state and the state tracker that sits                                 between all of these you know                                 the the important code and the                                 application                                 then we have the prober um                                 and it's the thing that actually                                 is sort of become where we dump all of                                 the                                 functionality does not really fits into                                 all any other buckets                                 so it holds the policy um it device                                 the probes or the devices that are on                                 the system                                 uh i also abstract away some of the                                 uh os things on how to talk to                                 uh hardware and we probably should split                                 it into                                 two parts we've been thinking about that                                 for a while                                 so i solar status on monaro                                 and a little bit on open xr                                 recent developments um we are passing                                 the                                 open xr conformance test suit we are not                                 conformant because that requires us to                                 um you know pay the conformance fee                                 uh but luckily the open xr performance                                 test with these open source and                                 radio available um we have packages in                                 debian for monado                                 and unfortunately heavy development                                 so like even after a week it's kind of                                 out of date                                 we do build                                 [Music]                                 debian packages on the ci so you can                                 point directly at the ci and download                                 the packages there                                 we have sixth of tracking with the lib                                 survive project                                 and we have a initial port to android of                                 monado                                 so you can run monado on                                 on android which is cool we can do                                 multiple clients                                 and we have also added more drivers as                                 we have gone along                                 sorry about all of them okay                                 yeah um                                 yeah so this is the current list of                                 hardware that we support we support                                 android hardware now it's basically of                                 the imu in the                                 uh in the in your phone and                                 the distortion parameters from cardboard                                 uh we have a                                 arduino driver which is sort of there as                                 a                                 example of how to create your own                                 hardware                                 um with andrino and there's also support                                 for the dietrich controller we have                                 support for the osvr hdk vive vipro                                 index and as i said we are positional                                 tracking through leap survive                                 we support the northstar headset which                                 is a really cool ar                                 headset that's completely made by the                                 community so it's all open source                                 very good fit we have support for the                                 playstation vr                                 and the playstation move we have six                                 staff tracking there                                 it's a little bit tricky to set up but                                 and you can actually get six of tracking                                 with all these we have support for the                                 really old racer hydra                                 and we do have a wraparound open hmd so                                 we have support for                                 those drivers as well that's on there in                                 there                                 there also some other drivers we have a                                 dumber driver that                                 you know allows you to just test it even                                 without                                 asking to test monado without any                                 hardware at all                                 we have a simulator driver as well which                                 allows you to                                 connect into it and manually manipulate                                 the values to                                 just simulate a order                                 and drama drive is supposed to be as                                 simple as possible                                 which is why we have a similar driver                                 there as well because it's                                 slightly more complex uh                                 so you can look at the drama driver of                                 how to do a driver or how do we just                                 start doing a driver where the assume                                 that they were simulated driver would                                 sort of get in the way of that or all                                 this crazy stuff then it does                                 some codes status you can see                                 monado uh the code that we have written                                 from one auto is around                                                                                                                                                            you can see that's fairly small to the                                 rest of the stuff                                 in that's in monado uh you you know they                                 have the state trackers which                                 both is the open excess state tracker                                 and the prober the                                 there's some debug ui as well in there                                 and the compositor                                 and there's a whole bunch of axle                                 recover that that that's there to                                 make it easy to fight drivers we have                                 the ipc layers                                 and if you're wondering why these are um                                 struck strikethrough numbers before them                                 those are i sort of have kept this code                                 page along for my various talks                                 and i keep keep updating them so i think                                 the first number is somewhere                                 [Music]                                 yeah last year uh and i think the second                                 number is in february this year                                 uh so and the rpc layer is new                                 so it doesn't have more numbers you can                                 see that the vibe driver has                                 drawn a fair bit uh and that's because                                 we have added support for the index                                 controllers                                 the index um we have hand tracking why                                 the index controller is there as well so                                 that's all of that code that's there                                 and um now a little bit about open xr                                 so apps and engines are starting to                                 support open xr which is good                                 the kudo has a open xr plugin that was                                 made by                                 christophe hogg a colleague of mine                                 calabro lover i had a support                                 for this and upstreamed so that's a                                 lua game engine development system                                 um and there's support in                                 unreal and unity has said that they will                                 support them as well                                 so support is getting there soon                                 so our next stop for monado                                 we want to improve the ps move tracking                                 a little bit more uh                                 there's things that we can prove there                                 we also want to make a native lighthouse                                 tracking inside of monado um                                 i sort of get take the pieces that we                                 need and                                 so we don't have to yeah so we can get                                 a much better support in there                                 we want excellent north star support so                                 we want to make                                 northstar be really well supported in                                 monado so                                 just because it's an open source project                                 and you know we want to                                 support open source uh brothering and                                 finish the android port and also finish                                 the windows port which might not be so                                 interesting for you but                                 it will allow people to                                 use monaro everywhere basically                                 even further out we are thinking on like                                 system ui setup ui                                 aor and slam and those are things like                                 you know basically if you haven't used                                 steam and the steam vr interfaces we                                 we need for monado as well um                                 we will probably just make a very simple                                 one for                                 ourselves for monado and                                 instead provide                                 libraries to do the things so gnome and                                 kde can make their own system uis                                 for monado and so you can have you can                                 match the theme of the system you are                                 with your desktop                                 to wrap up a little bit here                                 um yeah uh we are hoping to build a                                 force xr                                 a open source community around monado                                 but not just monotone                                 even like those are and all those things                                 um you are definitely welcome to join                                 the various channels of                                 where you can research um from ronaldo                                 as well                                 we want to make give we want to make                                 sure that                                 open source is part of the coming aor                                 revolution                                 uh you know at any moment now um                                 and this is why collaborate has spent a                                 lot of time and                                 effort into making sure that monado is                                 there and that there                                 are open source alternatives to                                 um all of these through er technologies                                 so that                                 you know we don't end up in of all                                 garden again like                                 ios and android                                 and a whole bunch of links for                                 people to follow yeah you                                 don't need to type this down i will make                                 sure that the pdf is available through                                 download                                 so that's it for me                                 again feel free to talk to me about                                 these things                                 and if you have any questions please                                 feel free to ask                                 okay let's go to the first questions                                 are there any flaws vr ar                                 games using monado or open x                                 r yet                                 yes let's see                                 there's a port of the morrow wind                                 engine i have to let's see                                 uh the dark mode vr and open morrow wind                                 are two that has been ported to open xr                                 and can be run                                 on uh monado                                 so                                 and there's support in the godot engine                                 so if you                                 if one as people make the                                 vr games with that engine thing we'll be                                 able to support open xr and monado with                                 that                                 great what is the minimal hardware to                                 try open xr on                                 apps sorry                                 what's the                                 uh what is a minimal hardware to try                                 open xr                                 and apps um                                 so you can run monado without                                 any hardware at all we have the you know                                 the simulator and the dummy driver                                 but you can't really do much then um                                 [Music]                                 yeah there's                                 yeah um                                 that's a hard question what the minimal                                 is uh                                 i think right now the                                 [Music]                                 best supporter to get give you a best                                 a reusable system would be a vive or                                 index which is not very minimal                                 unfortunately                                 um yeah                                 okay um what is the relationship                                 with open xr and web xr layer                                 um so web xr is                                 um sort of a different a                                 um a                                 different standard and they were sort of                                 made at the same time but                                 at different sites uh webex are runs on                                 top of open xr so chrome implements                                 its webex layer with open xr um                                 yeah so in the simplest turn web xr runs                                 on top of open xr                                 [Music]                                 um                                 so yeah                                 can you list classes of accessories that                                 could be part                                 to open xr sure um                                 there's a whole bunch of them um                                 in a sense                                 as we expand the open xr api and this is                                 talking very high level                                 you know we would track more and more of                                 the human body and more and more of the                                 world                                 so any accessory that allows you to                                 track say your hand your                                 your face or you know anything like                                 anything that can                                 track and generate uh                                 input so like in the future you you know                                 you can track your whole                                 body you can track your hands                                 and stuff like that so like                                 it's so basically anything can be an                                 accessory in in that sense                                 but like in short term a controller                                 um we're hoping at some point to have                                 good keyboard inputs                                 but yeah like trackers for your body is                                 basically                                 i think the next steps and also                                 trackers for the world                                 okay headsets like the oculus                                 rift require expensive pc hardware for                                 nice graphical quality                                 but that aside can someone get into pc                                 based                                 vr and xr for less than                                                                                           is a north star project going to be good                                 for that end                                 and are there any other options on the                                 horizon                                 um                                     is hard or                                                        probably your best friend if that's what                                 you're looking for                                 so you can probably get vinamar headsets                                 and such                                 used for that around there and                                 the northstar will hopefully be good for                                 that                                 it's quite it's still a bit expensive                                 and                                 even if you just buy the parts and                                    print other things you know                                 it takes a lot of time and effort to do                                 so i don't think                                 it will be it's yeah it's hard to get                                 get under                                     um just because of the screens and                                 lenses and all of that stuff um                                 there are uh and and you know                                 you're starting to get in do you into                                 territories where you skip sixth off                                 tracking and                                 is that really a good                                 quality uh good quality experience                                 uh for users then and                                 which is yeah so but                                 the north star is good because it can                                 it's will hopefully                                 lower their barrier entry but at least                                 but it also allows us to                                 actually be in the game so we can                                 actually                                 using open source only open source                                 methods                                 uh experiment with open ar or                                 open xr or ar in general um                                 but yeah it's it's a bit expensive uh                                 and the hardware that is cheap is                                 you know not the best and you also                                 unfortunately need like a computer                                 on top of that um so                                 yeah looking up like used windermore                                 headsets like the                                 first generation well crappy they still                                 work and hopefully yet sometime next                                 year we will actually have                                 support for them in minor as well not                                 just three dot by axilla six stuff                                 okay the next one is display audio                                 the only output or are there other                                 actuators to target other                                 sensors like vibration or smell                                 yeah and currently in the open xr api                                 you only have                                 display and vibration so you have like                                 um                                 vibrations in the controllers um                                 but there's definitely room to add more                                 uh like there's uh                                 there's not an open extra yet but                                 tactile feedback so you can have special                                 gloves that                                 you know you can feel the stuff they're                                 touching um touching or                                 getting or feeling like you're actually                                 holding something in your hand like a                                 gun                                 or something you're feeling the recoil                                 there you know                                 there's a lot of research and                                 development going on                                 all around xr in general but right now                                 in open xr                                 vibrations sound and display is                                 basically the only thing                                 there but you can extend open xr with                                 extensions so you can add support for                                 more                                 well okay let's wait if someone else                                 yeah there's things like a lot more                                 questions yeah then there's like                                 feedback                                 i've seen people have vests with                                 various engine uh various vibrations and                                 stuff like that so you can feel like                                 you're getting                                 heat shot and stuff like that so there's                                 a whole bunch of stuff                                 to add more add more reality                                 it                                 okay we have                                 what someone was writing let's see if we                                 have another question before                                 okay it seems this is everything okay                                 thanks a lot thank you thank you for                                 having me                                 and have a pleasant even                                 yeah have a nice evening
YouTube URL: https://www.youtube.com/watch?v=WccNsxBqPds


