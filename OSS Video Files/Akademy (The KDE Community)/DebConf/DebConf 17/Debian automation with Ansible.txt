Title: Debian automation with Ansible
Publication date: 2017-12-06
Playlist: DebConf 17
Description: 
	by Gregory Colpart
by Jeremy Lecour

At: DebConf17
https://debconf17.debconf.org/
Room: Buzz
Scheduled start: 2017-08-08 15:30:00
Captions: 
	00:00:05,009 --> 00:00:14,320
hi everybody Jamie and I work at every

00:00:09,219 --> 00:00:17,770
is a seasoned company since 2004 we

00:00:14,320 --> 00:00:21,359
provide Austin and mostly networking

00:00:17,770 --> 00:00:25,119
system administration 24 hours a day

00:00:21,359 --> 00:00:31,320
today we manage about 700 billion server

00:00:25,119 --> 00:00:34,390
for several customers let's cover

00:00:31,320 --> 00:00:38,140
confirmation by important the developer

00:00:34,390 --> 00:00:43,930
what of you the main question is how to

00:00:38,140 --> 00:00:48,129
are smooth equates so there are several

00:00:43,930 --> 00:00:53,410
ways to under of advice the simplest way

00:00:48,129 --> 00:00:58,179
is typically come fire from the veteran

00:00:53,410 --> 00:01:00,600
see typically confine our best effort of

00:00:58,179 --> 00:01:04,030
figuration as you know probably

00:01:00,600 --> 00:01:07,960
typically unders confide when they are

00:01:04,030 --> 00:01:11,920
embedded in the package Deepika she

00:01:07,960 --> 00:01:14,829
keeps track of amplified checksum for

00:01:11,920 --> 00:01:19,270
our original or fight mechanism with

00:01:14,829 --> 00:01:23,170
typically - yes if the profile is

00:01:19,270 --> 00:01:25,780
modified even a single character during

00:01:23,170 --> 00:01:31,210
that way you have to choose to keep the

00:01:25,780 --> 00:01:35,140
outside or and start a new one just for

00:01:31,210 --> 00:01:40,570
the record i motion sickness you can use

00:01:35,140 --> 00:01:46,030
siblings from /dt see from such dtc to

00:01:40,570 --> 00:01:50,049
face in /usr of such directories but

00:01:46,030 --> 00:01:52,130
very few materials is weighted more

00:01:50,049 --> 00:01:55,969
passive way is using

00:01:52,130 --> 00:02:00,229
man no space you can general generate a

00:01:55,969 --> 00:02:04,460
file with postal personal script during

00:02:00,229 --> 00:02:09,140
for system of your package then you can

00:02:04,460 --> 00:02:13,099
include genomic value like a snail for

00:02:09,140 --> 00:02:19,750
example with common host name and as

00:02:13,099 --> 00:02:26,569
question ways will know the problem and

00:02:19,750 --> 00:02:30,110
why not use UCF UCF stands for a date

00:02:26,569 --> 00:02:33,680
Africa and figuration file it's a tool

00:02:30,110 --> 00:02:35,140
for preserving uses use of change in

00:02:33,680 --> 00:02:39,280
config file

00:02:35,140 --> 00:02:42,880
it uses three webinars

00:02:39,280 --> 00:02:45,489
then he tracks the original content and

00:02:42,880 --> 00:02:48,410
come back if needed

00:02:45,489 --> 00:02:52,640
it's even compatible with the prom

00:02:48,410 --> 00:02:59,750
question for example Samba package use

00:02:52,640 --> 00:03:03,519
UCF and DEF CON which is great here is

00:02:59,750 --> 00:03:08,150
the natural choice with UCF in action

00:03:03,519 --> 00:03:14,030
take route to the option 6 3 way of

00:03:08,150 --> 00:03:16,239
match UCF use this recommen of course

00:03:14,030 --> 00:03:19,090
rather you can add effect during man

00:03:16,239 --> 00:03:23,989
that's why is option is only available

00:03:19,090 --> 00:03:29,989
in interactive one suddenly I don't know

00:03:23,989 --> 00:03:35,600
why but only about 200 packages use UCF

00:03:29,989 --> 00:03:41,750
in stretch you know why please I want it

00:03:35,600 --> 00:03:44,450
back then of course all these techniques

00:03:41,750 --> 00:03:48,709
are not enough for system in common

00:03:44,450 --> 00:03:51,140
needs for example you want to detect how

00:03:48,709 --> 00:03:57,260
much memory you are on you

00:03:51,140 --> 00:04:01,220
and 50% of it to Miami Bay principal you

00:03:57,260 --> 00:04:06,440
want to add or remove UNIX user and then

00:04:01,220 --> 00:04:09,320
change other user in sshd in fee of Stu

00:04:06,440 --> 00:04:13,190
configuration you want to add virtual

00:04:09,320 --> 00:04:16,430
Austin you're favoring HTTP server every

00:04:13,190 --> 00:04:19,820
day or sometimes you want to

00:04:16,430 --> 00:04:24,950
enable/disable a began in load balancer

00:04:19,820 --> 00:04:38,260
configuration then for all that needs we

00:04:24,950 --> 00:04:43,130
need management tools to automate some

00:04:38,260 --> 00:04:46,430
critical or repetitive tasks then for

00:04:43,130 --> 00:04:48,890
battle you will be posting many of our X

00:04:46,430 --> 00:04:53,330
element and speaks to on simple tables

00:04:48,890 --> 00:04:56,870
and now for the love we share with you

00:04:53,330 --> 00:05:02,930
our experience and help you I even and

00:04:56,870 --> 00:05:04,910
feedback loop wire to make automation

00:05:02,930 --> 00:05:09,169
tools an interval of fractions lately

00:05:04,910 --> 00:05:13,520
the Greek community reliability and

00:05:09,169 --> 00:05:16,820
speed to self management because they

00:05:13,520 --> 00:05:20,300
focus on the state of the server instead

00:05:16,820 --> 00:05:24,710
of a series of commands but it's true

00:05:20,300 --> 00:05:29,270
for all automation platforms so why did

00:05:24,710 --> 00:05:31,760
we choose on civil and why waiting it's

00:05:29,270 --> 00:05:36,050
a figuration management and deployment

00:05:31,760 --> 00:05:38,750
automation to Sawadee we set up with

00:05:36,050 --> 00:05:40,760
uncivil instead of chef or puppet for

00:05:38,750 --> 00:05:45,380
example because it's simple

00:05:40,760 --> 00:05:47,479
yes support it is patient less meaning

00:05:45,380 --> 00:05:50,960
that there is no on simple components

00:05:47,479 --> 00:05:51,870
that stay on the server it only requires

00:05:50,960 --> 00:05:55,830
an insane

00:05:51,870 --> 00:06:01,140
addiction and - it doesn't cost you to

00:05:55,830 --> 00:06:03,630
organize any see parents model it can be

00:06:01,140 --> 00:06:06,300
added afterwards used as much or as

00:06:03,630 --> 00:06:09,900
little as you want and you can remove it

00:06:06,300 --> 00:06:15,270
if you don't like the techno and very

00:06:09,900 --> 00:06:19,350
much is variables 14 to continue yeah

00:06:15,270 --> 00:06:22,470
and uncivil are pretty good friends we

00:06:19,350 --> 00:06:25,800
are Debian packages seen since we see

00:06:22,470 --> 00:06:30,720
backwards on stretch we are considered

00:06:25,800 --> 00:06:34,260
2.2 and soon and simple 2.3 and

00:06:30,720 --> 00:06:42,150
sentenced at all thanks to an apartment

00:06:34,260 --> 00:06:43,830
now Harley here thanks guys so we like

00:06:42,150 --> 00:06:44,220
like many and a lot that's why we're

00:06:43,830 --> 00:06:47,130
here

00:06:44,220 --> 00:06:51,660
and we form the majority of our servers

00:06:47,130 --> 00:06:54,570
and we build on top of it it's not

00:06:51,660 --> 00:06:58,800
surprised between sterile packages with

00:06:54,570 --> 00:07:01,860
reducers for meaning from Tim Meadows we

00:06:58,800 --> 00:07:05,370
apply security policies on performance

00:07:01,860 --> 00:07:08,400
tunings and most importantly we

00:07:05,370 --> 00:07:12,270
customize a lot of services for money

00:07:08,400 --> 00:07:17,340
with good practices very good practices

00:07:12,270 --> 00:07:20,340
in our context we are written more than

00:07:17,340 --> 00:07:23,010
50 rolls for one cigar rolling is a kind

00:07:20,340 --> 00:07:26,250
of package they are all publicly

00:07:23,010 --> 00:07:31,550
available on our repository and with

00:07:26,250 --> 00:07:33,979
them we can excel all our servers and

00:07:31,550 --> 00:07:36,800
very common wrong value favorite

00:07:33,979 --> 00:07:41,660
defaults for us but also many many

00:07:36,800 --> 00:07:44,060
versions for consecration we also have

00:07:41,660 --> 00:07:47,870
an admission goal its to be able to

00:07:44,060 --> 00:07:49,849
install all another hundred percent

00:07:47,870 --> 00:07:53,289
efficiency below but then for the

00:07:49,849 --> 00:07:56,270
management's we can go either way

00:07:53,289 --> 00:08:00,020
continue to maintain the sovereign limit

00:07:56,270 --> 00:08:03,349
on civil or harem and hybrid approach

00:08:00,020 --> 00:08:07,389
with manual interventions and uncivil

00:08:03,349 --> 00:08:10,460
driven operators that gives us many and

00:08:07,389 --> 00:08:12,560
quite difficult from space and we have

00:08:10,460 --> 00:08:23,060
to be extra careful in the way we manage

00:08:12,560 --> 00:08:25,610
our configuration is configuration some

00:08:23,060 --> 00:08:27,530
some services can include files within

00:08:25,610 --> 00:08:30,409
config files that's what we call in

00:08:27,530 --> 00:08:32,870
truth there are many variations on the

00:08:30,409 --> 00:08:35,599
implementation but the idea is you can

00:08:32,870 --> 00:08:39,200
extract fragments of configuration put

00:08:35,599 --> 00:08:43,459
them into external vise and then include

00:08:39,200 --> 00:08:45,649
them back in your main config and you

00:08:43,459 --> 00:08:48,230
can push the ID the ID a little bit

00:08:45,649 --> 00:08:52,240
further with automatic inclusion of all

00:08:48,230 --> 00:08:56,029
files from a specific path like

00:08:52,240 --> 00:09:01,370
directory record and that's what we help

00:08:56,029 --> 00:09:04,279
keep original 516 Apache as you can see

00:09:01,370 --> 00:09:07,550
you probably know is using this very

00:09:04,279 --> 00:09:11,260
extensively for modules we are fellows

00:09:07,550 --> 00:09:13,520
and also also configuration sections and

00:09:11,260 --> 00:09:16,940
with packages that use this approach

00:09:13,520 --> 00:09:19,220
like maybe in a much simpler way we are

00:09:16,940 --> 00:09:21,230
have some for customizing the

00:09:19,220 --> 00:09:25,660
configuration without touching the

00:09:21,230 --> 00:09:29,180
original files we are adding new face

00:09:25,660 --> 00:09:32,360
the first one is called abolish - false

00:09:29,180 --> 00:09:34,080
and it contains all our default settings

00:09:32,360 --> 00:09:39,209
by default we

00:09:34,080 --> 00:09:42,300
what we think is the best for the vast

00:09:39,209 --> 00:09:45,990
majority of of the worst and this file

00:09:42,300 --> 00:09:49,260
will always be created or overwritten by

00:09:45,990 --> 00:09:52,800
ansible that's why we can we are able to

00:09:49,260 --> 00:09:57,269
change the defaults later with no film

00:09:52,800 --> 00:10:00,990
that we mess with the operating rights

00:09:57,269 --> 00:10:04,680
after that the second file reason is

00:10:00,990 --> 00:10:06,740
every X - defaults and at the beginning

00:10:04,680 --> 00:10:10,649
it's just a placeholder it contains only

00:10:06,740 --> 00:10:17,279
comments or explanations for how to do

00:10:10,649 --> 00:10:19,410
them and this right has several set by

00:10:17,279 --> 00:10:22,500
encircle so we can set it up with man

00:10:19,410 --> 00:10:25,800
many of the uncivilized the legging is

00:10:22,500 --> 00:10:28,110
very important for this for this action

00:10:25,800 --> 00:10:29,550
because it enforces the road water and

00:10:28,110 --> 00:10:36,029
presidents and it provides

00:10:29,550 --> 00:10:39,450
responsibility of each fiber and we try

00:10:36,029 --> 00:10:41,160
to apply this we try to replace this

00:10:39,450 --> 00:10:48,060
button whenever we can but it's not

00:10:41,160 --> 00:10:51,089
always completely possible then for

00:10:48,060 --> 00:10:55,079
Debian package we have packages that was

00:10:51,089 --> 00:10:58,709
a joke very well they encouraging the

00:10:55,079 --> 00:11:02,040
use of overrides and includes I will

00:10:58,709 --> 00:11:05,640
give you some example fail to ban is

00:11:02,040 --> 00:11:07,320
explicitly discouraging the modification

00:11:05,640 --> 00:11:12,570
of jegs.com

00:11:07,320 --> 00:11:14,700
in 400 local file I mean this uses

00:11:12,570 --> 00:11:18,089
content directory populated with the

00:11:14,700 --> 00:11:23,399
profile and you need to use a variety in

00:11:18,089 --> 00:11:26,370
a new file the third use directory of

00:11:23,399 --> 00:11:32,880
the territory also and use

00:11:26,370 --> 00:11:36,260
which is right tail use CC gel but

00:11:32,880 --> 00:11:43,800
gee directory so you don't need to edit

00:11:36,260 --> 00:11:46,230
/ DC / CCL that on file anymore but we

00:11:43,800 --> 00:11:49,320
are also some package with lack of super

00:11:46,230 --> 00:11:53,880
of our right hand include I will give

00:11:49,320 --> 00:11:57,110
you some examples to do use sudo stodgy

00:11:53,880 --> 00:12:01,589
directory but you can't a variety I

00:11:57,110 --> 00:12:05,910
asked Reagan and the worst studio will

00:12:01,589 --> 00:12:09,930
be cognitive broken if you do is nag us

00:12:05,910 --> 00:12:14,070
NFP use multi directory but doesn't

00:12:09,930 --> 00:12:17,339
supports option of arrivals and even re5

00:12:14,070 --> 00:12:20,880
random name in county directory so

00:12:17,339 --> 00:12:24,329
surprising POSIX doesn't support include

00:12:20,880 --> 00:12:27,000
and upstream dozen transport is openness

00:12:24,329 --> 00:12:35,670
aside mm support extinct route also and

00:12:27,000 --> 00:12:38,820
the public option in it can be very

00:12:35,670 --> 00:12:42,660
dangerous and Chinese student support

00:12:38,820 --> 00:12:46,579
override squeak support includes an

00:12:42,660 --> 00:12:49,459
override but they can package use only

00:12:46,579 --> 00:12:53,880
one second file

00:12:49,459 --> 00:12:57,149
so Jeremy let's play with addition of on

00:12:53,880 --> 00:12:59,880
file with all the stuff I will reopen

00:12:57,149 --> 00:13:02,430
because I think relate but unsupportive

00:12:59,880 --> 00:13:04,740
as many many oceans to any price I'll

00:13:02,430 --> 00:13:06,910
call them briefly we have magnified

00:13:04,740 --> 00:13:10,269
which can which is

00:13:06,910 --> 00:13:12,220
I know general removal a neophyte become

00:13:10,269 --> 00:13:19,720
but it's not very good for mental

00:13:12,220 --> 00:13:23,170
institutions we have also replace which

00:13:19,720 --> 00:13:24,879
is essentially the set command it does

00:13:23,170 --> 00:13:29,889
not replace the whole life but only one

00:13:24,879 --> 00:13:32,139
mentions the regular expressions like in

00:13:29,889 --> 00:13:34,389
final project and replacing automatons

00:13:32,139 --> 00:13:36,480
use regular expressions and as you may

00:13:34,389 --> 00:13:39,430
know regular expressions are quite hard

00:13:36,480 --> 00:13:42,699
first of all try to remove the exact

00:13:39,430 --> 00:13:47,290
section of the page but not the shell

00:13:42,699 --> 00:13:49,509
exact maybe you will have fun and if you

00:13:47,290 --> 00:13:51,730
can hello a with replacing the full file

00:13:49,509 --> 00:13:56,439
instead of into it it's really

00:13:51,730 --> 00:13:58,990
easier we also have a compiler which is

00:13:56,439 --> 00:14:02,980
very useful to insert and update chunks

00:13:58,990 --> 00:14:04,689
of text within free defined markers this

00:14:02,980 --> 00:14:07,809
one is very useful for multiple

00:14:04,689 --> 00:14:10,569
institutions but it's quite dangerous to

00:14:07,809 --> 00:14:13,620
use it in conjunction with magnifiers or

00:14:10,569 --> 00:14:13,620
in place of the sunlights

00:14:15,269 --> 00:14:20,920
copy and templates the brows replaced

00:14:18,189 --> 00:14:23,679
the profile is all statically or with

00:14:20,920 --> 00:14:26,860
template and which topic can use

00:14:23,679 --> 00:14:30,850
variables and conditioners to build the

00:14:26,860 --> 00:14:31,690
final five final file but we advise not

00:14:30,850 --> 00:14:34,220
to put

00:14:31,690 --> 00:14:38,650
interplay dribbles the the maintenance

00:14:34,220 --> 00:14:42,230
the maintenance is part so to sum up

00:14:38,650 --> 00:14:44,180
stay at the final Valley camera we do

00:14:42,230 --> 00:14:47,930
that when we are not sure about the fat

00:14:44,180 --> 00:14:51,170
content and if you need get down to the

00:14:47,930 --> 00:14:53,270
line by line level in the file and using

00:14:51,170 --> 00:15:02,810
those those modules carefully use a lot

00:14:53,270 --> 00:15:05,480
of this thing so we need to have a smart

00:15:02,810 --> 00:15:10,810
aleck fight for automation and let's

00:15:05,480 --> 00:15:16,580
summarize all good watches supports

00:15:10,810 --> 00:15:19,970
overwrite in config file use include

00:15:16,580 --> 00:15:26,000
when possible to untouched before

00:15:19,970 --> 00:15:30,560
graphic files use Conte directory when

00:15:26,000 --> 00:15:37,600
possible use confide generated by

00:15:30,560 --> 00:15:37,600
manuscript and take a look at UCF

00:15:37,720 --> 00:15:44,540
provide scripts to validate the config

00:15:41,060 --> 00:15:48,860
like Apache CTL perfectest for example

00:15:44,540 --> 00:15:52,970
and provide tools to enable disable

00:15:48,860 --> 00:16:01,060
config file or module like a ph.d

00:15:52,970 --> 00:16:03,310
program thank you we are an opportunity

00:16:01,060 --> 00:16:10,220
yeah we're a few minutes if you are

00:16:03,310 --> 00:16:14,530
questions and if you know it's okay we

00:16:10,220 --> 00:16:16,880
will be here until the end of the week

00:16:14,530 --> 00:16:21,440
Harmon and we are organizing

00:16:16,880 --> 00:16:27,140
I know he's done but we can talk in the

00:16:21,440 --> 00:16:27,380
network way above about sure thank you

00:16:27,140 --> 00:16:29,150
again

00:16:27,380 --> 00:16:32,230
Thanks

00:16:29,150 --> 00:16:32,230
[Applause]

00:16:34,550 --> 00:16:38,480
you

00:16:35,000 --> 00:16:38,480

YouTube URL: https://www.youtube.com/watch?v=-sSLXWne6Mg


