Title: Migrating a Linux environment to IDM
Publication date: 2019-03-04
Playlist: DevConfCZ 2019
Description: 
	Presentation name: Migrating a Linux environment to IDM
Speaker: Dustin Minnich
Description:  As you would expect, Red Hat IT manages lots of Linux systems. This talk will discuss how we are slowly and methodically migrating them from classical LDAP and MIT Kerberos info and authentication backends to using IDM and sssd.

Benefits of the move will be shared and so will some of the lessons learned.
[ https://sched.co/JcfK ]
Captions: 
	00:00:04,910 --> 00:00:10,500
alright hey everybody my name is just a

00:00:07,350 --> 00:00:13,590
minute I work for Red Hat IT and this

00:00:10,500 --> 00:00:17,090
talks going to be discussing how we are

00:00:13,590 --> 00:00:20,429
currently moving systems Linux systems

00:00:17,090 --> 00:00:23,579
from using a legacy Kerberos and LDAP

00:00:20,429 --> 00:00:26,249
setup to using IDM if you're not

00:00:23,579 --> 00:00:28,529
familiar with IDM it's the downstream of

00:00:26,249 --> 00:00:31,679
free IPA if you're not familiar with

00:00:28,529 --> 00:00:35,970
three IPA you can kind of lovingly think

00:00:31,679 --> 00:00:38,340
of that as eighty-four links and it

00:00:35,970 --> 00:00:41,760
basically has certificate management

00:00:38,340 --> 00:00:45,570
bolts in Kerberos built in LDAP builtin

00:00:41,760 --> 00:00:48,930
it also manages two doors selinux

00:00:45,570 --> 00:00:53,510
has a DNS server built in so it does a

00:00:48,930 --> 00:00:57,240
lot of stuff all in one nice package so

00:00:53,510 --> 00:00:59,250
to get started I'm going to talk a

00:00:57,240 --> 00:01:01,110
little bit about Red Hat's IT

00:00:59,250 --> 00:01:01,620
environment or in hats environment as a

00:01:01,110 --> 00:01:03,390
whole

00:01:01,620 --> 00:01:05,270
I'll let you guys kind of read that's

00:01:03,390 --> 00:01:09,420
like because there's a lot of words but

00:01:05,270 --> 00:01:11,820
the the overall I guess takeaway that I

00:01:09,420 --> 00:01:14,730
want you to realize is that Red Hat is a

00:01:11,820 --> 00:01:16,800
big company and it kind of operates with

00:01:14,730 --> 00:01:18,810
several suck or I guess several groups

00:01:16,800 --> 00:01:22,860
running kind of like their own startups

00:01:18,810 --> 00:01:25,380
and that creates challenges for things

00:01:22,860 --> 00:01:28,670
that you want to change across the

00:01:25,380 --> 00:01:30,180
entire breadth of the company like this

00:01:28,670 --> 00:01:34,380
for instance

00:01:30,180 --> 00:01:36,990
I know what IT is doing and I know what

00:01:34,380 --> 00:01:39,150
systems we manage and I know that you

00:01:36,990 --> 00:01:41,340
know if we give laptops to new employees

00:01:39,150 --> 00:01:42,770
I can be reasonably assured what they're

00:01:41,340 --> 00:01:46,260
gonna get on them things of that nature

00:01:42,770 --> 00:01:47,940
but engineering the people that actually

00:01:46,260 --> 00:01:50,130
write the software kind of have their

00:01:47,940 --> 00:01:51,840
own IT group and that's good for the

00:01:50,130 --> 00:01:53,940
company because that allows their group

00:01:51,840 --> 00:01:55,500
to run like bleeding-edge versions of

00:01:53,940 --> 00:01:57,750
things like OpenStack and whatever

00:01:55,500 --> 00:02:01,439
they're running but at the same time

00:01:57,750 --> 00:02:04,590
other people in the company need I would

00:02:01,439 --> 00:02:08,189
say more standardized or more red tape

00:02:04,590 --> 00:02:09,929
style things and more normal offerings

00:02:08,189 --> 00:02:12,379
that like a normal IT shop would offer

00:02:09,929 --> 00:02:12,379
so

00:02:12,400 --> 00:02:17,200
it's kind of an interesting mixture of

00:02:14,590 --> 00:02:19,390
where we offer some things that other

00:02:17,200 --> 00:02:24,940
groups use and then other groups do

00:02:19,390 --> 00:02:28,299
basically the same things we do so right

00:02:24,940 --> 00:02:29,670
now this is our legacy set up and this

00:02:28,299 --> 00:02:33,129
is what we're trying to move away from

00:02:29,670 --> 00:02:36,879
so we have you know a Kerberos master

00:02:33,129 --> 00:02:40,239
and DC one that replicates the Kerberos

00:02:36,879 --> 00:02:41,349
slaves elsewhere we have Don tag which

00:02:40,239 --> 00:02:44,530
is RHCs

00:02:41,349 --> 00:02:46,599
and that is the certificate system and

00:02:44,530 --> 00:02:48,250
that's multi master it's in multiple

00:02:46,599 --> 00:02:53,739
data centers and writes back and forth

00:02:48,250 --> 00:02:56,620
same for LDAP 389 or HDS writes back and

00:02:53,739 --> 00:02:59,680
forth of multiple data centers and for

00:02:56,620 --> 00:03:01,359
DMS we run bind with one single master

00:02:59,680 --> 00:03:06,099
that writes to slaves in multiple data

00:03:01,359 --> 00:03:07,720
centers so I mean you can see that this

00:03:06,099 --> 00:03:11,829
is a lot of software a lot of stuff to

00:03:07,720 --> 00:03:15,129
maintain and you can also tell that bind

00:03:11,829 --> 00:03:17,109
and Kerberos have at least a little bit

00:03:15,129 --> 00:03:18,819
of lag time if something goes down we'd

00:03:17,109 --> 00:03:23,349
have to do some work to promote some

00:03:18,819 --> 00:03:25,840
stuff to master this goes into how

00:03:23,349 --> 00:03:28,209
things are configured right now so we do

00:03:25,840 --> 00:03:31,810
still have some rl6 boxes hanging around

00:03:28,209 --> 00:03:35,889
and they're running an SS pam i'll bap

00:03:31,810 --> 00:03:38,919
de pam care b5 and SL c BN s DD took

00:03:35,889 --> 00:03:42,489
into LDAP and Kerberos RL seven boxes

00:03:38,919 --> 00:03:45,489
are running us SSD their puppet managed

00:03:42,489 --> 00:03:47,799
and whenever we give laptops and

00:03:45,489 --> 00:03:51,400
machines to people it's either well

00:03:47,799 --> 00:03:53,650
seven Windows or Mac OS and those are

00:03:51,400 --> 00:03:57,519
kind of like blessed images that are

00:03:53,650 --> 00:04:00,090
desktop the desktop team manages we also

00:03:57,519 --> 00:04:04,090
support a lot of bring your own devices

00:04:00,090 --> 00:04:06,160
and self managed systems so one thing

00:04:04,090 --> 00:04:09,430
that's I think also interesting about

00:04:06,160 --> 00:04:11,889
Red Hat is even for the systems that Red

00:04:09,430 --> 00:04:15,069
Hat pays for so if you get a laptop from

00:04:11,889 --> 00:04:17,289
Red Hat last time I heard the statistic

00:04:15,069 --> 00:04:20,229
like 50 percent of those aren't even

00:04:17,289 --> 00:04:22,180
running the corporate image like people

00:04:20,229 --> 00:04:24,130
just get it and wipe it and install and

00:04:22,180 --> 00:04:25,169
do whatever they want which is actually

00:04:24,130 --> 00:04:26,789
great for the company

00:04:25,169 --> 00:04:29,729
because most of those people end up

00:04:26,789 --> 00:04:31,979
installing the Fedora and then they find

00:04:29,729 --> 00:04:34,169
bugs in Fedora and put the worried it's

00:04:31,979 --> 00:04:38,219
better and then rel gets better so

00:04:34,169 --> 00:04:39,479
that's great except for now if I want

00:04:38,219 --> 00:04:41,129
all of those people that are self

00:04:39,479 --> 00:04:45,300
managing their own machines to start

00:04:41,129 --> 00:04:50,189
using IPA where do i how do I do that

00:04:45,300 --> 00:04:53,099
so yeah perfect blog config is moving

00:04:50,189 --> 00:04:56,520
everything to IPA IPA does all the

00:04:53,099 --> 00:04:59,210
things and IPA has replicas and it's all

00:04:56,520 --> 00:05:01,800
multi-master everywhere so again this

00:04:59,210 --> 00:05:05,400
this is easier to maintain because it's

00:05:01,800 --> 00:05:08,819
all one big stack and a lot less servers

00:05:05,400 --> 00:05:10,590
and also we get rid of the single master

00:05:08,819 --> 00:05:13,469
problem for Kerberos and the single

00:05:10,590 --> 00:05:16,020
master problem for some of our DMS stuff

00:05:13,469 --> 00:05:18,979
that we got going on

00:05:16,020 --> 00:05:24,419
ideally everything would be around seven

00:05:18,979 --> 00:05:28,229
using an S SSD and we hopefully be

00:05:24,419 --> 00:05:30,839
ansible managed and as we start to roll

00:05:28,229 --> 00:05:34,080
out new laptops let's bake an IBM

00:05:30,839 --> 00:05:35,610
support to the actual images that you

00:05:34,080 --> 00:05:36,960
know the sales people the finance people

00:05:35,610 --> 00:05:41,430
the people that wants something that's

00:05:36,960 --> 00:05:44,069
supported by standard IT processes so

00:05:41,430 --> 00:05:47,159
that bacon using though a known system

00:05:44,069 --> 00:05:50,460
and then let's also give well-documented

00:05:47,159 --> 00:05:52,319
instructions rpms and other things for

00:05:50,460 --> 00:05:57,719
everybody else that wants to do their

00:05:52,319 --> 00:06:00,810
own stuff so getting there is going to

00:05:57,719 --> 00:06:06,899
take a long time so we're currently in

00:06:00,810 --> 00:06:08,610
about Phase two and a half so we have

00:06:06,899 --> 00:06:11,969
the existing infrastructure which was

00:06:08,610 --> 00:06:14,669
the legacy Kerberos LDAP buy and so on

00:06:11,969 --> 00:06:16,949
and so forth and we've created an IBM

00:06:14,669 --> 00:06:21,029
across realm trust and we must have done

00:06:16,949 --> 00:06:23,219
a DNS zone delegation so our legacy

00:06:21,029 --> 00:06:26,099
Kerberos realms Red Hat com

00:06:23,219 --> 00:06:27,750
we now have an IP a.com they both trust

00:06:26,099 --> 00:06:30,620
each other through Kerberos

00:06:27,750 --> 00:06:35,529
bi-directional trust and right now the

00:06:30,620 --> 00:06:39,819
IPA DMS is only managing IPA

00:06:35,529 --> 00:06:43,029
calm and it's subdomains so that's phase

00:06:39,819 --> 00:06:45,759
one and all pretty soon going to all the

00:06:43,029 --> 00:06:48,879
challenges we've had getting past even

00:06:45,759 --> 00:06:53,559
up these phase two is kind of adoption

00:06:48,879 --> 00:06:55,419
tool and so as I mentioned with kind of

00:06:53,559 --> 00:06:58,029
this open model that we run at Red Hat

00:06:55,419 --> 00:07:00,909
where people do whatever they want to do

00:06:58,029 --> 00:07:04,029
we have to make it easy for people to

00:07:00,909 --> 00:07:08,079
switch so that they will have incentive

00:07:04,029 --> 00:07:09,609
to switch and actually want to and one

00:07:08,079 --> 00:07:11,459
of that or one of the things that we're

00:07:09,609 --> 00:07:14,069
trying to encourage folks to do is

00:07:11,459 --> 00:07:16,899
people that have written and ansible

00:07:14,069 --> 00:07:19,479
played ansible roles or puppet modules

00:07:16,899 --> 00:07:23,439
to manage things like sudoers and

00:07:19,479 --> 00:07:26,469
selinux and those kind of things that

00:07:23,439 --> 00:07:30,399
are now that IDM is able to centrally

00:07:26,469 --> 00:07:33,419
store and manage and also ssh configs

00:07:30,399 --> 00:07:38,379
and stuff like that because IDM will do

00:07:33,419 --> 00:07:39,999
HVAC controls we have to get those folks

00:07:38,379 --> 00:07:43,269
to compare what they're currently doing

00:07:39,999 --> 00:07:46,469
to what type day offers and try to show

00:07:43,269 --> 00:07:48,729
off that IPA can do this better and

00:07:46,469 --> 00:07:54,069
potentially you know coax them into

00:07:48,729 --> 00:07:55,659
switching phase 3 is going to be cutting

00:07:54,069 --> 00:07:57,909
off RHCs so that's going to be the

00:07:55,659 --> 00:07:59,739
easiest thing for us to kill because

00:07:57,909 --> 00:08:02,199
basically people are just using it to

00:07:59,739 --> 00:08:04,899
cut search whether that server search or

00:08:02,199 --> 00:08:07,929
client certs and all we have to do is

00:08:04,899 --> 00:08:10,889
convince folks to start doing those same

00:08:07,929 --> 00:08:14,829
actions to the IPA cas

00:08:10,889 --> 00:08:17,019
one of the things in phase 3 also is the

00:08:14,829 --> 00:08:20,669
our HDS so that's the Alabama tree

00:08:17,019 --> 00:08:24,519
purpose one of the things that IPA

00:08:20,669 --> 00:08:26,289
states and their documentation is that

00:08:24,519 --> 00:08:28,179
it's really good at storing user and

00:08:26,289 --> 00:08:31,869
group information and it's really tuned

00:08:28,179 --> 00:08:33,939
to do that very well and right now over

00:08:31,869 --> 00:08:36,610
time has collected a lot of cruft

00:08:33,939 --> 00:08:40,360
and our LDAP servers so people will come

00:08:36,610 --> 00:08:42,550
to us and say hey I'd like to store my

00:08:40,360 --> 00:08:47,080
biography and

00:08:42,550 --> 00:08:49,480
I want my picture NL back or things that

00:08:47,080 --> 00:08:52,089
aren't like your typical Linux and UNIX

00:08:49,480 --> 00:08:54,010
attributes they wanted an LDAP so we've

00:08:52,089 --> 00:08:57,339
written schemas and we've extended our

00:08:54,010 --> 00:09:01,480
old legacy LDAP to support that and we

00:08:57,339 --> 00:09:03,579
have to push back on that and decide how

00:09:01,480 --> 00:09:06,730
dirty we're gonna make IDM to support

00:09:03,579 --> 00:09:10,860
what people want and how how unhappy we

00:09:06,730 --> 00:09:10,860
can make people to make our lives easier

00:09:11,730 --> 00:09:20,470
we've also used our HDS for custom

00:09:17,410 --> 00:09:23,320
application stuff so we have mail

00:09:20,470 --> 00:09:25,779
servers that do MX lookups and LDAP and

00:09:23,320 --> 00:09:28,300
that's because the mail servers do a lot

00:09:25,779 --> 00:09:30,010
of work and all that just responds

00:09:28,300 --> 00:09:32,890
really quickly and it's a good purpose

00:09:30,010 --> 00:09:35,290
fit but again we don't want to put that

00:09:32,890 --> 00:09:37,149
entire structure in the IBM so in all

00:09:35,290 --> 00:09:39,339
likelihood we're going to continue to

00:09:37,149 --> 00:09:42,160
run the LDAP servers that we have now

00:09:39,339 --> 00:09:45,790
we're just gonna minimize that as much

00:09:42,160 --> 00:09:48,279
as possible phase 4 is Kerberos cutoff

00:09:45,790 --> 00:09:51,579
that's going to be right now we're still

00:09:48,279 --> 00:09:54,250
being probably end of 2020 and the only

00:09:51,579 --> 00:09:56,529
reason why is again we don't really have

00:09:54,250 --> 00:09:59,170
a whole lot of control we can force

00:09:56,529 --> 00:10:02,260
people inside the IT organization to

00:09:59,170 --> 00:10:04,510
some extent to make moves but outside of

00:10:02,260 --> 00:10:06,370
that realistically the only way we're

00:10:04,510 --> 00:10:09,399
gonna get people off of the old systems

00:10:06,370 --> 00:10:12,640
is to really persuade them hardly

00:10:09,399 --> 00:10:14,950
whenever they're I guess whenever their

00:10:12,640 --> 00:10:17,709
stuff is about to timeout so if you're

00:10:14,950 --> 00:10:20,529
going to be migrating from rl6 to l7 or

00:10:17,709 --> 00:10:23,320
if your application is basically going

00:10:20,529 --> 00:10:24,970
to get rewritten or your device is going

00:10:23,320 --> 00:10:27,040
to be retired and you're gonna get a new

00:10:24,970 --> 00:10:30,100
laptop whatever it may be whatever that

00:10:27,040 --> 00:10:31,870
brand new thing is rolled out then it's

00:10:30,100 --> 00:10:34,029
time for you to move and then once

00:10:31,870 --> 00:10:37,959
everybody moves then we'll be able to

00:10:34,029 --> 00:10:40,660
cut it off phase five is forever out and

00:10:37,959 --> 00:10:43,329
that's gonna be us examining if Cote P

00:10:40,660 --> 00:10:45,070
and bind can be more widely used right

00:10:43,329 --> 00:10:47,529
now in house we have a different ITP

00:10:45,070 --> 00:10:51,040
solution that seems to work pretty well

00:10:47,529 --> 00:10:52,839
so we're not super I guess we're at this

00:10:51,040 --> 00:10:55,760
instance we're not super interested in

00:10:52,839 --> 00:10:58,550
pursuing that route and bind

00:10:55,760 --> 00:11:00,890
is also going to be interesting as well

00:10:58,550 --> 00:11:03,230
because we have some config management

00:11:00,890 --> 00:11:06,800
and we have lots of DNS servers around

00:11:03,230 --> 00:11:08,060
and I don't know if people will want to

00:11:06,800 --> 00:11:10,010
give up the way that they're used to

00:11:08,060 --> 00:11:12,500
managing that kind of stuff to move to

00:11:10,010 --> 00:11:14,360
IDM I'm also like we haven't done any

00:11:12,500 --> 00:11:16,010
benchmarking or anything either but I'm

00:11:14,360 --> 00:11:17,870
not I don't know

00:11:16,010 --> 00:11:21,320
I'd assume IDM would be able to keep up

00:11:17,870 --> 00:11:24,490
with the demand but we have lots of

00:11:21,320 --> 00:11:27,860
Records and we get lots of requests so I

00:11:24,490 --> 00:11:30,200
think IDM kind of treats it's by an

00:11:27,860 --> 00:11:32,150
instance a little bit like a black box

00:11:30,200 --> 00:11:34,010
like I don't think they want you to go

00:11:32,150 --> 00:11:37,340
in and mess with it a whole lot and that

00:11:34,010 --> 00:11:40,430
that leaves me a little concern versus

00:11:37,340 --> 00:11:42,230
the way that they treat our HDS RHCs and

00:11:40,430 --> 00:11:44,570
all that is also kind of black box but

00:11:42,230 --> 00:11:49,160
we don't really need special configs

00:11:44,570 --> 00:11:50,690
there so I'm okay with it let's skip

00:11:49,160 --> 00:11:52,370
this slide last time I gave this talk

00:11:50,690 --> 00:11:55,700
ahead an hour so I'm kind of trying to

00:11:52,370 --> 00:11:57,440
go through this pretty quick so data

00:11:55,700 --> 00:12:02,510
synchronization was one of the problems

00:11:57,440 --> 00:12:05,450
and so IPA officially supports IPA

00:12:02,510 --> 00:12:07,610
migrate des we use this for the initial

00:12:05,450 --> 00:12:12,050
data import and it's good for a kind of

00:12:07,610 --> 00:12:13,790
a one-and-done approach unfortunately to

00:12:12,050 --> 00:12:16,430
support these gradual migrations that

00:12:13,790 --> 00:12:18,560
I've been talking about and because we

00:12:16,430 --> 00:12:20,360
have a very complex account lifecycle

00:12:18,560 --> 00:12:22,700
management that's hooked into things

00:12:20,360 --> 00:12:24,740
like HR systems and SAS vendors that

00:12:22,700 --> 00:12:27,800
tracked locations of employees and

00:12:24,740 --> 00:12:31,240
things of that nature we have to run

00:12:27,800 --> 00:12:36,410
both systems at the same time and that

00:12:31,240 --> 00:12:39,590
is terrible and in order to do that we

00:12:36,410 --> 00:12:41,500
have written custom code and I would

00:12:39,590 --> 00:12:45,430
strongly suggest that you don't do this

00:12:41,500 --> 00:12:49,100
but basically what's happening here is

00:12:45,430 --> 00:12:50,990
we have the legacy LDAP system that's

00:12:49,100 --> 00:12:53,510
still being used for some of the

00:12:50,990 --> 00:12:56,480
lifecycle management of accounts because

00:12:53,510 --> 00:12:58,970
again that's that's what systems we

00:12:56,480 --> 00:13:00,920
currently have tied into it and as those

00:12:58,970 --> 00:13:03,080
things change we have custom code that

00:13:00,920 --> 00:13:05,480
is then taking those entries out of

00:13:03,080 --> 00:13:08,660
legacy LDAP putting them into

00:13:05,480 --> 00:13:10,700
and sometimes that's with API calls and

00:13:08,660 --> 00:13:13,040
other times that's with Braille LDAP

00:13:10,700 --> 00:13:16,520
writes and all the oh you structure and

00:13:13,040 --> 00:13:17,210
everything else changes it's just not

00:13:16,520 --> 00:13:20,510
pretty

00:13:17,210 --> 00:13:22,790
additionally as new apps are onboard it

00:13:20,510 --> 00:13:26,420
or as new consumers are onboard if we

00:13:22,790 --> 00:13:29,030
tell them to use IDM but then every once

00:13:26,420 --> 00:13:31,910
in a while somebody's using IDM but some

00:13:29,030 --> 00:13:33,590
of their clients aren't using IDM so

00:13:31,910 --> 00:13:35,630
then we have to do the reverse as well

00:13:33,590 --> 00:13:39,710
now we have to copy stuff from ITN to

00:13:35,630 --> 00:13:42,740
the old systems it's anyhow if you can

00:13:39,710 --> 00:13:45,520
force the change force to change because

00:13:42,740 --> 00:13:45,520
this is not good

00:13:45,610 --> 00:13:54,470
another situation we had is in our HDS

00:13:50,990 --> 00:13:56,750
we were using a plug-in called pan pass

00:13:54,470 --> 00:13:59,390
through and what Pam fast through does

00:13:56,750 --> 00:14:01,850
is it allows you to configure password

00:13:59,390 --> 00:14:05,060
lookups in different ways using panel

00:14:01,850 --> 00:14:08,890
modules and traditionally what we had

00:14:05,060 --> 00:14:13,000
done with our HDS is delegate to

00:14:08,890 --> 00:14:16,670
Kerberos Pam krb and what that meant is

00:14:13,000 --> 00:14:19,940
your LDAP records did not have a user

00:14:16,670 --> 00:14:23,150
password attribute and every time you

00:14:19,940 --> 00:14:25,760
would do a bind against LDAP LDAP would

00:14:23,150 --> 00:14:28,940
then talk to Kerberos and validate the

00:14:25,760 --> 00:14:30,320
password we did this because sweet now

00:14:28,940 --> 00:14:34,780
we only have to store passwords in one

00:14:30,320 --> 00:14:34,780
place and ideally that's more secure

00:14:36,170 --> 00:14:43,400
this did not end well or did not support

00:14:39,410 --> 00:14:46,640
our migration very well to IBM because

00:14:43,400 --> 00:14:49,040
IBM supports mass setting passwords and

00:14:46,640 --> 00:14:52,160
communicating them out users as a

00:14:49,040 --> 00:14:54,770
migration strategy that would there's no

00:14:52,160 --> 00:14:57,110
way we could ever do that maybe small

00:14:54,770 --> 00:15:00,230
companies that would work they also

00:14:57,110 --> 00:15:03,620
support a web UI migration in an S SSD

00:15:00,230 --> 00:15:06,110
migration which both of which look for

00:15:03,620 --> 00:15:08,060
the user password and validate against

00:15:06,110 --> 00:15:11,720
it and then if Kerberos doesn't have the

00:15:08,060 --> 00:15:14,300
password set it so they they tackle it

00:15:11,720 --> 00:15:16,370
from the kind of reverse of what we had

00:15:14,300 --> 00:15:19,010
they assume you're gonna migrate over an

00:15:16,370 --> 00:15:21,560
LDAP environment that has user password

00:15:19,010 --> 00:15:24,080
hashes and you can't migrate over the

00:15:21,560 --> 00:15:26,320
Kerberos data so then they would set up

00:15:24,080 --> 00:15:28,340
the Kerberos data we had the exact

00:15:26,320 --> 00:15:32,540
opposite we can't migrate over the

00:15:28,340 --> 00:15:34,820
Kerberos data and we can't so we have

00:15:32,540 --> 00:15:39,770
the right to custom map and the custom

00:15:34,820 --> 00:15:42,710
map is using a specific account or a

00:15:39,770 --> 00:15:44,330
special account inside of IDM and what

00:15:42,710 --> 00:15:47,680
happens is you end up on this web page

00:15:44,330 --> 00:15:51,350
and it's protected by sam'l and it's

00:15:47,680 --> 00:15:54,500
samos tied to our legacy LDAP and

00:15:51,350 --> 00:15:57,260
Kerberos infrastructure and once you log

00:15:54,500 --> 00:16:00,470
in it asks you to set your ID and

00:15:57,260 --> 00:16:02,030
password so you enter your IDM whatever

00:16:00,470 --> 00:16:05,840
you want your ID and password to be and

00:16:02,030 --> 00:16:08,030
it goes out via REST API and using that

00:16:05,840 --> 00:16:10,070
special account that special service

00:16:08,030 --> 00:16:13,370
account an IBM and set your password

00:16:10,070 --> 00:16:16,070
it also bypasses the user password reset

00:16:13,370 --> 00:16:18,050
requirement so normally whenever you set

00:16:16,070 --> 00:16:20,000
a password an IDM next time the person

00:16:18,050 --> 00:16:24,620
logs in they immediately have to change

00:16:20,000 --> 00:16:27,230
it so this has worked well and this this

00:16:24,620 --> 00:16:30,650
is easy and simple for people to to

00:16:27,230 --> 00:16:32,060
manage so overall this was a win it just

00:16:30,650 --> 00:16:37,010
took a little bit of time to figure out

00:16:32,060 --> 00:16:40,850
or work around so I've I've alluded to

00:16:37,010 --> 00:16:43,610
this some one of our biggest problems is

00:16:40,850 --> 00:16:47,210
we can't lift and shift at all so in

00:16:43,610 --> 00:16:49,820
addition to me not knowing what the guy

00:16:47,210 --> 00:16:52,460
across the hall is doing like if

00:16:49,820 --> 00:16:55,070
is its he running a Raspberry Pi under

00:16:52,460 --> 00:16:57,080
his desk that he's using to you know

00:16:55,070 --> 00:17:01,130
somehow seed production information I

00:16:57,080 --> 00:17:05,959
don't know we also don't have really

00:17:01,130 --> 00:17:09,290
strong I team ties to specific DNS

00:17:05,959 --> 00:17:13,850
subdomains which makes Kerberos

00:17:09,290 --> 00:17:16,610
migration fun as well so if you can

00:17:13,850 --> 00:17:17,120
switch everybody at the same time that's

00:17:16,610 --> 00:17:18,530
great

00:17:17,120 --> 00:17:20,300
if you can't switch everybody at the

00:17:18,530 --> 00:17:22,010
same time the next best thing you can do

00:17:20,300 --> 00:17:25,100
or the next best easiest thing you can

00:17:22,010 --> 00:17:29,540
do is update like the krb five configs

00:17:25,100 --> 00:17:31,370
or top-level dns text records which is

00:17:29,540 --> 00:17:36,050
what the domain realm stuff there is so

00:17:31,370 --> 00:17:37,640
we could say like team X Red Hat comm is

00:17:36,050 --> 00:17:40,280
still pointing at the legacy Red Hat

00:17:37,640 --> 00:17:42,440
comm realm and team Y doctor and hat

00:17:40,280 --> 00:17:45,980
comm is pointing at the IPA on Red Hat

00:17:42,440 --> 00:17:49,040
calm realm but the issue is is team X

00:17:45,980 --> 00:17:52,520
some of them will be right comm Sumomo

00:17:49,040 --> 00:17:55,850
VIP a dot rediff.com and because of that

00:17:52,520 --> 00:17:58,460
we have to end up doing all of the per

00:17:55,850 --> 00:18:02,450
boroughs information has to be fetched

00:17:58,460 --> 00:18:04,250
from dns and as a specific machine is

00:18:02,450 --> 00:18:06,020
migrated we have to add a text record

00:18:04,250 --> 00:18:11,120
for that specific machine if they're

00:18:06,020 --> 00:18:15,040
staying in that same self domain yep so

00:18:11,120 --> 00:18:17,510
that's working it's fine and this is

00:18:15,040 --> 00:18:19,220
this is basically the statements of

00:18:17,510 --> 00:18:21,710
what's happening here what I just went

00:18:19,220 --> 00:18:26,180
over we have to move one system at a

00:18:21,710 --> 00:18:28,520
time as they age out and create DMS text

00:18:26,180 --> 00:18:31,400
records that tell it what basically the

00:18:28,520 --> 00:18:34,310
point this guy at the IPA realm instead

00:18:31,400 --> 00:18:38,420
and we're doing that as things aged out

00:18:34,310 --> 00:18:39,590
and we're also again creating thing or

00:18:38,420 --> 00:18:42,110
we're making things as simple as

00:18:39,590 --> 00:18:45,230
possible so that when they do age out

00:18:42,110 --> 00:18:48,020
people will be able to migrate to IBM

00:18:45,230 --> 00:18:50,690
and hopefully not complain a whole lot

00:18:48,020 --> 00:18:53,810
so we're creating puppet classes ansible

00:18:50,690 --> 00:18:56,360
rolls rpms and docs for bring your own

00:18:53,810 --> 00:19:00,350
devices we're also updating picks cards

00:18:56,360 --> 00:19:02,150
and other automations that our desktop

00:19:00,350 --> 00:19:07,490
team uses to spit up the forth

00:19:02,150 --> 00:19:08,590
laptops another problem is people hate

00:19:07,490 --> 00:19:12,140
change

00:19:08,590 --> 00:19:16,930
so people are used to how they're

00:19:12,140 --> 00:19:20,270
getting searched for or from RHCs and

00:19:16,930 --> 00:19:21,800
people keep asking like well puppet or

00:19:20,270 --> 00:19:23,840
ansible is doing a really good job of

00:19:21,800 --> 00:19:26,090
managing ssh allowed groups

00:19:23,840 --> 00:19:29,690
why should we switch to H back inside of

00:19:26,090 --> 00:19:31,670
IDM and again puppet or ansible is doing

00:19:29,690 --> 00:19:35,200
a good job with config management for

00:19:31,670 --> 00:19:38,960
seniors in SE linux why should we change

00:19:35,200 --> 00:19:42,800
and the last one is again a mention of

00:19:38,960 --> 00:19:45,230
basically how we're gonna have to end up

00:19:42,800 --> 00:19:47,570
dirtying up the IDM schema so people are

00:19:45,230 --> 00:19:52,940
used to query LDAP and getting things

00:19:47,570 --> 00:19:55,130
again like biography or we have like a

00:19:52,940 --> 00:19:57,050
like a belief system or a video

00:19:55,130 --> 00:20:00,140
conferencing system so we'll store like

00:19:57,050 --> 00:20:02,720
their video conferencing ID and all that

00:20:00,140 --> 00:20:08,750
then things that aren't you know again

00:20:02,720 --> 00:20:11,270
stock stock schema things so to get

00:20:08,750 --> 00:20:14,660
people to change we're developing and

00:20:11,270 --> 00:20:16,310
offering even better automation so for

00:20:14,660 --> 00:20:19,550
the certificate stuff that they're used

00:20:16,310 --> 00:20:22,310
to or going ahead and creating better

00:20:19,550 --> 00:20:25,220
automation using serger and other custom

00:20:22,310 --> 00:20:27,260
code that will spit out or basically

00:20:25,220 --> 00:20:29,240
take the PEM that surf monger spits out

00:20:27,260 --> 00:20:35,030
and renew automatically and converts

00:20:29,240 --> 00:20:37,040
that into pkcs12 S&J ks's and just

00:20:35,030 --> 00:20:39,050
really makes it nice so that software

00:20:37,040 --> 00:20:41,000
developers can just point out a specific

00:20:39,050 --> 00:20:43,730
file and just know that the certs always

00:20:41,000 --> 00:20:46,370
going to be up to date which is a win

00:20:43,730 --> 00:20:48,590
for them compared to okay well my starts

00:20:46,370 --> 00:20:50,810
going to expire and now I have to run an

00:20:48,590 --> 00:20:56,510
automation script to get a new sir so

00:20:50,810 --> 00:20:58,400
that's better automation for SSH allowed

00:20:56,510 --> 00:21:01,940
groups were doing stuff like OTO member

00:20:58,400 --> 00:21:06,080
groups in HVAC so we'll be able to set

00:21:01,940 --> 00:21:09,650
things like ok you are underneath this

00:21:06,080 --> 00:21:12,560
manager and because of that you will

00:21:09,650 --> 00:21:13,590
have access to these systems and that

00:21:12,560 --> 00:21:16,200
will just

00:21:13,590 --> 00:21:18,990
and we can do auto member groups and

00:21:16,200 --> 00:21:22,160
auto remember host groups and it all

00:21:18,990 --> 00:21:24,420
just happens automatically inside of IDM

00:21:22,160 --> 00:21:27,780
whatever it does there are three fresh

00:21:24,420 --> 00:21:29,340
stones so again that's in some ways

00:21:27,780 --> 00:21:32,010
better than what they're used to with

00:21:29,340 --> 00:21:35,040
SSH allow groups we're also doing

00:21:32,010 --> 00:21:37,080
trainings and demo sessions and again

00:21:35,040 --> 00:21:39,960
pro con unless type things which to do

00:21:37,080 --> 00:21:41,640
or is and SELinux to try to get people

00:21:39,960 --> 00:21:45,780
interested and switching from config

00:21:41,640 --> 00:21:50,130
management to basically moving back some

00:21:45,780 --> 00:21:51,840
of that stuff into IDM and here the last

00:21:50,130 --> 00:21:53,760
bullet point again is talking about us

00:21:51,840 --> 00:21:57,210
moving some of that non-standard data

00:21:53,760 --> 00:22:02,580
into IDM there's some links there the my

00:21:57,210 --> 00:22:04,080
slide that's on the diskette site but

00:22:02,580 --> 00:22:07,190
here are some some of the things that

00:22:04,080 --> 00:22:10,020
we've done to do that it's not quite as

00:22:07,190 --> 00:22:13,170
simple as I would like it to be or quite

00:22:10,020 --> 00:22:14,610
as simple as it was and our HDS you have

00:22:13,170 --> 00:22:17,370
to do some stuff and then you have to do

00:22:14,610 --> 00:22:19,860
some other stuff to get it to actually

00:22:17,370 --> 00:22:24,540
displayed the extended scheme attributes

00:22:19,860 --> 00:22:28,160
at the API level and I got five minutes

00:22:24,540 --> 00:22:28,160
left and ready for questions

00:22:35,720 --> 00:22:42,720
the question was from a fedora what

00:22:38,340 --> 00:22:45,480
version oh yeah absolutely

00:22:42,720 --> 00:22:48,990
from a fedora 29 version or laptop can

00:22:45,480 --> 00:22:51,090
enjoy an idea yes I will say that with

00:22:48,990 --> 00:22:55,860
one small caveat I know it works with

00:22:51,090 --> 00:22:58,050
the door 28 and I have seen it I've got

00:22:55,860 --> 00:23:00,270
the ticket in my queue and it was

00:22:58,050 --> 00:23:03,180
somebody that was trying to use the word

00:23:00,270 --> 00:23:06,140
29 and I'm honestly not up-to-date on

00:23:03,180 --> 00:23:09,780
the desktop site but I think there was

00:23:06,140 --> 00:23:14,400
often things being replaced by something

00:23:09,780 --> 00:23:17,550
I'm sure somebody knows and because of

00:23:14,400 --> 00:23:19,260
that the IPA installer I think was

00:23:17,550 --> 00:23:21,390
bombing because it was expecting on

00:23:19,260 --> 00:23:25,850
confetti was this over

00:23:21,390 --> 00:23:25,850
specs beautiful

00:23:35,960 --> 00:23:41,810
yes that is true

00:23:38,180 --> 00:23:41,810
any other questions

00:23:45,540 --> 00:23:54,630
if you know now uh yeah the question was

00:23:52,830 --> 00:23:56,760
if I knew of all the problems that we

00:23:54,630 --> 00:23:59,880
were gonna hit what I still move to IDM

00:23:56,760 --> 00:24:01,860
and the answer is yes long term this is

00:23:59,880 --> 00:24:04,020
going to be a game changer for my team

00:24:01,860 --> 00:24:06,180
because it's going to be less systems to

00:24:04,020 --> 00:24:09,330
manage and it's also the right thing for

00:24:06,180 --> 00:24:12,540
Red Hat to do we tried it on food

00:24:09,330 --> 00:24:15,030
whatever we can so the more that we use

00:24:12,540 --> 00:24:17,010
our own products and you know the more

00:24:15,030 --> 00:24:19,370
we discover some issues the better off

00:24:17,010 --> 00:24:19,370
it is

00:24:21,580 --> 00:24:33,559
yeah if I ask how money lets a user

00:24:26,650 --> 00:24:34,940
entries sure yeah the the question was

00:24:33,559 --> 00:24:38,750
how many user entries do we have in the

00:24:34,940 --> 00:24:42,640
database yeah right now Red Hat has last

00:24:38,750 --> 00:24:50,480
time I looked a little over 1200 users

00:24:42,640 --> 00:24:51,950
yeah sorry 4,000 yeah mr. zero now to

00:24:50,480 --> 00:25:12,890
blow your mind I think we have like

00:24:51,950 --> 00:25:14,660
50,000 groups the question was do we

00:25:12,890 --> 00:25:17,500
keep off boarded or terminated employees

00:25:14,660 --> 00:25:19,669
in the user base and the answer is yes

00:25:17,500 --> 00:25:21,020
12,000 was the active user account I

00:25:19,669 --> 00:25:24,559
have no idea what the inactive user

00:25:21,020 --> 00:25:27,590
count is we moved them to and legacy ale

00:25:24,559 --> 00:25:31,419
that we move them to a different oh you

00:25:27,590 --> 00:25:31,419
and an idea we just

00:25:36,010 --> 00:25:51,960
here we go oh thanks everybody

00:25:43,980 --> 00:25:51,960

YouTube URL: https://www.youtube.com/watch?v=w__FAJBfxGo


