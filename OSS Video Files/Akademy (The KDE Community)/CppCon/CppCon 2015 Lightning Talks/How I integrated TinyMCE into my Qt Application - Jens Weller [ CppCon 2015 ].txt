Title: How I integrated TinyMCE into my Qt Application - Jens Weller [ CppCon 2015 ]
Publication date: 2015-10-21
Playlist: CppCon 2015 Lightning Talks
Description: 
	http://www.Cppcon.org
—
Presentation Slides, PDFs, Source Code and other presenter materials are available at: https://github.com/cppcon/cppcon2015
—
Lightning Talk
— 
Videos Filmed & Edited by Bash Films: http://www.BashFilms.com
—
Optimized And Managed by Digital Medium Ltd - events.digital-medium.co.uk
events@digital-medium.co.uk
Captions: 
	00:00:00,000 --> 00:00:06,450
hi um yeah I needed a text editor and

00:00:04,140 --> 00:00:11,070
that's why I integrated Tony MC in my

00:00:06,450 --> 00:00:14,490
cute application so a short boy excited

00:00:11,070 --> 00:00:18,119
about me but actually i only have 15

00:00:14,490 --> 00:00:19,590
minutes so i was looking for a text

00:00:18,119 --> 00:00:23,100
editor as i'm currently writing my own

00:00:19,590 --> 00:00:25,170
CMS and you know usually what what you

00:00:23,100 --> 00:00:27,840
get and UI frameworks are just text

00:00:25,170 --> 00:00:30,779
controls which allow you loved it off

00:00:27,840 --> 00:00:33,030
you know editing strings and cute also

00:00:30,779 --> 00:00:37,230
has like a rich text control where you

00:00:33,030 --> 00:00:39,480
can display and edit HTML and rich text

00:00:37,230 --> 00:00:44,340
in a very basic way but that's not

00:00:39,480 --> 00:00:45,899
really what i need and then why doing

00:00:44,340 --> 00:00:50,010
some research on that topic I saw that

00:00:45,899 --> 00:00:52,949
kte frameworks 5 which basically is the

00:00:50,010 --> 00:00:56,340
KDE libraries for cute wrapped into a

00:00:52,949 --> 00:00:59,489
new framework kind of has something

00:00:56,340 --> 00:01:01,500
called k text editor class and which if

00:00:59,489 --> 00:01:05,339
you really want to use C++ probably is

00:01:01,500 --> 00:01:08,280
the best way to go and so if you have

00:01:05,339 --> 00:01:12,030
used use things like Kate under linux or

00:01:08,280 --> 00:01:16,380
something else that's probably where it

00:01:12,030 --> 00:01:17,970
leads up on so um also yeah that would

00:01:16,380 --> 00:01:20,159
WA switch it says something like that in

00:01:17,970 --> 00:01:23,369
the library I remember from my days when

00:01:20,159 --> 00:01:26,549
I did that so I've been looking at Katie

00:01:23,369 --> 00:01:30,000
frameworks and I was not too hesitant to

00:01:26,549 --> 00:01:33,750
use it as even if it's like the best

00:01:30,000 --> 00:01:36,150
solution for c++ I'm not sure how good

00:01:33,750 --> 00:01:39,150
the windows support isn't I used to work

00:01:36,150 --> 00:01:40,799
on the windows and it should kind of

00:01:39,150 --> 00:01:44,310
work with cute but is there no treasure

00:01:40,799 --> 00:01:46,920
is there an alternative and tiny MCE is

00:01:44,310 --> 00:01:50,250
what I'm currently using and maybe I can

00:01:46,920 --> 00:01:52,530
integrate it because this is the

00:01:50,250 --> 00:01:56,070
dependency graph for the KDE solution

00:01:52,530 --> 00:01:57,630
and I thought maybe I found something

00:01:56,070 --> 00:02:02,450
which is easier to integrate into my

00:01:57,630 --> 00:02:06,960
application and this dependency myth so

00:02:02,450 --> 00:02:09,830
what I need is kind of what you see is

00:02:06,960 --> 00:02:13,390
what you get editor for HTML parts I

00:02:09,830 --> 00:02:17,530
want to be able to edit links

00:02:13,390 --> 00:02:22,569
to edit images and tiny MCE is able to

00:02:17,530 --> 00:02:25,510
do all of that and yeah this is the end

00:02:22,569 --> 00:02:29,560
result and this is the editor in my

00:02:25,510 --> 00:02:33,160
programs or as you see it works but how

00:02:29,560 --> 00:02:36,070
the hell do I get there um so Tania MCE

00:02:33,160 --> 00:02:38,260
is a written in JavaScript so it's kind

00:02:36,070 --> 00:02:41,230
of you know you have to have some HTML

00:02:38,260 --> 00:02:42,640
riffing and then it's basically living

00:02:41,230 --> 00:02:45,400
inside a browser it's browser technology

00:02:42,640 --> 00:02:48,489
it's not meant to be integrated into its

00:02:45,400 --> 00:02:51,820
dumb of application and its

00:02:48,489 --> 00:02:54,760
interfaces are mainly for integrating

00:02:51,820 --> 00:02:57,580
into a server environment or into a

00:02:54,760 --> 00:02:59,620
different environment and then I have on

00:02:57,580 --> 00:03:01,480
the other side cuvette view which can

00:02:59,620 --> 00:03:04,600
give me kind of like a browser like

00:03:01,480 --> 00:03:06,790
environment based on webkit that offers

00:03:04,600 --> 00:03:10,510
also bridge between c++ and java script

00:03:06,790 --> 00:03:12,820
i can execute commands from c++ to

00:03:10,510 --> 00:03:14,410
javascript and the other way around of

00:03:12,820 --> 00:03:16,720
course yet since the browser windows

00:03:14,410 --> 00:03:19,120
with randos HTML and has a C++ API which

00:03:16,720 --> 00:03:23,200
basically is everything I always need to

00:03:19,120 --> 00:03:28,299
make this work arm in a perfect world

00:03:23,200 --> 00:03:30,070
tiny MCE has a few limitations arm the

00:03:28,299 --> 00:03:32,380
first limitation is like everything

00:03:30,070 --> 00:03:33,790
which is in the browser stays there so

00:03:32,380 --> 00:03:35,890
we have for this little editor window

00:03:33,790 --> 00:03:37,420
and this little editor window is

00:03:35,890 --> 00:03:40,299
basically where everything which is

00:03:37,420 --> 00:03:43,150
inside of taniam's it can only go so if

00:03:40,299 --> 00:03:44,650
we open a dialog it will stay inside

00:03:43,150 --> 00:03:48,160
this window and that's like really

00:03:44,650 --> 00:03:51,190
really weird and the dialogues of tiny

00:03:48,160 --> 00:03:53,680
MC do not scale at all so there is like

00:03:51,190 --> 00:03:58,170
some windows even which are only

00:03:53,680 --> 00:03:58,170
closable because we have scroll bars and

00:03:58,620 --> 00:04:03,610
then also the other the other hand hand

00:04:01,840 --> 00:04:05,670
is integrating this is obviously a

00:04:03,610 --> 00:04:08,860
little bit of a hack I really need to

00:04:05,670 --> 00:04:12,549
write my own plugins for in JavaScript

00:04:08,860 --> 00:04:14,709
and one example is the the officer way

00:04:12,549 --> 00:04:18,669
to to integrate images into the editors

00:04:14,709 --> 00:04:21,640
actually having either a javascript file

00:04:18,669 --> 00:04:23,800
on the file system or having kind of

00:04:21,640 --> 00:04:26,170
like a PHP files which actually

00:04:23,800 --> 00:04:27,790
generates this java script

00:04:26,170 --> 00:04:30,760
file which contains a JavaScript

00:04:27,790 --> 00:04:35,890
variable pointing at a list of images

00:04:30,760 --> 00:04:37,570
and yeah you could use an executable for

00:04:35,890 --> 00:04:41,950
that on the file system but I didn't try

00:04:37,570 --> 00:04:45,700
that and but I thought about how about

00:04:41,950 --> 00:04:47,650
if I give it a URL which is pointing to

00:04:45,700 --> 00:04:50,640
localhost and I have a server running

00:04:47,650 --> 00:04:55,930
this well guess what that doesn't work

00:04:50,640 --> 00:04:58,240
so I I began to understand that I need

00:04:55,930 --> 00:05:00,760
to do if I want to make that working

00:04:58,240 --> 00:05:04,360
because the basic functionality of

00:05:00,760 --> 00:05:06,340
editing text works out of the box but

00:05:04,360 --> 00:05:10,750
things like images etc a bit more tricky

00:05:06,340 --> 00:05:13,150
so I need to be able to replace the

00:05:10,750 --> 00:05:15,130
dialogues which I want to use and which

00:05:13,150 --> 00:05:19,480
are not big enough or which use like

00:05:15,130 --> 00:05:21,190
images armed with my own dialogue switch

00:05:19,480 --> 00:05:23,560
live in the cute board and can you know

00:05:21,190 --> 00:05:28,290
the excess outside of the window of the

00:05:23,560 --> 00:05:30,610
browser and yeah the integration of

00:05:28,290 --> 00:05:34,780
images and links turns out to be really

00:05:30,610 --> 00:05:39,160
difficult as um there's kind of like the

00:05:34,780 --> 00:05:42,490
same origin policy in the browser and

00:05:39,160 --> 00:05:48,280
also there's another limitation which we

00:05:42,490 --> 00:05:52,120
will see soon um because from from the

00:05:48,280 --> 00:05:57,070
queue WebKit view of things um I'm very

00:05:52,120 --> 00:06:00,040
easy able to to just to register the

00:05:57,070 --> 00:06:03,550
object which is basically wrapping the

00:06:00,040 --> 00:06:06,940
whole edit or into JavaScript so I can

00:06:03,550 --> 00:06:09,610
easily call methods into super spots

00:06:06,940 --> 00:06:13,780
which are marked this queue in vocal or

00:06:09,610 --> 00:06:18,130
I could emit a signal from JavaScript

00:06:13,780 --> 00:06:20,740
which then handed and cute arm and of

00:06:18,130 --> 00:06:24,010
course I also can execute JavaScript

00:06:20,740 --> 00:06:25,840
from C++ so this is this becomes very

00:06:24,010 --> 00:06:30,040
important when we actually want to hack

00:06:25,840 --> 00:06:32,170
this to display a dialogue in C++ land

00:06:30,040 --> 00:06:35,080
and then execute JavaScript to return

00:06:32,170 --> 00:06:37,330
the result of that dialogue to the

00:06:35,080 --> 00:06:38,950
editor and actually display an image or

00:06:37,330 --> 00:06:45,700
change the HTML in the

00:06:38,950 --> 00:06:47,920
editor so i have a class called HTML it

00:06:45,700 --> 00:06:49,990
text edit or let's drive from québec

00:06:47,920 --> 00:06:51,430
view and that's basically wrapping the

00:06:49,990 --> 00:06:58,510
seacoast bus interface for the text

00:06:51,430 --> 00:07:04,270
editor and yeah this is like a smaller

00:06:58,510 --> 00:07:06,720
version of the class and um I have one

00:07:04,270 --> 00:07:09,730
method which is invoke oval via

00:07:06,720 --> 00:07:12,100
JavaScript and I have another method

00:07:09,730 --> 00:07:15,010
which I call by r which I connect to a

00:07:12,100 --> 00:07:16,690
signal so I have tried both ways from

00:07:15,010 --> 00:07:19,480
the JavaScript point of view it's

00:07:16,690 --> 00:07:22,030
basically the same syntax calling or

00:07:19,480 --> 00:07:25,180
calling or emitting signals I can save

00:07:22,030 --> 00:07:27,310
for John was brilliant I'm not sure

00:07:25,180 --> 00:07:30,310
which is the best method in my opinion

00:07:27,310 --> 00:07:31,840
from from from the laziness invoke a

00:07:30,310 --> 00:07:33,610
bill is better because I don't need to

00:07:31,840 --> 00:07:36,280
connect to that signal and would have to

00:07:33,610 --> 00:07:37,330
register a signal for it and maybe from

00:07:36,280 --> 00:07:40,140
the other point of view from the

00:07:37,330 --> 00:07:43,240
performances signal might be better and

00:07:40,140 --> 00:07:46,840
of course the class can also if there's

00:07:43,240 --> 00:07:48,280
one method to execute JavaScript and

00:07:46,840 --> 00:07:52,260
this method will also locally a

00:07:48,280 --> 00:07:54,070
JavaScript which we executed and the

00:07:52,260 --> 00:07:56,110
constructor is not learning a lot

00:07:54,070 --> 00:07:58,690
because I'm actually starting this

00:07:56,110 --> 00:08:02,380
editorial bit tricky and therefore there

00:07:58,690 --> 00:08:06,250
exists an init may edit or slot which is

00:08:02,380 --> 00:08:08,050
called by a timer as we have no way of

00:08:06,250 --> 00:08:12,490
knowing that the editor actually is

00:08:08,050 --> 00:08:13,930
loaded arm which was like really very

00:08:12,490 --> 00:08:15,550
difficult to find out why some things

00:08:13,930 --> 00:08:19,870
didn't work on the start and later

00:08:15,550 --> 00:08:25,540
worked the reason is that I I can get a

00:08:19,870 --> 00:08:28,120
signal for having the HTML loaded but

00:08:25,540 --> 00:08:30,160
then the JavaScript just started running

00:08:28,120 --> 00:08:33,970
and loading the editor and doing her

00:08:30,160 --> 00:08:36,310
things and so I played around with

00:08:33,970 --> 00:08:37,870
timings into to figure out how long

00:08:36,310 --> 00:08:41,229
actually the JavaScript needs to load

00:08:37,870 --> 00:08:43,510
and it's about like 150 to 200

00:08:41,229 --> 00:08:45,910
milliseconds on my machine atonement

00:08:43,510 --> 00:08:50,350
here on the laptop it takes a little bit

00:08:45,910 --> 00:08:52,660
longer so the implementation from super

00:08:50,350 --> 00:08:55,810
fast point of view is have 2x

00:08:52,660 --> 00:08:58,959
was the class itself to JavaScript I

00:08:55,810 --> 00:09:02,139
have to override the image link handlers

00:08:58,959 --> 00:09:07,420
and display to dialogue on an execute

00:09:02,139 --> 00:09:10,649
JavaScript x MCE itself I had to read

00:09:07,420 --> 00:09:13,629
plugins which actually handle the the

00:09:10,649 --> 00:09:16,180
buttons and our things and commands in

00:09:13,629 --> 00:09:17,800
the editor so that I have to replace I

00:09:16,180 --> 00:09:19,810
really have to hack me editor here to

00:09:17,800 --> 00:09:22,420
replace certain calls and javascript is

00:09:19,810 --> 00:09:25,949
my own JavaScript and then calling to

00:09:22,420 --> 00:09:29,649
c++ and do basically the round trip and

00:09:25,949 --> 00:09:32,319
then one problem i have is i need

00:09:29,649 --> 00:09:35,410
actually like a host fire for the editor

00:09:32,319 --> 00:09:38,889
which has to be a physical HTML fire I'm

00:09:35,410 --> 00:09:40,509
loading just random HTML string

00:09:38,889 --> 00:09:45,040
containing everything which would be

00:09:40,509 --> 00:09:47,709
need to run it didn't work so this HTML

00:09:45,040 --> 00:09:50,290
file contains the text area and also

00:09:47,709 --> 00:09:53,230
contains the JavaScript needed to loot

00:09:50,290 --> 00:09:55,149
on ence and the physical location and

00:09:53,230 --> 00:09:58,680
the directory where is the base pass for

00:09:55,149 --> 00:10:02,860
the editor which means that all all

00:09:58,680 --> 00:10:04,959
images or other things which reddit must

00:10:02,860 --> 00:10:08,079
have a relative path or must be in that

00:10:04,959 --> 00:10:10,120
directory to this editor which for

00:10:08,079 --> 00:10:14,800
example means that if I have several

00:10:10,120 --> 00:10:17,649
folders in my CMS i currently have to

00:10:14,800 --> 00:10:19,060
copy that file into each of those this

00:10:17,649 --> 00:10:22,300
is limitation which I'm currently trying

00:10:19,060 --> 00:10:26,110
to find out if I can work around it but

00:10:22,300 --> 00:10:30,459
from the current point of youth seems to

00:10:26,110 --> 00:10:33,100
be difficult so in the constructor I

00:10:30,459 --> 00:10:35,620
only do disabled clicking on links

00:10:33,100 --> 00:10:37,750
because otherwise we would open links in

00:10:35,620 --> 00:10:40,089
the editor where we're currently working

00:10:37,750 --> 00:10:41,800
on and that was really a big surprise to

00:10:40,089 --> 00:10:49,720
another happened so I turned that off

00:10:41,800 --> 00:10:51,160
and I connect to the signal um in the in

00:10:49,720 --> 00:10:53,350
this message I actually set the base

00:10:51,160 --> 00:10:55,839
pass which is important to first know

00:10:53,350 --> 00:11:01,059
which eight which editor HTML I should

00:10:55,839 --> 00:11:04,449
note and I then also associate this

00:11:01,059 --> 00:11:06,070
wisdom the sacred object of in

00:11:04,449 --> 00:11:08,320
JavaScript which then is called

00:11:06,070 --> 00:11:11,740
by a window notation I will show you

00:11:08,320 --> 00:11:18,250
that later and here's a little cute

00:11:11,740 --> 00:11:23,680
timer and I use this to initialize the Z

00:11:18,250 --> 00:11:27,910
object later so um this is the code for

00:11:23,680 --> 00:11:32,440
unselect image which first displays the

00:11:27,910 --> 00:11:35,620
image dialog and then we're just like

00:11:32,440 --> 00:11:38,830
boost which is then just being displayed

00:11:35,620 --> 00:11:42,460
in the editor via executing this

00:11:38,830 --> 00:11:46,330
JavaScript and the exact JavaScript

00:11:42,460 --> 00:11:49,930
method which just yeah this mainframe is

00:11:46,330 --> 00:11:51,850
basically the pointer to the HTML

00:11:49,930 --> 00:11:54,370
fragment the sequel.fast implementation

00:11:51,850 --> 00:11:56,380
of Q WebKit which holds our website and

00:11:54,370 --> 00:11:58,570
the editor and we just evaluate to

00:11:56,380 --> 00:12:00,070
JavaScript there and not before so that

00:11:58,570 --> 00:12:04,810
I know what kind of JavaScript I have

00:12:00,070 --> 00:12:06,340
executed and yeah I am not very good at

00:12:04,810 --> 00:12:09,580
javascript so I'm just going to show you

00:12:06,340 --> 00:12:14,860
a few little lines of JavaScript this is

00:12:09,580 --> 00:12:18,580
how as we have added this object which

00:12:14,860 --> 00:12:20,620
which is ourselves this is c++ object

00:12:18,580 --> 00:12:23,040
actually to the window variable of

00:12:20,620 --> 00:12:27,040
JavaScript and we're able to call

00:12:23,040 --> 00:12:28,750
methods and emit signals which is the

00:12:27,040 --> 00:12:35,400
same syntax actually and we also put a

00:12:28,750 --> 00:12:38,650
hand over parameters from JavaScript and

00:12:35,400 --> 00:12:41,920
yeah then I have to to add a button to

00:12:38,650 --> 00:12:45,520
to the editor and a little bit of other

00:12:41,920 --> 00:12:48,610
setup and basically it works good

00:12:45,520 --> 00:12:50,590
limitation lots of resources get

00:12:48,610 --> 00:12:51,880
allocated and wasted for this one editor

00:12:50,590 --> 00:12:53,770
should be enough in my opinion but

00:12:51,880 --> 00:12:57,280
instead I have like an editor's loaded

00:12:53,770 --> 00:12:59,800
on the base paths and the few

00:12:57,280 --> 00:13:02,230
limitations don't really mix up

00:12:59,800 --> 00:13:04,990
especially with the editor HTML on conan

00:13:02,230 --> 00:13:06,580
not really happy but I tried to set the

00:13:04,990 --> 00:13:08,680
base your eye off the editor them that

00:13:06,580 --> 00:13:11,560
does not work in JavaScript and yeah

00:13:08,680 --> 00:13:13,780
it's really difficult to doubt to debug

00:13:11,560 --> 00:13:19,540
JavaScript and WebKit inside a cute

00:13:13,780 --> 00:13:22,150
application and yeah what I also would

00:13:19,540 --> 00:13:26,110
need is a text editor for HTML text our

00:13:22,150 --> 00:13:28,270
CSS JavaScript Tony and see my opinion

00:13:26,110 --> 00:13:30,640
no good for that so maybe I need some

00:13:28,270 --> 00:13:32,440
other web editors and for example item

00:13:30,640 --> 00:13:35,020
would not be an alternative I look at

00:13:32,440 --> 00:13:37,240
Adam but I Thomas based on no trace and

00:13:35,020 --> 00:13:40,420
ransom like in its own environment in

00:13:37,240 --> 00:13:43,410
runtime therefore it's not very able to

00:13:40,420 --> 00:13:45,940
integrate in any and other application

00:13:43,410 --> 00:13:48,160
so the end result is I have a rockin

00:13:45,940 --> 00:13:52,000
HTML editor some fine-tuning is still

00:13:48,160 --> 00:13:55,240
needed arm and yeah some parts always

00:13:52,000 --> 00:13:57,460
moving a heck tiny MCE the 4x branch the

00:13:55,240 --> 00:14:00,339
newest branch of tangency did not run in

00:13:57,460 --> 00:14:02,830
the queue WebKit ah so that's why i also

00:14:00,339 --> 00:14:04,600
used the free version which also the

00:14:02,830 --> 00:14:10,500
solution i'm used to work with so its

00:14:04,600 --> 00:14:10,500

YouTube URL: https://www.youtube.com/watch?v=h7dKQllZnzA


