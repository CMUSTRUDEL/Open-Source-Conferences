Title: Chef Automation for the Cloud, Part 3 - Michael Ducy
Publication date: 2014-04-29
Playlist: CloudStack Collaboration Conference North America 2014
Description: 
	CloudStack Collaboration Conference North America 2014
Captions: 
	00:00:00,000 --> 00:00:03,380
we could talk about like what actually

00:00:01,530 --> 00:00:05,759
happens on the chef run them but that's

00:00:03,380 --> 00:00:08,730
it's important that is also a little

00:00:05,759 --> 00:00:09,870
boring a little dry so just try and keep

00:00:08,730 --> 00:00:12,719
you guys as awake as much as possible

00:00:09,870 --> 00:00:14,610
the other thing is so it's 341 we have

00:00:12,719 --> 00:00:16,529
the room until five it's up to you guys

00:00:14,610 --> 00:00:19,080
is like how much further you want to go

00:00:16,529 --> 00:00:20,369
and keep going I can always give you the

00:00:19,080 --> 00:00:23,699
rest of this duck and you can kind of

00:00:20,369 --> 00:00:27,300
work on this on your own at any point in

00:00:23,699 --> 00:00:29,550
time I know there's the Apache keynotes

00:00:27,300 --> 00:00:32,360
coming up towards the end of the day and

00:00:29,550 --> 00:00:36,030
things like that so it's up to you guys

00:00:32,360 --> 00:00:37,920
I'll let you drive the class but this is

00:00:36,030 --> 00:00:42,390
kind of an important concept so we at

00:00:37,920 --> 00:00:43,920
least want to get through this so we

00:00:42,390 --> 00:00:47,370
want to talk about node attributes and

00:00:43,920 --> 00:00:51,030
so attributes are one of the key

00:00:47,370 --> 00:00:53,129
defining concepts of chef there an

00:00:51,030 --> 00:00:54,620
extremely important aspect when you're

00:00:53,129 --> 00:00:57,059
writing a recipe or something like that

00:00:54,620 --> 00:00:59,280
we already saw attributes when we did

00:00:57,059 --> 00:01:01,109
the knife node search or the list as

00:00:59,280 --> 00:01:03,510
well and were you able to specify the

00:01:01,109 --> 00:01:05,129
dash a and we got certain attributes

00:01:03,510 --> 00:01:06,720
that we wanted back from the search

00:01:05,129 --> 00:01:12,600
results or from the listing results

00:01:06,720 --> 00:01:15,299
right so we've already talked about a

00:01:12,600 --> 00:01:16,619
node a bit so it's any physical it's

00:01:15,299 --> 00:01:21,180
anywhere where chef client is running

00:01:16,619 --> 00:01:23,009
and installed right when you write a

00:01:21,180 --> 00:01:24,869
recipe you can manipulate the node

00:01:23,009 --> 00:01:26,520
object right because you're running on

00:01:24,869 --> 00:01:35,070
the node and thus you can interact with

00:01:26,520 --> 00:01:41,159
the node object itself so inside of

00:01:35,070 --> 00:01:43,950
these inside of these nodes they have

00:01:41,159 --> 00:01:46,350
essentially various components to them

00:01:43,950 --> 00:01:48,060
and it's really an object so think of it

00:01:46,350 --> 00:01:50,759
in an object-oriented programming type

00:01:48,060 --> 00:01:52,890
perspective there's attributes there's

00:01:50,759 --> 00:01:54,450
the run list or the methods that I'm

00:01:52,890 --> 00:01:56,460
actually going to perform the resources

00:01:54,450 --> 00:01:58,979
that I'm going to manage and then the

00:01:56,460 --> 00:02:01,140
chef environment or the environment that

00:01:58,979 --> 00:02:02,399
I'm running in and I haven't talked

00:02:01,140 --> 00:02:04,259
about environments and I probably won't

00:02:02,399 --> 00:02:06,450
talk about environments much but

00:02:04,259 --> 00:02:10,200
essentially you can group servers by a

00:02:06,450 --> 00:02:12,360
common like like production servers you

00:02:10,200 --> 00:02:13,950
can group a development servers and then

00:02:12,360 --> 00:02:15,599
you can isolate them so that

00:02:13,950 --> 00:02:18,090
you have maybe a certain set of

00:02:15,599 --> 00:02:19,620
cookbooks you want to run on one

00:02:18,090 --> 00:02:22,349
environment versus another environment

00:02:19,620 --> 00:02:24,660
and so forth you can also pin versions

00:02:22,349 --> 00:02:26,670
of cookbooks / environment so you could

00:02:24,660 --> 00:02:31,140
say production environment always gets

00:02:26,670 --> 00:02:33,720
apache two dot one dot five cookbook but

00:02:31,140 --> 00:02:35,340
in my lower environment I can do testing

00:02:33,720 --> 00:02:37,860
with the newer cookbooks as I develop

00:02:35,340 --> 00:02:40,080
them and I can make sure that I won't

00:02:37,860 --> 00:02:41,400
infect production with a cookbook that I

00:02:40,080 --> 00:02:43,830
don't necessarily want to go to

00:02:41,400 --> 00:02:47,910
production until I increment a version

00:02:43,830 --> 00:02:50,130
number in the environment like the

00:02:47,910 --> 00:02:56,940
environment you had up earlier you had a

00:02:50,130 --> 00:02:59,220
load balancer a system that whole

00:02:56,940 --> 00:03:00,569
environment environment what would you

00:02:59,220 --> 00:03:02,220
have that would all be one shelf

00:03:00,569 --> 00:03:03,900
environment okay and then you could have

00:03:02,220 --> 00:03:06,180
additional things inside that

00:03:03,900 --> 00:03:11,849
environment as well you specify the

00:03:06,180 --> 00:03:13,680
difference it's to run this essentially

00:03:11,849 --> 00:03:22,350
is how you specified I was making sure I

00:03:13,680 --> 00:03:24,450
understand that yeah so we already

00:03:22,350 --> 00:03:27,150
talked about this as well so I'm just

00:03:24,450 --> 00:03:28,590
going to skip over this so the data in

00:03:27,150 --> 00:03:31,620
the client-server model is searchable

00:03:28,590 --> 00:03:34,380
right we've already talked about that so

00:03:31,620 --> 00:03:38,930
the syntax um so nodes are actually

00:03:34,380 --> 00:03:42,480
hashes of hashes in in Ruby syntax right

00:03:38,930 --> 00:03:44,850
and so you just specify if you want the

00:03:42,480 --> 00:03:47,359
kernel or you want the hostname or

00:03:44,850 --> 00:03:54,980
anything like that you just specify that

00:03:47,359 --> 00:04:00,090
since it is a so a ruby ism is that

00:03:54,980 --> 00:04:02,549
let's not talk about it right now all

00:04:00,090 --> 00:04:05,489
right so there's there's like three

00:04:02,549 --> 00:04:07,340
different ways to specify right this

00:04:05,489 --> 00:04:11,579
part in the middle between the brackets

00:04:07,340 --> 00:04:15,030
right so there's double quotes there's

00:04:11,579 --> 00:04:17,940
single quotes and the third way is a

00:04:15,030 --> 00:04:21,959
ruby ism called symbols or immutable

00:04:17,940 --> 00:04:25,380
strings and the third way is you could

00:04:21,959 --> 00:04:27,349
put colon hostname with no clothes means

00:04:25,380 --> 00:04:31,580
the exact same thing

00:04:27,349 --> 00:04:33,990
the immutable strings are faster because

00:04:31,580 --> 00:04:36,569
they're immutable right you're never

00:04:33,990 --> 00:04:38,069
going to change this string so therefore

00:04:36,569 --> 00:04:39,870
when its allocated and things like that

00:04:38,069 --> 00:04:44,099
it's done in a special way that Ruby

00:04:39,870 --> 00:04:46,889
actually makes it work faster there is a

00:04:44,099 --> 00:04:49,020
debate in the chef community whether if

00:04:46,889 --> 00:04:51,539
you should use single quotes or if you

00:04:49,020 --> 00:04:53,129
should use immutable strings I won't get

00:04:51,539 --> 00:04:54,840
into that right now there's something

00:04:53,129 --> 00:04:57,479
called fruit food critic which will

00:04:54,840 --> 00:04:59,340
actually lint your chef's recipe to make

00:04:57,479 --> 00:05:05,190
sure like it's syntactically correct and

00:04:59,340 --> 00:05:07,050
you're doing smart things and it's not

00:05:05,190 --> 00:05:09,840
installed in sublime as installed it

00:05:07,050 --> 00:05:16,370
like a knife plugin it's a gym that you

00:05:09,840 --> 00:05:21,780
actually install so let's open our

00:05:16,370 --> 00:05:24,630
template so our index HTML grb and let's

00:05:21,780 --> 00:05:29,759
put in some data so we're going to put

00:05:24,630 --> 00:05:32,419
in my name is node hostname and then

00:05:29,759 --> 00:05:32,419
save your file

00:05:56,249 --> 00:06:03,299
now if you wanted to if you want to work

00:05:59,279 --> 00:06:05,039
ahead or you can do that long listing

00:06:03,299 --> 00:06:06,749
and get back all of the attributes that

00:06:05,039 --> 00:06:09,409
are available in the node and you could

00:06:06,749 --> 00:06:11,519
put in more stuff here right so uptime

00:06:09,409 --> 00:06:16,709
don't put enough time and I'll tell you

00:06:11,519 --> 00:06:18,779
why in a second so you don't put an

00:06:16,709 --> 00:06:21,419
uptime because every single time the

00:06:18,779 --> 00:06:23,699
chef client runs up time is different

00:06:21,419 --> 00:06:26,159
you're putting this into a template and

00:06:23,699 --> 00:06:30,179
that's every time that the template file

00:06:26,159 --> 00:06:32,159
is parsed by chef up time is different

00:06:30,179 --> 00:06:33,989
thus the template changes and if the

00:06:32,159 --> 00:06:36,089
template triggers a service restart or

00:06:33,989 --> 00:06:37,379
something then you're like always going

00:06:36,089 --> 00:06:39,419
to be restarting that service or

00:06:37,379 --> 00:06:41,159
something like that right so be careful

00:06:39,419 --> 00:06:44,579
like if it's a counter or something like

00:06:41,159 --> 00:06:48,599
that in your note attributes be careful

00:06:44,579 --> 00:06:52,169
where you use it so save it upload the

00:06:48,599 --> 00:06:57,389
recipe or the cookbook and then run your

00:06:52,169 --> 00:06:59,549
chef client again the awesome bit that

00:06:57,389 --> 00:07:02,009
is you can't see on the screen you can't

00:06:59,549 --> 00:07:04,559
see on the recording you actually get a

00:07:02,009 --> 00:07:07,519
diff of what you change so what you

00:07:04,559 --> 00:07:11,129
deleted what you added and so forth

00:07:07,519 --> 00:07:14,519
additionally you break out of this so

00:07:11,129 --> 00:07:17,399
everyone get this far so far the other

00:07:14,519 --> 00:07:19,769
thing that you can do and no this is an

00:07:17,399 --> 00:07:22,259
open source conference so forgive me but

00:07:19,769 --> 00:07:24,689
it's kind of cool to see you can go to

00:07:22,259 --> 00:07:27,149
chef manage the GUI and you can go to

00:07:24,689 --> 00:07:29,549
reports and you can actually get a run

00:07:27,149 --> 00:07:33,119
history and you'll see all the runs that

00:07:29,549 --> 00:07:36,509
took place and anything changed you can

00:07:33,119 --> 00:07:39,689
actually see what changed and what was

00:07:36,509 --> 00:07:47,329
managed and stuff like that sorry to

00:07:39,689 --> 00:07:50,489
like pimp the product and so the this is

00:07:47,329 --> 00:07:52,439
yours to use it's like five nodes for

00:07:50,489 --> 00:07:56,339
free so play around with it keep it as

00:07:52,439 --> 00:07:57,659
long as you want we won't care so as

00:07:56,339 --> 00:07:59,549
you're learning chef and things like

00:07:57,659 --> 00:08:05,419
that you can actually continue to use it

00:07:59,549 --> 00:08:05,419
so everyone chef run complete

00:08:06,730 --> 00:08:15,950
the other thing that you can run on the

00:08:09,740 --> 00:08:18,620
node you can run oh hi and so this is on

00:08:15,950 --> 00:08:21,320
your note this is on you're on isn't on

00:08:18,620 --> 00:08:24,560
your local machine and you'll get back a

00:08:21,320 --> 00:08:26,630
bunch of data and so you'll notice by

00:08:24,560 --> 00:08:28,010
default it was able to go out and find

00:08:26,630 --> 00:08:29,840
out what version of Perl you have

00:08:28,010 --> 00:08:32,060
installed and what version of Python you

00:08:29,840 --> 00:08:38,090
hadn't installed this is obviously like

00:08:32,060 --> 00:08:44,060
a red hat box or something since we're

00:08:38,090 --> 00:08:46,700
using a two year old version you can

00:08:44,060 --> 00:08:48,470
also specify like various bits of

00:08:46,700 --> 00:08:52,040
information so specify the attributes

00:08:48,470 --> 00:08:55,660
right so if you specify oh hi hostname

00:08:52,040 --> 00:08:55,660
they'll give you back the host name

00:08:55,690 --> 00:09:03,770
which is similar to the node object

00:09:02,030 --> 00:09:09,370
right that's where all that data comes

00:09:03,770 --> 00:09:11,630
from is from oh hi we already did this

00:09:09,370 --> 00:09:13,370
so you should actually go to the home

00:09:11,630 --> 00:09:17,120
page and you should see my name is

00:09:13,370 --> 00:09:18,890
whatever your nodes name is web 10 or

00:09:17,120 --> 00:09:21,860
whatever you guys put right everyone

00:09:18,890 --> 00:09:24,040
work did you figure out your problem of

00:09:21,860 --> 00:09:24,040
white

00:09:27,170 --> 00:09:33,959
but I don't you don't have to pay right

00:09:30,329 --> 00:09:35,610
for now for now he's got a weird problem

00:09:33,959 --> 00:09:38,790
where he can't connect to port 80 on

00:09:35,610 --> 00:09:42,540
earth machine you're using to Bucky

00:09:38,790 --> 00:09:45,329
right no decent was give a firewall

00:09:42,540 --> 00:09:50,129
running on Santa left selinux problem

00:09:45,329 --> 00:09:54,660
Rocca tables so I had a table with dash

00:09:50,129 --> 00:09:57,110
capital L the tables just do service MP

00:09:54,660 --> 00:09:57,110
table stop

00:10:02,769 --> 00:10:08,589
yeah it was

00:10:05,439 --> 00:10:08,589
there we are

00:10:09,260 --> 00:10:15,660
multiple layers of fun and that's what i

00:10:11,730 --> 00:10:17,670
do to do but to local firewall what the

00:10:15,660 --> 00:10:23,670
hell that it has one but they don't

00:10:17,670 --> 00:10:25,740
enable it by full I don't so we can

00:10:23,670 --> 00:10:28,290
actually set these attributes as well

00:10:25,740 --> 00:10:32,910
and we can use them and do useful things

00:10:28,290 --> 00:10:35,670
with them so we already kind of talked

00:10:32,910 --> 00:10:38,130
about node attributes you can also have

00:10:35,670 --> 00:10:39,860
attributes in cookbooks as well and

00:10:38,130 --> 00:10:42,960
these attributes will then end up

00:10:39,860 --> 00:10:44,910
influencing the node attributes not

00:10:42,960 --> 00:10:47,640
influencing setting the node athletes

00:10:44,910 --> 00:10:49,500
right so say Apache so we're going to

00:10:47,640 --> 00:10:51,600
stalling a patsy what if we wanted to

00:10:49,500 --> 00:10:53,130
find a port Apache listens on then we

00:10:51,600 --> 00:10:55,470
can actually do that through an

00:10:53,130 --> 00:10:57,120
attribute in a recipe and when we want

00:10:55,470 --> 00:10:58,590
to change it we just need to change the

00:10:57,120 --> 00:11:04,380
attribute we don't need to change all of

00:10:58,590 --> 00:11:06,300
our configuration files so attributes

00:11:04,380 --> 00:11:10,110
can also not only be on the node but as

00:11:06,300 --> 00:11:12,030
i said in the cookbooks and recipes they

00:11:10,110 --> 00:11:14,700
can also be specified in roles and

00:11:12,030 --> 00:11:16,770
environments as well so if there's an

00:11:14,700 --> 00:11:18,870
attribute that you want to change for a

00:11:16,770 --> 00:11:22,280
group of servers then you can do that in

00:11:18,870 --> 00:11:22,280
a role or an environment

00:11:25,350 --> 00:11:31,890
so these are the ones that are kind of

00:11:27,150 --> 00:11:34,500
stuck automatically and oh hi so when

00:11:31,890 --> 00:11:37,080
you set an attribute we're not going to

00:11:34,500 --> 00:11:40,980
talk about precedence at all but

00:11:37,080 --> 00:11:44,220
essentially when you get started with

00:11:40,980 --> 00:11:48,390
chef the advice I can give you is always

00:11:44,220 --> 00:11:51,380
just use default to begin with there are

00:11:48,390 --> 00:11:54,630
15 levels of absolute precedence and

00:11:51,380 --> 00:11:57,120
it's changed by this name here so

00:11:54,630 --> 00:11:58,830
there's override their sports override

00:11:57,120 --> 00:12:02,490
their sports default and a whole bunch

00:11:58,830 --> 00:12:06,690
of other things by default just use

00:12:02,490 --> 00:12:10,050
default ah and then there's a precedent

00:12:06,690 --> 00:12:12,210
in roles environments nodes and

00:12:10,050 --> 00:12:16,830
cookbooks as well which one wins out

00:12:12,210 --> 00:12:20,010
there as well to make it simple just use

00:12:16,830 --> 00:12:21,570
default and then when you need to you

00:12:20,010 --> 00:12:23,670
can actually go into overrides and

00:12:21,570 --> 00:12:27,320
things like that when you get more

00:12:23,670 --> 00:12:27,320
mature in what you're doing with shock

00:12:27,410 --> 00:12:37,400
so let's open our attributes file so

00:12:31,980 --> 00:12:41,750
cookbooks Apache attributes default and

00:12:37,400 --> 00:12:41,750
just drop that in there file

00:12:44,520 --> 00:12:46,580
you

00:13:18,610 --> 00:13:33,730
so everyone got that in the file yes so

00:13:28,490 --> 00:13:36,590
now go into your index.html BRB and

00:13:33,730 --> 00:13:40,640
instead of hello world you can now drop

00:13:36,590 --> 00:13:42,530
in the attribute that you just set now

00:13:40,640 --> 00:13:44,570
you notice that you don't say default

00:13:42,530 --> 00:13:47,090
hear you say node so when you're setting

00:13:44,570 --> 00:13:57,020
you use default when you're consuming

00:13:47,090 --> 00:13:59,480
you use node right make sense and even

00:13:57,020 --> 00:14:00,830
though you're inside of a cookbook like

00:13:59,480 --> 00:14:02,960
when I first saw this it didn't

00:14:00,830 --> 00:14:04,280
necessarily make sense to me but even

00:14:02,960 --> 00:14:06,740
though you're inside of a cookbook you

00:14:04,280 --> 00:14:08,720
still you use node because the node

00:14:06,740 --> 00:14:12,500
object is the one that has all of the

00:14:08,720 --> 00:14:15,020
attributes set on it right it's not the

00:14:12,500 --> 00:14:16,880
cook book itself so all of these

00:14:15,020 --> 00:14:18,350
attributes that you define in the

00:14:16,880 --> 00:14:22,730
attributes file actually ends up getting

00:14:18,350 --> 00:14:24,440
pushed on to the node object itself so

00:14:22,730 --> 00:14:28,430
save that and then upload your cookbook

00:14:24,440 --> 00:14:32,420
after you've saved it and then after you

00:14:28,430 --> 00:14:34,700
upload your cookbook what do you do run

00:14:32,420 --> 00:14:36,800
in chef client the next thing that we're

00:14:34,700 --> 00:14:39,050
going to do which the last thing that

00:14:36,800 --> 00:14:40,700
we're going to do is we're going to set

00:14:39,050 --> 00:14:43,580
up chef client to run automatically for

00:14:40,700 --> 00:14:45,530
you so we'll do a role to actually do

00:14:43,580 --> 00:14:49,160
that I'll show you some other things as

00:14:45,530 --> 00:14:50,750
well you shouldn't have to be logging

00:14:49,160 --> 00:14:52,580
into the box to run chef client all the

00:14:50,750 --> 00:14:58,160
time chef client should run periodically

00:14:52,580 --> 00:15:03,710
for you so let me know when you guys got

00:14:58,160 --> 00:15:07,310
this working so what's interesting oh

00:15:03,710 --> 00:15:09,350
because the case is different so if your

00:15:07,310 --> 00:15:12,590
case wasn't the same in this case it was

00:15:09,350 --> 00:15:16,850
hello lowercase world uppercase world so

00:15:12,590 --> 00:15:18,680
that actually did make that change with

00:15:16,850 --> 00:15:21,100
this chef run should happen successfully

00:15:18,680 --> 00:15:21,100
everyone good

00:15:23,040 --> 00:15:35,140
and then you should verify it's the way

00:15:26,740 --> 00:15:41,710
that you want it to look all right so on

00:15:35,140 --> 00:15:54,690
your host on your workstation so run

00:15:41,710 --> 00:15:57,160
knife cookbook site install chef client

00:15:54,690 --> 00:16:02,380
and this is probably going to chin

00:15:57,160 --> 00:16:06,160
complain yes so this complains the

00:16:02,380 --> 00:16:08,290
reason why this complains and like we

00:16:06,160 --> 00:16:10,930
can we can debate version control

00:16:08,290 --> 00:16:15,730
systems if we want to but let's just we

00:16:10,930 --> 00:16:17,590
use get by default so sorry this the

00:16:15,730 --> 00:16:19,570
nice thing is is that when you run knife

00:16:17,590 --> 00:16:21,220
cookbook site install it actually

00:16:19,570 --> 00:16:23,020
downloads all the dependencies for you

00:16:21,220 --> 00:16:28,720
as well there's another tool called

00:16:23,020 --> 00:16:30,400
burke shelf so be e RK shelf which will

00:16:28,720 --> 00:16:33,550
actually help you do dependency

00:16:30,400 --> 00:16:35,290
management as well oh so you're going to

00:16:33,550 --> 00:16:37,420
use either one of those tools but a lot

00:16:35,290 --> 00:16:39,610
of the stuff in some cases of what we do

00:16:37,420 --> 00:16:44,290
are hooked very closely and to get at

00:16:39,610 --> 00:16:47,560
times so if we do get an it we're going

00:16:44,290 --> 00:16:52,240
to knit the repository if we run this

00:16:47,560 --> 00:16:54,040
command again it's going to complain so

00:16:52,240 --> 00:16:58,020
we actually have to do a commit so we do

00:16:54,040 --> 00:16:58,020
get add star

00:17:02,750 --> 00:17:10,579
and then get oh it's get not installed

00:17:07,280 --> 00:17:22,250
on your workstation Oh on his

00:17:10,579 --> 00:17:24,980
windows windows users yeah I know so the

00:17:22,250 --> 00:17:35,720
other way that you can do this is you

00:17:24,980 --> 00:17:37,490
can do knife cookbook site download the

00:17:35,720 --> 00:17:40,010
problem if you do this is it doesn't

00:17:37,490 --> 00:17:41,660
download any dependencies and the chef

00:17:40,010 --> 00:17:47,630
client cookbook actually has several

00:17:41,660 --> 00:17:52,280
dependencies that you need so it's not

00:17:47,630 --> 00:17:54,640
the most what's the word optimal way of

00:17:52,280 --> 00:17:54,640
doing it

00:18:24,630 --> 00:18:34,740
so inside of this one thing I didn't say

00:18:30,610 --> 00:18:37,840
one thing I didn't mention is that

00:18:34,740 --> 00:18:40,960
there's this file called metadata RB and

00:18:37,840 --> 00:18:47,530
this metadata RB shows you a different

00:18:40,960 --> 00:18:49,540
various things so it has the name the

00:18:47,530 --> 00:18:51,730
maintainer the email what license that

00:18:49,540 --> 00:18:53,290
this cookbooks under it also has the

00:18:51,730 --> 00:18:55,630
version number so as you're making

00:18:53,290 --> 00:18:58,150
changes to the cookbooks you should be

00:18:55,630 --> 00:19:00,309
bumping this version number and then you

00:18:58,150 --> 00:19:01,900
upload it to the chef server and then

00:19:00,309 --> 00:19:03,940
it's got different versions that it

00:19:01,900 --> 00:19:05,470
actually maintains for you so you can

00:19:03,940 --> 00:19:06,549
actually use different versions on

00:19:05,470 --> 00:19:07,840
different servers and different

00:19:06,549 --> 00:19:12,309
environments and things like that if you

00:19:07,840 --> 00:19:14,830
want to the other thing that you'll

00:19:12,309 --> 00:19:23,620
notice inside of here is that it's got

00:19:14,830 --> 00:19:26,080
dependencies so this depends upon this

00:19:23,620 --> 00:19:30,360
depends upon cron it also depends upon

00:19:26,080 --> 00:19:30,360
logrotate I thought it depended upon

00:19:30,750 --> 00:19:37,510
windows as well but maybe not on this

00:19:32,950 --> 00:19:40,630
version so what we can actually do since

00:19:37,510 --> 00:19:46,540
we don't maybe you don't want to use git

00:19:40,630 --> 00:19:51,130
we can download cron so the first

00:19:46,540 --> 00:19:55,780
command is knife site cookbook download

00:19:51,130 --> 00:19:59,049
chef client knife cookbook site download

00:19:55,780 --> 00:20:08,049
cron and then knife cookbook site

00:19:59,049 --> 00:20:12,160
download log rotate and I assume you all

00:20:08,049 --> 00:20:13,510
know how to here at a free and open

00:20:12,160 --> 00:20:16,740
source conference I hope you would know

00:20:13,510 --> 00:20:16,740
how to extract a tarball

00:20:22,550 --> 00:20:31,370
oh I'm in the wrong directory oh I made

00:20:29,090 --> 00:20:33,260
a bad mistake so I'm in the wrong

00:20:31,370 --> 00:20:38,420
directory and I downloaded this stuff oh

00:20:33,260 --> 00:20:40,970
well so you want these you want these

00:20:38,420 --> 00:20:44,300
extracted tar balls into your cookbooks

00:20:40,970 --> 00:20:48,830
directory I was in my chef client

00:20:44,300 --> 00:21:01,000
cookbook and I extracted these so I need

00:20:48,830 --> 00:21:03,050
to remove them so you want your

00:21:01,000 --> 00:21:06,560
cookbooks directory to look like this

00:21:03,050 --> 00:21:08,330
now so you want chef client Apache cron

00:21:06,560 --> 00:21:11,740
and logrotate and plus these other

00:21:08,330 --> 00:21:11,740
things that we put in there by default

00:21:42,909 --> 00:21:48,399
and after you do that if you do knife

00:21:45,190 --> 00:21:51,039
cookbook upload dash all or I cheat and

00:21:48,399 --> 00:21:53,739
do star which is not the best way to do

00:21:51,039 --> 00:21:57,460
it because you get errors like this if

00:21:53,739 --> 00:22:05,919
you do dash all then it'll actually like

00:21:57,460 --> 00:22:09,940
this it'll upload all your cookbooks so

00:22:05,919 --> 00:22:13,330
you need to get 34 close chef client

00:22:09,940 --> 00:22:16,479
cron and blogger take and this we gotta

00:22:13,330 --> 00:22:18,849
extract the directory yeah yeah yeah

00:22:16,479 --> 00:22:21,099
this is because we're not using get in

00:22:18,849 --> 00:22:22,840
this environment so instead of like

00:22:21,099 --> 00:22:25,479
making everyone got would get and

00:22:22,840 --> 00:22:29,440
installed yet this is the poor man's way

00:22:25,479 --> 00:22:31,149
of dependency resolution the way so like

00:22:29,440 --> 00:22:33,489
the way you want to do this is you want

00:22:31,149 --> 00:22:37,149
to be using burke shelf but like on a

00:22:33,489 --> 00:22:39,460
intro to chef hey let's throw dependency

00:22:37,149 --> 00:22:41,259
management solutions at you and like a

00:22:39,460 --> 00:22:43,470
bunch of other stuff it's just not

00:22:41,259 --> 00:22:43,470
useful

00:22:47,030 --> 00:22:54,230
so now we've got these three recipes our

00:22:51,680 --> 00:22:57,640
cookbooks uploaded let me know when

00:22:54,230 --> 00:22:57,640
everyone's caught up and we'll continue

00:24:17,639 --> 00:24:22,369
so I'm doing something else Oh ignore

00:24:20,009 --> 00:24:22,369
what

00:25:21,460 --> 00:25:25,120
so let me know when you guys have the

00:25:23,710 --> 00:25:27,309
cookbooks uploaded when you have the

00:25:25,120 --> 00:25:29,760
cookbooks uploaded what you need to do

00:25:27,309 --> 00:25:32,980
is you need a copy what's on the screen

00:25:29,760 --> 00:25:35,409
you need to go into your roles directory

00:25:32,980 --> 00:25:40,080
and you need to go in and create a file

00:25:35,409 --> 00:25:44,440
and i called it base JSON and then

00:25:40,080 --> 00:25:49,870
create this skeleton that's going to

00:25:44,440 --> 00:25:52,320
configure the chef client to actually

00:25:49,870 --> 00:25:52,320
run correctly

00:26:05,910 --> 00:26:10,380
so there's a bunch of attributes that I

00:26:08,370 --> 00:26:14,100
are two attributes that I'm passing in

00:26:10,380 --> 00:26:16,020
so this is we're creating a role and

00:26:14,100 --> 00:26:21,060
then we'll apply this role to our server

00:26:16,020 --> 00:26:23,070
and we're overriding attributes in the

00:26:21,060 --> 00:26:24,930
chef client cookbook and we're

00:26:23,070 --> 00:26:28,410
overriding interval and we're overriding

00:26:24,930 --> 00:26:32,760
what's called display interval is how

00:26:28,410 --> 00:26:36,390
often will run and thence play is will

00:26:32,760 --> 00:26:39,660
run every 300 seconds plus or minus 30

00:26:36,390 --> 00:26:41,700
seconds so 270 seconds to three hundred

00:26:39,660 --> 00:26:43,620
and thirty seconds so the idea is that

00:26:41,700 --> 00:26:46,260
we put up the kind of a random seed in

00:26:43,620 --> 00:26:48,120
there so that if everybody came up at

00:26:46,260 --> 00:26:50,370
once we're not hitting the chef server

00:26:48,120 --> 00:26:56,760
all of the exact same time every five

00:26:50,370 --> 00:26:58,800
minutes and then I'll show you where I

00:26:56,760 --> 00:27:01,730
found this information to like know what

00:26:58,800 --> 00:27:01,730
to put into this file

00:27:32,240 --> 00:27:36,570
it's funny I guys signed up for a new

00:27:34,500 --> 00:27:40,830
shelf account and so I got our welcome

00:27:36,570 --> 00:27:49,920
email need help with chef yeah which is

00:27:40,830 --> 00:27:55,080
all automated right so let me know when

00:27:49,920 --> 00:27:57,330
you guys have this summer faster typer

00:27:55,080 --> 00:28:01,350
is another if you already have this

00:27:57,330 --> 00:28:03,120
which you can do is save it and then try

00:28:01,350 --> 00:28:07,730
and figure out how to upload it to the

00:28:03,120 --> 00:28:07,730
server so knife roll from file filename

00:28:10,550 --> 00:28:16,230
so let's talk about where we get these

00:28:12,690 --> 00:28:23,060
attributes from you need to copy this

00:28:16,230 --> 00:28:23,060
still okay sorry I'll pause for a second

00:28:30,470 --> 00:28:37,640
so if i go and look at in my chef server

00:28:33,780 --> 00:28:37,640
i can see

00:28:54,780 --> 00:28:58,910
is not behaving the way it's supposed to

00:29:05,350 --> 00:29:10,000
so you should be able to go into a

00:29:07,419 --> 00:29:13,200
cookbook I don't know why this isn't

00:29:10,000 --> 00:29:19,600
working and you should be able to see

00:29:13,200 --> 00:29:21,580
all of its information here and if the

00:29:19,600 --> 00:29:25,830
cookbook is written properly so there's

00:29:21,580 --> 00:29:27,850
a readme md and you should write

00:29:25,830 --> 00:29:29,590
documentation so people actually know

00:29:27,850 --> 00:29:31,720
how to use and consume your cookbook and

00:29:29,590 --> 00:29:35,710
that's shown in the chef's manage

00:29:31,720 --> 00:29:40,390
console it should also be shown sorry

00:29:35,710 --> 00:29:42,280
guys if you go to the github repo for a

00:29:40,390 --> 00:29:45,610
cookbook or if you go to community

00:29:42,280 --> 00:29:46,960
Opscode calm and look at a cookbook then

00:29:45,610 --> 00:29:55,299
you'll see that readme file they're

00:29:46,960 --> 00:29:57,789
displayed as well the other thing is you

00:29:55,299 --> 00:30:00,640
could tune this down to maybe like 30

00:29:57,789 --> 00:30:02,350
seconds and so as we're making changes

00:30:00,640 --> 00:30:04,679
you can actually can pick things up

00:30:02,350 --> 00:30:04,679
quicker

00:30:19,230 --> 00:30:25,350
sniffing i modified this from another

00:30:22,510 --> 00:30:25,350
one so it could be wrong

00:30:49,710 --> 00:30:55,010
with this underscore ya know that's

00:30:52,409 --> 00:30:55,010
supposed to mean

00:30:56,830 --> 00:31:00,000
back club with that

00:32:06,390 --> 00:32:10,200
yeah but it shouldn't matter

00:33:05,929 --> 00:33:10,820
so there's two different ways that you

00:33:07,730 --> 00:33:13,580
can actually write this these roles you

00:33:10,820 --> 00:33:16,669
can actually write them as Ruby code you

00:33:13,580 --> 00:33:19,909
can also write them as JSON files the

00:33:16,669 --> 00:33:22,340
Ruby code is actually interpreted at

00:33:19,909 --> 00:33:24,289
when it's uploaded so you can actually

00:33:22,340 --> 00:33:26,360
write Ruby in there if you needed to do

00:33:24,289 --> 00:33:28,429
something more complicated and then it

00:33:26,360 --> 00:33:31,460
gets turned into JSON when it's actually

00:33:28,429 --> 00:33:33,289
uploaded to the server the problem is is

00:33:31,460 --> 00:33:34,669
that you can only then download JSON

00:33:33,289 --> 00:33:38,350
from the server you can't actually

00:33:34,669 --> 00:33:38,350
download the raw Ruby anymore

00:33:43,910 --> 00:33:46,910
file

00:33:48,679 --> 00:33:55,509
once the dollars in north but what's the

00:33:52,940 --> 00:33:55,509
difference in your

00:33:58,169 --> 00:34:02,859
if you're going straight to

00:34:00,190 --> 00:34:04,659
specification oh i thought you said to

00:34:02,859 --> 00:34:09,210
get rid of a different color no that is

00:34:04,659 --> 00:34:09,210
that ok so get rid of that comma

00:34:13,760 --> 00:34:16,540
very go

00:34:17,310 --> 00:34:21,210
so there's a couple different ways we

00:34:20,040 --> 00:34:24,750
can do this now let's do it through the

00:34:21,210 --> 00:34:27,990
console just for the hell of it I should

00:34:24,750 --> 00:34:31,110
now see that role and I can drill down

00:34:27,990 --> 00:34:33,120
into that role and this is actually

00:34:31,110 --> 00:34:35,820
giving me an error because mike says my

00:34:33,120 --> 00:34:38,160
cookbooks not here but then I can also

00:34:35,820 --> 00:34:40,770
see my attributes so there's the

00:34:38,160 --> 00:34:44,700
attributes that I've defined and now I

00:34:40,770 --> 00:34:48,390
can actually go to my node and I can

00:34:44,700 --> 00:34:50,490
edit the run list and I can actually

00:34:48,390 --> 00:34:54,020
drag that onto it so your run list

00:34:50,490 --> 00:34:54,020
should now look like this yeah

00:34:59,230 --> 00:35:04,300
and if you saved a run lift then you

00:35:01,900 --> 00:35:06,160
need to go one last time you need to go

00:35:04,300 --> 00:35:08,260
to the node and run the sous-chef client

00:35:06,160 --> 00:35:12,640
and then after that it will periodically

00:35:08,260 --> 00:35:14,200
check it and if you made it 30 when

00:35:12,640 --> 00:35:15,970
you're done here go back and change it

00:35:14,200 --> 00:35:18,220
because otherwise you're going to be

00:35:15,970 --> 00:35:23,470
found in our server every 30 seconds so

00:35:18,220 --> 00:35:25,619
not like we can't handle it but just be

00:35:23,470 --> 00:35:25,619
nice

00:35:26,690 --> 00:35:30,260
yes so you can do it two different ways

00:35:28,670 --> 00:35:36,440
you can edit there or you can pull that

00:35:30,260 --> 00:35:38,589
on the gear edit from us and then drag

00:35:36,440 --> 00:35:41,410
server-based over

00:35:38,589 --> 00:35:43,960
so so this is going to be executed in

00:35:41,410 --> 00:35:48,999
the way that you specify it right so

00:35:43,960 --> 00:35:53,440
kind of the way that we suggest things

00:35:48,999 --> 00:35:57,670
get setup is let me go back to what I

00:35:53,440 --> 00:36:05,079
was working on earlier so this is kind

00:35:57,670 --> 00:36:07,210
of an environment that we have so I've

00:36:05,079 --> 00:36:10,859
got a whole bunch of different roles for

00:36:07,210 --> 00:36:13,119
this environment and I have a couple

00:36:10,859 --> 00:36:16,539
ones that are kind of like the base

00:36:13,119 --> 00:36:19,210
getting started type roles and so I have

00:36:16,539 --> 00:36:21,519
one called server base and then I have a

00:36:19,210 --> 00:36:24,640
bun to base and I have sinned toast base

00:36:21,519 --> 00:36:26,799
right so if I'm running on a set-top box

00:36:24,640 --> 00:36:29,380
by default I want to put in sent off

00:36:26,799 --> 00:36:32,799
base if I'm running on an ubuntu box I

00:36:29,380 --> 00:36:37,210
want to put on ubuntu base then anything

00:36:32,799 --> 00:36:38,619
common between ubuntu and cintas yes

00:36:37,210 --> 00:36:41,170
there are some things that are common

00:36:38,619 --> 00:36:45,660
and that might be shared you would use

00:36:41,170 --> 00:36:51,489
server bits so if I actually look at a

00:36:45,660 --> 00:36:53,799
new bunch of base you can see what it

00:36:51,489 --> 00:36:56,589
actually includes is it be the

00:36:53,799 --> 00:36:59,200
uniqueness is that it needs apps right

00:36:56,589 --> 00:37:02,259
they can't install that on centos box

00:36:59,200 --> 00:37:06,089
right then it sucks in the role server

00:37:02,259 --> 00:37:09,190
base right so roles can call other roles

00:37:06,089 --> 00:37:11,469
so anytime I set up in ubuntu box I'm

00:37:09,190 --> 00:37:14,769
going to install this role on to it and

00:37:11,469 --> 00:37:22,559
then it'll get server-based whenever I

00:37:14,769 --> 00:37:25,930
do a set-top box I do cintas base and

00:37:22,559 --> 00:37:28,150
it's going to give me the only

00:37:25,930 --> 00:37:30,700
difference between you bunt to in this

00:37:28,150 --> 00:37:34,390
case that we care about is that one day

00:37:30,700 --> 00:37:35,660
is young and one needs apps it's

00:37:34,390 --> 00:37:39,930
basically in here

00:37:35,660 --> 00:37:43,830
yes yeah so server base is something

00:37:39,930 --> 00:37:45,270
that's like very like standard crap that

00:37:43,830 --> 00:37:47,790
needs to get installed before you can do

00:37:45,270 --> 00:37:50,790
anything else in your run list if you

00:37:47,790 --> 00:37:52,080
put it at the bottom all that base level

00:37:50,790 --> 00:37:54,750
stuff that might need to take place

00:37:52,080 --> 00:37:57,990
before something else happens wouldn't

00:37:54,750 --> 00:37:59,970
happen at the end so base type stuff

00:37:57,990 --> 00:38:01,860
like a bunch of base centos based server

00:37:59,970 --> 00:38:04,170
base needs to go to the top of your run

00:38:01,860 --> 00:38:06,000
list so you get everything set up the

00:38:04,170 --> 00:38:07,410
way you want it to and then you have

00:38:06,000 --> 00:38:12,030
your recipes run to configure your

00:38:07,410 --> 00:38:13,890
application make sense yeah now if you

00:38:12,030 --> 00:38:17,940
run if you ran chef honey did you guys

00:38:13,890 --> 00:38:21,390
run chef client on the dough since dude

00:38:17,940 --> 00:38:22,830
yes so run sudo chef client and you

00:38:21,390 --> 00:38:26,130
should get a new recipe that's going to

00:38:22,830 --> 00:38:31,590
get installed and it's going to be the

00:38:26,130 --> 00:38:34,380
shop client recipe get his rule where

00:38:31,590 --> 00:38:36,800
does it get the role did you put it on

00:38:34,380 --> 00:38:36,800
the run us

00:38:39,369 --> 00:38:49,509
imported the rules good ships mm-hmm

00:38:43,079 --> 00:38:54,339
okay so go into notes and then click on

00:38:49,509 --> 00:38:56,349
the gear and SE queda from but this is

00:38:54,339 --> 00:38:58,029
just another way of doing it and then

00:38:56,349 --> 00:39:03,789
drag server base over and make sure it's

00:38:58,029 --> 00:39:06,700
before watching and save it and then go

00:39:03,789 --> 00:39:14,470
run stuff client and so you should see a

00:39:06,700 --> 00:39:17,799
lot more output yeah and what did you

00:39:14,470 --> 00:39:20,109
set your interval to 30 seconds yeah I

00:39:17,799 --> 00:39:22,630
don't want it to 3000 later yeah yeah

00:39:20,109 --> 00:39:24,190
that's time so now you should be able to

00:39:22,630 --> 00:39:25,569
see like if you go to the recording

00:39:24,190 --> 00:39:30,730
console you'll see a chucking it

00:39:25,569 --> 00:39:32,589
periodically the other thing is now go

00:39:30,730 --> 00:39:36,160
to your attributes either do a knife

00:39:32,589 --> 00:39:40,329
note show your node name and do a long

00:39:36,160 --> 00:39:42,099
listing or go into the web UI and you

00:39:40,329 --> 00:39:46,630
can pull down attributes and you should

00:39:42,099 --> 00:39:48,369
see chef client there and so this is an

00:39:46,630 --> 00:39:54,340
example of how the recipe is actually

00:39:48,369 --> 00:39:56,920
overriding yeah

00:39:54,340 --> 00:40:04,780
yeah the other thing that you'll notice

00:39:56,920 --> 00:40:07,630
is that so when you do your run list

00:40:04,780 --> 00:40:10,810
only says server base when that's

00:40:07,630 --> 00:40:12,970
evaluated it actually expands out and so

00:40:10,810 --> 00:40:14,890
you'll notice when you do a knife note

00:40:12,970 --> 00:40:17,470
show you actually get a long list of

00:40:14,890 --> 00:40:19,510
recipes and this is actually the

00:40:17,470 --> 00:40:20,950
evaluated list from all of the roles

00:40:19,510 --> 00:40:23,350
that are actually running on that

00:40:20,950 --> 00:40:26,200
machine right and anything it depends

00:40:23,350 --> 00:40:28,150
upon anything that's important so what's

00:40:26,200 --> 00:40:33,540
interesting is if we actually look at

00:40:28,150 --> 00:40:33,540
the chef client cookbook

00:40:41,619 --> 00:40:46,799
so if i go into cookbooks and look at

00:40:44,049 --> 00:40:46,799
chef client

00:40:55,230 --> 00:41:01,740
I actually don't do anything I in this

00:40:58,320 --> 00:41:05,130
default it just says include recipe chef

00:41:01,740 --> 00:41:08,040
client service it's like one line right

00:41:05,130 --> 00:41:10,470
and so what ends up happening is I can

00:41:08,040 --> 00:41:13,520
actually kind of walk the chain and now

00:41:10,470 --> 00:41:13,520
I look at service

00:41:19,200 --> 00:41:25,109
what it does is it automatically

00:41:21,630 --> 00:41:27,180
determines based upon where it's running

00:41:25,109 --> 00:41:29,940
and the note and what a knit style you

00:41:27,180 --> 00:41:34,920
said you wanted it to use it actually

00:41:29,940 --> 00:41:36,990
will include recipe chef client whatever

00:41:34,920 --> 00:41:39,839
this variable name is and it includes

00:41:36,990 --> 00:41:44,010
yet another recipe right because we have

00:41:39,839 --> 00:41:46,890
all of these different we've done a

00:41:44,010 --> 00:41:51,630
great job of like consolidating down to

00:41:46,890 --> 00:41:53,730
like one in it service so if you're

00:41:51,630 --> 00:41:57,050
running on you know solaris you need to

00:41:53,730 --> 00:42:00,089
use us as I'm up right or you run it or

00:41:57,050 --> 00:42:01,680
D or an inn right everyone where you're

00:42:00,089 --> 00:42:03,300
running you're running on Windows you

00:42:01,680 --> 00:42:05,910
need to be able to run as a Windows

00:42:03,300 --> 00:42:08,040
service so what will happen is is this

00:42:05,910 --> 00:42:09,960
will get replaced in and a Napoleon yet

00:42:08,040 --> 00:42:12,119
another recipe so if you look at your

00:42:09,960 --> 00:42:13,859
recipes line of your node you'll see

00:42:12,119 --> 00:42:16,020
what recipe is actually determined it

00:42:13,859 --> 00:42:19,160
needed to pull in I'm thinking made up

00:42:16,020 --> 00:42:19,160
hold and run it or an it

00:42:21,319 --> 00:42:30,690
yeah yeah because I think that's the

00:42:26,099 --> 00:42:33,690
default one that this gets up to so if

00:42:30,690 --> 00:42:37,470
you wanted to change the anit style

00:42:33,690 --> 00:42:43,710
because you use launch d right because

00:42:37,470 --> 00:42:47,220
your i did that on purpose right so you

00:42:43,710 --> 00:42:49,079
would override in your role you would

00:42:47,220 --> 00:42:52,130
then put another attribute in there an

00:42:49,079 --> 00:42:54,960
it style equals one of these values

00:42:52,130 --> 00:42:58,369
right and then the recipe would get

00:42:54,960 --> 00:42:58,369
pulled in correctly ought to handle them

00:43:05,310 --> 00:43:13,010
so it's like 430 so you guys want to

00:43:09,630 --> 00:43:15,240
wrap it up so like we're at a good place

00:43:13,010 --> 00:43:18,180
the other cool thing that you guys

00:43:15,240 --> 00:43:29,310
should check out in the kind of the

00:43:18,180 --> 00:43:38,430
meantime is this um nice es stack so if

00:43:29,310 --> 00:43:40,140
you run knife CS stack it's actually

00:43:38,430 --> 00:43:42,600
going to complain but they're stacked

00:43:40,140 --> 00:43:45,120
create stack delete that you'll see here

00:43:42,600 --> 00:43:47,700
and you can actually now now you have a

00:43:45,120 --> 00:43:51,150
chef server now you have a CloudStack

00:43:47,700 --> 00:43:53,820
cloud you can actually build these JSON

00:43:51,150 --> 00:43:57,260
documents that basically allows you to

00:43:53,820 --> 00:44:01,320
define that I have this run list i won

00:43:57,260 --> 00:44:04,740
you know in your case server base recipe

00:44:01,320 --> 00:44:07,620
Apache and what will happen is if you

00:44:04,740 --> 00:44:11,250
put this in as the JSON file that you

00:44:07,620 --> 00:44:15,690
want it'll actually go and launch to web

00:44:11,250 --> 00:44:17,490
servers for you and automatically and

00:44:15,690 --> 00:44:21,870
then automatically apply this run list

00:44:17,490 --> 00:44:24,290
to it as well so something interesting

00:44:21,870 --> 00:44:24,290
to check out

00:44:26,330 --> 00:44:33,580
any questions stand aside yes I will

00:44:31,100 --> 00:44:33,580
send the slides

00:44:35,800 --> 00:44:38,340
Allah

00:44:41,260 --> 00:44:47,530
I can get the list of female attendees

00:44:44,710 --> 00:44:55,870
from shabash pneus I just send it off

00:44:47,530 --> 00:44:58,270
everyone thanks guys yeah yeah not

00:44:55,870 --> 00:45:02,230
really other people may not be exorcism

00:44:58,270 --> 00:45:06,750
not invited okay one question how did

00:45:02,230 --> 00:45:10,600
you manage as far as the actual

00:45:06,750 --> 00:45:13,410
employments ago when you're in an

00:45:10,600 --> 00:45:16,000
environment like this chef manager

00:45:13,410 --> 00:45:17,530
setting up like a shaft instance that's

00:45:16,000 --> 00:45:22,290
ended your father than kind of executing

00:45:17,530 --> 00:45:25,900
from there this like chef master yeah so

00:45:22,290 --> 00:45:28,720
you could so if you give multiple cloud

00:45:25,900 --> 00:45:30,910
environments right then chef manage like

00:45:28,720 --> 00:45:34,960
the hosted part is nice because you get

00:45:30,910 --> 00:45:37,120
less one place to go right or the

00:45:34,960 --> 00:45:39,700
alternative is you can install the exact

00:45:37,120 --> 00:45:40,840
same stuff in your data center so you

00:45:39,700 --> 00:45:42,640
can either install the open source

00:45:40,840 --> 00:45:44,500
version or you can install the

00:45:42,640 --> 00:45:46,000
enterprise version which gets you the

00:45:44,500 --> 00:45:48,040
pretty gooey and recording and some

00:45:46,000 --> 00:45:49,390
other features as well or your interests

00:45:48,040 --> 00:45:51,700
in saw the open source version which

00:45:49,390 --> 00:45:54,850
gives you a CLIA other basic thing that

00:45:51,700 --> 00:45:56,200
you need as well and so basically what

00:45:54,850 --> 00:45:58,540
you would end up doing is putting it

00:45:56,200 --> 00:46:00,490
into each data center or each location

00:45:58,540 --> 00:46:02,890
that you would need to a summer Chuck

00:46:00,490 --> 00:46:05,350
server and then ideally what you would

00:46:02,890 --> 00:46:07,330
want is all of your infrastructure code

00:46:05,350 --> 00:46:10,630
and source source control somewhere and

00:46:07,330 --> 00:46:12,430
then setting up a process to where the

00:46:10,630 --> 00:46:14,200
source control automatically syncs with

00:46:12,430 --> 00:46:15,820
the shop server okay that was going to

00:46:14,200 --> 00:46:19,180
do my gosh it was how are you can you

00:46:15,820 --> 00:46:21,100
pull your custom builds on yeah so you

00:46:19,180 --> 00:46:26,940
need a separate you want to try a

00:46:21,100 --> 00:46:26,940
retreat d what do you call it do

00:46:27,359 --> 00:46:32,559
the source control as the sink the

00:46:30,339 --> 00:46:34,660
source of record the source of truth and

00:46:32,559 --> 00:46:36,339
then your chef servers automatically get

00:46:34,660 --> 00:46:38,739
updated from that source of truth of it

00:46:36,339 --> 00:46:40,839
by like you know yeah Jenkins or whoever

00:46:38,739 --> 00:46:45,039
doing it right in an automated way yeah

00:46:40,839 --> 00:46:47,680
one of the CIS yeah I go yep and then

00:46:45,039 --> 00:46:49,299
the other idea is that I mean the way

00:46:47,680 --> 00:46:51,539
Facebook does it is they just have a

00:46:49,299 --> 00:46:54,160
bash script that does it for them

00:46:51,539 --> 00:46:55,839
everything comes like to bash yeah at

00:46:54,160 --> 00:46:57,309
some point especially like if you're not

00:46:55,839 --> 00:47:00,309
using a groupie environment where you're

00:46:57,309 --> 00:47:06,819
right yes yeah yeah exactly you got to

00:47:00,309 --> 00:47:08,019
do something yeah um but look it so look

00:47:06,819 --> 00:47:09,519
at berk shell because it'll make your

00:47:08,019 --> 00:47:11,289
life easier for like a dependency

00:47:09,519 --> 00:47:13,599
management perspective yeah and then

00:47:11,289 --> 00:47:15,819
there's hooks into vagrant as well so

00:47:13,599 --> 00:47:18,009
yeah well that's the chef I played with

00:47:15,819 --> 00:47:19,989
a bigger yes kind of the opposite

00:47:18,009 --> 00:47:21,910
approach to learn it I really understand

00:47:19,989 --> 00:47:23,589
chef it was like okay we're going to use

00:47:21,910 --> 00:47:25,809
vagrant and then chefs going to help us

00:47:23,589 --> 00:47:28,349
yeah a couple small things and then it's

00:47:25,809 --> 00:47:31,509
in some cases that shelf solo as well

00:47:28,349 --> 00:47:32,680
I'm not using my shelf server yeah I

00:47:31,509 --> 00:47:34,959
think that's what I was using the

00:47:32,680 --> 00:47:37,829
Johnson you know about the configuration

00:47:34,959 --> 00:47:37,829
yep exactly

00:47:39,060 --> 00:47:45,730
thankful so so with the code without you

00:47:43,120 --> 00:47:49,390
to pull the code that I be a template as

00:47:45,730 --> 00:47:52,030
a part of the service structure where do

00:47:49,390 --> 00:47:54,670
you make on like if you were going to do

00:47:52,030 --> 00:47:57,070
I would assume you would do a full

00:47:54,670 --> 00:47:59,830
client side on the nose that you play so

00:47:57,070 --> 00:48:03,550
that I could go out and then grab from

00:47:59,830 --> 00:48:05,080
the integration server so if not just be

00:48:03,550 --> 00:48:10,420
a template will combat in the great room

00:48:05,080 --> 00:48:13,330
the UH the pole so the nodes themselves

00:48:10,420 --> 00:48:15,700
hold up a chef server okay and then the

00:48:13,330 --> 00:48:17,710
chef server needs to pull down from the

00:48:15,700 --> 00:48:21,160
git repository or has any other public

00:48:17,710 --> 00:48:22,930
order and the nodes continue to sink to

00:48:21,160 --> 00:48:25,030
the chef server okay because then that

00:48:22,930 --> 00:48:26,770
way you get the capabilities of search

00:48:25,030 --> 00:48:29,440
and things like that that means more

00:48:26,770 --> 00:48:32,080
stuff yet one last question no that's

00:48:29,440 --> 00:48:34,680
like um how do you approach dealing with

00:48:32,080 --> 00:48:36,130
like a content distribution network

00:48:34,680 --> 00:48:39,310
environment

00:48:36,130 --> 00:48:42,760
are there kind of pre-built recipes or

00:48:39,310 --> 00:48:45,430
cookbooks for that or so what are you

00:48:42,760 --> 00:48:46,780
distributing in the CBI well like it

00:48:45,430 --> 00:48:49,050
just portions of the app or rendered

00:48:46,780 --> 00:48:52,060
statically and you're pushing those out

00:48:49,050 --> 00:48:53,620
you have to link those those dynamic

00:48:52,060 --> 00:48:54,850
buckets that are created I don't know

00:48:53,620 --> 00:48:56,890
what those who are elves are going to be

00:48:54,850 --> 00:49:01,150
necessarily ahead of time that there's

00:48:56,890 --> 00:49:02,880
no like a group of the bucket so what

00:49:01,150 --> 00:49:06,250
I'm asking is kind of like how do you

00:49:02,880 --> 00:49:07,810
integrate that with that the same style

00:49:06,250 --> 00:49:10,000
of thing where you're like setting the

00:49:07,810 --> 00:49:13,750
configuration it's getting passed out to

00:49:10,000 --> 00:49:19,390
the chef client so that's CDN endpoint

00:49:13,750 --> 00:49:22,540
right so I guess somebody needs to tell

00:49:19,390 --> 00:49:25,720
the chef client or the recipe what its

00:49:22,540 --> 00:49:27,430
final URL will be now if you're doing

00:49:25,720 --> 00:49:29,140
like redirects or something there's

00:49:27,430 --> 00:49:31,240
something called remote file so it's a

00:49:29,140 --> 00:49:32,650
resource called remote file and so if

00:49:31,240 --> 00:49:35,470
there's an artifact you need to download

00:49:32,650 --> 00:49:38,050
you can point to a URL and it'll

00:49:35,470 --> 00:49:40,390
download it and so if the CDN is smart

00:49:38,050 --> 00:49:42,640
enough to where it's doing DNS redirects

00:49:40,390 --> 00:49:44,950
or something like that then to get it to

00:49:42,640 --> 00:49:46,780
the right point then that would be

00:49:44,950 --> 00:49:48,100
sufficient enough the other thing that

00:49:46,780 --> 00:49:50,680
you could do is there's something called

00:49:48,100 --> 00:49:52,330
beta bags and so you could write out of

00:49:50,680 --> 00:49:54,400
data bag somebody could write out the

00:49:52,330 --> 00:49:57,010
data bag of where the current CEO at

00:49:54,400 --> 00:49:59,650
location is or something like that all

00:49:57,010 --> 00:50:02,410
right whatever whoever needs to use what

00:49:59,650 --> 00:50:04,600
and the chef clients when it runs can

00:50:02,410 --> 00:50:06,790
actually query that data bag to get that

00:50:04,600 --> 00:50:08,380
information back like this is wearing

00:50:06,790 --> 00:50:10,330
this is my endpoint that I need to use

00:50:08,380 --> 00:50:11,200
today okay and you could use a data back

00:50:10,330 --> 00:50:13,869
for anything

00:50:11,200 --> 00:50:15,849
could configure and not made a passion

00:50:13,869 --> 00:50:18,160
inside yeah yeah you need a pole like

00:50:15,849 --> 00:50:20,170
database stuff that wasn't a part of the

00:50:18,160 --> 00:50:22,060
repository remain script to do it that

00:50:20,170 --> 00:50:26,520
way as well yeah so data bags are

00:50:22,060 --> 00:50:30,970
interesting in that data bags are just

00:50:26,520 --> 00:50:32,950
json objects okay and so I've got a

00:50:30,970 --> 00:50:36,070
couple data bags one for users and one

00:50:32,950 --> 00:50:38,230
for groups and if i go into users i have

00:50:36,070 --> 00:50:43,359
two data bag items one is Bobo and want

00:50:38,230 --> 00:50:46,960
to spring and if I cap Frank you can see

00:50:43,359 --> 00:50:49,150
that it's just data right so string data

00:50:46,960 --> 00:50:51,930
and then that can be consumed and

00:50:49,150 --> 00:50:54,670
searched upon so you would search for

00:50:51,930 --> 00:50:58,030
users because users is actually my data

00:50:54,670 --> 00:51:00,490
bag and then my query I could query on

00:50:58,030 --> 00:51:02,650
any one of these fields to say alright

00:51:00,490 --> 00:51:04,810
search users and give me where the ID is

00:51:02,650 --> 00:51:08,170
equal to frame and that would return

00:51:04,810 --> 00:51:11,800
right that makes sense yeah that's

00:51:08,170 --> 00:51:14,950
awesome these are enemies can be

00:51:11,800 --> 00:51:17,260
encrypted as well so if there's password

00:51:14,950 --> 00:51:20,079
data or something everything except ID

00:51:17,260 --> 00:51:25,359
will get encrypted ok and then it will

00:51:20,079 --> 00:51:28,450
be decrypted at runtime on the note so

00:51:25,359 --> 00:51:32,849
common use cases like database passwords

00:51:28,450 --> 00:51:32,849
or something right yeah yeah yeah

00:51:33,499 --> 00:51:42,569
thank you oh cool glad it was useful

00:51:36,559 --> 00:51:43,799
lost 75 person in the class yeah those

00:51:42,569 --> 00:51:47,269
are those are the ones that just

00:51:43,799 --> 00:51:47,269

YouTube URL: https://www.youtube.com/watch?v=Hpo098u0yuI


