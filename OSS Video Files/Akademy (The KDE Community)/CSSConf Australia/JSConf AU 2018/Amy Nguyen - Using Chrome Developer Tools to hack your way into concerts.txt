Title: Amy Nguyen - Using Chrome Developer Tools to hack your way into concerts
Publication date: 2018-04-11
Playlist: JSConf AU 2018
Description: 
	Chrome Developer Tools is magical. It lets you record network traffic, step through code, modify the DOM, and more! To learn when we would use each of these features, I'll walk you through my adventures trying to trick Taylor Swiftâ€™s website into giving me concert tickets. Instead of reading through all of the JS files in her site and scrolling through hundreds of useless network activity logs, I learned how to use XHR breakpoints, filter network activity by type and domain, and recreate requests with CURL. I'll show you all of these tools and a few other tricks, and by the end of this talk, you will know how to reverse engineer any website and manipulate it to do your bidding.
Captions: 
	[Applause]all right hi everyone I'm so excited tobe starting off to guess Coffey you bytalking to you about how to use Chromedeveloper tools to hack your way intoconcerts now these subtitles talk isplease don't actually use thisinformation I'm not here to tell you todo anything that's literally illegal orto break any user agreements we're herefor the education and so do as I say andnot as I am still saying so I'm gonnatell you about a story this all reallydid happen to me last year I was reallyexcited about Taylor Swift I wanted toget in tickets to a concert and Ilearned so much about web development onthe way to doing that I built us a smallweb app for the purpose of this talk andI will be recreating the kinds ofinteractions that I saw when I wasinvestigating her web site so we havethis website website called Swifty'sit's selling tickets to Taylor sauceconcert and they want to give tickets tothe the most dedicated fans of TaylorSwift and they're measuring yourdedication by how many times you'vewatched her music video so the more youwatched her music video the more youwill have priority in line at the end noseriouslyso we want to convince Swifties thatwe've watched the music video more timesthan we really have you know it's likefour minutes long it's awesome awesomenot look what you made me do is not likethe greatest music video to be honestlike I'm sorry but I really thoughtTaylor stuff isn't watching soso space on with your story this is thewhat we're gonna be doing for the nextI realized that I actually cannot seeyou all very much but we will be usingthe browser a lot in this talk I'vetried to make the font as big aspossibleif you can't see please like do justcall out I don't want to want you tomiss the content just because you can'tsee we can make the font bigger ifsomeone near you is straining in they'retoo shy you know just call it for them Iwill not be mad so we've got Swiftieshere it's a very pared down web site Ialso realized that Taylor Swift is a lotmore cool than I am so I swapped out themusic video for a timer so that youcould all taste it's gonna talk but youknow it will work even if you replace itwith a four-minute video and I supposeit says one view it should say zeroviews that's fine starting the lifetimeoff great so we can play a video oh mygod that's like the biggest hurdle hereso you know we got this video we watchedthe whole thing this is the only timeI'm gonna watch the whole video and Icouldn't think of any funny jokes totell during this time but eventuallyI'll end and I can stop being awkwardyeah so we have two two views now and sowe just wanted to get that number as bigas possible so the first thing I startedthinking when I was debugging thiswebsite was like how do I just make thisvideo faster I know that I can come overhere and click on speed and click it - -and that will make the video faster butwhat if I want to do thatprogrammatically so every time I watchthe video the video comes out faster andthrough a little bit of research I foundout that there's the YouTube iframeplayer API which is pretty great itturns out you can send a ton ofdifferent pieces of information to youto a video that's embedded duringYouTube and the point here is that youcan you can send code you can examinethings dirty elements tab and so thatnow we're actually gonna get to thechrome parts so in case you didn't knowit turns out this is called a kebab menuthat's what I learned three recently ormaking it like a skewer menu or meatballmenu I'm not sure so you can find moretools developer toolsI usually hit command option I butthat's where you would find it and youcan paste in this code that I found onStack Overflow no seriously Iit's a JSON it's it's a command it setsthe playback rate so to you send themessage you post it to the iframe playerand I know you're all probably thinkinglike yeah I've done this before it'sfine you come over here you paste inyour code and you play this videoactually let's refresh this page becauseit's already played and now suddenlythis video he say hope you can tellthat's like moving faster than onesecond at a time one thing that'simportant to note here is that you cansee that this is actually searching fora element that has the idea of playerand if you want to make sure that wasworking you could come over here and seeindeed that there's an iframe here withthe idea of player one thing that Ireally love doing is if you hit commandshift C I realize you can't see my handsbut hit command C and you can highlightover any of these elements and thenselect it from there so that's reallycool you know you can make videos playfaster if you do this with torsos videoshe sounds like a chipmunkbut that's not good enough we you knowwe want to come and say where that we'rewatching at hundreds of times and so wedon't want to paste that code and everytime and so can we figure out how thesite is communicating with the server inthis case I was like being so e and likegoing hahaha I can like go over to thistree and like maybe I can edit this textI can like go here and go like yes I'vewatched it like a bajillion times I'mgreat but you know you refresh the pageof course you know what the views arenot there and so there must be some sortcommunication that's happening andthat's what the network tab is for youcan even come over here and you canactually watch everything that'shappening so if we refresh this pagestart over you can see a ton ofdifferent things happening watching allthese scripts go through the videoshappening and so you might meet youthinking like this is really complicatedbut it turns out that you can youactually filter by domain you know thatSwifty's is probably not sending arequest to youtube.com in order to trackof youand so you can actually type here domainin this case we can see actually I'm notsure if you can see it but the domain ismy local host that actually filters out and takes awayall that YouTube off that double-clickand all that other stuff next we knowthat there's some animations apparentlygoing on and some like left pad so weknow that we've we don't really careabout all of this stuff so we've gotsome we know that we have xhr here andwhat swing is that I someone asked mewhat does xhr mean I could say oh let'sanswer XML HTTP requests and if they askme anything else I'd be like Ajax Idon't know and that's I feel like I'vegone pretty far in life with just thatknowledge so anyway you you can clickhere for xhr and that that's reallygreat because now you can filter out allthis chaos you can ignore it if you wantto look at the CSS you can actuallyfilter out your network requests so wewent down to two network requests fromout of like let's say that's one really easy way to likefilter out and like drill down to likethe information that's really relevanthere and so now we can see that thereactually is a count request that'shappening so I mean we can investigatethat so from here we can click on thiswe can read through like what'shappening there's some request headersour user agent string and there's thisinteresting ID here that's like lookswith randomly generated so maybe we careabout that you kind of store all thisinformation away in case it comes up inthe future and then we can see that theresponse from the server is that there'sa true successful response I'm surprisedI haven't been checking in to see ifpeople are seeing the screen so I'llkeep moving all right so we open thenetwork tab we filtered oh and also I'mglad I have the slides because therereminds me of all the great things Iwant to talk about so we come here tothe initiator column and this is reallycool I may have just found out aboutthis yesterday so that's really greatyou can go here and see what stacktraceled to this count endpoint happening soif I go here I can see if there'ssome sort of VM stuffed I heard that'sthe next talks that's I'm excited forthe next one we can learn what's goingon here but we can pretend that thatdoesn't exist for now there is recordview and update view count if I clickhere I can see a bunch of stuff going onI can also see that there is some codehere it's like checking for a currenttime versus the duration of the video soI can see maybe like video is when we record that the userhas viewed the video so that's kind ofinteresting we can like even test outthat assumption let's refresh this pageand I skip all the way to the end I'vemet five views and now I'm at six yearsso I've already like learned a littlebit just by checking out the code insideof here and so we looked at the responseand request data and I was really afraidthat none of this would work so I took aton of screenshots in case I had to likego back to the slides that's everythingwe just saw so now we've seen thatthere's a count request and maybe if wesend that count request over and overagainwe might be able to get some more ofthese views so you come back over herelet's play this video and there's thecount endpoint one thing is really greatyou can do is click here or play xhr andthat will just redo this request againso now you can see that there is noinitiator column because I initiated itfrom the menu and you can see that theID here is the same ID as before this isthe original request and this is the newrequest but that the success is falseand so server's telling us that's notgoing to count this as a few we can testthis if i refresh this page let's tryreplaying it a bunch of timesI should see mmm like i refresh the page I only get seven soonly the first request went through sothat's kind of mysterious I'm not surewhat's going on here and so the nextquestion might be like well but you knowthere's that unique ID what does thatmean like does it have to be somethingdifferent every single timeand that's where a curl comes in curl isa command-line tool that lets you makeget request and post across through HTTPand all the other methods one thing thatI hate about Carl is that I never everget the syntax right there's all thoseheaders there's the new lines and allthat and it's just confusing so onething that's very great that you can dohere is I found out this you can copythis exact request as a curl command andthen you don't have to do all thatformatting yourself so let's do somecurl and now like I can see I have allthese headers I have my data if I gohere and I say something like hello J'sconf that's a unique ID maybe it hasn'tbeen sent yet maybe I'll work and so ifI paste this in no it doesn't work it'sstill false it was worth a shot though Iremember I had practiced this talkrecently and someone was like what if hejust changed the ID and so I wanted toconfirm that the ID does matter so weknow there's something going on here wewant to get that ID but we don't knowwhere it is so we want to send a validrequestso let's debug this we know we can findthe code from here but what if we wantto get to the code before it actuallyruns before that that Ajax requesthappens so I can come over to sources Iwas supposed to have that open and onething that's really great is you can setyour regular breakpoints just in atlines of code but you can actually breakon on Ajax requests before they happenyou can break any time a request happensand it turns out YouTube is constantlymaking xhr requests and so it's actuallynot that useful so delete that one butwe can break anytime the count happensand I will say any time an ER L containsthe word count will just stop so let'srefresh the page and there is we nodoubt now that we're in this weird VMcode that we can ignore let's make thisa little bit bigger and when we lookthrough the stack trace we canbe careful and say okay well there's therecord view but you know if you'reupdating the view count but there's anID eaterand so we can see if there's a variablesomewhere we know it's like somewhere inour scope if I can see the scope oh it'son the right thank youthanks to Chrome so to scope issomewhere in here for the ID it's aglobal variable indeed and at this pointI may have just command F for the wordID and realize I was at the top of thisfile which is pretty interestinglet's see I'm trying to make this a bitbigger for you so if i refresh this pagea bunch of times I can see that this IDkeeps changing and so like what you cando is you can come over here to networkclick on counters you can see it indeedthis response is coming through everytime every time I load the page I get anew counter and so at that point youknow you know that you can you candefinitely download this file and parseout that ID using a regular expressionwhich I will gloss over for now so thisID here what happens if I copy it if Isteal it and I put it inside my curlrequestmaybe I am done which maybe I'm done nowis the I kind of overall theme of thistalk so I put that new idea and I pasteit and I'm like it's gonna happen it'sgonna happen it's not gonna happen it'sjust like so disappointing likesoul-crushing but now I know at leastthat there's an ID that I can get butthere's something we're missing clearlyand at this point I will say this wholething I know I'm like squeezing intolike me a couple of days like I got reallyfrustrated I'd put it away I'd talked tosome friends perk up and I just keepcoming back to itand eventually after trying so manydifferent things I realized that therewas something going on with this with astart endpoint and then I'm pretty muchoops let's restart thisI realize that is false so I noticedthat there was a start in fine I wasgiving the same like style of responseas the count end point and I alsonoticed that that break point is here solet's press play so we're back in hereand I noticed that the start end pointhas an ID in it and so it must be itmust be connecting it back to the countsomehow and so honestly I don't have agood like intuition for how thishappened but I just decided that maybe Ishould try running the start command andthen I should try running the countcommandI did try like a dozen other things butI will give you the answer because we'reonly here for half an hour so I havethis this curl command I'm gonna pasteout my this is the start end point youcan see it right here and I'm gonna tryrefreshing this page so I can get a newfresh ID I can go over to sources hereit is and I'm gonna paste it right hereand also right here so I've got thisstart and you know okay so that one wastrue that's good what if I come overhere and try the counts and it's true[Music][Applause][Music]so I realized that that the climax isjust kind of like you try a lot ofthings you debug a lot you read throughall of the code that you can find thatisn't minified and you eventually figureout what's going on with the site andthen the next question is you know canwe automate the solution we know that wegot a unique ID we send a request tostart endpoint we send a request to theaccount endpoint and if we repeat thishopefully we should be able to get moreand more views I'm gonna do that thingthat Martha Stewart does where you knowshe has her like oven where she makesher turkey and then she puts it in andshe walks to her second oven andsuddenly there's another turkey and I'venever had two ovens in my life sometimesI've had like one I've had like zeroovens before but I have this great thingcalled turkey pie so we're gonna send arequest you're just using the Pythonrequest endpoint we have this regularexpression that just literally searchesfor a string VAR ID equals such-and-suchthing and we're going to get thecounters endpoint and we're going tothen post to the start endpoint with thetoken that we parsed out then we'regoing to post to the count endpoint andhopefully you will see a bunch ofsuccesses so come on yes okay so we didwe just manually or automatically didall the things that we were manuallydoing with curl if I come back over tothe browser and refresh this page now Ihave a hundred views so I can like runthis again and again I'm so glad I'm onthe local host because that would nothave worked over the Internet so how'dit's a conference Wi-Fi so now I havelike again I can even change the targetthousand but you get the ideanow I I've actually proven that I am thegreatest Taylor Swift fan I have more ofyou say anyone I have more views thanit's like physically possible to watchin one day so that's all great so thelast question you might be asking is howdo we prevent this from happening youknow we're all web developers here weknow that we we don't want people likeus to be playing with our sitesand so the first like I think most easything to do is like run a CAPTCHA likeevery time you watch a video or everytime you submit a form like say you wantto stop someone from automaticallybuying your stuff you can make them fillout a CAPTCHA one thing that is aproblem in this case is that you don'twant to make users for Kaptchuk everytime they play a music video now howpeople really annoying you'd lose all ofyour real fans um so you know there'spros and cons so you want to bethoughtful but when you would use aCAPTCHA another thing you could do israndomize the Dom I thought this was areally clever idea you could you know wehad we all of this just hinged on theidea that we could get the ID out of theout of the files that we weredownloading and I was always in the sameplace I was always far our ID equalsstring if you changed out the variablenames or randomize them or you even likedynamically generate those ideas maybe Iconcatenate strings together all of thatwould stop someone from just a regularexpression expression in out the IDS areally tricky idea that Mahmutco-workers gave me was that if you'relet's say you're you have a forum wherepeople are buying something rare like aspecial t-shirt or something you couldhave a hidden buy button inside of theDom that isn't showing to a user so thatit and you can randomize which bun comesfirst so that if someone's trying totraverse the Dom in order to find thebutton then they would sometimes hit thewrong button and that's how you'd knowif they were bahding or scripting Ithink the easiest or the simplest thingyou can do actually is not to stop BOTSfrom accessing your website but just letthem in and validate what kinds ofbehavior is seeing and not a Melbourneis really really familiar with thisbecause I learned that there it takesabout to Sydney but if you speed there you canget there in six hours and how's that gowhy not just do it just just speedthrough for six hoursand my friend says that told me thatthey'll take a picture of you at onepoint during this long drive and then atthe end they'll take another picture ofyou and they'll compare those timestampsand say there's no way you could havemade it there in the right time and sothere that's how to catch you forspeeding so you can do the same thingthere was no way I could have watchedit's and so if you detect that you canjust flag the accounts that are doingbad things one thing that's reallyimportant to do with this is to notalert the person who you believe isbotting you can just keep sending themsuccess equals true you can just keeptelling them that they're doing great ifthey're scraping your website you canstart sending them like vaguely true butalso not real data and you know thebenefit is that you're you're nottipping them off you're letting themkeep thinking that their solution isworking and at the end you don't have tosell in tickets and so those are justsome like starting points for how youfigure out how to stop you from doingthis if you can make it so that someonecan't just keep sending posts and getsin order to get to your website that'sprobably enough to deter the most the Iguess most anyone but the most dedicatedfans so why haven't any in with me wellI didn't get saddle band I actually wasreally afraid of that I thought like Ifind all this work and on the day of Ithought I would just like get an emailsaying you don't get tickets but theydidn't somehow they didn't realize thatI was watching this video way more timesthan I could have I did get a highpriority position in the salethe sad part is these tickets cost moneyit costs like fifteen hundred dollars tosay at the front at the concert and Iwas like not like at all prepared to dothat so I went to work I spent all thesehours doing this and then realized thatI didn't want those tickets after allbut I did get like the cheaper ticketslike you know kind of in the back ohmaybe I'll see her like from far awaylike bring my binocularsI got over a job so that was greatit's really great it was an internshipand I kind of want to be like what makesyou think I don't have a job man is itthe Taylor Swift I don't know maybe Imaybe I just like project I have toomuch time on my handsand I got to give this talk so that'sreally great I'm really glad I got tocome to Australia and talk to you allabout chrome developer tools so just tosum up we asked a ton of questionsduring this talk we are thinking aboutlike can we watch the video faster howhow are we communicating what's going onwith the network tab how do we do thisagain how do we make it repeatable howdo we find these tokens we were doing alot of debugging and we wrote somescripts and so that's a lot of reallybig questions IRA's that's like kind ofhard to remember but I think the thingthat you can walk away from this with islike first of all you got all this likeconcrete skills you know hopefullyyou've learned something or at least onething about chrome developer tools thatyou didn't know but the more importantthing is you know there's a spirit ofdebugging where you're filtering out theinformation that doesn't matter you'reyou're figuring out which path to godownand you're also persevering like even ifit takes our history you know it's okayyou can try things over and over againand you can keep asking questions and soI want to say here is going to becurious if you--if you want something tohappen and it's happening in the browseryou have the tools and those StackOverflow to make it happen yeah so thankyou here's all of the information[Applause]you
YouTube URL: https://www.youtube.com/watch?v=tXssxJgIHbs


