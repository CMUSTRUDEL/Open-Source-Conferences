Title: Attacking Email Encryption by Huzaifa Sidhpurwala
Publication date: 2019-03-25
Playlist: FOSSASIA Summit 2019 - Cybersecurity
Description: 
	16 March 2019 13:30, Training Room 9-2/9-3

Email remains the least common denominator when two or more people communicate over the Internet. After Snowden and various other disclosures, email encryption has become common. There are two standards related to email encryption namely OpenPGP and S/MIME. This talk discussed various interesting attacks against both of them. The talk ends with a discussion on the famous efail vuln (https://efail.de/) and the lessons learned from it.
Captions: 
	00:00:10,940 --> 00:00:16,699
thanks a lot for coming to my talk

00:00:13,110 --> 00:00:19,680
my name is Josefa I work with Red Hat a

00:00:16,699 --> 00:00:22,710
principal product security engineer I

00:00:19,680 --> 00:00:24,150
have worked on issues like heartbleed if

00:00:22,710 --> 00:00:30,500
you have heard of heartbleed or you know

00:00:24,150 --> 00:00:33,000
I fall ill shock I have loved crypto and

00:00:30,500 --> 00:00:38,550
conferences normally about security I

00:00:33,000 --> 00:00:41,250
have been coming to Foss a chef the

00:00:38,550 --> 00:00:43,320
security talk so this year I'm going to

00:00:41,250 --> 00:00:47,340
talk a little bit about attacking email

00:00:43,320 --> 00:00:59,160
encryption right oh how many people in

00:00:47,340 --> 00:01:03,809
the room are use Jeep GPG is not most

00:00:59,160 --> 00:01:09,090
most of us right so III not nearly is

00:01:03,809 --> 00:01:11,010
the least most of the time when you know

00:01:09,090 --> 00:01:13,320
when people start to learn computers or

00:01:11,010 --> 00:01:14,869
when they start to learn Internet the

00:01:13,320 --> 00:01:18,630
first thing they would they would I

00:01:14,869 --> 00:01:20,729
probably clearly the email address

00:01:18,630 --> 00:01:22,740
nowadays is associated with a lot of

00:01:20,729 --> 00:01:24,420
things so when you go to a particular

00:01:22,740 --> 00:01:30,090
website and you know when you try to

00:01:24,420 --> 00:01:32,430
create another thing it if you have an

00:01:30,090 --> 00:01:33,900
anchor the first thing you probably need

00:01:32,430 --> 00:01:36,540
to do when you buy a phone is you know

00:01:33,900 --> 00:01:40,770
create a account and you know tell your

00:01:36,540 --> 00:01:43,229
gmail account with of hope so email is

00:01:40,770 --> 00:01:44,939
very very common but now the problem it

00:01:43,229 --> 00:01:49,079
with email is that email is very very

00:01:44,939 --> 00:01:53,100
old and most protocol like you know if

00:01:49,079 --> 00:01:55,200
you have SMTP you have P o P or if you

00:01:53,100 --> 00:01:56,939
have heard of IMAP these are protocols

00:01:55,200 --> 00:02:01,950
which are responsible for sending and

00:01:56,939 --> 00:02:05,189
receiving the email basically Profoto

00:02:01,950 --> 00:02:07,409
calls and a reason why dia college they

00:02:05,189 --> 00:02:10,709
were basically designed they were

00:02:07,409 --> 00:02:13,200
invented instead when internet started

00:02:10,709 --> 00:02:13,890
which was talking about 30 years back or

00:02:13,200 --> 00:02:15,630
you know four

00:02:13,890 --> 00:02:17,790
two years back and at that time when

00:02:15,630 --> 00:02:19,530
Internet started internet was like 12

00:02:17,790 --> 00:02:21,300
machines which were connected together

00:02:19,530 --> 00:02:24,060
by some kind of a network cable or

00:02:21,300 --> 00:02:26,790
something like that right so one day

00:02:24,060 --> 00:02:29,370
internet would make a big that we will

00:02:26,790 --> 00:02:30,930
actually need security so when these

00:02:29,370 --> 00:02:33,270
protocols were designed they were not

00:02:30,930 --> 00:02:35,459
designed with security in mind so later

00:02:33,270 --> 00:02:38,490
on when Internet spread when email

00:02:35,459 --> 00:02:40,110
spread people figured out that there

00:02:38,490 --> 00:02:43,200
needs to be some security around these

00:02:40,110 --> 00:02:44,760
protocols attackers which are normally

00:02:43,200 --> 00:02:47,910
referred to as MIT a man-in-the-middle

00:02:44,760 --> 00:02:50,250
attack err which could be your IP it

00:02:47,910 --> 00:02:52,280
could be your government agency or you

00:02:50,250 --> 00:02:54,540
know it could be or network

00:02:52,280 --> 00:02:56,160
administrator of the company which you

00:02:54,540 --> 00:02:59,310
are working on so you know these people

00:02:56,160 --> 00:03:01,680
could easily you are doing they could

00:02:59,310 --> 00:03:03,600
modify your ills and they could do a lot

00:03:01,680 --> 00:03:04,980
of harm so later they figured out that

00:03:03,600 --> 00:03:06,720
you know we need to have some kind of

00:03:04,980 --> 00:03:10,050
security around this thing

00:03:06,720 --> 00:03:12,330
so to basically two forms of security

00:03:10,050 --> 00:03:13,620
were invented for email and this is what

00:03:12,330 --> 00:03:15,390
we will see in the presentation days

00:03:13,620 --> 00:03:17,580
there is one technology which is called

00:03:15,390 --> 00:03:20,100
the loopy G and there is one technology

00:03:17,580 --> 00:03:21,989
called which is called Esmail which is

00:03:20,100 --> 00:03:23,370
basically responsible for encrypting

00:03:21,989 --> 00:03:26,459
your email and both of them are

00:03:23,370 --> 00:03:29,459
susceptible to attacks right so let's be

00:03:26,459 --> 00:03:31,019
basically see how your email works so

00:03:29,459 --> 00:03:33,780
are things which you see in green over

00:03:31,019 --> 00:03:36,120
here is basically trusted it so green

00:03:33,780 --> 00:03:39,360
solid lines are trusted green dotted

00:03:36,120 --> 00:03:41,519
lines are probably trusted right and red

00:03:39,360 --> 00:03:43,829
lines are not trusted at all so they are

00:03:41,519 --> 00:03:45,810
so anyway when you send an email you

00:03:43,829 --> 00:03:47,579
start by type typing your email flow

00:03:45,810 --> 00:03:48,989
from the device which you have which

00:03:47,579 --> 00:03:51,180
could be your mobile or you know it

00:03:48,989 --> 00:03:52,680
could be your handheld device or

00:03:51,180 --> 00:03:54,570
whatever you have it could be your

00:03:52,680 --> 00:03:56,310
laptop or your desktop or whatever so

00:03:54,570 --> 00:03:57,870
when you start sending your email and

00:03:56,310 --> 00:04:00,030
when you actually send send out the

00:03:57,870 --> 00:04:03,060
email right you are saying sending your

00:04:00,030 --> 00:04:04,290
data why or why are your local router or

00:04:03,060 --> 00:04:06,030
you know your wireless device or

00:04:04,290 --> 00:04:08,100
whatever device which you have and we

00:04:06,030 --> 00:04:09,900
assume that you know v you have control

00:04:08,100 --> 00:04:12,390
of that device so if you are working in

00:04:09,900 --> 00:04:14,160
company the company network

00:04:12,390 --> 00:04:17,400
administrator probably has a control of

00:04:14,160 --> 00:04:19,530
the device so this is green then it goes

00:04:17,400 --> 00:04:21,600
to the SMTP source or server which is

00:04:19,530 --> 00:04:23,070
there and since the SMTP server is

00:04:21,600 --> 00:04:24,930
controlled by the thumb company which

00:04:23,070 --> 00:04:27,240
you are working for which we are calling

00:04:24,930 --> 00:04:27,570
it as Corp on this is also Greek which

00:04:27,240 --> 00:04:29,070
makes

00:04:27,570 --> 00:04:30,690
which means that you know all of these

00:04:29,070 --> 00:04:33,480
things are trusted you can basically

00:04:30,690 --> 00:04:35,040
control whatever is is happening now one

00:04:33,480 --> 00:04:37,380
one thing which normally happens is

00:04:35,040 --> 00:04:39,210
you're the network administrator or your

00:04:37,380 --> 00:04:41,760
system administrator will often like to

00:04:39,210 --> 00:04:43,620
take backup of your email right and if

00:04:41,760 --> 00:04:46,410
he takes this backup on a public cloud

00:04:43,620 --> 00:04:47,550
then it's probably not just adjusted

00:04:46,410 --> 00:04:49,650
because you know the data is going

00:04:47,550 --> 00:04:51,240
outside your company it's probably not

00:04:49,650 --> 00:04:53,730
encrypted at all or you know if it is

00:04:51,240 --> 00:04:55,920
encrypted then you don't know who has

00:04:53,730 --> 00:04:58,230
the keys to encryption right so you know

00:04:55,920 --> 00:04:59,790
if you if you host it on on Google you

00:04:58,230 --> 00:05:01,530
you are not sure where the Google has

00:04:59,790 --> 00:05:03,360
the keys or not so you are you are not

00:05:01,530 --> 00:05:05,730
sure where the Google is able to see

00:05:03,360 --> 00:05:08,280
your date did the data or not so that's

00:05:05,730 --> 00:05:09,750
why we have this dotted line saying that

00:05:08,280 --> 00:05:12,180
you know if you are taking a backup of

00:05:09,750 --> 00:05:14,430
your email there is a good chance that

00:05:12,180 --> 00:05:15,750
you know this backup is not just trusted

00:05:14,430 --> 00:05:19,620
and you know people are able to see your

00:05:15,750 --> 00:05:22,380
email then your email goes to doc your

00:05:19,620 --> 00:05:23,760
email goes to the antivirus source or

00:05:22,380 --> 00:05:26,940
server which is there right and

00:05:23,760 --> 00:05:29,550
antivirus software actually needs to see

00:05:26,940 --> 00:05:30,960
the content of your email in order to

00:05:29,550 --> 00:05:32,790
figure out if there's a virus inside

00:05:30,960 --> 00:05:35,790
your email right so most likely

00:05:32,790 --> 00:05:38,310
antivirus may not be a trusted it goes

00:05:35,790 --> 00:05:39,990
out to the Internet right this guy in

00:05:38,310 --> 00:05:42,060
the hoodie is put all probably or the

00:05:39,990 --> 00:05:43,650
guy with the cap is is the attacker he

00:05:42,060 --> 00:05:44,790
is able to see the packets which are

00:05:43,650 --> 00:05:47,610
going through the internet

00:05:44,790 --> 00:05:49,730
he's able to see what you have typed on

00:05:47,610 --> 00:05:52,650
your email right and then it goes to

00:05:49,730 --> 00:05:54,180
smtp corp to call to is the person whom

00:05:52,650 --> 00:05:55,860
you are trying to send the email to and

00:05:54,180 --> 00:05:57,630
then you know it again goes through the

00:05:55,860 --> 00:05:59,430
same path and then it goes through to

00:05:57,630 --> 00:06:00,750
the device of your friend or you know

00:05:59,430 --> 00:06:02,760
whoever you are going to send an email

00:06:00,750 --> 00:06:04,710
to right so if you see the entire email

00:06:02,760 --> 00:06:06,900
path from the sender to the receiver

00:06:04,710 --> 00:06:09,210
there is only a small part which is

00:06:06,900 --> 00:06:10,740
actually under your control and there is

00:06:09,210 --> 00:06:12,630
only a small part which you can

00:06:10,740 --> 00:06:14,850
basically say that it it is trusted

00:06:12,630 --> 00:06:17,190
everything else out there once it goes

00:06:14,850 --> 00:06:21,210
out on on the Internet then it is not

00:06:17,190 --> 00:06:24,390
trusted at all right so there is no such

00:06:21,210 --> 00:06:26,940
thing as my email right there is no such

00:06:24,390 --> 00:06:30,120
thing as my email once the email has

00:06:26,940 --> 00:06:32,040
left your your machine then they a lot

00:06:30,120 --> 00:06:33,030
of people out there on the internet who

00:06:32,040 --> 00:06:35,850
are able to modify

00:06:33,030 --> 00:06:37,950
they able to up see what we have typed

00:06:35,850 --> 00:06:40,500
they able to modify - five these things

00:06:37,950 --> 00:06:41,430
right and in this presentation we will

00:06:40,500 --> 00:06:43,830
see that

00:06:41,430 --> 00:06:46,169
even if you encrypt your email via the

00:06:43,830 --> 00:06:48,360
new PG even if you encrypt your email s

00:06:46,169 --> 00:06:50,699
mind it is quite possible that you know

00:06:48,360 --> 00:06:53,789
by you using a lot of attacks people are

00:06:50,699 --> 00:06:56,039
still able to modify your email okay so

00:06:53,789 --> 00:06:58,710
even if you own the email source or

00:06:56,039 --> 00:07:01,110
server right so even if you own your own

00:06:58,710 --> 00:07:03,720
email server even if you have an email

00:07:01,110 --> 00:07:05,759
server at home then it is it is not very

00:07:03,720 --> 00:07:08,160
useful because once the email goes out

00:07:05,759 --> 00:07:09,150
on the Internet then there is a problem

00:07:08,160 --> 00:07:10,949
people can sender

00:07:09,150 --> 00:07:13,050
people can change the emails so

00:07:10,949 --> 00:07:16,470
attackers have access to to your email

00:07:13,050 --> 00:07:17,940
right so this will the solution is to

00:07:16,470 --> 00:07:19,949
use something called end-to-end

00:07:17,940 --> 00:07:22,740
encryption end-to-end encryption

00:07:19,949 --> 00:07:24,780
basically means that you encrypt the

00:07:22,740 --> 00:07:26,729
sender will encrypt and the receiver

00:07:24,780 --> 00:07:30,240
will decrypt right so this is basically

00:07:26,729 --> 00:07:34,260
what n2n encryption means that norm

00:07:30,240 --> 00:07:36,210
normally when you use SSL TLS with the

00:07:34,260 --> 00:07:39,690
protocols like you know as I mentioned

00:07:36,210 --> 00:07:40,530
there is SMTP which is which is used for

00:07:39,690 --> 00:07:42,479
sending email

00:07:40,530 --> 00:07:44,370
similarly days I am s and there is

00:07:42,479 --> 00:07:46,500
purpose which is used for receiving

00:07:44,370 --> 00:07:49,650
email these are not basically into an

00:07:46,500 --> 00:07:52,289
encryption because the SSL TLS tunnel is

00:07:49,650 --> 00:07:54,870
between the sender and the server only

00:07:52,289 --> 00:07:57,210
if there is an SMTP server and a just

00:07:54,870 --> 00:07:59,580
sender the tunnel is between the sender

00:07:57,210 --> 00:08:01,050
and the server only there is no end to

00:07:59,580 --> 00:08:03,090
end encryption involved wait

00:08:01,050 --> 00:08:06,630
so end-to-end encryption basically means

00:08:03,090 --> 00:08:08,849
that you encrypt at your end and the

00:08:06,630 --> 00:08:11,669
email travels through the Internet in an

00:08:08,849 --> 00:08:14,070
encrypted way and then it it reaches the

00:08:11,669 --> 00:08:16,650
receiver and as you see what only the

00:08:14,070 --> 00:08:18,150
receiver is able to decrypt it right so

00:08:16,650 --> 00:08:19,919
so there are two standards which are

00:08:18,150 --> 00:08:24,720
prevalent on the internet there is open

00:08:19,919 --> 00:08:26,760
PGP which is RFC for 8 hz0 I think this

00:08:24,720 --> 00:08:29,039
is the first standard to bring

00:08:26,760 --> 00:08:32,279
encryption to a to everybody right so

00:08:29,039 --> 00:08:35,099
any person can set can set up a GPG key

00:08:32,279 --> 00:08:36,990
any person can do encryption any person

00:08:35,099 --> 00:08:39,390
can send an encryption email so this is

00:08:36,990 --> 00:08:41,370
the first mass encryption standard which

00:08:39,390 --> 00:08:44,790
was out there which anybody can can use

00:08:41,370 --> 00:08:46,709
most widely used right I have a graph

00:08:44,790 --> 00:08:48,720
which shows the statistics so it is the

00:08:46,709 --> 00:08:51,720
most widely used method of encrypting

00:08:48,720 --> 00:08:54,150
emails the only downside is you you need

00:08:51,720 --> 00:08:55,050
a plug-in for your email client so most

00:08:54,150 --> 00:08:57,510
of the email Klein

00:08:55,050 --> 00:08:59,790
will not natively support open GPG or

00:08:57,510 --> 00:09:02,730
auto PGP right so if you are using

00:08:59,790 --> 00:09:04,680
Thunderbird then there is a plug-in

00:09:02,730 --> 00:09:05,970
called energy mail or you know if you

00:09:04,680 --> 00:09:07,860
are using other clients there are

00:09:05,970 --> 00:09:09,450
different plugins which are available so

00:09:07,860 --> 00:09:12,060
the only downside is of plug-in is

00:09:09,450 --> 00:09:14,070
required there is a second technology

00:09:12,060 --> 00:09:16,230
which you can use which is called s/mime

00:09:14,070 --> 00:09:18,209
s/mime is normally favoured by a

00:09:16,230 --> 00:09:20,100
companies and the reason why it is

00:09:18,209 --> 00:09:22,620
favored by companies is because it works

00:09:20,100 --> 00:09:24,450
on certificates right so what now

00:09:22,620 --> 00:09:27,060
normally companies do is they generate a

00:09:24,450 --> 00:09:29,010
per user certificate so when a new

00:09:27,060 --> 00:09:31,529
person joins the company they will

00:09:29,010 --> 00:09:33,480
generate a certificate for the for the

00:09:31,529 --> 00:09:36,029
person they will put the certificate on

00:09:33,480 --> 00:09:37,860
a USB key right and they will give the

00:09:36,029 --> 00:09:40,230
USB key to to the person we're joined

00:09:37,860 --> 00:09:42,329
now when he has to encrypt the email

00:09:40,230 --> 00:09:44,339
what he will do is he will put the USB

00:09:42,329 --> 00:09:46,290
key in the USB Drive he will enter the

00:09:44,339 --> 00:09:48,600
password and that should automatically

00:09:46,290 --> 00:09:51,839
encrypt the image right so this is this

00:09:48,600 --> 00:09:53,730
is a most centralized corporate way of

00:09:51,839 --> 00:09:55,470
encrypting and decrypting your emails

00:09:53,730 --> 00:09:57,360
but but but again you need an

00:09:55,470 --> 00:09:59,339
infrastructure for this you need a

00:09:57,360 --> 00:10:00,600
certificate source or server and there

00:09:59,339 --> 00:10:02,399
are there's a lot of infrastructure

00:10:00,600 --> 00:10:04,649
which is required so if you are doing

00:10:02,399 --> 00:10:07,350
this on an individual basis then people

00:10:04,649 --> 00:10:09,000
will normally prefer open PP PGP if you

00:10:07,350 --> 00:10:11,760
are doing it on a corporate basis then

00:10:09,000 --> 00:10:13,890
companies normally prefer f9 the the

00:10:11,760 --> 00:10:17,550
advantages most of the email clients

00:10:13,890 --> 00:10:20,250
will natively support this right so now

00:10:17,550 --> 00:10:22,800
how how many PGP keys are are there or

00:10:20,250 --> 00:10:25,890
under internet so I think last time some

00:10:22,800 --> 00:10:28,470
somebody saw they were like 3 mil 300

00:10:25,890 --> 00:10:30,720
million GPG keys which were generated

00:10:28,470 --> 00:10:32,190
and if you see see see the graph over

00:10:30,720 --> 00:10:35,459
here the graph shows a very interesting

00:10:32,190 --> 00:10:37,890
pattern right so initially when 1997

00:10:35,459 --> 00:10:39,810
when the tech note that the technology

00:10:37,890 --> 00:10:43,320
becomes slightly famous there were very

00:10:39,810 --> 00:10:47,279
few of PGP keys right and it goes up to

00:10:43,320 --> 00:10:49,050
2004 if you if you see to 2004 2004 is

00:10:47,279 --> 00:10:51,990
the place where there is a sudden spike

00:10:49,050 --> 00:10:54,690
in the India number of people creating

00:10:51,990 --> 00:10:57,899
PGP keys and probably use using PGP keys

00:10:54,690 --> 00:11:03,990
right so you know why why why this bike

00:10:57,899 --> 00:11:05,760
is there in 2014 Snowden so to to 2014

00:11:03,990 --> 00:11:07,980
is the time when Snowden came out and

00:11:05,760 --> 00:11:08,970
you know we spoke about NSA and you know

00:11:07,980 --> 00:11:11,519
how how they are

00:11:08,970 --> 00:11:13,019
trying to snoop in on to your email and

00:11:11,519 --> 00:11:15,629
you know how they are trying to do stuff

00:11:13,019 --> 00:11:17,610
this this really enlightened people and

00:11:15,629 --> 00:11:21,300
everybody started creating PGP keys

00:11:17,610 --> 00:11:24,240
right so we we see us simsim similar

00:11:21,300 --> 00:11:25,980
statistics in enigmail enigmail is a

00:11:24,240 --> 00:11:27,779
plugin which is used for thunderbird

00:11:25,980 --> 00:11:29,910
which is used for PGP right

00:11:27,779 --> 00:11:33,839
we see the same similar statistics for

00:11:29,910 --> 00:11:36,000
Enigma as well if you see 2014 in 2014

00:11:33,839 --> 00:11:38,189
there's a sudden spike in a number of

00:11:36,000 --> 00:11:40,139
people actually downloading enigmail and

00:11:38,189 --> 00:11:43,560
you know trying to use a nickname right

00:11:40,139 --> 00:11:45,689
so now there is a problem which with

00:11:43,560 --> 00:11:48,720
both of these tools and a problem is

00:11:45,689 --> 00:11:51,449
usability right it is not it is not

00:11:48,720 --> 00:11:54,329
really easy to use enik mail or it is

00:11:51,449 --> 00:11:56,939
not easy to use open PGP it is not easy

00:11:54,329 --> 00:11:58,649
to use as mine and they are a lot of

00:11:56,939 --> 00:12:01,079
days there's a lot of work done on

00:11:58,649 --> 00:12:04,019
trying to understand the usability of

00:12:01,079 --> 00:12:06,300
both of these different securities so

00:12:04,019 --> 00:12:09,990
there was a paper which was published in

00:12:06,300 --> 00:12:13,139
1999 there was a paper published in 1999

00:12:09,990 --> 00:12:15,439
about usability of open PGP and the

00:12:13,139 --> 00:12:18,300
paper is called why Johnny can't encrypt

00:12:15,439 --> 00:12:20,939
right which shows how difficult it is

00:12:18,300 --> 00:12:23,759
for a layman to actually use open PGP

00:12:20,939 --> 00:12:26,069
right and then there was one more paper

00:12:23,759 --> 00:12:28,259
which was published in 2006 and the

00:12:26,069 --> 00:12:31,649
paper is is called why Johnny still can

00:12:28,259 --> 00:12:33,809
can encrypt which which shows that there

00:12:31,649 --> 00:12:35,610
was no work done on usability at all

00:12:33,809 --> 00:12:37,740
right there was a paper which was

00:12:35,610 --> 00:12:40,769
published in 2015 which is called why

00:12:37,740 --> 00:12:42,870
Johnny still still can encrypt which

00:12:40,769 --> 00:12:44,189
shows that again no work was done on

00:12:42,870 --> 00:12:46,589
usability at all

00:12:44,189 --> 00:12:48,029
so let's let's talk about SS mine for s

00:12:46,589 --> 00:12:52,500
mine there was a paper which was

00:12:48,029 --> 00:12:56,670
published in 2012 which is called not

00:12:52,500 --> 00:12:58,199
sealed but delivered ok s mine not not

00:12:56,670 --> 00:13:00,209
sealed but but delivered there was one

00:12:58,199 --> 00:13:02,160
more paper which says we are on the same

00:13:00,209 --> 00:13:04,139
page which which means that there is no

00:13:02,160 --> 00:13:05,970
security at all so these technologies

00:13:04,139 --> 00:13:08,129
are not these technologies are not

00:13:05,970 --> 00:13:10,490
really easy to use they are very very

00:13:08,129 --> 00:13:13,620
difficult they are so difficult that in

00:13:10,490 --> 00:13:15,720
2014 Edward Snowden made a tutorial on

00:13:13,620 --> 00:13:17,279
the Internet and that you toriel is

00:13:15,720 --> 00:13:19,529
still available on this website called

00:13:17,279 --> 00:13:22,529
Vimeo right so if you if you google

00:13:19,529 --> 00:13:22,860
Edward Snowden GPG tutorial you will put

00:13:22,529 --> 00:13:24,630
this

00:13:22,860 --> 00:13:28,010
we'll probably be the first hit so

00:13:24,630 --> 00:13:30,630
Edward Snowden made a tutorial on Vimeo

00:13:28,010 --> 00:13:32,880
showing Jorge journalist how to encrypt

00:13:30,630 --> 00:13:34,500
right because journalists are the most

00:13:32,880 --> 00:13:36,570
non-technical people out there at least

00:13:34,500 --> 00:13:38,070
most of journalists are right most of

00:13:36,570 --> 00:13:40,680
the journalists are at very

00:13:38,070 --> 00:13:43,230
non-technical so he/she is owed this

00:13:40,680 --> 00:13:46,290
video tutorial to show John journalists

00:13:43,230 --> 00:13:48,630
how you can set up a GPG key how you can

00:13:46,290 --> 00:13:51,360
encrypt by using GPG key how you can

00:13:48,630 --> 00:13:54,210
decrypt so that so so so that they can

00:13:51,360 --> 00:13:57,000
securely transmit information without

00:13:54,210 --> 00:13:58,530
the government gauges agencies snooping

00:13:57,000 --> 00:14:00,090
into what they are doing and trying to

00:13:58,530 --> 00:14:03,090
figure out what their source of

00:14:00,090 --> 00:14:04,890
information is right so Snowden

00:14:03,090 --> 00:14:07,800
basically says that you know you you use

00:14:04,890 --> 00:14:09,300
of plain text you use G edit or you know

00:14:07,800 --> 00:14:12,480
some something like that and you

00:14:09,300 --> 00:14:14,280
generate the encrypted message you copy

00:14:12,480 --> 00:14:16,320
the encrypted message you paste it into

00:14:14,280 --> 00:14:17,790
an email client and then you do the same

00:14:16,320 --> 00:14:20,130
thing when when you want to decrypt it

00:14:17,790 --> 00:14:22,440
right so Snowden's method is very very

00:14:20,130 --> 00:14:25,200
easy but but but but again there is a

00:14:22,440 --> 00:14:27,330
big usability factor involved over your

00:14:25,200 --> 00:14:29,910
none of these technologies are very easy

00:14:27,330 --> 00:14:31,620
to use right so what what what is the

00:14:29,910 --> 00:14:33,840
worst attack which you can think about

00:14:31,620 --> 00:14:39,000
what is the worst attack right so in

00:14:33,840 --> 00:14:41,340
2004 14 enigmail version 1.7 right so

00:14:39,000 --> 00:14:43,470
any mail is a plugin which is used by

00:14:41,340 --> 00:14:45,330
Thunderbird and you know as we saw from

00:14:43,470 --> 00:14:46,950
the last slides there are millions of

00:14:45,330 --> 00:14:49,620
downloads so we are assuming that

00:14:46,950 --> 00:14:52,350
millions of people actually use enigmail

00:14:49,620 --> 00:14:56,190
to encrypt and decrypt their email right

00:14:52,350 --> 00:14:59,790
so in 2014 it was found that a nickname

00:14:56,190 --> 00:15:02,100
will not encrypt your image at all right

00:14:59,790 --> 00:15:04,560
so basically you open your car your car

00:15:02,100 --> 00:15:06,480
your Thunderbird you type your email you

00:15:04,560 --> 00:15:08,820
click on the button which is encrypt my

00:15:06,480 --> 00:15:11,220
email and you send send a email right

00:15:08,820 --> 00:15:13,530
and you assume that encrypted email will

00:15:11,220 --> 00:15:15,510
be sent so enigmail will print a message

00:15:13,530 --> 00:15:17,550
saying email is encrypted but email is

00:15:15,510 --> 00:15:19,980
not encrypted it will send out a plain

00:15:17,550 --> 00:15:21,180
text email right so this is what these

00:15:19,980 --> 00:15:25,620
are one of the worst attacks which were

00:15:21,180 --> 00:15:29,010
found in 2017 of Outlook ok and and this

00:15:25,620 --> 00:15:31,200
this this is a very unique case 2017

00:15:29,010 --> 00:15:33,930
Microsoft Outlook head of law in which

00:15:31,200 --> 00:15:36,570
it will encrypt your email it will send

00:15:33,930 --> 00:15:36,840
an encrypted email but it will also send

00:15:36,570 --> 00:15:40,230
up

00:15:36,840 --> 00:15:43,350
in text email right so this is very very

00:15:40,230 --> 00:15:46,560
novel it doesn't keep you email so I

00:15:43,350 --> 00:15:48,450
mean it is it is doing doing its job but

00:15:46,560 --> 00:15:51,240
it will also send a plain text email

00:15:48,450 --> 00:15:52,880
food food food at all the Magnum middle

00:15:51,240 --> 00:15:56,640
attackers can actually read you English

00:15:52,880 --> 00:15:59,070
right so in 2007 there was a floor which

00:15:56,640 --> 00:16:00,930
with enigmail and the flow of wall was

00:15:59,070 --> 00:16:03,780
it up with some something which is known

00:16:00,930 --> 00:16:06,600
as a PEP extension and what it does is

00:16:03,780 --> 00:16:09,300
basically it will send an unencrypted

00:16:06,600 --> 00:16:11,400
email right it not only sends an

00:16:09,300 --> 00:16:14,460
unencrypted email but when you actually

00:16:11,400 --> 00:16:16,110
go to your sent items in the sent items

00:16:14,460 --> 00:16:18,180
it will show you that the email was

00:16:16,110 --> 00:16:20,670
encrypted and sent in an encrypted way

00:16:18,180 --> 00:16:23,550
right so there is no way for you to find

00:16:20,670 --> 00:16:25,650
out if an encrypted email was a saint or

00:16:23,550 --> 00:16:29,100
a non encrypted email was sent

00:16:25,650 --> 00:16:31,170
right so let's let's quick quickly look

00:16:29,100 --> 00:16:33,660
at how PGP so here we are trying to dis

00:16:31,170 --> 00:16:35,730
talk is about trying to attack email

00:16:33,660 --> 00:16:38,040
encryption right so let's let's quickly

00:16:35,730 --> 00:16:40,320
look at how we can attack both of the

00:16:38,040 --> 00:16:42,870
technologies which we have which is PGP

00:16:40,320 --> 00:16:45,450
and s mine so how PGP basically works so

00:16:42,870 --> 00:16:47,760
I am NOT going to go through all the

00:16:45,450 --> 00:16:50,040
mats and decrypt crypto over here but

00:16:47,760 --> 00:16:53,130
what what happens is when you when you

00:16:50,040 --> 00:16:55,890
encrypt an email using PGP M is your

00:16:53,130 --> 00:16:57,180
message right so M is email the text

00:16:55,890 --> 00:17:00,180
message which you are actually trying to

00:16:57,180 --> 00:17:02,820
say what PGP does is it creates a per

00:17:00,180 --> 00:17:04,320
session key so for each of the email

00:17:02,820 --> 00:17:06,570
which you are trying to send it will

00:17:04,320 --> 00:17:08,850
create a random key right so if you send

00:17:06,570 --> 00:17:10,680
ten emails then each email which you are

00:17:08,850 --> 00:17:13,260
sending will have a different random key

00:17:10,680 --> 00:17:15,330
so it creates a post session key so it

00:17:13,260 --> 00:17:18,420
is called s then what it basically does

00:17:15,330 --> 00:17:20,340
is it does a es encryption right it does

00:17:18,420 --> 00:17:22,950
Ajay's encryption of your message m and

00:17:20,340 --> 00:17:25,830
it you do this s as the key to actually

00:17:22,950 --> 00:17:28,260
do do the encryption right now once the

00:17:25,830 --> 00:17:30,120
encryption has been done it needs to

00:17:28,260 --> 00:17:31,140
send over the session key as well right

00:17:30,120 --> 00:17:33,090
because it is a symmetric encryption

00:17:31,140 --> 00:17:35,580
which means that you do need the same

00:17:33,090 --> 00:17:37,620
key for encryption and decryption now

00:17:35,580 --> 00:17:41,520
this session key needs to be safe over

00:17:37,620 --> 00:17:43,260
as well does is it uses C and the GPG

00:17:41,520 --> 00:17:47,580
key which you have judged or generated

00:17:43,260 --> 00:17:50,169
it uses the GPG key to crib right and

00:17:47,580 --> 00:17:52,330
this encrypted session key

00:17:50,169 --> 00:17:55,330
the actual message which is encrypted by

00:17:52,330 --> 00:17:57,730
using the citation key is then sent over

00:17:55,330 --> 00:18:00,789
the Internet right and then if we use a

00:17:57,730 --> 00:18:02,409
very similar protocol to decrypted you

00:18:00,789 --> 00:18:04,659
need to actually first decrypt the

00:18:02,409 --> 00:18:08,109
excitation key once you get your session

00:18:04,659 --> 00:18:11,460
key use AES to decrypt up so this is

00:18:08,109 --> 00:18:14,529
basic GPG encryption decryption works

00:18:11,460 --> 00:18:16,659
now they is there is a fundamental

00:18:14,529 --> 00:18:20,499
problem Enders end-of-file fundamental

00:18:16,659 --> 00:18:24,639
problem over here is es uses CBC right

00:18:20,499 --> 00:18:27,220
so CBC is a mode of encryption so mode

00:18:24,639 --> 00:18:28,989
of encryption basically means is that if

00:18:27,220 --> 00:18:31,389
you have a large message which you want

00:18:28,989 --> 00:18:33,249
to encrypt right so if you have say 1 MB

00:18:31,389 --> 00:18:34,840
or you know 10 MB or if you have a very

00:18:33,249 --> 00:18:38,379
large message which you want to encrypt

00:18:34,840 --> 00:18:40,989
es cannot work with large messages so

00:18:38,379 --> 00:18:43,179
what he has does is he s will break the

00:18:40,989 --> 00:18:45,999
message into small right

00:18:43,179 --> 00:18:48,070
so if I have a 1 K KB message what he s

00:18:45,999 --> 00:18:50,320
will do is break it into smaller blocks

00:18:48,070 --> 00:18:52,840
and it will encrypt each block

00:18:50,320 --> 00:18:55,059
separately right so if I have a long

00:18:52,840 --> 00:18:57,039
message say break it into ten blocks in

00:18:55,059 --> 00:18:59,230
creep block number one in creep block

00:18:57,039 --> 00:19:01,600
number to increase block number three do

00:18:59,230 --> 00:19:04,029
it for all the ten blocks and then the

00:19:01,600 --> 00:19:06,220
encrypted would which you get its join

00:19:04,029 --> 00:19:07,659
all the encrypted output it's going to

00:19:06,220 --> 00:19:10,359
send it out on the internal so this is

00:19:07,659 --> 00:19:12,609
basically what mode of encryption obey

00:19:10,359 --> 00:19:15,429
basically means CBC is slightly

00:19:12,609 --> 00:19:19,119
different so what happens if see CBC is

00:19:15,429 --> 00:19:21,759
I have three messages right so I have

00:19:19,119 --> 00:19:23,470
three three blocks so did this is what

00:19:21,759 --> 00:19:25,509
we discussed sometime back then because

00:19:23,470 --> 00:19:27,549
my message is very big my algorithm

00:19:25,509 --> 00:19:30,970
cannot handle such such a big message

00:19:27,549 --> 00:19:33,730
what happens in CBC is an output of one

00:19:30,970 --> 00:19:36,070
of the of the previous block is used as

00:19:33,730 --> 00:19:38,830
feed feedback for the next block right

00:19:36,070 --> 00:19:40,840
so this is basically what CBC means that

00:19:38,830 --> 00:19:43,119
we use the output from block 0 as a

00:19:40,840 --> 00:19:44,889
feedback from block 1 use output from

00:19:43,119 --> 00:19:46,480
block one other feedback from block 2

00:19:44,889 --> 00:19:48,279
and so on and so forth so this is

00:19:46,480 --> 00:19:50,470
basically how to CBC mode of encryption

00:19:48,279 --> 00:19:52,809
works now what you see on the screen is

00:19:50,470 --> 00:19:54,549
actually the decryption process so

00:19:52,809 --> 00:19:56,350
decryption or also needs to work in the

00:19:54,549 --> 00:19:58,269
same way as the encryption process right

00:19:56,350 --> 00:20:01,480
so what what you see is the decryption

00:19:58,269 --> 00:20:03,070
process we have one block so each block

00:20:01,480 --> 00:20:03,910
over here which you see is for example

00:20:03,070 --> 00:20:08,830
c8

00:20:03,910 --> 00:20:11,620
a bite so you know so each block juicy

00:20:08,830 --> 00:20:14,050
has got some some some size right and we

00:20:11,620 --> 00:20:16,660
use CBC method to basically decrypt the

00:20:14,050 --> 00:20:20,260
blocks right now the problem it's CCBC

00:20:16,660 --> 00:20:22,540
is that CBC is malleable what malleable

00:20:20,260 --> 00:20:24,970
which means that when I change one of

00:20:22,540 --> 00:20:27,640
the blocks then you know the output will

00:20:24,970 --> 00:20:29,200
slightly change right when I change one

00:20:27,640 --> 00:20:31,150
of the sighs sighs sighs I for text

00:20:29,200 --> 00:20:33,580
blocks then the output will slightly

00:20:31,150 --> 00:20:36,100
change and that change will propagate to

00:20:33,580 --> 00:20:38,020
put on next block as well so what dot

00:20:36,100 --> 00:20:40,530
what the attacker can basically do is

00:20:38,020 --> 00:20:43,630
the attacker can use the malleability

00:20:40,530 --> 00:20:45,040
problem it's CBC and what he does is he

00:20:43,630 --> 00:20:48,130
creates something which is known as a

00:20:45,040 --> 00:20:50,680
CBC guy gadget right so there are a lot

00:20:48,130 --> 00:20:53,050
of things which I think I'm slightly out

00:20:50,680 --> 00:20:55,720
of time so I'll I try to explain it a

00:20:53,050 --> 00:20:57,280
little bit faster so what she sees what

00:20:55,720 --> 00:20:58,960
she BBC basically does is what the

00:20:57,280 --> 00:21:00,670
attacker does is attacker create

00:20:58,960 --> 00:21:02,890
something which is no another CBC cat

00:21:00,670 --> 00:21:04,960
gadget right in which he is able to

00:21:02,890 --> 00:21:06,820
control what the output of the first

00:21:04,960 --> 00:21:09,160
block is which will which is going to

00:21:06,820 --> 00:21:11,320
kind of you know transform into the

00:21:09,160 --> 00:21:13,300
second and the third block so what the

00:21:11,320 --> 00:21:16,060
attacker basically does is the attacker

00:21:13,300 --> 00:21:19,270
controls the first block right and by

00:21:16,060 --> 00:21:21,760
using malicious values in the first

00:21:19,270 --> 00:21:24,070
block is able to change the output of

00:21:21,760 --> 00:21:25,660
the decryption right so he's able to

00:21:24,070 --> 00:21:28,120
change the output of the ending of the

00:21:25,660 --> 00:21:30,580
decryption so what the attacker has done

00:21:28,120 --> 00:21:35,380
over here is the attacker - is change if

00:21:30,580 --> 00:21:37,300
you see the last block the the attacker

00:21:35,380 --> 00:21:39,220
has changed content type and the

00:21:37,300 --> 00:21:41,410
attacker is able to change this and he

00:21:39,220 --> 00:21:43,690
is able to change this - he's able to

00:21:41,410 --> 00:21:46,570
insert or even link inside the email

00:21:43,690 --> 00:21:47,890
right so what what what what the

00:21:46,570 --> 00:21:50,200
attacker what the man-in-the-middle

00:21:47,890 --> 00:21:52,840
attack I can basically do is without

00:21:50,200 --> 00:21:55,690
knowing the key without knowing the

00:21:52,840 --> 00:21:57,880
contents of the email is able to insert

00:21:55,690 --> 00:22:00,190
a malicious link inside the email right

00:21:57,880 --> 00:22:02,710
and when when you basically decrypt your

00:22:00,190 --> 00:22:04,810
email you see this malicious link right

00:22:02,710 --> 00:22:06,760
you assume that this malicious link

00:22:04,810 --> 00:22:09,310
which you don't think is malicious in

00:22:06,760 --> 00:22:11,290
the first place is sent by friend or you

00:22:09,310 --> 00:22:13,270
know whoever has sent you and encrypted

00:22:11,290 --> 00:22:16,510
email you click on the malicious link

00:22:13,270 --> 00:22:17,920
and then you don't done right so so that

00:22:16,510 --> 00:22:20,020
I can be able to do

00:22:17,920 --> 00:22:22,690
and the reason why the attacker is able

00:22:20,020 --> 00:22:26,170
to control the first block is because in

00:22:22,690 --> 00:22:28,809
s mind the first block is always content

00:22:26,170 --> 00:22:30,940
type right so the attacker exactly knows

00:22:28,809 --> 00:22:32,559
what the first eight bytes are you know

00:22:30,940 --> 00:22:36,250
what the first six is sixteen bytes are

00:22:32,559 --> 00:22:37,840
so he's able to he's able to properly

00:22:36,250 --> 00:22:40,720
control that and you know he's able to

00:22:37,840 --> 00:22:42,670
insert this and similarly he is able to

00:22:40,720 --> 00:22:45,160
control the second block also right so

00:22:42,670 --> 00:22:47,950
similarly we can use CBC gadget and you

00:22:45,160 --> 00:22:50,380
can control the second block and what

00:22:47,950 --> 00:22:52,870
what basically happens this you you get

00:22:50,380 --> 00:22:55,570
an email you you basically get an email

00:22:52,870 --> 00:22:57,429
which has got a malicious link some of

00:22:55,570 --> 00:22:59,470
the characters of the email are known as

00:22:57,429 --> 00:23:01,990
crime some of the characters are known

00:22:59,470 --> 00:23:04,950
as Chi but if you use HTML email how

00:23:01,990 --> 00:23:08,650
many people people use HTML email

00:23:04,950 --> 00:23:10,900
excellent so if you use HTML email HTML

00:23:08,650 --> 00:23:12,970
as a standard save that if you have an

00:23:10,900 --> 00:23:15,370
honest guy character which you are not

00:23:12,970 --> 00:23:17,679
able to Zender then please don't show

00:23:15,370 --> 00:23:19,030
those characters on the screen right so

00:23:17,679 --> 00:23:20,799
if you have an honest caracal carry

00:23:19,030 --> 00:23:22,750
character which your browser or your

00:23:20,799 --> 00:23:24,400
email client is not able to render in

00:23:22,750 --> 00:23:26,830
the current language which we have said

00:23:24,400 --> 00:23:29,110
those non sk characters will be ignored

00:23:26,830 --> 00:23:31,419
and they will not be shown on the

00:23:29,110 --> 00:23:33,340
display screen so by using this the

00:23:31,419 --> 00:23:35,470
attacker is able to conveniently hide

00:23:33,340 --> 00:23:39,460
any malicious things that she has done

00:23:35,470 --> 00:23:41,980
with with with the blocks right so how

00:23:39,460 --> 00:23:44,110
we can prevent this you can use Mac

00:23:41,980 --> 00:23:46,960
right and it is very interesting that

00:23:44,110 --> 00:23:49,030
s/mime does not use Mac Mac is a method

00:23:46,960 --> 00:23:50,799
of ensuring that contents of the email

00:23:49,030 --> 00:23:54,809
or you know contents of your message are

00:23:50,799 --> 00:23:54,809
not changed but s/mime doesn't go

00:23:54,900 --> 00:24:00,669
similarly we can have a similar kind of

00:23:57,820 --> 00:24:02,590
attack on s - well and I'm just going to

00:24:00,669 --> 00:24:03,460
go through this because I want to show

00:24:02,590 --> 00:24:05,919
you something which is even more

00:24:03,460 --> 00:24:07,990
interesting so he can use a similar and

00:24:05,919 --> 00:24:10,450
you know he can kind of insert links in

00:24:07,990 --> 00:24:12,190
email right so one one thing which we

00:24:10,450 --> 00:24:15,910
which we need to understand over your if

00:24:12,190 --> 00:24:18,070
your email is encrypted right you assume

00:24:15,910 --> 00:24:20,710
that by encrypting but he will be able

00:24:18,070 --> 00:24:23,559
to change the image the attacker does

00:24:20,710 --> 00:24:25,419
not have your key right but it of that

00:24:23,559 --> 00:24:27,820
the attacker is able to modify your

00:24:25,419 --> 00:24:30,160
email right so this is very very

00:24:27,820 --> 00:24:30,980
important so we can do this with s mine

00:24:30,160 --> 00:24:32,690
as well

00:24:30,980 --> 00:24:35,330
now one thing very very important is how

00:24:32,690 --> 00:24:38,630
can we make this attack better right so

00:24:35,330 --> 00:24:40,309
we have a method of infiltrating into

00:24:38,630 --> 00:24:42,080
the emails and you know we have a method

00:24:40,309 --> 00:24:43,760
of changing the image but we can make

00:24:42,080 --> 00:24:45,290
this attack better by using something

00:24:43,760 --> 00:24:47,660
called yeah by using something called

00:24:45,290 --> 00:24:50,090
other back channel and back channels are

00:24:47,660 --> 00:24:52,820
flaws which were found in email clients

00:24:50,090 --> 00:24:54,799
I am sure you know most of you are using

00:24:52,820 --> 00:24:56,720
one of these email clients probably

00:24:54,799 --> 00:24:58,970
right so these are flaws which were

00:24:56,720 --> 00:25:01,150
found with email clients so for example

00:24:58,970 --> 00:25:04,250
in Linux if you are using Thunderbird

00:25:01,150 --> 00:25:07,429
okay in linux thunderbird is a flaw in

00:25:04,250 --> 00:25:10,070
which it will load a java script without

00:25:07,429 --> 00:25:12,230
asking for your permission at all right

00:25:10,070 --> 00:25:14,720
so if somebody sends you a email with

00:25:12,230 --> 00:25:16,580
JavaScript right it is possible for the

00:25:14,720 --> 00:25:18,650
person to hide the JavaScript in such a

00:25:16,580 --> 00:25:21,140
way then the JavaScript will run and

00:25:18,650 --> 00:25:22,880
load without your permission at all so

00:25:21,140 --> 00:25:25,340
we can use a combination of the attacks

00:25:22,880 --> 00:25:27,590
which I described some time back plus

00:25:25,340 --> 00:25:30,049
these back channels to completely own

00:25:27,590 --> 00:25:33,169
the browser or to have completely owned

00:25:30,049 --> 00:25:37,970
the email client right and since I am

00:25:33,169 --> 00:25:42,140
out of time I'll probably do a lot of

00:25:37,970 --> 00:25:43,669
things we have lost last but but but not

00:25:42,140 --> 00:25:45,679
least this is a very very good email

00:25:43,669 --> 00:25:48,500
order this is a very good link which

00:25:45,679 --> 00:25:52,540
talks about how to set up GPG in a

00:25:48,500 --> 00:25:52,540

YouTube URL: https://www.youtube.com/watch?v=wkCWxdq4NmM


