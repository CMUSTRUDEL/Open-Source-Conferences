Title: Building banter bots using natural language processing models -  Alyssa Ong - FOSSASIA 2018
Publication date: 2018-03-23
Playlist: FOSSASIA Summit 2018
Description: 
	Speaker: Alyssa Ong, Technical Evangelist Microsoft
Info: https://2018.fossasia.org/event/speakers.html#alyssa-ong3346

Having your chatbot handle your userâ€™s conversational chatter gives it another dimension of personality and improves the experience. Explore how to build and train NLP models to handle freestyle conversation, and also attempt to make a bot clone of yourself. As a bonus, we will deploy the end result to smart speakers like Cortana on Invoke, and potentially Alexa or Google Home.

Room: Lecture Theatre
Track: Artificial Intelligence
Date: Friday, 23rd March, 2018

Event Page: http://2018.fossasia.org
Follow FOSSASIA on Twitter: https://twitter.com/fossasia/
Like FOSSASIA on Facebook: https://www.facebook.com/fossasia/

Produced by Engineers.SG
Captions: 
	00:00:00,269 --> 00:00:10,460
say hi yummy

00:00:05,069 --> 00:00:10,460
is it cuz of this hey Cortana say hi

00:00:10,760 --> 00:00:18,810
hi there we go

00:00:13,500 --> 00:00:21,450
hey cool hi hi everyone I'm Alyssa and

00:00:18,810 --> 00:00:22,920
I'm a software engineer working with the

00:00:21,450 --> 00:00:25,410
commercial software engineering team at

00:00:22,920 --> 00:00:27,180
Microsoft so what we do is we work we

00:00:25,410 --> 00:00:31,199
code with customers and partners to

00:00:27,180 --> 00:00:32,730
build epic stuff basically so today I'm

00:00:31,199 --> 00:00:36,330
gonna be talking about building benter

00:00:32,730 --> 00:00:36,989
bots with NLP models and I was making my

00:00:36,330 --> 00:00:38,340
slides

00:00:36,989 --> 00:00:40,230
yes just kidding I wasn't making my

00:00:38,340 --> 00:00:43,409
slides yesterday but I was working on

00:00:40,230 --> 00:00:45,870
them and my friend sort of looked over

00:00:43,409 --> 00:00:47,850
my shoulder and he was like okay what I

00:00:45,870 --> 00:00:49,680
what what the hell I've been to bots can

00:00:47,850 --> 00:00:52,080
you please explain so I was like okay

00:00:49,680 --> 00:00:53,970
the title is not very explanatory sorry

00:00:52,080 --> 00:00:56,549
I spun the tree so I'm just gonna go

00:00:53,970 --> 00:00:58,500
through what these are so who's used a

00:00:56,549 --> 00:01:00,629
bug before probably most of you by the

00:00:58,500 --> 00:01:02,280
end of this conference Oh

00:01:00,629 --> 00:01:04,350
so a typical ball kind of looks like

00:01:02,280 --> 00:01:07,440
this okay so let's say I owned a fried

00:01:04,350 --> 00:01:09,510
chicken restaurant and my board can

00:01:07,440 --> 00:01:11,580
actually handle a limited number of

00:01:09,510 --> 00:01:13,979
things in the domain so for example

00:01:11,580 --> 00:01:16,140
people can ask me what my opening hours

00:01:13,979 --> 00:01:19,530
are and they can place bookings in my

00:01:16,140 --> 00:01:21,509
wall so how I would train the natural

00:01:19,530 --> 00:01:24,060
language model behind this using a

00:01:21,509 --> 00:01:26,159
third-party tool like Luis may be using

00:01:24,060 --> 00:01:27,359
dialog floor how I would trainer it

00:01:26,159 --> 00:01:29,100
would be something like this

00:01:27,359 --> 00:01:31,320
I'll make three different intents of

00:01:29,100 --> 00:01:33,119
what my bot can handle and then I'll

00:01:31,320 --> 00:01:36,060
train some utterances under those

00:01:33,119 --> 00:01:38,579
intents so that the bot can classify

00:01:36,060 --> 00:01:41,909
them so at its core its text analytics

00:01:38,579 --> 00:01:43,619
classification text classification so

00:01:41,909 --> 00:01:46,079
when the user says they don't have to

00:01:43,619 --> 00:01:48,359
say the exact phrase they can say I want

00:01:46,079 --> 00:01:50,939
to make a reservation table for four and

00:01:48,359 --> 00:01:53,969
we both should be able to classify that

00:01:50,939 --> 00:01:57,390
in to make booking so that's all fine

00:01:53,969 --> 00:01:59,549
and dandy but consider this scenario so

00:01:57,390 --> 00:02:02,640
the user says hello okay so what do we

00:01:59,549 --> 00:02:06,119
met that - maybe if you're using Luis or

00:02:02,640 --> 00:02:07,859
dialog Pro you say a hello intent what

00:02:06,119 --> 00:02:10,259
are the users is how are you what would

00:02:07,859 --> 00:02:12,750
you do method 2 how how are you intent

00:02:10,259 --> 00:02:13,020
maybe what is the user says tell me a

00:02:12,750 --> 00:02:15,690
joke

00:02:13,020 --> 00:02:17,250
okay one more intent maybe but what they

00:02:15,690 --> 00:02:21,459
there's just so many things that they

00:02:17,250 --> 00:02:26,409
can say to you so how do you actually am

00:02:21,459 --> 00:02:28,590
no this the issue with using Watson Luis

00:02:26,409 --> 00:02:31,420
dialog flow is that they often have

00:02:28,590 --> 00:02:32,950
intent limitations for those of you who

00:02:31,420 --> 00:02:36,159
have tried this before you be familiar

00:02:32,950 --> 00:02:41,079
with this so I think Watson and I

00:02:36,159 --> 00:02:43,989
electro have about 2000 intent limit so

00:02:41,079 --> 00:02:47,019
the question here really is how do we

00:02:43,989 --> 00:02:48,790
handle small talk how do we handle you

00:02:47,019 --> 00:02:50,799
know you know users love to test the

00:02:48,790 --> 00:02:52,209
limits of your BOTS so how do we handle

00:02:50,799 --> 00:02:56,260
all the rubbish that they're gonna throw

00:02:52,209 --> 00:02:59,230
at your body okay so the first step is

00:02:56,260 --> 00:03:01,209
to really extract the relevant noise all

00:02:59,230 --> 00:03:03,459
into a different intent so when you

00:03:01,209 --> 00:03:06,129
train your natural language model you

00:03:03,459 --> 00:03:08,319
put you know all this other random stuff

00:03:06,129 --> 00:03:10,959
that the user could say either in the

00:03:08,319 --> 00:03:13,870
small talk intent or I don't understand

00:03:10,959 --> 00:03:16,359
intent and then that routes to the small

00:03:13,870 --> 00:03:19,290
talk module inside your body so today

00:03:16,359 --> 00:03:21,879
what we're really gonna be exploring is

00:03:19,290 --> 00:03:25,810
one other techniques that we can use to

00:03:21,879 --> 00:03:28,569
handle small talk inside your body all

00:03:25,810 --> 00:03:31,120
right so before we begin on talking

00:03:28,569 --> 00:03:34,030
about the techniques it's really

00:03:31,120 --> 00:03:37,629
important to understand really the

00:03:34,030 --> 00:03:38,650
different types of NLP models that you

00:03:37,629 --> 00:03:41,109
can have all the different kind of

00:03:38,650 --> 00:03:43,840
conversational BOTS that you can have so

00:03:41,109 --> 00:03:46,689
this is what we can do currently in the

00:03:43,840 --> 00:03:48,729
near future so there's the idea of open

00:03:46,689 --> 00:03:50,500
domain versus closed domain closed

00:03:48,729 --> 00:03:52,030
domain means there's a limited amount of

00:03:50,500 --> 00:03:54,879
stuff that your part can talk about and

00:03:52,030 --> 00:03:58,180
the scope is really you know controlled

00:03:54,879 --> 00:03:59,979
by you open domain means if the if

00:03:58,180 --> 00:04:02,229
someone is talking to my fried chicken

00:03:59,979 --> 00:04:03,849
restaurant bot they'll be able to have a

00:04:02,229 --> 00:04:06,280
conversation about home loans at the

00:04:03,849 --> 00:04:09,069
same time so yeah your button has to be

00:04:06,280 --> 00:04:10,900
able to handle anything out there which

00:04:09,069 --> 00:04:13,689
is why it's so difficult and right now

00:04:10,900 --> 00:04:15,040
we are looking at closed domain so

00:04:13,689 --> 00:04:17,440
there's the idea of retrieval based

00:04:15,040 --> 00:04:22,090
versus generative based a retrieval

00:04:17,440 --> 00:04:24,729
based is when your but is the responses

00:04:22,090 --> 00:04:27,699
of your bot are all predefined so if

00:04:24,729 --> 00:04:30,340
someone asks me to make a booking the

00:04:27,699 --> 00:04:32,620
bot says sure what time what you like

00:04:30,340 --> 00:04:34,190
the booking to be so all the responses

00:04:32,620 --> 00:04:36,770
are pre scripted by you

00:04:34,190 --> 00:04:39,380
whereas we've generated based your

00:04:36,770 --> 00:04:40,880
button is actually creating the answers

00:04:39,380 --> 00:04:45,230
on the fly and we're going to be

00:04:40,880 --> 00:04:47,480
discussing how to do this as well all

00:04:45,230 --> 00:04:49,370
right so here are some the options that

00:04:47,480 --> 00:04:52,100
I'm gonna be talking about today

00:04:49,370 --> 00:04:54,380
so under close domain and retrieval will

00:04:52,100 --> 00:04:57,620
go home is still talking to me for some

00:04:54,380 --> 00:05:00,020
reason under close I mean a retrieval we

00:04:57,620 --> 00:05:02,180
could use a third party in our P service

00:05:00,020 --> 00:05:04,640
so I'll be going through a Microsoft Q&A

00:05:02,180 --> 00:05:07,390
maker which is like the easiest way to

00:05:04,640 --> 00:05:10,220
get set up and then we can look at

00:05:07,390 --> 00:05:13,370
medium level medium difficulty options

00:05:10,220 --> 00:05:15,680
so that's custom classifiers like maybe

00:05:13,370 --> 00:05:18,080
a classifier from scikit-learn or not

00:05:15,680 --> 00:05:20,150
natural package and then there's a cool

00:05:18,080 --> 00:05:21,890
Python package called cheddar bot that

00:05:20,150 --> 00:05:23,960
I'll be discussing as well and then

00:05:21,890 --> 00:05:35,420
lastly we'll be discussing the hard

00:05:23,960 --> 00:05:40,070
option which is the Arlen alright so the

00:05:35,420 --> 00:05:42,440
easy option this is using a corpus so

00:05:40,070 --> 00:05:46,610
that's a body of text that you want to

00:05:42,440 --> 00:05:48,710
train the button on and Q&A maker so Q&A

00:05:46,610 --> 00:05:51,380
Maker is like a knowledgebase as as a

00:05:48,710 --> 00:05:53,660
service there's no intent on them

00:05:51,380 --> 00:05:56,120
there's no limitations on the intent but

00:05:53,660 --> 00:05:59,060
it's a twenty megabytes page limit but

00:05:56,120 --> 00:06:04,600
that's still a lot of text so just quick

00:05:59,060 --> 00:06:12,500
demo how that would look like okay so

00:06:04,600 --> 00:06:22,220
yeah shameless plug but never mind hey

00:06:12,500 --> 00:06:26,510
Google be quiet wait keeps talking to me

00:06:22,220 --> 00:06:28,310
okay so basically what I have here is a

00:06:26,510 --> 00:06:32,030
small talk module for the bot framework

00:06:28,310 --> 00:06:33,620
but really you can use this for anything

00:06:32,030 --> 00:06:39,050
else I've just used that a Shabbat

00:06:33,620 --> 00:06:40,400
service so there's this TSV file that

00:06:39,050 --> 00:06:43,250
will act as the

00:06:40,400 --> 00:06:45,380
knowledge base for your bot dialogue

00:06:43,250 --> 00:06:47,180
flow actually has a small talk module

00:06:45,380 --> 00:06:49,370
but they have internal mutations as well

00:06:47,180 --> 00:06:51,110
so I actually took this out of dialogue

00:06:49,370 --> 00:06:53,479
flow and put it into a CSV file that you

00:06:51,110 --> 00:06:56,900
can use anywhere and train any model you

00:06:53,479 --> 00:06:59,240
want so yeah okay so we have the

00:06:56,900 --> 00:07:02,090
question and we had the type of answer

00:06:59,240 --> 00:07:06,380
that it relates to so let's go to Q&A

00:07:02,090 --> 00:07:08,660
maker and try to create a new service so

00:07:06,380 --> 00:07:23,389
I can name your service just call it

00:07:08,660 --> 00:07:25,879
small talk demo and then click create so

00:07:23,389 --> 00:07:29,599
this takes

00:07:25,879 --> 00:07:34,029
thirty seconds max maybe so everything

00:07:29,599 --> 00:07:34,029
is now loaded into your knowledge base

00:07:38,080 --> 00:07:45,550
okay so I can say something like how are

00:07:43,159 --> 00:07:45,550
you doing

00:07:47,659 --> 00:07:51,729
maybe I say it's my birthday it's not

00:07:50,899 --> 00:07:55,219
bad

00:07:51,729 --> 00:07:57,319
yeah so there's I I think 1,500

00:07:55,219 --> 00:07:58,969
different other answers in there that

00:07:57,319 --> 00:08:02,449
it's trained on so this is something you

00:07:58,969 --> 00:08:05,689
can plug into whatever whatever you're

00:08:02,449 --> 00:08:08,779
building so if I click on publish you

00:08:05,689 --> 00:08:12,499
can just easily publish it as a web

00:08:08,779 --> 00:08:15,589
service just like that and then in my

00:08:12,499 --> 00:08:17,509
bot what I'm what I have is a reference

00:08:15,589 --> 00:08:22,569
so these are the different responses

00:08:17,509 --> 00:08:26,629
that could that could match to this

00:08:22,569 --> 00:08:29,110
intent for example so if I go okay let's

00:08:26,629 --> 00:08:29,110
do this

00:08:39,310 --> 00:08:47,470
who wants to say something to it I can't

00:08:42,020 --> 00:08:47,470
think of anything I said tell me a joke

00:08:48,070 --> 00:08:59,720
okay no way yeah so you can see now I

00:08:55,790 --> 00:09:08,840
just what I've actually done in the code

00:08:59,720 --> 00:09:11,210
is is plug in the justjust make a post

00:09:08,840 --> 00:09:16,040
request to the Q&A maker that I made and

00:09:11,210 --> 00:09:19,010
then do do a match to reply with the

00:09:16,040 --> 00:09:22,550
appropriate response so yeah that's how

00:09:19,010 --> 00:09:25,940
you can use Q&A maker and the pros and

00:09:22,550 --> 00:09:28,250
cons of this are it's super duper easy

00:09:25,940 --> 00:09:29,450
to get started so as I showed you you

00:09:28,250 --> 00:09:32,960
know it's really easy to get started

00:09:29,450 --> 00:09:37,040
with deploying a small talk model as a

00:09:32,960 --> 00:09:39,350
web service the issue is that it's sorry

00:09:37,040 --> 00:09:41,240
and also a control domain so you know

00:09:39,350 --> 00:09:43,840
your bar won't go crazy and say weird

00:09:41,240 --> 00:09:47,360
stuff because you script those responses

00:09:43,840 --> 00:09:49,100
and also it's NLP as a service so

00:09:47,360 --> 00:09:51,530
Microsoft has researchers and

00:09:49,100 --> 00:09:54,350
development teams to literally maintain

00:09:51,530 --> 00:09:57,020
this as a service now the cons of it is

00:09:54,350 --> 00:09:59,810
that creating that knowledge base can be

00:09:57,020 --> 00:10:01,580
a very very manual process and there's

00:09:59,810 --> 00:10:03,140
no variation in your responses so

00:10:01,580 --> 00:10:04,810
they're pretty steady and there's a 20

00:10:03,140 --> 00:10:08,990
megabyte limit to it

00:10:04,810 --> 00:10:12,470
cool so with that let's move on to maybe

00:10:08,990 --> 00:10:14,150
using a classic custom classifier so

00:10:12,470 --> 00:10:17,210
this is also retriever based closed

00:10:14,150 --> 00:10:20,720
domain you can really use the data that

00:10:17,210 --> 00:10:24,950
I provided that that 1500 lines and

00:10:20,720 --> 00:10:28,790
train your maybe classifier on not

00:10:24,950 --> 00:10:34,280
natural or you know like like user base

00:10:28,790 --> 00:10:36,920
naive based or SVM on scikit-learn so

00:10:34,280 --> 00:10:38,839
what happens is then when the user ask

00:10:36,920 --> 00:10:39,770
something to your small talk module you

00:10:38,839 --> 00:10:41,660
will match it to the appropriate

00:10:39,770 --> 00:10:44,720
response so same same

00:10:41,660 --> 00:10:47,660
concept as before but using you know an

00:10:44,720 --> 00:10:52,390
open-source classifier insane all right

00:10:47,660 --> 00:10:57,980
so let's pick a demo using natural

00:10:52,390 --> 00:11:00,350
where's my goal okay

00:10:57,980 --> 00:11:06,290
so I've written this small script over

00:11:00,350 --> 00:11:08,900
here that basically takes in the TSB

00:11:06,290 --> 00:11:11,390
file and adds it to the classifier and

00:11:08,900 --> 00:11:13,790
then train to Train sit at the end and

00:11:11,390 --> 00:11:15,860
then once it trains that classifier it

00:11:13,790 --> 00:11:19,450
saves it as a model that you can load

00:11:15,860 --> 00:11:19,450
load in at any time

00:11:21,640 --> 00:11:38,210
okay Google be quiet okay and then in

00:11:32,150 --> 00:11:40,490
the in the code you can then let me just

00:11:38,210 --> 00:11:42,350
try to find okay you can then load and

00:11:40,490 --> 00:11:44,000
load in your classifier so this is my

00:11:42,350 --> 00:11:47,420
classifier that I've loaded in from the

00:11:44,000 --> 00:11:49,760
JSON file and then you do a classifier

00:11:47,420 --> 00:11:53,840
based on text and then you just respond

00:11:49,760 --> 00:11:56,420
using using whatever intent that's been

00:11:53,840 --> 00:11:58,940
matched so it's a same concept as before

00:11:56,420 --> 00:12:02,000
except using yeah except using the

00:11:58,940 --> 00:12:04,640
network to do it instead this isn't a my

00:12:02,000 --> 00:12:08,720
repository yet but I'll be pushing this

00:12:04,640 --> 00:12:11,180
sometime today or next week hey so for

00:12:08,720 --> 00:12:16,100
variation let's try testing it on one of

00:12:11,180 --> 00:12:20,750
these devices hey Cortana yep nice to me

00:12:16,100 --> 00:12:26,840
oh okay go away I lost the thread there

00:12:20,750 --> 00:12:34,820
okay so you phrase it another way tell

00:12:26,840 --> 00:12:37,040
tiny I said hello hi there friend

00:12:34,820 --> 00:12:40,160
so basically I've deployed a bot called

00:12:37,040 --> 00:12:42,050
tiny and it's connected to this invoked

00:12:40,160 --> 00:12:43,360
speaker and it's actually calling the

00:12:42,050 --> 00:12:47,949
edge about service in the back

00:12:43,360 --> 00:12:48,970
and running this code over here hey hey

00:12:47,949 --> 00:12:59,259
Cortana yeah

00:12:48,970 --> 00:13:00,339
tell tiny I said are you a bot hey

00:12:59,259 --> 00:13:09,720
Cortana yep

00:13:00,339 --> 00:13:12,579
tell tiny I said are you a bot I see

00:13:09,720 --> 00:13:16,779
what hey tiny

00:13:12,579 --> 00:13:17,649
sorry hey Cortana tell tiny I said nice

00:13:16,779 --> 00:13:25,029
to meet you

00:13:17,649 --> 00:13:27,480
I think this is the beginning of a

00:13:25,029 --> 00:13:27,480
beautiful friendship

00:13:28,049 --> 00:13:32,559
okay now that's right Google so I

00:13:30,489 --> 00:13:35,470
deployed the same a Shabbat service on

00:13:32,559 --> 00:13:37,779
the Google home you can deploy it to

00:13:35,470 --> 00:13:39,040
Alexa as well so you know you can really

00:13:37,779 --> 00:13:42,929
create a bot using both service and

00:13:39,040 --> 00:13:49,660
deploy to any way you want hey Google

00:13:42,929 --> 00:13:52,199
talk to small sorry hey Google talk to a

00:13:49,660 --> 00:13:52,199
tiny demo

00:13:59,920 --> 00:14:03,310
what's your name

00:14:09,650 --> 00:14:22,580
tell me a joke I'm bored

00:14:28,509 --> 00:14:35,589
okay I don't know if anyone heard that

00:14:31,480 --> 00:14:37,660
but that was a really bad job okay so

00:14:35,589 --> 00:14:39,550
yeah you can see that you can really

00:14:37,660 --> 00:14:41,470
deploy these models on many different

00:14:39,550 --> 00:14:44,139
voice platforms you can deploy it on

00:14:41,470 --> 00:14:45,369
messenger telegram etc or whatever you

00:14:44,139 --> 00:14:51,160
like cool

00:14:45,369 --> 00:14:54,040
all right so moving on okay so the

00:14:51,160 --> 00:14:55,600
difference between with like the pros

00:14:54,040 --> 00:14:57,999
and cons I'm using your own custom

00:14:55,600 --> 00:15:01,059
classifier is that of course it's open

00:14:57,999 --> 00:15:02,709
source so it's more customizable again

00:15:01,059 --> 00:15:06,490
there's a control domain so it won't go

00:15:02,709 --> 00:15:09,279
crazy and you can really use whatever

00:15:06,490 --> 00:15:12,119
knowledgebase size that you want and the

00:15:09,279 --> 00:15:15,550
cons of it is that you have to really

00:15:12,119 --> 00:15:16,420
improve this model yourself so when you

00:15:15,550 --> 00:15:18,100
build a model

00:15:16,420 --> 00:15:20,559
maybe the accuracy isn't that good and

00:15:18,100 --> 00:15:22,720
then you have to run like a parameter

00:15:20,559 --> 00:15:24,309
tuning bah-bah-bah you have to do all of

00:15:22,720 --> 00:15:27,189
that yourself and manage the department

00:15:24,309 --> 00:15:29,259
as well again creating the knowledge

00:15:27,189 --> 00:15:31,899
base can be very manual since it's all

00:15:29,259 --> 00:15:34,480
retrieval based and there's no variation

00:15:31,899 --> 00:15:37,139
on the responses it's all static the

00:15:34,480 --> 00:15:40,179
stuff that you have hard-coded in it

00:15:37,139 --> 00:15:43,360
okay so the third one the third option

00:15:40,179 --> 00:15:46,059
we have was chat a bot so what chatter

00:15:43,360 --> 00:15:48,160
bot is is an open source Python library

00:15:46,059 --> 00:15:51,610
developed by this person called Gunther

00:15:48,160 --> 00:15:55,480
conks and he has a bunch of pre-built

00:15:51,610 --> 00:15:57,429
corpuses dead oh my goodness they're

00:15:55,480 --> 00:16:01,509
available in many different languages

00:15:57,429 --> 00:16:03,459
and you put this on the ground sorry I

00:16:01,509 --> 00:16:05,650
can't help with that but I'm always

00:16:03,459 --> 00:16:12,240
learning

00:16:05,650 --> 00:16:15,430
Oh so yeah in in the background this

00:16:12,240 --> 00:16:18,779
this chat about currently uses a

00:16:15,430 --> 00:16:21,130
combination of search and naive base

00:16:18,779 --> 00:16:23,410
because it's open source you can cut you

00:16:21,130 --> 00:16:26,200
can customize this but it's probably a

00:16:23,410 --> 00:16:29,380
little bit harder ok so just showing you

00:16:26,200 --> 00:16:32,110
it's always easier to show you then talk

00:16:29,380 --> 00:16:37,450
about it ok so this is a Python library

00:16:32,110 --> 00:16:41,350
and what I've done here is you can

00:16:37,450 --> 00:16:43,480
actually put in a you can plug in you

00:16:41,350 --> 00:16:45,610
can plug in corpuses like this so check

00:16:43,480 --> 00:16:48,160
box rain chat about corporate English

00:16:45,610 --> 00:16:50,610
and where this is coming from so this is

00:16:48,160 --> 00:16:54,250
the main repository but he's got a

00:16:50,610 --> 00:16:58,720
corpus repository as well and this has a

00:16:54,250 --> 00:17:03,370
bunch of datasets all in different these

00:16:58,720 --> 00:17:05,530
different languages and under English

00:17:03,370 --> 00:17:10,329
there's all these different things that

00:17:05,530 --> 00:17:12,010
the bot can talk about so yeah you can

00:17:10,329 --> 00:17:16,420
see all the things that the button is

00:17:12,010 --> 00:17:19,300
trained on and you can also embed your

00:17:16,420 --> 00:17:25,260
own custom custom corpuses that you want

00:17:19,300 --> 00:17:28,750
so just one line over here this one line

00:17:25,260 --> 00:17:34,230
trains all trains the bots on all of

00:17:28,750 --> 00:17:34,230
this yeah so let's test it

00:17:50,770 --> 00:18:00,860
who is Albert Einstein

00:17:54,380 --> 00:18:05,960
uh I don't quite think so too bad okay

00:18:00,860 --> 00:18:12,770
uh huh what's the meaning of life that's

00:18:05,960 --> 00:18:13,790
new oh okay never mind you you get oh

00:18:12,770 --> 00:18:18,460
you get the idea

00:18:13,790 --> 00:18:18,460
oops so saying nice to meet you as well

00:18:18,640 --> 00:18:26,690
okay anyway yeah you get the idea it can

00:18:23,960 --> 00:18:28,400
see the thing is that a response that

00:18:26,690 --> 00:18:30,140
doesn't make sense is sometimes better

00:18:28,400 --> 00:18:34,580
than no response at all because it's a

00:18:30,140 --> 00:18:36,950
bit funny as well okay so the advantages

00:18:34,580 --> 00:18:40,460
of using cheddar board is that it's more

00:18:36,950 --> 00:18:42,440
customizable open-source as well it's

00:18:40,460 --> 00:18:45,230
it's really similar to the advantages of

00:18:42,440 --> 00:18:48,590
using the previous few options that we

00:18:45,230 --> 00:18:50,780
had and the disadvantages is also

00:18:48,590 --> 00:18:55,790
similar to the previous view um options

00:18:50,780 --> 00:18:58,100
that we had so yeah it just uses search

00:18:55,790 --> 00:19:00,350
and naive base at the moment but I mean

00:18:58,100 --> 00:19:04,400
you you can tweak that on your own to

00:19:00,350 --> 00:19:06,890
improve the improve the responses okay

00:19:04,400 --> 00:19:09,440
so I think I'm running out of time so

00:19:06,890 --> 00:19:13,580
we're gonna go straight into the RNN so

00:19:09,440 --> 00:19:17,240
this is a little bit harder and this

00:19:13,580 --> 00:19:21,020
will let you create generative BOTS so

00:19:17,240 --> 00:19:22,610
not just you don't have to write in all

00:19:21,020 --> 00:19:24,860
your static responses that you want your

00:19:22,610 --> 00:19:28,310
BOTS to answer you can actually get the

00:19:24,860 --> 00:19:31,720
bots to make make its own sentences

00:19:28,310 --> 00:19:33,860
based on data that you've trained it on

00:19:31,720 --> 00:19:36,620
so the idea behind recurrent neural

00:19:33,860 --> 00:19:38,480
network I should explain this so

00:19:36,620 --> 00:19:41,920
one-to-one that's not an iron end that's

00:19:38,480 --> 00:19:45,260
a classic model so you have a fixed size

00:19:41,920 --> 00:19:47,750
vector usually and then you have a fixed

00:19:45,260 --> 00:19:49,850
output so for example if you're trying

00:19:47,750 --> 00:19:54,110
to do image classification you put in

00:19:49,850 --> 00:19:57,380
one image and then you classify is it a

00:19:54,110 --> 00:19:58,790
cat or a dog for example so put in one

00:19:57,380 --> 00:20:00,050
image and then it makes one

00:19:58,790 --> 00:20:03,050
classification the

00:20:00,050 --> 00:20:05,540
that's the one to one and then Ireland's

00:20:03,050 --> 00:20:07,760
are sort of this sequential hidden

00:20:05,540 --> 00:20:09,680
layers so one so many for example you

00:20:07,760 --> 00:20:14,570
put in an image and it generates a

00:20:09,680 --> 00:20:16,670
caption the outputs are many because

00:20:14,570 --> 00:20:19,370
when you generate a caption your caption

00:20:16,670 --> 00:20:22,000
kind of has to make sense as a whole so

00:20:19,370 --> 00:20:26,690
maybe like a person sitting on a chair

00:20:22,000 --> 00:20:30,020
all the words all relate to each other

00:20:26,690 --> 00:20:33,980
in the same sentence so many to one will

00:20:30,020 --> 00:20:36,050
be for instance if if you're taking in

00:20:33,980 --> 00:20:38,630
someone's tweet and you're trying to

00:20:36,050 --> 00:20:40,700
predict whether it's whether it's

00:20:38,630 --> 00:20:45,350
positive sentiment or negative sentiment

00:20:40,700 --> 00:20:47,750
and then lastly many-to-many is kind of

00:20:45,350 --> 00:20:51,350
the thing that we'll be doing today so

00:20:47,750 --> 00:20:53,720
let me just explain here okay running

00:20:51,350 --> 00:20:55,310
out of time so I'll just quickly explain

00:20:53,720 --> 00:21:01,100
what this is doing here

00:20:55,310 --> 00:21:03,020
so in an RNN 101 um you're trying to put

00:21:01,100 --> 00:21:10,390
in input you're trying to all right

00:21:03,020 --> 00:21:10,390
oh no okay let me just duplicate this

00:21:12,880 --> 00:21:20,270
okay anyway in a nutshell your hidden

00:21:17,450 --> 00:21:23,570
layers each depend on the previous

00:21:20,270 --> 00:21:25,670
layers yeah your hidden layers each

00:21:23,570 --> 00:21:27,080
depend on the input of the previous

00:21:25,670 --> 00:21:30,530
layers to come up with the next

00:21:27,080 --> 00:21:32,480
prediction in a nutshell so that's why I

00:21:30,530 --> 00:21:34,520
earnings are good for if you need a

00:21:32,480 --> 00:21:36,140
context of the previous words to come up

00:21:34,520 --> 00:21:39,830
with the next word or character in this

00:21:36,140 --> 00:21:43,010
case okay so quick demo of the Cornell

00:21:39,830 --> 00:21:45,710
movie corpus so this person over here

00:21:43,010 --> 00:21:47,930
I've provided a model thankfully so I

00:21:45,710 --> 00:21:50,690
didn't have to write it myself but I

00:21:47,930 --> 00:21:54,700
trained this in a editor Ezra and series

00:21:50,690 --> 00:21:57,470
on VM for about 16 hours so it's

00:21:54,700 --> 00:21:58,880
conversational exchanges from two

00:21:57,470 --> 00:21:59,350
hundred twenty thousand five hundred and

00:21:58,880 --> 00:22:02,740
seventy

00:21:59,350 --> 00:22:10,330
and conversations in a movie so let's

00:22:02,740 --> 00:22:12,340
see what that looks like so the results

00:22:10,330 --> 00:22:15,610
were okay it was kind of hit and miss

00:22:12,340 --> 00:22:20,280
for some sentences okay I need to go

00:22:15,610 --> 00:22:20,280
inside it's using tensorflow 1.0 so

00:22:21,360 --> 00:22:31,450
where's his name so long it's gonna take

00:22:28,180 --> 00:22:48,220
a while to boot up so it's just

00:22:31,450 --> 00:22:54,000
restoring the restoring the model okay

00:22:48,220 --> 00:22:54,000
so if I say hello how are you

00:23:31,970 --> 00:23:38,390
okay I'm not sure why doing that maybe

00:23:33,920 --> 00:23:40,490
I'll come back to it okay let me just

00:23:38,390 --> 00:23:43,670
demoed the second one I don't know why

00:23:40,490 --> 00:23:46,040
it usually doesn't do that but oh well

00:23:43,670 --> 00:23:50,240
live demo so I took the risk

00:23:46,040 --> 00:23:52,910
oh okay so there's a second one

00:23:50,240 --> 00:23:54,740
that's a Arnon trained on reddit

00:23:52,910 --> 00:23:58,790
comments everyone knows this is a super

00:23:54,740 --> 00:24:01,700
bed super bad idea but nevermind let's

00:23:58,790 --> 00:24:05,390
try it anyway so warning the chat bot

00:24:01,700 --> 00:24:08,960
may swear it may say some inappropriate

00:24:05,390 --> 00:24:11,720
things so if you can't if you don't like

00:24:08,960 --> 00:24:13,730
that then yeah you can turn around or

00:24:11,720 --> 00:24:17,720
something like that so these are some

00:24:13,730 --> 00:24:19,820
funny lines that I got from it so it

00:24:17,720 --> 00:24:21,620
took about five turns or four turns

00:24:19,820 --> 00:24:25,390
before it started calling me an idiot so

00:24:21,620 --> 00:24:28,730
that's the state of what Radian is

00:24:25,390 --> 00:24:30,980
sometimes it can even be sweet so it

00:24:28,730 --> 00:24:33,040
says waves and hugs you so obviously

00:24:30,980 --> 00:24:35,630
people have on the internet put things

00:24:33,040 --> 00:24:37,490
put actions around stars and the iron

00:24:35,630 --> 00:24:41,240
and has kind of learned how to do that

00:24:37,490 --> 00:24:42,440
as well this one is interesting I have a

00:24:41,240 --> 00:24:44,480
pretty good relationship with my

00:24:42,440 --> 00:24:50,360
boyfriend it's like okay sure

00:24:44,480 --> 00:24:51,470
before you and him this one is like it

00:24:50,360 --> 00:24:54,110
kind of came up with something that

00:24:51,470 --> 00:24:55,670
didn't make sense and then I was like

00:24:54,110 --> 00:24:59,480
don't be here yep and it's a thank you

00:24:55,670 --> 00:25:01,520
for the inside so those are pretty good

00:24:59,480 --> 00:25:03,170
on as well and then this one was kind of

00:25:01,520 --> 00:25:05,750
disturbing cuz I was are you gonna kill

00:25:03,170 --> 00:25:07,640
humans and then the bot was what does

00:25:05,750 --> 00:25:09,500
that have to do with anything I having

00:25:07,640 --> 00:25:14,870
self casting and it kind of divert the

00:25:09,500 --> 00:25:20,390
topic so it's like yeah oh my god okay

00:25:14,870 --> 00:25:23,930
okay so hopefully this will work where

00:25:20,390 --> 00:25:26,480
did I put it in sorry I know I'm running

00:25:23,930 --> 00:25:29,920
a kind of overtime but I mean this is

00:25:26,480 --> 00:25:29,920
this is quite interesting so

00:25:34,269 --> 00:26:14,459
oh okay this work but it doesn't say uh

00:26:02,429 --> 00:26:14,459
oh no no no no okay okay nice not again

00:26:16,229 --> 00:26:20,669
no one put this on social media please

00:26:24,700 --> 00:26:30,230
haha

00:26:26,590 --> 00:26:42,410
no but I cleared it pretty fast so okay

00:26:30,230 --> 00:26:43,730
I was hoping you wouldn't say that okay

00:26:42,410 --> 00:26:44,840
that's anyone want to shoot something at

00:26:43,730 --> 00:26:48,460
it please don't say anything offensive

00:26:44,840 --> 00:26:48,460
cuz it's gonna say something even worse

00:26:48,640 --> 00:26:55,930
okay does anyone want to try anything

00:26:57,310 --> 00:27:13,190
okay not sure it's gonna reply with

00:27:05,030 --> 00:27:14,390
something that makes sense so you can

00:27:13,190 --> 00:27:16,420
see it's predicting character by

00:27:14,390 --> 00:27:16,420
character

00:27:19,299 --> 00:27:25,970
uh-oh

00:27:20,630 --> 00:27:33,110
no no no no no no no no if you weren't

00:27:25,970 --> 00:27:45,769
allowed to pay that okay Oh what happens

00:27:33,110 --> 00:27:51,909
if you say this oh this is okay anyone

00:27:45,769 --> 00:27:51,909
want to try anything yeah I think what

00:27:52,539 --> 00:27:55,539
okay

00:28:00,370 --> 00:28:07,700
don't be offensive please Oh what do you

00:28:04,790 --> 00:28:10,059
mean who wants to say something to it

00:28:07,700 --> 00:28:10,059
next

00:28:27,040 --> 00:28:31,960
[Laughter]

00:28:37,890 --> 00:28:43,410
yeah

00:28:39,400 --> 00:28:47,980
so yeah interesting interesting results

00:28:43,410 --> 00:28:50,340
better sorry okay let's try one more one

00:28:47,980 --> 00:28:50,340
last one

00:28:54,300 --> 00:28:58,290
okay it's asking what you mean by that

00:28:56,470 --> 00:29:01,320
again okay

00:28:58,290 --> 00:29:02,280
anyway yeah definitely try this report

00:29:01,320 --> 00:29:04,410
you've got time

00:29:02,280 --> 00:29:07,200
okay so quick bits of the last two

00:29:04,410 --> 00:29:09,240
slides so the good thing about this is

00:29:07,200 --> 00:29:11,550
that it's generative so you train it on

00:29:09,240 --> 00:29:14,580
a whole body of text and it can generate

00:29:11,550 --> 00:29:16,290
some really entertaining stuff bad thing

00:29:14,580 --> 00:29:18,240
about it is that it's really hard to

00:29:16,290 --> 00:29:19,920
control if you guys remember Microsoft's

00:29:18,240 --> 00:29:22,680
first experiment called take that

00:29:19,920 --> 00:29:23,970
totally went off the rockers so yeah

00:29:22,680 --> 00:29:27,810
that's that's one of the tough things

00:29:23,970 --> 00:29:29,430
about using iron okay so to summarize we

00:29:27,810 --> 00:29:32,370
export these different options that you

00:29:29,430 --> 00:29:34,640
could use close domain close domain

00:29:32,370 --> 00:29:36,480
retrieval versus close domain generative

00:29:34,640 --> 00:29:38,040
it's not either/or

00:29:36,480 --> 00:29:40,830
you can choose to combine them if you

00:29:38,040 --> 00:29:42,330
want so just really experiment get into

00:29:40,830 --> 00:29:44,880
it and have fun with it

00:29:42,330 --> 00:29:50,219
cool thank you

00:29:44,880 --> 00:29:50,219
[Applause]

00:30:06,680 --> 00:30:11,060
[Laughter]

00:30:12,060 --> 00:30:14,520

YouTube URL: https://www.youtube.com/watch?v=Ww3qV35s9Q8


