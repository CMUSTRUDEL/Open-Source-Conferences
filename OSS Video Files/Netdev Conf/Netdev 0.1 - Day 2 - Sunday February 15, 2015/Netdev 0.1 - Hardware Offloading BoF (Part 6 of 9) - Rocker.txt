Title: Netdev 0.1 - Hardware Offloading BoF (Part 6 of 9) - Rocker
Publication date: 2015-04-07
Playlist: Netdev 0.1 - Day 2 - Sunday February 15, 2015
Description: 
	Rocker and Switch Offloading
Scott Feldman
February 2015

Part 6 of 9 in the Hardware Offloading BoF series

This video is licensed under Creative Commons Attribution-ShareAlike 4.0 International license. Feel free to download and distribute.
Captions: 
	00:00:01,610 --> 00:00:09,830
hi everybody I'm Scott Feldman and had

00:00:07,470 --> 00:00:16,470
some bad news to report today it's the

00:00:09,830 --> 00:00:20,160
rocker it's 2015 and earth is the last

00:00:16,470 --> 00:00:25,619
planet in the Federation to get a switch

00:00:20,160 --> 00:00:27,660
device driver model and it's Colonel the

00:00:25,619 --> 00:00:29,670
good news is we're the first planet to

00:00:27,660 --> 00:00:42,030
have all of our flow API stuff sort of

00:00:29,670 --> 00:00:47,820
sort it out okay let's see so rocker is

00:00:42,030 --> 00:00:50,969
a device it's an emulated device that

00:00:47,820 --> 00:00:56,460
Giri where's Jerry scan and he's back

00:00:50,969 --> 00:00:59,629
there Jerry and I kind of invented to

00:00:56,460 --> 00:01:01,559
fill a gap I want to go too much into

00:00:59,629 --> 00:01:04,049
details of rocker because there's

00:01:01,559 --> 00:01:07,770
actually a talk on Tuesday that I'm

00:01:04,049 --> 00:01:10,770
giving on it and but the gap we're

00:01:07,770 --> 00:01:14,070
trying to fill is the development of

00:01:10,770 --> 00:01:16,140
this switch to driver model so let me

00:01:14,070 --> 00:01:17,970
define what that is that when I say

00:01:16,140 --> 00:01:23,070
switch to driver model I mean a in

00:01:17,970 --> 00:01:28,430
kernel driver model for switches to

00:01:23,070 --> 00:01:33,750
offload the forwarding data plane okay

00:01:28,430 --> 00:01:35,970
and we invent we had we built rocker a

00:01:33,750 --> 00:01:40,860
device and emulate a device that runs in

00:01:35,970 --> 00:01:43,130
qemu because it really wasn't an

00:01:40,860 --> 00:01:49,140
enterprise-class switch available

00:01:43,130 --> 00:01:52,020
without signing in DA's or SL ways to

00:01:49,140 --> 00:01:53,880
get access to an SDK and even if you had

00:01:52,020 --> 00:01:57,210
access to the SDK it's not something

00:01:53,880 --> 00:02:00,540
that's really something you can upstream

00:01:57,210 --> 00:02:03,060
or you know GPL into the kernel as a as

00:02:00,540 --> 00:02:04,979
a device driver so we just said let's

00:02:03,060 --> 00:02:07,969
just make a device and that's what

00:02:04,979 --> 00:02:07,969
rocker is and

00:02:08,220 --> 00:02:17,040
there's a rocker driver now in the

00:02:10,320 --> 00:02:20,880
kernel and today I would say we pretty

00:02:17,040 --> 00:02:25,530
much got l2 working there's a few loose

00:02:20,880 --> 00:02:28,950
ends Roopa mentioned a couple so we're

00:02:25,530 --> 00:02:31,680
able to help we're able to offload you

00:02:28,950 --> 00:02:34,380
just use all your standard Linux tools

00:02:31,680 --> 00:02:36,570
that create bridges and set properties

00:02:34,380 --> 00:02:38,970
on ports on a bridge and everything and

00:02:36,570 --> 00:02:42,810
put these rocker switch ports into the

00:02:38,970 --> 00:02:49,140
bridge and rocker will in combination

00:02:42,810 --> 00:02:52,530
with a driver offload the the l2

00:02:49,140 --> 00:02:54,810
forwarding or switching I'm also working

00:02:52,530 --> 00:02:58,380
on or what's in work in progress right

00:02:54,810 --> 00:03:00,470
now is doing the same for l3 and this

00:02:58,380 --> 00:03:02,520
conference been really good because a

00:03:00,470 --> 00:03:04,230
lot of people just been thinking about

00:03:02,520 --> 00:03:06,300
it as they sleep and I wake up the next

00:03:04,230 --> 00:03:09,300
morning and and have ideas including

00:03:06,300 --> 00:03:11,790
myself so I think a lot of the problems

00:03:09,300 --> 00:03:13,650
are known and solved at least in our

00:03:11,790 --> 00:03:17,130
heads and we'll try to get some patches

00:03:13,650 --> 00:03:18,660
out for l3 to add the device driver

00:03:17,130 --> 00:03:21,510
model support for that and have that

00:03:18,660 --> 00:03:23,280
offloaded to the rocker device after

00:03:21,510 --> 00:03:26,040
that well there's other people working

00:03:23,280 --> 00:03:28,530
on rocker that I became aware of this

00:03:26,040 --> 00:03:32,610
this conference also doing things like

00:03:28,530 --> 00:03:34,050
trying to offload NF tables or seems

00:03:32,610 --> 00:03:36,870
like there's something else that escapes

00:03:34,050 --> 00:03:41,239
me all John uses it also for a little

00:03:36,870 --> 00:03:41,239
bit of prototyping on his his flow API

00:03:43,030 --> 00:03:46,410
David's using it

00:03:47,720 --> 00:03:54,230
yeah yeah so there's I don't know what

00:03:52,130 --> 00:03:59,000
what's going to I mean I know we know

00:03:54,230 --> 00:04:01,340
for the switchdriver model that we're

00:03:59,000 --> 00:04:03,110
trying to create for that gold offload

00:04:01,340 --> 00:04:06,140
the forwarding data plane from the

00:04:03,110 --> 00:04:07,460
colonel we know all the usuals usual

00:04:06,140 --> 00:04:10,580
suspects we're just kind of going

00:04:07,460 --> 00:04:13,420
through the list and and implementing

00:04:10,580 --> 00:04:15,860
those in the driver and the device and

00:04:13,420 --> 00:04:18,890
publishing you know getting the net debt

00:04:15,860 --> 00:04:22,960
of Colonel updated with that and it's in

00:04:18,890 --> 00:04:26,360
queue I'm you know right now the device

00:04:22,960 --> 00:04:30,020
the drivers in the linux kernel has a

00:04:26,360 --> 00:04:33,260
318 but the device itself being a qemu

00:04:30,020 --> 00:04:35,590
device it's not been accepted but we're

00:04:33,260 --> 00:04:39,290
so so close it'll it should be going in

00:04:35,590 --> 00:04:41,000
right after this conference and the

00:04:39,290 --> 00:04:44,000
expectation is that once you have it

00:04:41,000 --> 00:04:47,150
like David said earlier if people want

00:04:44,000 --> 00:04:50,360
to talk about the interface to their GP

00:04:47,150 --> 00:04:52,790
to their non GPL hardware implement a

00:04:50,360 --> 00:04:57,260
rocker module and then you can show

00:04:52,790 --> 00:05:02,320
software that runs against it well yeah

00:04:57,260 --> 00:05:05,900
okay or if you have a real device yes

00:05:02,320 --> 00:05:09,080
just look at it rocker is an example of

00:05:05,900 --> 00:05:11,450
rocker driver and start you know like

00:05:09,080 --> 00:05:14,900
mellanox was offering here today let's

00:05:11,450 --> 00:05:17,150
just start going through the same

00:05:14,900 --> 00:05:19,669
progression get the ports up started l2

00:05:17,150 --> 00:05:22,729
let's get this thing get this thing

00:05:19,669 --> 00:05:24,290
going and you know this is all about you

00:05:22,729 --> 00:05:25,700
know we use a rock or a fake device

00:05:24,290 --> 00:05:27,520
right now because we have nothing else

00:05:25,700 --> 00:05:30,890
but if we get the other vendors

00:05:27,520 --> 00:05:32,720
participating it'll really solidify the

00:05:30,890 --> 00:05:34,040
api's we may have screwed up there may

00:05:32,720 --> 00:05:36,080
be things we've forgotten their don't

00:05:34,040 --> 00:05:40,070
know about or we've got scalability

00:05:36,080 --> 00:05:41,870
issues or you know if fewer the first

00:05:40,070 --> 00:05:44,630
hardware vendor to put a switch

00:05:41,870 --> 00:05:49,970
offloading driver upstream you're going

00:05:44,630 --> 00:05:51,350
to be so cool you have no idea what kind

00:05:49,970 --> 00:05:53,210
of future you're going to create for

00:05:51,350 --> 00:05:55,310
everyone else you're the first you're

00:05:53,210 --> 00:05:57,380
going to be really cool plus it works

00:05:55,310 --> 00:05:59,960
you make sure that it works for your

00:05:57,380 --> 00:06:01,009
device bust right and will help you

00:05:59,960 --> 00:06:02,809
maintain it

00:06:01,009 --> 00:06:05,180
exactly it's a much harder to change the

00:06:02,809 --> 00:06:07,909
API after the second or once the second

00:06:05,180 --> 00:06:12,139
person tries to get in there okay thank

00:06:07,909 --> 00:06:17,509
you that's it so so no plug for the

00:06:12,139 --> 00:06:19,249
rocker foundation right so Scott

00:06:17,509 --> 00:06:22,449
starting the rocker foundation anybody

00:06:19,249 --> 00:06:22,449

YouTube URL: https://www.youtube.com/watch?v=dyi55biQAu8


