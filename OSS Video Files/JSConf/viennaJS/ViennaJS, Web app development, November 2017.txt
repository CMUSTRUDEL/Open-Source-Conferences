Title: ViennaJS, Web app development, November 2017
Publication date: 2018-02-12
Playlist: viennaJS
Description: 
	Thomas Brus will talk to us about Client DB for Offline-First Apps (via IndexedDB), Server Graph DB (via Neo4j) and JS Async/Await (No Callbacks).

More about Thomas: https://sport.bi/

More about ViennaJS: https://www.meetup.com/viennajs/
Captions: 
	00:00:00,030 --> 00:00:06,420
hello I will talk today about three

00:00:03,629 --> 00:00:10,950
topics offline first craft database and

00:00:06,420 --> 00:00:14,570
also in Kuwait first of all about myself

00:00:10,950 --> 00:00:17,970
my name is Thomas coos I started with

00:00:14,570 --> 00:00:23,160
developing axel Marcos in 2014 that was

00:00:17,970 --> 00:00:25,439
my start let's say in 2017 in the

00:00:23,160 --> 00:00:28,230
beginning I developed visual basic.net

00:00:25,439 --> 00:00:32,880
and six months ago I started with

00:00:28,230 --> 00:00:37,380
JavaScript and my first app I developed

00:00:32,880 --> 00:00:42,120
is called sport bi and sport bi is a

00:00:37,380 --> 00:00:44,399
website which offers a random workout

00:00:42,120 --> 00:00:46,649
generator so if you go to the gym and

00:00:44,399 --> 00:00:48,480
make exercises you get every day a

00:00:46,649 --> 00:00:51,090
different workout so you really

00:00:48,480 --> 00:00:54,239
challenge your body every day and you

00:00:51,090 --> 00:00:59,190
have good progress and everything you

00:00:54,239 --> 00:01:02,190
shock your body really and today I will

00:00:59,190 --> 00:01:06,049
show you the questions I ran through

00:01:02,190 --> 00:01:11,880
when I learned Jas with my yeah

00:01:06,049 --> 00:01:13,590
playground which is the app sport VI the

00:01:11,880 --> 00:01:18,210
first topic I will cover is offline

00:01:13,590 --> 00:01:20,610
first my first question was is it

00:01:18,210 --> 00:01:23,340
possible to create a completely offline

00:01:20,610 --> 00:01:26,310
website and the simple answer is yes

00:01:23,340 --> 00:01:29,820
it's possible and this side answer is

00:01:26,310 --> 00:01:32,820
yes you need to connect to the website

00:01:29,820 --> 00:01:36,869
at least one time of course to get the

00:01:32,820 --> 00:01:40,110
data my second question was how can

00:01:36,869 --> 00:01:42,780
decline and receive data and use the

00:01:40,110 --> 00:01:45,149
data basically there are four ways

00:01:42,780 --> 00:01:49,590
cookies local storage session storage

00:01:45,149 --> 00:01:52,380
and index TP I decided for indexeddb and

00:01:49,590 --> 00:01:54,540
my cert question was who can use index

00:01:52,380 --> 00:02:00,360
TP here on the right corner you can see

00:01:54,540 --> 00:02:03,450
that 94% there is 94% global coverage of

00:02:00,360 --> 00:02:06,240
the browsers that can use index DB my

00:02:03,450 --> 00:02:08,789
fourth question was how does index TP

00:02:06,240 --> 00:02:11,730
look like in the browser so what you see

00:02:08,789 --> 00:02:13,560
here is Chrome and you see the developer

00:02:11,730 --> 00:02:16,020
tools on the right side

00:02:13,560 --> 00:02:18,180
if you go to application you can see a

00:02:16,020 --> 00:02:20,520
point which is called index TP and below

00:02:18,180 --> 00:02:22,920
that you can see the databases here

00:02:20,520 --> 00:02:25,710
there are 2 theta bases which are

00:02:22,920 --> 00:02:27,180
Scimitar and training and by the way on

00:02:25,710 --> 00:02:30,810
the left side you can see the apps for

00:02:27,180 --> 00:02:37,950
pi which is showing a random workout for

00:02:30,810 --> 00:02:40,680
that day table my next question was how

00:02:37,950 --> 00:02:44,190
does indexdb look like again in chrome

00:02:40,680 --> 00:02:47,310
application now I'm in the database

00:02:44,190 --> 00:02:49,950
training and in the table exercise what

00:02:47,310 --> 00:02:53,040
you see here are different exercises I

00:02:49,950 --> 00:02:54,810
have opened one exercise it's showing

00:02:53,040 --> 00:02:59,990
you an object with details about this

00:02:54,810 --> 00:03:03,300
specific exercise my sixth question was

00:02:59,990 --> 00:03:05,220
how can I talk to indexdb well there are

00:03:03,300 --> 00:03:09,600
different libraries worth checking out

00:03:05,220 --> 00:03:11,910
my choice was called exe my seventh

00:03:09,600 --> 00:03:15,300
question was how can I make create read

00:03:11,910 --> 00:03:17,310
update and delete to the database here

00:03:15,300 --> 00:03:21,150
you can see for example how I can create

00:03:17,310 --> 00:03:24,150
an entry in the 20 line I don't know if

00:03:21,150 --> 00:03:27,570
you can see it very good it's the third

00:03:24,150 --> 00:03:30,600
line I connect to the database the arrow

00:03:27,570 --> 00:03:34,590
shows user which is basically the table

00:03:30,600 --> 00:03:37,320
user in the index DB the second word is

00:03:34,590 --> 00:03:38,970
put and then I put an object which is

00:03:37,320 --> 00:03:41,400
the object you see here on the right

00:03:38,970 --> 00:03:46,650
side so I've just created an entry to

00:03:41,400 --> 00:03:48,630
index DB next was how can I make read

00:03:46,650 --> 00:03:50,070
it's also very easy first of all you're

00:03:48,630 --> 00:03:52,410
just connect to the database the

00:03:50,070 --> 00:03:56,910
variable is called TP then table user

00:03:52,410 --> 00:04:02,070
again to array and what I return is the

00:03:56,910 --> 00:04:09,620
item the first array item 0 and I again

00:04:02,070 --> 00:04:12,900
have the first item of this user table

00:04:09,620 --> 00:04:14,700
regarding update and delete I will skip

00:04:12,900 --> 00:04:16,080
that just for timely reasons but in a

00:04:14,700 --> 00:04:21,239
break we can talk about it it's not a

00:04:16,080 --> 00:04:23,970
problem my eighth question was how

00:04:21,239 --> 00:04:27,390
complex can I make varies and for

00:04:23,970 --> 00:04:30,240
example Dexy is quite powerful

00:04:27,390 --> 00:04:34,170
do you have many ways to query the

00:04:30,240 --> 00:04:38,070
database I have highlighted let's say

00:04:34,170 --> 00:04:41,340
most important ones for me I think and

00:04:38,070 --> 00:04:44,940
you can see yeah it's it's you can make

00:04:41,340 --> 00:04:47,940
good good things powerful things my

00:04:44,940 --> 00:04:50,970
ninth question was how to make the files

00:04:47,940 --> 00:04:53,250
available offline so it's one thing to

00:04:50,970 --> 00:04:55,040
have the data offline but it's another

00:04:53,250 --> 00:05:00,690
thing to have the files offline like

00:04:55,040 --> 00:05:02,700
HTML j/s and CSS that let's say a state

00:05:00,690 --> 00:05:05,970
of the art technology is serviceworkers

00:05:02,700 --> 00:05:09,480
but why didn't I choose it it's because

00:05:05,970 --> 00:05:11,880
of the global coverage of about 74%

00:05:09,480 --> 00:05:14,900
and you can see for example internet

00:05:11,880 --> 00:05:17,520
explorer and edge is not supported and

00:05:14,900 --> 00:05:23,160
yeah this is the reason why I didn't

00:05:17,520 --> 00:05:25,500
choose it then how can I make the files

00:05:23,160 --> 00:05:28,560
available offline in another way and I

00:05:25,500 --> 00:05:31,440
chose manifest the library is called

00:05:28,560 --> 00:05:33,600
goÃ»t manifest it's it's hard to read

00:05:31,440 --> 00:05:36,840
here actually but I will explain it on

00:05:33,600 --> 00:05:40,800
the left side I have a gulp task which

00:05:36,840 --> 00:05:43,260
is basically where I define all the

00:05:40,800 --> 00:05:46,170
folders the J's folders and CSS folders

00:05:43,260 --> 00:05:48,450
I need to catch and what it creates

00:05:46,170 --> 00:05:50,250
every time I make a build is that it

00:05:48,450 --> 00:05:52,800
creates a file which is this app dot

00:05:50,250 --> 00:05:56,790
manifest file which lists all the files

00:05:52,800 --> 00:05:59,910
I want to cache in the next step I have

00:05:56,790 --> 00:06:02,640
three files the first one here on top is

00:05:59,910 --> 00:06:06,690
an iframe I can include it in every

00:06:02,640 --> 00:06:09,240
website the source here where the arrow

00:06:06,690 --> 00:06:12,270
starts the route is called slash

00:06:09,240 --> 00:06:15,840
manifest which is basically this HTML

00:06:12,270 --> 00:06:21,090
talk document manifest HS or manifest

00:06:15,840 --> 00:06:26,910
HTML if it in the in the HTML tag there

00:06:21,090 --> 00:06:29,250
is app dot manifest so if this HTML

00:06:26,910 --> 00:06:33,540
document is loaded it runs into the

00:06:29,250 --> 00:06:38,280
route app manifest which is then again

00:06:33,540 --> 00:06:40,470
referring to the previously generated ed

00:06:38,280 --> 00:06:43,080
manifest

00:06:40,470 --> 00:06:47,130
here below the the below arrow is just

00:06:43,080 --> 00:06:49,940
the manifest route the normal route okay

00:06:47,130 --> 00:06:52,140
the 11th question is what is the result

00:06:49,940 --> 00:06:54,570
the result is on the left side you can

00:06:52,140 --> 00:06:56,520
see again chrome developer tools in

00:06:54,570 --> 00:06:59,790
application if you go to clear storage

00:06:56,520 --> 00:07:02,670
you can see on this chart this diagram

00:06:59,790 --> 00:07:04,380
there is a blue area which is the

00:07:02,670 --> 00:07:07,200
application cache which is which is

00:07:04,380 --> 00:07:09,720
currently 4 megabyte and you can see the

00:07:07,200 --> 00:07:10,590
index DB which is currently 1.4

00:07:09,720 --> 00:07:16,250
megabytes

00:07:10,590 --> 00:07:16,250
here you can also delete if needed and

00:07:16,310 --> 00:07:21,990
yeah you have an applied offline

00:07:18,480 --> 00:07:25,910
application that's that result and I can

00:07:21,990 --> 00:07:30,060
also show you we can try it one time

00:07:25,910 --> 00:07:30,810
wait a sec for example here I'm on

00:07:30,060 --> 00:07:32,850
meetup.com

00:07:30,810 --> 00:07:37,860
I have no connection at all you can see

00:07:32,850 --> 00:07:39,600
it here if I go to meetup.com it's not

00:07:37,860 --> 00:07:45,780
working because I have no connection if

00:07:39,600 --> 00:07:48,030
I go to sport P I workout then it's

00:07:45,780 --> 00:07:50,430
working and it's completely working

00:07:48,030 --> 00:07:54,000
offline now and I can refresh my

00:07:50,430 --> 00:07:56,760
exercises I can switch the date like

00:07:54,000 --> 00:08:03,169
it's storing all my workouts I had in

00:07:56,760 --> 00:08:03,169
the past and yeah this is offline first

00:08:03,580 --> 00:08:11,070
[Music]

00:08:06,710 --> 00:08:14,280
then my second topic is Croft database

00:08:11,070 --> 00:08:16,890
so while I was developing my sport bi

00:08:14,280 --> 00:08:19,320
app I was also wondering how should I

00:08:16,890 --> 00:08:21,030
store the data on the server well the

00:08:19,320 --> 00:08:23,880
classic ways to use a relational

00:08:21,030 --> 00:08:28,370
database where you have also relations

00:08:23,880 --> 00:08:30,780
but you need to write the the fields

00:08:28,370 --> 00:08:32,940
always two times in different tables

00:08:30,780 --> 00:08:34,589
like the yellows are in two tables the

00:08:32,940 --> 00:08:39,320
Koreans are in two tables

00:08:34,589 --> 00:08:41,219
the Blues are in two tables I was

00:08:39,320 --> 00:08:44,070
challenging the technologies out there

00:08:41,219 --> 00:08:46,140
and the second one was craft other

00:08:44,070 --> 00:08:49,680
pieces and I was wondering should I use

00:08:46,140 --> 00:08:51,839
craft databases finally I took it and I

00:08:49,680 --> 00:08:53,220
decided for the technology which is

00:08:51,839 --> 00:08:56,639
called or the wind or

00:08:53,220 --> 00:09:01,100
is called new Forte here on the right

00:08:56,639 --> 00:09:01,100
side you can see also other vendors and

00:09:01,279 --> 00:09:07,470
below here the links you can see how to

00:09:03,779 --> 00:09:09,449
install it on Linux and Windows and in

00:09:07,470 --> 00:09:12,449
general just to describe what is a craft

00:09:09,449 --> 00:09:15,240
database well you normally have nodes

00:09:12,449 --> 00:09:17,550
here you can see node user and you

00:09:15,240 --> 00:09:21,240
normally have relationships and here in

00:09:17,550 --> 00:09:24,449
this graph we have node user and the

00:09:21,240 --> 00:09:26,490
relationship folders and these different

00:09:24,449 --> 00:09:29,579
names which are old users are following

00:09:26,490 --> 00:09:35,310
each other so this is a very simple

00:09:29,579 --> 00:09:37,680
graph my second question for craft other

00:09:35,310 --> 00:09:39,720
basis was how can I run it once it's

00:09:37,680 --> 00:09:42,269
installed if you have installed it you

00:09:39,720 --> 00:09:44,730
can run this link it's local Coast

00:09:42,269 --> 00:09:47,790
localhost and the port slash browser

00:09:44,730 --> 00:09:50,279
what you receive is a very nice

00:09:47,790 --> 00:09:53,670
interface very powerful where you can

00:09:50,279 --> 00:09:57,019
write your database query here in order

00:09:53,670 --> 00:10:02,339
to test it and it returns you a graph

00:09:57,019 --> 00:10:05,189
but also the text form so you can see

00:10:02,339 --> 00:10:09,360
how it's yeah you can see the take very

00:10:05,189 --> 00:10:12,000
life my third question was how to read

00:10:09,360 --> 00:10:13,980
the data well I have here a simple

00:10:12,000 --> 00:10:16,160
example from the sport bi app here you

00:10:13,980 --> 00:10:19,170
can see a person this is the green one

00:10:16,160 --> 00:10:21,329
and on the other side you can see an

00:10:19,170 --> 00:10:22,829
exercise which is the career one and in

00:10:21,329 --> 00:10:25,620
between is a relationship which is

00:10:22,829 --> 00:10:28,290
called makes so in other words you can

00:10:25,620 --> 00:10:31,620
say a person makes an exercise so this

00:10:28,290 --> 00:10:34,259
is the simple interpretation of this

00:10:31,620 --> 00:10:36,509
this craft what I want to show you is

00:10:34,259 --> 00:10:38,459
that every element for example that

00:10:36,509 --> 00:10:41,160
person here can have different

00:10:38,459 --> 00:10:43,589
properties within this node you can see

00:10:41,160 --> 00:10:45,660
it here below but also a relationship

00:10:43,589 --> 00:10:48,329
like makes can have different properties

00:10:45,660 --> 00:10:50,699
but also the exercise can have different

00:10:48,329 --> 00:10:55,829
properties and you can vary all those

00:10:50,699 --> 00:10:58,529
properties now let's make a query with

00:10:55,829 --> 00:11:00,930
JavaScript but before I start let's do

00:10:58,529 --> 00:11:03,600
it without JavaScript so a human would

00:11:00,930 --> 00:11:05,699
say find the person that makes the

00:11:03,600 --> 00:11:07,080
exercise which is called let's say

00:11:05,699 --> 00:11:10,560
seated cable rows

00:11:07,080 --> 00:11:13,980
a machine and translated into the neo4j

00:11:10,560 --> 00:11:16,740
database would say match person makes

00:11:13,980 --> 00:11:20,130
exercise square brackets and then the

00:11:16,740 --> 00:11:23,220
exercise name and return the name of the

00:11:20,130 --> 00:11:26,540
person what you can see here is in red

00:11:23,220 --> 00:11:29,550
letters you can see P person R makes

00:11:26,540 --> 00:11:31,940
exercise it's just you don't need it

00:11:29,550 --> 00:11:35,010
really but it's good to have it because

00:11:31,940 --> 00:11:37,170
you can reuse this variable P for

00:11:35,010 --> 00:11:39,840
example in the second line I say return

00:11:37,170 --> 00:11:42,930
P name but in order to return the name

00:11:39,840 --> 00:11:47,630
of the person I need to in the first row

00:11:42,930 --> 00:11:47,630
say that the person is P you know yeah

00:11:47,750 --> 00:11:53,370
okay how can I make the query with

00:11:50,580 --> 00:11:58,710
JavaScript I took the same query like

00:11:53,370 --> 00:12:01,880
you have just seen it it's a variable

00:11:58,710 --> 00:12:06,060
just called query and I passed this

00:12:01,880 --> 00:12:08,580
string basically to a helper function

00:12:06,060 --> 00:12:10,230
which I just reuse every time it's just

00:12:08,580 --> 00:12:13,080
a query to the database so you set it up

00:12:10,230 --> 00:12:17,070
one time and that's it and it's the same

00:12:13,080 --> 00:12:20,040
if you also do it in this new Forte

00:12:17,070 --> 00:12:27,290
interface and the result is P name and

00:12:20,040 --> 00:12:30,210
this is what is returned then this is

00:12:27,290 --> 00:12:32,810
these are the helper functions what I've

00:12:30,210 --> 00:12:36,060
just talked that I passed the query and

00:12:32,810 --> 00:12:38,640
it's it's thank varying the database on

00:12:36,060 --> 00:12:41,400
the left side you can see the JavaScript

00:12:38,640 --> 00:12:45,360
driver which comes from new 4j directly

00:12:41,400 --> 00:12:49,100
so I would suggest to use it because it

00:12:45,360 --> 00:12:52,680
opens the session and closes the session

00:12:49,100 --> 00:12:57,000
but you can also do it via suppose it's

00:12:52,680 --> 00:13:02,280
also possible but you should use what's

00:12:57,000 --> 00:13:09,960
coming from your chat directly okay my

00:13:02,280 --> 00:13:12,570
next point is is asking your wait when I

00:13:09,960 --> 00:13:15,420
started to develop this JavaScript I ran

00:13:12,570 --> 00:13:19,260
into the question do I really have to do

00:13:15,420 --> 00:13:20,910
it like that it's like it was I couldn't

00:13:19,260 --> 00:13:25,230
really understand that

00:13:20,910 --> 00:13:28,670
no other way and my second question was

00:13:25,230 --> 00:13:31,320
of course are there any alternatives and

00:13:28,670 --> 00:13:36,120
yeah the alternative is using promises

00:13:31,320 --> 00:13:37,800
and awesome Kuwait and in order to use

00:13:36,120 --> 00:13:41,760
it you need to start your function

00:13:37,800 --> 00:13:45,330
always with a sink as a prefix and then

00:13:41,760 --> 00:13:47,880
you can use before you can use always a

00:13:45,330 --> 00:13:50,460
wait and here I made a very extreme

00:13:47,880 --> 00:13:53,400
example also from the workout generator

00:13:50,460 --> 00:13:55,950
basically I'm calling a function with a

00:13:53,400 --> 00:14:00,290
weight and the variables I passed to

00:13:55,950 --> 00:14:04,290
that function are also having a weight

00:14:00,290 --> 00:14:10,230
so yeah you can also nest to nest the

00:14:04,290 --> 00:14:12,890
ABE rate functions yeah my third

00:14:10,230 --> 00:14:16,320
question was how is it supported again

00:14:12,890 --> 00:14:19,560
especially for the front-end and we have

00:14:16,320 --> 00:14:22,520
global coverage of 90% especially

00:14:19,560 --> 00:14:28,140
Internet Explorer makes problems again

00:14:22,520 --> 00:14:30,450
and because the workout generator sport

00:14:28,140 --> 00:14:32,940
VI is mainly used on mobiles it's a

00:14:30,450 --> 00:14:38,310
topic because Mobile's are also not so

00:14:32,940 --> 00:14:40,620
well supported by J's us in Kuwait so my

00:14:38,310 --> 00:14:43,650
first question was then how can I reach

00:14:40,620 --> 00:14:45,840
more compatibility for us in Kuwait eg

00:14:43,650 --> 00:14:49,680
also for example us for Internet

00:14:45,840 --> 00:14:52,200
Explorer and it's possible you can

00:14:49,680 --> 00:15:01,500
compile it down to years to 15 for

00:14:52,200 --> 00:15:05,550
example and yes I used Babel and also

00:15:01,500 --> 00:15:09,480
here together ugly 5 with Internet

00:15:05,550 --> 00:15:11,640
Explorer 8 and it allowed me or the

00:15:09,480 --> 00:15:14,370
result is that you have no I'll sink

00:15:11,640 --> 00:15:17,400
your weight in your code anymore you

00:15:14,370 --> 00:15:19,140
cannot read it it's not readable but the

00:15:17,400 --> 00:15:20,880
a secure weight is a way and the app is

00:15:19,140 --> 00:15:23,940
still working and you have it

00:15:20,880 --> 00:15:27,380
comfortable for all the process as well

00:15:23,940 --> 00:15:27,380
which is very very important

00:15:27,980 --> 00:15:34,669
that's it sinks

00:15:30,440 --> 00:15:34,669

YouTube URL: https://www.youtube.com/watch?v=a2iGJlv5ly8


