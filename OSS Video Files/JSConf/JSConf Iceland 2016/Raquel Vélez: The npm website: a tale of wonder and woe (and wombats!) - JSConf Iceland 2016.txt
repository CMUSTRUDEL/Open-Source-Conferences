Title: Raquel Vélez: The npm website: a tale of wonder and woe (and wombats!) - JSConf Iceland 2016
Publication date: 2016-09-20
Playlist: JSConf Iceland 2016
Description: 
	Since its creation in 2010, the npm website has gone on quite an adventure. Oh, the stories it could tell! From its humble beginnings as a pioneer node application without a single line of client-side JavaScript to its current state as a full-fledged web application with front-end and backend frameworks, this site has seen it all. Learn from our successes as well as our mistakes as I take you on a journey of lessons learned over the past 2.5 years (and counting)!
Captions: 
	00:00:12,920 --> 00:00:18,510
hi everyone as you said my name is

00:00:16,410 --> 00:00:21,750
Raquel Bellas I'm rockbot on all of the

00:00:18,510 --> 00:00:23,849
things now let me just get a general

00:00:21,750 --> 00:00:27,810
survey of the area how many of you have

00:00:23,849 --> 00:00:30,449
ever used NPM okay excellent how many of

00:00:27,810 --> 00:00:37,500
you have used the NPM website in the

00:00:30,449 --> 00:00:39,900
last month last week last day use it

00:00:37,500 --> 00:00:41,670
multiple times a day okay yeah the

00:00:39,900 --> 00:00:42,989
numbers are dwindling that's okay one

00:00:41,670 --> 00:00:45,000
day we'll get you using it all the time

00:00:42,989 --> 00:00:49,110
forever and ever will be like the next

00:00:45,000 --> 00:00:50,610
state no we won't okay now most of my

00:00:49,110 --> 00:00:52,650
colleagues when they talk about NPM

00:00:50,610 --> 00:00:54,600
they'll talk about the CLI they'll talk

00:00:52,650 --> 00:00:56,670
about the registry but today you're all

00:00:54,600 --> 00:01:00,449
y'all are in luck because I'm going to

00:00:56,670 --> 00:01:02,339
talk about the website so my goal is to

00:01:00,449 --> 00:01:03,989
kind of give you an overview of NPM in

00:01:02,339 --> 00:01:05,489
general then talk about the history of

00:01:03,989 --> 00:01:06,869
the website and then I want to talk

00:01:05,489 --> 00:01:08,690
about the lessons that we have learned

00:01:06,869 --> 00:01:10,590
in the process of building the website

00:01:08,690 --> 00:01:12,990
and that I think is going to be the

00:01:10,590 --> 00:01:16,920
coolest take away all right so NPM in

00:01:12,990 --> 00:01:20,189
general fun fact npm does not actually

00:01:16,920 --> 00:01:22,799
stand for node package manager when i've

00:01:20,189 --> 00:01:25,590
actually recreated it it was literally

00:01:22,799 --> 00:01:28,590
just a three letter word and p.m. you

00:01:25,590 --> 00:01:33,090
could say that it has no prescribed

00:01:28,590 --> 00:01:36,000
meaning okay only pun I promise okay

00:01:33,090 --> 00:01:38,249
that said it is actually a package

00:01:36,000 --> 00:01:40,649
manager for javascript though even that

00:01:38,249 --> 00:01:45,509
is a little bit misleading because there

00:01:40,649 --> 00:01:48,539
are over 350,000 packages on NPM right

00:01:45,509 --> 00:01:50,939
now and many of them while many of them

00:01:48,539 --> 00:01:54,240
are javascript-based there are ones with

00:01:50,939 --> 00:01:55,829
CSS in them and ones with go and rest

00:01:54,240 --> 00:01:58,109
and there's even a little bit of C++ in

00:01:55,829 --> 00:01:59,999
there so really it's just a package

00:01:58,109 --> 00:02:03,749
manager I like to think it's pretty cool

00:01:59,999 --> 00:02:06,149
and so you may know that it started out

00:02:03,749 --> 00:02:08,220
as an open source project node came

00:02:06,149 --> 00:02:10,289
around in 2009 and that was really great

00:02:08,220 --> 00:02:12,120
and people wanted to share code but they

00:02:10,289 --> 00:02:14,940
wanted to really use it as like modules

00:02:12,120 --> 00:02:17,459
and add those little modules into their

00:02:14,940 --> 00:02:22,020
websites or their applications and so

00:02:17,459 --> 00:02:23,820
Isaac schluter our CEO created NPM

00:02:22,020 --> 00:02:26,850
as you know just a kind of cool thing

00:02:23,820 --> 00:02:29,310
and that was fantastic except something

00:02:26,850 --> 00:02:31,890
interesting happened people started

00:02:29,310 --> 00:02:34,830
using node a lot and with it they

00:02:31,890 --> 00:02:37,520
started using NPM a lot this is the

00:02:34,830 --> 00:02:40,710
graph of people installing node modules

00:02:37,520 --> 00:02:43,770
in over the course of the first four

00:02:40,710 --> 00:02:45,950
years of n PM's existence but not only

00:02:43,770 --> 00:02:49,200
were they using NPM they were also

00:02:45,950 --> 00:02:51,660
really contributing to the NPM ecosystem

00:02:49,200 --> 00:02:54,420
right this is exponential like this is

00:02:51,660 --> 00:02:58,110
not what you expect in general now there

00:02:54,420 --> 00:02:59,880
was a dark period at the end of 2013 in

00:02:58,110 --> 00:03:03,000
those days we call the dark period

00:02:59,880 --> 00:03:05,790
because NPM kept going down how many of

00:03:03,000 --> 00:03:08,330
you used NPM in 2013 do you remember

00:03:05,790 --> 00:03:11,850
those days they're kind of dark at

00:03:08,330 --> 00:03:14,070
people were relying on node and NPM in

00:03:11,850 --> 00:03:16,860
production and then all of a sudden they

00:03:14,070 --> 00:03:19,200
couldn't use NPM because the growth was

00:03:16,860 --> 00:03:21,300
so exponential and so massive that this

00:03:19,200 --> 00:03:23,040
tiny open source project could not

00:03:21,300 --> 00:03:26,400
handle the load there was no dedicated

00:03:23,040 --> 00:03:30,150
people no real dedicated servers so it

00:03:26,400 --> 00:03:32,520
went dark a lot at that point Isaac made

00:03:30,150 --> 00:03:34,440
the decision to turn NPM into a company

00:03:32,520 --> 00:03:37,200
because we wanted to be able to create

00:03:34,440 --> 00:03:39,450
products and services to give real user

00:03:37,200 --> 00:03:41,340
value to the point where you wanted to

00:03:39,450 --> 00:03:43,140
pay money so that we could keep the

00:03:41,340 --> 00:03:44,970
registry up and running and we could pay

00:03:43,140 --> 00:03:48,330
people to keep the edge of the registry

00:03:44,970 --> 00:03:52,560
up and running so that's how NPM kind of

00:03:48,330 --> 00:03:55,200
started and in 2014 I became the first

00:03:52,560 --> 00:03:57,480
employee of NPM and the entire existence

00:03:55,200 --> 00:03:59,700
of my time a 10pm has been focused on

00:03:57,480 --> 00:04:03,420
the website so let's go a little bit

00:03:59,700 --> 00:04:07,080
back in time at the very first version

00:04:03,420 --> 00:04:09,600
of the NPM website is from jun 2010 and

00:04:07,080 --> 00:04:11,340
here's what it looked like it was just a

00:04:09,600 --> 00:04:15,209
little landing page there's not much

00:04:11,340 --> 00:04:17,970
here it's just a little like hey there's

00:04:15,209 --> 00:04:19,290
this thing called NPM go to the github

00:04:17,970 --> 00:04:22,940
repo you'll find out more information

00:04:19,290 --> 00:04:24,930
there great six months later though

00:04:22,940 --> 00:04:26,850
there's a little bit more information

00:04:24,930 --> 00:04:29,400
again it's still really more of a

00:04:26,850 --> 00:04:32,370
landing page but one really fun addition

00:04:29,400 --> 00:04:35,080
is this idea of searching for packages

00:04:32,370 --> 00:04:37,300
this is what the search looked like

00:04:35,080 --> 00:04:40,379
anybody who uses its back then this is

00:04:37,300 --> 00:04:43,569
like a nostalgia static sort of moment

00:04:40,379 --> 00:04:46,300
this was a couch app created by michael

00:04:43,569 --> 00:04:49,090
rogers and when you only have like a few

00:04:46,300 --> 00:04:52,870
hundred packages this is fine this is

00:04:49,090 --> 00:04:56,409
totally fine it was in fact it was so

00:04:52,870 --> 00:05:00,069
fine it worked for 18 months and then

00:04:56,409 --> 00:05:02,259
something really big happened npm became

00:05:00,069 --> 00:05:03,789
packaged with node I'm all that in of

00:05:02,259 --> 00:05:06,250
itself or the website is not that big of

00:05:03,789 --> 00:05:08,440
a deal it does actually mean that there

00:05:06,250 --> 00:05:13,060
are more users which means more user

00:05:08,440 --> 00:05:15,789
growth and a few months after that the

00:05:13,060 --> 00:05:18,610
first real community was was born on the

00:05:15,789 --> 00:05:21,009
NPM website this really allows us to not

00:05:18,610 --> 00:05:22,599
only search packages but to start seeing

00:05:21,009 --> 00:05:25,449
people's profiles and start getting

00:05:22,599 --> 00:05:27,940
statistics about about packages and

00:05:25,449 --> 00:05:29,800
who's building stuff and and how many

00:05:27,940 --> 00:05:32,199
people are downloading it and it was so

00:05:29,800 --> 00:05:33,969
cool now the thing about the search

00:05:32,199 --> 00:05:36,550
though is that the number of packages

00:05:33,969 --> 00:05:37,810
started to skyrocket and Michael's

00:05:36,550 --> 00:05:40,599
little couch app didn't quite work

00:05:37,810 --> 00:05:42,729
anymore and so it actually turned out

00:05:40,599 --> 00:05:45,279
that you would go to the little search

00:05:42,729 --> 00:05:46,900
input and it would just take you to

00:05:45,279 --> 00:05:48,879
google was like forget it we're not be

00:05:46,900 --> 00:05:51,819
able to do this but eventually somebody

00:05:48,879 --> 00:05:55,509
added an elastic search engine and we

00:05:51,819 --> 00:05:57,400
had really really basic search I'm sad

00:05:55,509 --> 00:05:58,690
to say that this is still the exact same

00:05:57,400 --> 00:06:01,930
elastic search engine that we're using

00:05:58,690 --> 00:06:03,789
on NPM Jess calm right now that's why

00:06:01,930 --> 00:06:08,560
the search sucks we're working on it I

00:06:03,789 --> 00:06:11,490
promise okay great so after that point

00:06:08,560 --> 00:06:14,229
for the next two and a half years we

00:06:11,490 --> 00:06:15,759
started this company we started really

00:06:14,229 --> 00:06:18,520
getting into the website but something

00:06:15,759 --> 00:06:25,690
very very very important really

00:06:18,520 --> 00:06:29,229
important happened in jun 2014 we got a

00:06:25,690 --> 00:06:32,379
wombat we got our first mascot and this

00:06:29,229 --> 00:06:34,419
is our really our only mascot but it's

00:06:32,379 --> 00:06:36,009
really cute and cuddly and a lot of

00:06:34,419 --> 00:06:38,319
people ask me what is the origin of the

00:06:36,009 --> 00:06:39,310
wombat where does this come from now if

00:06:38,319 --> 00:06:41,860
you'll allow me a moment of

00:06:39,310 --> 00:06:45,279
embarrassment this is the real story of

00:06:41,860 --> 00:06:47,820
why we have a wombat as our mascot turns

00:06:45,279 --> 00:06:50,220
out that there was an intern who

00:06:47,820 --> 00:06:53,010
who was complaining one day about slow

00:06:50,220 --> 00:06:55,730
internet and I don't I have no idea what

00:06:53,010 --> 00:06:58,680
compelled me I have no clue at all but

00:06:55,730 --> 00:07:00,390
basically here's what I said the

00:06:58,680 --> 00:07:02,970
internet is a series of tubes which we

00:07:00,390 --> 00:07:05,300
all know as a fact sometimes things get

00:07:02,970 --> 00:07:08,880
clogged and sometimes there is a leak

00:07:05,300 --> 00:07:11,400
because tubes can be broken there is no

00:07:08,880 --> 00:07:14,040
fix except to release a pack of wombats

00:07:11,400 --> 00:07:17,760
with pickaxes in little helmets and

00:07:14,040 --> 00:07:19,380
bright orange vests for safety I have no

00:07:17,760 --> 00:07:22,790
idea where this came from it just came

00:07:19,380 --> 00:07:26,100
out of nowhere now CJ Silverio who

00:07:22,790 --> 00:07:28,830
started a week after me chief chimes in

00:07:26,100 --> 00:07:31,320
with wombat developers Union for the win

00:07:28,830 --> 00:07:33,000
I don't know where that came from either

00:07:31,320 --> 00:07:35,880
but see here's the fun thing if you take

00:07:33,000 --> 00:07:38,490
the npm logo and you invert it it's wdu

00:07:35,880 --> 00:07:43,950
so boom of course obviously we should be

00:07:38,490 --> 00:07:46,170
the wombats developer Union so if you

00:07:43,950 --> 00:07:48,960
love our wombat shout out to its John Q

00:07:46,170 --> 00:07:51,570
on Twitter because I just one day was

00:07:48,960 --> 00:07:55,470
like okay hey Twitter who can draw me a

00:07:51,570 --> 00:07:57,900
wombat in ninja suit and John quach came

00:07:55,470 --> 00:08:00,180
in and just drew his cute little thing

00:07:57,900 --> 00:08:02,610
and we were like done it's over game

00:08:00,180 --> 00:08:05,250
over we love our little wombat this is

00:08:02,610 --> 00:08:09,000
the greatest so now you all know the

00:08:05,250 --> 00:08:12,060
story back to the website okay so two

00:08:09,000 --> 00:08:14,040
and a half years go by and uh actually

00:08:12,060 --> 00:08:17,190
not to enough yours the next several

00:08:14,040 --> 00:08:22,590
years later uh from the last time we saw

00:08:17,190 --> 00:08:24,480
our website we spent time and we we put

00:08:22,590 --> 00:08:26,640
out a brand new website we were really

00:08:24,480 --> 00:08:30,270
focused now now that the community was

00:08:26,640 --> 00:08:32,190
growing so much our major focus was to

00:08:30,270 --> 00:08:34,020
build a website centered around the

00:08:32,190 --> 00:08:36,240
community we wanted to make it as easy

00:08:34,020 --> 00:08:37,890
as possible to find good packages to

00:08:36,240 --> 00:08:40,590
connect with others and just give you a

00:08:37,890 --> 00:08:42,120
really nice beautiful experience I love

00:08:40,590 --> 00:08:45,750
the old website but I like this one

00:08:42,120 --> 00:08:47,520
better now in the process we also

00:08:45,750 --> 00:08:48,630
changed a whole bunch of backend stuff

00:08:47,520 --> 00:08:52,170
and I'm going to dive into that in a

00:08:48,630 --> 00:08:54,990
moment so here's where we are today over

00:08:52,170 --> 00:08:58,800
the last 18 months we have released

00:08:54,990 --> 00:09:01,350
three products on our website and it's

00:08:58,800 --> 00:09:03,750
really important for us to

00:09:01,350 --> 00:09:06,600
help tell you what they are so we've got

00:09:03,750 --> 00:09:07,980
marketing pages now and we are really

00:09:06,600 --> 00:09:09,600
just trying to push these products and

00:09:07,980 --> 00:09:12,150
services because the last thing we ever

00:09:09,600 --> 00:09:14,280
want ever again is for you to not be

00:09:12,150 --> 00:09:16,320
able to depend on NPM when you're doing

00:09:14,280 --> 00:09:18,440
your installs it's really important that

00:09:16,320 --> 00:09:22,650
those servers do exactly what you want

00:09:18,440 --> 00:09:25,170
so we got to sell you stuff okay great

00:09:22,650 --> 00:09:28,290
news users are increasing on the website

00:09:25,170 --> 00:09:29,220
this is great but did you know that

00:09:28,290 --> 00:09:31,380
we're doing with the team of three

00:09:29,220 --> 00:09:33,630
there's only three of us working on the

00:09:31,380 --> 00:09:37,620
web team a 10pm there's only 24 of us a

00:09:33,630 --> 00:09:40,970
10pm entirely so there's all y'all and

00:09:37,620 --> 00:09:42,960
then there's just a couple of less so

00:09:40,970 --> 00:09:45,060
but we all work together and that's

00:09:42,960 --> 00:09:49,020
really important ok let's get into the

00:09:45,060 --> 00:09:51,000
nitty-gritty meaty bits so over the

00:09:49,020 --> 00:09:53,220
course of the last two and a half years

00:09:51,000 --> 00:09:55,800
I have had the wonderful privilege of

00:09:53,220 --> 00:09:58,560
working on the NPM website and I have

00:09:55,800 --> 00:10:00,330
learned a ton of things I cannot go over

00:09:58,560 --> 00:10:01,470
every single thing that we learned but

00:10:00,330 --> 00:10:04,620
here are some kind of really high-level

00:10:01,470 --> 00:10:07,800
highlights when we vary only first

00:10:04,620 --> 00:10:11,490
started NPM I I started on the first day

00:10:07,800 --> 00:10:13,440
a week later my coworker CJ started and

00:10:11,490 --> 00:10:15,660
I'm sitting there just frantically

00:10:13,440 --> 00:10:18,000
trying to figure out okay I just need to

00:10:15,660 --> 00:10:19,320
put stars in the website let me add Ajax

00:10:18,000 --> 00:10:21,930
like there was no javascript in the

00:10:19,320 --> 00:10:24,780
original version of the of the web app

00:10:21,930 --> 00:10:26,780
and seizure comes in and she's like okay

00:10:24,780 --> 00:10:29,850
we are going to add metrics and logging

00:10:26,780 --> 00:10:32,220
immediately and I was like why would we

00:10:29,850 --> 00:10:34,350
do that that makes no sense right now

00:10:32,220 --> 00:10:36,720
our servers keep falling over our

00:10:34,350 --> 00:10:39,780
community is really upset with us we

00:10:36,720 --> 00:10:42,360
need to build stuff fast well there's a

00:10:39,780 --> 00:10:43,530
reason why CJ is now the CTO and I've

00:10:42,360 --> 00:10:46,580
only made my way up to engineering

00:10:43,530 --> 00:10:49,410
manager because it turns out that

00:10:46,580 --> 00:10:51,900
metrics give you the information that

00:10:49,410 --> 00:10:54,180
you didn't know you needed metrics tell

00:10:51,900 --> 00:10:56,250
you what your users and what your

00:10:54,180 --> 00:10:57,750
systems are doing because while you can

00:10:56,250 --> 00:11:00,240
guess what they're doing you can't

00:10:57,750 --> 00:11:02,730
actually know with real hard data until

00:11:00,240 --> 00:11:04,440
you start adding metrics logs allow you

00:11:02,730 --> 00:11:06,390
to basically record those metrics and

00:11:04,440 --> 00:11:08,790
search them later so those two things

00:11:06,390 --> 00:11:10,950
really come hand-in-hand for you to

00:11:08,790 --> 00:11:13,050
really understand what the heck is going

00:11:10,950 --> 00:11:14,370
on and let me tell you the sooner you do

00:11:13,050 --> 00:11:16,020
it the easier

00:11:14,370 --> 00:11:18,210
is to continue doing it and you'll have

00:11:16,020 --> 00:11:19,890
all of that data from the beginning the

00:11:18,210 --> 00:11:22,170
worst thing is when product comes in and

00:11:19,890 --> 00:11:26,220
says hey so we have this idea what do

00:11:22,170 --> 00:11:28,529
you think you're like hmm when you have

00:11:26,220 --> 00:11:30,600
the actual data that's when you can

00:11:28,529 --> 00:11:32,940
really kind of push forward and say yes

00:11:30,600 --> 00:11:36,240
this is a great idea or no our users are

00:11:32,940 --> 00:11:39,089
never going to want to do this to see

00:11:36,240 --> 00:11:40,800
something a little bit yeah interesting

00:11:39,089 --> 00:11:43,800
but I'm gonna give it to from a

00:11:40,800 --> 00:11:47,220
different angle at some point so the

00:11:43,800 --> 00:11:51,270
original website that Isaac built it was

00:11:47,220 --> 00:11:54,120
a hand-rolled just kind of framework

00:11:51,270 --> 00:11:56,760
that he built on his own and it was fine

00:11:54,120 --> 00:11:58,770
except for the part where when I needed

00:11:56,760 --> 00:12:00,810
to come on to on board it took me six

00:11:58,770 --> 00:12:03,210
months to figure out how it all worked

00:12:00,810 --> 00:12:04,980
and that was really difficult so we

00:12:03,210 --> 00:12:07,860
decided to scrap it all entirely and

00:12:04,980 --> 00:12:09,570
start from scratch now when you're

00:12:07,860 --> 00:12:11,430
starting an app from scratch there are

00:12:09,570 --> 00:12:15,029
so many options so many opportunities

00:12:11,430 --> 00:12:17,310
and honestly it doesn't matter which one

00:12:15,029 --> 00:12:21,930
you choose or if you even choose one at

00:12:17,310 --> 00:12:24,779
all at the ultimately that it comes down

00:12:21,930 --> 00:12:28,500
to the fact that your framework if you

00:12:24,779 --> 00:12:32,370
choose one it okay let me phrase it this

00:12:28,500 --> 00:12:35,000
way there is no one framework to solve

00:12:32,370 --> 00:12:37,320
every single problem never ever ever

00:12:35,000 --> 00:12:40,500
it's important if you're going to pick a

00:12:37,320 --> 00:12:43,380
framework to pick one that suits your

00:12:40,500 --> 00:12:46,110
needs specifically so assess what your

00:12:43,380 --> 00:12:49,410
needs are and then focus on that I don't

00:12:46,110 --> 00:12:51,990
care which one you choose if at all that

00:12:49,410 --> 00:12:53,760
said use a framework please use a

00:12:51,990 --> 00:12:55,800
framework when you're an early stage

00:12:53,760 --> 00:12:58,500
startup you don't have time to be making

00:12:55,800 --> 00:12:59,970
a billion in seven decisions right let

00:12:58,500 --> 00:13:01,500
me tell you if you have 20 engineers in

00:12:59,970 --> 00:13:02,970
a room you're going to have 50 different

00:13:01,500 --> 00:13:05,640
opinions on how things should be done

00:13:02,970 --> 00:13:07,080
right like we all know this a framework

00:13:05,640 --> 00:13:08,910
gives you the opportunity to let

00:13:07,080 --> 00:13:10,170
somebody else make those decisions let

00:13:08,910 --> 00:13:11,520
someone else have the opinions and

00:13:10,170 --> 00:13:14,400
everyone else just kind of fall in line

00:13:11,520 --> 00:13:15,990
because you have to get product out you

00:13:14,400 --> 00:13:16,770
don't have to sit there fighting about

00:13:15,990 --> 00:13:18,720
whether or not you should have

00:13:16,770 --> 00:13:20,730
semicolons or call backs or promises or

00:13:18,720 --> 00:13:25,110
what you don't need that on your on your

00:13:20,730 --> 00:13:28,080
plate you just don't that said we

00:13:25,110 --> 00:13:29,760
ultimately decided to use happy j/s for

00:13:28,080 --> 00:13:32,460
back-end framework if you want to know

00:13:29,760 --> 00:13:33,810
why we chose happy over say something

00:13:32,460 --> 00:13:35,760
like Express let's talk about that

00:13:33,810 --> 00:13:39,090
afterwards but that was a decision that

00:13:35,760 --> 00:13:40,680
we made similarly for our front-end we

00:13:39,090 --> 00:13:42,450
haven't implemented a front-end

00:13:40,680 --> 00:13:43,680
framework yet but we're thinking about

00:13:42,450 --> 00:13:45,870
which one we're going to go with

00:13:43,680 --> 00:13:48,660
ultimately again it doesn't matter which

00:13:45,870 --> 00:13:51,270
one you choose but it does matter that

00:13:48,660 --> 00:13:53,130
you pick something and stick with it the

00:13:51,270 --> 00:13:55,860
absolute worst thing you can ever do is

00:13:53,130 --> 00:13:58,710
implement a framework into your app and

00:13:55,860 --> 00:14:01,410
then either not use it at all or fight

00:13:58,710 --> 00:14:04,080
it if you find yourself fighting your

00:14:01,410 --> 00:14:05,670
framework just stop get rid of your

00:14:04,080 --> 00:14:10,440
framework and pick a new one that will

00:14:05,670 --> 00:14:12,510
actually work with what you need as the

00:14:10,440 --> 00:14:14,130
websites as the web team started to grow

00:14:12,510 --> 00:14:16,260
an interesting thing started happening

00:14:14,130 --> 00:14:18,090
because at first I was the only one

00:14:16,260 --> 00:14:19,920
working on the website it was great

00:14:18,090 --> 00:14:21,870
right because I had everything in my

00:14:19,920 --> 00:14:24,060
brain I knew everything that I needed to

00:14:21,870 --> 00:14:26,370
know every decision that was made all of

00:14:24,060 --> 00:14:29,490
it the whole code base was in my head at

00:14:26,370 --> 00:14:31,260
all times but then an interesting thing

00:14:29,490 --> 00:14:35,100
happens when you bring someone else to

00:14:31,260 --> 00:14:37,610
new to get the team right it's suddenly

00:14:35,100 --> 00:14:40,290
like you have this whole arc

00:14:37,610 --> 00:14:42,270
archaeological dig site you can see all

00:14:40,290 --> 00:14:44,910
the decisions that were made but you'll

00:14:42,270 --> 00:14:47,370
never know why they were made you you

00:14:44,910 --> 00:14:49,080
can see what was done you'll never

00:14:47,370 --> 00:14:51,750
understand what were the things that led

00:14:49,080 --> 00:14:54,240
up to those decisions so ultimately

00:14:51,750 --> 00:14:56,370
people would come and be like why why

00:14:54,240 --> 00:14:58,080
are we doing it this way and I would

00:14:56,370 --> 00:15:00,090
look at them like well isn't it obvious

00:14:58,080 --> 00:15:02,400
and you're like no there's no

00:15:00,090 --> 00:15:05,360
documentation this one function isn't

00:15:02,400 --> 00:15:07,920
tested at all there's nothing here so

00:15:05,360 --> 00:15:11,610
that was a huge moment for me to realize

00:15:07,920 --> 00:15:13,500
that in order to get people to be in to

00:15:11,610 --> 00:15:15,030
understand what's going on in this code

00:15:13,500 --> 00:15:17,250
base we had to implement some new

00:15:15,030 --> 00:15:19,370
processes that meant more pair

00:15:17,250 --> 00:15:21,840
programming and even more importantly

00:15:19,370 --> 00:15:24,030
whenever we get new things from product

00:15:21,840 --> 00:15:25,470
we actually sit down and and have a

00:15:24,030 --> 00:15:27,810
discussion about what decisions we

00:15:25,470 --> 00:15:30,120
should be making and that was super

00:15:27,810 --> 00:15:31,770
critical and so valuable because now

00:15:30,120 --> 00:15:35,490
everybody is on the same page at the

00:15:31,770 --> 00:15:36,420
same time as you're building your as

00:15:35,490 --> 00:15:39,000
you're writing your code and you're

00:15:36,420 --> 00:15:40,770
building your app there's this moment

00:15:39,000 --> 00:15:41,760
when you know you need to push your

00:15:40,770 --> 00:15:45,060
production

00:15:41,760 --> 00:15:46,950
but you're probably a little nervous so

00:15:45,060 --> 00:15:48,450
why why are you a little nervous well

00:15:46,950 --> 00:15:49,560
it's probably because you're not as

00:15:48,450 --> 00:15:51,990
confident in your code is you really

00:15:49,560 --> 00:15:54,240
want to be ultimately this comes down to

00:15:51,990 --> 00:15:57,240
testing right you know that you can put

00:15:54,240 --> 00:15:59,460
stuff out when when it's really good

00:15:57,240 --> 00:16:02,550
quality code when you trust your code

00:15:59,460 --> 00:16:04,860
that means you are happy to let it go

00:16:02,550 --> 00:16:06,510
out into production when I first started

00:16:04,860 --> 00:16:08,850
when this team first started we thought

00:16:06,510 --> 00:16:10,560
okay you know what unit tests let's just

00:16:08,850 --> 00:16:12,240
focus on the unit tests because any

00:16:10,560 --> 00:16:15,930
testing is better than no testing at all

00:16:12,240 --> 00:16:18,090
for sure but about it got to the point

00:16:15,930 --> 00:16:20,520
where we would throw things up into

00:16:18,090 --> 00:16:22,680
staging and while all the individual

00:16:20,520 --> 00:16:25,200
pieces of code worked just fine the

00:16:22,680 --> 00:16:26,850
integration points didn't and why was

00:16:25,200 --> 00:16:28,860
that well we didn't have any integration

00:16:26,850 --> 00:16:31,620
tests so it was impossible for us to

00:16:28,860 --> 00:16:35,430
know because we we mocked out all of our

00:16:31,620 --> 00:16:37,440
API calls in our unit tests so if we had

00:16:35,430 --> 00:16:40,230
no idea we did not realize that the

00:16:37,440 --> 00:16:42,660
actual API calls from our external AP is

00:16:40,230 --> 00:16:44,730
the the stuff that was coming out of

00:16:42,660 --> 00:16:47,460
there was not much I was not matching

00:16:44,730 --> 00:16:49,380
what we were expecting so eventually we

00:16:47,460 --> 00:16:52,230
did put in integration tests I want to

00:16:49,380 --> 00:16:54,750
make a huge shout out to Nemo Jas

00:16:52,230 --> 00:16:56,940
they're made by the folks at paypal it

00:16:54,750 --> 00:16:59,340
is the best rapper around selenium I've

00:16:56,940 --> 00:17:00,780
ever seen so if you're if you're sitting

00:16:59,340 --> 00:17:03,900
there going and I don't know about

00:17:00,780 --> 00:17:07,500
integration tests nemo d is a promise

00:17:03,900 --> 00:17:12,420
it's worth your time speaking about

00:17:07,500 --> 00:17:14,940
trust n pm's ethos is all about the many

00:17:12,420 --> 00:17:17,010
small modules we love small modules

00:17:14,940 --> 00:17:19,260
there they make code easier to write

00:17:17,010 --> 00:17:21,870
they make your code stronger and better

00:17:19,260 --> 00:17:23,970
but ultimately there is that one tiny

00:17:21,870 --> 00:17:25,470
caveat which is that you didn't

00:17:23,970 --> 00:17:28,320
necessarily always right all of those

00:17:25,470 --> 00:17:29,820
little modules so you have to trust the

00:17:28,320 --> 00:17:34,320
people who created them in the first

00:17:29,820 --> 00:17:36,450
place but what happens when that trust

00:17:34,320 --> 00:17:38,640
is slightly broken we had an incident

00:17:36,450 --> 00:17:40,860
where we implemented we created a

00:17:38,640 --> 00:17:43,500
brand-new markdown parser and we added

00:17:40,860 --> 00:17:45,630
it to the website and that was super

00:17:43,500 --> 00:17:48,450
super great because it was beautiful and

00:17:45,630 --> 00:17:52,110
it worked fast except for whatever

00:17:48,450 --> 00:17:54,610
reason every 36 hours or so our website

00:17:52,110 --> 00:17:56,260
would just go down and crash

00:17:54,610 --> 00:17:58,870
because there was a massive memory leak

00:17:56,260 --> 00:18:01,000
we had no idea why it took us six months

00:17:58,870 --> 00:18:02,710
before before we we actually sat down

00:18:01,000 --> 00:18:04,690
and just went through line by line

00:18:02,710 --> 00:18:07,780
figured out where this memory leak was

00:18:04,690 --> 00:18:11,230
it turns out that within our markdown

00:18:07,780 --> 00:18:13,390
dependency there was a dependency that

00:18:11,230 --> 00:18:15,910
was a dependency of another dependency

00:18:13,390 --> 00:18:18,670
that had a memory leak in some c++ code

00:18:15,910 --> 00:18:21,400
and they had never seen that leak

00:18:18,670 --> 00:18:24,880
because nobody was using that that one

00:18:21,400 --> 00:18:26,980
tiny module at the scale that we were so

00:18:24,880 --> 00:18:29,020
we found this leak and the beauty of

00:18:26,980 --> 00:18:31,809
open source is that we found the leak we

00:18:29,020 --> 00:18:34,059
put in we put in a pull request and then

00:18:31,809 --> 00:18:36,190
using the beauty of some ver just kind

00:18:34,059 --> 00:18:37,750
of like worked our way back up memory

00:18:36,190 --> 00:18:40,559
leak gone push it out to production

00:18:37,750 --> 00:18:43,840
fantastic everything is fine again but

00:18:40,559 --> 00:18:47,350
you do have to trust that is that is a

00:18:43,840 --> 00:18:52,809
big thing I totally trust all of it just

00:18:47,350 --> 00:18:55,900
you know okay now the fun thing about

00:18:52,809 --> 00:18:58,260
working on a website is that you really

00:18:55,900 --> 00:19:00,730
bring an entire company together right

00:18:58,260 --> 00:19:02,110
everybody loves working on the website

00:19:00,730 --> 00:19:03,730
everybody has an opinion about what

00:19:02,110 --> 00:19:05,799
should be on the website and that's

00:19:03,730 --> 00:19:07,840
because for a lot of companies the

00:19:05,799 --> 00:19:10,360
website is your one opportunity to

00:19:07,840 --> 00:19:12,130
interact with the user base npm is

00:19:10,360 --> 00:19:14,049
interesting because we have a CLI and

00:19:12,130 --> 00:19:17,440
that's where all of our users interact

00:19:14,049 --> 00:19:20,410
with us but our marketing team and our

00:19:17,440 --> 00:19:22,809
support team and our Doc's team they all

00:19:20,410 --> 00:19:25,150
need to use the only to talk to you some

00:19:22,809 --> 00:19:27,040
way somehow and that's in addition to

00:19:25,150 --> 00:19:29,440
all the products that we're building so

00:19:27,040 --> 00:19:32,230
one of the biggest difficulties we had

00:19:29,440 --> 00:19:34,960
early on and actually even still to this

00:19:32,230 --> 00:19:37,210
day is figuring out how to really

00:19:34,960 --> 00:19:39,610
prioritize all of the different

00:19:37,210 --> 00:19:42,790
requirements and needs which are all

00:19:39,610 --> 00:19:44,950
valid in a way that we can really push

00:19:42,790 --> 00:19:47,200
everything out the door especially given

00:19:44,950 --> 00:19:48,910
that we have such a tiny tiny team the

00:19:47,200 --> 00:19:50,799
fact that everybody wants their say on

00:19:48,910 --> 00:19:53,919
how the website should look or act or

00:19:50,799 --> 00:19:56,260
feel it can be really overwhelming so we

00:19:53,919 --> 00:19:58,059
started we did two things and like I

00:19:56,260 --> 00:20:00,340
said it's a work in progress but the

00:19:58,059 --> 00:20:01,870
first thing we did was we started adding

00:20:00,340 --> 00:20:03,790
some kind of project management some

00:20:01,870 --> 00:20:05,770
product management to get people to kind

00:20:03,790 --> 00:20:08,590
of line up and say okay here are the

00:20:05,770 --> 00:20:10,630
major things that we need to accomplish

00:20:08,590 --> 00:20:11,980
and that's been really helpful because

00:20:10,630 --> 00:20:13,779
it allows us to kind of put into

00:20:11,980 --> 00:20:15,340
perspective okay this is the next thing

00:20:13,779 --> 00:20:17,620
that we need to accomplish everybody's

00:20:15,340 --> 00:20:19,419
on board cool but the other thing that

00:20:17,620 --> 00:20:21,640
we did from a technical side is we

00:20:19,419 --> 00:20:24,159
started breaking the website down it's a

00:20:21,640 --> 00:20:24,970
massive monolith at the moment but we're

00:20:24,159 --> 00:20:27,130
starting to breaking it down into

00:20:24,970 --> 00:20:30,940
different micro services which will

00:20:27,130 --> 00:20:33,850
allow individual teams a 10pm to kind of

00:20:30,940 --> 00:20:35,950
take over their own personal piece so

00:20:33,850 --> 00:20:39,850
for example the marketing team will have

00:20:35,950 --> 00:20:41,230
their own kind of marketing service that

00:20:39,850 --> 00:20:43,720
you as the user won't ever actually

00:20:41,230 --> 00:20:45,340
notice any difference but at least what

00:20:43,720 --> 00:20:46,809
that means is the marketing team can go

00:20:45,340 --> 00:20:49,059
ahead and push out the code they need

00:20:46,809 --> 00:20:51,100
whenever they want without having to

00:20:49,059 --> 00:20:55,720
incur the three-team three-person team

00:20:51,100 --> 00:20:57,820
bottleneck now probably the hardest

00:20:55,720 --> 00:21:00,929
lesson that we've learned in the last

00:20:57,820 --> 00:21:03,789
two and a half years comes down to this

00:21:00,929 --> 00:21:05,350
when Isaac first started NPM he did

00:21:03,789 --> 00:21:07,450
everything an open source and it was

00:21:05,350 --> 00:21:09,909
fantastic it was really really really

00:21:07,450 --> 00:21:11,590
wonderful in fact all of us who joined

00:21:09,909 --> 00:21:14,289
NPM especially on the engineering team

00:21:11,590 --> 00:21:15,909
we were super ecstatic because how great

00:21:14,289 --> 00:21:17,649
is it to have somebody else pay you to

00:21:15,909 --> 00:21:19,059
work on open source like that is just

00:21:17,649 --> 00:21:21,940
the coolest thing ever no more nights

00:21:19,059 --> 00:21:25,809
and weekends this is your day job and it

00:21:21,940 --> 00:21:27,640
was great but then something happened we

00:21:25,809 --> 00:21:29,890
had to get stuff out the door we had a

00:21:27,640 --> 00:21:32,529
move on product our team was too small

00:21:29,890 --> 00:21:34,899
we didn't have any bandwidth or the

00:21:32,529 --> 00:21:37,630
people or the time to really focus on

00:21:34,899 --> 00:21:39,130
the user community so people would put

00:21:37,630 --> 00:21:41,500
in pull requests and issues and we were

00:21:39,130 --> 00:21:43,600
like okay well let's get to this but

00:21:41,500 --> 00:21:45,580
then another thing happened which is

00:21:43,600 --> 00:21:47,649
that the registry team decided to break

00:21:45,580 --> 00:21:50,679
out the registry into lots of different

00:21:47,649 --> 00:21:52,870
micro services which was great it made

00:21:50,679 --> 00:21:54,940
us move a lot faster internally but it

00:21:52,870 --> 00:21:57,340
meant that our user base couldn't

00:21:54,940 --> 00:21:59,260
replicate the website locally because

00:21:57,340 --> 00:22:00,789
all of these services were private and

00:21:59,260 --> 00:22:03,429
everything like that and it was just

00:22:00,789 --> 00:22:06,250
suddenly you could clone the repo but

00:22:03,429 --> 00:22:08,590
you couldn't actually do anything with

00:22:06,250 --> 00:22:11,080
it and Sippie would put in issues and

00:22:08,590 --> 00:22:12,399
they'd be like hey I think I think this

00:22:11,080 --> 00:22:15,460
is wrong but I don't know because I

00:22:12,399 --> 00:22:18,039
can't replicate it but maybe you could

00:22:15,460 --> 00:22:20,320
do it for us it's like we don't have the

00:22:18,039 --> 00:22:21,700
time to do that oh gosh this is really

00:22:20,320 --> 00:22:23,080
bad and

00:22:21,700 --> 00:22:24,789
just kind of kept building up and

00:22:23,080 --> 00:22:27,460
building up and it was kind of terrible

00:22:24,789 --> 00:22:31,570
and at the same time we had the

00:22:27,460 --> 00:22:34,029
situation where because our repo was

00:22:31,570 --> 00:22:36,870
open source at the time like we've been

00:22:34,029 --> 00:22:39,220
using Travis continuous integration for

00:22:36,870 --> 00:22:44,529
last year and a half or so and it's been

00:22:39,220 --> 00:22:47,200
fantastic at the time the if you have a

00:22:44,529 --> 00:22:49,090
public repo you end up in the same queue

00:22:47,200 --> 00:22:51,220
as all the other public repose which

00:22:49,090 --> 00:22:54,070
sometimes meant that even if it was a

00:22:51,220 --> 00:22:56,799
massive security bug fix it could take

00:22:54,070 --> 00:22:59,320
up to an hour maybe two to get our build

00:22:56,799 --> 00:23:01,750
to go that's not acceptable for a

00:22:59,320 --> 00:23:04,029
production level website so we did a

00:23:01,750 --> 00:23:06,669
little experiment we we went ahead and

00:23:04,029 --> 00:23:09,070
we've made a private Fork of the website

00:23:06,669 --> 00:23:11,169
just to see what happens well first of

00:23:09,070 --> 00:23:13,360
all the Travis fields went the the

00:23:11,169 --> 00:23:15,669
timing went down super it was super fast

00:23:13,360 --> 00:23:18,100
right so great we can move forward and

00:23:15,669 --> 00:23:21,360
we can move really quickly but then

00:23:18,100 --> 00:23:23,980
another thing happened nobody noticed

00:23:21,360 --> 00:23:27,100
nobody noticed that we made a private

00:23:23,980 --> 00:23:29,019
Fork of everything like the public open

00:23:27,100 --> 00:23:31,539
source version of our website was stale

00:23:29,019 --> 00:23:33,039
for months and there may be two people

00:23:31,539 --> 00:23:35,500
who are like hey wait a second this

00:23:33,039 --> 00:23:39,880
doesn't quite look right but I'm talking

00:23:35,500 --> 00:23:43,179
to out of all of our users that was it

00:23:39,880 --> 00:23:46,299
was kind of like well so at this point

00:23:43,179 --> 00:23:48,850
it kind of just feels like just a view

00:23:46,299 --> 00:23:50,950
source button which it was really

00:23:48,850 --> 00:23:53,919
awesome talking to miles the other night

00:23:50,950 --> 00:23:55,090
he talked about open source vs. view

00:23:53,919 --> 00:23:57,669
source and I thought it was a brilliant

00:23:55,090 --> 00:23:58,750
brilliant idea but that was basically we

00:23:57,669 --> 00:24:00,340
were doing we're just kind of showing

00:23:58,750 --> 00:24:04,059
off our website but we couldn't let

00:24:00,340 --> 00:24:06,490
anybody really comment on it or work

00:24:04,059 --> 00:24:08,830
with it or play with it and so we made

00:24:06,490 --> 00:24:14,350
the really tough decision to go ahead

00:24:08,830 --> 00:24:16,630
and just shut it down that's hard it's

00:24:14,350 --> 00:24:19,299
really hard believe me there was a lot

00:24:16,630 --> 00:24:20,980
of angry people internally to the

00:24:19,299 --> 00:24:22,779
company there were a lot of discussions

00:24:20,980 --> 00:24:25,120
there were very heated discussions that

00:24:22,779 --> 00:24:26,710
happen because of it now the way that

00:24:25,120 --> 00:24:28,929
we've mollified it is that in the

00:24:26,710 --> 00:24:30,220
process of taking our monolithic app and

00:24:28,929 --> 00:24:32,799
breaking it down into smaller pieces

00:24:30,220 --> 00:24:34,899
we're open sourcing the tiny modules

00:24:32,799 --> 00:24:35,350
right and those are a lot easier to

00:24:34,899 --> 00:24:38,950
maintain

00:24:35,350 --> 00:24:41,320
because it's 30 lines of code there's a

00:24:38,950 --> 00:24:44,549
pull request great and it's easy to see

00:24:41,320 --> 00:24:48,340
an easy to test and it's fantastic so

00:24:44,549 --> 00:24:51,070
that was rough but it happened now

00:24:48,340 --> 00:24:53,890
through all of this we have learned a

00:24:51,070 --> 00:24:55,570
ton of lessons right we've made a bunch

00:24:53,890 --> 00:24:57,760
of mistakes we've made some really good

00:24:55,570 --> 00:25:02,799
decisions and we paid a ton of progress

00:24:57,760 --> 00:25:04,360
and just change this website so much but

00:25:02,799 --> 00:25:05,860
ultimately no matter what mistakes we

00:25:04,360 --> 00:25:07,929
made no matter what decisions we made

00:25:05,860 --> 00:25:09,130
thin in the day we're going to make more

00:25:07,929 --> 00:25:10,150
mistakes and we're going to make more

00:25:09,130 --> 00:25:11,679
decisions and it's just going to

00:25:10,150 --> 00:25:14,080
continue cycling because change is

00:25:11,679 --> 00:25:15,549
inevitable as we move forward as we

00:25:14,080 --> 00:25:17,200
continue learning we're going to get

00:25:15,549 --> 00:25:19,990
we're going to learn yet even more and

00:25:17,200 --> 00:25:21,580
ultimately personally I want to thank

00:25:19,990 --> 00:25:24,880
you all for giving us that opportunity

00:25:21,580 --> 00:25:27,250
because honestly it's because of all of

00:25:24,880 --> 00:25:29,110
our users that we continually want and

00:25:27,250 --> 00:25:31,750
strive to change and it's because of you

00:25:29,110 --> 00:25:33,880
who use these products and services that

00:25:31,750 --> 00:25:35,620
we are desperate to get out that we can

00:25:33,880 --> 00:25:37,240
continue to maintain this wonderful

00:25:35,620 --> 00:25:39,700
ecosystem and really build up this

00:25:37,240 --> 00:25:45,159
community in every other way that we

00:25:39,700 --> 00:25:48,669
possibly can so with that huge huge huge

00:25:45,159 --> 00:25:54,370
thanks it's great to be here I have a

00:25:48,669 --> 00:25:55,809
few pairs of socks um what do you mean

00:25:54,370 --> 00:25:59,860
I'm not bribing me to be my friend's uh

00:25:55,809 --> 00:26:02,350
so if you would like to maybe pukur one

00:25:59,860 --> 00:26:06,460
of these I'd come hang out with me and

00:26:02,350 --> 00:26:09,100
ask me questions and let's talk about

00:26:06,460 --> 00:26:11,409
NPM and let's talk about the website or

00:26:09,100 --> 00:26:12,909
the CLI or anything I want to hear your

00:26:11,409 --> 00:26:15,659
opinions I want to hear what you have to

00:26:12,909 --> 00:26:19,110
say that matters a lot to me all right

00:26:15,659 --> 00:26:19,110

YouTube URL: https://www.youtube.com/watch?v=uAT7MJnHnMs


