Title: Simon Swain: Rats Of The Maze - JSConf.Asia 2016
Publication date: 2016-12-13
Playlist: JSConf.Asia 2016
Description: 
	The year is 2048. Thirty years ago, we outsourced the very runnings of our lives to machines. Machines that learn... The machines learnt... too well...

Simon is an institution at JSConf.Asia by now and has blown away our audiences in the past 3 years with gripping stories and mesmerizing visual effects in the browser. He has been building the web since the beginning, somehow surviving through it's many iterations.
Currently he is building cloud services for connected devices.


JSConf.Asia - Capitol Theatre, Singapore - 25+26 November 2016

Source: https://2016.jsconf.asia/
Demo: http://ratsofthemaze.com

License: For reuse of this video under a more permissive license please get in touch with us. The speakers retain the copyright for their performances.
Captions: 
	00:00:01,260 --> 00:00:04,420
[Music]

00:00:04,680 --> 00:00:18,800
[Applause]

00:00:05,390 --> 00:00:18,800
[Music]

00:00:29,030 --> 00:00:31,090
you

00:00:33,130 --> 00:00:37,080
you

00:00:35,020 --> 00:00:37,080
you

00:00:46,079 --> 00:00:54,870
the year is 2048 30 years ago we

00:00:52,510 --> 00:01:02,350
outsource the very runnings of our lives

00:00:54,870 --> 00:01:08,880
to machines machines that learn the

00:01:02,350 --> 00:01:10,960
machines learnt too well today all

00:01:08,880 --> 00:01:15,130
computing resource on the planet has

00:01:10,960 --> 00:01:19,899
been consolidated in a vast maze hewn

00:01:15,130 --> 00:01:24,460
out of solid rock no humans have access

00:01:19,899 --> 00:01:28,920
to the maze reactors makes an ideal home

00:01:24,460 --> 00:01:31,500
for millions of flesh-eating rats

00:01:28,920 --> 00:01:33,670
your mission is the end of the maze

00:01:31,500 --> 00:01:36,310
sabotage the power source of the

00:01:33,670 --> 00:01:42,170
machines and free the human race from

00:01:36,310 --> 00:01:45,710
its self-inflicted automated prison

00:01:42,170 --> 00:01:49,900
you are our last best hope but until

00:01:45,710 --> 00:01:49,900
today no human has survived

00:01:52,540 --> 00:01:56,850
of the rats rats

00:02:00,600 --> 00:02:02,659
you

00:02:05,010 --> 00:02:07,070
you

00:02:12,890 --> 00:02:16,860
human hackers have penetrated the

00:02:15,090 --> 00:02:18,930
machines networks and obtained some

00:02:16,860 --> 00:02:22,580
basic intelligence on the configuration

00:02:18,930 --> 00:02:22,580
of their defenses

00:02:25,970 --> 00:02:31,290
before you enter the maze we will

00:02:28,680 --> 00:02:34,220
provide a brief overview of what we have

00:02:31,290 --> 00:02:34,220
learned so far

00:02:34,370 --> 00:02:38,490
the machines hired deep in their maze

00:02:36,720 --> 00:02:42,980
from where they control our world

00:02:38,490 --> 00:02:42,980
disable their power to free all humans

00:02:43,730 --> 00:02:57,450
each maze has a reactor find the reactor

00:02:47,810 --> 00:03:02,190
sabotage escape follow markers to reach

00:02:57,450 --> 00:03:04,890
your goal we have identified three

00:03:02,190 --> 00:03:13,890
primary variants of vermin the breeder

00:03:04,890 --> 00:03:18,140
at the baby rent the kilo red superior

00:03:13,890 --> 00:03:21,140
machine engineering creates rat breeding

00:03:18,140 --> 00:03:21,140
factories

00:03:27,870 --> 00:03:35,140
destroy rats have no mercy in a tight

00:03:32,379 --> 00:03:37,890
situation you're super Zappa will help

00:03:35,140 --> 00:03:37,890
you survive

00:03:42,130 --> 00:03:49,680
before you enter the maze we will

00:03:44,560 --> 00:03:49,680
provide a brief training simulation

00:03:52,400 --> 00:03:56,849
[Music]

00:03:59,910 --> 00:04:03,259
[Music]

00:04:08,150 --> 00:04:14,420
are you ready you look ready

00:04:15,710 --> 00:04:27,829
[Music]

00:04:31,280 --> 00:04:44,500
[Music]

00:05:13,090 --> 00:05:16,240
[Music]

00:05:30,889 --> 00:05:32,949
you

00:05:33,150 --> 00:05:37,229
you

00:05:35,169 --> 00:05:37,229
you

00:05:37,260 --> 00:05:39,320
you

00:05:39,430 --> 00:05:41,490
you

00:05:45,730 --> 00:05:52,590
the maze exists as a grid

00:05:50,400 --> 00:05:55,259
we represent the amazing memory as a

00:05:52,590 --> 00:05:58,229
one-dimensional array we can easily

00:05:55,259 --> 00:06:00,600
translate between the XY coordinates of

00:05:58,229 --> 00:06:03,720
the cells and the grid and the zero

00:06:00,600 --> 00:06:07,980
indexed elements of the array that are

00:06:03,720 --> 00:06:10,800
these cells each sellers are so

00:06:07,980 --> 00:06:13,440
contain simulation implemented as a

00:06:10,800 --> 00:06:16,320
function object it has attributes that

00:06:13,440 --> 00:06:18,390
describe the cell and arrays to hold the

00:06:16,320 --> 00:06:24,120
collections of actors that exist within

00:06:18,390 --> 00:06:26,790
the cell one of ourselves attributes are

00:06:24,120 --> 00:06:29,810
its neighbors a four element array

00:06:26,790 --> 00:06:33,230
representing north east south and west

00:06:29,810 --> 00:06:35,580
if a given side of the cell is closed

00:06:33,230 --> 00:06:38,430
the corresponding element in the

00:06:35,580 --> 00:06:40,650
neighbors array is known if the side of

00:06:38,430 --> 00:06:42,690
the cell is open the corresponding

00:06:40,650 --> 00:06:45,360
element holds a reference to the

00:06:42,690 --> 00:06:49,110
function object that is the neighboring

00:06:45,360 --> 00:06:51,330
cell this lets us create a traversable

00:06:49,110 --> 00:06:53,040
graph of cells that are connected

00:06:51,330 --> 00:06:55,140
together and have cells that are

00:06:53,040 --> 00:06:57,480
completely isolated from their neighbors

00:06:55,140 --> 00:07:02,550
giving us access to a bountiful

00:06:57,480 --> 00:07:05,910
abundance of powerful algorithms to make

00:07:02,550 --> 00:07:09,780
a maze we start with a grid of

00:07:05,910 --> 00:07:13,560
completely disconnected cells pick a

00:07:09,780 --> 00:07:15,510
cell at random any cell will do pick a

00:07:13,560 --> 00:07:19,100
neighbor of that cell ensuring that

00:07:15,510 --> 00:07:21,360
neighbor has no connections of its own

00:07:19,100 --> 00:07:25,410
create a mutual connection between the

00:07:21,360 --> 00:07:29,670
two cells push the cell we came from

00:07:25,410 --> 00:07:33,150
onto a stack or repeat the process from

00:07:29,670 --> 00:07:35,610
the neighboring cell we selected as we

00:07:33,150 --> 00:07:38,970
work our way through the grid we build

00:07:35,610 --> 00:07:41,070
up a list of places we visited when

00:07:38,970 --> 00:07:43,320
there are no more cells to explore we

00:07:41,070 --> 00:07:44,490
pop an element off the stack and work

00:07:43,320 --> 00:07:47,640
back the way we came

00:07:44,490 --> 00:07:51,510
following up any unexplored cells we

00:07:47,640 --> 00:07:55,590
find along the way when there's nothing

00:07:51,510 --> 00:07:59,120
left on our stack we know we formed our

00:07:55,590 --> 00:07:59,120
perfect maze

00:08:07,629 --> 00:08:13,909
each cell is a self-contained simulation

00:08:10,580 --> 00:08:15,860
it is a floorspace and collections of

00:08:13,909 --> 00:08:19,849
actors that interact with each other

00:08:15,860 --> 00:08:20,810
within that space a game loop runs 60

00:08:19,849 --> 00:08:22,340
times a second

00:08:20,810 --> 00:08:26,030
driven by window don't

00:08:22,340 --> 00:08:27,740
requestanimationframe each frame we

00:08:26,030 --> 00:08:30,050
iterate through our array of cells

00:08:27,740 --> 00:08:32,240
giving each one a chance to run its

00:08:30,050 --> 00:08:36,010
simulation so it's actors can observe

00:08:32,240 --> 00:08:38,979
their environment and react accordingly

00:08:36,010 --> 00:08:41,990
the simulations use simple counters

00:08:38,979 --> 00:08:43,760
periodic waveforms and the probability

00:08:41,990 --> 00:08:47,149
of events occurring to modulate

00:08:43,760 --> 00:08:49,880
parameters and trigger effects each

00:08:47,149 --> 00:08:53,029
class of actor has a set of interacting

00:08:49,880 --> 00:08:55,820
behaviors combining several simple

00:08:53,029 --> 00:09:01,820
behaviors together can make for complex

00:08:55,820 --> 00:09:04,430
results when an actor moves to the edge

00:09:01,820 --> 00:09:07,790
of a cell and that edge is closed

00:09:04,430 --> 00:09:09,500
they reflect off the walls exert a kind

00:09:07,790 --> 00:09:11,839
of short-range as some topic

00:09:09,500 --> 00:09:14,350
anti-gravity expressed as a force vector

00:09:11,839 --> 00:09:17,829
and applied to the actors velocity

00:09:14,350 --> 00:09:21,740
causing them to move away from the wall

00:09:17,829 --> 00:09:23,630
if the side of the cell is open the

00:09:21,740 --> 00:09:25,880
actor is moved into the neighboring cell

00:09:23,630 --> 00:09:30,490
with a bit of mass applied to their

00:09:25,880 --> 00:09:30,490
position to reflect their entry point

00:09:32,079 --> 00:09:39,940
the human exhibits a consuming impulse

00:09:34,940 --> 00:09:39,940
to seek the reactor sabotage and escape

00:09:42,160 --> 00:09:47,100
the rats exhibit a base

00:09:45,000 --> 00:09:49,440
flocking behavior with a cluster and

00:09:47,100 --> 00:09:53,450
move together as a group or maintaining

00:09:49,440 --> 00:09:53,450
some separation from their friends

00:09:54,860 --> 00:10:01,800
the killer ants have the same base

00:09:58,710 --> 00:10:11,100
behavior but a possessed to seek the

00:10:01,800 --> 00:10:14,400
human and devour his flesh both basic

00:10:11,100 --> 00:10:17,040
behaviors beholden us be able to find

00:10:14,400 --> 00:10:19,040
our way through the mains we always have

00:10:17,040 --> 00:10:22,740
an origin and a desired destination

00:10:19,040 --> 00:10:25,350
because we have a perfect maze we can

00:10:22,740 --> 00:10:29,760
always find away from oneself to any

00:10:25,350 --> 00:10:31,740
other from our origin we expand a search

00:10:29,760 --> 00:10:36,300
frontier through every connected cell we

00:10:31,740 --> 00:10:38,370
can find as we search we record the

00:10:36,300 --> 00:10:41,040
place we came from and calculate the

00:10:38,370 --> 00:10:44,940
cost in terms of distance for us to get

00:10:41,040 --> 00:10:47,070
to each cell if for a given path there

00:10:44,940 --> 00:10:51,839
are no more cells to explore we

00:10:47,070 --> 00:10:53,790
terminate our search on that path if we

00:10:51,839 --> 00:10:56,130
reach our destination our search is

00:10:53,790 --> 00:11:00,780
complete and we use a list of places we

00:10:56,130 --> 00:11:03,570
came from to determine our route we can

00:11:00,780 --> 00:11:06,270
enhance the solver to the cost

00:11:03,570 --> 00:11:07,950
calculation for each cell based roughly

00:11:06,270 --> 00:11:10,230
on the distance from that cell to our

00:11:07,950 --> 00:11:12,600
destination and following the path with

00:11:10,230 --> 00:11:20,910
the lowest cost to help us reach our

00:11:12,600 --> 00:11:24,450
goal quickly when the human enters the

00:11:20,910 --> 00:11:27,570
maze he uses the formula to determine

00:11:24,450 --> 00:11:29,190
the route to the reactor the steps of

00:11:27,570 --> 00:11:31,230
the path are contained in an array of

00:11:29,190 --> 00:11:34,380
cell indexes arranged an order from

00:11:31,230 --> 00:11:37,110
start to finish from the seller humanism

00:11:34,380 --> 00:11:40,020
we determine the exit that is connected

00:11:37,110 --> 00:11:41,339
to the next step in the path and apply a

00:11:40,020 --> 00:11:43,080
force vector to the human in that

00:11:41,339 --> 00:11:45,540
direction pushing him out through the

00:11:43,080 --> 00:11:48,360
exit and into the next cell until he

00:11:45,540 --> 00:11:53,600
reaches the reactor when it's time to

00:11:48,360 --> 00:11:53,600
escape the path is reversed

00:11:54,870 --> 00:12:00,930
it would be too expensive to calculate

00:11:59,250 --> 00:12:04,920
the path through the maze for each

00:12:00,930 --> 00:12:06,570
individual rent so before updating each

00:12:04,920 --> 00:12:08,730
cell determines the route through its

00:12:06,570 --> 00:12:10,800
neighbors to the human applying a force

00:12:08,730 --> 00:12:12,450
vector to all killer rats on the cell

00:12:10,800 --> 00:12:15,029
pushing them out through the exit

00:12:12,450 --> 00:12:19,130
creating the illusion that they are

00:12:15,029 --> 00:12:19,130
seeking the human to devour his flesh

00:12:23,480 --> 00:12:30,450
when a maze is created we need to seed

00:12:27,150 --> 00:12:32,520
it with interesting objects some cells

00:12:30,450 --> 00:12:37,350
have a special object in them like the

00:12:32,520 --> 00:12:39,270
reactor or a rant Factory the first cell

00:12:37,350 --> 00:12:42,480
in the maze is always the ingress the

00:12:39,270 --> 00:12:45,270
human enters through the last cell is

00:12:42,480 --> 00:12:47,339
always the reactor the human follows a

00:12:45,270 --> 00:12:50,339
path from the ingress to the reactor and

00:12:47,339 --> 00:12:53,190
back we can treat the sips of this path

00:12:50,339 --> 00:12:55,650
as linear and pick points of random or

00:12:53,190 --> 00:12:59,850
according to some rules placing items in

00:12:55,650 --> 00:13:02,550
the cells referenced by those points we

00:12:59,850 --> 00:13:04,709
can also place items off the path so

00:13:02,550 --> 00:13:09,320
they have an effect on play but don't

00:13:04,709 --> 00:13:09,320
interfere with the humans movement a

00:13:10,640 --> 00:13:16,320
level counter is incremented each time a

00:13:13,260 --> 00:13:18,270
maze is completed as the human

00:13:16,320 --> 00:13:20,370
progresses through the levels the mazes

00:13:18,270 --> 00:13:23,850
get larger with more devious entities

00:13:20,370 --> 00:13:25,680
hiding in their depths the occurrence of

00:13:23,850 --> 00:13:26,580
monsters in the first four levels is

00:13:25,680 --> 00:13:29,339
hard-coded

00:13:26,580 --> 00:13:30,959
but beyond that some cheap tricks are

00:13:29,339 --> 00:13:33,810
employed to create the illusion of

00:13:30,959 --> 00:13:36,630
forethought if we take a level number

00:13:33,810 --> 00:13:38,850
and apply some modular arithmetic we can

00:13:36,630 --> 00:13:41,010
activate a disable the occurrence of

00:13:38,850 --> 00:13:44,100
certain effects and objects based on the

00:13:41,010 --> 00:13:47,010
result every third level zooms to follow

00:13:44,100 --> 00:13:50,339
the human every seventh lever has extra

00:13:47,010 --> 00:13:53,089
power-ups every thirteenth level is a

00:13:50,339 --> 00:13:53,089
tiny maze

00:13:57,320 --> 00:14:11,930
the future is uncertain but one day soon

00:14:03,770 --> 00:14:11,930
the human race must enter the maze of

00:14:14,360 --> 00:14:17,440
[Music]

00:14:20,350 --> 00:14:25,749
[Music]

00:14:27,990 --> 00:14:33,009
[Music]

00:14:40,210 --> 00:14:56,240
[Music]

00:15:02,100 --> 00:15:06,899
[Music]

00:15:17,150 --> 00:15:20,340
[Music]

00:15:22,040 --> 00:15:25,220
thank you

00:15:25,580 --> 00:15:30,809

YouTube URL: https://www.youtube.com/watch?v=-IvDnvtJ93s


