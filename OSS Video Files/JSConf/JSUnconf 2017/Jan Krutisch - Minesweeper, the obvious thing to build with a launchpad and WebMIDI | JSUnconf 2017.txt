Title: Jan Krutisch - Minesweeper, the obvious thing to build with a launchpad and WebMIDI | JSUnconf 2017
Publication date: 2017-06-26
Playlist: JSUnconf 2017
Description: 
	
Captions: 
	00:00:00,709 --> 00:00:10,910
can you hear me all right sounds good

00:00:05,990 --> 00:00:10,910
everyone here who knows

00:00:12,980 --> 00:00:20,789
since eyes the schedule is so tight I'm

00:00:17,699 --> 00:00:23,340
just going to start as a well first of

00:00:20,789 --> 00:00:27,449
all thank you for uploading my talk

00:00:23,340 --> 00:00:29,310
today and I try to cobble together a

00:00:27,449 --> 00:00:32,930
short presentation at the beginning but

00:00:29,310 --> 00:00:36,390
most of the part will be me trying to

00:00:32,930 --> 00:00:39,030
assemble pieces of code that I know work

00:00:36,390 --> 00:00:41,219
together and in a way that makes more

00:00:39,030 --> 00:00:42,809
sense for you to understand it but

00:00:41,219 --> 00:00:45,210
there's always the fallback of the full

00:00:42,809 --> 00:00:48,120
working version so I have this is not

00:00:45,210 --> 00:00:52,309
really live coding more like life copy

00:00:48,120 --> 00:00:56,989
and pasting but I think it will help so

00:00:52,309 --> 00:01:01,559
what I'm going to talk about is this

00:00:56,989 --> 00:01:03,300
among other things short disclaimer I'm

00:01:01,559 --> 00:01:06,090
currently working as a freelancer for

00:01:03,300 --> 00:01:07,650
this company innovation but that's not

00:01:06,090 --> 00:01:09,450
the reason I'm giving the talk it's just

00:01:07,650 --> 00:01:11,640
the most of the products are pretty

00:01:09,450 --> 00:01:13,799
awesome and this one especially it's

00:01:11,640 --> 00:01:16,970
like one of the cheapest devices that

00:01:13,799 --> 00:01:21,600
gives you some sort of button matrix

00:01:16,970 --> 00:01:25,650
with colors on it it costs under 100

00:01:21,600 --> 00:01:28,259
euros which sounds a lot for a piece of

00:01:25,650 --> 00:01:31,259
plastic and LEDs but if you look at what

00:01:28,259 --> 00:01:32,759
the competitors are doing or if you try

00:01:31,259 --> 00:01:36,119
to build this by hand this is actually

00:01:32,759 --> 00:01:38,850
relatively cheap and also it works very

00:01:36,119 --> 00:01:41,070
reliable which is a good thing for music

00:01:38,850 --> 00:01:45,149
instruments I guess so what this

00:01:41,070 --> 00:01:48,020
technically is really just a field of

00:01:45,149 --> 00:01:50,340
buttons and LEDs under it it's not even

00:01:48,020 --> 00:01:52,619
velocity sensitive they are versions

00:01:50,340 --> 00:01:54,060
that like to measure how hard you press

00:01:52,619 --> 00:01:57,270
the buttons but in this case it's just

00:01:54,060 --> 00:01:59,759
on and off and that's pretty cool for a

00:01:57,270 --> 00:02:02,460
lot of musical applications but I always

00:01:59,759 --> 00:02:06,750
feel like we are not using alternative

00:02:02,460 --> 00:02:08,399
input methods enough and so I always try

00:02:06,750 --> 00:02:10,950
to come up with interesting ideas

00:02:08,399 --> 00:02:14,909
to do with it so how to talk to this

00:02:10,950 --> 00:02:17,099
thing well meaty obviously like every

00:02:14,909 --> 00:02:19,439
musical instrument really stands for a

00:02:17,099 --> 00:02:21,030
musical instrument device interface some

00:02:19,439 --> 00:02:23,599
of you may have heard to talk about this

00:02:21,030 --> 00:02:29,090
for me before how many of you know

00:02:23,599 --> 00:02:32,879
nothing about new MIDI okay a few hands

00:02:29,090 --> 00:02:36,319
so the thing about media is that it's

00:02:32,879 --> 00:02:42,349
really old media used to be about this

00:02:36,319 --> 00:02:47,579
these are being plugs and the year is

00:02:42,349 --> 00:02:55,650
1983 that is a long time ago how many of

00:02:47,579 --> 00:03:01,049
you here are born after 1983 yeah that

00:02:55,650 --> 00:03:04,099
always scares me a bit so the years 1983

00:03:01,049 --> 00:03:06,329
and a few vendors of electronic

00:03:04,099 --> 00:03:10,290
instruments you know the synthesizers

00:03:06,329 --> 00:03:13,379
just became a thing and synthesizers

00:03:10,290 --> 00:03:16,379
wanted to be you know you want to

00:03:13,379 --> 00:03:18,449
connect synthesizers together and have

00:03:16,379 --> 00:03:21,299
them play each other or whatnot and so

00:03:18,449 --> 00:03:22,980
this was basically done by a few

00:03:21,299 --> 00:03:24,629
companies coming together and agreeing

00:03:22,980 --> 00:03:27,780
on a standard something that you don't

00:03:24,629 --> 00:03:30,269
eat that often these days but it is I

00:03:27,780 --> 00:03:31,909
mean probably web centers are pretty

00:03:30,269 --> 00:03:34,859
close to what was happening here and

00:03:31,909 --> 00:03:38,010
interestingly enough they kind of they

00:03:34,859 --> 00:03:42,180
got out the one aspect and that's still

00:03:38,010 --> 00:03:45,299
the relevant document which is kind of

00:03:42,180 --> 00:03:47,819
fascinating what's not so relevant

00:03:45,299 --> 00:03:49,560
anymore is like on the second page or so

00:03:47,819 --> 00:03:51,690
there's electric circuitry how you

00:03:49,560 --> 00:03:53,549
should build these reflex things to

00:03:51,690 --> 00:03:55,319
isolate them correctly so that you

00:03:53,549 --> 00:03:59,209
cannot destroy your instruments when

00:03:55,319 --> 00:04:03,629
plugging things together nowadays mostly

00:03:59,209 --> 00:04:05,940
MIDI runs over USB or just internally in

00:04:03,629 --> 00:04:07,949
software but the protocol is still used

00:04:05,940 --> 00:04:13,169
and the protocol is basically serial

00:04:07,949 --> 00:04:16,049
data because back then that was like the

00:04:13,169 --> 00:04:17,900
simplest thing that would possibly work

00:04:16,049 --> 00:04:21,410
and

00:04:17,900 --> 00:04:24,410
it it's really simple you only have two

00:04:21,410 --> 00:04:26,449
types of well basically is bite by bite

00:04:24,410 --> 00:04:27,229
and you only have two different types of

00:04:26,449 --> 00:04:30,110
data

00:04:27,229 --> 00:04:35,590
one is a command and one is a data bite

00:04:30,110 --> 00:04:38,570
and a data stream on on any MIDI

00:04:35,590 --> 00:04:41,030
interface regardless of you know one of

00:04:38,570 --> 00:04:42,650
those old plugs or a USB interface looks

00:04:41,030 --> 00:04:44,630
like this you have a command bite and

00:04:42,650 --> 00:04:47,720
then data data data data data data data

00:04:44,630 --> 00:04:49,759
data or maybe just data data and then

00:04:47,720 --> 00:04:52,280
another command bite and that's the only

00:04:49,759 --> 00:04:54,380
way how you can chunk come on luckily

00:04:52,280 --> 00:04:56,479
you don't have to do that yourselves and

00:04:54,380 --> 00:05:00,830
modern ID is but that's how it works

00:04:56,479 --> 00:05:02,960
basically so speaking to this device

00:05:00,830 --> 00:05:04,910
let's talk about briefly let's talk

00:05:02,960 --> 00:05:07,729
briefly about output and what you see is

00:05:04,910 --> 00:05:10,190
already kind of what you do with the web

00:05:07,729 --> 00:05:12,229
MIDI API I'm going to talk about as soon

00:05:10,190 --> 00:05:15,610
as you see the code but if it's

00:05:12,229 --> 00:05:18,410
basically you're just sending bytes out

00:05:15,610 --> 00:05:24,500
is this readable and the bottom or is it

00:05:18,410 --> 00:05:27,289
too small okay so you send one command

00:05:24,500 --> 00:05:30,949
and then data behind it and the specific

00:05:27,289 --> 00:05:33,919
command here is 1:44 which is note on

00:05:30,949 --> 00:05:35,900
and it's it's really it's really that

00:05:33,919 --> 00:05:38,449
basic it's not like there's no

00:05:35,900 --> 00:05:40,669
abstraction in the web MIDI API that

00:05:38,449 --> 00:05:42,650
says okay note on is one point four you

00:05:40,669 --> 00:05:44,180
just have to know that obviously there

00:05:42,650 --> 00:05:47,750
are libraries that people wrote to make

00:05:44,180 --> 00:05:49,490
it a little bit easier but for me I've

00:05:47,750 --> 00:05:51,889
been doing MIDI programming for a long

00:05:49,490 --> 00:05:55,940
time this feels home like this 144 yeah

00:05:51,889 --> 00:05:58,159
I know that the second one is in this

00:05:55,940 --> 00:05:59,930
case is the note on command the second

00:05:58,159 --> 00:06:01,960
one this is different for different

00:05:59,930 --> 00:06:04,250
commands so they are commands for like

00:06:01,960 --> 00:06:06,470
twisting buttons and stuff but in this

00:06:04,250 --> 00:06:12,110
case it's really just okay play a note

00:06:06,470 --> 00:06:15,889
and the note here 24 these are just half

00:06:12,110 --> 00:06:17,990
tones if someone knows what use our

00:06:15,889 --> 00:06:20,840
music notation works these are just half

00:06:17,990 --> 00:06:21,460
tones and the zero is basically the

00:06:20,840 --> 00:06:24,250
lowest

00:06:21,460 --> 00:06:27,280
and so 24 would probably be something

00:06:24,250 --> 00:06:30,310
like these zero or something C zero and

00:06:27,280 --> 00:06:32,740
the last one is velocity so how hot has

00:06:30,310 --> 00:06:35,349
someone hit a keyboard or pull the

00:06:32,740 --> 00:06:36,849
string or something if we want to talk

00:06:35,349 --> 00:06:41,139
to the launch pad things are a little

00:06:36,849 --> 00:06:43,449
bit different so the note on command

00:06:41,139 --> 00:06:48,099
basically switches on one of those LEDs

00:06:43,449 --> 00:06:49,930
below the buttons the second the note is

00:06:48,099 --> 00:06:52,810
basically the position on the grid and

00:06:49,930 --> 00:06:57,000
they did that in a very I don't know

00:06:52,810 --> 00:07:02,380
clever way I guess where every row is so

00:06:57,000 --> 00:07:06,160
zero would be top left and then 16 would

00:07:02,380 --> 00:07:07,840
be the left in the next row because if

00:07:06,160 --> 00:07:10,030
you've seen this there are actually nine

00:07:07,840 --> 00:07:13,539
buttons on the row so if they couldn't

00:07:10,030 --> 00:07:16,300
use eight as a divider so they use 16

00:07:13,539 --> 00:07:18,130
and conveniently since we are talking

00:07:16,300 --> 00:07:23,919
about seven bit numbers they go from 0

00:07:18,130 --> 00:07:28,030
to 127 and 8 times 16 is 128 so it just

00:07:23,919 --> 00:07:32,159
matches up so that's how they chose that

00:07:28,030 --> 00:07:34,449
I guess so the last one is color and

00:07:32,159 --> 00:07:35,680
talked about briefly about colors on

00:07:34,449 --> 00:07:40,110
this thing because they are little bit

00:07:35,680 --> 00:07:44,139
special so first of all we can only have

00:07:40,110 --> 00:07:46,630
127 different colors originally right

00:07:44,139 --> 00:07:49,289
because we only have PC of 7 bit so

00:07:46,630 --> 00:07:51,490
that's a bummer if you want to do RGB

00:07:49,289 --> 00:07:54,099
LEDs because then you have to kind of

00:07:51,490 --> 00:07:56,229
narrow down the color space to get into

00:07:54,099 --> 00:07:58,690
that and I actually didn't look at how

00:07:56,229 --> 00:08:01,110
the larger launch pads do that but in

00:07:58,690 --> 00:08:05,830
this case since this is a chief Hardware

00:08:01,110 --> 00:08:08,380
it works a little bit different in that

00:08:05,830 --> 00:08:11,259
they are not RGB LEDs that can do the

00:08:08,380 --> 00:08:15,460
full color spectrum but they are red

00:08:11,259 --> 00:08:17,440
green LEDs and red and green LEDs are

00:08:15,460 --> 00:08:19,360
like one of the first types of LEDs

00:08:17,440 --> 00:08:21,159
invented they have really really cheap

00:08:19,360 --> 00:08:23,400
and you can get them in this specific

00:08:21,159 --> 00:08:26,409
combination red green LEDs are a thing

00:08:23,400 --> 00:08:28,360
so they're not two LEDs per button this

00:08:26,409 --> 00:08:30,220
is actually one but with combined

00:08:28,360 --> 00:08:34,330
circuitry for red and green

00:08:30,220 --> 00:08:36,669
and if you kind of modulate the

00:08:34,330 --> 00:08:38,800
intensity of red and green you get to

00:08:36,669 --> 00:08:40,780
something like this which is a weird

00:08:38,800 --> 00:08:44,110
spectrum between red and green and

00:08:40,780 --> 00:08:48,700
yellow and amber and orange somewhere in

00:08:44,110 --> 00:08:50,710
there but it's it's slightly problematic

00:08:48,700 --> 00:08:52,780
to use all the different colors

00:08:50,710 --> 00:08:55,090
especially ones that are close together

00:08:52,780 --> 00:08:56,860
if you want to kind of convey meaning

00:08:55,090 --> 00:08:59,050
because they are sometimes the

00:08:56,860 --> 00:09:00,450
calibration on the LEDs is a little bit

00:08:59,050 --> 00:09:03,880
off so you have to be careful with that

00:09:00,450 --> 00:09:06,100
I really like that phrase and in the

00:09:03,880 --> 00:09:09,010
documentation readers who are versed in

00:09:06,100 --> 00:09:15,160
the manipulation of binary will have

00:09:09,010 --> 00:09:19,960
worked out really like that phrase so

00:09:15,160 --> 00:09:22,660
how does input work well as you might

00:09:19,960 --> 00:09:27,550
think they just send note on the note

00:09:22,660 --> 00:09:30,610
offs and for in the web media API you

00:09:27,550 --> 00:09:32,710
would connect an event handler to the

00:09:30,610 --> 00:09:38,650
input ports I'm going to show you how

00:09:32,710 --> 00:09:40,660
that works later on and then the actual

00:09:38,650 --> 00:09:43,330
thing is like if you press a button you

00:09:40,660 --> 00:09:45,700
get a note on event and if you release a

00:09:43,330 --> 00:09:48,880
button you get a note of event which is

00:09:45,700 --> 00:09:51,550
not technically correct in the sense

00:09:48,880 --> 00:09:54,160
that you actually get a note off command

00:09:51,550 --> 00:09:55,690
but it is within the specs that you can

00:09:54,160 --> 00:09:57,670
just send a note on command with

00:09:55,690 --> 00:09:59,950
velocity zero because back in the days

00:09:57,670 --> 00:10:03,130
you know microcontrollers were very slow

00:09:59,950 --> 00:10:04,780
and so they thought well probably it's

00:10:03,130 --> 00:10:06,880
easier for them to do it that way and

00:10:04,780 --> 00:10:08,910
novation thought well this is a cheap

00:10:06,880 --> 00:10:12,640
microcontroller let's do it the same way

00:10:08,910 --> 00:10:15,820
so you just get these two signals and 24

00:10:12,640 --> 00:10:19,089
I think I checked it's like the last

00:10:15,820 --> 00:10:22,330
button on the second row I guess so

00:10:19,089 --> 00:10:24,250
let's talk about minesweeper and you all

00:10:22,330 --> 00:10:31,390
know who doesn't know what mines meat

00:10:24,250 --> 00:10:34,450
cleaver is okay that's good so there are

00:10:31,390 --> 00:10:37,480
a few UI challenges if you want to port

00:10:34,450 --> 00:10:39,760
this to a device like this this is the

00:10:37,480 --> 00:10:40,310
actual minesweeper version I'm using if

00:10:39,760 --> 00:10:42,200
you're

00:10:40,310 --> 00:10:44,960
you're familiar with minesweeper your

00:10:42,200 --> 00:10:47,000
you will notice that it's actually 8x8

00:10:44,960 --> 00:10:49,730
and I think the original minesweeper the

00:10:47,000 --> 00:10:51,529
small grid is 9 by 9 or something but

00:10:49,730 --> 00:10:55,610
for this case it's really good because

00:10:51,529 --> 00:10:58,310
we have 8x8 button and the first

00:10:55,610 --> 00:11:00,680
challenge is this because like I told

00:10:58,310 --> 00:11:02,210
you colors are really hard to

00:11:00,680 --> 00:11:05,660
distinguish so if I want to build

00:11:02,210 --> 00:11:08,930
something where you can actually check

00:11:05,660 --> 00:11:10,550
how many a adjacent of mines there are

00:11:08,930 --> 00:11:12,290
and it's really important to play

00:11:10,550 --> 00:11:14,000
minesweeper then I need to come up with

00:11:12,290 --> 00:11:15,620
a mechanism that works better than just

00:11:14,000 --> 00:11:19,130
displaying color so we'll come to that

00:11:15,620 --> 00:11:21,650
later the second challenge is yeah you

00:11:19,130 --> 00:11:23,690
have to flag fields for mine right and

00:11:21,650 --> 00:11:28,640
how do you normally do that in mine

00:11:23,690 --> 00:11:31,940
sweeper right click correct so there is

00:11:28,640 --> 00:11:36,140
no like there button how do I do a right

00:11:31,940 --> 00:11:38,390
click and so yeah I could use a key on

00:11:36,140 --> 00:11:41,089
the keyboard that's kind of stupid and

00:11:38,390 --> 00:11:43,820
my first approach was to simply use one

00:11:41,089 --> 00:11:45,980
of the extra buttons and make it so that

00:11:43,820 --> 00:11:48,500
I press it and then press the other

00:11:45,980 --> 00:11:50,270
thing what I turns out that it's a

00:11:48,500 --> 00:11:52,460
little bit the button is a little bit

00:11:50,270 --> 00:11:54,320
too unreliable for that to work and so

00:11:52,460 --> 00:11:55,820
more often than not I would press it and

00:11:54,320 --> 00:11:57,620
then hit it and then it would reveal the

00:11:55,820 --> 00:11:59,390
field and guess what there's a bomb

00:11:57,620 --> 00:12:01,820
underneath it or mine and then

00:11:59,390 --> 00:12:04,280
everything blows up and I was kind of

00:12:01,820 --> 00:12:06,220
kind of frustrated by that so I took

00:12:04,280 --> 00:12:09,620
another approach and just make it like

00:12:06,220 --> 00:12:15,800
different make it so like they are

00:12:09,620 --> 00:12:22,210
different different modes so yeah let's

00:12:15,800 --> 00:12:22,210
go this will be

00:12:26,260 --> 00:12:32,240
for we need to realign this a little bit

00:12:29,330 --> 00:12:35,660
so you can see it so I do have a camera

00:12:32,240 --> 00:12:44,180
here for later on let's start with this

00:12:35,660 --> 00:12:46,460
is way too small this good so let's

00:12:44,180 --> 00:12:48,290
start with the very basics of how you

00:12:46,460 --> 00:12:50,600
would start interacting with the web

00:12:48,290 --> 00:12:53,210
media API by the way I didn't talk about

00:12:50,600 --> 00:12:56,630
this web media API currently only works

00:12:53,210 --> 00:12:59,120
in chromium browsers there is a team

00:12:56,630 --> 00:13:01,970
working at the at Mozilla to implement

00:12:59,120 --> 00:13:05,540
it I have no idea what Apple is doing

00:13:01,970 --> 00:13:11,990
and I know signals from Microsoft

00:13:05,540 --> 00:13:14,290
yet I think and so yeah we're working

00:13:11,990 --> 00:13:16,760
for the Firefox thing but the chromium

00:13:14,290 --> 00:13:19,970
interestingly enough also works on

00:13:16,760 --> 00:13:21,230
Android devices so you can plug if you

00:13:19,970 --> 00:13:23,210
have an Android device where you can

00:13:21,230 --> 00:13:24,830
actually plug use II devices into it

00:13:23,210 --> 00:13:27,700
that actually works with the launchpad

00:13:24,830 --> 00:13:31,910
as well kind of cool

00:13:27,700 --> 00:13:34,160
so the init MIDI function at this point

00:13:31,910 --> 00:13:36,410
is only called in an onload handler and

00:13:34,160 --> 00:13:40,160
then you do navigate a request MIDI

00:13:36,410 --> 00:13:48,980
access and it's modern API so it uses

00:13:40,160 --> 00:13:52,610
promises as promising a kibosh yeah it

00:13:48,980 --> 00:13:54,830
was issues with keyShot so and then you

00:13:52,610 --> 00:13:57,890
would you need to find your media

00:13:54,830 --> 00:14:00,050
devices they are just enumerated and

00:13:57,890 --> 00:14:02,120
some sort of array it's not a real array

00:14:00,050 --> 00:14:04,130
as usual when you're dealing with arrays

00:14:02,120 --> 00:14:06,050
from internal API so some reason they

00:14:04,130 --> 00:14:08,900
always come up with new ways of

00:14:06,050 --> 00:14:11,090
disguising errors or something else and

00:14:08,900 --> 00:14:12,320
you would do a for each on it and then

00:14:11,090 --> 00:14:14,210
you can check the name and that's

00:14:12,320 --> 00:14:16,700
basically the only way how you can

00:14:14,210 --> 00:14:18,920
distinguish devices so this one goes for

00:14:16,700 --> 00:14:20,570
Launchpad mini if you have another

00:14:18,920 --> 00:14:22,100
Launchpad you would probably and you

00:14:20,570 --> 00:14:23,180
want to use both you would probably do

00:14:22,100 --> 00:14:26,990
some sort of regex

00:14:23,180 --> 00:14:29,060
on that which is something for example

00:14:26,990 --> 00:14:32,630
we also do for the device I'm working

00:14:29,060 --> 00:14:34,590
with in my Novation project because

00:14:32,630 --> 00:14:37,350
sometimes also

00:14:34,590 --> 00:14:39,180
windows tend to kind of enumerate them

00:14:37,350 --> 00:14:41,190
and say okay launchpad mini one

00:14:39,180 --> 00:14:43,770
launchpad menu - even if there's only

00:14:41,190 --> 00:14:47,940
one connected and you have to deal with

00:14:43,770 --> 00:14:51,390
that and I'm gonna you know I'm going to

00:14:47,940 --> 00:14:54,270
show you the the minesweeper stuff in a

00:14:51,390 --> 00:14:56,370
second but what you notice here is I'm

00:14:54,270 --> 00:14:58,050
just using global variables because

00:14:56,370 --> 00:15:00,150
that's the coding style used in the

00:14:58,050 --> 00:15:03,000
original minesweeper implementation

00:15:00,150 --> 00:15:05,400
that's obviously not how you would want

00:15:03,000 --> 00:15:08,490
to do that but for short demo like this

00:15:05,400 --> 00:15:14,190
this is okay so I'm detecting inputs and

00:15:08,490 --> 00:15:18,660
outputs set variables and then yeah I

00:15:14,190 --> 00:15:23,490
need to in at the display so let's do

00:15:18,660 --> 00:15:29,850
that the function is not here so let's

00:15:23,490 --> 00:15:33,240
get that like I said copy and paste

00:15:29,850 --> 00:15:34,710
there you go and what this does is it

00:15:33,240 --> 00:15:38,970
sets a few messages that are also

00:15:34,710 --> 00:15:43,560
documented in in the documentation so it

00:15:38,970 --> 00:15:45,600
sends out a reset be 0 is 176 by the way

00:15:43,560 --> 00:15:50,730
that's a control change another type of

00:15:45,600 --> 00:15:53,040
message and then I use something to to

00:15:50,730 --> 00:15:54,750
make this LED blink which is a special

00:15:53,040 --> 00:15:58,710
mode a flashing mode that you have to

00:15:54,750 --> 00:16:03,030
activate and then I just send to note on

00:15:58,710 --> 00:16:04,830
messages to to set these to led to these

00:16:03,030 --> 00:16:05,660
two LEDs so that you know that I have a

00:16:04,830 --> 00:16:09,090
special meaning

00:16:05,660 --> 00:16:14,700
let me check I think I need to change

00:16:09,090 --> 00:16:16,560
this no okay so this is how the H how

00:16:14,700 --> 00:16:20,690
the how the webpage currently works and

00:16:16,560 --> 00:16:25,740
you can actually can play that Wow

00:16:20,690 --> 00:16:30,150
that's raw but nothing happens right now

00:16:25,740 --> 00:16:32,450
on the launchpad so let's go forward so

00:16:30,150 --> 00:16:36,240
we entered the display that's fine but

00:16:32,450 --> 00:16:37,300
actually it should be blank is not

00:16:36,240 --> 00:16:55,790
happening

00:16:37,300 --> 00:16:59,470
that's interesting wrong here no all

00:16:55,790 --> 00:17:02,269
right right because obviously this is

00:16:59,470 --> 00:17:04,699
this is not mean you sent note on that's

00:17:02,269 --> 00:17:07,280
not fine as well let's get that quickly

00:17:04,699 --> 00:17:09,620
it's really really simple it's just a

00:17:07,280 --> 00:17:15,230
convenient function all the checks if

00:17:09,620 --> 00:17:19,730
the media is available that work now no

00:17:15,230 --> 00:17:21,829
it doesn't what does it give it okay if

00:17:19,730 --> 00:17:27,199
this goes on like this again I'm going

00:17:21,829 --> 00:17:32,570
to fall back to the full version might

00:17:27,199 --> 00:17:36,980
be worth checking might be worth oh yeah

00:17:32,570 --> 00:17:39,220
I know you're right guess I try to hack

00:17:36,980 --> 00:17:41,690
it in a way that I didn't have to like

00:17:39,220 --> 00:17:46,299
monkey patch the original implementation

00:17:41,690 --> 00:17:51,040
so ah there you go

00:17:46,299 --> 00:17:53,470
blank this way wonderful where yeah

00:17:51,040 --> 00:17:58,549
where does the shadows come from

00:17:53,470 --> 00:18:01,100
interesting okay anyway so we have that

00:17:58,549 --> 00:18:04,610
and then let in the next step let's add

00:18:01,100 --> 00:18:06,290
the the input handler here so that's how

00:18:04,610 --> 00:18:09,500
you you know you know add eventlistener

00:18:06,290 --> 00:18:12,140
that's pretty standard stuff so we just

00:18:09,500 --> 00:18:19,940
need the media input handler let's get

00:18:12,140 --> 00:18:25,370
that over this one and there you can see

00:18:19,940 --> 00:18:28,130
like how this stuff sort of work so you

00:18:25,370 --> 00:18:30,409
get a data part in the event and it it

00:18:28,130 --> 00:18:33,620
just contains an array it's a type area

00:18:30,409 --> 00:18:36,080
of you in eight that will just contain

00:18:33,620 --> 00:18:38,059
the the data sent over and so I'm just

00:18:36,080 --> 00:18:41,090
ignoring everything that is not a node

00:18:38,059 --> 00:18:43,190
on here I try to figure out the row and

00:18:41,090 --> 00:18:46,610
column of the button that gets pressed

00:18:43,190 --> 00:18:50,510
and then I have two two handlers

00:18:46,610 --> 00:18:53,120
and the important one is the note unhand

00:18:50,510 --> 00:18:56,200
ler and that one going to copy over

00:18:53,120 --> 00:18:59,240
that's a little bit more complicated

00:18:56,200 --> 00:19:01,250
because it does a lot of different

00:18:59,240 --> 00:19:07,130
things but one thing it does and that

00:19:01,250 --> 00:19:11,390
like where functionality goes in is this

00:19:07,130 --> 00:19:12,920
part so they are there's a click square

00:19:11,390 --> 00:19:14,900
function in the original like the

00:19:12,920 --> 00:19:20,530
original looked like this is really

00:19:14,900 --> 00:19:26,120
old-school JavaScript and there's a

00:19:20,530 --> 00:19:27,800
proper where is it like this is the full

00:19:26,120 --> 00:19:30,260
minesweeper implementation and there's a

00:19:27,800 --> 00:19:32,720
click square thing that's just an event

00:19:30,260 --> 00:19:36,020
handler that's on every element on on

00:19:32,720 --> 00:19:40,280
the webpage and I'm just calling that

00:19:36,020 --> 00:19:44,810
from from my function to be able to not

00:19:40,280 --> 00:19:48,380
or to to not having to monkey patch the

00:19:44,810 --> 00:19:49,790
other software and so basically I'm

00:19:48,380 --> 00:19:53,920
clicking the square so this should this

00:19:49,790 --> 00:20:01,580
should now actually work I think did I

00:19:53,920 --> 00:20:04,100
yeah so let's load this again and now so

00:20:01,580 --> 00:20:05,600
you see that I hit the button nothing is

00:20:04,100 --> 00:20:07,790
displayed because we didn't handle that

00:20:05,600 --> 00:20:14,300
yet but you can see that I can already

00:20:07,790 --> 00:20:20,270
expose phew so that's cool and you know

00:20:14,300 --> 00:20:22,820
all I all I do here is I take the the

00:20:20,270 --> 00:20:25,280
row and column and then I though the way

00:20:22,820 --> 00:20:30,640
the original game handles the internal

00:20:25,280 --> 00:20:33,410
data is just using 64 length arrays and

00:20:30,640 --> 00:20:35,720
you know basically every row eight eight

00:20:33,410 --> 00:20:38,540
bytes of that or eight pieces of that

00:20:35,720 --> 00:20:42,140
and so to get the actual position you

00:20:38,540 --> 00:20:46,640
just take the row multiply it by 8 and

00:20:42,140 --> 00:20:49,360
then at the column oh and the important

00:20:46,640 --> 00:20:51,800
part is this one this is a normal click

00:20:49,360 --> 00:20:56,150
exactly and send

00:20:51,800 --> 00:20:57,980
let's try to get this play on and set

00:20:56,150 --> 00:21:01,940
that's a little bit more complicated

00:20:57,980 --> 00:21:05,090
because again I didn't want to I didn't

00:21:01,940 --> 00:21:06,620
want to really patch around and the

00:21:05,090 --> 00:21:09,170
other thing and I did a very stupid

00:21:06,620 --> 00:21:11,990
thing which is just overwrite it

00:21:09,170 --> 00:21:15,500
override the function it's pointless

00:21:11,990 --> 00:21:18,410
probably and that's basically the

00:21:15,500 --> 00:21:21,580
longest function it's a little bit hard

00:21:18,410 --> 00:21:24,320
to go through that but we're trying it

00:21:21,580 --> 00:21:26,780
basically mirrors the original set

00:21:24,320 --> 00:21:28,790
square function and instead of setting

00:21:26,780 --> 00:21:32,330
classes and changing the contents of

00:21:28,790 --> 00:21:36,340
cells it sends MIDI notes and if I do

00:21:32,330 --> 00:21:45,110
that actually nothing happens

00:21:36,340 --> 00:21:47,360
yay why is that that is a bummer okay

00:21:45,110 --> 00:21:50,890
that's a help function I wrote that

00:21:47,360 --> 00:21:50,890
needs to go in this well Oh

00:21:56,650 --> 00:22:04,380
so that's just you know going from the

00:22:04,890 --> 00:22:13,030
yeah exactly so this is I showed you the

00:22:10,930 --> 00:22:15,730
documentation and I just try to figure

00:22:13,030 --> 00:22:18,400
out some some color values that make

00:22:15,730 --> 00:22:20,980
sense and I'm just using the just adding

00:22:18,400 --> 00:22:23,010
the velocity value so I need to put that

00:22:20,980 --> 00:22:25,840
in here as well

00:22:23,010 --> 00:22:29,140
there you have it

00:22:25,840 --> 00:22:32,650
and you can already see like the yellow

00:22:29,140 --> 00:22:34,780
tone something may have to do with the

00:22:32,650 --> 00:22:36,309
lighting in this room but they they kind

00:22:34,780 --> 00:22:38,260
of look all different even though I'm

00:22:36,309 --> 00:22:41,080
sending the same value to all field so

00:22:38,260 --> 00:22:42,990
that that's kind of a bummer but yeah

00:22:41,080 --> 00:22:46,179
great

00:22:42,990 --> 00:22:50,140
but you can now start playing the game

00:22:46,179 --> 00:22:53,380
which is kind of fun but for example

00:22:50,140 --> 00:22:55,870
what we didn't handle did we know what

00:22:53,380 --> 00:23:01,270
we didn't handle yet is flagging for

00:22:55,870 --> 00:23:02,190
example that was obvious so let's do

00:23:01,270 --> 00:23:07,360
that

00:23:02,190 --> 00:23:09,490
where was I so like I mean this is

00:23:07,360 --> 00:23:11,320
looking at this this doesn't even make

00:23:09,490 --> 00:23:15,700
sense if you don't know what the

00:23:11,320 --> 00:23:18,340
original code does but you have you have

00:23:15,700 --> 00:23:20,050
an array which gives you the exposed

00:23:18,340 --> 00:23:22,590
elements and then there's another array

00:23:20,050 --> 00:23:27,700
which gives you the adjacent values and

00:23:22,590 --> 00:23:28,900
you basically go through all the go you

00:23:27,700 --> 00:23:32,140
basically go through all the

00:23:28,900 --> 00:23:43,059
possibilities and then set the right

00:23:32,140 --> 00:23:45,640
color so exactly so in this case here

00:23:43,059 --> 00:23:48,340
I'm checking on the note on handler I'm

00:23:45,640 --> 00:23:50,800
checking that the column I'm the button

00:23:48,340 --> 00:23:54,280
was pressed on it's smaller than eight

00:23:50,800 --> 00:23:56,260
because the the 8th column is like my

00:23:54,280 --> 00:23:59,270
command column and so I have this this

00:23:56,260 --> 00:24:03,020
other thing here

00:23:59,270 --> 00:24:05,899
and if it's row six that's the that's

00:24:03,020 --> 00:24:09,620
the Jeep why you don't see the they're

00:24:05,899 --> 00:24:11,480
actually letters makes it the yellow one

00:24:09,620 --> 00:24:15,980
this place if you resist the the playing

00:24:11,480 --> 00:24:17,539
field and click smiley was like that's a

00:24:15,980 --> 00:24:20,210
bit weird but that's how the original

00:24:17,539 --> 00:24:21,620
game works for as well right and that's

00:24:20,210 --> 00:24:24,169
a function in the original

00:24:21,620 --> 00:24:27,140
implementation so the other one is road

00:24:24,169 --> 00:24:31,640
seven I'm just toggling the flag mode

00:24:27,140 --> 00:24:34,580
and then sending a note to it so that

00:24:31,640 --> 00:24:38,210
that you actually see this blinking

00:24:34,580 --> 00:24:41,450
right so I can toggle flag mode

00:24:38,210 --> 00:24:44,929
oh come on give me something to work

00:24:41,450 --> 00:24:47,600
with you and I can now switch this on

00:24:44,929 --> 00:24:50,240
and flag it switch it off again and play

00:24:47,600 --> 00:24:55,730
on so that's pretty obviously you're

00:24:50,240 --> 00:24:59,120
mine you agree so that works and now

00:24:55,730 --> 00:25:01,100
let's do the last thing which is a way

00:24:59,120 --> 00:25:03,440
to show how many adjacent buttons are

00:25:01,100 --> 00:25:11,480
there and that that's that's the fun

00:25:03,440 --> 00:25:14,960
part these are just two functions going

00:25:11,480 --> 00:25:20,059
to copy over as well and what this does

00:25:14,960 --> 00:25:22,250
is it sends control changes because for

00:25:20,059 --> 00:25:24,679
some reason the row on the top here is

00:25:22,250 --> 00:25:28,279
switch on and off by control changes and

00:25:24,679 --> 00:25:29,809
I'm just going through the adjacent the

00:25:28,279 --> 00:25:34,130
number of adjacent fields here and

00:25:29,809 --> 00:25:36,080
switch on the top row so that if you hit

00:25:34,130 --> 00:25:40,880
the button you can actually see how many

00:25:36,080 --> 00:25:43,100
mines are adjacent to it so of course on

00:25:40,880 --> 00:25:47,230
YouTube and you know just a function to

00:25:43,100 --> 00:25:47,230
to deactivate that display as well

00:25:48,160 --> 00:26:00,430
but that one and then there's where's

00:25:51,550 --> 00:26:03,090
the off handler I didn't include that so

00:26:00,430 --> 00:26:05,880
now you know my code better than me

00:26:03,090 --> 00:26:11,590
maybe ah come on

00:26:05,880 --> 00:26:15,070
yeah exactly let's include that one well

00:26:11,590 --> 00:26:21,040
somewhere to pull it in there is totally

00:26:15,070 --> 00:26:23,470
irrelevant and then I need to then I

00:26:21,040 --> 00:26:27,670
need to activate it here and now you now

00:26:23,470 --> 00:26:29,410
it's basically done if I for example hit

00:26:27,670 --> 00:26:32,650
this button you see that there's only

00:26:29,410 --> 00:26:35,770
one mine so I can flag this one and

00:26:32,650 --> 00:26:38,380
since this is also one I can also flag

00:26:35,770 --> 00:26:42,220
this one this is also one you know how

00:26:38,380 --> 00:26:46,150
to play minesweeper right and one thing

00:26:42,220 --> 00:26:52,090
like how late is it are we almost done

00:26:46,150 --> 00:26:55,120
okay so these are now about 160 lines of

00:26:52,090 --> 00:26:57,040
code of relatively well relatively well

00:26:55,120 --> 00:27:00,400
commented code I'm pretty sure I could

00:26:57,040 --> 00:27:02,280
write it in a more compact fashion but

00:27:00,400 --> 00:27:10,860
then you wouldn't understand the thing

00:27:02,280 --> 00:27:10,860
it's actually online at pad no offside

00:27:11,400 --> 00:27:17,370
yes

00:27:13,800 --> 00:27:18,330
pants we birthday it is so if you have a

00:27:17,370 --> 00:27:20,820
launchpad

00:27:18,330 --> 00:27:22,650
she probably haven't you can actually

00:27:20,820 --> 00:27:26,790
play it there but you can actually also

00:27:22,650 --> 00:27:29,340
just play some screen credits to who

00:27:26,790 --> 00:27:32,540
Andrew the barrel who wrote the original

00:27:29,340 --> 00:27:38,370
implementation probably in I don't know

00:27:32,540 --> 00:27:40,980
1995 or something and it was for me it

00:27:38,370 --> 00:27:42,720
was really fun to just try to figure out

00:27:40,980 --> 00:27:44,910
how to hack this in there without

00:27:42,720 --> 00:27:50,250
actually without actually touching the

00:27:44,910 --> 00:27:53,160
ill code and as you can see it's

00:27:50,250 --> 00:27:55,500
relatively simple to just you know send

00:27:53,160 --> 00:27:57,950
me data over here and now I'm going to

00:27:55,500 --> 00:28:00,200
show you one last thing and that is the

00:27:57,950 --> 00:28:04,530
implementation from this morning

00:28:00,200 --> 00:28:07,200
which is just an array and I know it's

00:28:04,530 --> 00:28:10,230
hard to see but this is the J and this

00:28:07,200 --> 00:28:15,420
is the s and then I'm just sending out

00:28:10,230 --> 00:28:18,080
you know I'm just activating the output

00:28:15,420 --> 00:28:20,820
and then I'm just sending out this array

00:28:18,080 --> 00:28:25,820
very very simply by copying over some

00:28:20,820 --> 00:28:25,820
code and if I activate that

00:28:29,510 --> 00:28:40,880
you get the logo so so what can we do

00:28:38,540 --> 00:28:43,370
with that apart from playing minesweeper

00:28:40,880 --> 00:28:44,780
and I'm going to sit outside if you want

00:28:43,370 --> 00:28:46,430
to play it on the launch pad I think

00:28:44,780 --> 00:28:50,540
it's a pretty cool experience just come

00:28:46,430 --> 00:28:54,110
over and hit me up on that if you want

00:28:50,540 --> 00:28:56,390
to like what can we do with that one

00:28:54,110 --> 00:28:59,150
thing that I find pretty cool is that

00:28:56,390 --> 00:29:01,580
Adam my editor is actually building on

00:28:59,150 --> 00:29:05,870
chromium and I think the web media API

00:29:01,580 --> 00:29:07,700
works there so what about using this for

00:29:05,870 --> 00:29:13,480
some additional keyboard shortcuts I

00:29:07,700 --> 00:29:16,190
mean there are 64 plus 16 on these or

00:29:13,480 --> 00:29:18,080
display test results from your unit test

00:29:16,190 --> 00:29:20,300
runs or something and then you can just

00:29:18,080 --> 00:29:22,910
hit a red button and go to the file and

00:29:20,300 --> 00:29:25,010
position of where the error is stuff

00:29:22,910 --> 00:29:27,290
like that it doesn't make a lot of sense

00:29:25,010 --> 00:29:30,800
but it's actually pretty fun to play

00:29:27,290 --> 00:29:32,630
with and MIDI communications is so fast

00:29:30,800 --> 00:29:36,040
that it doesn't even matter if you I

00:29:32,630 --> 00:29:38,890
mean Adams already not so fast but

00:29:36,040 --> 00:29:41,150
probably that doesn't matter as much so

00:29:38,890 --> 00:29:43,670
thank you very much for listening if you

00:29:41,150 --> 00:29:45,970
have any questions like I said I'll be

00:29:43,670 --> 00:29:54,920
sitting outside thank

00:29:45,970 --> 00:29:54,920

YouTube URL: https://www.youtube.com/watch?v=pDPVDVzXTYE


