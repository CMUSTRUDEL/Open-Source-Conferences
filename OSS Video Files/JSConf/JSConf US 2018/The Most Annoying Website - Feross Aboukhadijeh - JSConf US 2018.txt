Title: The Most Annoying Website - Feross Aboukhadijeh - JSConf US 2018
Publication date: 2018-10-31
Playlist: JSConf US 2018
Description: 
	aka "The Power of the Web Platform"
Captions: 
	00:00:00,320 --> 00:00:03,840
[Music]

00:00:02,070 --> 00:00:05,660
[Applause]

00:00:03,840 --> 00:00:07,410
[Music]

00:00:05,660 --> 00:00:09,280
[Applause]

00:00:07,410 --> 00:00:11,020
[Music]

00:00:09,280 --> 00:00:12,780
[Applause]

00:00:11,020 --> 00:00:15,920
[Music]

00:00:12,780 --> 00:00:15,920
[Applause]

00:00:16,870 --> 00:00:24,050
[Music]

00:00:24,419 --> 00:00:31,239
thank you Sam welcome to my talk The

00:00:28,719 --> 00:00:35,440
Annoying site also known as the power of

00:00:31,239 --> 00:00:37,930
the web platform so my name is Feroz I

00:00:35,440 --> 00:00:41,110
work on web torrent which is a torrent

00:00:37,930 --> 00:00:42,879
library for the web and I also built web

00:00:41,110 --> 00:00:45,790
torrent desktop which is an electron app

00:00:42,879 --> 00:00:47,920
built with some friends and it was one

00:00:45,790 --> 00:00:50,470
of the first electron apps and it just

00:00:47,920 --> 00:00:52,989
recently passed 1.5 million total

00:00:50,470 --> 00:00:54,730
downloads which is pretty cool and

00:00:52,989 --> 00:00:56,890
standard yes as well so javascript

00:00:54,730 --> 00:00:58,540
linter that catches programmer errors

00:00:56,890 --> 00:01:00,850
and the forces consists of code style in

00:00:58,540 --> 00:01:02,920
your projects and it's also good at

00:01:00,850 --> 00:01:05,710
angering people which is just good fun

00:01:02,920 --> 00:01:08,259
sometimes and if they're doing open

00:01:05,710 --> 00:01:10,509
source since 2014 full-time since 2015

00:01:08,259 --> 00:01:13,210
and you probably use some of my NPM

00:01:10,509 --> 00:01:15,040
packages and my open source work is

00:01:13,210 --> 00:01:17,049
supported by many generous patreon

00:01:15,040 --> 00:01:20,890
donors at the moment so thank you to all

00:01:17,049 --> 00:01:21,880
of those people I just wanted to give a

00:01:20,890 --> 00:01:23,200
quick shout out to my most recent

00:01:21,880 --> 00:01:25,240
project that I've been working on called

00:01:23,200 --> 00:01:26,530
bit MIDI if you follow me on Twitter

00:01:25,240 --> 00:01:29,290
you've probably seen me tweeting about

00:01:26,530 --> 00:01:31,630
it so it's like a wayback machine for

00:01:29,290 --> 00:01:33,130
MIDI files how many people here know

00:01:31,630 --> 00:01:36,400
what a MIDI file is raise your hand okay

00:01:33,130 --> 00:01:37,420
cool so alright cool so it's it's used

00:01:36,400 --> 00:01:40,299
by a lot of people in the music industry

00:01:37,420 --> 00:01:42,340
but my first exposure to it was in like

00:01:40,299 --> 00:01:44,920
my first days of browsing the web it was

00:01:42,340 --> 00:01:46,450
often used with the BG sound HTML tag

00:01:44,920 --> 00:01:47,650
for playing audio in the background

00:01:46,450 --> 00:01:49,960
automatically when you land on a web

00:01:47,650 --> 00:01:52,479
page the good old days back when the web

00:01:49,960 --> 00:01:54,189
was fun and quirky and so anyway I

00:01:52,479 --> 00:01:57,070
wanted to play some of those I looked

00:01:54,189 --> 00:01:58,780
online for basically a collection of zip

00:01:57,070 --> 00:02:00,310
file as it filed full of Middies and I

00:01:58,780 --> 00:02:02,229
couldn't play it back in any program so

00:02:00,310 --> 00:02:05,590
I thought it would be fun to use web

00:02:02,229 --> 00:02:07,780
assembly to take a mini player in C and

00:02:05,590 --> 00:02:09,159
make it work on the web and then host

00:02:07,780 --> 00:02:10,450
all these MIDI files and so that's what

00:02:09,159 --> 00:02:12,700
it is you can go there and you can play

00:02:10,450 --> 00:02:14,379
around with it it's been good fun it

00:02:12,700 --> 00:02:15,549
also gets a perfect Lighthouse score in

00:02:14,379 --> 00:02:17,409
Chrome Canary which I'm really proud of

00:02:15,549 --> 00:02:19,930
so it's really lightweight really fast

00:02:17,409 --> 00:02:23,020
and works on mobile and it's great okay

00:02:19,930 --> 00:02:25,120
so it's story time I've been getting a

00:02:23,020 --> 00:02:25,480
lot of weird spam in my inbox lately

00:02:25,120 --> 00:02:27,480
here's one

00:02:25,480 --> 00:02:34,090
the emails you can see on the projector

00:02:27,480 --> 00:02:35,980
so yeah stock manufacturers from Zi

00:02:34,090 --> 00:02:39,159
Jiang China are trying to sell me what

00:02:35,980 --> 00:02:42,010
they call sublimation socks which I

00:02:39,159 --> 00:02:43,450
think there's been printed socks and I

00:02:42,010 --> 00:02:44,980
don't know it's been waste so much of my

00:02:43,450 --> 00:02:46,390
time and it always ends up in my inbox

00:02:44,980 --> 00:02:48,519
for some reason it doesn't get filtered

00:02:46,390 --> 00:02:50,440
out properly so I was thinking is there

00:02:48,519 --> 00:02:53,650
some way that I could waste the spammers

00:02:50,440 --> 00:02:55,540
time in return how many of you felt that

00:02:53,650 --> 00:02:57,730
before like you know some people they

00:02:55,540 --> 00:02:59,590
respond to the spam emails themselves

00:02:57,730 --> 00:03:02,019
you know and try to lure the spammers

00:02:59,590 --> 00:03:03,910
into like a lengthy conversation and at

00:03:02,019 --> 00:03:05,650
the end they like say surprise I'm not

00:03:03,910 --> 00:03:06,700
gonna fall for what you did but the

00:03:05,650 --> 00:03:08,530
thing is like that way it would waste a

00:03:06,700 --> 00:03:12,609
lot of my time as well so I'm not going

00:03:08,530 --> 00:03:14,500
to do that so I was wondering what if

00:03:12,609 --> 00:03:17,260
there was some way that I could just

00:03:14,500 --> 00:03:20,049
send a link to this spammer and to all

00:03:17,260 --> 00:03:24,640
future spammers and teach them a lesson

00:03:20,049 --> 00:03:26,739
you know waste their time in return so

00:03:24,640 --> 00:03:29,709
in the good old days browsing the web

00:03:26,739 --> 00:03:32,040
was more dangerous if you visited a web

00:03:29,709 --> 00:03:36,519
page anything could happen

00:03:32,040 --> 00:03:39,099
so this is an infamous trick on the

00:03:36,519 --> 00:03:41,349
early web it was often known as the

00:03:39,099 --> 00:03:42,370
infinite alert loop raise your hand if

00:03:41,349 --> 00:03:45,040
you've been caught in one of these

00:03:42,370 --> 00:03:46,299
before okay oh my gosh

00:03:45,040 --> 00:03:48,760
way more people than I would have

00:03:46,299 --> 00:03:50,590
guessed in the past so in the past when

00:03:48,760 --> 00:03:53,980
this actually worked the only way to

00:03:50,590 --> 00:03:56,380
escape from this infinite alert loop was

00:03:53,980 --> 00:03:58,030
to force quit your web browser which

00:03:56,380 --> 00:04:00,430
would cause you to lose any unsaved work

00:03:58,030 --> 00:04:03,099
and that included all of the unsubmitted

00:04:00,430 --> 00:04:06,239
forms that you had in your browser and

00:04:03,099 --> 00:04:09,280
so modern browsers are unfortunately

00:04:06,239 --> 00:04:10,810
multi-process and so alert doesn't block

00:04:09,280 --> 00:04:13,419
the browser process anymore which means

00:04:10,810 --> 00:04:18,910
that you can just ex out the tab if it

00:04:13,419 --> 00:04:20,320
opens up an alert so I open up issues on

00:04:18,910 --> 00:04:21,729
all the major browsers explaining to

00:04:20,320 --> 00:04:25,240
them that this broke an important use

00:04:21,729 --> 00:04:26,650
case for me but for some reason they

00:04:25,240 --> 00:04:33,130
closed all my issues immediately as

00:04:26,650 --> 00:04:34,900
won't fix this is a good xkcd about you

00:04:33,130 --> 00:04:37,289
know strange workflows in these cases

00:04:34,900 --> 00:04:37,289
that I like

00:04:38,830 --> 00:04:44,750
so in the good old days we had Internet

00:04:41,450 --> 00:04:46,280
Explorer we had ActiveX so as I

00:04:44,750 --> 00:04:48,260
mentioned visiting a web page had real

00:04:46,280 --> 00:04:50,000
risk associated with it you have to

00:04:48,260 --> 00:04:51,770
watch out for danger click on a fake

00:04:50,000 --> 00:04:54,020
media player and an ActiveX control

00:04:51,770 --> 00:04:55,460
would run and it was game over so this

00:04:54,020 --> 00:04:57,290
actually is not a real media player this

00:04:55,460 --> 00:04:58,820
is actually with a thing where with one

00:04:57,290 --> 00:05:03,770
click you start running native code on

00:04:58,820 --> 00:05:05,690
your computer obvious right so if only

00:05:03,770 --> 00:05:07,340
ActiveX still ran automatically I could

00:05:05,690 --> 00:05:14,600
build a really annoying website to send

00:05:07,340 --> 00:05:16,370
to this spammer so I think of the web as

00:05:14,600 --> 00:05:17,870
evolving through three distinct phases

00:05:16,370 --> 00:05:19,460
so there was the early days when the web

00:05:17,870 --> 00:05:20,570
was really the Wild West you could do

00:05:19,460 --> 00:05:22,880
infinite alert loops he could run

00:05:20,570 --> 00:05:24,230
ActiveX and then we we sort of grew up a

00:05:22,880 --> 00:05:26,240
little bit we realized security is

00:05:24,230 --> 00:05:29,720
important people started using Firefox

00:05:26,240 --> 00:05:31,670
Chrome was released in 2008 so the 2000s

00:05:29,720 --> 00:05:33,170
were sort of focused on reining back

00:05:31,670 --> 00:05:34,880
what the web could do and sort of saying

00:05:33,170 --> 00:05:36,020
okay look look let's just really sandbox

00:05:34,880 --> 00:05:37,370
the heck out of this thing and make it

00:05:36,020 --> 00:05:39,380
really limited and make it just display

00:05:37,370 --> 00:05:41,030
documents and not own your computer when

00:05:39,380 --> 00:05:42,770
you visit a website but now I think

00:05:41,030 --> 00:05:44,630
we're going into this third phase which

00:05:42,770 --> 00:05:45,830
is we need powerful features in the web

00:05:44,630 --> 00:05:47,540
we need the web to be able to compete

00:05:45,830 --> 00:05:49,310
with mobile mobile apps we need

00:05:47,540 --> 00:05:51,710
basically as much functionality as

00:05:49,310 --> 00:05:52,790
possible to move into the browser so

00:05:51,710 --> 00:05:54,710
that I don't need to make a native app

00:05:52,790 --> 00:05:55,940
and there are still exceptions to this

00:05:54,710 --> 00:05:57,200
where you do need a native app and this

00:05:55,940 --> 00:05:59,120
is where you see people often reaching

00:05:57,200 --> 00:06:00,830
for electron where you know they have a

00:05:59,120 --> 00:06:02,390
website that can do 95% of what they

00:06:00,830 --> 00:06:05,960
need but there's like one thing you know

00:06:02,390 --> 00:06:07,010
I want to be able to do you know have

00:06:05,960 --> 00:06:08,150
something running in the background in

00:06:07,010 --> 00:06:09,290
the tray or whatever and you know

00:06:08,150 --> 00:06:11,180
there's these few use cases where the

00:06:09,290 --> 00:06:12,560
web still can't can't support it but

00:06:11,180 --> 00:06:13,610
basically you know you can do almost

00:06:12,560 --> 00:06:15,170
everything you need in the web today

00:06:13,610 --> 00:06:19,250
which is great we have a lot of powerful

00:06:15,170 --> 00:06:21,950
features so a good news for me annoying

00:06:19,250 --> 00:06:23,330
website I went to you know I'm glad I'm

00:06:21,950 --> 00:06:25,730
glad that the web platform has become

00:06:23,330 --> 00:06:27,650
really powerful we have all these new

00:06:25,730 --> 00:06:29,270
api's that have been added back to the

00:06:27,650 --> 00:06:31,460
web and we can do things like

00:06:29,270 --> 00:06:34,820
serviceworker web audio web payments

00:06:31,460 --> 00:06:37,340
push notifications web assembly WebGL

00:06:34,820 --> 00:06:38,930
WebRTC Web VR and you know all these are

00:06:37,340 --> 00:06:40,670
fun to play with and all these have

00:06:38,930 --> 00:06:42,260
delightful edge cases that the browser

00:06:40,670 --> 00:06:43,490
vendors didn't think about when making

00:06:42,260 --> 00:06:46,120
them and we're gonna have a lot of fun

00:06:43,490 --> 00:06:47,950
with that today

00:06:46,120 --> 00:06:49,240
the web also has a lot of ancient api's

00:06:47,950 --> 00:06:50,740
that can't be removed for backwards

00:06:49,240 --> 00:06:52,600
compatibility reasons and some of these

00:06:50,740 --> 00:06:54,120
api's are so old that I'm sure that many

00:06:52,600 --> 00:06:57,760
of you have never heard of them and

00:06:54,120 --> 00:06:59,170
they're they're sort of just sitting

00:06:57,760 --> 00:07:00,520
there nicely in the browser waiting to

00:06:59,170 --> 00:07:02,830
be discovered waiting to be used

00:07:00,520 --> 00:07:04,480
in the various ways so I decided to take

00:07:02,830 --> 00:07:05,800
a look at each one of these api's one at

00:07:04,480 --> 00:07:10,090
a time and try to do the worst possible

00:07:05,800 --> 00:07:12,160
thing with them I like this quote by

00:07:10,090 --> 00:07:13,870
Paul Boucher it's every system has two

00:07:12,160 --> 00:07:16,180
sets of rules the rules as they are

00:07:13,870 --> 00:07:18,450
intended or commonly perceived and the

00:07:16,180 --> 00:07:20,740
actual rules also known as reality in

00:07:18,450 --> 00:07:22,890
most complex systems the gap between

00:07:20,740 --> 00:07:24,940
these two sets of rules is huge

00:07:22,890 --> 00:07:27,670
sometimes we catch a glimpse of the

00:07:24,940 --> 00:07:30,130
truth and discover the actual rules of a

00:07:27,670 --> 00:07:32,050
system once the actual rules are known

00:07:30,130 --> 00:07:34,120
it may become possible to perform

00:07:32,050 --> 00:07:37,419
miracles which are things that violate

00:07:34,120 --> 00:07:39,820
the perceived rules so what Paul is

00:07:37,419 --> 00:07:42,880
calling miracles are also known as hacks

00:07:39,820 --> 00:07:44,500
and so the definition of hacking that I

00:07:42,880 --> 00:07:46,210
like a lot is taking advantage of the

00:07:44,500 --> 00:07:49,240
gap between the written rules and the

00:07:46,210 --> 00:07:50,380
actual rules so if there's no gap then

00:07:49,240 --> 00:07:51,580
it's not possible to do something

00:07:50,380 --> 00:07:53,980
surprising because everybody already

00:07:51,580 --> 00:07:56,440
knows what's possible it's not possible

00:07:53,980 --> 00:07:58,120
to hack fortunately the web is full of

00:07:56,440 --> 00:07:59,830
places where the written rules also

00:07:58,120 --> 00:08:01,300
known as the specs diverge from the

00:07:59,830 --> 00:08:03,340
actual rules also known as the

00:08:01,300 --> 00:08:05,620
implementations we experience this every

00:08:03,340 --> 00:08:07,030
day on the web as well developers so I

00:08:05,620 --> 00:08:08,410
didn't think it would be very hard to

00:08:07,030 --> 00:08:11,919
find some edge cases and some of these

00:08:08,410 --> 00:08:13,390
powerful new api's so I started looking

00:08:11,919 --> 00:08:15,010
through various web API is looking for

00:08:13,390 --> 00:08:16,419
anything that might help me make a

00:08:15,010 --> 00:08:16,840
really annoying website to send to this

00:08:16,419 --> 00:08:20,169
spammer

00:08:16,840 --> 00:08:22,120
and I found some really weird ones as

00:08:20,169 --> 00:08:24,190
you can see up here some of these like

00:08:22,120 --> 00:08:25,180
the plaintext tag are just absurd how

00:08:24,190 --> 00:08:27,460
many of you have heard of the plaintext

00:08:25,180 --> 00:08:31,240
tag raise your hand okay yeah like three

00:08:27,460 --> 00:08:32,740
four people it's absurd it it renders

00:08:31,240 --> 00:08:35,289
everything that appears after it as

00:08:32,740 --> 00:08:38,589
plaintext and there's no way to close it

00:08:35,289 --> 00:08:39,789
so if you include it then all the HTML

00:08:38,589 --> 00:08:44,350
tags afterwards will just show up in the

00:08:39,789 --> 00:08:46,839
page I don't know what that's for but

00:08:44,350 --> 00:08:48,430
anyway there's also a string prototype

00:08:46,839 --> 00:08:50,020
big and quote which are they're not

00:08:48,430 --> 00:08:51,280
really good for annoying annoying

00:08:50,020 --> 00:08:54,459
purposes but they're just they're just

00:08:51,280 --> 00:08:57,490
silly like if you call big on a string

00:08:54,459 --> 00:08:58,870
it just adds a big HTML tag on both

00:08:57,490 --> 00:09:00,430
sides of the stream

00:08:58,870 --> 00:09:04,630
and quote just adds double quotes on

00:09:00,430 --> 00:09:06,550
both sides yeah I looked up with the big

00:09:04,630 --> 00:09:09,760
tag does it actually just it makes the

00:09:06,550 --> 00:09:14,620
the size of the text one size bigger

00:09:09,760 --> 00:09:19,180
than the parent div around it really

00:09:14,620 --> 00:09:21,810
useful okay so in all this searching I I

00:09:19,180 --> 00:09:27,820
finally found what I was looking for I

00:09:21,810 --> 00:09:29,820
found it seriously the best api's window

00:09:27,820 --> 00:09:33,070
moved to and their friends

00:09:29,820 --> 00:09:36,130
these methods allow you to move and to

00:09:33,070 --> 00:09:37,839
resize a browser window I thought there

00:09:36,130 --> 00:09:40,080
was no way that these ap eyes would

00:09:37,839 --> 00:09:43,029
still be allowed in modern web browsers

00:09:40,080 --> 00:09:45,760
sure enough when I I tried them they

00:09:43,029 --> 00:09:48,010
didn't work immediately and the reason

00:09:45,760 --> 00:09:50,200
is actually kind of surprising it's the

00:09:48,010 --> 00:09:52,690
same origin policy can you think about

00:09:50,200 --> 00:09:58,500
why moving a window would have anything

00:09:52,690 --> 00:09:58,500
to do with the same origin policy huh

00:09:58,529 --> 00:10:03,910
sort of no it's actually so it's

00:10:02,350 --> 00:10:04,960
actually more and more that if you think

00:10:03,910 --> 00:10:07,210
about like when you're using your

00:10:04,960 --> 00:10:09,940
browser you usually have multiple tabs

00:10:07,210 --> 00:10:12,130
open right and so if one site like say

00:10:09,940 --> 00:10:13,810
this site here bit MIDI were to try to

00:10:12,130 --> 00:10:15,700
resize the window I would also be

00:10:13,810 --> 00:10:19,210
resizing the Wikipedia tab which is

00:10:15,700 --> 00:10:20,740
implicitly it's sort of affecting domain

00:10:19,210 --> 00:10:22,210
on another origin and that's just not

00:10:20,740 --> 00:10:23,589
allowed even though it's kind of a silly

00:10:22,210 --> 00:10:24,520
thing it's like I'm just resizing it you

00:10:23,589 --> 00:10:25,839
wouldn't think that's a big deal but

00:10:24,520 --> 00:10:27,550
actually any kind of you know

00:10:25,839 --> 00:10:29,170
cross-origin communication without the

00:10:27,550 --> 00:10:30,820
site explicitly opting into it is a

00:10:29,170 --> 00:10:32,290
violation of the same-origin policy so

00:10:30,820 --> 00:10:34,120
at least that's how I explained to

00:10:32,290 --> 00:10:36,610
myself why the API didn't work but I

00:10:34,120 --> 00:10:39,070
figured out a workaround for it so if

00:10:36,610 --> 00:10:42,160
you open a new window using window dot

00:10:39,070 --> 00:10:43,839
open then you get this little window

00:10:42,160 --> 00:10:45,550
that pops up and you can see the

00:10:43,839 --> 00:10:47,680
parameters there are it's a really weird

00:10:45,550 --> 00:10:51,180
API the first two parameters don't work

00:10:47,680 --> 00:10:51,180
anymore so you just pass empty strings

00:10:51,350 --> 00:10:57,410
the the third one is like a

00:10:53,720 --> 00:10:59,350
comma-separated list of of properties I

00:10:57,410 --> 00:11:01,100
don't know why it's not an object but

00:10:59,350 --> 00:11:03,290
anyway that's what you do and then you

00:11:01,100 --> 00:11:06,170
get this little window that pops up and

00:11:03,290 --> 00:11:10,900
okay so that's cool now let's try to

00:11:06,170 --> 00:11:14,450
move it around so when I wrote this code

00:11:10,900 --> 00:11:15,710
and I ran it it didn't work again but I

00:11:14,450 --> 00:11:19,030
noticed a little thing in the browser

00:11:15,710 --> 00:11:21,140
that said pop-up window is blocked so

00:11:19,030 --> 00:11:23,150
you know I did a little research figure

00:11:21,140 --> 00:11:24,350
it out okay so what we need to do here

00:11:23,150 --> 00:11:26,180
is we need to trigger this window

00:11:24,350 --> 00:11:29,600
opening in response to a user initiated

00:11:26,180 --> 00:11:31,760
event so in other words like a click or

00:11:29,600 --> 00:11:34,540
a key a key press if we do that we're

00:11:31,760 --> 00:11:38,320
allowed to open up windows so this works

00:11:34,540 --> 00:11:38,320
now let's add the fun part

00:11:39,790 --> 00:11:45,610
right so let's see it

00:11:47,170 --> 00:11:53,060
so I have a little demo here can you see

00:11:51,380 --> 00:11:57,110
that yeah okay cool so if I click this

00:11:53,060 --> 00:11:58,580
button you get a window that moves on

00:11:57,110 --> 00:12:02,840
its own and if you try to grab it and

00:11:58,580 --> 00:12:04,370
move it around it fights you and if you

00:12:02,840 --> 00:12:06,020
if you try to right-click on it to the

00:12:04,370 --> 00:12:11,090
little right-click thing also the menu

00:12:06,020 --> 00:12:13,220
moves too so okay we're off to a good

00:12:11,090 --> 00:12:17,060
start this is pretty annoying can we do

00:12:13,220 --> 00:12:19,370
anything else and so I thought I should

00:12:17,060 --> 00:12:20,990
intercept oh sorry you can see my my

00:12:19,370 --> 00:12:24,890
slides here and need to fix that okay

00:12:20,990 --> 00:12:26,630
there we go so I thought let's intercept

00:12:24,890 --> 00:12:28,910
all user initiated events and let's open

00:12:26,630 --> 00:12:32,240
a window on any possible interaction

00:12:28,910 --> 00:12:33,880
with the site at all the best part about

00:12:32,240 --> 00:12:37,390
this is this includes things like

00:12:33,880 --> 00:12:40,370
command W if you try to close the tab

00:12:37,390 --> 00:12:42,500
this includes escape if you try to like

00:12:40,370 --> 00:12:44,000
you know close if a pop-up window comes

00:12:42,500 --> 00:12:45,440
up and you're like escape I need to get

00:12:44,000 --> 00:12:49,400
out of this it'll actually open another

00:12:45,440 --> 00:12:51,110
pop-up window yeah so you doesn't work

00:12:49,400 --> 00:12:52,430
on scroll unfortunately or on any of

00:12:51,110 --> 00:12:54,350
those other types of really common

00:12:52,430 --> 00:12:55,340
events but like mouse move would be

00:12:54,350 --> 00:12:58,430
really ridiculous

00:12:55,340 --> 00:13:01,930
but it works on mouse click touch on

00:12:58,430 --> 00:13:04,310
touch devices and all keystroke events

00:13:01,930 --> 00:13:05,630
so let's just use that little function

00:13:04,310 --> 00:13:07,310
we just wrote called intercept user

00:13:05,630 --> 00:13:08,990
input and when that happens we will

00:13:07,310 --> 00:13:10,550
prevent that whatever the default thing

00:13:08,990 --> 00:13:12,290
the browser was going to do and well

00:13:10,550 --> 00:13:18,380
instead call up this little open window

00:13:12,290 --> 00:13:22,220
function to open a window so one other

00:13:18,380 --> 00:13:24,440
trick we should add is so the pop-up

00:13:22,220 --> 00:13:25,910
windows can sort of go behind the main

00:13:24,440 --> 00:13:27,290
browser window if the user clicks on the

00:13:25,910 --> 00:13:28,700
main window and then they'll be moving

00:13:27,290 --> 00:13:29,780
in the background which wouldn't be

00:13:28,700 --> 00:13:31,400
nearly as annoying as if they were

00:13:29,780 --> 00:13:33,920
moving and they were all on the front of

00:13:31,400 --> 00:13:35,540
what you're doing so we can just on any

00:13:33,920 --> 00:13:37,640
click we can just call this little focus

00:13:35,540 --> 00:13:39,920
windows function to bring all the

00:13:37,640 --> 00:13:41,839
windows to the front you have to do this

00:13:39,920 --> 00:13:45,580
in response to a user event like a click

00:13:41,839 --> 00:13:48,899
or something but it works really nicely

00:13:45,580 --> 00:13:51,269
ok gets worse

00:13:48,899 --> 00:13:54,509
what if we bounce the windows off the

00:13:51,269 --> 00:13:55,529
screen edges and so this little bit of

00:13:54,509 --> 00:13:57,779
code here you probably gonna be able to

00:13:55,529 --> 00:13:59,040
read it fast enough but it just detects

00:13:57,779 --> 00:14:01,100
when the window hits an edge and then it

00:13:59,040 --> 00:14:03,480
just inverts the direction

00:14:01,100 --> 00:14:06,569
okay let's also play a random video in

00:14:03,480 --> 00:14:10,170
the window so I have some good ones here

00:14:06,569 --> 00:14:11,759
that I found the great part too is so

00:14:10,170 --> 00:14:14,100
browsers have started to try to prevent

00:14:11,759 --> 00:14:17,249
autoplay Auto playing video that

00:14:14,100 --> 00:14:18,980
includes audio and if you try to do that

00:14:17,249 --> 00:14:22,199
then the video just will get blocked

00:14:18,980 --> 00:14:23,579
however we're setting up this site so

00:14:22,199 --> 00:14:25,350
that the user will be tempted to

00:14:23,579 --> 00:14:27,569
interact with it in some way initially

00:14:25,350 --> 00:14:28,769
we're gonna put like a cute cat or

00:14:27,569 --> 00:14:31,649
something and say you know click the cat

00:14:28,769 --> 00:14:33,269
to get started or something we need some

00:14:31,649 --> 00:14:34,559
way that entice them to do an initial

00:14:33,269 --> 00:14:35,699
event in order to get these pop-ups

00:14:34,559 --> 00:14:37,379
going and then once they've done that

00:14:35,699 --> 00:14:40,649
we'll also be able to play sound because

00:14:37,379 --> 00:14:42,509
they've interacted with the site so so

00:14:40,649 --> 00:14:43,740
now we've sort of used this API but can

00:14:42,509 --> 00:14:47,220
we do more is there anything else we can

00:14:43,740 --> 00:14:51,329
add any other API as we can use of

00:14:47,220 --> 00:14:55,379
course yes so I'm gonna get into a few

00:14:51,329 --> 00:14:56,579
more api's but first one thing is one

00:14:55,379 --> 00:14:57,990
thing is worth discussing which is the

00:14:56,579 --> 00:15:00,059
permission model for all of these api's

00:14:57,990 --> 00:15:02,490
as I was looking into them I realized

00:15:00,059 --> 00:15:04,740
there's basically four models that the

00:15:02,490 --> 00:15:07,800
browser uses for permissioning each of

00:15:04,740 --> 00:15:09,480
these api's so i think of them in this

00:15:07,800 --> 00:15:12,360
way so the first one is the API just

00:15:09,480 --> 00:15:13,920
always works so API is like that are

00:15:12,360 --> 00:15:15,059
well actually I won't tell you the API

00:15:13,920 --> 00:15:16,110
as we'll see them as we go so there's so

00:15:15,059 --> 00:15:18,029
many P as you can just always use

00:15:16,110 --> 00:15:20,399
there's some that you can only use if

00:15:18,029 --> 00:15:21,779
you're on an HTTP domain you probably

00:15:20,399 --> 00:15:22,740
probably if you've used the Service

00:15:21,779 --> 00:15:24,300
Worker you know you have to be on a

00:15:22,740 --> 00:15:26,540
secure origin because it's a very

00:15:24,300 --> 00:15:28,800
powerful API same thing with geolocation

00:15:26,540 --> 00:15:30,480
then there are api's which require user

00:15:28,800 --> 00:15:34,230
interaction so this is to play sound for

00:15:30,480 --> 00:15:36,389
example and then the most sensitive API

00:15:34,230 --> 00:15:37,529
is require explicit user permission and

00:15:36,389 --> 00:15:38,939
that's what you've seen with the little

00:15:37,529 --> 00:15:42,029
prompt that comes up saying like can I

00:15:38,939 --> 00:15:43,949
use your webcam for example so as I go

00:15:42,029 --> 00:15:45,600
through these I'm going to hopefully

00:15:43,949 --> 00:15:47,629
I'll remember to mention which of these

00:15:45,600 --> 00:15:50,730
models each of the api's falls under

00:15:47,629 --> 00:15:53,790
okay so the first one we can do is we

00:15:50,730 --> 00:15:57,120
can copy text spam text to the user's

00:15:53,790 --> 00:16:01,499
clipboard so here we have an array of

00:15:57,120 --> 00:16:02,610
interesting ASCII art and we can just

00:16:01,499 --> 00:16:04,019
call clipboard

00:16:02,610 --> 00:16:06,149
I guess that's actually yeah that's a

00:16:04,019 --> 00:16:07,560
method that I that I wrote but anyway

00:16:06,149 --> 00:16:09,779
you call it and it copies text to the

00:16:07,560 --> 00:16:13,680
users clipboard this API requires a user

00:16:09,779 --> 00:16:14,579
in user interaction with a site so if

00:16:13,680 --> 00:16:16,500
they click at all we're just going to

00:16:14,579 --> 00:16:17,910
fill their clipboard with the cat and

00:16:16,500 --> 00:16:19,560
then also a link to our site so if they

00:16:17,910 --> 00:16:24,839
accidentally paste it into slack you

00:16:19,560 --> 00:16:28,350
know it'll go viral like that okay one

00:16:24,839 --> 00:16:29,880
more so we got speaking to the user this

00:16:28,350 --> 00:16:31,950
one is great this one's actually really

00:16:29,880 --> 00:16:35,100
great so we can we can use this speech

00:16:31,950 --> 00:16:37,410
synthesis API which lets you pass text

00:16:35,100 --> 00:16:38,750
to a special function and then it will

00:16:37,410 --> 00:16:40,860
read it to the user

00:16:38,750 --> 00:16:41,820
and so I have these nice phrases here

00:16:40,860 --> 00:16:43,079
that I found which are extremely

00:16:41,820 --> 00:16:47,519
annoying when read in a computerized

00:16:43,079 --> 00:16:51,329
voice especially the a all the A's there

00:16:47,519 --> 00:16:53,190
that one is great the best thing about

00:16:51,329 --> 00:16:55,170
this API is that it can auto play right

00:16:53,190 --> 00:16:57,570
away without user interaction as soon as

00:16:55,170 --> 00:16:59,760
you land on the page on top of that it's

00:16:57,570 --> 00:17:01,769
also unmute Abul so if you right-click

00:16:59,760 --> 00:17:07,470
on the tab and you try to say mute this

00:17:01,769 --> 00:17:09,089
site it doesn't affect this API so I see

00:17:07,470 --> 00:17:10,500
the chrome engineers in the audience

00:17:09,089 --> 00:17:12,510
opening up issues right now I'll try to

00:17:10,500 --> 00:17:15,319
go slowly say you have time to keep

00:17:12,510 --> 00:17:21,049
opening issues as we go through these

00:17:15,319 --> 00:17:23,010
yeah so anyway there's a great API

00:17:21,049 --> 00:17:25,230
here's a fun one you've probably seen

00:17:23,010 --> 00:17:27,360
before you can ask the user are you sure

00:17:25,230 --> 00:17:29,760
you want to leave this page when they're

00:17:27,360 --> 00:17:31,950
trying to close your website so you just

00:17:29,760 --> 00:17:34,169
listen to the before unload event and if

00:17:31,950 --> 00:17:36,000
you set this event return value to true

00:17:34,169 --> 00:17:37,049
then when the user tries to close the

00:17:36,000 --> 00:17:38,850
tab it's gonna say are you sure you want

00:17:37,049 --> 00:17:40,020
to leave you have unsaved changes you've

00:17:38,850 --> 00:17:41,730
probably seen this used on like Google

00:17:40,020 --> 00:17:44,760
Docs or something if you if it hasn't

00:17:41,730 --> 00:17:47,580
sent up the changes to the server yet so

00:17:44,760 --> 00:17:49,610
let's just make them have to do an extra

00:17:47,580 --> 00:17:52,110
click to close each of these pop-ups

00:17:49,610 --> 00:17:53,250
browsers have actually started to lock

00:17:52,110 --> 00:17:54,780
this one down a little bit so you need

00:17:53,250 --> 00:17:56,850
to at least interact with the site once

00:17:54,780 --> 00:18:00,270
before this is allowed to pop up which

00:17:56,850 --> 00:18:04,470
is annoying but it's still pretty good

00:18:00,270 --> 00:18:08,100
so I'll try it anyway this is a good one

00:18:04,470 --> 00:18:09,840
so we can register protocol handlers so

00:18:08,100 --> 00:18:12,580
we attempted to register all possible

00:18:09,840 --> 00:18:14,650
protocols that the user might

00:18:12,580 --> 00:18:16,390
on their computer and then if they oh

00:18:14,650 --> 00:18:18,280
this one actually had required explicit

00:18:16,390 --> 00:18:20,110
user permission so it's probably

00:18:18,280 --> 00:18:22,450
unlikely that they're going to say yes

00:18:20,110 --> 00:18:23,500
but maybe in the frenzy of them trying

00:18:22,450 --> 00:18:24,040
to close all these windows going on

00:18:23,500 --> 00:18:25,210
their screen

00:18:24,040 --> 00:18:26,860
they might just give us permission to

00:18:25,210 --> 00:18:30,940
handle all their Bitcoin transactions

00:18:26,860 --> 00:18:34,810
which would be great might as well try

00:18:30,940 --> 00:18:37,990
right while we're at it let's ask for

00:18:34,810 --> 00:18:39,280
the camera and the mic one cool thing

00:18:37,990 --> 00:18:41,560
about this code is if you look towards

00:18:39,280 --> 00:18:45,430
the bottom there's a little function

00:18:41,560 --> 00:18:48,250
called tracked apply constraints and

00:18:45,430 --> 00:18:51,600
you'll see that I've passed torch true

00:18:48,250 --> 00:18:54,640
to it torch is actually the term that

00:18:51,600 --> 00:18:56,410
describes the camera flash so if they do

00:18:54,640 --> 00:18:59,620
give us permission we'll just turn their

00:18:56,410 --> 00:19:05,380
flash on on their mobile device it's

00:18:59,620 --> 00:19:07,840
nice this one's good we can vibrate the

00:19:05,380 --> 00:19:11,410
device this actually works on Chrome

00:19:07,840 --> 00:19:13,480
chrome on Android and we just to make it

00:19:11,410 --> 00:19:17,070
even better we pick a random duration

00:19:13,480 --> 00:19:20,320
for each of the vibrates so it goes like

00:19:17,070 --> 00:19:22,090
really and consistently this one

00:19:20,320 --> 00:19:24,460
unfortunately now also requires a user

00:19:22,090 --> 00:19:25,720
interaction and it also doesn't work in

00:19:24,460 --> 00:19:27,490
iframes anymore because there were ads

00:19:25,720 --> 00:19:28,720
that were actually like an ad would in

00:19:27,490 --> 00:19:30,160
the iframe would just start causing

00:19:28,720 --> 00:19:32,500
buzzes on your phone to attract

00:19:30,160 --> 00:19:34,030
attention to the ad so they stopped that

00:19:32,500 --> 00:19:35,230
but anyway if they interact at all with

00:19:34,030 --> 00:19:36,520
their site which they're going to do

00:19:35,230 --> 00:19:38,950
then we will be able to start buzzing

00:19:36,520 --> 00:19:40,060
their phone which is nice you're

00:19:38,950 --> 00:19:42,550
starting to notice a pattern here

00:19:40,060 --> 00:19:43,480
basically like the idea was like you

00:19:42,550 --> 00:19:45,580
know let's put some of these api's

00:19:43,480 --> 00:19:46,780
behind a user interaction and then you

00:19:45,580 --> 00:19:48,430
know that way it can't be abused but the

00:19:46,780 --> 00:19:50,260
thing is one user interaction maybe

00:19:48,430 --> 00:19:51,700
shouldn't be allowed to cause all of

00:19:50,260 --> 00:19:57,430
these api's to run at the same time

00:19:51,700 --> 00:19:59,770
right okay we got more Safari has a

00:19:57,430 --> 00:20:03,400
feature called picture-in-picture which

00:19:59,770 --> 00:20:05,320
allows a video site to pop a video out

00:20:03,400 --> 00:20:07,090
that hovers on top of all of your

00:20:05,320 --> 00:20:08,410
windows on your desktop so you can like

00:20:07,090 --> 00:20:12,250
watch a lecture or something while

00:20:08,410 --> 00:20:13,600
you're working on other things so what

00:20:12,250 --> 00:20:16,090
we do here is we start an invisible

00:20:13,600 --> 00:20:17,410
muted video so that it's ready to go and

00:20:16,090 --> 00:20:20,260
then as soon as there's an initial user

00:20:17,410 --> 00:20:21,130
interaction with the site we we trigger

00:20:20,260 --> 00:20:23,140
the picture-in-picture

00:20:21,130 --> 00:20:24,910
and then that pops the video out onto

00:20:23,140 --> 00:20:26,410
the desktop and actually chrome is

00:20:24,910 --> 00:20:30,390
adding this API to

00:20:26,410 --> 00:20:30,390
future versions so that's good for us

00:20:30,900 --> 00:20:41,650
this one this next one is amazing this

00:20:38,650 --> 00:20:43,600
actually works so we can actually just

00:20:41,650 --> 00:20:45,070
take away the cursor that's great now

00:20:43,600 --> 00:20:46,180
they can't even now they can't even

00:20:45,070 --> 00:20:51,300
chase down the windows and try to hit

00:20:46,180 --> 00:20:51,300
the X button it's very disorienting

00:20:52,690 --> 00:20:56,350
I also saw another actually somewhat

00:20:54,880 --> 00:20:58,230
someone did something even more clever

00:20:56,350 --> 00:21:02,020
you can actually set custom images as

00:20:58,230 --> 00:21:04,330
the cursor and I saw this great site

00:21:02,020 --> 00:21:07,570
where someone actually made it so that

00:21:04,330 --> 00:21:08,920
like they basically offset the cursor I

00:21:07,570 --> 00:21:10,930
wish I had a video of it but anyway they

00:21:08,920 --> 00:21:12,700
offset the cursor down by like 100

00:21:10,930 --> 00:21:14,140
pixels in each direction and then they

00:21:12,700 --> 00:21:15,790
pop something up that you try to close

00:21:14,140 --> 00:21:17,440
but when you actually close it you're

00:21:15,790 --> 00:21:19,840
actually enabling a permission prompt

00:21:17,440 --> 00:21:24,750
because your real cursor is up higher

00:21:19,840 --> 00:21:28,930
it's actually great yeah

00:21:24,750 --> 00:21:30,460
Security's hard ok so here's another one

00:21:28,930 --> 00:21:31,540
and we can this is a great one too

00:21:30,460 --> 00:21:33,130
because I don't know if you've seen

00:21:31,540 --> 00:21:34,510
websites where it says if you go to

00:21:33,130 --> 00:21:35,800
download a file and then you get the

00:21:34,510 --> 00:21:37,780
little countdown timer it's like

00:21:35,800 --> 00:21:40,630
downloading in five four three two one

00:21:37,780 --> 00:21:42,130
and then the file downloads well what

00:21:40,630 --> 00:21:44,320
that what's going on is actually you're

00:21:42,130 --> 00:21:46,240
allowed to download one file without any

00:21:44,320 --> 00:21:47,230
user interaction if you think about it

00:21:46,240 --> 00:21:48,490
right because it's it's counting down

00:21:47,230 --> 00:21:50,140
and then it downloads a file and you

00:21:48,490 --> 00:21:51,640
haven't even clicked anything so we're

00:21:50,140 --> 00:21:52,960
allowed to trigger a file download one

00:21:51,640 --> 00:21:55,060
file download immediately without any

00:21:52,960 --> 00:21:56,740
user interaction but then further file

00:21:55,060 --> 00:21:58,060
downloads have to happen in response to

00:21:56,740 --> 00:22:00,100
a user initiated event or otherwise the

00:21:58,060 --> 00:22:02,500
browser blocks them and then asks the

00:22:00,100 --> 00:22:03,790
user it says like the site is trying to

00:22:02,500 --> 00:22:06,670
download multiple files would you like

00:22:03,790 --> 00:22:08,790
to allow it so we can just call this

00:22:06,670 --> 00:22:11,440
right away and give them a give them

00:22:08,790 --> 00:22:14,830
various cat pictures in their downloads

00:22:11,440 --> 00:22:17,220
folder and remember each pop-up window

00:22:14,830 --> 00:22:17,220
can do this

00:22:21,710 --> 00:22:26,610
okay this one is really nice so if they

00:22:24,840 --> 00:22:28,590
go to hit command W so I mentioned

00:22:26,610 --> 00:22:30,389
earlier that that you can you can handle

00:22:28,590 --> 00:22:32,610
you can run events when that happens but

00:22:30,389 --> 00:22:34,710
I can't think it's chrome actually

00:22:32,610 --> 00:22:36,840
doesn't let you call event dot prevent

00:22:34,710 --> 00:22:37,769
default on command W because they don't

00:22:36,840 --> 00:22:39,419
want you to be able to intercept that

00:22:37,769 --> 00:22:43,919
however there's a good trick that

00:22:39,419 --> 00:22:46,139
actually works around this so if you in

00:22:43,919 --> 00:22:48,750
response to then pushing command you

00:22:46,139 --> 00:22:50,940
open a modal dialog like an alert then

00:22:48,750 --> 00:22:52,409
the W actually doesn't it doesn't do the

00:22:50,940 --> 00:22:53,669
full shortcut anymore because the the

00:22:52,409 --> 00:22:55,409
the dialog has opened up and now it just

00:22:53,669 --> 00:22:56,940
sees it as a W so all you got to do is

00:22:55,409 --> 00:22:58,769
when they push command you just open a

00:22:56,940 --> 00:23:01,980
pop-up and then you open up an alert and

00:22:58,769 --> 00:23:03,809
then W doesn't work so that's nice and

00:23:01,980 --> 00:23:05,039
we can also very varied a little bit for

00:23:03,809 --> 00:23:06,480
good fun so in some of that some of the

00:23:05,039 --> 00:23:10,049
time we can call window dot print which

00:23:06,480 --> 00:23:12,149
asks if they want to print the page and

00:23:10,049 --> 00:23:13,470
that's nice and it doesn't actually it

00:23:12,149 --> 00:23:16,549
doesn't require any user interaction you

00:23:13,470 --> 00:23:16,549
can just call that as much as you want

00:23:17,240 --> 00:23:22,259
let's also just throw in a random modal

00:23:20,399 --> 00:23:26,490
alert every 30 seconds just for more

00:23:22,259 --> 00:23:29,549
chaos you can also full-screen the

00:23:26,490 --> 00:23:31,110
browser this happens on user interaction

00:23:29,549 --> 00:23:34,860
as well so we need to have a click but

00:23:31,110 --> 00:23:36,419
throw that in there all right

00:23:34,860 --> 00:23:39,149
so many of these like I think I'm gonna

00:23:36,419 --> 00:23:41,399
run out of time okay so this is a good

00:23:39,149 --> 00:23:43,289
one I didn't come up this one but you

00:23:41,399 --> 00:23:44,700
can there's actually these URLs which if

00:23:43,289 --> 00:23:46,230
you send a get request to them they'll

00:23:44,700 --> 00:23:49,049
actually log the user out of the the

00:23:46,230 --> 00:23:50,370
given website and what's amazing is you

00:23:49,049 --> 00:23:51,929
can actually send get requests

00:23:50,370 --> 00:23:53,370
cross-origin right think about it like

00:23:51,929 --> 00:23:54,720
every time you've included an image tag

00:23:53,370 --> 00:23:56,190
you can include an image to a

00:23:54,720 --> 00:23:57,539
third-party website and that image will

00:23:56,190 --> 00:23:59,429
load just fine and what is that doing

00:23:57,539 --> 00:24:00,840
that's making a get request now of

00:23:59,429 --> 00:24:02,190
course if you try to make a if you try

00:24:00,840 --> 00:24:03,450
to load one of these URLs as an image

00:24:02,190 --> 00:24:05,009
it's not going to show an image but

00:24:03,450 --> 00:24:06,299
it'll still make the get request the

00:24:05,009 --> 00:24:10,080
data will come back they'll be logged

00:24:06,299 --> 00:24:11,789
out and then no image will show so let's

00:24:10,080 --> 00:24:12,809
just try to do this a lot of these

00:24:11,789 --> 00:24:14,549
actually some of these half of these

00:24:12,809 --> 00:24:16,740
don't work anymore but it does actually

00:24:14,549 --> 00:24:20,220
log you out of google still and a few

00:24:16,740 --> 00:24:22,409
other sites so this is the commercial

00:24:20,220 --> 00:24:23,850
code to do that we just we just use I

00:24:22,409 --> 00:24:27,929
think xhr here or something like that

00:24:23,850 --> 00:24:30,190
yeah and it works

00:24:27,929 --> 00:24:33,070
here's another one I discovered so let's

00:24:30,190 --> 00:24:34,450
disable the back button this is really

00:24:33,070 --> 00:24:36,640
fun look at what it's doing it says if

00:24:34,450 --> 00:24:38,170
the user goes back they'll trigger pop

00:24:36,640 --> 00:24:46,330
state so if the user goes back just send

00:24:38,170 --> 00:24:48,340
them forward it's works and then here's

00:24:46,330 --> 00:24:49,900
the thing though so the back button has

00:24:48,340 --> 00:24:51,520
like a long press feature where you can

00:24:49,900 --> 00:24:54,370
hold down the back button and it'll show

00:24:51,520 --> 00:24:56,500
you multiple like previous sites you can

00:24:54,370 --> 00:24:57,760
go back to like a whole list of them we

00:24:56,500 --> 00:25:00,520
don't want them to be able to use that

00:24:57,760 --> 00:25:02,350
to actually skip past this code that

00:25:00,520 --> 00:25:03,730
we've written here so what we do is when

00:25:02,350 --> 00:25:06,850
they first land on the site we fill the

00:25:03,730 --> 00:25:08,980
history with extra entries so we just

00:25:06,850 --> 00:25:11,230
push state a bunch of extra URLs in that

00:25:08,980 --> 00:25:13,030
are our own site and then we push back

00:25:11,230 --> 00:25:14,140
the original URL back on so they can't

00:25:13,030 --> 00:25:16,150
tell that we've actually gone through

00:25:14,140 --> 00:25:18,220
and you know iterated like added like 20

00:25:16,150 --> 00:25:19,809
entries to the list and so now they

00:25:18,220 --> 00:25:26,950
can't actually hold down either and and

00:25:19,809 --> 00:25:30,059
try to go back okay we got more we can

00:25:26,950 --> 00:25:30,059
do some embarrassing searches

00:25:34,170 --> 00:25:40,690
try to keep it pg so what we do here is

00:25:38,290 --> 00:25:42,520
we can actually once in a while when we

00:25:40,690 --> 00:25:44,680
open up a pop-up window we'll make one

00:25:42,520 --> 00:25:48,730
of those pop-ups actually point to being

00:25:44,680 --> 00:25:54,400
searched and I chose being cuz you know

00:25:48,730 --> 00:25:55,420
it's pretty funny on its own but you

00:25:54,400 --> 00:25:58,660
know to mean heaven being in your

00:25:55,420 --> 00:26:00,160
history now I'm just kidding anyway so

00:25:58,660 --> 00:26:01,360
so yeah basically this is the code it's

00:26:00,160 --> 00:26:02,620
a little too much to see what's going on

00:26:01,360 --> 00:26:04,120
but basically it just opens a pop-up

00:26:02,620 --> 00:26:05,770
window and then the interesting thing is

00:26:04,120 --> 00:26:07,900
so if you open up a pop-up window and

00:26:05,770 --> 00:26:10,120
it's on another domain like Bing com

00:26:07,900 --> 00:26:11,770
then you I'm no longer allowed to

00:26:10,120 --> 00:26:14,860
control it and move it around because

00:26:11,770 --> 00:26:16,060
it's on another origin right however as

00:26:14,860 --> 00:26:18,400
long as you have a reference to the

00:26:16,060 --> 00:26:19,900
window you know in other words we were

00:26:18,400 --> 00:26:21,340
the worse side was the one that opened

00:26:19,900 --> 00:26:23,050
the window so we have a handle we have a

00:26:21,340 --> 00:26:24,730
variable that references that window we

00:26:23,050 --> 00:26:26,500
can't actually okay we can't actually

00:26:24,730 --> 00:26:27,880
like reach into the page or do anything

00:26:26,500 --> 00:26:29,650
to it or move it around but we can do is

00:26:27,880 --> 00:26:31,450
set window dot location on it and

00:26:29,650 --> 00:26:32,770
redirect it back to ourselves so we can

00:26:31,450 --> 00:26:34,930
redirect you to Bing so that the search

00:26:32,770 --> 00:26:36,340
gets added to your history and then we

00:26:34,930 --> 00:26:37,750
can redirect you back to our own site so

00:26:36,340 --> 00:26:39,220
the window can start to move again and

00:26:37,750 --> 00:26:41,230
then redirect you to another search and

00:26:39,220 --> 00:26:42,400
then just keep looping like this so the

00:26:41,230 --> 00:26:43,930
window Bing windows will actually freeze

00:26:42,400 --> 00:26:45,400
once in a while while they're loading

00:26:43,930 --> 00:26:47,170
the Bing site but then once we once

00:26:45,400 --> 00:26:48,220
they've loaded we redirect them back to

00:26:47,170 --> 00:26:51,940
our own domain so that we can continue

00:26:48,220 --> 00:26:54,100
moving them around your screen ok this

00:26:51,940 --> 00:26:56,950
is ok I think this is the last one this

00:26:54,100 --> 00:26:58,270
one is extremely surprising this

00:26:56,950 --> 00:27:04,300
probably sit was going to surprise a lot

00:26:58,270 --> 00:27:06,280
of you so sites that link to two sites

00:27:04,300 --> 00:27:09,870
that include links that open in a new

00:27:06,280 --> 00:27:12,190
tab using target equals underscore blank

00:27:09,870 --> 00:27:14,830
will actually still open links in a new

00:27:12,190 --> 00:27:17,950
window however that new window that has

00:27:14,830 --> 00:27:21,250
been opened has a variable set called

00:27:17,950 --> 00:27:23,980
window opener and that references the

00:27:21,250 --> 00:27:25,600
window that opened it this only happens

00:27:23,980 --> 00:27:27,010
if your so if your site has been opened

00:27:25,600 --> 00:27:29,080
in a new tab you can check window dot

00:27:27,010 --> 00:27:31,920
opener and that will be a pointer to

00:27:29,080 --> 00:27:33,880
that window that opened to you okay so

00:27:31,920 --> 00:27:35,110
like I said before they're like having a

00:27:33,880 --> 00:27:36,430
pointer to a window on another origin

00:27:35,110 --> 00:27:37,780
doesn't necessarily help you you can't

00:27:36,430 --> 00:27:40,780
really do anything but what you can do

00:27:37,780 --> 00:27:43,960
is redirect it so if anybody links to

00:27:40,780 --> 00:27:45,220
our site the annoying site and it opens

00:27:43,960 --> 00:27:46,659
in a new tab and a lot of site

00:27:45,220 --> 00:27:47,650
do this for example facebook Messenger

00:27:46,659 --> 00:27:49,570
does this when you click a link it'll

00:27:47,650 --> 00:27:53,470
open in a new tab will redirect Facebook

00:27:49,570 --> 00:27:54,570
to ourselves in response so this is how

00:27:53,470 --> 00:27:56,590
you do that

00:27:54,570 --> 00:27:57,820
it's actually really crazy that you can

00:27:56,590 --> 00:27:59,470
do this so you can imagine like hooking

00:27:57,820 --> 00:28:01,150
a link to go to another site and then

00:27:59,470 --> 00:28:02,590
you know that site that was previously

00:28:01,150 --> 00:28:03,789
like a trusted site now redirects to a

00:28:02,590 --> 00:28:05,770
phishing site or something it's really

00:28:03,789 --> 00:28:08,559
bad however there was a way to work

00:28:05,770 --> 00:28:10,210
around this you can add rel equals no

00:28:08,559 --> 00:28:12,700
opener to all of your links that open in

00:28:10,210 --> 00:28:14,919
new tabs and then that new tab will not

00:28:12,700 --> 00:28:15,789
have window door opener set they can't

00:28:14,919 --> 00:28:16,780
do this by default because it's a

00:28:15,789 --> 00:28:18,070
breaking change but you should

00:28:16,780 --> 00:28:21,669
definitely do this and all your links to

00:28:18,070 --> 00:28:22,840
open in a new window okay cool so let's

00:28:21,669 --> 00:28:29,350
see it let's put it all together and

00:28:22,840 --> 00:28:32,799
let's see what we got all right okay so

00:28:29,350 --> 00:28:34,179
I have chrome here actually let's start

00:28:32,799 --> 00:28:34,960
in Safari Safari actually it's more

00:28:34,179 --> 00:28:39,900
funny in Safari

00:28:34,960 --> 00:28:43,630
all right okay so here we go

00:28:39,900 --> 00:28:45,610
so it's telling you to hold down space

00:28:43,630 --> 00:28:47,950
for three seconds because that triggers

00:28:45,610 --> 00:28:49,480
a bunch of repeated events I could also

00:28:47,950 --> 00:28:52,350
just click once but I think it's funnier

00:28:49,480 --> 00:29:00,130
if I hold down space so let's do that

00:28:52,350 --> 00:29:01,570
okay so some stuffs happening well yeah

00:29:00,130 --> 00:29:02,980
I don't think my speakers not plugged in

00:29:01,570 --> 00:29:05,250
but yeah they have I've sound going

00:29:02,980 --> 00:29:05,250
right now

00:29:24,760 --> 00:29:31,360
so the more let me turn the volume down

00:29:27,490 --> 00:29:33,750
a little bit okay so the more that I hit

00:29:31,360 --> 00:29:36,400
escape the more actually windows open up

00:29:33,750 --> 00:29:39,960
so if I like own a scene out like my

00:29:36,400 --> 00:29:39,960
computer's actually frozen there we go

00:29:41,190 --> 00:29:44,200
all right let me try to catch them these

00:29:43,120 --> 00:29:45,640
I think if you miss and you actually

00:29:44,200 --> 00:29:48,160
click on the window then you open up

00:29:45,640 --> 00:29:51,220
more pop-ups so so I'll try to do

00:29:48,160 --> 00:29:52,270
command W instead which to see it opens

00:29:51,220 --> 00:29:55,390
up this alert window with like a lot of

00:29:52,270 --> 00:29:56,260
cats in it and I think I can hit X when

00:29:55,390 --> 00:29:58,480
that happens though that's actually

00:29:56,260 --> 00:29:59,860
useful oh now it's trying to print so

00:29:58,480 --> 00:30:01,840
I'll just I don't wanna print anything

00:29:59,860 --> 00:30:04,120
now let's try command W again

00:30:01,840 --> 00:30:05,440
okay so I've hidden command W over and

00:30:04,120 --> 00:30:06,520
over again but I'm getting and this is

00:30:05,440 --> 00:30:09,910
see this actually blocked the opening

00:30:06,520 --> 00:30:10,929
here what if I try to go okay I can't

00:30:09,910 --> 00:30:14,020
even hit the window here but if I try to

00:30:10,929 --> 00:30:16,710
go back I got all the annoying sight if

00:30:14,020 --> 00:30:19,419
I check my notice here too this is the

00:30:16,710 --> 00:30:21,429
floating floating picture and picture

00:30:19,419 --> 00:30:29,890
window down here and my downloads folder

00:30:21,429 --> 00:30:32,080
has been filled yeah so this is kind of

00:30:29,890 --> 00:30:34,000
a disaster the easiest way to get out of

00:30:32,080 --> 00:30:35,530
it is to just you know quit the browser

00:30:34,000 --> 00:30:38,230
that actually works but it's gonna ask

00:30:35,530 --> 00:30:39,580
me if I'm sure and then the best part is

00:30:38,230 --> 00:30:44,230
if you open up the browser again it's

00:30:39,580 --> 00:30:45,880
going to recover all the windows so yeah

00:30:44,230 --> 00:30:47,110
if I if I'm silly enough to try to hit

00:30:45,880 --> 00:30:48,340
command W to close that one of these

00:30:47,110 --> 00:30:49,809
it's going to start it's gonna kick it

00:30:48,340 --> 00:30:51,700
off and there we go

00:30:49,809 --> 00:30:53,620
so you actually have to go by hand and

00:30:51,700 --> 00:30:58,750
mouse click on all the X's and hope hope

00:30:53,620 --> 00:31:02,049
that you don't miss yeah anyway so this

00:30:58,750 --> 00:31:04,090
oh did you hear that

00:31:02,049 --> 00:31:05,620
so I use the speech synthesis API to

00:31:04,090 --> 00:31:09,760
whenever I try to close a tab it

00:31:05,620 --> 00:31:13,590
actually says please don't go let me see

00:31:09,760 --> 00:31:13,590
if I could do that again Stan page

00:31:14,799 --> 00:31:17,980
all right

00:31:18,690 --> 00:31:22,660
[Music]

00:31:23,039 --> 00:31:32,499
I'm trying to exit it right now hold on

00:31:25,149 --> 00:31:34,119
okay okay cool it stopped all right and

00:31:32,499 --> 00:31:35,080
of course this works across browser to I

00:31:34,119 --> 00:31:40,600
can prove it you know I mean obviously

00:31:35,080 --> 00:31:42,940
it's gonna work here to frozen for some

00:31:40,600 --> 00:31:47,470
reason probably has trauma from the last

00:31:42,940 --> 00:31:50,590
time I did it okay this right now okay

00:31:47,470 --> 00:31:51,820
so anyway yeah so that's like that like

00:31:50,590 --> 00:31:58,450
that site is actually live on the

00:31:51,820 --> 00:32:01,690
annoying site calm so yeah you can send

00:31:58,450 --> 00:32:04,720
it to your friends today they won't be

00:32:01,690 --> 00:32:09,429
your friends afterwards so I actually

00:32:04,720 --> 00:32:11,409
sent this to the spammer and I think it

00:32:09,429 --> 00:32:15,519
was successful I never got any more spam

00:32:11,409 --> 00:32:18,489
from him and I have a few more demos I

00:32:15,519 --> 00:32:19,809
don't know if I have time I have to have

00:32:18,489 --> 00:32:22,419
like it maybe an extra two minutes to

00:32:19,809 --> 00:32:25,090
show for me or things okay cool alright

00:32:22,419 --> 00:32:26,379
okay cool so I have some other so this

00:32:25,090 --> 00:32:30,429
isn't I didn't add these to the annoying

00:32:26,379 --> 00:32:32,859
site but these are just sort of fun fun

00:32:30,429 --> 00:32:33,190
demos that I thought would be cool to

00:32:32,859 --> 00:32:37,480
show you

00:32:33,190 --> 00:32:39,639
so I think I think it's this one okay so

00:32:37,480 --> 00:32:41,679
one thing we can do with the move the

00:32:39,639 --> 00:32:43,539
window moving API is we can make like

00:32:41,679 --> 00:32:45,039
actually interesting games using the

00:32:43,539 --> 00:32:48,759
window using the windows so we can like

00:32:45,039 --> 00:32:50,559
have Windows that have physics so like

00:32:48,759 --> 00:32:53,350
if I actually if this was mine what

00:32:50,559 --> 00:32:56,669
happened there yeah so if I you can like

00:32:53,350 --> 00:32:56,669
play with it with my mouse

00:32:59,000 --> 00:33:02,520
it's really basic physics it's just

00:33:01,080 --> 00:33:04,800
gravity and then you know detecting the

00:33:02,520 --> 00:33:05,910
edges of the windows so I think it would

00:33:04,800 --> 00:33:08,250
be fun to make a game with this if

00:33:05,910 --> 00:33:10,560
anybody wants to like try to do this go

00:33:08,250 --> 00:33:12,000
for it then we can actually have really

00:33:10,560 --> 00:33:17,370
use cases for these API so that they

00:33:12,000 --> 00:33:19,070
can't take them away yeah so this is a

00:33:17,370 --> 00:33:21,450
fun one okay and then I have another one

00:33:19,070 --> 00:33:22,980
so this is a fun one so this one

00:33:21,450 --> 00:33:24,600
actually is a window which will find

00:33:22,980 --> 00:33:27,780
your mouse wherever it is and follow it

00:33:24,600 --> 00:33:29,910
around so if I if I move my mouse it

00:33:27,780 --> 00:33:31,680
tries to block whatever I'm doing so if

00:33:29,910 --> 00:33:32,550
I try to like close something up here

00:33:31,680 --> 00:33:34,830
you know it's gonna it's just gonna

00:33:32,550 --> 00:33:35,460
follow me around and try to block me and

00:33:34,830 --> 00:33:37,110
here's the best part

00:33:35,460 --> 00:33:39,600
if I move really fast and I escape the

00:33:37,110 --> 00:33:42,660
window look what it does it still finds

00:33:39,600 --> 00:33:44,490
me again so this is really explain how

00:33:42,660 --> 00:33:45,750
this works that's pretty cool so what's

00:33:44,490 --> 00:33:47,190
going on is every time we move my mouse

00:33:45,750 --> 00:33:49,140
and mouse move event is triggered and

00:33:47,190 --> 00:33:51,480
that will allow the window to recenter

00:33:49,140 --> 00:33:53,460
itself around the new position on the

00:33:51,480 --> 00:33:55,290
screen right but if I move really

00:33:53,460 --> 00:33:57,420
quickly and I leave the window then what

00:33:55,290 --> 00:33:59,160
happens is you know it's it's now not

00:33:57,420 --> 00:34:01,080
got a nice move event in awhile and so

00:33:59,160 --> 00:34:02,760
it realizes that it's lost the mouse and

00:34:01,080 --> 00:34:03,900
it needs to search for it and will

00:34:02,760 --> 00:34:04,950
notice it doing right now is you see how

00:34:03,900 --> 00:34:07,740
it's jumping back and forth left and

00:34:04,950 --> 00:34:08,940
right what is suing is it hasn't gotten

00:34:07,740 --> 00:34:10,560
a mouse move event in a while and so

00:34:08,940 --> 00:34:12,690
it's moving off the mouse and then

00:34:10,560 --> 00:34:14,040
moving back on the mouse and even though

00:34:12,690 --> 00:34:15,690
it's not the mouse that's moved it's the

00:34:14,040 --> 00:34:17,159
window that's moved under the mouse it

00:34:15,690 --> 00:34:18,510
still triggers a massive move event and

00:34:17,159 --> 00:34:19,860
so that allows this little

00:34:18,510 --> 00:34:21,300
back-and-forth motion allows me to

00:34:19,860 --> 00:34:23,010
detect that the mouse is still where I

00:34:21,300 --> 00:34:24,570
thought it was it just hasn't moved so I

00:34:23,010 --> 00:34:26,129
go off on oh it's still there okay cool

00:34:24,570 --> 00:34:27,659
stay there but it does this every so

00:34:26,129 --> 00:34:29,310
often and then but if I escape

00:34:27,659 --> 00:34:30,570
completely then it does a little back

00:34:29,310 --> 00:34:31,740
and forth and I can hear I can actually

00:34:30,570 --> 00:34:33,600
show you in slow motion so I have a

00:34:31,740 --> 00:34:35,159
version that runs at very much slower

00:34:33,600 --> 00:34:36,629
speeds so if I move the mouse you'll see

00:34:35,159 --> 00:34:37,800
it's gonna it's gonna follow the mouse

00:34:36,629 --> 00:34:41,250
this is running at much slower speed

00:34:37,800 --> 00:34:44,340
okay now if I hold still you'll see it's

00:34:41,250 --> 00:34:45,990
gonna go off on and it's like oh you're

00:34:44,340 --> 00:34:48,450
still there okay I'll stay here for a

00:34:45,990 --> 00:34:50,210
while and then I'll test again off on

00:34:48,450 --> 00:34:52,590
but now if I escape watch what happens

00:34:50,210 --> 00:34:54,480
it does basically like a binary search

00:34:52,590 --> 00:34:56,730
so it's gonna try the left half of it so

00:34:54,480 --> 00:34:57,990
it does back and forth it sees okay the

00:34:56,730 --> 00:34:59,400
mouse isn't there now so now I'm gonna

00:34:57,990 --> 00:35:01,320
try the left side of the screen and try

00:34:59,400 --> 00:35:01,800
the right side of the screen oh there

00:35:01,320 --> 00:35:04,430
you are

00:35:01,800 --> 00:35:04,430
found you

00:35:09,420 --> 00:35:12,480
cool

00:35:10,630 --> 00:35:15,430
alright last one since I'm out of time

00:35:12,480 --> 00:35:17,440
this one is okay I haven't actually told

00:35:15,430 --> 00:35:20,020
anyone about this one yet you guys are

00:35:17,440 --> 00:35:21,430
the first to see it and I'm I'm not

00:35:20,020 --> 00:35:23,079
gonna probably gonna show the code until

00:35:21,430 --> 00:35:26,230
I do something fun with it I'm gonna

00:35:23,079 --> 00:35:29,619
make a game with it but what I can do is

00:35:26,230 --> 00:35:31,720
with a single keyboard event I can open

00:35:29,619 --> 00:35:32,859
up an unlimited number of Windows not

00:35:31,720 --> 00:35:33,849
just one I can open up an unlimited

00:35:32,859 --> 00:35:38,200
number that's not supposed to be

00:35:33,849 --> 00:35:42,190
possible and yet Oh what happened

00:35:38,200 --> 00:35:44,109
Oh probably you might compete I don't

00:35:42,190 --> 00:35:55,300
know what's going on here this happened

00:35:44,109 --> 00:36:00,070
a moment ago two rows really unhappy

00:35:55,300 --> 00:36:02,290
with me oh it stopped there okay well

00:36:00,070 --> 00:36:05,730
anyway when it doesn't freeze it

00:36:02,290 --> 00:36:08,200
actually tiles the screen with Windows

00:36:05,730 --> 00:36:12,130
anyway that's it that's pretty much my

00:36:08,200 --> 00:36:13,450
talk if you want to reach out to me for

00:36:12,130 --> 00:36:14,950
us on Twitter I'm going to post my

00:36:13,450 --> 00:36:16,950
slides there afterwards and my websites

00:36:14,950 --> 00:36:23,290
frosted org thank you very much

00:36:16,950 --> 00:36:23,290

YouTube URL: https://www.youtube.com/watch?v=QFZ-pwErSl4


