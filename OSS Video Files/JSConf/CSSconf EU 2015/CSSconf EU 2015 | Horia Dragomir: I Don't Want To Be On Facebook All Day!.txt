Title: CSSconf EU 2015 | Horia Dragomir: I Don't Want To Be On Facebook All Day!
Publication date: 2015-09-26
Playlist: CSSconf EU 2015
Description: 
	Horia’s talk tells the story of building messenger.com. Horia will give us a glimpse into how CSS is used at Facebook, and how it worked both for and against the developers tasked with working on the first secondary domain: messenger.com. Contains cool CSS and a bit of React. You’ve been warned!

Horia is currently a UI Engineer at Facebook, and in the past has worked on everything from design to project management, in all sorts of organizations, from social gaming companies to investment banks.

http://2015.cssconf.eu/
Captions: 
	00:00:14,480 --> 00:00:23,789
hi and welcome back from lunch am I too

00:00:17,940 --> 00:00:27,330
loud yes no alright so let's talk about

00:00:23,789 --> 00:00:30,029
how we build messenger calm and if you

00:00:27,330 --> 00:00:33,120
don't know messengers calm is a full

00:00:30,029 --> 00:00:35,460
page react application on which you can

00:00:33,120 --> 00:00:39,149
send and receive facebook messenger

00:00:35,460 --> 00:00:40,590
messages um why would we build such a

00:00:39,149 --> 00:00:42,989
thing when you already have chat on

00:00:40,590 --> 00:00:44,250
facebook well when we launched it we

00:00:42,989 --> 00:00:47,280
gave all the reasons in the press

00:00:44,250 --> 00:00:49,980
release and they're so true something

00:00:47,280 --> 00:00:51,780
nice happen is a side effect a lot of

00:00:49,980 --> 00:00:54,570
corporations for instance block access

00:00:51,780 --> 00:00:55,649
to facebook on their corporate networks

00:00:54,570 --> 00:00:59,399
because they want people to be

00:00:55,649 --> 00:01:01,500
productive but they don't block access

00:00:59,399 --> 00:01:04,739
to messenger calm at least not yet so

00:01:01,500 --> 00:01:07,680
there's that but also we thought it

00:01:04,739 --> 00:01:10,979
would be very cool to build and how do I

00:01:07,680 --> 00:01:13,140
get to work on it I was just lucky I i

00:01:10,979 --> 00:01:16,009
joined facebook right about the time it

00:01:13,140 --> 00:01:18,330
was started and the web messages team

00:01:16,009 --> 00:01:21,750
pitched the project i liked it and i

00:01:18,330 --> 00:01:24,299
joined and I never looked back before we

00:01:21,750 --> 00:01:26,130
get into actual messenger com I want to

00:01:24,299 --> 00:01:28,860
take them over and talk about how we

00:01:26,130 --> 00:01:30,570
front in that facebook and I think it's

00:01:28,860 --> 00:01:34,140
time we use front-end as a verb it's

00:01:30,570 --> 00:01:38,369
hard to talk otherwise but as most

00:01:34,140 --> 00:01:40,200
companies do we use modules small

00:01:38,369 --> 00:01:42,630
components this is the thing that makes

00:01:40,200 --> 00:01:45,750
sense everyone knows everyone agrees I

00:01:42,630 --> 00:01:47,790
think how we make modules is the same as

00:01:45,750 --> 00:01:50,460
everyone else we will define one just

00:01:47,790 --> 00:01:53,040
messenger foo it lives in the file that

00:01:50,460 --> 00:01:55,350
has the same name messenger foo we just

00:01:53,040 --> 00:01:59,549
add this doc block to the beginning of

00:01:55,350 --> 00:02:01,380
the CSS file and ready to get started we

00:01:59,549 --> 00:02:04,320
had our rules but we have a special kind

00:02:01,380 --> 00:02:06,149
of syntax as you can see we use the name

00:02:04,320 --> 00:02:08,819
of the module and a slash and then the

00:02:06,149 --> 00:02:11,220
actual rule name this makes it very easy

00:02:08,819 --> 00:02:13,470
to whenever you look at the class name

00:02:11,220 --> 00:02:16,730
to know what it belongs to

00:02:13,470 --> 00:02:19,860
and we have it so that you can only use

00:02:16,730 --> 00:02:21,600
rules and class names that belong to

00:02:19,860 --> 00:02:24,510
this module over here so if we try to

00:02:21,600 --> 00:02:26,250
use messenger bar this will be a lint

00:02:24,510 --> 00:02:29,130
error why would you want to change

00:02:26,250 --> 00:02:32,280
messenger bar rules from with a

00:02:29,130 --> 00:02:33,660
messenger foo we do this for

00:02:32,280 --> 00:02:36,350
encapsulation purposes and to try to

00:02:33,660 --> 00:02:39,150
make our CSS components small and very

00:02:36,350 --> 00:02:41,850
focus on one thing so we can compose

00:02:39,150 --> 00:02:43,230
multiple if we need to however sometimes

00:02:41,850 --> 00:02:44,640
you do need to style something from

00:02:43,230 --> 00:02:47,670
another component so we have a thing

00:02:44,640 --> 00:02:49,620
called public classes we just define

00:02:47,670 --> 00:02:51,450
them in a way that you can use in a

00:02:49,620 --> 00:02:52,770
different module because sometimes you

00:02:51,450 --> 00:02:55,260
do need to style things differently

00:02:52,770 --> 00:02:57,840
depending on how you can post things but

00:02:55,260 --> 00:02:59,550
this will really make a lot of sense why

00:02:57,840 --> 00:03:02,150
would we always overwrite the public

00:02:59,550 --> 00:03:05,310
class of another module we just

00:03:02,150 --> 00:03:07,470
concatenate with our rule it's very

00:03:05,310 --> 00:03:09,540
simple it just takes some getting used

00:03:07,470 --> 00:03:11,730
to especially with a slash in the rule

00:03:09,540 --> 00:03:14,010
name which is not valid syntax I don't

00:03:11,730 --> 00:03:16,200
think well you don't even need to use

00:03:14,010 --> 00:03:18,300
all that a simple rule like that is all

00:03:16,200 --> 00:03:19,830
you need for a mile to exist we don't

00:03:18,300 --> 00:03:21,269
even need a rule you just need to put

00:03:19,830 --> 00:03:24,180
the module there and everything will be

00:03:21,269 --> 00:03:26,640
public and it is how we would use it in

00:03:24,180 --> 00:03:29,640
JavaScript we have a simple mark

00:03:26,640 --> 00:03:31,290
messenger foo react component we have an

00:03:29,640 --> 00:03:35,220
h1 and we want to just use the title

00:03:31,290 --> 00:03:37,680
class name on it we just right you know

00:03:35,220 --> 00:03:39,630
react does anyone here use react I'm

00:03:37,680 --> 00:03:44,519
sure you do yes there we go put your

00:03:39,630 --> 00:03:46,320
hands down but we can do more complex

00:03:44,519 --> 00:03:48,780
things instead of saying just use this

00:03:46,320 --> 00:03:51,660
class name we can pass it some JSON and

00:03:48,780 --> 00:03:53,459
this in this JSON the property names are

00:03:51,660 --> 00:03:56,280
the actual class names that we want to

00:03:53,459 --> 00:03:58,290
use and the values are booleans and the

00:03:56,280 --> 00:04:01,799
signal whether or not to include this

00:03:58,290 --> 00:04:04,470
class in the class list and let's focus

00:04:01,799 --> 00:04:10,380
on the the weird thing over there that's

00:04:04,470 --> 00:04:12,780
CX CX is our class transform function it

00:04:10,380 --> 00:04:14,790
serves multiple purposes for one thing

00:04:12,780 --> 00:04:16,830
it actually evaluates the logic of which

00:04:14,790 --> 00:04:20,310
classes to include based on the boolean

00:04:16,830 --> 00:04:23,640
values for jasons but it's always there

00:04:20,310 --> 00:04:25,780
we always have to use it so we know that

00:04:23,640 --> 00:04:28,810
we can search for it

00:04:25,780 --> 00:04:31,060
and we look for instances of CX and we

00:04:28,810 --> 00:04:32,950
find out which modules do we need to

00:04:31,060 --> 00:04:35,740
include in this case we need to include

00:04:32,950 --> 00:04:38,620
messenger foo and messenger bar that CSS

00:04:35,740 --> 00:04:39,700
these two modules and we do this not at

00:04:38,620 --> 00:04:41,950
runtime because that will be very

00:04:39,700 --> 00:04:45,700
inefficient we do this through static

00:04:41,950 --> 00:04:47,320
analysis at build time we just parts all

00:04:45,700 --> 00:04:49,600
our JavaScript files and we see which

00:04:47,320 --> 00:04:51,340
modules are being referenced and then

00:04:49,600 --> 00:04:53,800
whenever the module will be loaded we

00:04:51,340 --> 00:04:56,260
already have the CSS loaded side by side

00:04:53,800 --> 00:04:58,780
with it it's on a package and all

00:04:56,260 --> 00:05:01,530
required and this is great because you

00:04:58,780 --> 00:05:04,840
never forget to include your modules and

00:05:01,530 --> 00:05:08,110
it saves you love you know time hassled

00:05:04,840 --> 00:05:11,169
debugging effort and this enables us to

00:05:08,110 --> 00:05:13,630
do very cool things that have to do with

00:05:11,169 --> 00:05:16,120
the two modes and now I'm not talking

00:05:13,630 --> 00:05:18,970
about you read software more than you

00:05:16,120 --> 00:05:20,470
write software even when you're writing

00:05:18,970 --> 00:05:22,990
software or when you're reading software

00:05:20,470 --> 00:05:25,630
a code or when you're debugging it

00:05:22,990 --> 00:05:27,130
you're still in the human mode it's you

00:05:25,630 --> 00:05:29,740
interacting with the code that you or

00:05:27,130 --> 00:05:32,500
somebody else is written the other mode

00:05:29,740 --> 00:05:34,660
is the Machine mode is the machine when

00:05:32,500 --> 00:05:38,490
it executes your code and it has to do

00:05:34,660 --> 00:05:41,380
something with has to understand it our

00:05:38,490 --> 00:05:43,240
our static strength our static tools our

00:05:41,380 --> 00:05:44,560
psyche transforms and analysis allow us

00:05:43,240 --> 00:05:46,350
to do things there are good both for

00:05:44,560 --> 00:05:49,539
humans and for machines for instance

00:05:46,350 --> 00:05:52,150
this is all we need to type to get all

00:05:49,539 --> 00:05:55,000
the prefixes these get added at build

00:05:52,150 --> 00:05:57,460
time automatically this is an

00:05:55,000 --> 00:05:59,350
optimization done for humans it's very

00:05:57,460 --> 00:06:01,240
unpleasant to have to type these manuals

00:05:59,350 --> 00:06:03,460
I'm sure you know and you'll use prefix

00:06:01,240 --> 00:06:04,960
free or something of the sort we go a

00:06:03,460 --> 00:06:07,150
step further we also optimized for

00:06:04,960 --> 00:06:11,169
machine at this level as well more or

00:06:07,150 --> 00:06:13,750
less when a person loads our page they

00:06:11,169 --> 00:06:17,110
load it with a browser so if I'm using

00:06:13,750 --> 00:06:19,630
Firefox and I load messenger com why

00:06:17,110 --> 00:06:21,370
would I get the MS transform and the

00:06:19,630 --> 00:06:22,840
WebKit transform declarations they make

00:06:21,370 --> 00:06:25,180
no sense the browser will ignore them

00:06:22,840 --> 00:06:27,940
they're wasted bites we actually don't

00:06:25,180 --> 00:06:29,440
even send them we look at what browser

00:06:27,940 --> 00:06:31,660
you're using and we only send you the

00:06:29,440 --> 00:06:33,310
rules that you will understand which is

00:06:31,660 --> 00:06:36,450
very cool because this saves a lot of

00:06:33,310 --> 00:06:39,320
bites and bites save energy in fact I

00:06:36,450 --> 00:06:41,210
estimated just by this thing

00:06:39,320 --> 00:06:43,430
we save enough energy which is

00:06:41,210 --> 00:06:45,620
equivalent to about half a Hiroshima

00:06:43,430 --> 00:06:49,700
every day to put it in a different

00:06:45,620 --> 00:06:52,430
perspective it's enough energy to warm

00:06:49,700 --> 00:06:56,800
up this room to a temperature of 214

00:06:52,430 --> 00:06:59,210
cats for about a week that's a lot

00:06:56,800 --> 00:07:02,180
another thing we do and this is actually

00:06:59,210 --> 00:07:06,500
a pet peeve of mine it doesn't matter if

00:07:02,180 --> 00:07:08,720
an element is 0 pixels or 0% or zero

00:07:06,500 --> 00:07:10,790
elephants from the right it's smack on

00:07:08,720 --> 00:07:13,250
the right we don't need the unit there

00:07:10,790 --> 00:07:16,310
we actually do remove it the static

00:07:13,250 --> 00:07:19,700
analysis and this again saves bytes

00:07:16,310 --> 00:07:22,430
white save energy this simple say by

00:07:19,700 --> 00:07:24,170
removing the unit from zero allows 200

00:07:22,430 --> 00:07:28,730
stray cats to find a new home every

00:07:24,170 --> 00:07:31,330
single day that's my estimation and this

00:07:28,730 --> 00:07:34,220
managing is something we do for machines

00:07:31,330 --> 00:07:37,190
because I am a human I'm sure your human

00:07:34,220 --> 00:07:40,100
as well most of you and we need

00:07:37,190 --> 00:07:42,470
something like this we need a rule that

00:07:40,100 --> 00:07:44,480
makes sense when you read it this is the

00:07:42,470 --> 00:07:48,170
title rule belonging to the messenger

00:07:44,480 --> 00:07:51,770
for component a machine doesn't care a

00:07:48,170 --> 00:07:54,160
machine needs a unique string so why not

00:07:51,770 --> 00:07:56,900
make it something very very short a

00:07:54,160 --> 00:07:58,580
machine will do just fine and we never

00:07:56,900 --> 00:08:00,890
have to read this this just happens

00:07:58,580 --> 00:08:05,540
between machines so back to our

00:08:00,890 --> 00:08:08,150
JavaScript example this whole thing gets

00:08:05,540 --> 00:08:10,990
evaluated and say we also have the

00:08:08,150 --> 00:08:13,430
subtitle it will be those two classes

00:08:10,990 --> 00:08:16,190
but this is after build time when this

00:08:13,430 --> 00:08:17,780
actually runs so it's not that big long

00:08:16,190 --> 00:08:20,660
string in the class this is just

00:08:17,780 --> 00:08:23,410
something small like this now the

00:08:20,660 --> 00:08:27,410
compound savings from all these bites

00:08:23,410 --> 00:08:29,810
arteries are enough to boil all the

00:08:27,410 --> 00:08:32,120
coffee that has and ever will be

00:08:29,810 --> 00:08:35,810
consumed that all the CSS cons would

00:08:32,120 --> 00:08:37,550
ever ever happen but we're not over I

00:08:35,810 --> 00:08:40,700
mean this is just writing and maybe

00:08:37,550 --> 00:08:42,650
debugging a but yes we're shipping code

00:08:40,700 --> 00:08:43,880
we're shipping our code to the the users

00:08:42,650 --> 00:08:46,610
and they're loading in their browsers

00:08:43,880 --> 00:08:48,560
but we're not done we have another thing

00:08:46,610 --> 00:08:49,970
it's called machine learning which we

00:08:48,560 --> 00:08:52,490
can use we have this cool thing called

00:08:49,970 --> 00:08:53,030
packager and remember how we reference

00:08:52,490 --> 00:08:56,060
to

00:08:53,030 --> 00:08:58,730
ss modules in our example messenger foo

00:08:56,060 --> 00:09:00,380
and messenger bar well packager we'll

00:08:58,730 --> 00:09:02,840
look at how messenger full and messenger

00:09:00,380 --> 00:09:05,750
bar are loaded especially in relation to

00:09:02,840 --> 00:09:07,310
messenger food out Jas and we'll see

00:09:05,750 --> 00:09:09,500
that whenever we request messenger foo

00:09:07,310 --> 00:09:11,540
we also request messenger bar so it

00:09:09,500 --> 00:09:14,690
makes sense to turn these two files into

00:09:11,540 --> 00:09:17,150
one single file and the file name will

00:09:14,690 --> 00:09:19,460
also be very small again fewer bytes and

00:09:17,150 --> 00:09:24,130
fewer bytes and this is these are just

00:09:19,460 --> 00:09:28,220
randomly generated hashes but even even

00:09:24,130 --> 00:09:31,610
machines can make mistakes two weeks ago

00:09:28,220 --> 00:09:35,780
or so this file was generated based on

00:09:31,610 --> 00:09:38,810
packagers heuristics and I'm sure some

00:09:35,780 --> 00:09:42,170
of you already see the problem some

00:09:38,810 --> 00:09:44,540
people couldn't chat for a considerable

00:09:42,170 --> 00:09:46,490
amount of time because ad blockers

00:09:44,540 --> 00:09:48,140
thought this was an ad when in fact it

00:09:46,490 --> 00:09:52,040
was just a couple of our modules that we

00:09:48,140 --> 00:09:56,480
kind of need for chats work machines are

00:09:52,040 --> 00:09:58,370
silly but that's why we're here and here

00:09:56,480 --> 00:10:00,440
today yesterday and just in general

00:09:58,370 --> 00:10:01,850
people ask me a lot whether we use less

00:10:00,440 --> 00:10:04,520
or SAS and which one would prefer at

00:10:01,850 --> 00:10:08,390
Facebook or do we use tieless we use

00:10:04,520 --> 00:10:10,610
nothing because using one of these make

00:10:08,390 --> 00:10:12,830
it harder for people who just start to

00:10:10,610 --> 00:10:15,020
get into the groove anyone who's ever

00:10:12,830 --> 00:10:18,110
written a web page can work at Facebook

00:10:15,020 --> 00:10:19,640
and they instantly know everything they

00:10:18,110 --> 00:10:23,510
do need to know to be able to be

00:10:19,640 --> 00:10:25,550
efficient we use plain old CSS however

00:10:23,510 --> 00:10:28,100
we do have the static analysis and style

00:10:25,550 --> 00:10:29,720
transform step in our build system so we

00:10:28,100 --> 00:10:31,850
can do some funny things we use

00:10:29,720 --> 00:10:33,170
variables of course we call him

00:10:31,850 --> 00:10:36,110
constants though because they're not

00:10:33,170 --> 00:10:41,390
really variable and this is how you use

00:10:36,110 --> 00:10:42,920
a constant what it's a bar but anyway it

00:10:41,390 --> 00:10:45,530
builds stuff we will replace it with his

00:10:42,920 --> 00:10:48,680
actual value this is great so you don't

00:10:45,530 --> 00:10:50,990
have to always remember you know fo six

00:10:48,680 --> 00:10:54,080
for a magenta you can just say messenger

00:10:50,990 --> 00:10:57,350
magenta and that will be great now the

00:10:54,080 --> 00:11:00,500
rule that you have to use to you know to

00:10:57,350 --> 00:11:03,140
go from a actual explicit hex value to a

00:11:00,500 --> 00:11:06,470
constant or after how many repetitions

00:11:03,140 --> 00:11:07,970
do you use that the rule

00:11:06,470 --> 00:11:10,190
I still don't know it but I'll find out

00:11:07,970 --> 00:11:12,710
and I'll tell you but that's enough

00:11:10,190 --> 00:11:15,530
about how we we actually you know ship

00:11:12,710 --> 00:11:18,290
code I think you got a pretty okay idea

00:11:15,530 --> 00:11:20,690
of what happens hopefully otherwise

00:11:18,290 --> 00:11:23,420
let's talk later but let's get back to

00:11:20,690 --> 00:11:25,700
messenger calm because it all actually

00:11:23,420 --> 00:11:28,430
started a long time ago when we rewrote

00:11:25,700 --> 00:11:30,650
chat the facebook chat with this in a

00:11:28,430 --> 00:11:33,230
very special way we thought let's make

00:11:30,650 --> 00:11:34,880
some components that have no styling

00:11:33,230 --> 00:11:36,980
they just get the data they need and

00:11:34,880 --> 00:11:39,800
then we have different components that

00:11:36,980 --> 00:11:42,410
will present the data this is not a new

00:11:39,800 --> 00:11:45,050
concept but we decided to apply this

00:11:42,410 --> 00:11:47,060
religiously through chat we call these

00:11:45,050 --> 00:11:49,490
Stalag gnostic components containers and

00:11:47,060 --> 00:11:51,580
everything is a container and needs a

00:11:49,490 --> 00:11:54,560
presenter to actually display the data

00:11:51,580 --> 00:11:56,150
so you wrap a you know a normal

00:11:54,560 --> 00:11:57,980
presenter in a container and you wrap

00:11:56,150 --> 00:11:59,390
that you know what multiple lists of

00:11:57,980 --> 00:12:02,180
them in another container and so on you

00:11:59,390 --> 00:12:03,920
go up and go up we call this shawarma

00:12:02,180 --> 00:12:07,850
driven development because everything is

00:12:03,920 --> 00:12:09,890
a rap as a simple example let's say we

00:12:07,850 --> 00:12:11,960
would hypothetically have a list of

00:12:09,890 --> 00:12:15,920
recent conversations that we'll just

00:12:11,960 --> 00:12:18,140
call the style agnostic threadless we

00:12:15,920 --> 00:12:20,060
give us some parameters we give it a

00:12:18,140 --> 00:12:21,860
presenter which is something again we

00:12:20,060 --> 00:12:24,440
control and we give it a class name just

00:12:21,860 --> 00:12:26,720
so we have a hook so we can use its

00:12:24,440 --> 00:12:29,450
public classes to style things and we're

00:12:26,720 --> 00:12:31,940
done it goes down one level it calls the

00:12:29,450 --> 00:12:34,130
class the component we pass in and then

00:12:31,940 --> 00:12:37,400
again we for every conversation we just

00:12:34,130 --> 00:12:39,890
add a new container pass down to how the

00:12:37,400 --> 00:12:43,600
classes have the hooks and so on until

00:12:39,890 --> 00:12:45,860
we have the whole tree shawarma and

00:12:43,600 --> 00:12:48,080
because this was a new thing right this

00:12:45,860 --> 00:12:50,450
is facebook com and facebook com has

00:12:48,080 --> 00:12:52,010
been there for a while we believe that

00:12:50,450 --> 00:12:53,930
everybody should be able to use facebook

00:12:52,010 --> 00:12:56,590
so we support a large amount of browsers

00:12:53,930 --> 00:12:59,150
but messenger come was a new thing and

00:12:56,590 --> 00:13:00,710
by definition it is niche it's people

00:12:59,150 --> 00:13:02,780
who really want to use messenger and

00:13:00,710 --> 00:13:04,550
they want to have a nice environment to

00:13:02,780 --> 00:13:07,730
do so and Icefall this type of

00:13:04,550 --> 00:13:09,380
environment so we decided to not support

00:13:07,730 --> 00:13:11,720
the old browsers and that meant we could

00:13:09,380 --> 00:13:14,210
use the new CSS stuff we were finally

00:13:11,720 --> 00:13:16,970
free to use flex box and suffolk CSS

00:13:14,210 --> 00:13:19,880
grid for layout and whatnot except we

00:13:16,970 --> 00:13:22,070
weren't because we want to

00:13:19,880 --> 00:13:25,940
have something that looks like this and

00:13:22,070 --> 00:13:28,850
with a CSS only solution it didn't work

00:13:25,940 --> 00:13:32,030
out that well as Leah mentioned in her

00:13:28,850 --> 00:13:34,220
talk just having the CSS only solution

00:13:32,030 --> 00:13:35,780
doesn't help you is just so you can say

00:13:34,220 --> 00:13:37,910
that you have it but it doesn't do

00:13:35,780 --> 00:13:40,310
anything else than be and sometimes it's

00:13:37,910 --> 00:13:42,410
wrong as well so instead of using

00:13:40,310 --> 00:13:44,720
flexbox and CSS to it we went back to

00:13:42,410 --> 00:13:47,660
using an old component of ours it's a

00:13:44,720 --> 00:13:51,020
layout component and it is JavaScript

00:13:47,660 --> 00:13:53,300
based but it's battle-tested we've been

00:13:51,020 --> 00:13:54,980
using this for a long time we figured

00:13:53,300 --> 00:13:59,120
out the bugs people who are much smarter

00:13:54,980 --> 00:14:01,400
than me fix the bugs and we ship with

00:13:59,120 --> 00:14:03,680
this and later after it was ship when we

00:14:01,400 --> 00:14:06,080
had more time we went back and found out

00:14:03,680 --> 00:14:08,510
what was wrong with flexbox it turns out

00:14:06,080 --> 00:14:09,980
that because flexbox has changed so much

00:14:08,510 --> 00:14:11,510
over time it's you know its

00:14:09,980 --> 00:14:15,830
specification and all that and the

00:14:11,510 --> 00:14:17,150
standard it still isn't we had some

00:14:15,830 --> 00:14:20,270
static transform tools that were

00:14:17,150 --> 00:14:21,680
conflicting with each other and chrome

00:14:20,270 --> 00:14:24,290
would sometimes get the new version of

00:14:21,680 --> 00:14:25,730
flexbox automatically transform but for

00:14:24,290 --> 00:14:28,190
Safari you would get the old version

00:14:25,730 --> 00:14:30,020
with the WebKit box and of course that

00:14:28,190 --> 00:14:33,410
wouldn't work well what once you figure

00:14:30,020 --> 00:14:35,540
out those issues it was okay except for

00:14:33,410 --> 00:14:37,460
you know Internet Explorer because

00:14:35,540 --> 00:14:41,420
engine explore is to need to specify ms

00:14:37,460 --> 00:14:42,920
flex in a 1 10 pixels and it needs to

00:14:41,420 --> 00:14:44,630
have pixels there because if you just

00:14:42,920 --> 00:14:46,310
say 0 it doesn't know that it doesn't

00:14:44,630 --> 00:14:49,250
know what you mean I remember our rule

00:14:46,310 --> 00:14:50,660
that strips away the unit from pixels so

00:14:49,250 --> 00:14:53,650
we just added a couple of exceptions and

00:14:50,660 --> 00:14:55,550
we were fine to go with flexbox flexbox

00:14:53,650 --> 00:14:59,120
well we weren't out of the woods yet

00:14:55,550 --> 00:15:01,250
because it's a bit product even though

00:14:59,120 --> 00:15:03,830
it's it sounds simple it actually has

00:15:01,250 --> 00:15:07,280
very many moving parts the shawarma wrap

00:15:03,830 --> 00:15:10,250
is very deep and I'm sure you can see

00:15:07,280 --> 00:15:13,820
the problem with this and if you miss it

00:15:10,250 --> 00:15:17,710
let me blow it up for you as you're

00:15:13,820 --> 00:15:20,930
typing in a right-to-left language and

00:15:17,710 --> 00:15:24,490
you type in comma space as you do to add

00:15:20,930 --> 00:15:26,860
a comma the college's jumps

00:15:24,490 --> 00:15:28,360
this is weird we never understood why

00:15:26,860 --> 00:15:30,580
and we spend a lot of time just

00:15:28,360 --> 00:15:33,450
debugging why this happened we thought

00:15:30,580 --> 00:15:35,920
were supposed to some old archaic

00:15:33,450 --> 00:15:40,330
components that we weren't including by

00:15:35,920 --> 00:15:42,279
mistake but it turned out that it was

00:15:40,330 --> 00:15:44,230
our over optimization as many websites

00:15:42,279 --> 00:15:46,330
as many web applications we have just

00:15:44,230 --> 00:15:47,589
one font definition it's a font family

00:15:46,330 --> 00:15:50,670
we have a fun stack and everything's

00:15:47,589 --> 00:15:52,810
fine we were using helvetica neue

00:15:50,670 --> 00:15:54,190
Helvetica neue actually has this problem

00:15:52,810 --> 00:15:56,080
that if you're typing in right to left

00:15:54,190 --> 00:15:59,080
and you've having a character character

00:15:56,080 --> 00:16:01,209
character comma space character space

00:15:59,080 --> 00:16:03,520
and comma will just invert and that

00:16:01,209 --> 00:16:06,190
looks very horrible if you're a user

00:16:03,520 --> 00:16:09,760
that you know speaks in a right-to-left

00:16:06,190 --> 00:16:12,610
written language so instead of using her

00:16:09,760 --> 00:16:14,080
veticon know which is the cool thing we

00:16:12,610 --> 00:16:15,490
detected if you're using right to left

00:16:14,080 --> 00:16:17,529
we don't want you to have a better

00:16:15,490 --> 00:16:21,580
experience so we just fall back to REO

00:16:17,529 --> 00:16:23,890
REO the old boring REO but the old

00:16:21,580 --> 00:16:25,570
boring battle-tested area which has been

00:16:23,890 --> 00:16:29,200
improved over time and works well with

00:16:25,570 --> 00:16:30,339
anything you throw at it and this was

00:16:29,200 --> 00:16:32,640
just something that we just happen to

00:16:30,339 --> 00:16:34,839
find out Helvetica neue has this problem

00:16:32,640 --> 00:16:39,940
but there are some things within

00:16:34,839 --> 00:16:42,399
facebook that got in our way java

00:16:39,940 --> 00:16:45,940
subcomponents really like pixels as size

00:16:42,399 --> 00:16:48,959
dimensions as they should but remember

00:16:45,940 --> 00:16:51,100
we're a full page application pixels

00:16:48,959 --> 00:16:53,620
don't work well because you resize the

00:16:51,100 --> 00:16:56,380
page a lot you might want to dock it to

00:16:53,620 --> 00:16:58,899
the lift and not only that but we need

00:16:56,380 --> 00:17:00,279
to accurately display what you have sent

00:16:58,899 --> 00:17:02,770
to the other person with which you're

00:17:00,279 --> 00:17:04,809
talking if you send them an image we

00:17:02,770 --> 00:17:08,350
need to display like this or if you send

00:17:04,809 --> 00:17:11,740
more images each case has a different

00:17:08,350 --> 00:17:14,740
grid on different sizing and we need to

00:17:11,740 --> 00:17:16,150
kind of make it look nice and if we try

00:17:14,740 --> 00:17:17,890
to stretch images they will look

00:17:16,150 --> 00:17:20,650
horrible and we needed a different

00:17:17,890 --> 00:17:24,189
approach also they're always about

00:17:20,650 --> 00:17:27,250
roughly half of the other conversation

00:17:24,189 --> 00:17:29,740
window even if they're six or just one

00:17:27,250 --> 00:17:30,970
in short we needed to be responsive and

00:17:29,740 --> 00:17:35,860
that's very hard to do if you're using

00:17:30,970 --> 00:17:38,880
pixels so we had to add our own

00:17:35,860 --> 00:17:41,800
containers again just so we could

00:17:38,880 --> 00:17:44,140
use different CSS classes that were

00:17:41,800 --> 00:17:46,060
based on percentages and we couldn't use

00:17:44,140 --> 00:17:47,560
a lot of the building blocks that people

00:17:46,060 --> 00:17:50,950
on facebook com use out of the box

00:17:47,560 --> 00:17:52,710
because they only work with pixels still

00:17:50,950 --> 00:17:55,390
though we have four break points oh

00:17:52,710 --> 00:17:58,660
that's not a lot but it's kind of a lot

00:17:55,390 --> 00:18:01,180
because it's four and we change small

00:17:58,660 --> 00:18:03,730
things that every one of them the bigger

00:18:01,180 --> 00:18:06,340
thing that you'll notice is the right

00:18:03,730 --> 00:18:07,840
hand side information panel if we detect

00:18:06,340 --> 00:18:09,730
that we don't that you don't have enough

00:18:07,840 --> 00:18:11,260
space to comfortably displayed and also

00:18:09,730 --> 00:18:12,610
view the conversation will just

00:18:11,260 --> 00:18:14,380
automatically close it for you you can

00:18:12,610 --> 00:18:16,990
still open it if you want we have the

00:18:14,380 --> 00:18:19,030
button and again if as you expand and

00:18:16,990 --> 00:18:22,240
you have more space we automatically

00:18:19,030 --> 00:18:23,590
open it for you actually the day we

00:18:22,240 --> 00:18:25,600
released we got featured on good

00:18:23,590 --> 00:18:28,480
products as you do and a person

00:18:25,600 --> 00:18:32,410
literally spent enough time resizing is

00:18:28,480 --> 00:18:34,750
browser window back-engineering how we

00:18:32,410 --> 00:18:37,060
what the rules for this are and he was

00:18:34,750 --> 00:18:38,650
so impressed that we took the time to do

00:18:37,060 --> 00:18:41,530
this but this is actually something very

00:18:38,650 --> 00:18:43,300
simple it makes a big difference but

00:18:41,530 --> 00:18:45,160
it's something simple you can do but if

00:18:43,300 --> 00:18:48,240
something is very in your face you can

00:18:45,160 --> 00:18:50,920
also be responsive at a smaller scale

00:18:48,240 --> 00:18:53,890
titles and messenger even on your phone

00:18:50,920 --> 00:18:55,510
app are there centered so we Center the

00:18:53,890 --> 00:18:57,220
page title which is messenger but we

00:18:55,510 --> 00:19:00,340
also Center the conversation title in

00:18:57,220 --> 00:19:03,480
this case it's an unnamed group between

00:19:00,340 --> 00:19:05,740
me and two other people with long names

00:19:03,480 --> 00:19:10,060
what if you want to dock your window to

00:19:05,740 --> 00:19:11,950
the left of your screen truncating

00:19:10,060 --> 00:19:13,600
centered text is weird especially if you

00:19:11,950 --> 00:19:15,550
have icons on the other side because

00:19:13,600 --> 00:19:17,800
they will take up space on evenly and

00:19:15,550 --> 00:19:20,440
we'll just look weird and you can't do

00:19:17,800 --> 00:19:22,150
it you can't use a CSS only solution for

00:19:20,440 --> 00:19:23,770
this because it's not dependent on the

00:19:22,150 --> 00:19:26,530
size of the viewport is depend on the

00:19:23,770 --> 00:19:27,880
size of the name and the element that

00:19:26,530 --> 00:19:30,580
contains in the name and not even

00:19:27,880 --> 00:19:32,560
element query if we ever get it will

00:19:30,580 --> 00:19:33,940
help us here for this you need of a

00:19:32,560 --> 00:19:36,310
hybrid solution you need to measure the

00:19:33,940 --> 00:19:37,900
size of the text and measure the size of

00:19:36,310 --> 00:19:40,000
the container and when there's not

00:19:37,900 --> 00:19:42,010
enough room just change a class named

00:19:40,000 --> 00:19:45,250
float everything to the left and apply a

00:19:42,010 --> 00:19:47,740
truncation if you need to now we do a

00:19:45,250 --> 00:19:49,360
lot of these small things on break

00:19:47,740 --> 00:19:52,060
points or when we detect that you don't

00:19:49,360 --> 00:19:54,250
have enough space just so everything

00:19:52,060 --> 00:19:56,110
nicely and looks nicely it's supposed to

00:19:54,250 --> 00:19:58,660
be an app that's on par with the native

00:19:56,110 --> 00:20:00,540
experience and that means you need to do

00:19:58,660 --> 00:20:04,720
a lot of these little polishing and

00:20:00,540 --> 00:20:07,450
speaking of polishing and how we know

00:20:04,720 --> 00:20:10,330
titles messenger are centered that's an

00:20:07,450 --> 00:20:14,980
interface guide and we have an interface

00:20:10,330 --> 00:20:17,200
guy for facebook now please please tell

00:20:14,980 --> 00:20:20,350
me you know what this is just say what

00:20:17,200 --> 00:20:23,020
it is yes it's a fig right the Facebook

00:20:20,350 --> 00:20:25,840
interface guy to fig I showed this to

00:20:23,020 --> 00:20:30,100
Americans and they just had no idea what

00:20:25,840 --> 00:20:31,900
it was they had not seen figs I went hot

00:20:30,100 --> 00:20:34,030
air ballooning and the person though the

00:20:31,900 --> 00:20:36,670
pilot dropped the balloon so we could

00:20:34,030 --> 00:20:39,010
just brush against some walnut trees you

00:20:36,670 --> 00:20:40,180
know walnuts and he said you know if you

00:20:39,010 --> 00:20:41,770
reach how you can actually grab some

00:20:40,180 --> 00:20:44,320
walnut so I did and I grabbed the walnut

00:20:41,770 --> 00:20:46,240
and was all still green and only me and

00:20:44,320 --> 00:20:48,010
the pilot knew that that's what walnuts

00:20:46,240 --> 00:20:49,570
looked like Americans are weird they

00:20:48,010 --> 00:20:51,070
don't know what fruit looks like in any

00:20:49,570 --> 00:20:52,660
case that's the fig that's the facebook

00:20:51,070 --> 00:20:54,760
in your face guide and we have a

00:20:52,660 --> 00:20:57,520
different product it's a messenger thing

00:20:54,760 --> 00:21:01,570
so you get the reference i'm trying to

00:20:57,520 --> 00:21:05,350
make we have the mig the messenger

00:21:01,570 --> 00:21:07,240
interface guide and that's just a visual

00:21:05,350 --> 00:21:09,250
style guide of how things should look

00:21:07,240 --> 00:21:12,370
like a different combinations and all

00:21:09,250 --> 00:21:13,840
that normally it's made by a designer we

00:21:12,370 --> 00:21:16,240
found that it's a lot better to be made

00:21:13,840 --> 00:21:17,740
by people who are working on the product

00:21:16,240 --> 00:21:19,540
not just the design is not just the

00:21:17,740 --> 00:21:21,940
developers with everybody involved

00:21:19,540 --> 00:21:23,290
because some things make sense the

00:21:21,940 --> 00:21:25,060
designers somethings are very cool to

00:21:23,290 --> 00:21:26,590
design two designers but don't make

00:21:25,060 --> 00:21:29,290
sense to implement or just don't make

00:21:26,590 --> 00:21:31,560
sense for people to use in any case we

00:21:29,290 --> 00:21:33,700
took some of the facebook components and

00:21:31,560 --> 00:21:37,830
turn them into our own components

00:21:33,700 --> 00:21:40,120
remember how when Chad was rewritten

00:21:37,830 --> 00:21:42,370
everything was a container and a

00:21:40,120 --> 00:21:45,820
presenter that's kind of how we do

00:21:42,370 --> 00:21:47,410
components everywhere we have an

00:21:45,820 --> 00:21:50,170
abstract thing and something that gives

00:21:47,410 --> 00:21:51,760
a presentation and we were able to take

00:21:50,170 --> 00:21:54,070
the Facebook button turn into a

00:21:51,760 --> 00:21:57,160
messenger button which looks a lot like

00:21:54,070 --> 00:21:59,200
a button I know I'm sorry but you can

00:21:57,160 --> 00:22:01,270
see you know facebook facebook on the

00:21:59,200 --> 00:22:03,190
left messenger on the right even though

00:22:01,270 --> 00:22:05,380
it's the same component underneath and

00:22:03,190 --> 00:22:06,010
that's great because the facebook

00:22:05,380 --> 00:22:07,480
components

00:22:06,010 --> 00:22:09,340
have undergone a lot of work to make

00:22:07,480 --> 00:22:12,820
them accessible you have we have a lot

00:22:09,340 --> 00:22:14,200
of customization for Aria roles and for

00:22:12,820 --> 00:22:16,060
screen readers to be able to properly

00:22:14,200 --> 00:22:18,280
detect them and their states and we

00:22:16,060 --> 00:22:20,590
wanted to get all that good stuff over

00:22:18,280 --> 00:22:24,310
the messenger I want to take just a

00:22:20,590 --> 00:22:26,380
short time to emphasize accessibility we

00:22:24,310 --> 00:22:28,960
need more of this doesn't matter if it

00:22:26,380 --> 00:22:33,190
looks good if you can't see it you need

00:22:28,960 --> 00:22:35,380
to be able to use something and another

00:22:33,190 --> 00:22:38,230
thing that's bad also focus ability but

00:22:35,380 --> 00:22:41,500
just bad as an element is my new

00:22:38,230 --> 00:22:45,970
favorite element the hate lets the image

00:22:41,500 --> 00:22:47,860
tag let's go back to this example the

00:22:45,970 --> 00:22:51,400
images here are you know the basically

00:22:47,860 --> 00:22:52,870
shawarmas but they're each a different

00:22:51,400 --> 00:22:54,910
image but we need to display them in a

00:22:52,870 --> 00:22:56,530
nice grid if we would have a jagged

00:22:54,910 --> 00:22:58,060
thing it would be horrible if we display

00:22:56,530 --> 00:22:59,530
them one by one it would take up too

00:22:58,060 --> 00:23:03,070
much space and use your contacts of your

00:22:59,530 --> 00:23:05,020
conversation so we need to you know

00:23:03,070 --> 00:23:07,570
sighs them evenly which is not always

00:23:05,020 --> 00:23:09,790
possible with image tags if you also

00:23:07,570 --> 00:23:13,420
want to make the images look nice and

00:23:09,790 --> 00:23:14,560
then we have other use cases where with

00:23:13,420 --> 00:23:16,200
your share a link will show you a

00:23:14,560 --> 00:23:18,280
preview of what that link is and

00:23:16,200 --> 00:23:21,040
sometimes the link will have a thumbnail

00:23:18,280 --> 00:23:25,570
in this case yes hot-plug that's me I'm

00:23:21,040 --> 00:23:28,420
sexy but I have a square image as my

00:23:25,570 --> 00:23:31,780
profile although over here is displayed

00:23:28,420 --> 00:23:33,430
in this nice wide ratio that we decided

00:23:31,780 --> 00:23:36,310
would look best for all images there are

00:23:33,430 --> 00:23:37,630
big enough to be displayed like this but

00:23:36,310 --> 00:23:39,340
it's a square image being displayed as

00:23:37,630 --> 00:23:41,470
wide but what happens if you don't have

00:23:39,340 --> 00:23:44,230
a big enough image well we fall back to

00:23:41,470 --> 00:23:46,360
a different more in line version we just

00:23:44,230 --> 00:23:48,730
use the icon and we stretch it in a

00:23:46,360 --> 00:23:52,480
different way you can't do this with

00:23:48,730 --> 00:23:54,730
images and live a sane life so we just

00:23:52,480 --> 00:23:57,400
obviously use background size we still

00:23:54,730 --> 00:23:59,200
have invisible images on top so you can

00:23:57,400 --> 00:24:00,820
still drag and drop things and we still

00:23:59,200 --> 00:24:02,830
have links around them so you can open a

00:24:00,820 --> 00:24:03,940
new tab right there so the accessibility

00:24:02,830 --> 00:24:05,140
there is still there but the

00:24:03,940 --> 00:24:07,810
presentation there well it looks like

00:24:05,140 --> 00:24:10,450
the people who can see it's a lot nicer

00:24:07,810 --> 00:24:12,520
and it's also something we control and

00:24:10,450 --> 00:24:14,920
that is MIG compliant the messager

00:24:12,520 --> 00:24:16,960
interface guide and we do everything we

00:24:14,920 --> 00:24:19,190
can CSS to make sure to set it up and

00:24:16,960 --> 00:24:21,500
then we close the deal in Chavez

00:24:19,190 --> 00:24:23,450
some things you can't do in CSS like

00:24:21,500 --> 00:24:25,880
this especially if you have a lot of

00:24:23,450 --> 00:24:28,550
dynamic data and because we have these

00:24:25,880 --> 00:24:31,880
polite little building blocks we can do

00:24:28,550 --> 00:24:33,830
cool things I have interactive maps that

00:24:31,880 --> 00:24:35,180
respect are an interface guide and

00:24:33,830 --> 00:24:37,550
respect the Facebook interface guide on

00:24:35,180 --> 00:24:39,050
facebook look at the look at the corners

00:24:37,550 --> 00:24:40,610
they're all nice and rounded therefore

00:24:39,050 --> 00:24:43,490
when the corners meet up there in the

00:24:40,610 --> 00:24:44,960
top this is also partly interface guide

00:24:43,490 --> 00:24:46,460
but you get this for free if you just

00:24:44,960 --> 00:24:48,290
use our components because they're all

00:24:46,460 --> 00:24:51,590
very small and all do just one little

00:24:48,290 --> 00:24:53,740
thing you can have simple attachments

00:24:51,590 --> 00:24:57,020
that just say hey here's my opinion or

00:24:53,740 --> 00:25:00,920
you can have nice stunning-looking

00:24:57,020 --> 00:25:03,080
images that retailers would like you to

00:25:00,920 --> 00:25:05,180
still experience after you've left their

00:25:03,080 --> 00:25:07,190
shop and you get notifications yes you

00:25:05,180 --> 00:25:10,400
know you bought this belt is on its way

00:25:07,190 --> 00:25:12,860
great and people who have built these

00:25:10,400 --> 00:25:14,150
things that aren't on our team tell us

00:25:12,860 --> 00:25:15,650
that they really enjoy building stuff

00:25:14,150 --> 00:25:17,690
from messenger calm because of how easy

00:25:15,650 --> 00:25:19,840
it is just use the small components that

00:25:17,690 --> 00:25:24,230
we've built and the CSS is very small

00:25:19,840 --> 00:25:25,970
but does its job very well but that's

00:25:24,230 --> 00:25:29,210
not the best thing the best thing that

00:25:25,970 --> 00:25:32,030
we've we feel that we've done is we were

00:25:29,210 --> 00:25:34,220
the first secondary domain everything

00:25:32,030 --> 00:25:36,800
you saw is basically Facebook code

00:25:34,220 --> 00:25:38,660
running on a domain that is in facebook

00:25:36,800 --> 00:25:41,480
and they'll never be able to take that

00:25:38,660 --> 00:25:43,790
away from us so do try messenger calm

00:25:41,480 --> 00:25:49,900
and let us know what you think we'll be

00:25:43,790 --> 00:25:49,900

YouTube URL: https://www.youtube.com/watch?v=rSx5RxuaZfc


