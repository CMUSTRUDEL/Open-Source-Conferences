Title: !!Con 2021 - Building Weird Things With With The National Hockey League Using Ruby! by Wade Minter
Publication date: 2021-07-06
Playlist: !!Con 2021
Description: 
	Building Weird Things With With The National Hockey League Using Ruby! by Wade Minter

If you’re a Ruby developer who also moonlights as the arena public address announcer for a National Hockey League team, clearly the best thing to do is to write some odd bits of software using NHL data! In this talk, we’ll discover how to use the semi-undocumented NHL API to do things like preparing your car for the drive home and having a script announcement goals for you! There’s 10 minutes remaining in the period, so we’ll see how to build weird and delightful software just for the fun of it!

Wade is a Product Principal at Dualboot Partners, where he helps companies build great software. He was a member of the founding team at TeamSnap, and headed up Engineering at Adwerx, WeaveUp, and Custom Communications. He is also the arena public address announcer for the NHL’s Carolina Hurricanes, a 20+ year improv performer, ring announcer for a professional wrestling federation, and beer league ice hockey player/goalie. He leads a weird life.
Captions: 
	00:00:13,280 --> 00:00:16,800
hi everybody my name is wade minter and

00:00:15,519 --> 00:00:18,560
i'm here to present

00:00:16,800 --> 00:00:20,960
building weird things with the national

00:00:18,560 --> 00:00:22,480
hockey league using ruby

00:00:20,960 --> 00:00:25,119
now in the words of admiral james

00:00:22,480 --> 00:00:27,519
stockdale who am i why am i here

00:00:25,119 --> 00:00:29,359
well by day i'm a product principal at

00:00:27,519 --> 00:00:30,480
dual boot partners i'm based in raleigh

00:00:29,359 --> 00:00:32,320
north carolina

00:00:30,480 --> 00:00:34,160
prior to that i was part of the founding

00:00:32,320 --> 00:00:35,520
team at sports tech company team snap

00:00:34,160 --> 00:00:37,440
which just got acquired

00:00:35,520 --> 00:00:39,680
head of engineering at places like ad

00:00:37,440 --> 00:00:41,520
works and weave up

00:00:39,680 --> 00:00:43,520
and custom communications a product

00:00:41,520 --> 00:00:45,200
manager at nbc sports engine

00:00:43,520 --> 00:00:46,719
my background is in system

00:00:45,200 --> 00:00:48,480
administration devops

00:00:46,719 --> 00:00:50,480
but i also picked up ruby development

00:00:48,480 --> 00:00:52,079
back about 15 years ago

00:00:50,480 --> 00:00:55,440
but that's what i do in the during the

00:00:52,079 --> 00:00:57,280
day but by night

00:00:55,440 --> 00:00:58,559
i am the arena public address announcer

00:00:57,280 --> 00:01:00,160
for the national hockey league's

00:00:58,559 --> 00:01:02,399
carolina hurricanes

00:01:00,160 --> 00:01:04,159
meaning i set rinkside 41 nights a year

00:01:02,399 --> 00:01:07,840
calling out goals penalties

00:01:04,159 --> 00:01:07,840
and otherwise entertaining the

00:01:11,119 --> 00:01:15,119
rex crowd we have provided fans and

00:01:13,600 --> 00:01:17,360
staff the opportunity

00:01:15,119 --> 00:01:18,880
to share her safe fight for the battle

00:01:17,360 --> 00:01:21,200
against cancer

00:01:18,880 --> 00:01:23,200
at this time we ask all in attendance to

00:01:21,200 --> 00:01:26,799
raise your card high

00:01:23,200 --> 00:01:26,799
and show everyone who you

00:01:27,840 --> 00:01:30,960
he lays it back to wesley to the outside

00:01:30,079 --> 00:01:34,150
he goes

00:01:30,960 --> 00:01:34,580
out in front they score what a play

00:01:34,150 --> 00:01:40,860
[Applause]

00:01:34,580 --> 00:01:40,860
[Music]

00:01:41,439 --> 00:01:46,159
hands it he finds his line mate catalano

00:01:44,399 --> 00:01:48,720
the godfather puts one in

00:01:46,159 --> 00:01:50,159
but minter off the bench and making

00:01:48,720 --> 00:01:52,479
saves

00:01:50,159 --> 00:01:54,320
as a multi-disciplinarian i've often

00:01:52,479 --> 00:01:55,360
thought how can i combine these two

00:01:54,320 --> 00:01:57,920
parts of my life

00:01:55,360 --> 00:02:00,079
on the one hand i'm a tech engineer on

00:01:57,920 --> 00:02:01,119
the other hand i'm an nhl public address

00:02:00,079 --> 00:02:02,880
announcer

00:02:01,119 --> 00:02:04,960
what could possibly bring these two

00:02:02,880 --> 00:02:08,239
things together and the answer of course

00:02:04,960 --> 00:02:10,080
is pointless software and by bopping

00:02:08,239 --> 00:02:10,959
around the internet i soon discovered

00:02:10,080 --> 00:02:14,000
that there is an

00:02:10,959 --> 00:02:15,120
undocumented yet very rich national

00:02:14,000 --> 00:02:18,480
hockey league game

00:02:15,120 --> 00:02:20,239
api that provides play-by-play down to a

00:02:18,480 --> 00:02:22,000
very minute level

00:02:20,239 --> 00:02:24,480
and gives you all the information you

00:02:22,000 --> 00:02:26,800
need about an ongoing game

00:02:24,480 --> 00:02:27,520
as i looked at this api i had a couple

00:02:26,800 --> 00:02:29,840
of different

00:02:27,520 --> 00:02:31,200
ideas of things that i could do with it

00:02:29,840 --> 00:02:31,680
and that's what i'm going to talk about

00:02:31,200 --> 00:02:34,560
today

00:02:31,680 --> 00:02:38,319
two very pointless projects that i built

00:02:34,560 --> 00:02:39,840
with ruby on top of the nhl api

00:02:38,319 --> 00:02:42,239
now the first project i'm going to talk

00:02:39,840 --> 00:02:44,000
about is one that i call tesla puck

00:02:42,239 --> 00:02:45,680
it's interesting because my car has an

00:02:44,000 --> 00:02:49,040
api as a tesla

00:02:45,680 --> 00:02:51,920
and my league has an api as the nhl

00:02:49,040 --> 00:02:54,080
now tesla has an also undocumented api

00:02:51,920 --> 00:02:56,480
but one that's been reverse engineered

00:02:54,080 --> 00:02:58,400
there's a rubygem on github by tim door

00:02:56,480 --> 00:03:00,480
called tesla api

00:02:58,400 --> 00:03:02,159
that's what i use to talk to the car

00:03:00,480 --> 00:03:03,040
basically if you can do it inside of the

00:03:02,159 --> 00:03:04,879
mobile app

00:03:03,040 --> 00:03:07,200
you'll be able to do it inside of the

00:03:04,879 --> 00:03:08,879
tesla api rubygem it can talk to your

00:03:07,200 --> 00:03:11,760
car it can start it up

00:03:08,879 --> 00:03:13,200
get data send actions all those things

00:03:11,760 --> 00:03:14,319
that you can do inside of the tesla

00:03:13,200 --> 00:03:17,120
mobile app

00:03:14,319 --> 00:03:18,640
now the nhl's undocumented api is called

00:03:17,120 --> 00:03:21,120
statsweb

00:03:18,640 --> 00:03:21,760
it provides information about schedule

00:03:21,120 --> 00:03:24,879
teams

00:03:21,760 --> 00:03:26,319
ongoing games live data feeds where if

00:03:24,879 --> 00:03:29,280
you refresh it it's actually a really

00:03:26,319 --> 00:03:32,640
nicely documented rest api

00:03:29,280 --> 00:03:35,440
and i use the stats web api to determine

00:03:32,640 --> 00:03:36,400
what's going on in a game now between

00:03:35,440 --> 00:03:39,840
the two of those

00:03:36,400 --> 00:03:41,040
i had an idea what if i could use the

00:03:39,840 --> 00:03:44,000
nhl api

00:03:41,040 --> 00:03:45,760
to determine when a game is over a home

00:03:44,000 --> 00:03:47,440
game specifically because my car is

00:03:45,760 --> 00:03:49,599
parked at the arena

00:03:47,440 --> 00:03:50,959
and hockey takes place in the winter

00:03:49,599 --> 00:03:52,640
most often

00:03:50,959 --> 00:03:56,080
i don't like walking through the cold to

00:03:52,640 --> 00:03:59,120
a cold car what if

00:03:56,080 --> 00:04:02,159
ruby could tell my car hey

00:03:59,120 --> 00:04:04,080
the game's over let's turn on your

00:04:02,159 --> 00:04:06,000
uh air conditioning or heating depending

00:04:04,080 --> 00:04:08,959
on what time of the year it is

00:04:06,000 --> 00:04:10,560
and set your car for home that way when

00:04:08,959 --> 00:04:11,599
you walk across the parking lot after

00:04:10,560 --> 00:04:14,319
dropping all of your stuff

00:04:11,599 --> 00:04:15,200
off you'll be able to get into a nice

00:04:14,319 --> 00:04:18,000
warmed car

00:04:15,200 --> 00:04:19,120
and just drive on home so that's what i

00:04:18,000 --> 00:04:21,680
did

00:04:19,120 --> 00:04:23,520
now in the code you can see several

00:04:21,680 --> 00:04:25,120
things we'll talk about here that makes

00:04:23,520 --> 00:04:26,560
it really fun

00:04:25,120 --> 00:04:28,000
as you can see here in the code it's a

00:04:26,560 --> 00:04:29,199
pretty simple ruby project they're

00:04:28,000 --> 00:04:31,919
basically three classes

00:04:29,199 --> 00:04:34,000
a sidekick worker a model for the tesla

00:04:31,919 --> 00:04:36,639
and a model for the schedule

00:04:34,000 --> 00:04:37,759
so i have a cron job that kicks off

00:04:36,639 --> 00:04:41,120
every day

00:04:37,759 --> 00:04:43,280
and it starts up the worker

00:04:41,120 --> 00:04:44,400
the worker will then check on a few

00:04:43,280 --> 00:04:46,160
things it will see

00:04:44,400 --> 00:04:48,160
is there a game scheduled for today if

00:04:46,160 --> 00:04:50,240
there's not no need to do anything

00:04:48,160 --> 00:04:51,360
is it a home game if it's not my car's

00:04:50,240 --> 00:04:54,160
not going to be at the arena

00:04:51,360 --> 00:04:55,120
no need to do anything is the game

00:04:54,160 --> 00:04:58,960
pending

00:04:55,120 --> 00:04:59,600
if so check again later is the game in

00:04:58,960 --> 00:05:01,360
progress

00:04:59,600 --> 00:05:02,800
aha so the game's going on so we're

00:05:01,360 --> 00:05:04,400
going to check back about every five

00:05:02,800 --> 00:05:05,759
minutes to see if the game has gone

00:05:04,400 --> 00:05:08,160
final

00:05:05,759 --> 00:05:10,080
if the game has gone final it does a few

00:05:08,160 --> 00:05:12,479
things it wakes up the car

00:05:10,080 --> 00:05:14,479
and that can take a couple of tries if

00:05:12,479 --> 00:05:18,720
my car is parked at the arena

00:05:14,479 --> 00:05:22,240
or within about a mile it will proceed

00:05:18,720 --> 00:05:24,400
and then if the team won

00:05:22,240 --> 00:05:26,639
it celebrates that's right i made my car

00:05:24,400 --> 00:05:28,160
celebrate it honks the horn and flashes

00:05:26,639 --> 00:05:29,440
the lights in celebration if the canes

00:05:28,160 --> 00:05:31,440
won the game

00:05:29,440 --> 00:05:33,360
otherwise it prepares the car to leave

00:05:31,440 --> 00:05:37,360
and that happens over here in the

00:05:33,360 --> 00:05:39,120
tesla model celebration honks the horn

00:05:37,360 --> 00:05:40,400
and flashes the lights three times

00:05:39,120 --> 00:05:42,400
prepare to leave starts the air

00:05:40,400 --> 00:05:43,039
conditioning to whatever it has been set

00:05:42,400 --> 00:05:45,360
to

00:05:43,039 --> 00:05:46,240
and sets the navigation to my home

00:05:45,360 --> 00:05:48,400
address

00:05:46,240 --> 00:05:49,280
all this is powered by an in file right

00:05:48,400 --> 00:05:52,479
here

00:05:49,280 --> 00:05:52,800
easily configurable runs in docker so if

00:05:52,479 --> 00:05:55,520
you

00:05:52,800 --> 00:05:57,360
go to nhl games and you have a tesla

00:05:55,520 --> 00:05:59,280
this is something you can use

00:05:57,360 --> 00:06:01,360
i shudder to think how many people i've

00:05:59,280 --> 00:06:02,319
scared over the last couple years

00:06:01,360 --> 00:06:03,919
as they've been walking through the

00:06:02,319 --> 00:06:05,280
parking lot and all of a sudden my car

00:06:03,919 --> 00:06:07,120
starts freaking out

00:06:05,280 --> 00:06:21,840
with horns and lights because the canes

00:06:07,120 --> 00:06:21,840
just won

00:06:35,110 --> 00:06:41,939
[Music]

00:06:42,800 --> 00:06:47,199
my second project is called robo goal

00:06:45,360 --> 00:06:49,520
now this has a little explanation behind

00:06:47,199 --> 00:06:50,720
it on twitter for the past several years

00:06:49,520 --> 00:06:52,800
i've been doing a thing called

00:06:50,720 --> 00:06:54,880
road goal calls where if the team is on

00:06:52,800 --> 00:06:56,639
the road and a keynes player scores

00:06:54,880 --> 00:06:58,400
i'll get on twitter and record a video

00:06:56,639 --> 00:07:00,160
of myself from my living room

00:06:58,400 --> 00:07:01,759
announcing the goal just like i would at

00:07:00,160 --> 00:07:03,680
the arena and it's become a fun little

00:07:01,759 --> 00:07:06,680
bit among hurricanes fans everyone looks

00:07:03,680 --> 00:07:09,120
forward to it on twitter

00:07:06,680 --> 00:07:11,280
carolina hurricanes

00:07:09,120 --> 00:07:11,280
go

00:07:12,160 --> 00:07:15,520
his sixth of the season score by number

00:07:14,479 --> 00:07:17,980
00:07:15,520 --> 00:07:19,919
martin natus

00:07:17,980 --> 00:07:24,880
[Music]

00:07:19,919 --> 00:07:24,880
assisted by number 20 sebastian

00:07:27,440 --> 00:07:30,639
but there are occasionally times when i

00:07:28,960 --> 00:07:32,400
can't do that i've got a hockey game

00:07:30,639 --> 00:07:34,160
that i'm playing in an improv show

00:07:32,400 --> 00:07:35,759
some sort of scheduling conflict that

00:07:34,160 --> 00:07:37,759
prevents me from doing the road goal

00:07:35,759 --> 00:07:40,720
calls and it makes people sad

00:07:37,759 --> 00:07:42,800
they miss it i had an idea though there

00:07:40,720 --> 00:07:44,400
is the nhl api it's got information

00:07:42,800 --> 00:07:45,599
about every play that's happening in the

00:07:44,400 --> 00:07:48,240
game

00:07:45,599 --> 00:07:49,759
what if i could write myself a script to

00:07:48,240 --> 00:07:52,879
obsolete myself

00:07:49,759 --> 00:07:56,319
and do the road goal calls for me that's

00:07:52,879 --> 00:07:58,000
where robo goal comes in

00:07:56,319 --> 00:08:00,080
so as you can see another fairly simple

00:07:58,000 --> 00:08:01,599
ruby project there is a scheduler that

00:08:00,080 --> 00:08:03,360
checks if there's a game today if so it

00:08:01,599 --> 00:08:04,000
accused the game stream now the game

00:08:03,360 --> 00:08:07,199
stream

00:08:04,000 --> 00:08:10,080
checks the live feed for goal plays

00:08:07,199 --> 00:08:12,240
if carolina has scored a goal it will

00:08:10,080 --> 00:08:14,960
kick off a worker to process

00:08:12,240 --> 00:08:16,479
the video file if not it just recues

00:08:14,960 --> 00:08:19,199
itself for another minute

00:08:16,479 --> 00:08:20,879
until the game is final now the workers

00:08:19,199 --> 00:08:24,000
where the magic happens it checks the

00:08:20,879 --> 00:08:26,160
stat feed for that particular game

00:08:24,000 --> 00:08:28,879
it starts building a tweet and it starts

00:08:26,160 --> 00:08:30,639
concatenating a bunch of audio files

00:08:28,879 --> 00:08:33,279
as you can see i've got a bunch of

00:08:30,639 --> 00:08:35,039
different calls for however many goals

00:08:33,279 --> 00:08:36,800
the players scored i've got

00:08:35,039 --> 00:08:39,599
all of the different player names on the

00:08:36,800 --> 00:08:41,120
team i've got different times this was

00:08:39,599 --> 00:08:44,240
the most complex

00:08:41,120 --> 00:08:46,560
and it uses socks and ffmpeg to

00:08:44,240 --> 00:08:49,920
concatenate these things together

00:08:46,560 --> 00:08:52,000
along with a photo and to build a video

00:08:49,920 --> 00:08:55,839
file with an audio track

00:08:52,000 --> 00:08:55,839
that sounds a little something like this

00:08:56,070 --> 00:09:01,440
[Music]

00:08:57,880 --> 00:09:01,440
hurricanes go

00:09:02,399 --> 00:09:06,720
his 17th of the season gourd on the

00:09:05,279 --> 00:09:09,040
power play by

00:09:06,720 --> 00:09:09,040
number

00:09:11,760 --> 00:09:16,080
assisted by number 22

00:09:17,440 --> 00:09:23,839
assisted by number 88 martin

00:09:28,880 --> 00:09:32,080
now is this software pointless

00:09:30,720 --> 00:09:35,200
absolutely

00:09:32,080 --> 00:09:38,720
was it tremendously fun to write also

00:09:35,200 --> 00:09:41,600
absolutely i had a great time melding

00:09:38,720 --> 00:09:42,720
my knowledge of ruby with some fun data

00:09:41,600 --> 00:09:45,120
that's available

00:09:42,720 --> 00:09:46,720
and created something that i can enjoy

00:09:45,120 --> 00:09:47,440
and really that's what software is all

00:09:46,720 --> 00:09:49,360
about

00:09:47,440 --> 00:09:50,560
if you build something that you love

00:09:49,360 --> 00:09:52,000
you'll be happy

00:09:50,560 --> 00:09:54,080
and you'll make the world a little bit

00:09:52,000 --> 00:09:55,360
better place so if you've got crazy

00:09:54,080 --> 00:09:57,519
ideas in your head

00:09:55,360 --> 00:09:58,720
go ahead and build that software because

00:09:57,519 --> 00:10:01,519
you can take it to the bank

00:09:58,720 --> 00:10:02,640
it won't be any dumber than this thanks

00:10:01,519 --> 00:10:05,680
for watching

00:10:02,640 --> 00:10:05,680

YouTube URL: https://www.youtube.com/watch?v=5FoxERw7F2Y


