Title: !!COn 2021 - tzdata: Back to the Future! by John Feminella
Publication date: 2021-07-06
Playlist: !!Con 2021
Description: 
	tzdata: Back to the Future! by John Feminella

Every modern computer ships with some flavor of a special database called tzdata, which codifies the worldâ€™s diverse and varied viewpoints about how to standardize time.

This talk is about one very specific line in that gigantic store of information, what it means, and how every computer that needs to rely on time depends on this single, solitary idea being correct.

John is an avid technologist, occasional public speaker, and curiosity advocate. He serves as a consultant, helping enterprises transform the way they write, operate, and deploy software.

John is interested in bits, bucks, bots, and blocks. He lives in Charlottesville, VA and likes meta-jokes, milkshakes, and referring to himself in the third person in speaker bios.
Captions: 
	00:00:14,240 --> 00:00:17,760
hi everyone

00:00:15,120 --> 00:00:19,439
welcome to tz data back to the future

00:00:17,760 --> 00:00:21,359
i'd like to talk today about a fun

00:00:19,439 --> 00:00:23,199
sometimes obscure data set its

00:00:21,359 --> 00:00:24,400
tremendous impact on almost everything

00:00:23,199 --> 00:00:26,800
in modern computing

00:00:24,400 --> 00:00:28,640
and the historical curiosity of one very

00:00:26,800 --> 00:00:31,119
specific line in this dataset

00:00:28,640 --> 00:00:32,079
let's dive right in computers can do

00:00:31,119 --> 00:00:33,760
some things well

00:00:32,079 --> 00:00:35,520
much better than even the most talented

00:00:33,760 --> 00:00:36,320
humans i hope that's not a controversial

00:00:35,520 --> 00:00:38,160
statement

00:00:36,320 --> 00:00:40,239
one of the things they do really well is

00:00:38,160 --> 00:00:42,399
to keep track of the passage of time

00:00:40,239 --> 00:00:44,079
you barely need any electronic

00:00:42,399 --> 00:00:46,000
components for this to work something as

00:00:44,079 --> 00:00:47,760
simple as a quartz crystal

00:00:46,000 --> 00:00:50,879
that's part of an electrical circuit can

00:00:47,760 --> 00:00:52,719
be used as the basis for a digital clock

00:00:50,879 --> 00:00:54,800
frankly i think this is amazing we've

00:00:52,719 --> 00:00:56,079
tricked rocks into telling us what time

00:00:54,800 --> 00:00:57,760
it is

00:00:56,079 --> 00:01:00,320
but if you want to know what time it is

00:00:57,760 --> 00:01:01,120
where you live that is what horologists

00:01:00,320 --> 00:01:04,320
would call

00:01:01,120 --> 00:01:04,960
your local time that's a very different

00:01:04,320 --> 00:01:07,520
idea

00:01:04,960 --> 00:01:09,280
now using the physics of quartz crystals

00:01:07,520 --> 00:01:10,000
isn't enough because humans have

00:01:09,280 --> 00:01:12,159
invented

00:01:10,000 --> 00:01:14,400
a deviously complicated set of rules

00:01:12,159 --> 00:01:16,320
that tell us what the local time is

00:01:14,400 --> 00:01:17,439
those times can be different for each

00:01:16,320 --> 00:01:19,520
person on earth

00:01:17,439 --> 00:01:20,560
and because these rules have changed

00:01:19,520 --> 00:01:22,400
over time

00:01:20,560 --> 00:01:24,320
knowing how to convert from one time to

00:01:22,400 --> 00:01:26,960
another gets even more complicated

00:01:24,320 --> 00:01:28,960
because it requires historical knowledge

00:01:26,960 --> 00:01:31,280
of when those rules changed when they

00:01:28,960 --> 00:01:33,520
apply and when they don't

00:01:31,280 --> 00:01:35,920
fortunately in most computers all of

00:01:33,520 --> 00:01:37,200
that complexity is codified by a set of

00:01:35,920 --> 00:01:40,479
standards we call the

00:01:37,200 --> 00:01:43,680
i a n a time zone database

00:01:40,479 --> 00:01:46,079
or tz data for short because humans are

00:01:43,680 --> 00:01:48,479
peculiar and particular creatures

00:01:46,079 --> 00:01:49,360
there are a lot of rules in tz data to

00:01:48,479 --> 00:01:51,200
consider

00:01:49,360 --> 00:01:52,479
in fact depending on how you slice it

00:01:51,200 --> 00:01:55,119
there are about 2

00:01:52,479 --> 00:01:56,000
200 such rules in the database each of

00:01:55,119 --> 00:01:57,360
which is needed

00:01:56,000 --> 00:01:59,360
if you want to have a correct

00:01:57,360 --> 00:02:00,880
understanding of local time in some time

00:01:59,360 --> 00:02:03,759
zone

00:02:00,880 --> 00:02:05,119
importantly local time is not the same

00:02:03,759 --> 00:02:06,799
thing as a time zone

00:02:05,119 --> 00:02:08,720
this is a common point of confusion for

00:02:06,799 --> 00:02:10,239
both non-technical and technical folks

00:02:08,720 --> 00:02:12,640
alike

00:02:10,239 --> 00:02:13,760
the local time tells you what time it is

00:02:12,640 --> 00:02:16,239
on your clock

00:02:13,760 --> 00:02:18,000
relative to standard time for example we

00:02:16,239 --> 00:02:20,080
might say that the local time in chicago

00:02:18,000 --> 00:02:21,920
right now is about two o'clock pm

00:02:20,080 --> 00:02:24,319
and no matter where we are in the world

00:02:21,920 --> 00:02:26,879
we agree about what the standard time is

00:02:24,319 --> 00:02:28,480
but the time zone is something else it's

00:02:26,879 --> 00:02:30,959
the set of rules

00:02:28,480 --> 00:02:32,239
that tells us how to convert from

00:02:30,959 --> 00:02:34,879
standard time to

00:02:32,239 --> 00:02:36,319
local time it is not a time in and of

00:02:34,879 --> 00:02:38,480
itself those

00:02:36,319 --> 00:02:39,920
rules are often different from place to

00:02:38,480 --> 00:02:40,560
place and different at different times

00:02:39,920 --> 00:02:43,760
of the year

00:02:40,560 --> 00:02:45,840
and they usually vary historically

00:02:43,760 --> 00:02:48,239
for example the local time in ecuador

00:02:45,840 --> 00:02:49,120
right now is also about 2pm just like in

00:02:48,239 --> 00:02:51,360
chicago

00:02:49,120 --> 00:02:52,959
but ecuador uses a totally different set

00:02:51,360 --> 00:02:54,239
of rules than chicago does for

00:02:52,959 --> 00:02:56,080
determining the time

00:02:54,239 --> 00:02:57,680
so it has a different time zone it's

00:02:56,080 --> 00:02:59,840
just a coincidence in other words that

00:02:57,680 --> 00:03:02,959
their local times happen to be the same

00:02:59,840 --> 00:03:05,440
they are in very different time zones

00:03:02,959 --> 00:03:06,519
at a different time for example 2 p.m on

00:03:05,440 --> 00:03:08,959
december 19

00:03:06,519 --> 00:03:11,120
2021 we might see a difference in their

00:03:08,959 --> 00:03:13,280
local times because ecuador doesn't use

00:03:11,120 --> 00:03:15,760
daylight savings time unlike the us

00:03:13,280 --> 00:03:17,280
or most of the us again their time zone

00:03:15,760 --> 00:03:19,040
is different and so their rules are

00:03:17,280 --> 00:03:20,959
different and so we might wind up with

00:03:19,040 --> 00:03:22,560
different local times

00:03:20,959 --> 00:03:24,799
let's look at how you might read a

00:03:22,560 --> 00:03:27,519
particular tz data time zone

00:03:24,799 --> 00:03:29,040
this is one tiny excerpt from the rules

00:03:27,519 --> 00:03:31,519
you need for codifying time

00:03:29,040 --> 00:03:32,080
in just one specific place which is new

00:03:31,519 --> 00:03:33,840
york city

00:03:32,080 --> 00:03:35,920
and everything that's canonically part

00:03:33,840 --> 00:03:38,480
of the eastern time zone

00:03:35,920 --> 00:03:40,159
here's the name of the time zone america

00:03:38,480 --> 00:03:42,560
new york

00:03:40,159 --> 00:03:44,640
above this are a set of rules that can

00:03:42,560 --> 00:03:46,080
be used by any of the time zones in the

00:03:44,640 --> 00:03:48,400
database to describe

00:03:46,080 --> 00:03:50,640
when those rules applied historically

00:03:48,400 --> 00:03:52,560
how to apply them when they do apply

00:03:50,640 --> 00:03:54,480
and what happens to the local time zone

00:03:52,560 --> 00:03:56,799
when you apply them

00:03:54,480 --> 00:03:58,879
for example these first two rules

00:03:56,799 --> 00:04:00,080
codified daylight savings time for the

00:03:58,879 --> 00:04:02,640
entire us

00:04:00,080 --> 00:04:05,360
so right now the u.s rules are that we

00:04:02,640 --> 00:04:07,599
add one hour to local time

00:04:05,360 --> 00:04:09,280
starting on the second sunday in march

00:04:07,599 --> 00:04:12,640
at 2 am

00:04:09,280 --> 00:04:14,799
and we revert to no offset to local time

00:04:12,640 --> 00:04:16,959
starting on the first sunday in november

00:04:14,799 --> 00:04:18,959
at 2am local time

00:04:16,959 --> 00:04:21,120
together these two rules help to find

00:04:18,959 --> 00:04:23,360
the offsets that apply at any particular

00:04:21,120 --> 00:04:25,440
time for any particular time zone that

00:04:23,360 --> 00:04:27,360
uses those rules

00:04:25,440 --> 00:04:28,479
we can see here that the america new

00:04:27,360 --> 00:04:31,280
york time zone

00:04:28,479 --> 00:04:33,120
uses the us rules right now the normal

00:04:31,280 --> 00:04:34,320
offset we should use is five hours

00:04:33,120 --> 00:04:36,240
behind the standard time

00:04:34,320 --> 00:04:38,560
just like the first field in this row of

00:04:36,240 --> 00:04:40,479
the time zones description says

00:04:38,560 --> 00:04:42,240
but when the date is the second sunday

00:04:40,479 --> 00:04:44,960
in march or after that date

00:04:42,240 --> 00:04:46,639
we apply a one hour positive offset like

00:04:44,960 --> 00:04:49,520
the rule says so we'd now be

00:04:46,639 --> 00:04:51,360
four hours behind standard time because

00:04:49,520 --> 00:04:53,360
these rules were written by people

00:04:51,360 --> 00:04:55,600
they offer an interesting view into the

00:04:53,360 --> 00:04:57,840
complexity and vagaries of the history

00:04:55,600 --> 00:04:58,960
the people were experiencing at the time

00:04:57,840 --> 00:05:01,720
for instance here

00:04:58,960 --> 00:05:02,960
new york city set its own rules until

00:05:01,720 --> 00:05:04,479
00:05:02,960 --> 00:05:06,400
that were different from the rest of the

00:05:04,479 --> 00:05:07,440
country you can see there's an nyc there

00:05:06,400 --> 00:05:10,560
not a u.s

00:05:07,440 --> 00:05:12,880
so what happened in 1967

00:05:10,560 --> 00:05:14,639
well a bill called the federal uniform

00:05:12,880 --> 00:05:16,479
time act or uta

00:05:14,639 --> 00:05:18,000
was passed that standardized how

00:05:16,479 --> 00:05:19,919
daylight savings time worked

00:05:18,000 --> 00:05:21,199
so if you look in cz data you'll see a

00:05:19,919 --> 00:05:23,840
lot of different time zones

00:05:21,199 --> 00:05:26,960
standardizing around 1967

00:05:23,840 --> 00:05:28,720
towards the u.s time zone rules but

00:05:26,960 --> 00:05:31,039
guess what there were problems

00:05:28,720 --> 00:05:33,039
indiana wanted to use two different time

00:05:31,039 --> 00:05:34,160
zones and michigan and south dakota

00:05:33,039 --> 00:05:36,240
wanted to put it

00:05:34,160 --> 00:05:37,759
wanted to put what time it was up to a

00:05:36,240 --> 00:05:39,520
vote

00:05:37,759 --> 00:05:40,960
one of the things i really love about tz

00:05:39,520 --> 00:05:43,600
data is that the authors have

00:05:40,960 --> 00:05:44,560
inserted a bunch of stories like actual

00:05:43,600 --> 00:05:47,120
pros

00:05:44,560 --> 00:05:49,440
as code comments about how all the

00:05:47,120 --> 00:05:50,880
wackiness and time zones came to be

00:05:49,440 --> 00:05:52,160
i won't spoil the fun in this talk

00:05:50,880 --> 00:05:52,960
because i think many of those stories

00:05:52,160 --> 00:05:54,880
are worth reading

00:05:52,960 --> 00:05:56,720
but one of my favorite tales is about an

00:05:54,880 --> 00:05:57,440
indiana legislator named herbert

00:05:56,720 --> 00:05:59,680
copeland

00:05:57,440 --> 00:06:01,520
who was so furious about the idea of

00:05:59,680 --> 00:06:02,880
needing to set his clock differently at

00:06:01,520 --> 00:06:04,880
different points in the year

00:06:02,880 --> 00:06:07,120
that he broke the official clock in the

00:06:04,880 --> 00:06:08,479
indiana state capital as a protest

00:06:07,120 --> 00:06:09,919
i think representative copeland would

00:06:08,479 --> 00:06:11,360
probably have hated being a software

00:06:09,919 --> 00:06:13,199
developer

00:06:11,360 --> 00:06:15,360
but for me one of the most interesting

00:06:13,199 --> 00:06:17,600
lines that shows up over and over again

00:06:15,360 --> 00:06:19,360
across dozens of time zones not

00:06:17,600 --> 00:06:22,160
necessarily even in the us

00:06:19,360 --> 00:06:23,440
is this one it says that on november 18

00:06:22,160 --> 00:06:25,600
00:06:23,440 --> 00:06:26,800
new york stopped using something called

00:06:25,600 --> 00:06:29,039
lmt

00:06:26,800 --> 00:06:31,440
and switched to a standardized time and

00:06:29,039 --> 00:06:34,000
so did almost everywhere else in the us

00:06:31,440 --> 00:06:35,199
so what's lmt and why did people switch

00:06:34,000 --> 00:06:38,960
from it

00:06:35,199 --> 00:06:40,960
lmt is short for local mean time

00:06:38,960 --> 00:06:43,840
roughly speaking it's the time you would

00:06:40,960 --> 00:06:44,960
keep if you measured 24 hours as being

00:06:43,840 --> 00:06:47,680
the time between

00:06:44,960 --> 00:06:49,599
two consecutive high noons the time when

00:06:47,680 --> 00:06:50,720
the sun is the highest in the sky at

00:06:49,599 --> 00:06:52,720
your position

00:06:50,720 --> 00:06:54,880
in this diagram it's what you get if you

00:06:52,720 --> 00:06:55,599
count 24 hours as the time it takes for

00:06:54,880 --> 00:06:58,720
earth to go

00:06:55,599 --> 00:07:01,520
from location 1 to location 3. one

00:06:58,720 --> 00:07:03,280
huge problem with lmt of course is that

00:07:01,520 --> 00:07:04,400
two different observers at different

00:07:03,280 --> 00:07:06,720
places on earth

00:07:04,400 --> 00:07:09,599
will measure the sun as reaching high

00:07:06,720 --> 00:07:11,199
noon at different times on the same day

00:07:09,599 --> 00:07:14,080
so that means that cities that are

00:07:11,199 --> 00:07:17,520
separated by as little as 20 miles apart

00:07:14,080 --> 00:07:19,440
won't agree about what time it is now

00:07:17,520 --> 00:07:21,360
in the 19th century that didn't matter

00:07:19,440 --> 00:07:22,639
that much because there was no easy way

00:07:21,360 --> 00:07:25,840
to travel quickly

00:07:22,639 --> 00:07:28,000
if it took you a day to travel 20 miles

00:07:25,840 --> 00:07:29,840
by walking or by horseback you would

00:07:28,000 --> 00:07:30,720
just set your watch at the destination

00:07:29,840 --> 00:07:33,840
using their

00:07:30,720 --> 00:07:35,840
local meantime but in 1869

00:07:33,840 --> 00:07:37,039
after years of back-breaking work and

00:07:35,840 --> 00:07:38,160
horrific working conditions for

00:07:37,039 --> 00:07:39,840
immigrant laborers

00:07:38,160 --> 00:07:41,440
the united states transcontinental

00:07:39,840 --> 00:07:43,680
railroad was completed

00:07:41,440 --> 00:07:45,280
joining the eastern u.s with the western

00:07:43,680 --> 00:07:47,440
us for the first time

00:07:45,280 --> 00:07:51,120
that reduced the coast to coast travel

00:07:47,440 --> 00:07:54,240
times from months to about six days

00:07:51,120 --> 00:07:57,840
shortly after high noon local mean time

00:07:54,240 --> 00:07:58,560
on may 10 1869 at promontory point in

00:07:57,840 --> 00:08:01,039
utah

00:07:58,560 --> 00:08:03,120
the two railroads were connected because

00:08:01,039 --> 00:08:05,440
there were no time standards in place

00:08:03,120 --> 00:08:07,520
the time the final spike was driven was

00:08:05,440 --> 00:08:08,560
reported in accordance with local time

00:08:07,520 --> 00:08:11,680
across the country

00:08:08,560 --> 00:08:13,520
1245 at promontory point 1144

00:08:11,680 --> 00:08:17,360
and 1146 in different parts of san

00:08:13,520 --> 00:08:18,800
francisco and 249 in washington dc

00:08:17,360 --> 00:08:21,280
this created a problem because the

00:08:18,800 --> 00:08:22,479
railroad operators also kept their own

00:08:21,280 --> 00:08:24,960
versions of local time

00:08:22,479 --> 00:08:27,039
on a particular railway line resolving

00:08:24,960 --> 00:08:28,000
local mean time and railroad time was

00:08:27,039 --> 00:08:29,680
contentious

00:08:28,000 --> 00:08:31,440
railroads wanted to keep their own time

00:08:29,680 --> 00:08:33,200
and towns wanted to keep theirs

00:08:31,440 --> 00:08:35,680
so it was only through the joint efforts

00:08:33,200 --> 00:08:38,159
of charles dowd a seminary teacher

00:08:35,680 --> 00:08:38,800
sanford fleming a railroad surveyor and

00:08:38,159 --> 00:08:40,959
william

00:08:38,800 --> 00:08:42,640
allen a railroad engineer that the

00:08:40,959 --> 00:08:44,720
solution was finally reached

00:08:42,640 --> 00:08:46,720
every railway stop would align to a

00:08:44,720 --> 00:08:48,880
standard time and be in exactly one of

00:08:46,720 --> 00:08:49,839
four time zones eastern central mountain

00:08:48,880 --> 00:08:51,600
or pacific

00:08:49,839 --> 00:08:54,640
the switch over to this new standard

00:08:51,600 --> 00:08:56,800
would take place at noon local meantime

00:08:54,640 --> 00:08:57,920
because everyone's local mean time

00:08:56,800 --> 00:09:00,399
wasn't quite the same

00:08:57,920 --> 00:09:02,240
relative to their newly formed time zone

00:09:00,399 --> 00:09:03,519
everyone had different offsets and

00:09:02,240 --> 00:09:05,279
that's why the lmc

00:09:03,519 --> 00:09:08,160
offsets are different for each city in

00:09:05,279 --> 00:09:09,680
tz data what these lines and tz data

00:09:08,160 --> 00:09:12,080
show us in other words

00:09:09,680 --> 00:09:12,959
are the historical birth of time zones

00:09:12,080 --> 00:09:15,120
in this country

00:09:12,959 --> 00:09:16,959
and that's just the us almost every

00:09:15,120 --> 00:09:19,040
country in tz data has their own

00:09:16,959 --> 00:09:20,880
interesting origin story for when and

00:09:19,040 --> 00:09:22,320
how they standardized on times

00:09:20,880 --> 00:09:24,320
and many of these stories are written

00:09:22,320 --> 00:09:25,440
down in the code comments of tz data

00:09:24,320 --> 00:09:27,040
itself

00:09:25,440 --> 00:09:28,800
i never would have known this story if

00:09:27,040 --> 00:09:30,959
brett column stuart hadn't been left

00:09:28,800 --> 00:09:32,640
behind in tz data by the many

00:09:30,959 --> 00:09:33,279
contributors to the data set over the

00:09:32,640 --> 00:09:35,839
years

00:09:33,279 --> 00:09:37,360
so if i can leave you with one request

00:09:35,839 --> 00:09:39,120
it's that if your software has a

00:09:37,360 --> 00:09:40,959
complicated and interesting history

00:09:39,120 --> 00:09:42,959
write it down you never know if other

00:09:40,959 --> 00:09:44,480
people might find it interesting too

00:09:42,959 --> 00:09:45,760
thanks for giving me your own time

00:09:44,480 --> 00:09:46,480
please feel free to reach out with

00:09:45,760 --> 00:09:50,800
questions

00:09:46,480 --> 00:09:50,800

YouTube URL: https://www.youtube.com/watch?v=qr3CEWNb9og


