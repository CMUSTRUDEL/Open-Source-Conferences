Title: PromCon 2018: Taking Advantage of Relabeling
Publication date: 2018-11-10
Playlist: PromCon 2018
Description: 
	Speaker: Julien Pivotto

Relabeling is a powerful feature of Prometheus but it is also quite specific to the project. This talk will explain and demonstrate relabeling, with some real use cases. After the presentation, you will understand relabeling and stop to copy/paste relabeling rules you don't understand.
Captions: 
	00:00:10,120 --> 00:00:16,180
[Applause]

00:00:12,300 --> 00:00:17,920
so I come from Belgium and my main

00:00:16,180 --> 00:00:20,380
interests are about automation my

00:00:17,920 --> 00:00:22,630
drivability I'm contributing to

00:00:20,380 --> 00:00:24,670
primitives to grow fauna and I am also

00:00:22,630 --> 00:00:26,800
I've also started the graph unit project

00:00:24,670 --> 00:00:29,619
so to create a graph and a dashboard

00:00:26,800 --> 00:00:32,590
using JSON it so I work for in which we

00:00:29,619 --> 00:00:34,360
have a European company we do open

00:00:32,590 --> 00:00:37,239
source consultancy across different

00:00:34,360 --> 00:00:38,320
kinds of organizations but now let's

00:00:37,239 --> 00:00:42,820
talk about labels

00:00:38,320 --> 00:00:44,920
so let's first get back to the basics

00:00:42,820 --> 00:00:47,289
like what symmetric in primitives well

00:00:44,920 --> 00:00:49,329
it's a name and then it's a key value

00:00:47,289 --> 00:00:51,070
pairs so that you have like the name of

00:00:49,329 --> 00:00:53,620
the matrix in this case it's like it's a

00:00:51,070 --> 00:00:55,899
proxy HTTP response is todo and then you

00:00:53,620 --> 00:00:57,399
have a catenary T which is all the

00:00:55,899 --> 00:00:59,769
different stuff that are attached to

00:00:57,399 --> 00:01:02,199
that like the back end is squid call

00:00:59,769 --> 00:01:04,839
this 1 X X environment is acceptance for

00:01:02,199 --> 00:01:08,080
example so all of that makes what we

00:01:04,839 --> 00:01:11,230
call a metric what you might not know is

00:01:08,080 --> 00:01:13,420
that a metric name is also a label like

00:01:11,230 --> 00:01:14,530
it is the label underscore underscore

00:01:13,420 --> 00:01:16,690
name is conozco

00:01:14,530 --> 00:01:19,150
so that's also a label so you can

00:01:16,690 --> 00:01:21,760
everywhere where you use a label you can

00:01:19,150 --> 00:01:23,880
actually alter the name change the name

00:01:21,760 --> 00:01:26,830
and you can do some stuff like that like

00:01:23,880 --> 00:01:29,110
you want to understand when the cadet is

00:01:26,830 --> 00:01:33,670
coming from then you can count your

00:01:29,110 --> 00:01:35,710
metrics by name so that you have the

00:01:33,670 --> 00:01:36,970
count value which usually removes the

00:01:35,710 --> 00:01:39,100
name of the metrics but you can

00:01:36,970 --> 00:01:42,970
explicitly say okay please keep the name

00:01:39,100 --> 00:01:46,690
so that I know which metrics after I ask

00:01:42,970 --> 00:01:49,330
add an ID for example primitives itself

00:01:46,690 --> 00:01:52,000
also add some labels when it scrapes

00:01:49,330 --> 00:01:55,390
metrics like it will add a job and an

00:01:52,000 --> 00:01:58,780
instance label you can add static labels

00:01:55,390 --> 00:02:01,540
also in the job configuration so that

00:01:58,780 --> 00:02:02,290
you also evolve EDF you always have

00:02:01,540 --> 00:02:06,580
basically

00:02:02,290 --> 00:02:10,149
labels attached to your metrics well you

00:02:06,580 --> 00:02:12,099
should at least so but labels is more

00:02:10,149 --> 00:02:14,410
than that so promoted is using them all

00:02:12,099 --> 00:02:17,050
over the place so it start in the

00:02:14,410 --> 00:02:19,750
configuration so when primitives is

00:02:17,050 --> 00:02:21,490
doing the configuration and it's looking

00:02:19,750 --> 00:02:22,730
hey what should i scrape now it will

00:02:21,490 --> 00:02:24,470
also have some

00:02:22,730 --> 00:02:26,659
labels to say okay this is my

00:02:24,470 --> 00:02:30,379
configuration this is my target so this

00:02:26,659 --> 00:02:32,599
is also using labels when it will fetch

00:02:30,379 --> 00:02:34,640
the targets it will fetch the labels

00:02:32,599 --> 00:02:38,019
that have exposed by the target but also

00:02:34,640 --> 00:02:39,830
at throne override one of the target and

00:02:38,019 --> 00:02:43,060
after it has done that

00:02:39,830 --> 00:02:46,310
it can also like alter the labels

00:02:43,060 --> 00:02:48,530
labelling and when you also record holes

00:02:46,310 --> 00:02:50,810
it will do the same it will use labels

00:02:48,530 --> 00:02:53,750
and it will enables you to add labels

00:02:50,810 --> 00:02:56,090
with your high cutting holes also in the

00:02:53,750 --> 00:02:57,680
Federation so when you have a printing

00:02:56,090 --> 00:03:00,290
service that's Federation other one it

00:02:57,680 --> 00:03:02,840
will get the external labels on top of

00:03:00,290 --> 00:03:05,420
the primitive levels and when it send

00:03:02,840 --> 00:03:07,129
alerts also it will add the labels for

00:03:05,420 --> 00:03:09,560
the remote right it will also add some

00:03:07,129 --> 00:03:12,500
labels so there are labels all over the

00:03:09,560 --> 00:03:15,769
place even some that you don't see like

00:03:12,500 --> 00:03:18,349
when you do the service discovery then

00:03:15,769 --> 00:03:20,239
you have some labels that establish

00:03:18,349 --> 00:03:23,120
under scan of committer that are added

00:03:20,239 --> 00:03:25,040
by the service discovery agents like for

00:03:23,120 --> 00:03:27,769
cuban it is for a pod you have like a

00:03:25,040 --> 00:03:29,510
lot of meter labels that you can use and

00:03:27,769 --> 00:03:31,400
reuse when you do the labelling when you

00:03:29,510 --> 00:03:35,000
want to configure your target you can

00:03:31,400 --> 00:03:37,370
just use them and it's like that for

00:03:35,000 --> 00:03:39,049
older services coffee including the file

00:03:37,370 --> 00:03:40,459
service discovery where you have like

00:03:39,049 --> 00:03:44,569
the first pass so you know where your

00:03:40,459 --> 00:03:46,280
target is coming from so what does

00:03:44,569 --> 00:03:48,739
redoubling means it means like you

00:03:46,280 --> 00:03:51,919
change the labels you add the labels you

00:03:48,739 --> 00:03:53,780
remove them whatever you want the only

00:03:51,919 --> 00:03:55,790
hole that you have is that you should

00:03:53,780 --> 00:03:59,690
not have duplicated matrix at the hand

00:03:55,790 --> 00:04:01,370
like if you remove a label from a metric

00:03:59,690 --> 00:04:03,680
you must be sure that at the end you

00:04:01,370 --> 00:04:05,180
still have the same number of matrix

00:04:03,680 --> 00:04:10,790
that you don't have a matrix with the

00:04:05,180 --> 00:04:12,829
same set of labels twice okay one last

00:04:10,790 --> 00:04:16,479
thing before we go into the subject like

00:04:12,829 --> 00:04:19,099
like X I know everyone loves rag X so

00:04:16,479 --> 00:04:21,650
promote issues only to regular

00:04:19,099 --> 00:04:24,169
expression while for me it just works

00:04:21,650 --> 00:04:26,720
it's like the red X I use everywhere

00:04:24,169 --> 00:04:28,550
else oh it's fine for me you need to

00:04:26,720 --> 00:04:31,250
know that ensured it means that if you

00:04:28,550 --> 00:04:33,500
use bar it will not match fuba because

00:04:31,250 --> 00:04:34,460
it will try to match from the beginning

00:04:33,500 --> 00:04:37,340
to the end

00:04:34,460 --> 00:04:39,740
so you can insure with the dots and

00:04:37,340 --> 00:04:42,610
Asterix sign and then you can also use

00:04:39,740 --> 00:04:45,110
capture groups to say okay this is

00:04:42,610 --> 00:04:47,690
something I don't know what I want to

00:04:45,110 --> 00:04:51,740
have that in a you know in a variable

00:04:47,690 --> 00:04:55,009
that I can use so some example that if

00:04:51,740 --> 00:04:58,009
you are familiar is tools like rep you

00:04:55,009 --> 00:05:00,620
will organize them so if I say from pipe

00:04:58,009 --> 00:05:05,360
other than it will much prom it will

00:05:00,620 --> 00:05:08,630
match alert if I use 201 and then square

00:05:05,360 --> 00:05:13,340
bracket 7/8 then it will match 2017 and

00:05:08,630 --> 00:05:15,410
2018 and then if I used the parenthesis

00:05:13,340 --> 00:05:19,039
it will also match things and make new

00:05:15,410 --> 00:05:22,190
variable like like you will expect it so

00:05:19,039 --> 00:05:24,410
let's go for relay billing so we're a

00:05:22,190 --> 00:05:27,139
billing is something that you add at the

00:05:24,410 --> 00:05:29,930
end of in the job configuration matrix

00:05:27,139 --> 00:05:31,789
it about config and then it's a list so

00:05:29,930 --> 00:05:33,620
primitives will do one after each other

00:05:31,789 --> 00:05:36,199
and it will hit a value or matrix like

00:05:33,620 --> 00:05:40,310
that so let's let's start with a simple

00:05:36,199 --> 00:05:41,930
one so because name is a label I can

00:05:40,310 --> 00:05:45,979
actually change the name of the matrix

00:05:41,930 --> 00:05:49,310
so we have a job SQL that will select

00:05:45,979 --> 00:05:52,010
from status table of any database system

00:05:49,310 --> 00:05:55,400
a bunch of matrix and we can just say

00:05:52,010 --> 00:05:57,620
okay this is my primitive metric name

00:05:55,400 --> 00:06:00,349
that's what the exporter will tell me

00:05:57,620 --> 00:06:03,099
and then in primitives I say okay now

00:06:00,349 --> 00:06:05,750
please do that please make that my

00:06:03,099 --> 00:06:08,630
metric name so that my metric name is

00:06:05,750 --> 00:06:12,470
actually logical and it's not like

00:06:08,630 --> 00:06:14,479
primitives query something auto and then

00:06:12,470 --> 00:06:17,690
the second step is okay because I know

00:06:14,479 --> 00:06:19,940
use that as my metric name I don't need

00:06:17,690 --> 00:06:23,330
the label so I can use the action label

00:06:19,940 --> 00:06:25,760
drop so each label step as an action and

00:06:23,330 --> 00:06:27,440
it you have multiple options one of them

00:06:25,760 --> 00:06:31,610
is table table it means I don't need

00:06:27,440 --> 00:06:34,610
that label so it means that that metric

00:06:31,610 --> 00:06:37,940
which is like the preference counter for

00:06:34,610 --> 00:06:39,949
a random database system which contains

00:06:37,940 --> 00:06:42,440
a primitive metric name called SQL

00:06:39,949 --> 00:06:45,110
Server on SQL databases will just become

00:06:42,440 --> 00:06:46,909
SQL Server databases and I will have

00:06:45,110 --> 00:06:47,650
less matrix and I will as matrix that I

00:06:46,909 --> 00:06:50,290
am of

00:06:47,650 --> 00:06:52,240
confident to see in the UI when I select

00:06:50,290 --> 00:06:54,550
metric so it makes more sense to have a

00:06:52,240 --> 00:06:56,979
metric like SQL Server databases and

00:06:54,550 --> 00:07:00,850
queries the wizard the MMOs performance

00:06:56,979 --> 00:07:03,580
is counterexample the second thing is

00:07:00,850 --> 00:07:06,400
extracting labels like we have a

00:07:03,580 --> 00:07:08,229
convention for each a proxy that the

00:07:06,400 --> 00:07:10,180
name of the backends mean something it's

00:07:08,229 --> 00:07:14,940
not just like a random name so we can

00:07:10,180 --> 00:07:18,490
just say okay for the each approxi

00:07:14,940 --> 00:07:21,430
matrix so we first look at the sauce

00:07:18,490 --> 00:07:23,139
labels which are the name and then we

00:07:21,430 --> 00:07:25,870
say okay the name should be like HM

00:07:23,139 --> 00:07:28,240
proxy its truth start with H a proxy and

00:07:25,870 --> 00:07:31,060
then we have the backend which is

00:07:28,240 --> 00:07:33,610
another label on the original H a proxy

00:07:31,060 --> 00:07:36,400
exposure I say okay we have four groups

00:07:33,610 --> 00:07:39,360
in our label which are delimited by

00:07:36,400 --> 00:07:43,840
columns and then we say okay I know that

00:07:39,360 --> 00:07:46,690
the second the second item is the

00:07:43,840 --> 00:07:48,370
environment and the first the first item

00:07:46,690 --> 00:07:50,770
is like the path note which we addressed

00:07:48,370 --> 00:07:56,110
using a cheap proxy so instead of having

00:07:50,770 --> 00:07:58,840
like a big pack and labeled and we can

00:07:56,110 --> 00:08:00,610
say okay this is like the partner this

00:07:58,840 --> 00:08:03,940
is like the environment of the partner

00:08:00,610 --> 00:08:06,639
so we know without doing complex queries

00:08:03,940 --> 00:08:07,990
or complex releases later on that from

00:08:06,639 --> 00:08:11,530
the script I'm will have the right

00:08:07,990 --> 00:08:15,610
target so this is the example so like if

00:08:11,530 --> 00:08:18,699
we have like a back-end which is like

00:08:15,610 --> 00:08:20,680
example ACC services something then I

00:08:18,699 --> 00:08:23,110
know that the partner will be example

00:08:20,680 --> 00:08:26,050
and that the environment of the partner

00:08:23,110 --> 00:08:28,720
will be like ACC and I don't need to

00:08:26,050 --> 00:08:31,990
actually do complex where he later and I

00:08:28,720 --> 00:08:33,310
have them just at script time and I

00:08:31,990 --> 00:08:36,700
don't need to change the expert on

00:08:33,310 --> 00:08:39,279
either another thing that you can do is

00:08:36,700 --> 00:08:42,430
dropping matrix so for example we are

00:08:39,279 --> 00:08:44,290
using JIRA and the gyri exporter by

00:08:42,430 --> 00:08:48,070
default will tell you when someone

00:08:44,290 --> 00:08:50,320
updates a ticket when someone will log

00:08:48,070 --> 00:08:52,779
in when someone will update an issue

00:08:50,320 --> 00:08:55,300
when someone will view a dashboard which

00:08:52,779 --> 00:08:56,620
is something that some problematic that

00:08:55,300 --> 00:08:58,209
you don't want to deal with inside

00:08:56,620 --> 00:09:00,339
primitives because they are not really

00:08:58,209 --> 00:09:01,310
useful so you can just say okay the

00:09:00,339 --> 00:09:04,250
metric whiz

00:09:01,310 --> 00:09:06,320
level name I just dropped them if the

00:09:04,250 --> 00:09:09,140
name is like jaha userlogin count

00:09:06,320 --> 00:09:10,700
because poet is not the location I want

00:09:09,140 --> 00:09:12,800
to use that but I also don't have the

00:09:10,700 --> 00:09:15,260
time to change the exposure to actually

00:09:12,800 --> 00:09:17,510
remove the privacy issue that I might

00:09:15,260 --> 00:09:20,950
have so I can just say okay drop the

00:09:17,510 --> 00:09:24,290
matrix that I don't want and you have

00:09:20,950 --> 00:09:27,440
the number of metrics available as a

00:09:24,290 --> 00:09:30,650
primitive metric which is like the SEM

00:09:27,440 --> 00:09:32,630
described samples scraped and then you

00:09:30,650 --> 00:09:34,190
can make a difference with the script

00:09:32,630 --> 00:09:35,480
sample post metric a doubling so that

00:09:34,190 --> 00:09:35,900
you know how many metrics you have

00:09:35,480 --> 00:09:38,990
dropped

00:09:35,900 --> 00:09:41,540
when you have crab on your target so

00:09:38,990 --> 00:09:45,710
that was for the matrix now the

00:09:41,540 --> 00:09:47,360
configuration so one of the use case to

00:09:45,710 --> 00:09:50,570
change the configuration is that you

00:09:47,360 --> 00:09:52,910
might want to reuse a target so if you

00:09:50,570 --> 00:09:56,360
scrape some targets using HTTP you might

00:09:52,910 --> 00:09:59,270
also want to use the same with a black

00:09:56,360 --> 00:10:02,360
box exposure so you know if the SSL

00:09:59,270 --> 00:10:04,040
certificate will expire or not so we

00:10:02,360 --> 00:10:07,250
have an initial job which is like okay

00:10:04,040 --> 00:10:09,680
we have a job go traffic and it will

00:10:07,250 --> 00:10:13,100
just be like we will scrap it using

00:10:09,680 --> 00:10:14,240
HTTPS and it will be like in a TC point

00:10:13,100 --> 00:10:17,690
is something using the file

00:10:14,240 --> 00:10:19,790
configuration so now we would like to

00:10:17,690 --> 00:10:23,360
use the same file so the traffic dots

00:10:19,790 --> 00:10:25,640
hammer to check the mutual SSL status or

00:10:23,360 --> 00:10:28,730
to check just the SSL status so we have

00:10:25,640 --> 00:10:31,130
the second job which I will do part but

00:10:28,730 --> 00:10:32,960
PI but which will use the same file as

00:10:31,130 --> 00:10:35,810
input but it will do something

00:10:32,960 --> 00:10:38,150
completely different it will not check

00:10:35,810 --> 00:10:40,160
if traffic is alive it will ask the

00:10:38,150 --> 00:10:43,370
black bucket exporter to inspire the SSL

00:10:40,160 --> 00:10:47,360
Certificates so let's take a look at the

00:10:43,370 --> 00:10:49,880
relating steps first of all this is not

00:10:47,360 --> 00:10:52,850
this is in the job configuration this is

00:10:49,880 --> 00:10:57,680
not the matrix fillable configs this is

00:10:52,850 --> 00:11:00,560
the head the head about convicts so the

00:10:57,680 --> 00:11:03,529
first thing is that okay we say yes so

00:11:00,560 --> 00:11:07,880
there is an address in the file that is

00:11:03,529 --> 00:11:10,070
my actual traffic address I will take

00:11:07,880 --> 00:11:13,520
that address and I will make it a

00:11:10,070 --> 00:11:15,080
parameter of my target so I will say

00:11:13,520 --> 00:11:17,870
like the replacement for the

00:11:15,080 --> 00:11:20,149
address is HTTP colon as well as traffic

00:11:17,870 --> 00:11:22,630
slash health so that this is a new

00:11:20,149 --> 00:11:25,670
parameter that I will hide to my target

00:11:22,630 --> 00:11:28,820
it means that when coitus will fetch the

00:11:25,670 --> 00:11:30,290
metric it will add that parameter which

00:11:28,820 --> 00:11:34,339
contained the original address but also

00:11:30,290 --> 00:11:36,890
like some prefix and suffix then I want

00:11:34,339 --> 00:11:39,800
to say okay I want to use the HTTP to xx

00:11:36,890 --> 00:11:42,440
as a module for my black box exporter

00:11:39,800 --> 00:11:44,540
which you can do in two ways we have

00:11:42,440 --> 00:11:46,490
used the matrix will appealing because

00:11:44,540 --> 00:11:48,019
then we have one configuration but you

00:11:46,490 --> 00:11:50,360
can also add that statically in this

00:11:48,019 --> 00:11:52,940
case because that replacement sent and

00:11:50,360 --> 00:11:54,470
target label is unconditional there is

00:11:52,940 --> 00:11:58,040
no condition it will just always do it

00:11:54,470 --> 00:11:59,360
and then we also add a a parameter so

00:11:58,040 --> 00:12:01,610
that we will change the address that

00:11:59,360 --> 00:12:03,380
primitives needs to scrape to be like

00:12:01,610 --> 00:12:06,680
that fixed address which we know is the

00:12:03,380 --> 00:12:09,200
black box exporter so the initial

00:12:06,680 --> 00:12:12,050
address before we where he labelling

00:12:09,200 --> 00:12:14,390
that would be like the SS traffic slash

00:12:12,050 --> 00:12:16,250
probe and we changed that to first

00:12:14,390 --> 00:12:18,950
change the address that we want to label

00:12:16,250 --> 00:12:21,500
and then we had a bunch of parameters at

00:12:18,950 --> 00:12:23,570
the end so that the black box exporter

00:12:21,500 --> 00:12:25,579
can work and because we are using the

00:12:23,570 --> 00:12:27,050
same input the same file as input we

00:12:25,579 --> 00:12:29,750
know that everything that we scrape

00:12:27,050 --> 00:12:34,370
using the traffic job we also monitor

00:12:29,750 --> 00:12:37,730
the SSL certificate so we have dropped

00:12:34,370 --> 00:12:39,649
the Jireh to Jireh matrix that we don't

00:12:37,730 --> 00:12:41,630
want but you can also say you have two

00:12:39,649 --> 00:12:43,370
primary servers and you want okay to

00:12:41,630 --> 00:12:46,610
split the loads between the two of them

00:12:43,370 --> 00:12:48,290
but using the same configuration what

00:12:46,610 --> 00:12:51,320
you can do is just say ok I will take

00:12:48,290 --> 00:12:54,620
all the older even IP addresses on one

00:12:51,320 --> 00:12:56,630
side and I will take the other ones on

00:12:54,620 --> 00:12:59,149
the other side so you can use action

00:12:56,630 --> 00:13:02,000
drop and action keep to say ok this is

00:12:59,149 --> 00:13:03,620
the matrix I want to scrape and on the

00:13:02,000 --> 00:13:05,899
other side this is the metric I don't

00:13:03,620 --> 00:13:07,760
want I am NOT interested to get them so

00:13:05,899 --> 00:13:10,190
you can also say ok if you have too many

00:13:07,760 --> 00:13:12,380
targets you can search just ok I will

00:13:10,190 --> 00:13:14,390
use two primitive servers and I will do

00:13:12,380 --> 00:13:17,230
something simple like this to split them

00:13:14,390 --> 00:13:19,550
and let me get all of them all the time

00:13:17,230 --> 00:13:21,920
electing so what can you do in yoga

00:13:19,550 --> 00:13:24,589
double alerts so informatics is sending

00:13:21,920 --> 00:13:28,490
Alice to the alert measure it can add it

00:13:24,589 --> 00:13:30,080
can add the external labels which

00:13:28,490 --> 00:13:32,209
means that if you have like your

00:13:30,080 --> 00:13:34,250
primitive server in the external label

00:13:32,209 --> 00:13:35,089
what will happen is that the as manager

00:13:34,250 --> 00:13:37,700
we say okay

00:13:35,089 --> 00:13:39,740
those two others I will not hope them I

00:13:37,700 --> 00:13:40,399
will not diplucate them because they are

00:13:39,740 --> 00:13:43,070
different

00:13:40,399 --> 00:13:44,420
the point is server is different and you

00:13:43,070 --> 00:13:46,310
don't want that actually you don't want

00:13:44,420 --> 00:13:48,589
to say to have like you have left twice

00:13:46,310 --> 00:13:50,029
in the alert manager so what you do is

00:13:48,589 --> 00:13:52,339
that you had a lot of high level

00:13:50,029 --> 00:13:54,170
configuration that say ok you see that

00:13:52,339 --> 00:13:56,810
point is server when you send an alert

00:13:54,170 --> 00:13:58,399
so that's in the alerting part just say

00:13:56,810 --> 00:14:01,250
that it is the point from the data

00:13:58,399 --> 00:14:02,180
center one that that's sending the alert

00:14:01,250 --> 00:14:06,529
so that you don't

00:14:02,180 --> 00:14:09,770
yes manager knows ok this is 27 from dc1

00:14:06,529 --> 00:14:13,880
and i I can just notice when to allow

00:14:09,770 --> 00:14:16,310
the same in that case what you can also

00:14:13,880 --> 00:14:18,529
do is to add a default label to your

00:14:16,310 --> 00:14:22,339
Hallows so that was a tricky one because

00:14:18,529 --> 00:14:25,310
you can not by default at an empty reg X

00:14:22,339 --> 00:14:28,279
to your to your other so what we have

00:14:25,310 --> 00:14:31,040
done is we have just put parentheses

00:14:28,279 --> 00:14:33,230
between single quotes and then what you

00:14:31,040 --> 00:14:35,690
have at the end is a default value which

00:14:33,230 --> 00:14:37,310
is p1 so in this case if we have an

00:14:35,690 --> 00:14:40,279
alert that is sent to the art manager

00:14:37,310 --> 00:14:42,920
that doesn't have a priority label then

00:14:40,279 --> 00:14:47,600
we automatically had a priority you can

00:14:42,920 --> 00:14:49,670
do that with all kind of you can of

00:14:47,600 --> 00:14:52,190
allows that you might want like okay

00:14:49,670 --> 00:14:54,560
what we also do is we had as an instance

00:14:52,190 --> 00:14:57,470
the poetry server by default is there is

00:14:54,560 --> 00:14:59,660
no instance label so if we are hoping

00:14:57,470 --> 00:15:01,640
lots of labels and we had an instance

00:14:59,660 --> 00:15:04,700
labor so that when the lab manager

00:15:01,640 --> 00:15:07,010
receives information he knows we know

00:15:04,700 --> 00:15:10,070
that there will be that instance label

00:15:07,010 --> 00:15:11,720
all the time for all the alerts if there

00:15:10,070 --> 00:15:14,089
is already a priority then it will

00:15:11,720 --> 00:15:18,290
simply not be in that high level in

00:15:14,089 --> 00:15:20,270
configuration the the last use case is

00:15:18,290 --> 00:15:24,500
the remote fry so you know primitives

00:15:20,270 --> 00:15:27,290
that will speak to another database

00:15:24,500 --> 00:15:29,990
system to say ok this is my matrix you

00:15:27,290 --> 00:15:33,200
can also say ok but so for the remote

00:15:29,990 --> 00:15:36,500
right I actually only want to keep like

00:15:33,200 --> 00:15:38,900
the matrix that start with job for

00:15:36,500 --> 00:15:40,340
example so that you only sent to the

00:15:38,900 --> 00:15:43,670
remote

00:15:40,340 --> 00:15:46,520
the remote right side we only send the

00:15:43,670 --> 00:15:48,560
hit matrix and not everything that

00:15:46,520 --> 00:15:50,990
purchase is doing which is also very

00:15:48,560 --> 00:15:52,940
useful because then you can because the

00:15:50,990 --> 00:15:55,250
remote right is also at least you can

00:15:52,940 --> 00:15:57,710
say okay for that back end I sent those

00:15:55,250 --> 00:15:59,570
matrix for that other back end I can set

00:15:57,710 --> 00:16:02,360
other matrix and that's not a program so

00:15:59,570 --> 00:16:05,240
that's another use case for doubling and

00:16:02,360 --> 00:16:07,400
you can also alter the the your

00:16:05,240 --> 00:16:09,589
primitive server if you want to like

00:16:07,400 --> 00:16:11,660
unify them in the remote right from your

00:16:09,589 --> 00:16:16,930
two different purchase server you can

00:16:11,660 --> 00:16:19,550
also do that so collaborating is

00:16:16,930 --> 00:16:22,040
something that's actually quite unique

00:16:19,550 --> 00:16:23,660
to primitives I have been using a lot of

00:16:22,040 --> 00:16:25,339
open-source software I've never seen

00:16:23,660 --> 00:16:27,200
something like that in any other place

00:16:25,339 --> 00:16:29,779
so it's something that you really need

00:16:27,200 --> 00:16:33,230
to learn and use primitives even if you

00:16:29,779 --> 00:16:35,089
can perfectly use it without that except

00:16:33,230 --> 00:16:37,910
the day you want to use the assembly

00:16:35,089 --> 00:16:39,589
exporter then you are like yeah I need

00:16:37,910 --> 00:16:42,260
to copy and paste this and then it will

00:16:39,589 --> 00:16:44,950
work so it's important to understand it

00:16:42,260 --> 00:16:46,880
because like the assembly exporter

00:16:44,950 --> 00:16:48,980
configuration is good one but you can

00:16:46,880 --> 00:16:54,770
improve that and make it like a better

00:16:48,980 --> 00:16:56,570
fire for your own stuff so it's also

00:16:54,770 --> 00:16:58,970
important to know that you can do that

00:16:56,570 --> 00:17:00,830
in prom ql also so you have function in

00:16:58,970 --> 00:17:03,020
pump ql that can also at all I'll tell

00:17:00,830 --> 00:17:04,819
the labels and you can also just

00:17:03,020 --> 00:17:06,709
dropping matrix and dropping

00:17:04,819 --> 00:17:09,290
configuration is also important so that

00:17:06,709 --> 00:17:10,939
scalable Inc is not just for your matrix

00:17:09,290 --> 00:17:12,679
but if you learn that once you can apply

00:17:10,939 --> 00:17:15,829
that to your configuration as well which

00:17:12,679 --> 00:17:18,439
is very very great and also like being

00:17:15,829 --> 00:17:20,150
able to drop matrix helps a lot in lots

00:17:18,439 --> 00:17:22,880
of cases when you just don't want to

00:17:20,150 --> 00:17:24,319
like deal with some exporters that don't

00:17:22,880 --> 00:17:26,600
behave like you would like them to

00:17:24,319 --> 00:17:29,360
behave and so that you limit the hover

00:17:26,600 --> 00:17:29,840
hat on your printer server okay that was

00:17:29,360 --> 00:17:31,970
it

00:17:29,840 --> 00:17:34,130
one last word I will give a practice

00:17:31,970 --> 00:17:36,200
mode workshop in Berlin in November so

00:17:34,130 --> 00:17:39,170
if you are interested it will be more on

00:17:36,200 --> 00:17:41,630
produce 101 with so the resistance ooh

00:17:39,170 --> 00:17:44,130
so thank you if you have any questions

00:17:41,630 --> 00:17:47,940
now I will take them happily

00:17:44,130 --> 00:17:55,060
[Applause]

00:17:47,940 --> 00:17:56,620
over that much question any hands or is

00:17:55,060 --> 00:17:58,900
relabeling now solved for everyone

00:17:56,620 --> 00:18:10,600
forever and I will no longer get any

00:17:58,900 --> 00:18:15,400
questions about did I understand that

00:18:10,600 --> 00:18:17,710
you can do relabeling and prima QL yeah

00:18:15,400 --> 00:18:20,410
you have the the you have the liberal

00:18:17,710 --> 00:18:22,300
hippies and the label join functions

00:18:20,410 --> 00:18:25,480
that you can join labels and you can

00:18:22,300 --> 00:18:29,710
also replace values from labels yes and

00:18:25,480 --> 00:18:31,990
you can change them also and label

00:18:29,710 --> 00:18:34,510
replace also enables you to add new

00:18:31,990 --> 00:18:36,100
labels so if you let the tool as

00:18:34,510 --> 00:18:37,600
parameters empty then you can add a new

00:18:36,100 --> 00:18:39,910
label to your matrix if you want it

00:18:37,600 --> 00:18:44,710
which is very useful especially like in

00:18:39,910 --> 00:18:48,550
the lefting you can use that a great

00:18:44,710 --> 00:18:50,980
talk so can you give us an idea when

00:18:48,550 --> 00:18:57,370
it's good idea to use really link and

00:18:50,980 --> 00:19:00,850
when in prom code to use so in general

00:18:57,370 --> 00:19:02,140
we we don't do that much in Punk you'll

00:19:00,850 --> 00:19:04,480
directly to that directly in the

00:19:02,140 --> 00:19:07,060
configuration but when you do the

00:19:04,480 --> 00:19:09,130
recording holds then it's a location and

00:19:07,060 --> 00:19:11,110
use deliberately place which why never

00:19:09,130 --> 00:19:15,460
to use that in the graph on apart

00:19:11,110 --> 00:19:17,620
because we we prefer to have the

00:19:15,460 --> 00:19:22,240
dashboard having minimal impact on the

00:19:17,620 --> 00:19:24,690
printed servers hey optimized - any

00:19:22,240 --> 00:19:24,690
other questions

00:19:33,470 --> 00:19:40,380
yes hi I miss you too and think about

00:19:37,740 --> 00:19:42,830
the dope and labels it's applied for all

00:19:40,380 --> 00:19:45,330
historical data or just starting to

00:19:42,830 --> 00:19:48,090
change the configuration can you repeat

00:19:45,330 --> 00:19:51,180
the question I mean the doping labels

00:19:48,090 --> 00:19:55,590
it's applied for historical data or

00:19:51,180 --> 00:19:58,350
 already in parameters also primer

00:19:55,590 --> 00:20:00,690
it is never changes historical data so

00:19:58,350 --> 00:20:02,340
what you can do if you really want to

00:20:00,690 --> 00:20:06,270
change your cycle data you need to use

00:20:02,340 --> 00:20:08,160
the punctual functions to do that and it

00:20:06,270 --> 00:20:21,960
will only be computed when you do the

00:20:08,160 --> 00:20:24,780
query ok but hi so do you ever envision

00:20:21,960 --> 00:20:27,060
using relabeling and maybe dropping

00:20:24,780 --> 00:20:30,180
labels as a way to rate limiter use

00:20:27,060 --> 00:20:33,180
users and like if yes then how can we do

00:20:30,180 --> 00:20:35,400
it dynamically can you repeat the

00:20:33,180 --> 00:20:37,440
question so you know you can drop

00:20:35,400 --> 00:20:39,660
metrics right so I was wondering can we

00:20:37,440 --> 00:20:42,450
use that as a way to rate limit users so

00:20:39,660 --> 00:20:44,810
have a way that we can figure out okay

00:20:42,450 --> 00:20:47,130
how how much somebody is emitting and

00:20:44,810 --> 00:20:50,420
dynamically applied we labeling as a way

00:20:47,130 --> 00:20:53,520
to really mean well the problem is

00:20:50,420 --> 00:20:56,190
dropping matrix is that at the end the

00:20:53,520 --> 00:20:58,800
exporter will always compute the matrix

00:20:56,190 --> 00:21:00,540
first so easily want to like lower the

00:20:58,800 --> 00:21:02,430
depression of the exporter you should

00:21:00,540 --> 00:21:04,530
modify the missive dropping the matrix

00:21:02,430 --> 00:21:09,960
picked because it will expose the matrix

00:21:04,530 --> 00:21:11,520
anyway so yeah what we do to solve some

00:21:09,960 --> 00:21:13,650
performance issue is that we have some

00:21:11,520 --> 00:21:16,290
primitives that we dedicate to some

00:21:13,650 --> 00:21:18,480
graph on our instances so that they only

00:21:16,290 --> 00:21:20,250
like fiddy evaded R&D servers and only

00:21:18,480 --> 00:21:21,840
take the matrix that matter so but

00:21:20,250 --> 00:21:32,240
that's when we have lots of user for

00:21:21,840 --> 00:21:32,240
some - words any more questions

00:21:33,549 --> 00:21:37,400
no I guess not well thank you very much

00:21:35,720 --> 00:21:41,479
Jillian thank you

00:21:37,400 --> 00:21:41,479

YouTube URL: https://www.youtube.com/watch?v=QufG6rjbsOM


