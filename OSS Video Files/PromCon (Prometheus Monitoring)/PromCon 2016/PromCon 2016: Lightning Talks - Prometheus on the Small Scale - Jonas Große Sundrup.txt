Title: PromCon 2016: Lightning Talks - Prometheus on the Small Scale - Jonas Große Sundrup
Publication date: 2016-09-04
Playlist: PromCon 2016
Description: 
	* Abstract:

Jonas Große Sundrup from Universität Heidelberg explains how he uses Prometheus for backup monitoring on the small scale.

* PromCon website:

https://promcon.io/
Captions: 
	00:00:03,290 --> 00:00:08,629
hi I want to talk about a little bit

00:00:05,960 --> 00:00:10,639
about primitive on the small scale I'm

00:00:08,629 --> 00:00:11,840
sysadmin in the work in a group in the

00:00:10,639 --> 00:00:13,849
information science department at the

00:00:11,840 --> 00:00:15,740
University of Heidelberg and there i use

00:00:13,849 --> 00:00:18,170
Prometheus for our local infrastructure

00:00:15,740 --> 00:00:20,630
we have the talk yesterday of breaking

00:00:18,170 --> 00:00:23,000
Prometheus scaling hi this is basically

00:00:20,630 --> 00:00:24,200
the opposite where I'm scaling low

00:00:23,000 --> 00:00:26,119
because we just have a handful of

00:00:24,200 --> 00:00:28,279
machines but I still think that

00:00:26,119 --> 00:00:31,369
prometheus is useful in this case and

00:00:28,279 --> 00:00:34,040
especially you at your modern receiving

00:00:31,369 --> 00:00:36,500
devices looking at the video now if you

00:00:34,040 --> 00:00:38,540
think if you should use Prometheus for

00:00:36,500 --> 00:00:39,500
your hand full of servers I say yes you

00:00:38,540 --> 00:00:41,810
certainly showed and there are some

00:00:39,500 --> 00:00:43,700
reasons for that and the first thing is

00:00:41,810 --> 00:00:46,240
it is amazingly simple to set up you

00:00:43,700 --> 00:00:48,980
just have to fire up the previous binary

00:00:46,240 --> 00:00:51,350
an alert manager and then the node

00:00:48,980 --> 00:00:54,350
exporter which is kind of quickly done

00:00:51,350 --> 00:00:57,739
and then you basically already have a

00:00:54,350 --> 00:01:00,020
running monitoring solution and and also

00:00:57,739 --> 00:01:01,880
you have not only the monitoring but you

00:01:00,020 --> 00:01:04,879
have also alerting included and graphing

00:01:01,880 --> 00:01:06,350
so you don't need to have the monitoring

00:01:04,879 --> 00:01:08,210
and besides that to collect d

00:01:06,350 --> 00:01:10,850
additionally but it's all in one in one

00:01:08,210 --> 00:01:13,340
piece and especially there's four small

00:01:10,850 --> 00:01:15,229
setups I really like the text file

00:01:13,340 --> 00:01:16,670
collector which is one of the collectors

00:01:15,229 --> 00:01:19,430
of the knoll exporter where you just

00:01:16,670 --> 00:01:21,799
hack can have your script or your cron

00:01:19,430 --> 00:01:23,390
jobs or your timers generate some

00:01:21,799 --> 00:01:26,060
metrics and just write them to a file

00:01:23,390 --> 00:01:28,100
somewhere in the somewhere in the in the

00:01:26,060 --> 00:01:29,780
in the file system and then the node

00:01:28,100 --> 00:01:31,580
exporter is exporting these metrics as

00:01:29,780 --> 00:01:35,060
well this is one example where I

00:01:31,580 --> 00:01:36,950
actually using that this is our backup

00:01:35,060 --> 00:01:40,190
system I'm there is one machine that I

00:01:36,950 --> 00:01:41,930
need to backup and what this script is

00:01:40,190 --> 00:01:44,000
doing its an arse encrypt script it runs

00:01:41,930 --> 00:01:46,189
every night just hours ings the entire

00:01:44,000 --> 00:01:48,470
server on to the backup device and then

00:01:46,189 --> 00:01:50,450
it writes out just some of the metrics

00:01:48,470 --> 00:01:53,619
like how long did the backup take when

00:01:50,450 --> 00:01:57,229
did it finish to a file in the in the

00:01:53,619 --> 00:01:59,840
where the prom weather note exporter

00:01:57,229 --> 00:02:02,090
looks at and then export these metrics

00:01:59,840 --> 00:02:04,130
with me so I can just let Prometheus

00:02:02,090 --> 00:02:06,799
check when did the last backup run and

00:02:04,130 --> 00:02:08,509
if that's too old then please tell me

00:02:06,799 --> 00:02:12,019
that something is not working there and

00:02:08,509 --> 00:02:14,989
I can just say how long did it take how

00:02:12,019 --> 00:02:16,510
big is it which is actually which I'm

00:02:14,989 --> 00:02:18,310
actually cheating what

00:02:16,510 --> 00:02:20,829
with regard to the size because I'm just

00:02:18,310 --> 00:02:23,349
saying okay tell me how much free space

00:02:20,829 --> 00:02:26,260
i have and tell me how much free space i

00:02:23,349 --> 00:02:29,860
had 24 hours ago and the difference must

00:02:26,260 --> 00:02:32,049
be my backup right and as I'm doing as

00:02:29,860 --> 00:02:33,970
I'm using our zinc and do some

00:02:32,049 --> 00:02:36,909
deduplication and basic deduplication by

00:02:33,970 --> 00:02:38,709
using ours and hard links I'm thinking

00:02:36,909 --> 00:02:41,170
also about if I can get the number of

00:02:38,709 --> 00:02:43,720
inodes to get the number of changed

00:02:41,170 --> 00:02:46,299
files because if the file doesn't change

00:02:43,720 --> 00:02:48,370
our zinc will use the same inode but if

00:02:46,299 --> 00:02:50,079
the file changes it would copy this the

00:02:48,370 --> 00:02:51,790
file again and it should use a different

00:02:50,079 --> 00:02:55,540
I note so you can actually if there

00:02:51,790 --> 00:02:58,060
isn't an inode metric somewhere you can

00:02:55,540 --> 00:03:00,370
use that or I plan to use that to

00:02:58,060 --> 00:03:04,450
actually track how many files did a copy

00:03:00,370 --> 00:03:06,370
and yeah so that is basically it if

00:03:04,450 --> 00:03:09,250
you're wondering if Prometheus works on

00:03:06,370 --> 00:03:11,590
the small scale I can really say that it

00:03:09,250 --> 00:03:14,920
works perfectly well you don't even have

00:03:11,590 --> 00:03:16,420
to use automation to run it roll it out

00:03:14,920 --> 00:03:18,370
although I don't say that you shouldn't

00:03:16,420 --> 00:03:20,590
because automate automation is awesome

00:03:18,370 --> 00:03:21,849
but it's easy enough that you even if

00:03:20,590 --> 00:03:23,260
you don't have automation in place you

00:03:21,849 --> 00:03:27,250
can still use it because it's amazingly

00:03:23,260 --> 00:03:31,019
easy to set up alright any questions if

00:03:27,250 --> 00:03:31,019

YouTube URL: https://www.youtube.com/watch?v=Z6dtCbFa3Ks


