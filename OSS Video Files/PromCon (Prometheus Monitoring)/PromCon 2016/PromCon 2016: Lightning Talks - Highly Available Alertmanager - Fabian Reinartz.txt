Title: PromCon 2016: Lightning Talks - Highly Available Alertmanager - Fabian Reinartz
Publication date: 2016-09-04
Playlist: PromCon 2016
Description: 
	* Abstract:

Fabian Reinartz from CoreOS talks about the upcoming highly available Alertmanager implementation.

* Slides:

https://docs.google.com/presentation/d/1isitpzL8gyytevZLYYGwplorSnF9NPgGQ5Aom3V28IY/edit?usp=sharing

* PromCon website:

https://promcon.io/
Captions: 
	00:00:03,460 --> 00:00:08,149
so really quick five minutes right and

00:00:06,050 --> 00:00:09,740
so I will tell you about highly valuable

00:00:08,149 --> 00:00:11,390
road manager which is sort of like my

00:00:09,740 --> 00:00:13,730
work in progress kind of thing right now

00:00:11,390 --> 00:00:16,010
I'm working for us on prometheus

00:00:13,730 --> 00:00:18,140
sometimes and the current state of the

00:00:16,010 --> 00:00:19,849
alert ninja is that you have all these

00:00:18,140 --> 00:00:22,070
promises servers which are pushing us to

00:00:19,849 --> 00:00:23,269
the allotment so it essentially means

00:00:22,070 --> 00:00:25,880
that it measures the most critical

00:00:23,269 --> 00:00:27,859
component of the entire setup just that

00:00:25,880 --> 00:00:29,810
it's one single node and this can sort

00:00:27,859 --> 00:00:34,370
of die and there's no real story out now

00:00:29,810 --> 00:00:37,250
to sort of rug around that so what you

00:00:34,370 --> 00:00:38,420
want is you want smart meters right and

00:00:37,250 --> 00:00:40,789
if you want all these permissive servers

00:00:38,420 --> 00:00:41,989
to just push the alerts and basically

00:00:40,789 --> 00:00:43,879
have all these different lipman just

00:00:41,989 --> 00:00:45,859
sort of make everything works and work

00:00:43,879 --> 00:00:49,609
and if one fails the other one other

00:00:45,859 --> 00:00:51,230
ones will handle it so what you don't

00:00:49,609 --> 00:00:54,170
want is this one and this is basically

00:00:51,230 --> 00:00:55,820
what everybody comes up with if they if

00:00:54,170 --> 00:00:59,059
we talk about basically making a

00:00:55,820 --> 00:01:00,620
tailored manager on my a/c and the basic

00:00:59,059 --> 00:01:02,899
it was okay everybody's using raft and

00:01:00,620 --> 00:01:05,780
rafters doing gps oh this must be great

00:01:02,899 --> 00:01:08,420
right the only thing is that raft is a

00:01:05,780 --> 00:01:11,570
CP algorithm and it works based on

00:01:08,420 --> 00:01:13,460
contents consensus and you can only do

00:01:11,570 --> 00:01:15,850
something basically if you have

00:01:13,460 --> 00:01:18,079
conventus as if you have a petition here

00:01:15,850 --> 00:01:19,970
you can do all singing things you want

00:01:18,079 --> 00:01:22,040
here but here you can't buy seed do

00:01:19,970 --> 00:01:24,110
anything and then you start coming

00:01:22,040 --> 00:01:25,220
efforts okay and maybe you can just like

00:01:24,110 --> 00:01:26,840
if you don't have Continentals here

00:01:25,220 --> 00:01:28,670
which is like alone we can walk around

00:01:26,840 --> 00:01:30,979
to some in some way but then you're

00:01:28,670 --> 00:01:34,579
talking about AP actually you don't want

00:01:30,979 --> 00:01:36,920
CP in this case MN AP sort of this right

00:01:34,579 --> 00:01:38,659
we have just several luck managers and

00:01:36,920 --> 00:01:41,180
they sort of all work independently as

00:01:38,659 --> 00:01:43,880
good as I can and if they can see the

00:01:41,180 --> 00:01:46,610
others it's good if not well still not

00:01:43,880 --> 00:01:49,369
end of the world and this sort of

00:01:46,610 --> 00:01:52,009
usually means eventual consistency so if

00:01:49,369 --> 00:01:53,869
you do right or do you take an extra

00:01:52,009 --> 00:01:56,180
more alert minja it will not immediately

00:01:53,869 --> 00:01:58,399
visible everywhere just after some time

00:01:56,180 --> 00:01:59,780
which might be a few milliseconds or

00:01:58,399 --> 00:02:03,950
maybe few minutes depending on the

00:01:59,780 --> 00:02:06,469
current situation of the network and

00:02:03,950 --> 00:02:08,360
this would suffer like this so if you

00:02:06,469 --> 00:02:10,280
want to create a silence now you

00:02:08,360 --> 00:02:12,560
basically do this in the interface of on

00:02:10,280 --> 00:02:14,330
redmond jump and as soon as it's done

00:02:12,560 --> 00:02:16,340
this science becomes visible in this

00:02:14,330 --> 00:02:16,940
allotment immediately and then it sort

00:02:16,340 --> 00:02:19,910
of propagate

00:02:16,940 --> 00:02:22,100
as fast as I can and through the rest of

00:02:19,910 --> 00:02:27,370
the basically network of a lot ninjas

00:02:22,100 --> 00:02:30,590
and and pretty much the same applies to

00:02:27,370 --> 00:02:33,650
selling our notifications so let's say I

00:02:30,590 --> 00:02:36,290
want to page someone right and I don't

00:02:33,650 --> 00:02:38,570
want all of these alert managers to send

00:02:36,290 --> 00:02:40,310
out pages because page of duty for

00:02:38,570 --> 00:02:42,290
example deduplicated for you but for

00:02:40,310 --> 00:02:43,550
example if you send out emails you will

00:02:42,290 --> 00:02:46,220
just get five inmates in this case and

00:02:43,550 --> 00:02:48,860
you don't want it and so what we do is

00:02:46,220 --> 00:02:51,320
we basically lock that you have notified

00:02:48,860 --> 00:02:53,420
a certain receiver about basically set

00:02:51,320 --> 00:02:55,670
of alerts and then we propagates

00:02:53,420 --> 00:02:58,720
information just like silences across

00:02:55,670 --> 00:02:58,720
the entire network

00:02:58,940 --> 00:03:05,150
and so I can make to ensure that we only

00:03:01,880 --> 00:03:07,100
send ba notification and this because

00:03:05,150 --> 00:03:09,440
this basically requires us to basically

00:03:07,100 --> 00:03:11,510
communicator orchestrate who gets the

00:03:09,440 --> 00:03:13,150
sense Dufner right you got otherwise all

00:03:11,510 --> 00:03:15,380
the different let me just would

00:03:13,150 --> 00:03:20,720
basically attempt at the same time %

00:03:15,380 --> 00:03:24,440
notification and this whole oops lock

00:03:20,720 --> 00:03:26,510
thing here won't really help so what you

00:03:24,440 --> 00:03:28,550
want to do is you don't really want to

00:03:26,510 --> 00:03:30,080
this basically be in the critical code

00:03:28,550 --> 00:03:31,550
pass right from the point where you get

00:03:30,080 --> 00:03:33,680
alerts you point to your cell

00:03:31,550 --> 00:03:35,740
notifications you don't want to avoid at

00:03:33,680 --> 00:03:37,520
all costs basically to have any

00:03:35,740 --> 00:03:39,170
intercommunication going on because this

00:03:37,520 --> 00:03:41,540
is always point where things can break

00:03:39,170 --> 00:03:43,850
and this is what you want to avoid so

00:03:41,540 --> 00:03:45,320
what piece to do is and every point in

00:03:43,850 --> 00:03:47,720
time even if you can't talk to certain

00:03:45,320 --> 00:03:50,420
other leg manages directly we sort of

00:03:47,720 --> 00:03:53,120
have this state or a state of the entire

00:03:50,420 --> 00:03:55,280
network of allotment just um and thereby

00:03:53,120 --> 00:03:57,740
we can say okay and this is me and this

00:03:55,280 --> 00:04:00,680
is a list of my PS and ever sort this

00:03:57,740 --> 00:04:03,860
list by name or IP or whatever and where

00:04:00,680 --> 00:04:09,050
am i and for example in the case of a

00:04:03,860 --> 00:04:11,270
here is slightly Singh I can basic just

00:04:09,050 --> 00:04:15,110
figure of my position and then just wait

00:04:11,270 --> 00:04:16,880
a bit my waiting I just give the alert

00:04:15,110 --> 00:04:18,350
manager who sees itself as a first in

00:04:16,880 --> 00:04:20,450
the list some time to tell a

00:04:18,350 --> 00:04:23,180
notification and for the notification

00:04:20,450 --> 00:04:25,669
log to propagate to the network and then

00:04:23,180 --> 00:04:27,530
basically at the time I try to send I

00:04:25,669 --> 00:04:29,690
can say okay let's lock already and I

00:04:27,530 --> 00:04:33,140
see the receiver was notified and I

00:04:29,690 --> 00:04:34,610
don't have to do it anymore so this

00:04:33,140 --> 00:04:37,130
basically how this whole thing works

00:04:34,610 --> 00:04:39,500
right we are using this and great weave

00:04:37,130 --> 00:04:42,980
mesh library by Peter whoever years um

00:04:39,500 --> 00:04:46,100
to basically build this mesh which by a

00:04:42,980 --> 00:04:48,440
gossip distributed state MP just by

00:04:46,100 --> 00:04:50,300
eventual consistency this book all our

00:04:48,440 --> 00:04:51,590
data but every load manager from

00:04:50,300 --> 00:04:53,870
receiving alerts to sending out

00:04:51,590 --> 00:04:55,640
notifications basically works completely

00:04:53,870 --> 00:04:59,419
independently without ever talking

00:04:55,640 --> 00:05:01,310
directly to this mesh network so this is

00:04:59,419 --> 00:05:02,690
sort of the short version of it and

00:05:01,310 --> 00:05:05,300
tomorrow there will be the general talk

00:05:02,690 --> 00:05:07,600
on loading so basically this sort of

00:05:05,300 --> 00:05:11,590
part will not be in there but more there

00:05:07,600 --> 00:05:11,590

YouTube URL: https://www.youtube.com/watch?v=XvqaYbiTOMg


