Title: "API != REST - procmail to the rescue" - Bruno Cornec, FREDERIC PASSERON (LCA 2021 Online)
Publication date: 2021-02-18
Playlist: System Administration Miniconf (LCA 2021)
Description: 
	Bruno Cornec, FREDERIC PASSERON

https://lca2021.linux.org.au/schedule/presentation/96/

These days, most people speaking APIs think REST API. It's ubiquitous, uses standard protocols and formats, based on giants shoulders...
For the sysadmin REST API like Redfish is a nice way to have a cross-manufacturer out of band management interface e.g.

However in some case, you have constraints that do not allow you to use a REST API. When your system is not reachable directly using the HTTPS protocol e.g.  In that case, you can still use an API of course, but based on other standards, such as the venerable STMP one !

Our use case, a training on demand workshop system, involves a Web front-end to manage user registration to run jupyter notebooks hosted on a back-end hosting the jupyterhub instance as well as all the companion systems needed to perform the various workshops proposed (on Redfish, Git, Rust as visible on https://hackshack.hpedev.io/workshops)

So to make it work flawlessly, we used an SMTP based API, the front-end generating the SMTP content and the back-end using procmail, some scripts and ansible playbooks to manage the setup of the user environment. Once logged on the platform, the user has acces to its own workshop content, with all the links to the other systems available to perform the actions. Why SMTP ? Well our needs were small enough to avoid developing a full REST one (even if if have also one for the front-end), we benefit from the asynchronous aspect of e-mail for free in the management of requests, and it's fun to use old methods to show young engineers that there is more than one way to do it ;-)

Interested ? Well come to hear how we did that and we'll show you how it works, from the automatic deployment of the platform up to the run of a workshop.

linux.conf.au is a conference about the Linux operating system, and all aspects of the thriving ecosystem of Free and Open Source Software that has grown up around it. Run since 1999, in a different Australian or New Zealand city each year, by a team of local volunteers, LCA invites more than 500 people to learn from the people who shape the future of Open Source. For more information on the conference see https://linux.conf.au/

Produced by Next Day Video Australia: https://nextdayvideo.com.au

#linux.conf.au #linux #foss #opensource

Sat Jan 23 10:45:00 2021 at Blemings Labs
Captions: 
	00:00:10,820 --> 00:00:14,060
[Music]

00:00:15,839 --> 00:00:20,560
and so up first

00:00:16,960 --> 00:00:22,480
as you might be able to see um is bruno

00:00:20,560 --> 00:00:25,039
and frederick both speaking from

00:00:22,480 --> 00:00:26,240
france in the middle of the night it is

00:00:25,039 --> 00:00:28,240
after midnight for them

00:00:26,240 --> 00:00:29,279
but they have arrived today thank you

00:00:28,240 --> 00:00:31,760
very much

00:00:29,279 --> 00:00:32,480
and so over to you brendon frederick

00:00:31,760 --> 00:00:35,600
talking to

00:00:32,480 --> 00:00:38,399
us about api and how wrist and proc mail

00:00:35,600 --> 00:00:40,480
can work together

00:00:38,399 --> 00:00:42,320
thank you very much for the introduction

00:00:40,480 --> 00:00:43,120
and welcome everybody especially for

00:00:42,320 --> 00:00:45,440
those of you

00:00:43,120 --> 00:00:46,960
down on there uh we'll try to make our

00:00:45,440 --> 00:00:48,559
best to cover the topic in

00:00:46,960 --> 00:00:50,800
in the short amount of time that we have

00:00:48,559 --> 00:00:52,559
so first let me introduce myself my name

00:00:50,800 --> 00:00:54,719
is bruno connect i'm working

00:00:52,559 --> 00:00:56,879
in juret pacquiao for the last 20 years

00:00:54,719 --> 00:01:00,079
now and but i've been doing

00:00:56,879 --> 00:01:03,199
with my my friend attacks over there uh

00:01:00,079 --> 00:01:07,119
stuff since 93 0

00:01:03,199 --> 00:01:08,960
99 pf13 for those of you who know that

00:01:07,119 --> 00:01:11,040
and i've been doing various set of stuff

00:01:08,960 --> 00:01:12,000
in the linux and open source area being

00:01:11,040 --> 00:01:15,040
upstream for some

00:01:12,000 --> 00:01:15,759
projects and i've been happy to to be in

00:01:15,040 --> 00:01:18,799
fact

00:01:15,759 --> 00:01:22,280
in australia for previous linux

00:01:18,799 --> 00:01:25,520
australia conferences back in 2007

00:01:22,280 --> 00:01:28,000
2013 and 2014 and

00:01:25,520 --> 00:01:29,439
it's very uh i'm very happy and glad to

00:01:28,000 --> 00:01:32,240
be able to to talk with

00:01:29,439 --> 00:01:33,920
with you again this year and i will now

00:01:32,240 --> 00:01:36,079
pass a mic to to felik who will

00:01:33,920 --> 00:01:38,400
introduce himself

00:01:36,079 --> 00:01:40,000
well uh good day everyone my name is

00:01:38,400 --> 00:01:42,079
frederic pastron and i've been working

00:01:40,000 --> 00:01:43,840
for hp for the last 20 years as well i

00:01:42,079 --> 00:01:44,320
think we joined hp nearly in the same

00:01:43,840 --> 00:01:47,200
year

00:01:44,320 --> 00:01:49,040
with no ni i've been working in hp in

00:01:47,200 --> 00:01:50,720
the pre-sales organization ever since i

00:01:49,040 --> 00:01:51,759
mean moving back and forth between you

00:01:50,720 --> 00:01:55,439
know

00:01:51,759 --> 00:01:57,360
i would say local region like france to

00:01:55,439 --> 00:01:59,360
emea then to worldwide and i've been

00:01:57,360 --> 00:02:00,960
focusing on infrastructure management

00:01:59,360 --> 00:02:02,960
solution mainly

00:02:00,960 --> 00:02:04,399
from the early days of hpc and down to

00:02:02,960 --> 00:02:06,240
the cloud days with

00:02:04,399 --> 00:02:08,319
openstack and now kubernetes and all

00:02:06,240 --> 00:02:09,360
this stuff i'm currently part of the

00:02:08,319 --> 00:02:12,400
team which is the

00:02:09,360 --> 00:02:13,120
hp dev experience team and we are

00:02:12,400 --> 00:02:14,959
delivering

00:02:13,120 --> 00:02:17,280
a hack shack and we're delivering a

00:02:14,959 --> 00:02:20,080
program that is called the hp developer

00:02:17,280 --> 00:02:21,680
community program and uh hack shack is

00:02:20,080 --> 00:02:24,640
one of the physical aspect

00:02:21,680 --> 00:02:26,160
uh of it that we were taking or taking

00:02:24,640 --> 00:02:28,879
care of during the events

00:02:26,160 --> 00:02:30,319
moving now to virtual and as part of it

00:02:28,879 --> 00:02:32,160
we were delivering workshops

00:02:30,319 --> 00:02:34,000
and all of these hands-on training that

00:02:32,160 --> 00:02:34,879
we used to do live we're now doing them

00:02:34,000 --> 00:02:37,200
virtual

00:02:34,879 --> 00:02:38,080
and we're making them available as well

00:02:37,200 --> 00:02:40,560
so they're using

00:02:38,080 --> 00:02:41,360
jupyter notebooks and uh really that's

00:02:40,560 --> 00:02:43,200
about it

00:02:41,360 --> 00:02:45,599
i would say and when i'm not doing the

00:02:43,200 --> 00:02:47,120
computing stuff and working for hp

00:02:45,599 --> 00:02:49,760
as you can see the background i'm

00:02:47,120 --> 00:02:50,640
playing with ify and building up some

00:02:49,760 --> 00:02:53,599
musical stream

00:02:50,640 --> 00:02:54,239
as well and sometimes asking bruno to

00:02:53,599 --> 00:02:56,319
come over and

00:02:54,239 --> 00:02:57,360
give me some help with some coding and

00:02:56,319 --> 00:03:00,000
that's about it yeah

00:02:57,360 --> 00:03:00,640
and i can i can also bring some some cds

00:03:00,000 --> 00:03:03,280
that i have

00:03:00,640 --> 00:03:04,879
behind me as well to to so that we can

00:03:03,280 --> 00:03:07,360
hear stuff together

00:03:04,879 --> 00:03:08,959
so let's first talk about uh what we

00:03:07,360 --> 00:03:10,400
were talking about so frederick

00:03:08,959 --> 00:03:12,319
gave you information about the the

00:03:10,400 --> 00:03:14,319
activity which is doing workshop on

00:03:12,319 --> 00:03:17,040
demand and how does it work and

00:03:14,319 --> 00:03:19,040
what infrastructure did we put in place

00:03:17,040 --> 00:03:20,080
and what type of tools did we use to

00:03:19,040 --> 00:03:23,120
make all that work

00:03:20,080 --> 00:03:26,400
so first we have

00:03:23,120 --> 00:03:29,599
a student who was willing to

00:03:26,400 --> 00:03:30,080
pass a workshop on demand and so he has

00:03:29,599 --> 00:03:32,799
first

00:03:30,080 --> 00:03:34,959
to look at our portals the registration

00:03:32,799 --> 00:03:38,400
portal register itself

00:03:34,959 --> 00:03:40,560
and through the http

00:03:38,400 --> 00:03:43,280
and his web browser it will be able to

00:03:40,560 --> 00:03:46,720
make a query to our system

00:03:43,280 --> 00:03:50,080
our system will then

00:03:46,720 --> 00:03:51,920
discuss with

00:03:50,080 --> 00:03:53,840
a complete infrastructure which is

00:03:51,920 --> 00:03:55,680
private in fact which is not

00:03:53,840 --> 00:03:57,599
reachable from the outside from the

00:03:55,680 --> 00:03:58,799
internet so the first question we had

00:03:57,599 --> 00:04:00,480
when we when we

00:03:58,799 --> 00:04:02,239
wanted to put that infrastructure in

00:04:00,480 --> 00:04:03,680
place and say okay we have the

00:04:02,239 --> 00:04:05,599
registration portal which is

00:04:03,680 --> 00:04:06,879
hosted on netlify how do we make the

00:04:05,599 --> 00:04:08,159
discussion with something which is

00:04:06,879 --> 00:04:11,680
internal and then

00:04:08,159 --> 00:04:12,239
we talk about okay everybody was doing

00:04:11,680 --> 00:04:14,959
you know

00:04:12,239 --> 00:04:16,720
new stuff there's a new kid in play once

00:04:14,959 --> 00:04:18,560
they want to play with rest api they

00:04:16,720 --> 00:04:21,359
want to do https so some

00:04:18,560 --> 00:04:21,919
new and really enjoying stuff and i'm

00:04:21,359 --> 00:04:23,759
i'm

00:04:21,919 --> 00:04:25,520
a little guy and i said okay but you

00:04:23,759 --> 00:04:26,800
know you are behind the firewall it's

00:04:25,520 --> 00:04:28,000
very complicated from a network

00:04:26,800 --> 00:04:29,360
perspective you will have to

00:04:28,000 --> 00:04:31,040
put some proxies and we will have

00:04:29,360 --> 00:04:32,400
security issues and it will be very

00:04:31,040 --> 00:04:34,000
difficult so say

00:04:32,400 --> 00:04:36,000
i would like to propose something which

00:04:34,000 --> 00:04:39,360
is from my point of view much simpler

00:04:36,000 --> 00:04:42,560
which is to discuss from the portal uh

00:04:39,360 --> 00:04:43,919
here to the jupiter notebook servers the

00:04:42,560 --> 00:04:46,560
server hosting in fact

00:04:43,919 --> 00:04:47,440
there's a majority of activities that we

00:04:46,560 --> 00:04:49,040
need to

00:04:47,440 --> 00:04:51,040
handle to set up the infrastructure

00:04:49,040 --> 00:04:54,880
correctly that server

00:04:51,040 --> 00:04:57,600
can really easily have

00:04:54,880 --> 00:04:59,759
the mail as an smtp server receive mail

00:04:57,600 --> 00:05:02,160
from the outside it's difficult to

00:04:59,759 --> 00:05:03,120
have an interactive connection which is

00:05:02,160 --> 00:05:05,199
live between

00:05:03,120 --> 00:05:07,680
a client and server but that's very easy

00:05:05,199 --> 00:05:11,360
when you deal with smtp because it's uh

00:05:07,680 --> 00:05:13,280
asynchronous by essence so

00:05:11,360 --> 00:05:14,800
we put that in place and that server in

00:05:13,280 --> 00:05:16,880
fact which is hosting our

00:05:14,800 --> 00:05:18,320
jupiter hub infrastructure is also

00:05:16,880 --> 00:05:20,639
equipped with space fix

00:05:18,320 --> 00:05:21,919
and proc mail and process requests

00:05:20,639 --> 00:05:25,680
coming from that portal

00:05:21,919 --> 00:05:28,639
then using this information it will

00:05:25,680 --> 00:05:29,280
talk to the backend appliances which

00:05:28,639 --> 00:05:32,080
could be

00:05:29,280 --> 00:05:34,479
physical servers which could be virtual

00:05:32,080 --> 00:05:37,680
machines which could be containers

00:05:34,479 --> 00:05:40,080
using ssh connection using rest api

00:05:37,680 --> 00:05:40,960
and it will set up book in fact the

00:05:40,080 --> 00:05:43,120
environment

00:05:40,960 --> 00:05:44,960
deploys a notebook for the students

00:05:43,120 --> 00:05:46,960
create the student environment

00:05:44,960 --> 00:05:48,240
and once all that is done behind the

00:05:46,960 --> 00:05:51,360
scene it will then

00:05:48,240 --> 00:05:54,000
talk to our backend system and register

00:05:51,360 --> 00:05:55,199
really the user in our in our database

00:05:54,000 --> 00:05:57,440
which manage

00:05:55,199 --> 00:05:59,520
which is managing all the user

00:05:57,440 --> 00:06:00,000
information workshop information and

00:05:59,520 --> 00:06:03,360
which

00:06:00,000 --> 00:06:07,120
serve also as a base for for

00:06:03,360 --> 00:06:12,080
https queries from the posifix

00:06:07,120 --> 00:06:15,360
jupiter hub server once this is done

00:06:12,080 --> 00:06:18,800
we will then inform

00:06:15,360 --> 00:06:20,160
the user through again mail that he has

00:06:18,800 --> 00:06:23,120
successfully registered

00:06:20,160 --> 00:06:23,840
that the workshop on demand is ready to

00:06:23,120 --> 00:06:26,319
use

00:06:23,840 --> 00:06:28,080
and we give him the credentials that we

00:06:26,319 --> 00:06:28,639
will have to use to connect to the

00:06:28,080 --> 00:06:30,479
system

00:06:28,639 --> 00:06:32,240
and to be able to perform the workshop

00:06:30,479 --> 00:06:36,880
and from now on

00:06:32,240 --> 00:06:39,120
he has four hours to be able to perform

00:06:36,880 --> 00:06:40,000
the workshop he has booked through the

00:06:39,120 --> 00:06:42,720
system

00:06:40,000 --> 00:06:45,199
so he logged on the system he has access

00:06:42,720 --> 00:06:46,240
to the notebook we have multiple type of

00:06:45,199 --> 00:06:48,880
workshops we will

00:06:46,240 --> 00:06:49,280
disclose that a bit later on and he will

00:06:48,880 --> 00:06:51,520
talk

00:06:49,280 --> 00:06:52,560
during his notebook jupiter notebook so

00:06:51,520 --> 00:06:54,400
which is based on

00:06:52,560 --> 00:06:55,599
on different set of kernels depending on

00:06:54,400 --> 00:06:57,599
on the

00:06:55,599 --> 00:06:59,440
workshop we want to make and during

00:06:57,599 --> 00:07:01,440
those execution of

00:06:59,440 --> 00:07:03,120
code through the notebook the jupyter

00:07:01,440 --> 00:07:04,400
notebook he will talk to the backend

00:07:03,120 --> 00:07:06,479
infrastructure

00:07:04,400 --> 00:07:08,639
which could host as we said different

00:07:06,479 --> 00:07:09,599
type of appliance depending whether he

00:07:08,639 --> 00:07:13,759
is

00:07:09,599 --> 00:07:15,039
performing a git 101 type of workshop or

00:07:13,759 --> 00:07:18,000
a more complex

00:07:15,039 --> 00:07:20,000
envelopes hp container platform type of

00:07:18,000 --> 00:07:21,039
workshop because we have a very large

00:07:20,000 --> 00:07:23,199
range of

00:07:21,039 --> 00:07:24,560
more introductory type of workshops and

00:07:23,199 --> 00:07:26,560
more high-end type of workshops

00:07:24,560 --> 00:07:30,639
depending on what people want to

00:07:26,560 --> 00:07:33,280
uh explore with regards to technology

00:07:30,639 --> 00:07:34,960
so that's how the infrastructure is

00:07:33,280 --> 00:07:35,599
working and we will demonstrate that to

00:07:34,960 --> 00:07:39,280
you

00:07:35,599 --> 00:07:42,479
uh just a bit later on so we used

00:07:39,280 --> 00:07:45,039
in fact a mail api not an arrest and

00:07:42,479 --> 00:07:46,720
a very modern stuff https and

00:07:45,039 --> 00:07:47,919
certificates and all that type of stuff

00:07:46,720 --> 00:07:50,800
no no no

00:07:47,919 --> 00:07:52,319
we are all guys we do all type of stuff

00:07:50,800 --> 00:07:55,039
on our site to complement

00:07:52,319 --> 00:07:55,919
what is difficult to do with a full rest

00:07:55,039 --> 00:07:58,720
api

00:07:55,919 --> 00:07:59,280
uh not having a direct connection

00:07:58,720 --> 00:08:02,560
between

00:07:59,280 --> 00:08:03,440
the frontal netify and that jupiter hub

00:08:02,560 --> 00:08:05,680
machine

00:08:03,440 --> 00:08:07,680
uh male is very convenient because mail

00:08:05,680 --> 00:08:09,759
can go through very complex network

00:08:07,680 --> 00:08:11,360
topology without any problem

00:08:09,759 --> 00:08:13,080
going through the firewalls going to

00:08:11,360 --> 00:08:16,240
indirect not

00:08:13,080 --> 00:08:18,160
non-interconnected networks very easily

00:08:16,240 --> 00:08:20,479
it provides for free a queueing system

00:08:18,160 --> 00:08:22,720
you send mail it's put in various queues

00:08:20,479 --> 00:08:23,919
up to the final system it's re-delivered

00:08:22,720 --> 00:08:25,680
in case you have issues

00:08:23,919 --> 00:08:27,199
of course we want to have the most

00:08:25,680 --> 00:08:29,440
interactive

00:08:27,199 --> 00:08:30,240
way of working between the user making

00:08:29,440 --> 00:08:32,640
the

00:08:30,240 --> 00:08:34,719
request and the deployment of the

00:08:32,640 --> 00:08:36,959
infrastructure however

00:08:34,719 --> 00:08:38,640
having a queuing system is very helpful

00:08:36,959 --> 00:08:41,599
in that in that context

00:08:38,640 --> 00:08:43,839
then the server receiving the mail is

00:08:41,599 --> 00:08:44,640
using a small tool called procmail which

00:08:43,839 --> 00:08:47,440
helps

00:08:44,640 --> 00:08:48,640
managing the api requests and we have

00:08:47,440 --> 00:08:51,040
like a rest api

00:08:48,640 --> 00:08:51,920
we have verbs so we have the verb create

00:08:51,040 --> 00:08:55,040
we have the verb

00:08:51,920 --> 00:08:56,959
cleanup we have the verb reset

00:08:55,040 --> 00:08:58,640
and then we have some parameters that

00:08:56,959 --> 00:09:01,920
are not passed through

00:08:58,640 --> 00:09:03,600
json or that type of mechanism that you

00:09:01,920 --> 00:09:06,320
use with rest environment

00:09:03,600 --> 00:09:07,440
but here we just use some parameters on

00:09:06,320 --> 00:09:09,920
the subject line

00:09:07,440 --> 00:09:10,800
and some other parameters in the body of

00:09:09,920 --> 00:09:13,120
the mail

00:09:10,800 --> 00:09:14,959
so typically here we have the the number

00:09:13,120 --> 00:09:17,279
of the student on on the subject line

00:09:14,959 --> 00:09:19,519
and the name of the workshop in the body

00:09:17,279 --> 00:09:20,880
and then we call a script so we pass all

00:09:19,519 --> 00:09:22,640
that through a pipe

00:09:20,880 --> 00:09:23,920
to the proc my action script that we

00:09:22,640 --> 00:09:26,800
have created

00:09:23,920 --> 00:09:28,560
with the match which corresponds to the

00:09:26,800 --> 00:09:31,440
parameter which has been detected

00:09:28,560 --> 00:09:33,440
in the subject line so it's easy to

00:09:31,440 --> 00:09:36,240
filter input it's easy to manage

00:09:33,440 --> 00:09:37,360
parameters and it's very easy to call a

00:09:36,240 --> 00:09:40,000
script which does

00:09:37,360 --> 00:09:42,320
all the dirty stuff behind the scene and

00:09:40,000 --> 00:09:44,880
that script is a mix of shell script

00:09:42,320 --> 00:09:46,959
unseable playbooks because we have a

00:09:44,880 --> 00:09:48,800
large infrastructure to deploy behind

00:09:46,959 --> 00:09:50,800
once we receive the request from from

00:09:48,800 --> 00:09:53,120
the outside also it was

00:09:50,800 --> 00:09:54,000
pretty easy to to perform the test

00:09:53,120 --> 00:09:56,959
because we have

00:09:54,000 --> 00:09:58,160
another small script which has support

00:09:56,959 --> 00:10:01,040
for the same verbs

00:09:58,160 --> 00:10:01,760
as what our production environment has

00:10:01,040 --> 00:10:05,120
and we just

00:10:01,760 --> 00:10:07,200
have to send a mail using those verbs to

00:10:05,120 --> 00:10:08,640
the local host system when we do the

00:10:07,200 --> 00:10:10,560
test on the machine

00:10:08,640 --> 00:10:11,760
and it's pretty convenient to also make

00:10:10,560 --> 00:10:13,680
our test uh

00:10:11,760 --> 00:10:15,680
in parallel with uh with a production

00:10:13,680 --> 00:10:19,279
and we have logging and mechanisms

00:10:15,680 --> 00:10:21,600
like that coming for free

00:10:19,279 --> 00:10:22,640
so as i said the the infrastructure of

00:10:21,600 --> 00:10:26,000
to to

00:10:22,640 --> 00:10:28,079
provision it we use mainly ansible

00:10:26,000 --> 00:10:29,680
environmental so there are plenty of

00:10:28,079 --> 00:10:31,440
tools available that's the one

00:10:29,680 --> 00:10:32,880
we know the best so that's the one we

00:10:31,440 --> 00:10:34,399
decided to use

00:10:32,880 --> 00:10:36,399
and uncivil is in charge in our

00:10:34,399 --> 00:10:38,720
environment to manage different type

00:10:36,399 --> 00:10:40,480
of activities first it's in charge of

00:10:38,720 --> 00:10:44,480
the platform installation so our

00:10:40,480 --> 00:10:47,440
jupiter hub machine itself is deployed

00:10:44,480 --> 00:10:49,440
automatically from a deployment server

00:10:47,440 --> 00:10:50,640
with a minimum set of packages and

00:10:49,440 --> 00:10:53,839
software installed on it

00:10:50,640 --> 00:10:55,040
and then we have a large ansible

00:10:53,839 --> 00:10:57,360
playbook which does

00:10:55,040 --> 00:10:58,720
all the setup and we did that because we

00:10:57,360 --> 00:11:00,640
wanted to be able to

00:10:58,720 --> 00:11:01,920
provide that feature to other teams

00:11:00,640 --> 00:11:04,240
inside hpe

00:11:01,920 --> 00:11:06,800
able to reuse our development so they

00:11:04,240 --> 00:11:09,519
can set up very easily their own jupiter

00:11:06,800 --> 00:11:09,519
hub environment

00:11:10,240 --> 00:11:15,839
sorry my time is flying time yeah yeah i

00:11:16,399 --> 00:11:21,200
is doing conformity and convergence each

00:11:19,200 --> 00:11:22,880
night we run an ansible playbook

00:11:21,200 --> 00:11:24,240
to be sure that the platforms take

00:11:22,880 --> 00:11:26,079
consistent

00:11:24,240 --> 00:11:27,680
and also it does the student

00:11:26,079 --> 00:11:28,640
instantiation and the notebook

00:11:27,680 --> 00:11:31,839
instantiation

00:11:28,640 --> 00:11:33,519
for us so that every student is

00:11:31,839 --> 00:11:36,000
recreated from scratch

00:11:33,519 --> 00:11:37,519
every time a new notebook is generated

00:11:36,000 --> 00:11:39,279
and we benefit from

00:11:37,519 --> 00:11:41,519
some interesting features inside the

00:11:39,279 --> 00:11:42,240
notebooks we can use jinja extensions

00:11:41,519 --> 00:11:45,279
for example

00:11:42,240 --> 00:11:46,160
inside the notebook to customize a

00:11:45,279 --> 00:11:47,760
notebook

00:11:46,160 --> 00:11:50,079
with regards to the student we made the

00:11:47,760 --> 00:11:52,880
request so using the student id

00:11:50,079 --> 00:11:54,880
and using some variables we can really

00:11:52,880 --> 00:11:58,800
associate a student to a set of machines

00:11:54,880 --> 00:12:02,079
to a set of vms etc etc

00:11:58,800 --> 00:12:05,680
okay now it's time to

00:12:02,079 --> 00:12:07,920
jump on the video

00:12:05,680 --> 00:12:08,800
okay so play the video so this is the

00:12:07,920 --> 00:12:10,720
hack shack

00:12:08,800 --> 00:12:11,839
and i think the links were copied over

00:12:10,720 --> 00:12:14,079
in the chat room

00:12:11,839 --> 00:12:15,360
so you can see it's a nice website where

00:12:14,079 --> 00:12:16,000
you can actually perform different

00:12:15,360 --> 00:12:17,600
things

00:12:16,000 --> 00:12:19,760
you can check out for some challenges

00:12:17,600 --> 00:12:20,639
some information some replays videos of

00:12:19,760 --> 00:12:22,639
all the action

00:12:20,639 --> 00:12:24,240
and all the workshops that you have and

00:12:22,639 --> 00:12:25,760
we'll be going to the workshop section

00:12:24,240 --> 00:12:27,760
so within the workshop page you can

00:12:25,760 --> 00:12:29,839
actually see some different tiles

00:12:27,760 --> 00:12:31,200
appearing there and they're displaying

00:12:29,839 --> 00:12:33,120
the different workshops that we are

00:12:31,200 --> 00:12:34,639
proposing in our environment so there's

00:12:33,120 --> 00:12:36,880
a few of them around

00:12:34,639 --> 00:12:39,040
the esmerald portfolio a few around

00:12:36,880 --> 00:12:41,839
programming and some other stuff around

00:12:39,040 --> 00:12:42,560
open source like uh bromide which is our

00:12:41,839 --> 00:12:44,880
you know

00:12:42,560 --> 00:12:47,040
uh open source project within hp so i

00:12:44,880 --> 00:12:48,720
choose uh python 101 because i'm not a

00:12:47,040 --> 00:12:49,920
very good developer so i need to take

00:12:48,720 --> 00:12:52,800
some courses on

00:12:49,920 --> 00:12:55,279
python so what why not this one so it's

00:12:52,800 --> 00:12:56,880
a discovery workshop on on python so i

00:12:55,279 --> 00:12:59,680
just register into my email

00:12:56,880 --> 00:13:01,680
my name company name and i read the

00:12:59,680 --> 00:13:02,160
terms and condition that tells me that i

00:13:01,680 --> 00:13:04,399
need to

00:13:02,160 --> 00:13:06,399
i'm running for four hours only and at

00:13:04,399 --> 00:13:07,120
the end of the four hours everything

00:13:06,399 --> 00:13:10,079
will be

00:13:07,120 --> 00:13:11,440
wiped out from the system uh including

00:13:10,079 --> 00:13:13,519
the work that i did so

00:13:11,440 --> 00:13:15,519
i need to to to work during this uh

00:13:13,519 --> 00:13:17,360
these four hours which is largely enough

00:13:15,519 --> 00:13:19,519
to perform most of the most of the

00:13:17,360 --> 00:13:20,959
workshop and actually

00:13:19,519 --> 00:13:22,880
checked for the video as well at the

00:13:20,959 --> 00:13:24,240
same time so i'm registering and so at

00:13:22,880 --> 00:13:25,920
the very same time this

00:13:24,240 --> 00:13:27,360
front-end application is calling the

00:13:25,920 --> 00:13:29,920
back-end database

00:13:27,360 --> 00:13:31,440
and registering myself as a new customer

00:13:29,920 --> 00:13:34,639
so i can see my name

00:13:31,440 --> 00:13:36,399
the workshop i selected the notebook and

00:13:34,639 --> 00:13:38,000
the email that will be sent to me is a

00:13:36,399 --> 00:13:39,600
welcome email that's the first one the

00:13:38,000 --> 00:13:40,079
first of the series of four that will be

00:13:39,600 --> 00:13:41,600
sent

00:13:40,079 --> 00:13:43,839
and i can see that i've been assigned

00:13:41,600 --> 00:13:45,440
the student id so this information the

00:13:43,839 --> 00:13:47,279
student id will be passed

00:13:45,440 --> 00:13:49,040
to the back to the backend as you can

00:13:47,279 --> 00:13:50,560
see and this is the script that is

00:13:49,040 --> 00:13:51,440
running in the back end so we can see

00:13:50,560 --> 00:13:54,160
the verb

00:13:51,440 --> 00:13:55,839
creation okay that the bruno talked to

00:13:54,160 --> 00:13:58,240
you about a moment ago

00:13:55,839 --> 00:14:00,079
and so we can see that is the customer

00:13:58,240 --> 00:14:02,320
name and customer email address

00:14:00,079 --> 00:14:04,480
and the id of the student that will be

00:14:02,320 --> 00:14:06,639
delivering on

00:14:04,480 --> 00:14:07,760
so the verb is to create so i'll be i

00:14:06,639 --> 00:14:09,920
mean the the

00:14:07,760 --> 00:14:11,120
the automation will be creating the

00:14:09,920 --> 00:14:13,519
necessary uh

00:14:11,120 --> 00:14:14,720
environment for the student six nine six

00:14:13,519 --> 00:14:16,079
i would say so it's checking the

00:14:14,720 --> 00:14:19,360
workshop id if i remember

00:14:16,079 --> 00:14:22,320
well and from there you'll be

00:14:19,360 --> 00:14:22,800
you know doing some other stuff around

00:14:22,320 --> 00:14:24,560
uh

00:14:22,800 --> 00:14:26,480
you know preparing the notebook copying

00:14:24,560 --> 00:14:27,360
the notebook generating a random

00:14:26,480 --> 00:14:29,519
password

00:14:27,360 --> 00:14:31,839
informing the back end as well that

00:14:29,519 --> 00:14:33,680
we've been doing all the necessary work

00:14:31,839 --> 00:14:35,199
uh for him to tell the customer that his

00:14:33,680 --> 00:14:38,639
environment is ready

00:14:35,199 --> 00:14:39,839
so obviously we'll be at the at the very

00:14:38,639 --> 00:14:41,680
end so we're here

00:14:39,839 --> 00:14:43,199
just generating the random password then

00:14:41,680 --> 00:14:44,880
we're doing the interval copy

00:14:43,199 --> 00:14:46,639
so we're using the playbook to actually

00:14:44,880 --> 00:14:48,959
copy over all the necessary

00:14:46,639 --> 00:14:49,920
notebooks into the students folder and

00:14:48,959 --> 00:14:52,399
we're erasing

00:14:49,920 --> 00:14:52,959
everything by default before copying

00:14:52,399 --> 00:14:55,680
that's a

00:14:52,959 --> 00:14:56,800
kind of a security measure that we took

00:14:55,680 --> 00:14:59,680
and at the end we do

00:14:56,800 --> 00:15:00,399
we do actually two api calls passing

00:14:59,680 --> 00:15:02,480
over the

00:15:00,399 --> 00:15:03,680
the password to the back end to be sent

00:15:02,480 --> 00:15:06,160
to the customer

00:15:03,680 --> 00:15:07,680
and uh obviously setting up the customer

00:15:06,160 --> 00:15:08,560
as an active so if i go back to the

00:15:07,680 --> 00:15:10,480
database

00:15:08,560 --> 00:15:12,000
and i do a refresh on the table i will

00:15:10,480 --> 00:15:14,560
see that now

00:15:12,000 --> 00:15:16,000
i'm not anymore in i mean i need to

00:15:14,560 --> 00:15:19,040
check that i receive my

00:15:16,000 --> 00:15:19,360
emails which is the case okay so this is

00:15:19,040 --> 00:15:22,800
my

00:15:19,360 --> 00:15:24,800
wonderful mailbox okay this is the mail

00:15:22,800 --> 00:15:27,199
that i received so in the first mail

00:15:24,800 --> 00:15:28,880
this is a welcome message i mean giving

00:15:27,199 --> 00:15:29,600
me information about how to run the

00:15:28,880 --> 00:15:31,440
workshop

00:15:29,600 --> 00:15:32,639
providing the information on the video

00:15:31,440 --> 00:15:35,759
replay that is

00:15:32,639 --> 00:15:37,600
uh i would say link to the workshop

00:15:35,759 --> 00:15:39,199
and so on so forth in the second email i

00:15:37,600 --> 00:15:40,079
get the credentials and i can actually

00:15:39,199 --> 00:15:42,959
click on the start

00:15:40,079 --> 00:15:45,360
workshop and register i mean and open up

00:15:42,959 --> 00:15:48,160
the browser to actually do the workshop

00:15:45,360 --> 00:15:49,040
this actually feature will disappear

00:15:48,160 --> 00:15:50,959
over time

00:15:49,040 --> 00:15:52,880
we will be providing an autoloading

00:15:50,959 --> 00:15:54,240
feature directly in the email

00:15:52,880 --> 00:15:56,320
where the customer wouldn't have to take

00:15:54,240 --> 00:15:59,360
any order the work the

00:15:56,320 --> 00:16:01,360
the password and uh and type it in so

00:15:59,360 --> 00:16:03,360
just a very quick well you can move on

00:16:01,360 --> 00:16:05,120
this one is just to show that uh

00:16:03,360 --> 00:16:07,120
we've been deploying the workshop in the

00:16:05,120 --> 00:16:08,639
back end okay so if you can move just a

00:16:07,120 --> 00:16:11,360
bit quicker because i don't think we

00:16:08,639 --> 00:16:13,360
have that much time left

00:16:11,360 --> 00:16:15,839
yeah you can you can't see it anymore

00:16:13,360 --> 00:16:17,519
okay so we'll be jumping to

00:16:15,839 --> 00:16:19,279
the workshop itself so i'm logging in

00:16:17,519 --> 00:16:21,360
now with the

00:16:19,279 --> 00:16:23,120
provided password okay and i'll be

00:16:21,360 --> 00:16:24,800
launching my notebook

00:16:23,120 --> 00:16:27,199
and then i'll be doing the note the

00:16:24,800 --> 00:16:29,680
workshop itself so i'll be opening up

00:16:27,199 --> 00:16:30,639
you know the readme to introduce sorry

00:16:29,680 --> 00:16:32,480
the workshop

00:16:30,639 --> 00:16:33,759
then doing the lab itself which is a

00:16:32,480 --> 00:16:36,880
simple api

00:16:33,759 --> 00:16:38,240
simple python 101 labs so it's going to

00:16:36,880 --> 00:16:40,720
be fairly easy so

00:16:38,240 --> 00:16:41,600
obviously we'll need to show that we

00:16:40,720 --> 00:16:44,000
have plenty of

00:16:41,600 --> 00:16:44,959
kernels available this one is the python

00:16:44,000 --> 00:16:48,079
3 tunnel

00:16:44,959 --> 00:16:50,000
obviously based workshop and this is the

00:16:48,079 --> 00:16:52,160
workshop itself so what is python and

00:16:50,000 --> 00:16:53,759
now you just execute the different cells

00:16:52,160 --> 00:16:55,600
so the notebooks are based you know on

00:16:53,759 --> 00:16:57,199
markdown and uh

00:16:55,600 --> 00:16:59,440
cells where you can actually run some

00:16:57,199 --> 00:17:01,040
codes so this is only just simple python

00:16:59,440 --> 00:17:03,360
code for people who want to learn

00:17:01,040 --> 00:17:04,799
license so you can move on quicker if

00:17:03,360 --> 00:17:07,679
you don't mind

00:17:04,799 --> 00:17:08,240
and we'll move to i'll just see the rest

00:17:07,679 --> 00:17:12,880
so

00:17:08,240 --> 00:17:14,959
once i'm done with the with the with the

00:17:12,880 --> 00:17:16,480
sorry the workshop i can fill up the

00:17:14,959 --> 00:17:17,600
survey obviously because we need your

00:17:16,480 --> 00:17:20,640
feedback

00:17:17,600 --> 00:17:22,400
and uh actually that helps us to define

00:17:20,640 --> 00:17:24,640
what will be the future of the

00:17:22,400 --> 00:17:25,919
content that we'll be providing to you

00:17:24,640 --> 00:17:28,079
so i'm logging out and

00:17:25,919 --> 00:17:30,400
obviously uh what i'll be doing now

00:17:28,079 --> 00:17:31,280
switch up the time to go quicker in the

00:17:30,400 --> 00:17:33,679
in the

00:17:31,280 --> 00:17:35,679
in the environment so rather than

00:17:33,679 --> 00:17:38,080
waiting for the four hours i'm just

00:17:35,679 --> 00:17:40,080
you know hacking the database to

00:17:38,080 --> 00:17:42,160
cheating here to tell him

00:17:40,080 --> 00:17:43,679
uh this is the end of the of the of the

00:17:42,160 --> 00:17:46,480
four hour window and

00:17:43,679 --> 00:17:48,400
just do the do the necessary automation

00:17:46,480 --> 00:17:50,640
now to clean up the environment

00:17:48,400 --> 00:17:51,679
okay so we've got two minutes left so

00:17:50,640 --> 00:17:53,919
you can pass

00:17:51,679 --> 00:17:55,440
a quicker on the on the rest so just to

00:17:53,919 --> 00:17:57,600
show you that the database

00:17:55,440 --> 00:17:59,600
will show now that i'm in expiring mode

00:17:57,600 --> 00:18:01,440
and then i will be expired

00:17:59,600 --> 00:18:03,840
then i'll receive one minute left so

00:18:01,440 --> 00:18:06,320
it's getting way faster than i think

00:18:03,840 --> 00:18:07,120
okay so just right there i think we can

00:18:06,320 --> 00:18:08,799
i mean go

00:18:07,120 --> 00:18:10,400
with the end of the video because it

00:18:08,799 --> 00:18:11,840
will only show the very same thing which

00:18:10,400 --> 00:18:14,080
is the reset environment

00:18:11,840 --> 00:18:15,919
providing the very same step of step the

00:18:14,080 --> 00:18:17,679
verb will be different in the sense that

00:18:15,919 --> 00:18:19,440
now it's going to be a clean up verb

00:18:17,679 --> 00:18:21,120
and you will be doing all the necessary

00:18:19,440 --> 00:18:22,880
action that is to say

00:18:21,120 --> 00:18:24,559
i mean cleaning up the environment

00:18:22,880 --> 00:18:25,520
erasing the content changing the

00:18:24,559 --> 00:18:27,760
password

00:18:25,520 --> 00:18:29,600
informing the backend database that we

00:18:27,760 --> 00:18:31,440
have done the cleanup so

00:18:29,600 --> 00:18:32,720
with the gener providing the new

00:18:31,440 --> 00:18:35,520
password

00:18:32,720 --> 00:18:37,039
setting the customer to inactive and

00:18:35,520 --> 00:18:38,640
that's about it really that's the

00:18:37,039 --> 00:18:40,400
and the automation could be much more

00:18:38,640 --> 00:18:42,160
complex in some cases because

00:18:40,400 --> 00:18:44,320
some of the workshops would need some

00:18:42,160 --> 00:18:46,880
ldap would need some reset procedure

00:18:44,320 --> 00:18:47,600
that would be more i would say complex

00:18:46,880 --> 00:18:50,160
than just

00:18:47,600 --> 00:18:51,919
erasing a simple content of a folder and

00:18:50,160 --> 00:18:52,400
so depending on the workshops we are

00:18:51,919 --> 00:18:55,120
doing

00:18:52,400 --> 00:18:55,520
uh different things so it's time to wrap

00:18:55,120 --> 00:18:59,280
up

00:18:55,520 --> 00:19:01,919
the uh ewing is saying so we can shut up

00:18:59,280 --> 00:19:04,960
shut the video and maybe go back to the

00:19:01,919 --> 00:19:04,960
very end of the slides

00:19:06,000 --> 00:19:11,440
and uh so we yeah so everything is

00:19:09,919 --> 00:19:13,520
managed under git we have

00:19:11,440 --> 00:19:15,600
a currently 10 workshop developed using

00:19:13,520 --> 00:19:18,720
that way it's built on a on the ubuntu

00:19:15,600 --> 00:19:20,640
2004 uh distribution right now we were

00:19:18,720 --> 00:19:22,320
working on a port to centos as well to

00:19:20,640 --> 00:19:24,880
have uh to cover other

00:19:22,320 --> 00:19:26,640
needs internally inside inside hp we

00:19:24,880 --> 00:19:28,080
have multiple jupiter cameras

00:19:26,640 --> 00:19:29,600
automatically installed during the

00:19:28,080 --> 00:19:31,600
installation procedures

00:19:29,600 --> 00:19:33,200
and we are working to publish three more

00:19:31,600 --> 00:19:35,520
workshops per month

00:19:33,200 --> 00:19:38,160
and work on the ci cd stuff and some

00:19:35,520 --> 00:19:40,240
other one today

00:19:38,160 --> 00:19:41,919
and here you have in the presentation

00:19:40,240 --> 00:19:44,160
and presentation is available online you

00:19:41,919 --> 00:19:46,799
will have all the links to be able to

00:19:44,160 --> 00:19:47,440
discuss with the developer community and

00:19:46,799 --> 00:19:49,600
access

00:19:47,440 --> 00:19:50,880
the last one is allowing you to access

00:19:49,600 --> 00:19:51,440
the workshop on demand that you have

00:19:50,880 --> 00:19:53,760
seen to

00:19:51,440 --> 00:19:55,200
pass a workshop if you are interested

00:19:53,760 --> 00:19:56,559
thank you very much

00:19:55,200 --> 00:19:58,799
um we're going to have those slides up

00:19:56,559 --> 00:20:01,520
on the sysadmin.miniconf.org

00:19:58,799 --> 00:20:02,080
site on the program there so you'll be

00:20:01,520 --> 00:20:04,640
able to

00:20:02,080 --> 00:20:06,480
grab those links from there thank you

00:20:04,640 --> 00:20:07,840
bruno thank you frederick um both of

00:20:06,480 --> 00:20:09,200
them who said that they will jump into

00:20:07,840 --> 00:20:10,799
the chat for a few minutes

00:20:09,200 --> 00:20:12,720
yeah we'll say that answer any questions

00:20:10,799 --> 00:20:14,240
that you might have um that we didn't

00:20:12,720 --> 00:20:16,880
get a chance to get to

00:20:14,240 --> 00:20:18,799
um and then we will be back in about 10

00:20:16,880 --> 00:20:23,360
minutes with our next presentation

00:20:18,799 --> 00:20:23,360
um from michael thank you very much

00:20:28,360 --> 00:20:31,360

YouTube URL: https://www.youtube.com/watch?v=D6Ss3T2p008


