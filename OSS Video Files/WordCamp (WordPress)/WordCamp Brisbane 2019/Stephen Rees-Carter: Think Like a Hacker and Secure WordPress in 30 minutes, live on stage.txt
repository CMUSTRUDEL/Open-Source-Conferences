Title: Stephen Rees-Carter: Think Like a Hacker and Secure WordPress in 30 minutes, live on stage
Publication date: 2019-10-27
Playlist: WordCamp Brisbane 2019
Description: 
	“What could I have done to avoid being hacked?” is a question you’ll often hear after a site is hacked. In some cases the answer is complicated, but a lot of the time it’s relatively simple and there are many checklists and guides online outlining the ways sites can be hacked, plus how to secure them. However, a lot of people learn better from seeing and doing than reading (often boring) checklists. So rather than look at checklists on slides for 30 minutes, we’re going to hack into WordPress instead!
https://2019.brisbane.wordcamp.org/session/think-like-a-hacker-and-secure-wordpress-in-30-minutes-live-on-stage/

WPTV link: https://wordpress.tv/2019/10/21/stephen-rees-carter-think-like-a-hacker-and-secure-wordpress-in-30-minutes-live-on-stage/
Captions: 
	00:00:00,270 --> 00:00:06,330
[Applause]

00:00:03,259 --> 00:00:07,880
thank the very stateroom I'm gonna have

00:00:06,330 --> 00:00:11,309
to look up to make sure I can seal off

00:00:07,880 --> 00:00:13,830
okay so Edward fence we have the motto

00:00:11,309 --> 00:00:15,660
think like a hacker and the idea behind

00:00:13,830 --> 00:00:17,190
it is that if you can identify the

00:00:15,660 --> 00:00:19,470
potential vulnerabilities that can be

00:00:17,190 --> 00:00:21,000
used to optimize your site then it puts

00:00:19,470 --> 00:00:23,189
you in a much better position to defend

00:00:21,000 --> 00:00:24,840
your site from an attack it's my job

00:00:23,189 --> 00:00:26,939
here today is to teach all of you how to

00:00:24,840 --> 00:00:27,810
think like a hacker so we're going to

00:00:26,939 --> 00:00:29,429
look at a couple of different

00:00:27,810 --> 00:00:31,590
vulnerabilities specifically how they

00:00:29,429 --> 00:00:33,270
work and how you exploit them and also

00:00:31,590 --> 00:00:34,920
how you mitigate and patch against them

00:00:33,270 --> 00:00:36,690
and the idea is to teach you what's

00:00:34,920 --> 00:00:38,760
possible what attackers are likely to do

00:00:36,690 --> 00:00:39,930
what they're looking for and give you a

00:00:38,760 --> 00:00:41,460
better understanding of how to think

00:00:39,930 --> 00:00:44,550
like a hacker so you can protect your

00:00:41,460 --> 00:00:45,989
science so the keep things simple we're

00:00:44,550 --> 00:00:47,640
going to use this Chrome browser with

00:00:45,989 --> 00:00:49,649
the white bar along the top as the site

00:00:47,640 --> 00:00:51,300
owner and then we're aware that hacker

00:00:49,649 --> 00:00:52,530
we're going to use this one over here so

00:00:51,300 --> 00:00:52,980
the black bar top which is the incognito

00:00:52,530 --> 00:00:56,070
mode

00:00:52,980 --> 00:00:58,020
okay hacker mode so the first thing

00:00:56,070 --> 00:00:59,579
we're going to do is the simplest attack

00:00:58,020 --> 00:01:01,289
is a brute-force attack so what that

00:00:59,579 --> 00:01:04,470
means is they're going to try and guess

00:01:01,289 --> 00:01:05,729
the password and luckily because all we

00:01:04,470 --> 00:01:07,229
have to do is find a login form doesn't

00:01:05,729 --> 00:01:08,610
matter what the sides running but we

00:01:07,229 --> 00:01:09,810
know it's WordPress the theme makes it

00:01:08,610 --> 00:01:11,909
pretty obvious and even if it wasn't

00:01:09,810 --> 00:01:12,960
obvious by the theme we can look at the

00:01:11,909 --> 00:01:14,159
source code of the page and there are

00:01:12,960 --> 00:01:16,619
very super signatures that WordPress

00:01:14,159 --> 00:01:20,580
will leave lying around for us so you

00:01:16,619 --> 00:01:22,049
can assume the login form from that we'd

00:01:20,580 --> 00:01:23,310
be hiding in here nice and simple

00:01:22,049 --> 00:01:25,380
occasionally it's free named it usually

00:01:23,310 --> 00:01:27,299
doesn't matter though and now we need

00:01:25,380 --> 00:01:28,799
the username well luckily WordPress is

00:01:27,299 --> 00:01:31,049
going to help us with that so check

00:01:28,799 --> 00:01:33,360
admin no see here it says it invalid

00:01:31,049 --> 00:01:34,680
username we know it's not admin the

00:01:33,360 --> 00:01:37,920
guide that writes this site's name is

00:01:34,680 --> 00:01:40,470
Steven so let's check that it's not that

00:01:37,920 --> 00:01:42,030
one okay what else can we try well if

00:01:40,470 --> 00:01:43,799
you look up here in the domain there's a

00:01:42,030 --> 00:01:45,899
username in here we've got valoran flow

00:01:43,799 --> 00:01:47,939
no dev so why don't we try the Laura and

00:01:45,899 --> 00:01:50,759
I'll see if that's the site user name

00:01:47,939 --> 00:01:53,430
and password the message has changed to

00:01:50,759 --> 00:01:54,990
this so now we know we've got the

00:01:53,430 --> 00:01:56,640
username for this account with the login

00:01:54,990 --> 00:01:58,140
form all we need is the password and

00:01:56,640 --> 00:02:00,780
here's where the brute-force attack

00:01:58,140 --> 00:02:02,009
starts so simple brute force attack you

00:02:00,780 --> 00:02:04,850
just start trying different passwords

00:02:02,009 --> 00:02:06,090
that was QWERTY you're three four five

00:02:04,850 --> 00:02:08,489
password

00:02:06,090 --> 00:02:09,810
none of those are the password and we

00:02:08,489 --> 00:02:11,340
can keep trying that for hours and hours

00:02:09,810 --> 00:02:11,950
would get kind of bored but we could

00:02:11,340 --> 00:02:14,260
eventually

00:02:11,950 --> 00:02:17,020
the password there's much easier way and

00:02:14,260 --> 00:02:18,880
we can automate the attack so there's a

00:02:17,020 --> 00:02:20,560
tool called WP scan which is a wordpress

00:02:18,880 --> 00:02:22,330
vulnerability scanner and pen testing

00:02:20,560 --> 00:02:23,890
tool and provides a bunch of different

00:02:22,330 --> 00:02:25,060
features it'll scan the side to look at

00:02:23,890 --> 00:02:26,500
different versions to work out what

00:02:25,060 --> 00:02:28,690
you're running find vulnerabilities and

00:02:26,500 --> 00:02:31,180
Herthum tools built in as well including

00:02:28,690 --> 00:02:32,380
a brute force password attack mode so

00:02:31,180 --> 00:02:35,340
we'll jump on the command line and we'll

00:02:32,380 --> 00:02:40,120
use that so you can run it by Adobe scan

00:02:35,340 --> 00:02:41,739
URL tell it the size of dress yeah I

00:02:40,120 --> 00:02:44,400
won't try and talk while I type it

00:02:41,739 --> 00:02:46,480
wasn't gonna end badly

00:02:44,400 --> 00:02:47,920
you're right yo so then tell me want to

00:02:46,480 --> 00:02:50,590
enumerate the users to figure out all

00:02:47,920 --> 00:02:54,010
the users on this site we're gonna tell

00:02:50,590 --> 00:02:55,840
me why to figure out the passwords gonna

00:02:54,010 --> 00:02:57,760
use pass to database so run through that

00:02:55,840 --> 00:02:59,440
so what the password database using here

00:02:57,760 --> 00:03:01,239
is Rock hue which was a site that was

00:02:59,440 --> 00:03:02,830
breached about 10 years ago I think

00:03:01,239 --> 00:03:05,260
there was what 32 million accounts that

00:03:02,830 --> 00:03:07,360
came from that and they had plaintext

00:03:05,260 --> 00:03:08,530
passwords and so they extracted 14

00:03:07,360 --> 00:03:10,989
million unique passwords from this

00:03:08,530 --> 00:03:13,000
database and what that allows gives us

00:03:10,989 --> 00:03:14,890
is 14 million passwords that have been

00:03:13,000 --> 00:03:16,930
known to work and many of them have been

00:03:14,890 --> 00:03:19,420
renews many times and so we can try then

00:03:16,930 --> 00:03:21,670
as part of an attack to see if anyone is

00:03:19,420 --> 00:03:24,340
reusing those passwords and so you can

00:03:21,670 --> 00:03:26,350
see up here though beats get identified

00:03:24,340 --> 00:03:27,790
for users the first one is actually not

00:03:26,350 --> 00:03:29,709
a user it's the display name of the

00:03:27,790 --> 00:03:31,120
valoran user but close enough it's

00:03:29,709 --> 00:03:33,160
figured out valoran based on various

00:03:31,120 --> 00:03:34,989
things like the json api the author api

00:03:33,160 --> 00:03:37,000
login error message there's also a

00:03:34,989 --> 00:03:38,890
support user and a mark user as well

00:03:37,000 --> 00:03:40,359
that's figured out and as you can see

00:03:38,890 --> 00:03:42,459
down the bottom we've got two password

00:03:40,359 --> 00:03:44,560
hits the lorentz password there which

00:03:42,459 --> 00:03:46,090
some of you might recognize and there's

00:03:44,560 --> 00:03:47,290
also password for the mark use oh it

00:03:46,090 --> 00:03:48,760
hasn't figured out the password for

00:03:47,290 --> 00:03:49,989
support I could leave it running for

00:03:48,760 --> 00:03:51,880
awhile but it's not going to figure that

00:03:49,989 --> 00:03:53,650
one out it's a different password so now

00:03:51,880 --> 00:03:55,359
we've got the password we can go back to

00:03:53,650 --> 00:03:57,880
the login form notice that quick that

00:03:55,359 --> 00:03:59,049
was when our insight and then on this

00:03:57,880 --> 00:04:00,519
side we've got whatever we can do

00:03:59,049 --> 00:04:04,600
whatever we want now nice and easy

00:04:00,519 --> 00:04:05,620
oh yeah so hackers gonna log out so how

00:04:04,600 --> 00:04:07,780
do we fix this problem

00:04:05,620 --> 00:04:09,880
and luckily WordPress can help us there

00:04:07,780 --> 00:04:12,040
too so the simplest and most important

00:04:09,880 --> 00:04:14,500
thing we can do is set a good password

00:04:12,040 --> 00:04:15,639
hope come on there we go okay so two

00:04:14,500 --> 00:04:17,919
good passwords so if you go into your

00:04:15,639 --> 00:04:19,690
profile on your WordPress site when you

00:04:17,919 --> 00:04:22,090
got a new password it hopefully gives

00:04:19,690 --> 00:04:23,860
you a password so that is a randomly

00:04:22,090 --> 00:04:24,970
generated unique password that's not

00:04:23,860 --> 00:04:25,420
going to be guessed by a brute force

00:04:24,970 --> 00:04:27,880
attack

00:04:25,420 --> 00:04:30,100
anytime soon so there's really no reason

00:04:27,880 --> 00:04:31,420
not to use that password any part of the

00:04:30,100 --> 00:04:33,070
wordpress it generates for you like that

00:04:31,420 --> 00:04:34,210
we should use it it's gonna keep your

00:04:33,070 --> 00:04:37,000
pet account safe from a brute-force

00:04:34,210 --> 00:04:38,860
attack but the question that everyone

00:04:37,000 --> 00:04:41,290
asks about after this is how do I

00:04:38,860 --> 00:04:43,480
remember it and you don't you don't want

00:04:41,290 --> 00:04:45,040
to have to remember these passwords so

00:04:43,480 --> 00:04:46,870
that's where a password manager such as

00:04:45,040 --> 00:04:48,250
one password comes in and so you store

00:04:46,870 --> 00:04:50,290
all your passwords in the password

00:04:48,250 --> 00:04:51,640
manager and then you remember the login

00:04:50,290 --> 00:04:53,590
details for the password manager only

00:04:51,640 --> 00:04:55,060
and then all you have to do to access

00:04:53,590 --> 00:04:56,650
the site is you log in to your password

00:04:55,060 --> 00:04:58,900
manager grab the credentials and then

00:04:56,650 --> 00:05:00,280
log in to your site nice and easy and

00:04:58,900 --> 00:05:02,290
there's less passes the one I'm sorry

00:05:00,280 --> 00:05:04,060
one password is the one I use there's

00:05:02,290 --> 00:05:06,040
also LastPass and pass - Lane a whole

00:05:04,060 --> 00:05:07,210
bunch of others if you need let's come

00:05:06,040 --> 00:05:09,250
and find me at the end I can talk you

00:05:07,210 --> 00:05:10,510
through the different options so yeah so

00:05:09,250 --> 00:05:12,730
you use a password manager I can't

00:05:10,510 --> 00:05:14,620
stress it enough but the thing is of

00:05:12,730 --> 00:05:16,000
course not all of your users are going

00:05:14,620 --> 00:05:18,430
to use strong passwords even though you

00:05:16,000 --> 00:05:19,840
tell them user strong password and so

00:05:18,430 --> 00:05:22,030
that's where you need a login security

00:05:19,840 --> 00:05:23,290
plug-in so they're a bunch of different

00:05:22,030 --> 00:05:25,510
long in security plugins in the

00:05:23,290 --> 00:05:27,160
repositories I've just search for login

00:05:25,510 --> 00:05:29,200
security here and it's found some things

00:05:27,160 --> 00:05:30,910
and so what a login security plug-in

00:05:29,200 --> 00:05:31,930
will do is it does it a couple it adds a

00:05:30,910 --> 00:05:33,970
couple of different extra features to

00:05:31,930 --> 00:05:35,770
your site so first up it allows likelike

00:05:33,970 --> 00:05:37,750
brute force cloud-based protection and

00:05:35,770 --> 00:05:39,670
so what that allows it to do is detect

00:05:37,750 --> 00:05:41,590
brute force attacks from multiply P

00:05:39,670 --> 00:05:43,570
addresses and block those attacks

00:05:41,590 --> 00:05:45,940
so when WordPress comm what during the

00:05:43,570 --> 00:05:47,830
word fence con site we got hit by a

00:05:45,940 --> 00:05:49,030
brute force attack from over a million

00:05:47,830 --> 00:05:51,370
different IP addresses they're each

00:05:49,030 --> 00:05:52,780
doing a small number of requests over

00:05:51,370 --> 00:05:54,700
the millions different IP addresses and

00:05:52,780 --> 00:05:55,840
so we enabled we're working on the

00:05:54,700 --> 00:05:57,280
feature at the time but we enabled

00:05:55,840 --> 00:06:00,010
Google Google recapture on there which

00:05:57,280 --> 00:06:02,020
is a cloud-based login system a blocking

00:06:00,010 --> 00:06:03,550
protection system and what it allowed it

00:06:02,020 --> 00:06:05,500
to do was block those attacks entirely

00:06:03,550 --> 00:06:06,850
because the brute force attack wasn't

00:06:05,500 --> 00:06:09,610
able to authenticate through that and it

00:06:06,850 --> 00:06:11,410
stopped the attack completely and these

00:06:09,610 --> 00:06:13,450
login security systems will also include

00:06:11,410 --> 00:06:14,890
things like two factor authentication so

00:06:13,450 --> 00:06:16,720
you can have a unique token generator on

00:06:14,890 --> 00:06:18,490
your phone and so when you log in you

00:06:16,720 --> 00:06:20,860
have type your password the enter the

00:06:18,490 --> 00:06:22,450
the token from your phone and the

00:06:20,860 --> 00:06:23,650
benefit of that is a brute force attack

00:06:22,450 --> 00:06:25,180
if it's going to guess the password

00:06:23,650 --> 00:06:27,070
isn't going to get the token from your

00:06:25,180 --> 00:06:29,050
phone in order to steal the token you

00:06:27,070 --> 00:06:30,730
need a targeted attack directly at that

00:06:29,050 --> 00:06:32,410
user to grab the token via phishing or

00:06:30,730 --> 00:06:34,440
sort of a method and so completely

00:06:32,410 --> 00:06:36,970
eliminates brute forcing as well I'm

00:06:34,440 --> 00:06:38,129
sorry okay let's just finally enough how

00:06:36,970 --> 00:06:39,749
important it is to have some

00:06:38,129 --> 00:06:41,550
of login security plug it on your site

00:06:39,749 --> 00:06:45,809
because it'll protect to your users that

00:06:41,550 --> 00:06:47,129
aren't using good passwords so we could

00:06:45,809 --> 00:06:48,239
set that password to run the brute-force

00:06:47,129 --> 00:06:49,649
attack again and wouldn't find anything

00:06:48,239 --> 00:06:51,629
what we don't have time for that so move

00:06:49,649 --> 00:06:53,580
on so let's pretend that there's a solid

00:06:51,629 --> 00:06:55,769
password and we haven't got in so what's

00:06:53,580 --> 00:06:57,300
the next thing we can do and as I

00:06:55,769 --> 00:06:59,129
mentioned before though it'd be scan

00:06:57,300 --> 00:07:00,449
scan some vulnerabilities and version

00:06:59,129 --> 00:07:03,959
numbers so we'll scroll up through the

00:07:00,449 --> 00:07:05,550
output it provided where is it

00:07:03,959 --> 00:07:07,469
scrolling is not working so here we go

00:07:05,550 --> 00:07:09,959
okay so hopefully you can see that it

00:07:07,469 --> 00:07:12,389
says there 52 vulnerabilities found this

00:07:09,959 --> 00:07:15,629
version of WordPress is version 4.7 it

00:07:12,389 --> 00:07:17,789
was released in 2016 in December so it's

00:07:15,629 --> 00:07:19,050
quite old and as I've said it has 52

00:07:17,789 --> 00:07:20,909
vulnerabilities so that gives us

00:07:19,050 --> 00:07:24,719
potentially 50 do different ways to

00:07:20,909 --> 00:07:25,919
compromise this site so one other one

00:07:24,719 --> 00:07:27,509
we're going to look at is this one here

00:07:25,919 --> 00:07:29,399
this is actually one of my favorites it

00:07:27,509 --> 00:07:30,899
came out just as I started working where

00:07:29,399 --> 00:07:32,879
press security so it's a bit sentimental

00:07:30,899 --> 00:07:35,519
for me and it's just so easy to exploit

00:07:32,879 --> 00:07:37,199
so this photo really does it allows you

00:07:35,519 --> 00:07:39,209
to modify page and post content without

00:07:37,199 --> 00:07:41,339
having to log in at all which is really

00:07:39,209 --> 00:07:44,249
cool so I'll show you how it works it'll

00:07:41,339 --> 00:07:46,379
go to the site will find a page I post

00:07:44,249 --> 00:07:48,539
actually go to hello world because why

00:07:46,379 --> 00:07:49,619
not what we need to do is figure out the

00:07:48,539 --> 00:07:51,749
ID of this post

00:07:49,619 --> 00:07:53,939
luckily WordPress is going to help us

00:07:51,749 --> 00:07:57,029
here we'll go to the source comments

00:07:53,939 --> 00:08:00,419
oops can't type today yeah I really come

00:07:57,029 --> 00:08:01,860
tired that's it okay comment post right

00:08:00,419 --> 00:08:03,209
here is telling us the ID of this post

00:08:01,860 --> 00:08:05,189
is one we probably could've guessed that

00:08:03,209 --> 00:08:06,509
from hello world but so be it so now we

00:08:05,189 --> 00:08:08,459
know the ID is one we're going to update

00:08:06,509 --> 00:08:16,279
the post who worked at the command line

00:08:08,459 --> 00:08:16,279
and let me just type this in oops

00:08:17,380 --> 00:08:21,400
now the URL so you need the URL for the

00:08:19,810 --> 00:08:23,040
dice on the API which I can never

00:08:21,400 --> 00:08:25,000
remember so it's written that next to me

00:08:23,040 --> 00:08:30,700
posts 1 oops

00:08:25,000 --> 00:08:32,530
1 ok oops I equals 1 right now what we

00:08:30,700 --> 00:08:36,520
want to do title will change the title

00:08:32,530 --> 00:08:41,490
to greetings and the content to good

00:08:36,520 --> 00:08:45,190
it's still morning right cool

00:08:41,490 --> 00:08:48,310
great ok we'll run that nice big block

00:08:45,190 --> 00:08:51,370
of output go back to our site refresh

00:08:48,310 --> 00:08:53,740
the page we've updated the post nice and

00:08:51,370 --> 00:08:55,090
easy now those who recognized the

00:08:53,740 --> 00:08:56,500
command will notice an authentication

00:08:55,090 --> 00:08:59,020
there at all no cookies no nothing

00:08:56,500 --> 00:09:00,730
that's how simple it was and so we saw

00:08:59,020 --> 00:09:02,680
hundreds and hundreds of sites hit by

00:09:00,730 --> 00:09:05,260
this when the vulnerability was released

00:09:02,680 --> 00:09:06,790
so what happened WordPress security

00:09:05,260 --> 00:09:08,590
discovered vulnerability and quietly

00:09:06,790 --> 00:09:10,090
told WordPress they fixed it and rolled

00:09:08,590 --> 00:09:11,170
out the update quietly they didn't

00:09:10,090 --> 00:09:13,330
announce that they just rolled out the

00:09:11,170 --> 00:09:15,010
update I mean a week later they

00:09:13,330 --> 00:09:16,930
disclosed it they told they announced

00:09:15,010 --> 00:09:18,250
with the of the vulnerability was they

00:09:16,930 --> 00:09:19,930
allowed that week for automatic updates

00:09:18,250 --> 00:09:22,030
and updates to be applied in order to

00:09:19,930 --> 00:09:23,140
fix the vulnerability they didn't want

00:09:22,030 --> 00:09:24,820
to leave it too long so someone else

00:09:23,140 --> 00:09:26,410
couldn't discover it and as soon as they

00:09:24,820 --> 00:09:27,730
did announced her attacker started using

00:09:26,410 --> 00:09:29,650
and they were searching web sites for

00:09:27,730 --> 00:09:31,300
WordPress 4.7 that weren't patched and

00:09:29,650 --> 00:09:33,100
they're updating posts here and

00:09:31,300 --> 00:09:34,450
everywhere in it do it we were cleaning

00:09:33,100 --> 00:09:35,560
so many sites in this as well the reason

00:09:34,450 --> 00:09:37,420
as I remember it was there was some use

00:09:35,560 --> 00:09:38,980
hard to a cleaning luckily it was on the

00:09:37,420 --> 00:09:40,690
database it was fairly easy to clean but

00:09:38,980 --> 00:09:42,130
the fact is it was still very easy for

00:09:40,690 --> 00:09:43,720
them to exploit I think I had things

00:09:42,130 --> 00:09:44,860
like crypto miners and defacements and

00:09:43,720 --> 00:09:47,530
here images and that sort of thing in

00:09:44,860 --> 00:09:49,900
there so it was quite bad so the

00:09:47,530 --> 00:09:52,660
question we have is why isn't this site

00:09:49,900 --> 00:09:54,310
updating because why hasn't this like

00:09:52,660 --> 00:09:55,570
one replied the automatic updating to

00:09:54,310 --> 00:09:58,030
fix the problem so we'll go check site

00:09:55,570 --> 00:09:59,170
health and those who know WordPress

00:09:58,030 --> 00:10:01,030
version numbers are gonna notice a

00:09:59,170 --> 00:10:03,160
greenie weed of this site but we'll

00:10:01,030 --> 00:10:03,490
scroll down wait for it to load there we

00:10:03,160 --> 00:10:05,110
go

00:10:03,490 --> 00:10:07,330
have a look in here critical issue

00:10:05,110 --> 00:10:09,010
automatic updates have been disabled so

00:10:07,330 --> 00:10:10,360
the site owner of this site has disabled

00:10:09,010 --> 00:10:12,370
automatic updates for whatever reason

00:10:10,360 --> 00:10:14,200
and there are some legitimate reasons to

00:10:12,370 --> 00:10:16,030
do it but the problem is if you disable

00:10:14,200 --> 00:10:18,010
automatic updates you need to be really

00:10:16,030 --> 00:10:18,730
careful about applying your updates as

00:10:18,010 --> 00:10:20,050
quick as possible

00:10:18,730 --> 00:10:21,460
so as soon as an update is there you

00:10:20,050 --> 00:10:22,930
have to go review it have to test it and

00:10:21,460 --> 00:10:24,760
apply it you can't just leave it sitting

00:10:22,930 --> 00:10:25,900
around for days or weeks because it was

00:10:24,760 --> 00:10:28,150
less than a week it was about a week

00:10:25,900 --> 00:10:30,000
when they released the update and then

00:10:28,150 --> 00:10:31,590
disclosed the vulnerability and

00:10:30,000 --> 00:10:32,700
started getting hit hit so if you spent

00:10:31,590 --> 00:10:34,440
longer than a week for viewing this

00:10:32,700 --> 00:10:37,440
plug-in your site was going to be hit

00:10:34,440 --> 00:10:42,600
from it so we'll get rid of the config

00:10:37,440 --> 00:10:44,820
what is it okay so we'll go into the

00:10:42,600 --> 00:10:47,850
config file and all make updates are

00:10:44,820 --> 00:10:49,890
disabled by this line in here so we'll

00:10:47,850 --> 00:10:52,110
comment that out and we'll go back to

00:10:49,890 --> 00:10:55,650
here and more fresh the page wait for it

00:10:52,110 --> 00:10:56,940
to load again it still loading and it

00:10:55,650 --> 00:10:58,290
should be gone there we go

00:10:56,940 --> 00:11:00,390
this site is now going to automatically

00:10:58,290 --> 00:11:02,160
update to the latest version and protect

00:11:00,390 --> 00:11:03,600
yourself we don't really have time to

00:11:02,160 --> 00:11:05,510
wait for the would make updates so we'll

00:11:03,600 --> 00:11:09,360
just go and apply it manually

00:11:05,510 --> 00:11:10,710
go but normally if we for make updates

00:11:09,360 --> 00:11:12,090
were working then this would have

00:11:10,710 --> 00:11:13,440
happened sometime during that week it's

00:11:12,090 --> 00:11:16,110
a couple of days depending on your site

00:11:13,440 --> 00:11:17,370
couple of hours if you're lucky but

00:11:16,110 --> 00:11:18,540
because of the disclosure period they

00:11:17,370 --> 00:11:20,760
maintain for the vulnerability

00:11:18,540 --> 00:11:23,070
disclosure the sites are pretty safe

00:11:20,760 --> 00:11:24,180
they had on wrecked updates available so

00:11:23,070 --> 00:11:25,830
that's just running through its update

00:11:24,180 --> 00:11:30,360
hope they don't take much much longer

00:11:25,830 --> 00:11:31,710
and there we go doing weird things okay

00:11:30,360 --> 00:11:33,210
it's updated now so I'll back it into

00:11:31,710 --> 00:11:37,589
our command line and we'll run this

00:11:33,210 --> 00:11:39,240
again Oh run it again and we've got a

00:11:37,589 --> 00:11:41,070
new era got an error here actually I

00:11:39,240 --> 00:11:43,710
should say so the fix for this

00:11:41,070 --> 00:11:46,350
vulnerability comes from how it's being

00:11:43,710 --> 00:11:47,820
exploited which is the ID value here so

00:11:46,350 --> 00:11:50,100
what's going on in the code in the old

00:11:47,820 --> 00:11:52,110
code the vulnerable code is when the

00:11:50,100 --> 00:11:54,420
response when the request comes in it

00:11:52,110 --> 00:11:57,089
says okay so I've been asked to modify

00:11:54,420 --> 00:11:59,280
this post with an ID of 1 WC B and E and

00:11:57,089 --> 00:12:02,010
the code goes away and says ok find me

00:11:59,280 --> 00:12:03,390
the post that has the ID of 1 WC BNA it

00:12:02,010 --> 00:12:05,850
checks the database the post doesn't

00:12:03,390 --> 00:12:07,230
exist and so it doesn't care anymore it

00:12:05,850 --> 00:12:08,610
just says okay that's fine keep going

00:12:07,230 --> 00:12:10,350
there's no post we don't have to do any

00:12:08,610 --> 00:12:12,600
authentication which is kind of silly

00:12:10,350 --> 00:12:14,550
because the next bit of code is ok so we

00:12:12,600 --> 00:12:16,050
asked to modify the post that has an ID

00:12:14,550 --> 00:12:17,610
of weight there should be a number let's

00:12:16,050 --> 00:12:19,440
turn it into a number so it turns it

00:12:17,610 --> 00:12:21,900
into one then the checks the database

00:12:19,440 --> 00:12:24,240
and says is there a post ID one yes okay

00:12:21,900 --> 00:12:25,980
we've got content great update it done

00:12:24,240 --> 00:12:28,500
and so that's how it's bypassing

00:12:25,980 --> 00:12:30,089
authentication is because the ID has

00:12:28,500 --> 00:12:31,740
been turned into a number after it's

00:12:30,089 --> 00:12:34,589
authenticating so the fix here is

00:12:31,740 --> 00:12:37,110
they're enforcing the ID value to be an

00:12:34,589 --> 00:12:39,360
integer number and so when the request

00:12:37,110 --> 00:12:41,610
comes in with the ID of the Wonder

00:12:39,360 --> 00:12:43,709
c'est bien a it's rejected initially

00:12:41,610 --> 00:12:45,510
because the idea is not an integer the

00:12:43,709 --> 00:12:47,160
ideas on a number so that's a simple fix

00:12:45,510 --> 00:12:49,140
they applied which patched up the

00:12:47,160 --> 00:12:50,760
problem and as I said before I've had

00:12:49,140 --> 00:12:51,690
automatic updates running you saw I

00:12:50,760 --> 00:12:54,630
would have been protected and you'll

00:12:51,690 --> 00:12:56,640
miss fine from that one so that is a

00:12:54,630 --> 00:12:57,690
core vulnerability you might have

00:12:56,640 --> 00:12:59,579
noticed there were also some other

00:12:57,690 --> 00:13:02,820
updates be applied so we're going to

00:12:59,579 --> 00:13:04,470
look at one of them now so wait for it

00:13:02,820 --> 00:13:06,180
to load so here we go okay so there look

00:13:04,470 --> 00:13:07,620
this one in the middle is IP block

00:13:06,180 --> 00:13:10,019
alight so this is a simple little

00:13:07,620 --> 00:13:11,760
extension that allows your block IP

00:13:10,019 --> 00:13:14,490
addresses from accessing your site and

00:13:11,760 --> 00:13:15,870
the idea is if you know an attacker who

00:13:14,490 --> 00:13:17,700
is using your IP address and is going to

00:13:15,870 --> 00:13:19,260
take your site you can block them to

00:13:17,700 --> 00:13:21,390
veteran from getting to your site so

00:13:19,260 --> 00:13:23,519
we'll go on ignore its instructions and

00:13:21,390 --> 00:13:24,209
we'll block ourselves hopefully this

00:13:23,519 --> 00:13:25,500
won't backfire

00:13:24,209 --> 00:13:27,209
epically because that could be funny and

00:13:25,500 --> 00:13:28,740
bad okay so we're gonna block ourselves

00:13:27,209 --> 00:13:31,019
we'll go back to a hacker browser

00:13:28,740 --> 00:13:33,630
refresh the page we're now banned by the

00:13:31,019 --> 00:13:35,640
administrator so where the attacker we

00:13:33,630 --> 00:13:36,930
see this page and this just gives us

00:13:35,640 --> 00:13:38,190
more reason to want to try and attack

00:13:36,930 --> 00:13:40,079
this site because why not

00:13:38,190 --> 00:13:41,880
it's also very easy to get new IP

00:13:40,079 --> 00:13:44,370
addresses you can get VPNs you can use

00:13:41,880 --> 00:13:45,810
tor bunch of ways to get different IP

00:13:44,370 --> 00:13:48,300
addresses so ultimately this isn't gonna

00:13:45,810 --> 00:13:49,890
do much so here the attacker we want to

00:13:48,300 --> 00:13:52,019
figure out how can we exploit this so it

00:13:49,890 --> 00:13:53,279
well let's have do some recon figure out

00:13:52,019 --> 00:13:55,079
what we're dealing with so if you the

00:13:53,279 --> 00:13:56,820
source of the block page and it's

00:13:55,079 --> 00:13:59,070
telling us we're running the WordPress

00:13:56,820 --> 00:14:00,690
IP address block a probe plug-in the

00:13:59,070 --> 00:14:03,360
light version of the plug-in and the

00:14:00,690 --> 00:14:05,160
version is 10 3 and as we've seen before

00:14:03,360 --> 00:14:06,329
version numbers are fantastic because we

00:14:05,160 --> 00:14:08,550
go over and check for the vulnerability

00:14:06,329 --> 00:14:10,230
database and we have a vulnerability for

00:14:08,550 --> 00:14:13,110
the IP address blocker version ten point

00:14:10,230 --> 00:14:15,810
three this is a vulnerability known as a

00:14:13,110 --> 00:14:17,940
CSRF leading to arbitrary file upload so

00:14:15,810 --> 00:14:20,100
CSRF is cross-site request forgery and

00:14:17,940 --> 00:14:22,500
how that works is if you log in to your

00:14:20,100 --> 00:14:24,060
site over here and I as a malicious

00:14:22,500 --> 00:14:26,459
person can get you to visit my site here

00:14:24,060 --> 00:14:28,769
my site can make fake requests to your

00:14:26,459 --> 00:14:30,089
site and in many cases all you'll be

00:14:28,769 --> 00:14:31,410
doing is updating options and

00:14:30,089 --> 00:14:33,570
defacements it's causing some minor

00:14:31,410 --> 00:14:35,730
nuisances but in some cases you can do a

00:14:33,570 --> 00:14:37,589
lot worse and in this case what you can

00:14:35,730 --> 00:14:39,209
do with the CSRF vulnerability is

00:14:37,589 --> 00:14:41,370
getting the malicious ID to upload a

00:14:39,209 --> 00:14:43,350
file on to the site you logged in to and

00:14:41,370 --> 00:14:44,760
because it's an arbitrary file we can

00:14:43,350 --> 00:14:46,880
get our in my shell and get full access

00:14:44,760 --> 00:14:48,750
to the site so let's see that action

00:14:46,880 --> 00:14:50,940
that's the first of all kind of

00:14:48,750 --> 00:14:52,800
unblock ourselves where we go

00:14:50,940 --> 00:14:54,090
okay so we'll pretend that we've got a

00:14:52,800 --> 00:14:57,120
new IP address obviously it's a user

00:14:54,090 --> 00:14:59,190
just on block in here go back in so what

00:14:57,120 --> 00:15:00,920
we need to do as the attacker is getting

00:14:59,190 --> 00:15:02,970
the site administrator to visit our site

00:15:00,920 --> 00:15:04,770
and the question is how do we do that

00:15:02,970 --> 00:15:06,810
well it's easy it's a blog it's got a

00:15:04,770 --> 00:15:12,560
comment section so let's exploit that so

00:15:06,810 --> 00:15:15,990
I love your side right hey thank you

00:15:12,560 --> 00:15:17,400
whoops where is it obviously we do

00:15:15,990 --> 00:15:20,150
something a little bit less obvious but

00:15:17,400 --> 00:15:20,150
you get the point

00:15:23,840 --> 00:15:28,680
oops okay that's in there now with the

00:15:27,330 --> 00:15:30,030
site oh yeah we're going through our

00:15:28,680 --> 00:15:31,500
site we see a look someone's left us

00:15:30,030 --> 00:15:32,460
coming oh great they wrote a review

00:15:31,500 --> 00:15:35,340
let's have a look at it

00:15:32,460 --> 00:15:35,550
oh nothing to see here oh ah let's go

00:15:35,340 --> 00:15:37,980
away

00:15:35,550 --> 00:15:40,020
nothing to see here right yeah well now

00:15:37,980 --> 00:15:42,330
them like the UM the hacker knows you

00:15:40,020 --> 00:15:46,010
visited their page they can go to the

00:15:42,330 --> 00:15:51,660
site and they can go content uploads

00:15:46,010 --> 00:15:53,670
where's that 2008 show a PHP hack remote

00:15:51,660 --> 00:15:55,080
shell we can now run whatever PHP code

00:15:53,670 --> 00:15:57,030
you want on that site it gives us full X

00:15:55,080 --> 00:15:59,150
to do whatever we want currently

00:15:57,030 --> 00:16:01,740
assisting all the files in the directory

00:15:59,150 --> 00:16:03,540
we can add on em I could say hello we

00:16:01,740 --> 00:16:05,310
can raid the config file run a crypto

00:16:03,540 --> 00:16:07,440
minor DOS how competitive science oh you

00:16:05,310 --> 00:16:10,890
can do all sorts of fun things game over

00:16:07,440 --> 00:16:12,450
basically so what's the prop what's the

00:16:10,890 --> 00:16:16,440
fig thing what can we do to prevent this

00:16:12,450 --> 00:16:17,970
from happening and as a user as a site

00:16:16,440 --> 00:16:21,120
owner what you really should do anytime

00:16:17,970 --> 00:16:22,590
you get a suspicious link like this is

00:16:21,120 --> 00:16:24,570
open up in your company demo because it

00:16:22,590 --> 00:16:26,700
looks yeah that was really not you

00:16:24,570 --> 00:16:28,440
should do okay right click on it and you

00:16:26,700 --> 00:16:29,580
go to opening you know window a private

00:16:28,440 --> 00:16:32,490
window or whatever it is that your

00:16:29,580 --> 00:16:34,830
browser calls it and what that does is

00:16:32,490 --> 00:16:36,450
it opens up the malicious site in a

00:16:34,830 --> 00:16:38,310
completely separate environment isn't

00:16:36,450 --> 00:16:39,960
logged into your site so even if this is

00:16:38,310 --> 00:16:42,090
a vulnerability such as this one we just

00:16:39,960 --> 00:16:43,410
exploited it's not gonna have access to

00:16:42,090 --> 00:16:45,000
it and that will protect you from that

00:16:43,410 --> 00:16:46,500
and should do this any time you're

00:16:45,000 --> 00:16:48,060
visiting strange links to comments and

00:16:46,500 --> 00:16:49,740
you blog or even comments on forums or

00:16:48,060 --> 00:16:51,330
emails anything like that if you're not

00:16:49,740 --> 00:16:53,220
sure where it comes from if you're not

00:16:51,330 --> 00:16:55,770
sure the site then it's best to open it

00:16:53,220 --> 00:16:57,300
in in an incognito window because it

00:16:55,770 --> 00:16:59,850
protects you from any sort of attack

00:16:57,300 --> 00:17:01,710
like this and the other thing of course

00:16:59,850 --> 00:17:03,070
is as we saw before there's an update

00:17:01,710 --> 00:17:04,870
available for this vulnerability

00:17:03,070 --> 00:17:07,540
and the update was made available pretty

00:17:04,870 --> 00:17:09,339
quickly and the fact that you have to go

00:17:07,540 --> 00:17:11,020
and physically open up say a link in a

00:17:09,339 --> 00:17:13,240
comment or visit a specific page to be

00:17:11,020 --> 00:17:15,220
attacked by it means that you're more

00:17:13,240 --> 00:17:18,160
likely to see the update before you get

00:17:15,220 --> 00:17:19,689
here by the vulnerability and if you see

00:17:18,160 --> 00:17:21,699
it update for a plug-in go have a look

00:17:19,689 --> 00:17:23,709
at it open it up click on the details

00:17:21,699 --> 00:17:25,150
and check the changelog because we can

00:17:23,709 --> 00:17:27,250
see here that 10-4 has security

00:17:25,150 --> 00:17:29,020
enhancements so this version this update

00:17:27,250 --> 00:17:30,280
we know has security fixes we should

00:17:29,020 --> 00:17:32,320
apply that as soon as possible we

00:17:30,280 --> 00:17:35,380
shouldn't delay on the home now so we'll

00:17:32,320 --> 00:17:36,760
go and update that one and the question

00:17:35,380 --> 00:17:39,490
from a developer point of view how do we

00:17:36,760 --> 00:17:41,590
fix this and force constant of CSRF

00:17:39,490 --> 00:17:44,290
attacks the fix is to use what's called

00:17:41,590 --> 00:17:45,880
a nonce or a CSRF token and we're press

00:17:44,290 --> 00:17:47,710
makes that incredibly simple so if we go

00:17:45,880 --> 00:17:48,760
view this is the code they change this

00:17:47,710 --> 00:17:51,130
is the change they need to fix the

00:17:48,760 --> 00:17:53,620
vulnerability and we look for nonce so

00:17:51,130 --> 00:17:55,570
you can add a non-steam a nonce field

00:17:53,620 --> 00:17:57,340
into your form here just lying here in

00:17:55,570 --> 00:17:58,840
the middle and what that does is it adds

00:17:57,340 --> 00:18:00,400
a nonce on to the form it's when the

00:17:58,840 --> 00:18:02,110
form is loaded in the browser it

00:18:00,400 --> 00:18:04,419
generates a round of token and it said

00:18:02,110 --> 00:18:04,960
to the user and then when the form is

00:18:04,419 --> 00:18:06,549
submitted

00:18:04,960 --> 00:18:08,440
it has to send that token back the

00:18:06,549 --> 00:18:09,970
server will reject any requests to do

00:18:08,440 --> 00:18:13,030
anything if it doesn't have that token

00:18:09,970 --> 00:18:15,580
and that's set down here so it's running

00:18:13,030 --> 00:18:16,870
the Doherty verify nonce function which

00:18:15,580 --> 00:18:18,880
is where it checks that's my response

00:18:16,870 --> 00:18:20,740
and the way the reason this works is

00:18:18,880 --> 00:18:22,809
because browser security policies mean

00:18:20,740 --> 00:18:24,669
that the malicious site cannot read any

00:18:22,809 --> 00:18:25,720
data from your site so you can't get the

00:18:24,669 --> 00:18:27,669
nonce there's no way for it to get the

00:18:25,720 --> 00:18:29,470
knots all it can do is send requests but

00:18:27,669 --> 00:18:30,520
account numbers read the response and so

00:18:29,470 --> 00:18:32,409
if you've got a nonce running on the

00:18:30,520 --> 00:18:33,580
form it blocks them entirely and there's

00:18:32,409 --> 00:18:35,919
no way that it can exploit the

00:18:33,580 --> 00:18:37,270
vulnerability so it's a nice simple fix

00:18:35,919 --> 00:18:40,900
and as I said WordPress makes it really

00:18:37,270 --> 00:18:42,340
easy so that is this from Emily but what

00:18:40,900 --> 00:18:43,929
if there's a bigger vulnerability

00:18:42,340 --> 00:18:45,340
something like a zero-day on a site so

00:18:43,929 --> 00:18:47,679
for those haven't heard the term a

00:18:45,340 --> 00:18:50,200
zero-day means the developer has had

00:18:47,679 --> 00:18:51,309
zero days to fix the vulnerability so

00:18:50,200 --> 00:18:52,780
it's out there being used in the wild

00:18:51,309 --> 00:18:55,419
and the developer doesn't know about it

00:18:52,780 --> 00:18:57,580
or haven't fixed it yet and there's one

00:18:55,419 --> 00:18:59,530
what we discovered I think it was asked

00:18:57,580 --> 00:19:02,140
how exactly he described this one in an

00:18:59,530 --> 00:19:03,520
extension for newcomers so this one here

00:19:02,140 --> 00:19:05,380
so you abandoned cart life for

00:19:03,520 --> 00:19:06,940
WooCommerce as a stored cross-site

00:19:05,380 --> 00:19:09,549
scripting vulnerability and so what that

00:19:06,940 --> 00:19:10,840
means is you can inject JavaScript onto

00:19:09,549 --> 00:19:12,309
a page and certain get saved in the

00:19:10,840 --> 00:19:13,659
database then when the administrator

00:19:12,309 --> 00:19:15,640
views the page it executes the

00:19:13,659 --> 00:19:16,669
JavaScript which gives you full control

00:19:15,640 --> 00:19:18,830
over there

00:19:16,669 --> 00:19:20,929
you can do whatever you want I'm

00:19:18,830 --> 00:19:23,289
noticing a pattern here so go to the

00:19:20,929 --> 00:19:26,989
shop well add something to the cart and

00:19:23,289 --> 00:19:28,879
go to checkout okay so the way it works

00:19:26,989 --> 00:19:30,919
it was he was on the farm when it's

00:19:28,879 --> 00:19:33,289
having in details so for the first man

00:19:30,919 --> 00:19:40,450
put some JavaScript in here where it

00:19:33,289 --> 00:19:48,289
you've been yeah yeah cookies

00:19:40,450 --> 00:19:49,789
oops okay hopefully I've got that right

00:19:48,289 --> 00:19:51,320
that box is tiny so it's really hard to

00:19:49,789 --> 00:19:52,639
see what I've typed and then you got to

00:19:51,320 --> 00:19:54,350
put an email address in for it to save

00:19:52,639 --> 00:19:57,289
prop leaves no we don't reveal who we

00:19:54,350 --> 00:19:59,749
are he's up there is dead okay so that

00:19:57,289 --> 00:20:04,039
should have sent it to the site so we're

00:19:59,749 --> 00:20:06,139
a site owner we're viewing our viewing

00:20:04,039 --> 00:20:08,840
area Ben and carts there we go we've

00:20:06,139 --> 00:20:10,399
been hacked nice and easy

00:20:08,840 --> 00:20:11,779
and every time that page gets loaded

00:20:10,399 --> 00:20:12,769
it's going to run the JavaScript and

00:20:11,779 --> 00:20:14,179
normally it wouldn't announce its

00:20:12,769 --> 00:20:16,340
presence like that it would be subtle in

00:20:14,179 --> 00:20:19,129
the background he wouldn't even know

00:20:16,340 --> 00:20:20,470
what's going on and when they exploited

00:20:19,129 --> 00:20:25,519
this in the wild

00:20:20,470 --> 00:20:26,600
yeah what they were running I wouldn't

00:20:25,519 --> 00:20:27,559
find it here we go what they were

00:20:26,600 --> 00:20:29,450
running when they explored this in the

00:20:27,559 --> 00:20:30,859
wild was that code which was creating a

00:20:29,450 --> 00:20:32,690
new an administrator account on the

00:20:30,859 --> 00:20:33,710
sites that were hit by it so once they

00:20:32,690 --> 00:20:34,789
create an administrator account on the

00:20:33,710 --> 00:20:36,259
site they can log in and do whatever

00:20:34,789 --> 00:20:38,809
they wanted you know change the payment

00:20:36,259 --> 00:20:40,039
details steal customer information you

00:20:38,809 --> 00:20:43,399
know send fake products that sort of

00:20:40,039 --> 00:20:45,499
thing mmm so this was quite bad and

00:20:43,399 --> 00:20:46,549
because it was a zero day was exploited

00:20:45,499 --> 00:20:48,559
for anyone knew about us there were no

00:20:46,549 --> 00:20:50,389
updates available to patch this

00:20:48,559 --> 00:20:52,460
vulnerability at the time and all you

00:20:50,389 --> 00:20:54,350
have to do is access the event and cards

00:20:52,460 --> 00:20:57,019
page for it to be executed which made it

00:20:54,350 --> 00:20:58,580
really really easy for them to take over

00:20:57,019 --> 00:20:59,929
your site and there wasn't much ever you

00:20:58,580 --> 00:21:00,950
won't click on a new link for it it's

00:20:59,929 --> 00:21:02,299
like that you were just doing something

00:21:00,950 --> 00:21:06,049
you would normally do as part of maybe

00:21:02,299 --> 00:21:10,609
your daily process okay and I'm running

00:21:06,049 --> 00:21:11,929
out of time okay um okay so what you can

00:21:10,609 --> 00:21:13,850
do to fix this vulnerabilities or fix

00:21:11,929 --> 00:21:16,850
zero-day vulnerabilities is this where a

00:21:13,850 --> 00:21:18,049
firewall comes in and so luckily I know

00:21:16,850 --> 00:21:20,649
someone that makes a firewall so we're

00:21:18,049 --> 00:21:23,659
going in able wordfence

00:21:20,649 --> 00:21:34,200
word security and

00:21:23,659 --> 00:21:37,019
given my my press enable yourself give

00:21:34,200 --> 00:21:38,490
it a sec okay come on do we go things

00:21:37,019 --> 00:21:41,490
sorry okay so we'll go back to check-in

00:21:38,490 --> 00:21:42,750
checkout form open the inspector and if

00:21:41,490 --> 00:21:44,730
we just change this to trigger it to

00:21:42,750 --> 00:21:45,600
update again we should see nice big red

00:21:44,730 --> 00:21:46,860
warning over here

00:21:45,600 --> 00:21:48,330
we're defense has blocked it so

00:21:46,860 --> 00:21:50,519
wordfriends had it has a default rule

00:21:48,330 --> 00:21:52,830
for caching CSR cross-site scripting

00:21:50,519 --> 00:21:54,509
attacks and I blocked this by default so

00:21:52,830 --> 00:21:56,250
if you had wordfence or another firewall

00:21:54,509 --> 00:21:57,480
that has similar rules running you would

00:21:56,250 --> 00:21:58,590
have protect it from this from the start

00:21:57,480 --> 00:22:00,450
and your site would have been safe

00:21:58,590 --> 00:22:01,620
regardless of the update being applied

00:22:00,450 --> 00:22:05,070
on the site or not which is really

00:22:01,620 --> 00:22:06,450
really useful okay so something else

00:22:05,070 --> 00:22:09,570
that an attacker will do when they're

00:22:06,450 --> 00:22:11,070
trying to attack a site is they'll look

00:22:09,570 --> 00:22:13,769
for different things like backups of

00:22:11,070 --> 00:22:15,090
configuration files or your new

00:22:13,769 --> 00:22:16,740
installations that haven't been applied

00:22:15,090 --> 00:22:18,990
yet so this site for example we have

00:22:16,740 --> 00:22:20,669
obscure that has a new it new install

00:22:18,990 --> 00:22:22,409
that hasn't been run and still sitting

00:22:20,669 --> 00:22:24,210
there waiting for someone to run it so

00:22:22,409 --> 00:22:26,429
we're an attacker we know might as well

00:22:24,210 --> 00:22:28,649
just quit is a setup attack yep

00:22:26,429 --> 00:22:30,379
marzo just attack it ourselves so we run

00:22:28,649 --> 00:22:37,019
the script it takes about five seconds

00:22:30,379 --> 00:22:38,429
maybe there we go refresh the page looks

00:22:37,019 --> 00:22:43,350
like the site's no more app we're still

00:22:38,429 --> 00:22:48,690
on the installer but oops I know you

00:22:43,350 --> 00:22:50,759
don't ya can't type today and I really

00:22:48,690 --> 00:22:52,110
come back there we go we now have our

00:22:50,759 --> 00:22:54,480
remote shell in this new installation

00:22:52,110 --> 00:22:55,590
and the site line it's going to come

00:22:54,480 --> 00:22:56,429
back they're going to run their install

00:22:55,590 --> 00:22:57,779
they're not going to say any different

00:22:56,429 --> 00:23:00,059
they don't know their site their

00:22:57,779 --> 00:23:02,100
installer is back doored and this gives

00:23:00,059 --> 00:23:04,289
us full access to the site and we can

00:23:02,100 --> 00:23:06,629
also because we're running in

00:23:04,289 --> 00:23:07,889
subdirectory go back to the full site

00:23:06,629 --> 00:23:09,200
that this is running some directory of

00:23:07,889 --> 00:23:12,659
so we can you affect that one as well

00:23:09,200 --> 00:23:14,100
again game over so the thing about this

00:23:12,659 --> 00:23:15,360
one is an attacker isn't gonna find out

00:23:14,100 --> 00:23:17,250
instantly they're going to have to be

00:23:15,360 --> 00:23:18,570
searching your site to find us so you

00:23:17,250 --> 00:23:19,679
can you can copy up the service script

00:23:18,570 --> 00:23:20,580
then you can run it and as long as you

00:23:19,679 --> 00:23:20,940
do it within you know a couple of

00:23:20,580 --> 00:23:23,129
minutes

00:23:20,940 --> 00:23:24,840
you're safe there's very very low chance

00:23:23,129 --> 00:23:25,860
they're gonna find it that quickly but

00:23:24,840 --> 00:23:27,450
you don't want to leave it there leave

00:23:25,860 --> 00:23:28,590
it sitting there for hours or days or

00:23:27,450 --> 00:23:30,539
weeks or months or years

00:23:28,590 --> 00:23:32,460
with clean sites we've had a thing like

00:23:30,539 --> 00:23:33,750
this sitting there for years and it's

00:23:32,460 --> 00:23:35,370
been compromised so many times because

00:23:33,750 --> 00:23:37,350
an attacker comes along and installs it

00:23:35,370 --> 00:23:38,760
configures it removes all evidence and

00:23:37,350 --> 00:23:41,190
the signer and it's forgotten it's even

00:23:38,760 --> 00:23:42,570
there so you really need to keep track

00:23:41,190 --> 00:23:46,140
of any new installations that you put on

00:23:42,570 --> 00:23:50,789
the site ok so last thing to talk about

00:23:46,140 --> 00:23:52,740
is plugins ok so the other thing there's

00:23:50,789 --> 00:23:54,299
a belief that some people have is that

00:23:52,740 --> 00:23:56,159
if a plugin is disabled you can't do

00:23:54,299 --> 00:23:58,049
anything it's safe the codes not going

00:23:56,159 --> 00:24:00,960
to be not going to be run and that is a

00:23:58,049 --> 00:24:02,700
very big problem because there are some

00:24:00,960 --> 00:24:04,500
plugins that respond to requests that

00:24:02,700 --> 00:24:06,750
don't go through WordPress so for

00:24:04,500 --> 00:24:08,549
example this one here dopey autosuggest

00:24:06,750 --> 00:24:10,500
has an unauthenticated SQL injection

00:24:08,549 --> 00:24:12,390
vulnerability what that means is we can

00:24:10,500 --> 00:24:13,890
modify the database queries that are

00:24:12,390 --> 00:24:15,480
applied to the database and if you can

00:24:13,890 --> 00:24:17,279
do that then you can update the login

00:24:15,480 --> 00:24:18,480
details you can bypass passwords you can

00:24:17,279 --> 00:24:20,370
extract information delete information

00:24:18,480 --> 00:24:22,440
change stuff it gives you full access to

00:24:20,370 --> 00:24:23,850
the database and the reason why this

00:24:22,440 --> 00:24:26,549
works when the plugin is disabled is

00:24:23,850 --> 00:24:28,039
because the URL it goes directly to the

00:24:26,549 --> 00:24:30,690
plug-in it doesn't go through WordPress

00:24:28,039 --> 00:24:33,140
so we'll grab this and we'll see what we

00:24:30,690 --> 00:24:33,140
can do with it

00:24:34,730 --> 00:24:39,200
take your otherwise it's not gonna work

00:24:40,279 --> 00:24:45,510
ok now what we want to do is figure out

00:24:42,779 --> 00:24:47,460
all the databases on this site oh wait

00:24:45,510 --> 00:24:48,840
up you'll notice how the firewall

00:24:47,460 --> 00:24:50,460
wordfence has blocked it again so this

00:24:48,840 --> 00:24:54,270
is another reason why you want a

00:24:50,460 --> 00:24:55,679
firewall running on your site is because

00:24:54,270 --> 00:24:57,539
it can block attacks like this so this

00:24:55,679 --> 00:24:59,250
is again saying that a generic rule in

00:24:57,539 --> 00:25:00,390
wave fans is blocked and our firewalls

00:24:59,250 --> 00:25:01,380
or similar will block this sort of

00:25:00,390 --> 00:25:04,380
attack because they can detect it

00:25:01,380 --> 00:25:07,830
happening so we run this again and now

00:25:04,380 --> 00:25:09,360
we've got the database so it's giving an

00:25:07,830 --> 00:25:13,710
information schema we know now the

00:25:09,360 --> 00:25:14,850
site's database is 1/2 DB tables you

00:25:13,710 --> 00:25:16,740
want to figure out the table prefix

00:25:14,850 --> 00:25:20,299
because sometimes that gets changed look

00:25:16,740 --> 00:25:20,299
at is 1/2 DB underscore thing

00:25:20,940 --> 00:25:33,730
uses we won't use a pass user email user

00:25:27,130 --> 00:25:37,330
login what's the thing and I put it out

00:25:33,730 --> 00:25:39,250
on there okay that's nothing to download

00:25:37,330 --> 00:25:40,900
the users from a database using your

00:25:39,250 --> 00:25:42,730
spine this has to be of some ability in

00:25:40,900 --> 00:25:43,930
this disable plug-in this gives us

00:25:42,730 --> 00:25:45,160
secret to passwords as well as a

00:25:43,930 --> 00:25:47,170
password that's badly okay

00:25:45,160 --> 00:26:01,150
to sing so well that's running are there

00:25:47,170 --> 00:26:03,520
any questions yeah there we go there's

00:26:01,150 --> 00:26:05,770
email addresses our hashed passwords and

00:26:03,520 --> 00:26:08,950
our login details the bottom hash is an

00:26:05,770 --> 00:26:10,179
md5 which is trivial to to find in a

00:26:08,950 --> 00:26:11,440
lookup table so we could log in as that

00:26:10,179 --> 00:26:14,740
user as well he was also an interest

00:26:11,440 --> 00:26:17,380
rate from our care yeah throat over

00:26:14,740 --> 00:26:20,230
Christmas good morning thank you I've

00:26:17,380 --> 00:26:22,030
got a question about after viewing all

00:26:20,230 --> 00:26:26,140
of that wonderful things the last pass

00:26:22,030 --> 00:26:30,820
or those password protectors yep are

00:26:26,140 --> 00:26:33,100
they safe yes ones like one passwords

00:26:30,820 --> 00:26:34,510
LastPass and pass - like all those

00:26:33,100 --> 00:26:37,150
things they spent a lot of time and

00:26:34,510 --> 00:26:39,010
money making a product safe even one

00:26:37,150 --> 00:26:41,260
pathway I know they have a 1 million

00:26:39,010 --> 00:26:42,910
dollar bounty if you can compromise one

00:26:41,260 --> 00:26:44,140
password and extract passwords out of it

00:26:42,910 --> 00:26:46,120
they will give you a million dollars

00:26:44,140 --> 00:26:48,400
that's how sure they are they're

00:26:46,120 --> 00:26:49,540
security safe is because you're they're

00:26:48,400 --> 00:26:51,309
putting their money on the mouth where

00:26:49,540 --> 00:26:56,220
their mouth is so yeah you can trust

00:26:51,309 --> 00:26:56,220
those products because of that yeah

00:26:59,530 --> 00:27:06,010
what do you think of easy Update Manager

00:27:01,450 --> 00:27:08,110
- people keep everything up to date well

00:27:06,010 --> 00:27:10,210
four core updates definitely let the

00:27:08,110 --> 00:27:12,100
call automatic updates happen and as

00:27:10,210 --> 00:27:14,169
long and the health check in WordPress

00:27:12,100 --> 00:27:15,400
five point whatever it is will tell you

00:27:14,169 --> 00:27:17,679
if automatic updates are working

00:27:15,400 --> 00:27:18,850
properly and so if you you can check

00:27:17,679 --> 00:27:20,620
that to make sure that I make updates

00:27:18,850 --> 00:27:22,809
are there four core and the plugins and

00:27:20,620 --> 00:27:24,190
themes are to luck wordfence or them are

00:27:22,809 --> 00:27:25,929
probably others will actually alert you

00:27:24,190 --> 00:27:27,159
when they're updates available and so as

00:27:25,929 --> 00:27:28,870
long as you've got alerting working

00:27:27,159 --> 00:27:30,549
further for your dscanner

00:27:28,870 --> 00:27:32,470
it'll tell you to go in and apply the

00:27:30,549 --> 00:27:33,850
update and as long as you go in and deal

00:27:32,470 --> 00:27:36,159
with in a day or two you should be fine

00:27:33,850 --> 00:27:38,080
and as you know having a firewall the

00:27:36,159 --> 00:27:39,700
reason why you want around a firewall on

00:27:38,080 --> 00:27:41,200
your site is so that it can protect you

00:27:39,700 --> 00:27:43,000
from attacks before you do the updates

00:27:41,200 --> 00:27:45,010
as well such as the ones we saw there

00:27:43,000 --> 00:27:46,960
the firewall was blocking them so if you

00:27:45,010 --> 00:27:48,280
keep a firewall and then apply updates

00:27:46,960 --> 00:27:50,700
when you're notified about them then you

00:27:48,280 --> 00:27:50,700
should be fine

00:27:59,080 --> 00:28:03,679
where can I get all those fun little

00:28:01,130 --> 00:28:06,110
tools ears that link up there the

00:28:03,679 --> 00:28:07,580
mistletoe I do you yep has all the

00:28:06,110 --> 00:28:09,679
information I'll stop them including one

00:28:07,580 --> 00:28:11,630
of the things I'm I skipped and I've got

00:28:09,679 --> 00:28:14,330
links at the bottom to Adobe scan and

00:28:11,630 --> 00:28:15,710
ask your Mac and such and also if you've

00:28:14,330 --> 00:28:18,140
got any questions email me Stephen

00:28:15,710 --> 00:28:19,910
Atwood fenced calm and I'm running lock

00:28:18,140 --> 00:28:22,850
picking out of the hallway track shortly

00:28:19,910 --> 00:28:23,990
so ask me any questions over that and I

00:28:22,850 --> 00:28:25,549
can teach Olympics and I've got a bag

00:28:23,990 --> 00:28:27,320
full of wet vents swag that's really

00:28:25,549 --> 00:28:28,460
really heavy so please take some because

00:28:27,320 --> 00:28:30,020
I don't have to carry it for this of the

00:28:28,460 --> 00:28:39,740
day it's it's it's ridiculously heavy

00:28:30,020 --> 00:28:42,650
thanks for watching yeah Stephen thanks

00:28:39,740 --> 00:28:44,900
for that I mean the wood fence plug-in

00:28:42,650 --> 00:28:47,240
is available in a free and a paid for

00:28:44,900 --> 00:28:48,470
solution yep we see on some sites where

00:28:47,240 --> 00:28:50,929
we've got it installed in the free

00:28:48,470 --> 00:28:52,970
version where it's clear that the site's

00:28:50,929 --> 00:28:54,950
being attacked and the attacker then

00:28:52,970 --> 00:28:56,330
just changes IP addresses so it goes

00:28:54,950 --> 00:28:59,120
ahead and blocks the IP that it comes

00:28:56,330 --> 00:29:01,160
from but then within seconds it just

00:28:59,120 --> 00:29:02,929
randomly generates wifey's and comes

00:29:01,160 --> 00:29:04,100
from yeah we're doing something wrong is

00:29:02,929 --> 00:29:06,590
there a way to block that out with the

00:29:04,100 --> 00:29:10,040
provision in the word fence premium

00:29:06,590 --> 00:29:12,140
version we have the the real time I paid

00:29:10,040 --> 00:29:14,330
block where is called and the idea of

00:29:12,140 --> 00:29:15,980
that is it uses the entire premium word

00:29:14,330 --> 00:29:17,929
fence network to identify malicious IP

00:29:15,980 --> 00:29:20,900
addresses and block them proactively and

00:29:17,929 --> 00:29:22,370
so to to in order to block attacks where

00:29:20,900 --> 00:29:24,230
the IP addresses are changing you need

00:29:22,370 --> 00:29:25,940
some form of infrastructure around of

00:29:24,230 --> 00:29:27,410
some cloud-based solution and so that's

00:29:25,940 --> 00:29:29,150
why it's part of a paid version of what

00:29:27,410 --> 00:29:30,500
Vince is that it can you check it from

00:29:29,150 --> 00:29:33,350
and it works pretty well we haven't had

00:29:30,500 --> 00:29:35,000
a break but I look at him think he's

00:29:33,350 --> 00:29:36,440
there a bit of white so yeah yeah the

00:29:35,000 --> 00:29:38,870
problem is it's so easy to change IP

00:29:36,440 --> 00:29:40,040
addresses that I mean all you can do is

00:29:38,870 --> 00:29:44,710
try and block that when they come up and

00:29:40,040 --> 00:29:44,710
detect the attacks yeah thank you okay

00:29:52,009 --> 00:29:59,489
um as far as I know yet yep does

00:29:57,330 --> 00:30:01,679
wordfence play well with s2member and

00:29:59,489 --> 00:30:04,200
other membership plugins as far as I

00:30:01,679 --> 00:30:06,389
know it does yeah in the firewall rules

00:30:04,200 --> 00:30:07,590
you can whitelist have so if it does

00:30:06,389 --> 00:30:09,629
block things that should be blocking you

00:30:07,590 --> 00:30:11,309
can add whitelisting in there and so you

00:30:09,629 --> 00:30:12,600
can allow through the pacific calls that

00:30:11,309 --> 00:30:15,479
have been blocked if it's causing

00:30:12,600 --> 00:30:17,850
problems and if you're a premium

00:30:15,479 --> 00:30:19,080
subscriber you've of course or you can

00:30:17,850 --> 00:30:20,789
create out to differ help and have

00:30:19,080 --> 00:30:22,919
something we can help with things with

00:30:20,789 --> 00:30:24,149
we can make we make we make changes to

00:30:22,919 --> 00:30:25,919
we're fence if we need to if it

00:30:24,149 --> 00:30:27,659
completes other things I could recently

00:30:25,919 --> 00:30:28,649
got I made changes to getting working

00:30:27,659 --> 00:30:30,029
there with the engine which is fantastic

00:30:28,649 --> 00:30:31,559
we were wanting two different ages so

00:30:30,029 --> 00:30:34,349
we're finally working on that with the

00:30:31,559 --> 00:30:35,909
engine okay so yeah if there are

00:30:34,349 --> 00:30:36,929
specific problems with plugins we can we

00:30:35,909 --> 00:30:39,259
can look at it and try and work around

00:30:36,929 --> 00:30:39,259
it yeah

00:30:44,780 --> 00:30:50,750
do we have any more questions for

00:30:47,200 --> 00:30:51,200
Stephen I have a question for you

00:30:50,750 --> 00:30:54,410
Stephen

00:30:51,200 --> 00:30:56,180
yep so let's say that I have a bunch of

00:30:54,410 --> 00:30:57,410
client sites and I want to see how hard

00:30:56,180 --> 00:31:00,260
they are to hack what would your advice

00:30:57,410 --> 00:31:03,500
be for developers who want to put their

00:31:00,260 --> 00:31:05,060
sites to the test how do how do you

00:31:03,500 --> 00:31:06,230
start thinking like a hacker like what

00:31:05,060 --> 00:31:10,580
would be the first thing that you would

00:31:06,230 --> 00:31:11,780
suggest to them to try oh if you're a

00:31:10,580 --> 00:31:13,220
developer you want to start thinking

00:31:11,780 --> 00:31:15,530
like a hacker I'd recommend looking

00:31:13,220 --> 00:31:17,600
first CTS so capture the flag so what

00:31:15,530 --> 00:31:20,120
they are hacking competitions we've got

00:31:17,600 --> 00:31:21,440
a scythe specifically set up vulnerable

00:31:20,120 --> 00:31:23,630
signs that you've got to try and break

00:31:21,440 --> 00:31:24,740
into and so it teaches you to look for

00:31:23,630 --> 00:31:26,990
the different ways you can break into a

00:31:24,740 --> 00:31:28,610
length trivial things I do SQL injection

00:31:26,990 --> 00:31:31,850
you'll often have a login form that you

00:31:28,610 --> 00:31:33,410
can modify the query through or you know

00:31:31,850 --> 00:31:35,120
config file there in plain text that

00:31:33,410 --> 00:31:36,320
sort of thing and so that's a fantastic

00:31:35,120 --> 00:31:37,850
way to start if you're a developer

00:31:36,320 --> 00:31:38,840
wanting to get into security he's

00:31:37,850 --> 00:31:39,710
looking for those sorts of things

00:31:38,840 --> 00:31:42,260
because it makes them a bit of a

00:31:39,710 --> 00:31:43,640
challenge and you get the momentum

00:31:42,260 --> 00:31:46,670
building up as you start solving the

00:31:43,640 --> 00:31:49,340
challenges fantastic who is it who's

00:31:46,670 --> 00:31:51,470
gonna try and capture the flag I think

00:31:49,340 --> 00:31:53,180
I'm gonna give it a well we used to run

00:31:51,470 --> 00:31:55,760
one at the US where camps but we've

00:31:53,180 --> 00:31:57,230
stopped doing that now unfortunately do

00:31:55,760 --> 00:31:58,370
we have any other questions for Stephen

00:31:57,230 --> 00:32:01,550
we've got a little bit of time before

00:31:58,370 --> 00:32:08,690
our next presentation so any last

00:32:01,550 --> 00:32:10,460
questions on the back all right I think

00:32:08,690 --> 00:32:13,130
we're done did you want to wrap up then

00:32:10,460 --> 00:32:14,840
Stephen um if there's a little bit of

00:32:13,130 --> 00:32:20,300
time I can show you my thing I dropped

00:32:14,840 --> 00:32:21,350
off my list yeah okay cool so the one

00:32:20,300 --> 00:32:23,600
thing other thing I was gonna talk about

00:32:21,350 --> 00:32:25,940
is I'm not theme so I don't know if

00:32:23,600 --> 00:32:28,670
anyone hears heard or used about news

00:32:25,940 --> 00:32:31,970
and things and plugins before but I sure

00:32:28,670 --> 00:32:34,700
haven't don't so the one thing I faked

00:32:31,970 --> 00:32:37,370
for this talk is let's imagine that 2019

00:32:34,700 --> 00:32:40,130
is actually a paid premium of theme and

00:32:37,370 --> 00:32:41,630
so I wanted on my site I didn't want to

00:32:40,130 --> 00:32:42,410
pay for it and so I found it on an old

00:32:41,630 --> 00:32:43,940
theme site

00:32:42,410 --> 00:32:45,680
so I've downloaded I've installed it I

00:32:43,940 --> 00:32:48,050
ignored the thousands of ads on the

00:32:45,680 --> 00:32:49,130
known theme site and I resolved it on my

00:32:48,050 --> 00:32:50,300
site I'm pretty happy with that but

00:32:49,130 --> 00:32:52,190
there's a problem if we go down the

00:32:50,300 --> 00:32:53,750
bottom here expect everything so the

00:32:52,190 --> 00:32:56,720
bottom line

00:32:53,750 --> 00:32:58,400
but going to sauce what they've done

00:32:56,720 --> 00:33:00,680
we're now I'm removing a life of seen

00:32:58,400 --> 00:33:03,110
from this plug-in is they've added in a

00:33:00,680 --> 00:33:04,340
bunch of different SEO spam links and so

00:33:03,110 --> 00:33:06,560
what they're doing is they're using my

00:33:04,340 --> 00:33:08,300
sites reputation to promote their own

00:33:06,560 --> 00:33:10,670
services so for example NOLA plugins

00:33:08,300 --> 00:33:12,350
comm is promoting themselves able so by

00:33:10,670 --> 00:33:13,880
home to a Kentucky apparently work at

00:33:12,350 --> 00:33:15,460
Brisbane gets advertising from nod

00:33:13,880 --> 00:33:17,660
things who would have known that and

00:33:15,460 --> 00:33:20,750
some guy called Stephen Aires car door

00:33:17,660 --> 00:33:21,950
so these dodgy people okay so that's so

00:33:20,750 --> 00:33:23,000
that's the problem and they do that all

00:33:21,950 --> 00:33:24,470
the time where there is a bigger problem

00:33:23,000 --> 00:33:26,480
if you're using null themes and plugins

00:33:24,470 --> 00:33:29,060
because they're modifying the code you

00:33:26,480 --> 00:33:33,020
don't know what they've also added so in

00:33:29,060 --> 00:33:36,890
this case yeah where's the URL go be

00:33:33,020 --> 00:33:38,570
here they've added a backdoor so now

00:33:36,890 --> 00:33:40,730
this attack the person that writes

00:33:38,570 --> 00:33:42,170
there's no themes can log into your site

00:33:40,730 --> 00:33:44,270
and do whatever they want you know add

00:33:42,170 --> 00:33:47,000
crypto mining Dawson competitors that

00:33:44,270 --> 00:33:48,350
sort of stuff right the other important

00:33:47,000 --> 00:33:50,510
thing to know is there are sites like

00:33:48,350 --> 00:33:52,370
this a search source code search engine

00:33:50,510 --> 00:33:55,910
which means you can find websites based

00:33:52,370 --> 00:33:57,830
on the source code they've got and if we

00:33:55,910 --> 00:33:59,090
go back to here where was it you see

00:33:57,830 --> 00:33:59,990
this thing like here above this theme

00:33:59,090 --> 00:34:02,390
00:33:59,990 --> 00:34:04,730
now if they add in some unique HTML in

00:34:02,390 --> 00:34:06,710
there they can then use the the source

00:34:04,730 --> 00:34:07,850
code engine to find your site once

00:34:06,710 --> 00:34:08,870
they've found just site they can use the

00:34:07,850 --> 00:34:10,730
backdoor they've installed and they've

00:34:08,870 --> 00:34:13,640
got full access to do whatever they want

00:34:10,730 --> 00:34:15,650
on your site and we were investing any

00:34:13,640 --> 00:34:17,690
at the moment a specific node things

00:34:15,650 --> 00:34:19,280
plug inside that we've downloaded all of

00:34:17,690 --> 00:34:20,840
the we've crawled through their site

00:34:19,280 --> 00:34:22,360
downloaded all of the ones they provide

00:34:20,840 --> 00:34:24,860
and they're all infected with malware

00:34:22,360 --> 00:34:26,300
every single download on that site has

00:34:24,860 --> 00:34:27,770
malware in it so as soon as you download

00:34:26,300 --> 00:34:29,030
that an old team will plug in and put on

00:34:27,770 --> 00:34:31,970
your site your site's infected with

00:34:29,030 --> 00:34:33,440
malware and so I heard an amen' talks

00:34:31,970 --> 00:34:35,510
because I just don't don't do it pay for

00:34:33,440 --> 00:34:36,650
the pay for the license or get something

00:34:35,510 --> 00:34:38,270
else get something that's friends in the

00:34:36,650 --> 00:34:41,930
repository you don't want to touch the

00:34:38,270 --> 00:34:43,730
non themes and plugins the ends the fix

00:34:41,930 --> 00:34:44,930
of that one obviously is you go and

00:34:43,730 --> 00:34:47,060
delete the theme or plugin then you

00:34:44,930 --> 00:34:48,830
install the the proper version office or

00:34:47,060 --> 00:34:50,150
something else then you want to run a

00:34:48,830 --> 00:34:51,590
malware scan because it might have

00:34:50,150 --> 00:34:55,010
infected across the other different

00:34:51,590 --> 00:34:56,600
sites um yeah I think that kind of

00:34:55,010 --> 00:34:58,340
covers it all up um it's the only thing

00:34:56,600 --> 00:35:02,630
I was going to show there is still time

00:34:58,340 --> 00:35:04,880
is that hash the bottom so I said this

00:35:02,630 --> 00:35:07,520
is an old hash so there's old users if

00:35:04,880 --> 00:35:11,200
we grab that and then we go over here

00:35:07,520 --> 00:35:13,220
we're going to look up till reverse that

00:35:11,200 --> 00:35:14,690
and that's the yep but that's the

00:35:13,220 --> 00:35:16,850
password for that user name so now we

00:35:14,690 --> 00:35:19,130
can log in as that user to the site so

00:35:16,850 --> 00:35:20,600
even though all of the other accounts on

00:35:19,130 --> 00:35:21,770
that side have got their modern hashes

00:35:20,600 --> 00:35:23,330
that's an old account that's been

00:35:21,770 --> 00:35:24,860
sitting there for years full of

00:35:23,330 --> 00:35:27,770
administrator we can now log into the

00:35:24,860 --> 00:35:28,880
site so the SQL injection vulnerability

00:35:27,770 --> 00:35:31,040
they're little added us to download this

00:35:28,880 --> 00:35:33,619
page allows us to get in as well as a

00:35:31,040 --> 00:35:36,160
siphoner so again full access to do

00:35:33,619 --> 00:35:36,160
whatever we want

00:35:38,020 --> 00:35:42,050
yes so can we just get that on through

00:35:40,910 --> 00:35:43,520
the microphone it's just so that we can

00:35:42,050 --> 00:35:45,830
pick it up I was just saying can you

00:35:43,520 --> 00:35:49,190
tell that it's an md5 from the length of

00:35:45,830 --> 00:35:50,690
the hash yes is that that yeah md5 s

00:35:49,190 --> 00:35:53,180
have absolutely I think it's 32

00:35:50,690 --> 00:35:55,970
characters from memory shall ones have

00:35:53,180 --> 00:35:57,380
40 characters and then as the hashing

00:35:55,970 --> 00:35:57,740
algorithm gets stronger they get a bit

00:35:57,380 --> 00:36:01,160
longer

00:35:57,740 --> 00:36:02,990
Michelle 256 is quite long and 512 gets

00:36:01,160 --> 00:36:04,670
a bit longer but you can also tell it by

00:36:02,990 --> 00:36:06,590
looking at it these top two and very

00:36:04,670 --> 00:36:08,690
different so the dollar sign P dollar

00:36:06,590 --> 00:36:10,280
sign that's telling WordPress the

00:36:08,690 --> 00:36:11,570
hashing format so it says that some

00:36:10,280 --> 00:36:12,950
specific hash format I'll cover what

00:36:11,570 --> 00:36:15,890
they yearly possibly be crypt or

00:36:12,950 --> 00:36:17,690
something and WordPress knows when it

00:36:15,890 --> 00:36:19,130
sees that it can do you can apply that

00:36:17,690 --> 00:36:20,810
hash and work out how to compare the

00:36:19,130 --> 00:36:23,000
password and if you doesn't see that

00:36:20,810 --> 00:36:24,230
then it knows that that's going to be an

00:36:23,000 --> 00:36:25,580
md5 because that's the old legacy

00:36:24,230 --> 00:36:26,030
password he used to use them as sports

00:36:25,580 --> 00:36:27,770
players

00:36:26,030 --> 00:36:30,800
yeah can we describe that I microphone

00:36:27,770 --> 00:36:33,490
down the front here yeah just this

00:36:30,800 --> 00:36:33,490
gentleman in the middle

00:36:34,960 --> 00:36:40,460
so as far as fixing old password hashes

00:36:38,540 --> 00:36:43,520
is that just a matter of updating your

00:36:40,460 --> 00:36:46,640
WordPress maybe changing the salt in the

00:36:43,520 --> 00:36:48,110
in the WP Kampf and just making a new

00:36:46,640 --> 00:36:51,860
password or just making new password

00:36:48,110 --> 00:36:53,240
once the day upgraded you don't need to

00:36:51,860 --> 00:36:54,200
change if you're one upgrade passwords

00:36:53,240 --> 00:36:56,810
with nearly five you don't need to touch

00:36:54,200 --> 00:36:58,160
the salts you just go and change the

00:36:56,810 --> 00:36:59,450
password on the user I think even if

00:36:58,160 --> 00:37:00,740
they log in and it might reset the

00:36:59,450 --> 00:37:02,390
password at that point I think that's

00:37:00,740 --> 00:37:04,460
all WordPress stars from memory so as

00:37:02,390 --> 00:37:05,660
long as that user can log in if they're

00:37:04,460 --> 00:37:08,000
in all views and they haven't logged in

00:37:05,660 --> 00:37:09,530
for years then reset the password on

00:37:08,000 --> 00:37:10,820
them or just delete the account if it

00:37:09,530 --> 00:37:12,910
hasn't been used that long delete it and

00:37:10,820 --> 00:37:16,220
there's probably no reason it's there

00:37:12,910 --> 00:37:18,850
yeah but a login or password change will

00:37:16,220 --> 00:37:22,330
reset the password yep

00:37:18,850 --> 00:37:27,080
just one last question right up the back

00:37:22,330 --> 00:37:28,250
yeah gentleman up the back hangout if we

00:37:27,080 --> 00:37:29,330
just wait for the microphone comment

00:37:28,250 --> 00:37:35,240
just because otherwise it doesn't get

00:37:29,330 --> 00:37:37,700
picked up on the recording if they off

00:37:35,240 --> 00:37:40,220
off LDAP does it drop a hash in the

00:37:37,700 --> 00:37:41,750
local WordPress table as well I've got

00:37:40,220 --> 00:37:43,430
no idea notice I haven't used LDAP with

00:37:41,750 --> 00:37:44,900
WordPress you have to have a look in the

00:37:43,430 --> 00:37:47,750
database to see what it puts in there

00:37:44,900 --> 00:37:49,880
yeah cool thanks but some single Scion

00:37:47,750 --> 00:37:50,480
systems if they don't grab a password on

00:37:49,880 --> 00:37:52,220
the way through

00:37:50,480 --> 00:37:53,600
they're not gonna generate store some

00:37:52,220 --> 00:37:56,600
parts in the database or you somewhere

00:37:53,600 --> 00:37:59,210
you wouldn't think yeah it does I'll

00:37:56,600 --> 00:38:02,240
just throw it back to this in case you

00:37:59,210 --> 00:38:03,350
want that again yeah and as I said

00:38:02,240 --> 00:38:05,480
you've got any more questions about

00:38:03,350 --> 00:38:05,950
stuffing links to anything just send me

00:38:05,480 --> 00:38:08,360
an email

00:38:05,950 --> 00:38:11,630
fantastic and how can we find you on

00:38:08,360 --> 00:38:13,400
social media Stephen um hey you want

00:38:11,630 --> 00:38:14,990
Twitter yes everyone's on Twitter right

00:38:13,400 --> 00:38:19,250
yeah I should put that page to them

00:38:14,990 --> 00:38:21,820
what's the hashtag WCB na yeah he's

00:38:19,250 --> 00:38:24,470
already posted today with hashtag WCB na

00:38:21,820 --> 00:38:25,660
all right let's see those hands doubled

00:38:24,470 --> 00:38:29,830
by lunchtime

00:38:25,660 --> 00:38:33,940
yes I'm florid on Twitter yeah

00:38:29,830 --> 00:38:33,940

YouTube URL: https://www.youtube.com/watch?v=-tYtCZf5VbU


