Title: Jaakko Alajoki: Environmentally friendly WordPress development
Publication date: 2019-09-08
Playlist: WordCamp Nordic 2019
Description: 
	Data centers in the U.S. use more than 90 billion kilowatt-hours of electricity a year. That requires roughly 34 giant coal-powered plants. What can a single developer do to make more energy efficient code? I will go through a series of not-so-serious experiments showing how various implementations made with Raspberry PI web server and power meter affect power consumption. How much energy does enabling WordPress caching save? What about optimizing queries? I will tell.

Presentation slides: https://drive.google.com/open?id=1GpjzKy3nLtV3YUEsjowpJrQcAYhXXCqm
WPTV link: https://wordpress.tv/2019/06/14/jaakko-alajoki-environmentally-friendly-wordpress-development/
Captions: 
	00:00:00,500 --> 00:00:07,319
hello hope you had a good break this is

00:00:04,440 --> 00:00:07,799
gonna be the most important talk of your

00:00:07,319 --> 00:00:10,800
life

00:00:07,799 --> 00:00:13,769
so please listen

00:00:10,800 --> 00:00:17,010
my name is Yoko lucky I'm from a company

00:00:13,769 --> 00:00:22,170
called animate I'm founder of the

00:00:17,010 --> 00:00:25,430
company and also CTO there and today we

00:00:22,170 --> 00:00:30,000
are going to talk about environmentally

00:00:25,430 --> 00:00:34,559
friendly WordPress development let's

00:00:30,000 --> 00:00:38,160
start by checking few numbers it has

00:00:34,559 --> 00:00:41,809
been estimated that in a few years six

00:00:38,160 --> 00:00:46,079
years data center power consumption is

00:00:41,809 --> 00:00:56,010
20% of like all the electricity produced

00:00:46,079 --> 00:01:02,250
on this planet 20% today the yearly

00:00:56,010 --> 00:01:07,439
number is over 400 terawatt-hours or

00:01:02,250 --> 00:01:10,409
each year for me this number doesn't say

00:01:07,439 --> 00:01:13,729
that much but if we think about what it

00:01:10,409 --> 00:01:17,939
takes to produce that it would require

00:01:13,729 --> 00:01:20,130
over 50 nuclear power plants the one we

00:01:17,939 --> 00:01:25,970
have at all what one here in Finland

00:01:20,130 --> 00:01:29,970
it's 900 megawatts or it will take 200

00:01:25,970 --> 00:01:32,040
core power plants for example the one

00:01:29,970 --> 00:01:36,869
here in Helsinki salma sorry you might

00:01:32,040 --> 00:01:39,409
know it two hundred of dollars or the

00:01:36,869 --> 00:01:45,180
biggest windmill in Finland for

00:01:39,409 --> 00:01:49,250
megawatts twelve thousand of tops to

00:01:45,180 --> 00:01:49,250
power all the data centers in the world

00:01:51,299 --> 00:01:59,220
and in a way that's our fault we have

00:01:56,010 --> 00:02:03,450
done the services taking all this energy

00:01:59,220 --> 00:02:10,350
and when we talk about climate change

00:02:03,450 --> 00:02:15,090
and environment we talk about flying we

00:02:10,350 --> 00:02:18,959
talk about needs food production we talk

00:02:15,090 --> 00:02:21,989
about traffic all of these very

00:02:18,959 --> 00:02:26,580
important things I think like we're

00:02:21,989 --> 00:02:30,440
missing one here and I found one source

00:02:26,580 --> 00:02:34,800
saying that the data centers actually

00:02:30,440 --> 00:02:38,640
emit more carbon like a carbon emission

00:02:34,800 --> 00:02:41,880
is bigger than flying so it's a rather

00:02:38,640 --> 00:02:44,640
like quite a big thing and of course

00:02:41,880 --> 00:02:47,760
there's a lot of discussion how the

00:02:44,640 --> 00:02:51,390
energy is produced for the data centers

00:02:47,760 --> 00:02:53,819
but there's not that much discussion how

00:02:51,390 --> 00:02:58,470
to reduce the amount of energy required

00:02:53,819 --> 00:03:00,690
and and especially like what I can do to

00:02:58,470 --> 00:03:05,880
reduce the amount of energy what the

00:03:00,690 --> 00:03:09,989
same services I create I have one case

00:03:05,880 --> 00:03:15,510
example we have been working enough one

00:03:09,989 --> 00:03:19,650
event site and last fall few days before

00:03:15,510 --> 00:03:24,000
the event we realized that the site was

00:03:19,650 --> 00:03:27,329
much low and we start to investigate the

00:03:24,000 --> 00:03:28,920
issue and we found out that it was too

00:03:27,329 --> 00:03:31,769
varnish a cash

00:03:28,920 --> 00:03:36,690
it wasn't caching properly and and

00:03:31,769 --> 00:03:40,230
that's why the side was slow so we had

00:03:36,690 --> 00:03:45,630
pretty much two options break a fixed

00:03:40,230 --> 00:03:49,470
issue or we go scalar fixing it

00:03:45,630 --> 00:03:52,650
fixing they sure will take roughly four

00:03:49,470 --> 00:03:57,260
hours at work that's worth of 400 euros

00:03:52,650 --> 00:04:01,569
roughly scaling will take few minutes

00:03:57,260 --> 00:04:08,270
maybe additional server costs 30 euros

00:04:01,569 --> 00:04:13,730
so you can guess what we did from for

00:04:08,270 --> 00:04:20,859
court to 24 course because he preferred

00:04:13,730 --> 00:04:29,150
cheap it was so easy you mean it's from

00:04:20,859 --> 00:04:32,270
424 I think that right now like we have

00:04:29,150 --> 00:04:35,360
unlimited resources in our haves if we

00:04:32,270 --> 00:04:38,350
need to scale with the scale more CPUs

00:04:35,360 --> 00:04:44,270
more memory no worries there's no like

00:04:38,350 --> 00:04:47,120
finance or penalty for scaling or there

00:04:44,270 --> 00:04:52,639
is some but they supposed to be more and

00:04:47,120 --> 00:04:55,130
I started to think about what I can do

00:04:52,639 --> 00:04:57,620
for this is there something like I'm

00:04:55,130 --> 00:05:02,120
just a single developer and can I do

00:04:57,620 --> 00:05:05,690
something for this issue so I decided to

00:05:02,120 --> 00:05:11,690
build my own data center and run some

00:05:05,690 --> 00:05:16,220
experiments here it is I configured

00:05:11,690 --> 00:05:16,820
raspberry pi server to be a hard worker

00:05:16,220 --> 00:05:20,479
site

00:05:16,820 --> 00:05:23,530
and then I ordered this beautiful power

00:05:20,479 --> 00:05:26,960
consumption meter from Amazon and I

00:05:23,530 --> 00:05:30,080
created a set of experiments to see like

00:05:26,960 --> 00:05:35,260
how various scenarios affect the power

00:05:30,080 --> 00:05:38,560
consumption of the server I have here

00:05:35,260 --> 00:05:38,560
four of them

00:05:38,680 --> 00:05:47,710
first one is pretty obvious cashing in

00:05:44,020 --> 00:05:51,250
able cash episode Prakash it's 70

00:05:47,710 --> 00:05:55,000
percent less energy consumed consumed I

00:05:51,250 --> 00:05:57,610
did this by requesting the front page

00:05:55,000 --> 00:06:00,130
with the passion benchmark I guess this

00:05:57,610 --> 00:06:02,100
was five thousand times or something

00:06:00,130 --> 00:06:05,380
like that

00:06:02,100 --> 00:06:10,150
of course like enable cast is pretty

00:06:05,380 --> 00:06:12,250
obvious but to be honest I have done

00:06:10,150 --> 00:06:16,060
maybe hundreds of sites in my life

00:06:12,250 --> 00:06:19,210
and if the site is very small I know

00:06:16,060 --> 00:06:21,820
it's a lot traffic site it's on a fast

00:06:19,210 --> 00:06:24,490
server and early cache so I have

00:06:21,820 --> 00:06:25,990
deployed many sites without cache even

00:06:24,490 --> 00:06:30,789
though it's obvious that the usual

00:06:25,990 --> 00:06:34,630
always cache second example unused

00:06:30,789 --> 00:06:37,870
plugins please please never do that but

00:06:34,630 --> 00:06:40,360
I went to WordPress plug-in directory

00:06:37,870 --> 00:06:44,190
just installed 20 from the most popular

00:06:40,360 --> 00:06:46,599
list like 20 most relevant plugins and

00:06:44,190 --> 00:06:49,630
suddenly and enabled all of them and

00:06:46,599 --> 00:06:53,979
suddenly double as much energy consumed

00:06:49,630 --> 00:06:54,400
and I know also that this happens all

00:06:53,979 --> 00:06:57,250
the time

00:06:54,400 --> 00:07:04,750
we forget to remove plugins we don't use

00:06:57,250 --> 00:07:09,220
and all those consumes energy the next

00:07:04,750 --> 00:07:14,289
one nested query imagine example where

00:07:09,220 --> 00:07:19,240
you have a list of say apartments and on

00:07:14,289 --> 00:07:22,750
each apartment you have a contact person

00:07:19,240 --> 00:07:25,150
so what you could do it's just like load

00:07:22,750 --> 00:07:28,120
the list of apartments have a loop and

00:07:25,150 --> 00:07:31,479
in that loop load that related conduct

00:07:28,120 --> 00:07:35,590
person so you do multiple queries it's

00:07:31,479 --> 00:07:41,530
quite easy to code but what if you write

00:07:35,590 --> 00:07:43,270
a single joint database query it's a

00:07:41,530 --> 00:07:48,150
little bit text takes like a little bit

00:07:43,270 --> 00:07:50,440
more time a little bit more complex but

00:07:48,150 --> 00:07:56,440
significant change on the power

00:07:50,440 --> 00:08:01,000
consumption the last example I have is

00:07:56,440 --> 00:08:04,690
the very classic PHP optimization if you

00:08:01,000 --> 00:08:07,960
google for PHP or a PHP optimization you

00:08:04,690 --> 00:08:10,509
will always find this do not use regular

00:08:07,960 --> 00:08:14,560
expression if you don't need to your

00:08:10,509 --> 00:08:17,979
string replacements Edina experiment

00:08:14,560 --> 00:08:22,199
with change and learning with like doing

00:08:17,979 --> 00:08:25,360
some replacements for multiple items I

00:08:22,199 --> 00:08:29,139
was surprised how tests that actually

00:08:25,360 --> 00:08:31,289
affect it but yeah 20 percent I can take

00:08:29,139 --> 00:08:31,289
it

00:08:31,320 --> 00:08:38,469
so based on these experiments I can I

00:08:34,959 --> 00:08:41,740
can personally say that from now on all

00:08:38,469 --> 00:08:45,130
the services I create they will consume

00:08:41,740 --> 00:08:47,680
at least work save at least 20 percent

00:08:45,130 --> 00:08:51,880
of energy I can I can say it based on

00:08:47,680 --> 00:08:56,020
these experiences that itself is not

00:08:51,880 --> 00:08:59,370
significant but I'm going to create

00:08:56,020 --> 00:09:04,300
multiple sites hopefully in my life and

00:08:59,370 --> 00:09:09,080
if you all do that as well that all adds

00:09:04,300 --> 00:09:12,810
up and now imagine

00:09:09,080 --> 00:09:16,250
if I do that if everyone in our company

00:09:12,810 --> 00:09:23,089
do that if like all developers here

00:09:16,250 --> 00:09:28,680
globally do that 20% off for example 40

00:09:23,089 --> 00:09:31,070
call powerbands plants less I'm happy to

00:09:28,680 --> 00:09:31,070
take that

00:09:33,730 --> 00:09:41,170
of course it's obvious that I'm standing

00:09:37,750 --> 00:09:45,880
here and saying that please consume less

00:09:41,170 --> 00:09:48,880
CPU that saves energy but I think it is

00:09:45,880 --> 00:09:53,079
the mindset that needs to change we

00:09:48,880 --> 00:09:55,690
optimize our sights for better SEO we

00:09:53,079 --> 00:09:59,050
want better Google rankings we optimize

00:09:55,690 --> 00:10:01,870
our sites for our users people want fast

00:09:59,050 --> 00:10:04,329
sites they don't wanna wait sometimes

00:10:01,870 --> 00:10:07,839
even though all the scaling is easy we

00:10:04,329 --> 00:10:11,740
optimize for lower costs but what I

00:10:07,839 --> 00:10:18,790
would like us to do is to also optimize

00:10:11,740 --> 00:10:22,690
for polar bears that was my message

00:10:18,790 --> 00:10:25,500
today I'm gonna write a blog post to

00:10:22,690 --> 00:10:27,730
ever mates blog about this like all the

00:10:25,500 --> 00:10:31,120
calculations and details information

00:10:27,730 --> 00:10:33,760
about how I did the experiments so if

00:10:31,120 --> 00:10:35,889
you want to see that you can follow me

00:10:33,760 --> 00:10:38,440
on twitter you can follow ever made on

00:10:35,889 --> 00:10:43,209
twitter or you can just uninstall

00:10:38,440 --> 00:10:49,350
twitter go out into nature nature as

00:10:43,209 --> 00:10:49,350
long it is this lasts thank you

00:10:53,170 --> 00:10:55,740

YouTube URL: https://www.youtube.com/watch?v=j-ZN3o8GVE0


