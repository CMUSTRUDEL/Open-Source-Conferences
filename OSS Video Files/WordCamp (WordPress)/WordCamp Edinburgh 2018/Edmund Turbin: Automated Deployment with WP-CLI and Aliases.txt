Title: Edmund Turbin: Automated Deployment with WP-CLI and Aliases
Publication date: 2019-05-10
Playlist: WordCamp Edinburgh 2018
Description: 
	WP-CLI has introduced new ways of working with WordPress via automated commands and scripts. Aliases allow WP-CLI commands to be run on remote servers. Put them together and you have a powerful foundation to run automated processes remotely on multiple servers.
This talk will focus on using WP-CLI to automate deployment of a WordPress database between a development and production website. WP-CLI commands will be joined together in a BASH script that can be executed from the command line.

WPTV link: https://wordpress.tv/2019/04/11/edmund-turbin-automated-deployment-with-wp-cli-and-aliases/
Captions: 
	00:00:04,630 --> 00:00:08,620
I thought of this really cool name

00:00:06,730 --> 00:00:10,540
remote-controlled WordPress and that is

00:00:08,620 --> 00:00:14,050
trying to envision in my head what I

00:00:10,540 --> 00:00:16,689
could do to kind of visually show that

00:00:14,050 --> 00:00:19,029
and I thought like a really cool racecar

00:00:16,689 --> 00:00:21,070
with like a work France logo on the

00:00:19,029 --> 00:00:22,930
front will be cool I started to look at

00:00:21,070 --> 00:00:27,040
stock car knows I'm gonna buy that I

00:00:22,930 --> 00:00:30,820
could pay money for that so but the idea

00:00:27,040 --> 00:00:32,920
is that yes I want to find a way to use

00:00:30,820 --> 00:00:38,980
WTC light and do a little bit more

00:00:32,920 --> 00:00:43,960
automation and here's what we're going

00:00:38,980 --> 00:00:46,930
to talk about today so I'll give you

00:00:43,960 --> 00:00:49,329
this like introduction about what it is

00:00:46,930 --> 00:00:51,400
that I'm talking about so that this kind

00:00:49,329 --> 00:00:53,710
of makes a little bit more sense there

00:00:51,400 --> 00:00:55,510
is a lot of information so if there's

00:00:53,710 --> 00:00:57,820
something that doesn't make a whole lot

00:00:55,510 --> 00:01:00,100
of sense just stop me and say actually

00:00:57,820 --> 00:01:03,579
can you help me understand

00:01:00,100 --> 00:01:08,370
so really the talk is based around WP

00:01:03,579 --> 00:01:13,630
CLI local development using WordPress to

00:01:08,370 --> 00:01:16,390
have a remote connection into actually

00:01:13,630 --> 00:01:17,950
another server so that you can execute

00:01:16,390 --> 00:01:20,740
commands

00:01:17,950 --> 00:01:23,620
so using these aliases which make it

00:01:20,740 --> 00:01:25,450
easier to have a remote connection I'll

00:01:23,620 --> 00:01:27,700
get some database commands and we'll

00:01:25,450 --> 00:01:30,909
we'll finally get a bunch of scripts

00:01:27,700 --> 00:01:34,680
together and look at the complete script

00:01:30,909 --> 00:01:34,680
that actually does something functional

00:01:35,310 --> 00:01:38,310
so

00:01:38,909 --> 00:01:43,979
my name is Edmund as you guys know I

00:01:41,850 --> 00:01:46,649
work as a VP engine it's a digital

00:01:43,979 --> 00:01:51,570
experience platform for WordPress we

00:01:46,649 --> 00:01:53,549
have lots of different ways to host

00:01:51,570 --> 00:01:57,590
WordPress whether it's shared or it's

00:01:53,549 --> 00:02:00,869
dedicated or Enterprise different

00:01:57,590 --> 00:02:02,970
configurations I have a slide here that

00:02:00,869 --> 00:02:04,829
says this is who I am this is what I do

00:02:02,970 --> 00:02:06,990
I figured I'd take it one step further

00:02:04,829 --> 00:02:10,769
and actually go into pictures because

00:02:06,990 --> 00:02:12,840
that's that's more official so this is

00:02:10,769 --> 00:02:16,830
something I really like is cycling and

00:02:12,840 --> 00:02:21,209
we took a trip to Amsterdam this is the

00:02:16,830 --> 00:02:23,040
WP engine London office and what we were

00:02:21,209 --> 00:02:25,470
actually what we realized after this

00:02:23,040 --> 00:02:27,989
picture was taken the the woman who took

00:02:25,470 --> 00:02:30,060
the picture was laughing at us because

00:02:27,989 --> 00:02:35,640
this animal is apparently not so

00:02:30,060 --> 00:02:38,700
friendly I love snowboarding so this is

00:02:35,640 --> 00:02:41,069
a picture of me in the Alps and I also

00:02:38,700 --> 00:02:43,859
love music productions so anytime I get

00:02:41,069 --> 00:02:46,859
I will be in the studio making some

00:02:43,859 --> 00:02:48,269
sorts of sounds and when I'm not doing

00:02:46,859 --> 00:02:50,819
all that I'm with these guys

00:02:48,269 --> 00:02:52,500
those are my kids they're going really

00:02:50,819 --> 00:02:57,840
fast on their best buzz as you can tell

00:02:52,500 --> 00:03:00,840
all right so so yes so a sales engineer

00:02:57,840 --> 00:03:05,280
is really somebody who has to find

00:03:00,840 --> 00:03:07,290
solutions so I look and see a problem

00:03:05,280 --> 00:03:11,609
and I have to find a way to overcome

00:03:07,290 --> 00:03:14,160
that and really define what what the

00:03:11,609 --> 00:03:16,430
solution is and then find a way to get

00:03:14,160 --> 00:03:19,470
there and a lot of times that means

00:03:16,430 --> 00:03:21,930
thinking creatively and by that I mean

00:03:19,470 --> 00:03:24,209
it's maybe not the solution may not be

00:03:21,930 --> 00:03:26,579
within the application or it may not be

00:03:24,209 --> 00:03:28,769
within the platform that I'm using so

00:03:26,579 --> 00:03:30,630
there are times when I'll have to say

00:03:28,769 --> 00:03:32,700
actually I can't do that with this

00:03:30,630 --> 00:03:34,049
platform at all and I have to look at

00:03:32,700 --> 00:03:36,569
something else whether it's a third

00:03:34,049 --> 00:03:40,319
party or it's something completely

00:03:36,569 --> 00:03:43,349
different so the problem that I want to

00:03:40,319 --> 00:03:46,859
solve here was how do I take my database

00:03:43,349 --> 00:03:47,710
on a production website and copy down to

00:03:46,859 --> 00:03:51,160
my local

00:03:47,710 --> 00:03:53,110
environment and it's it's not a

00:03:51,160 --> 00:03:54,880
difficult problem to solve there's many

00:03:53,110 --> 00:03:57,340
ways to do this but I want to do this

00:03:54,880 --> 00:03:59,470
with WP CLI I wanted to do it in a way

00:03:57,340 --> 00:04:01,360
that was repeatable and in something

00:03:59,470 --> 00:04:03,940
that I could really script out do it

00:04:01,360 --> 00:04:10,200
once and then run it on a regular basis

00:04:03,940 --> 00:04:12,630
so the solution involves of course

00:04:10,200 --> 00:04:16,600
developing locally with WordPress

00:04:12,630 --> 00:04:20,890
creating aliases to access WordPress

00:04:16,600 --> 00:04:25,030
site remotely using SSH to connect to

00:04:20,890 --> 00:04:26,770
these remotes and also using WP CLI

00:04:25,030 --> 00:04:33,070
commands to actually get the database

00:04:26,770 --> 00:04:37,120
and do some database interactions people

00:04:33,070 --> 00:04:42,460
here are developers it's a good split

00:04:37,120 --> 00:04:45,640
and do you guys also work locally on

00:04:42,460 --> 00:04:51,430
your development or is it all on servers

00:04:45,640 --> 00:04:52,570
so you couldn't get them out so there's

00:04:51,430 --> 00:04:53,110
a couple of ways that you can work

00:04:52,570 --> 00:04:55,780
locally

00:04:53,110 --> 00:04:59,470
I've always well so I've actually done

00:04:55,780 --> 00:05:03,130
all of these so and in the beginning the

00:04:59,470 --> 00:05:05,260
easiest way to do development was with

00:05:03,130 --> 00:05:06,730
nap so that's kind of what made me say

00:05:05,260 --> 00:05:08,380
actually I'm going to do this because it

00:05:06,730 --> 00:05:10,570
was easy to install this an application

00:05:08,380 --> 00:05:14,100
you install it and you've got this whole

00:05:10,570 --> 00:05:16,360
server you can use virtual machines

00:05:14,100 --> 00:05:19,420
docker containers are really popular now

00:05:16,360 --> 00:05:22,390
as well if you're a complete maverick

00:05:19,420 --> 00:05:25,090
you could build a local server and risk

00:05:22,390 --> 00:05:27,760
your entire development environment

00:05:25,090 --> 00:05:29,680
changing as you have to your us and

00:05:27,760 --> 00:05:32,260
actually there's a lot of solutions from

00:05:29,680 --> 00:05:34,480
a host now so a hosts are more commonly

00:05:32,260 --> 00:05:36,940
bringing a product that will do local

00:05:34,480 --> 00:05:38,790
development and actually bring the local

00:05:36,940 --> 00:05:43,440
environment up to there

00:05:38,790 --> 00:05:45,870
hosting a party so I use DVD press my

00:05:43,440 --> 00:05:48,000
local development tool and one of the

00:05:45,870 --> 00:05:50,600
reasons why I like it is because it has

00:05:48,000 --> 00:05:52,770
a lot more things than just just

00:05:50,600 --> 00:05:56,430
development in large so if lots of

00:05:52,770 --> 00:06:00,050
different tools so uses virtual machine

00:05:56,430 --> 00:06:05,880
this VirtualBox as a virtual machine so

00:06:00,050 --> 00:06:09,180
it essentially is a completely different

00:06:05,880 --> 00:06:11,940
system running on my laptop and it uses

00:06:09,180 --> 00:06:15,080
a tool called vagrant for configuration

00:06:11,940 --> 00:06:18,930
that actually does some provisioning and

00:06:15,080 --> 00:06:20,490
automation so one thing that that really

00:06:18,930 --> 00:06:22,920
struck me when I looked at this slide is

00:06:20,490 --> 00:06:23,400
like Sophie VB does anyone know what it

00:06:22,920 --> 00:06:29,580
stands for

00:06:23,400 --> 00:06:30,480
yeah very vagrant vagrants but you've

00:06:29,580 --> 00:06:33,150
got DVD

00:06:30,480 --> 00:06:35,400
you've got VirtualBox you've got vagrant

00:06:33,150 --> 00:06:38,000
so what are come onto something but we

00:06:35,400 --> 00:06:38,000
might never know

00:06:38,300 --> 00:06:45,240
so VirtualBox is a hypervisor so

00:06:43,020 --> 00:06:48,590
essentially it's a virtual machine

00:06:45,240 --> 00:06:51,720
manager it it takes a slice of your

00:06:48,590 --> 00:06:54,510
computer and it says I can actually run

00:06:51,720 --> 00:06:56,820
another system completely on there so

00:06:54,510 --> 00:06:58,830
you have the concept that so this laptop

00:06:56,820 --> 00:07:02,780
is my host and then a versatile machine

00:06:58,830 --> 00:07:05,610
that runs there would be a guest machine

00:07:02,780 --> 00:07:07,650
you can have multiple machines so it's

00:07:05,610 --> 00:07:10,230
not just one I can have multiple

00:07:07,650 --> 00:07:13,830
operating systems it could be Windows

00:07:10,230 --> 00:07:15,480
Windows Linux Mac it can be something

00:07:13,830 --> 00:07:17,700
that's configured so you can get a

00:07:15,480 --> 00:07:20,190
distribution that's an operating system

00:07:17,700 --> 00:07:22,770
or something that's that's very specific

00:07:20,190 --> 00:07:25,440
to an application and you're also able

00:07:22,770 --> 00:07:28,470
to save State so you can terminate it

00:07:25,440 --> 00:07:30,650
you can stop it you can say that reboot

00:07:28,470 --> 00:07:33,240
when you're not using it so fairly

00:07:30,650 --> 00:07:35,270
fairly easy to go back to where you

00:07:33,240 --> 00:07:40,260
started which can be really really

00:07:35,270 --> 00:07:43,050
interesting and useful so that the

00:07:40,260 --> 00:07:45,120
hypervisor looks somewhat like this so

00:07:43,050 --> 00:07:47,340
if you imagine this is the operating

00:07:45,120 --> 00:07:50,800
system that you're running on and the

00:07:47,340 --> 00:07:54,069
hypervisor is layer a thin layer on top

00:07:50,800 --> 00:07:57,190
that does all of the allocation for

00:07:54,069 --> 00:08:00,490
memory and resources for virtual

00:07:57,190 --> 00:08:03,300
instances so on top of that hypervisor

00:08:00,490 --> 00:08:07,389
we can have these guest virtual machines

00:08:03,300 --> 00:08:10,150
and that's really what is what what DVD

00:08:07,389 --> 00:08:15,520
is doing so I've got my Mac OS and it

00:08:10,150 --> 00:08:17,759
runs Ubuntu on top of that so vagrant

00:08:15,520 --> 00:08:21,430
comes in as a tool that actually

00:08:17,759 --> 00:08:24,310
automates and builds out the system to

00:08:21,430 --> 00:08:28,780
our specifications in the case of DVD

00:08:24,310 --> 00:08:32,740
it's actually doing some installation it

00:08:28,780 --> 00:08:35,140
uses a base box so it's got a virtual

00:08:32,740 --> 00:08:37,450
machine that it starts with and then it

00:08:35,140 --> 00:08:39,760
installs and configures on top of that

00:08:37,450 --> 00:08:42,219
so it does things to the virtual machine

00:08:39,760 --> 00:08:48,930
as well as the local machine in order to

00:08:42,219 --> 00:08:52,420
make that work WP CLI of course

00:08:48,930 --> 00:08:54,160
command-line tool allows you to do

00:08:52,420 --> 00:08:55,959
things in WordPress that you would have

00:08:54,160 --> 00:08:58,600
to actually click around for you'd have

00:08:55,959 --> 00:09:03,730
to go the to dashboard and actually do

00:08:58,600 --> 00:09:05,800
operations with a mouse so allows you to

00:09:03,730 --> 00:09:08,110
also automate things that are repetitive

00:09:05,800 --> 00:09:08,829
so if you want to do something over and

00:09:08,110 --> 00:09:11,020
over again

00:09:08,829 --> 00:09:13,320
you just have to have a script that does

00:09:11,020 --> 00:09:16,420
that you can loop through a script and

00:09:13,320 --> 00:09:19,240
in that you can bundle commands together

00:09:16,420 --> 00:09:27,240
and you can save them run them at any

00:09:19,240 --> 00:09:29,860
time and the base of the system is bash

00:09:27,240 --> 00:09:31,510
so I don't think that we really talked

00:09:29,860 --> 00:09:33,610
too much about bash it's something that

00:09:31,510 --> 00:09:36,730
as a developer I gazed a little bit and

00:09:33,610 --> 00:09:39,220
it's been kind of like a utility but I

00:09:36,730 --> 00:09:43,570
never would say that I'm a bash expert

00:09:39,220 --> 00:09:45,820
and I think it's a it's a tool but it is

00:09:43,570 --> 00:09:48,610
it's really interesting to learn you can

00:09:45,820 --> 00:09:53,250
do a lot more with it than I probably do

00:09:48,610 --> 00:09:56,440
really it's a shell scripting language

00:09:53,250 --> 00:09:58,420
it's almost 30 years old so it's just

00:09:56,440 --> 00:10:00,760
really common you'll find that on you

00:09:58,420 --> 00:10:02,430
know lots of different systems it can

00:10:00,760 --> 00:10:04,710
read command from

00:10:02,430 --> 00:10:06,360
me typing into a terminal or can

00:10:04,710 --> 00:10:08,040
actually read a command from a file and

00:10:06,360 --> 00:10:11,550
that's where we get into your scripting

00:10:08,040 --> 00:10:12,860
and then there is there's some simple

00:10:11,550 --> 00:10:15,270
things that you can do but there's also

00:10:12,860 --> 00:10:18,420
control structures so you can do have

00:10:15,270 --> 00:10:20,910
been statements and variables lots more

00:10:18,420 --> 00:10:24,990
but for the scope of this presentation

00:10:20,910 --> 00:10:26,280
we'll keep it to those two and you know

00:10:24,990 --> 00:10:27,930
throughout the presentation you'll see

00:10:26,280 --> 00:10:30,120
links here so I've always tried to cite

00:10:27,930 --> 00:10:35,730
information if you want to learn more

00:10:30,120 --> 00:10:37,890
about it so I said DV is great because

00:10:35,730 --> 00:10:40,590
Scott a lot of stuff and this is some of

00:10:37,890 --> 00:10:43,740
the stuff that it has so it does the

00:10:40,590 --> 00:10:46,500
server it installs the local server it

00:10:43,740 --> 00:10:48,210
has database with PHP my admin' for

00:10:46,500 --> 00:10:50,400
management and also some other tools

00:10:48,210 --> 00:10:51,810
including WTC lies so there's this

00:10:50,400 --> 00:10:53,670
really great starting point for

00:10:51,810 --> 00:10:56,460
development I don't have to really go

00:10:53,670 --> 00:11:00,450
and install other things configuration

00:10:56,460 --> 00:11:03,290
is is almost finished for me you can add

00:11:00,450 --> 00:11:06,360
additional WordPress sites quite easily

00:11:03,290 --> 00:11:09,060
and so this all runs on top of move on

00:11:06,360 --> 00:11:12,000
to there and this is the virtual machine

00:11:09,060 --> 00:11:17,640
this is a base box that that's that's

00:11:12,000 --> 00:11:25,910
used by BBD and provisioned to be to

00:11:17,640 --> 00:11:25,910
have all of the software on it so

00:11:25,990 --> 00:11:34,550
SSH and any configuration because we

00:11:32,360 --> 00:11:38,510
have this virtual machine it's

00:11:34,550 --> 00:11:41,180
essentially another system running on my

00:11:38,510 --> 00:11:43,820
laptop so there's no way for me to

00:11:41,180 --> 00:11:46,370
actually access it without using a

00:11:43,820 --> 00:11:48,320
remote connection it sounds kind of

00:11:46,370 --> 00:11:50,090
strange that you'd have to remote into

00:11:48,320 --> 00:11:51,740
something that's literally running on

00:11:50,090 --> 00:11:55,790
the same system but they're almost

00:11:51,740 --> 00:11:57,800
entirely separate so that's where SSH

00:11:55,790 --> 00:12:00,950
comes in so you'll have to use that to

00:11:57,800 --> 00:12:04,460
get a remote connection to run any shell

00:12:00,950 --> 00:12:07,960
scripts or any sort of commands using WP

00:12:04,460 --> 00:12:12,140
CLI so

00:12:07,960 --> 00:12:15,230
SSH it can be secured by public/private

00:12:12,140 --> 00:12:18,860
key authentication so I've got a key

00:12:15,230 --> 00:12:20,750
that's on my local system a private key

00:12:18,860 --> 00:12:23,450
which is matched to a public key which

00:12:20,750 --> 00:12:25,820
is on the remote system the benefit is

00:12:23,450 --> 00:12:29,390
so those keys are checked to make sure

00:12:25,820 --> 00:12:33,080
that they match and the benefit is that

00:12:29,390 --> 00:12:36,050
the password is eliminated so you won't

00:12:33,080 --> 00:12:38,420
have to enter a password which is really

00:12:36,050 --> 00:12:41,030
handy for scripting so this can be just

00:12:38,420 --> 00:12:44,480
run by an automated process if you need

00:12:41,030 --> 00:12:46,400
to connect and run the script so it

00:12:44,480 --> 00:12:48,500
looks something like this so this is to

00:12:46,400 --> 00:12:51,170
illustrate that you've got this client

00:12:48,500 --> 00:12:53,660
private key and public key that gets

00:12:51,170 --> 00:12:57,590
checked and some additional information

00:12:53,660 --> 00:13:01,550
there if you want to dig deeper runs on

00:12:57,590 --> 00:13:05,450
SSH runs on port 22 and a typical SSH

00:13:01,550 --> 00:13:09,530
command would be to use SSH the username

00:13:05,450 --> 00:13:11,510
at hostname once you've run that you can

00:13:09,530 --> 00:13:13,760
add options to the end and usually what

00:13:11,510 --> 00:13:17,900
I would do is point to the location of

00:13:13,760 --> 00:13:20,690
my private key so that - I often would

00:13:17,900 --> 00:13:23,510
be at the end of this command and

00:13:20,690 --> 00:13:25,340
sometimes if you're connecting to a

00:13:23,510 --> 00:13:26,930
remote for the first time you'll get a

00:13:25,340 --> 00:13:29,480
message that says do you want to add

00:13:26,930 --> 00:13:31,120
this key to a list of hosts you say yes

00:13:29,480 --> 00:13:35,260
and that never happens again and

00:13:31,120 --> 00:13:38,160
actually saves to your neurosis file and

00:13:35,260 --> 00:13:42,900
make it easier to connect to the future

00:13:38,160 --> 00:13:45,400
so I've given an example of a basic

00:13:42,900 --> 00:13:48,070
configuration file so we can make it

00:13:45,400 --> 00:13:51,760
easier to connect to SSH by using a

00:13:48,070 --> 00:13:53,980
configuration file and what I would

00:13:51,760 --> 00:13:56,800
typically do is take the hostname

00:13:53,980 --> 00:13:59,050
username and then the path to the the

00:13:56,800 --> 00:14:01,930
private key this is probably the minimum

00:13:59,050 --> 00:14:05,230
that you would need to actually set this

00:14:01,930 --> 00:14:07,060
up but whatever I use is your name so

00:14:05,230 --> 00:14:09,040
instead I called in Edmund I would just

00:14:07,060 --> 00:14:11,980
say SSH Edmund and that would go

00:14:09,040 --> 00:14:15,940
directly to don't connect directly to

00:14:11,980 --> 00:14:20,410
the remote server so as part of that

00:14:15,940 --> 00:14:21,310
configuration of what BVD does it uses

00:14:20,410 --> 00:14:23,920
vagrant

00:14:21,310 --> 00:14:24,370
Baker it has a whole set of commands and

00:14:23,920 --> 00:14:27,430
vaguer

00:14:24,370 --> 00:14:30,460
has an ssh configuration command which

00:14:27,430 --> 00:14:31,900
will actually just generate this simple

00:14:30,460 --> 00:14:33,910
you don't have to mess around with

00:14:31,900 --> 00:14:36,010
anything oh it always maybe change the

00:14:33,910 --> 00:14:39,600
host to something that makes sense you

00:14:36,010 --> 00:14:43,060
know go post Edmund or production or dev

00:14:39,600 --> 00:14:45,790
whatever you're using it for and then I

00:14:43,060 --> 00:14:49,150
take this and copy it into my SSH

00:14:45,790 --> 00:14:52,810
configuration file so this is something

00:14:49,150 --> 00:14:55,630
that you can save in one place a group

00:14:52,810 --> 00:15:01,000
of different connections and that makes

00:14:55,630 --> 00:15:03,430
it much easier one thing to know I know

00:15:01,000 --> 00:15:06,430
this is potentially hard to see but this

00:15:03,430 --> 00:15:09,910
port can change so it is very possible

00:15:06,430 --> 00:15:11,860
and I've spent a bunch of time trying to

00:15:09,910 --> 00:15:14,490
figure out why my connections didn't

00:15:11,860 --> 00:15:17,500
work when I would terminate and then

00:15:14,490 --> 00:15:19,120
reboot the virtual machine and the port

00:15:17,500 --> 00:15:20,770
changes so that's that's what I found

00:15:19,120 --> 00:15:22,830
hopefully I'd save some time for all of

00:15:20,770 --> 00:15:26,130
you

00:15:22,830 --> 00:15:31,050
cool how many people are using WPC life

00:15:26,130 --> 00:15:37,560
all right yes you're in the right place

00:15:31,050 --> 00:15:37,560
what about me Lisa's yes okay cool

00:15:37,690 --> 00:15:43,490
so typical command might need to face

00:15:41,250 --> 00:15:48,160
you essentially just

00:15:43,490 --> 00:15:50,720
your commands here on the command line

00:15:48,160 --> 00:15:52,010
it's not very beautiful and a lot of

00:15:50,720 --> 00:15:53,930
people will be scared of this but

00:15:52,010 --> 00:15:55,640
they're just words we can all breathe

00:15:53,930 --> 00:15:57,290
through them it's not really too

00:15:55,640 --> 00:16:01,339
difficult if you take some time to just

00:15:57,290 --> 00:16:03,770
focus on it so I think that elisa's are

00:16:01,339 --> 00:16:05,990
you know just judging from kenneth hands

00:16:03,770 --> 00:16:08,240
there's there's only a few of you who

00:16:05,990 --> 00:16:10,850
actually have used them it's a

00:16:08,240 --> 00:16:13,640
little-known feature and it's it's

00:16:10,850 --> 00:16:16,760
something that is pretty simple to set

00:16:13,640 --> 00:16:18,620
up which can save you a lot of time it's

00:16:16,760 --> 00:16:20,330
essentially just setting a shortcut to

00:16:18,620 --> 00:16:22,520
servers so I don't have to go through

00:16:20,330 --> 00:16:25,370
that whole SSH connection to do

00:16:22,520 --> 00:16:29,360
something I can just specify that I want

00:16:25,370 --> 00:16:31,910
to run a command on a remote it works

00:16:29,360 --> 00:16:35,300
with a very small configuration file is

00:16:31,910 --> 00:16:36,860
a gavel file and one of the cool things

00:16:35,300 --> 00:16:39,470
is you can actually group together in

00:16:36,860 --> 00:16:43,209
these remotes so if you imagine instead

00:16:39,470 --> 00:16:46,040
of running a command in the terminal on

00:16:43,209 --> 00:16:48,350
one WordPress instance I could run it on

00:16:46,040 --> 00:16:49,820
many instances I'll show you how that

00:16:48,350 --> 00:16:55,720
works because I think that's that's

00:16:49,820 --> 00:16:58,250
really cool so you can set aliases

00:16:55,720 --> 00:16:59,899
globally or they can be on a site by

00:16:58,250 --> 00:17:02,660
site basis so it could be at the server

00:16:59,899 --> 00:17:04,490
level or they could be literally for

00:17:02,660 --> 00:17:05,689
each site has different aliases and that

00:17:04,490 --> 00:17:07,939
makes a lot of sense because you

00:17:05,689 --> 00:17:11,630
probably would have different production

00:17:07,939 --> 00:17:13,970
for each site yeah and then you know

00:17:11,630 --> 00:17:17,270
clearly then the benefit is time saved

00:17:13,970 --> 00:17:21,050
so I don't have to really log in sorry

00:17:17,270 --> 00:17:24,679
connect with SSH change directories run

00:17:21,050 --> 00:17:28,400
a command then exit and then do whatever

00:17:24,679 --> 00:17:30,500
else I was going to do so these remotes

00:17:28,400 --> 00:17:33,470
then do they they get set up with

00:17:30,500 --> 00:17:36,110
aliases to look like yes so this would

00:17:33,470 --> 00:17:38,510
be my production site I've got the SSH

00:17:36,110 --> 00:17:42,890
connection that we specified in SH

00:17:38,510 --> 00:17:45,230
config and I've got the path here for my

00:17:42,890 --> 00:17:48,610
dev environment and that's something

00:17:45,230 --> 00:17:52,690
that you'll need for

00:17:48,610 --> 00:17:55,030
and gripping the together very simply

00:17:52,690 --> 00:17:58,720
can be done my dad and if I ran a

00:17:55,030 --> 00:18:05,710
command on both that would actually run

00:17:58,720 --> 00:18:07,630
on those amazing simple commands this is

00:18:05,710 --> 00:18:10,660
how you would use an alias so that the

00:18:07,630 --> 00:18:14,350
normal command that structure for a WP

00:18:10,660 --> 00:18:17,670
CLI is WP command and sub command

00:18:14,350 --> 00:18:20,470
so in this case we're doing the active

00:18:17,670 --> 00:18:23,170
in this and that we'll run that command

00:18:20,470 --> 00:18:25,600
on the dev server which I usually have

00:18:23,170 --> 00:18:27,040
this DVD and then production you might

00:18:25,600 --> 00:18:33,670
get totally different results depending

00:18:27,040 --> 00:18:34,750
on what's installed so as this problem

00:18:33,670 --> 00:18:36,970
that we're trying to solve involves

00:18:34,750 --> 00:18:39,270
database commands we'll talk about a

00:18:36,970 --> 00:18:43,450
couple of database commands but actually

00:18:39,270 --> 00:18:44,680
not too many one of the really important

00:18:43,450 --> 00:18:48,130
things to know is that you can always

00:18:44,680 --> 00:18:51,430
get help so the help command takes a sub

00:18:48,130 --> 00:18:53,080
command and will give you a nice display

00:18:51,430 --> 00:18:57,490
of all the things that we can actually

00:18:53,080 --> 00:18:59,560
do with that WP CLI command and we're DB

00:18:57,490 --> 00:19:03,420
there's a couple of really useful things

00:18:59,560 --> 00:19:06,780
you can optimize you can look at the

00:19:03,420 --> 00:19:09,550
tables prefix actually used some repairs

00:19:06,780 --> 00:19:16,620
but in this case we're going to look at

00:19:09,550 --> 00:19:19,470
export and import all right

00:19:16,620 --> 00:19:27,120
so let's take a bunch of commands and

00:19:19,470 --> 00:19:31,049
tie them all together so I've started to

00:19:27,120 --> 00:19:33,059
take WP CLI and mix it with a bit of

00:19:31,049 --> 00:19:36,630
shell scripting and this is not going to

00:19:33,059 --> 00:19:40,110
be too involved but the the idea here is

00:19:36,630 --> 00:19:42,960
that you can add some logic into your WP

00:19:40,110 --> 00:19:45,690
CLI commands so in this case I'm going

00:19:42,960 --> 00:19:48,000
to my production server I'm looking to

00:19:45,690 --> 00:19:51,380
see if Hello Dolly isn't solved so it's

00:19:48,000 --> 00:19:56,429
plug-in is installed hello

00:19:51,380 --> 00:19:58,679
batch has a variable this question mark

00:19:56,429 --> 00:20:01,529
variable and essentially what that does

00:19:58,679 --> 00:20:05,190
is it will give me the value for the

00:20:01,529 --> 00:20:07,529
last minute right and in this case we

00:20:05,190 --> 00:20:11,580
want to check if the plug-in is

00:20:07,529 --> 00:20:15,419
installed and if it's not installed go

00:20:11,580 --> 00:20:17,940
ahead install so all this is doing here

00:20:15,419 --> 00:20:21,990
it's quite simply an if-then statement

00:20:17,940 --> 00:20:27,600
so if that if the result is not equal to

00:20:21,990 --> 00:20:31,309
zero then install plugin because

00:20:27,600 --> 00:20:31,309
everyone wants to install hello don't

00:20:32,480 --> 00:20:37,799
and then so what I've done is just to

00:20:35,789 --> 00:20:40,260
take the comments out just reduce it

00:20:37,799 --> 00:20:42,659
show that it's really simple clear and

00:20:40,260 --> 00:20:44,159
actually for any bash scripts you're

00:20:42,659 --> 00:20:45,990
going to need this thing at the top

00:20:44,159 --> 00:20:48,659
called this shebang it's really just

00:20:45,990 --> 00:20:53,029
tells where the this file should be

00:20:48,659 --> 00:20:55,559
wrong what application should run it so

00:20:53,029 --> 00:20:57,779
we talked about variables and control

00:20:55,559 --> 00:21:00,570
structures that you've seen the offends

00:20:57,779 --> 00:21:04,020
the variables can be created very simply

00:21:00,570 --> 00:21:06,120
so I just say name equals Edmund give it

00:21:04,020 --> 00:21:08,100
a string and then there's an echo

00:21:06,120 --> 00:21:11,059
command which actually will print that

00:21:08,100 --> 00:21:14,419
variable out to screen so echo name

00:21:11,059 --> 00:21:14,419
would print out

00:21:17,140 --> 00:21:23,900
so it gets deeper we can take the output

00:21:20,990 --> 00:21:26,690
of a command and say it as a variable as

00:21:23,900 --> 00:21:29,030
well so I put the command in these

00:21:26,690 --> 00:21:33,320
brackets and I'm actually just saving

00:21:29,030 --> 00:21:35,330
the blog name as block name and then

00:21:33,320 --> 00:21:44,990
again echoing it and then printing a

00:21:35,330 --> 00:21:47,750
blog so in our case I'll need to get the

00:21:44,990 --> 00:21:51,530
site URL from production and I'll need

00:21:47,750 --> 00:21:55,790
to replace that with the dev site URL so

00:21:51,530 --> 00:21:58,150
I use option get site URL and save that

00:21:55,790 --> 00:22:08,350
into a variable for both production and

00:21:58,150 --> 00:22:12,830
development so this is really the

00:22:08,350 --> 00:22:14,570
coolest part I think and take a little

00:22:12,830 --> 00:22:17,179
while for me to figure this out even

00:22:14,570 --> 00:22:20,390
though it's pretty straightforward I'm

00:22:17,179 --> 00:22:22,309
going into production I'm exporting the

00:22:20,390 --> 00:22:27,350
database but the other stuff this is a

00:22:22,309 --> 00:22:29,480
little bit tricky so that that - it

00:22:27,350 --> 00:22:32,120
actually takes the the entire database

00:22:29,480 --> 00:22:32,860
the sequel dump and prints it out to the

00:22:32,120 --> 00:22:35,630
screen

00:22:32,860 --> 00:22:37,880
which doesn't really help you that much

00:22:35,630 --> 00:22:43,669
at all it's going to be a long-running

00:22:37,880 --> 00:22:45,830
screen of sequel statements the greater

00:22:43,669 --> 00:22:49,220
than symbol actually takes that output

00:22:45,830 --> 00:22:51,559
redirects it to a file and it's it's not

00:22:49,220 --> 00:22:53,000
any file on this production environment

00:22:51,559 --> 00:22:55,970
since I'm actually running in from a

00:22:53,000 --> 00:22:56,630
different system it's gonna save it

00:22:55,970 --> 00:22:58,700
locally

00:22:56,630 --> 00:23:00,919
wherever in the command and that's

00:22:58,700 --> 00:23:04,610
brilliant so I don't have to go and

00:23:00,919 --> 00:23:07,010
download the file and then process it or

00:23:04,610 --> 00:23:12,590
do we know whatever else it's there

00:23:07,010 --> 00:23:15,429
already so my next step is to actually

00:23:12,590 --> 00:23:17,900
import that into my dev environment and

00:23:15,429 --> 00:23:21,530
pretty straightforward so I'm doing dev

00:23:17,900 --> 00:23:23,830
DB import and giving it the path to the

00:23:21,530 --> 00:23:23,830
bottom

00:23:26,980 --> 00:23:31,180
there's a search and replace function

00:23:29,050 --> 00:23:33,900
this is actually a totally different

00:23:31,180 --> 00:23:37,060
thing this is not part of the database

00:23:33,900 --> 00:23:39,010
command but that's essentially what it

00:23:37,060 --> 00:23:41,350
does it will search for one string and

00:23:39,010 --> 00:23:44,050
replace with the other so my production

00:23:41,350 --> 00:23:49,840
site girl replacing it with the dev site

00:23:44,050 --> 00:23:52,780
URL and what would coding be without

00:23:49,840 --> 00:23:55,690
some housekeeping so we we take the file

00:23:52,780 --> 00:23:59,230
that we downloaded and remove it simply

00:23:55,690 --> 00:24:03,340
the RM command get rid of it our last

00:23:59,230 --> 00:24:06,430
step so in order to run a script we need

00:24:03,340 --> 00:24:09,670
to make it executable and in this case

00:24:06,430 --> 00:24:13,050
we'll use a command college mod and that

00:24:09,670 --> 00:24:16,930
essentially will go and add this

00:24:13,050 --> 00:24:20,380
executable permission to our file so we

00:24:16,930 --> 00:24:24,990
are get DV shell file will actually be

00:24:20,380 --> 00:24:31,300
able to be executed by typing dot slash

00:24:24,990 --> 00:24:34,360
get BT so put that all together for you

00:24:31,300 --> 00:24:36,370
guys it is here this is what it looks

00:24:34,360 --> 00:24:40,180
like and it's born just like a couple of

00:24:36,370 --> 00:24:44,190
lines that can be run to take your

00:24:40,180 --> 00:24:47,380
production database to your development

00:24:44,190 --> 00:24:49,060
this could be done weekly I don't know

00:24:47,380 --> 00:24:51,040
what the best practices are for you guys

00:24:49,060 --> 00:24:53,050
I would say probably weekly makes a lot

00:24:51,040 --> 00:24:55,840
of sense because things can change on

00:24:53,050 --> 00:24:58,690
you know assuming that all of the work

00:24:55,840 --> 00:25:00,460
is being done on a staging server or

00:24:58,690 --> 00:25:02,680
another server and then push to

00:25:00,460 --> 00:25:04,840
production so you want to get the most

00:25:02,680 --> 00:25:08,170
current version of your production

00:25:04,840 --> 00:25:10,720
content I've saved that here on github

00:25:08,170 --> 00:25:20,020
as well so you can take a look download

00:25:10,720 --> 00:25:23,560
that and in conclusion so you can use

00:25:20,020 --> 00:25:25,840
aliases and WPC lie with BDD it makes

00:25:23,560 --> 00:25:28,600
for a really great system I think that

00:25:25,840 --> 00:25:30,650
it is pretty straightforward and can

00:25:28,600 --> 00:25:34,100
make things a lot quicker

00:25:30,650 --> 00:25:37,040
scripting can make things repeatable and

00:25:34,100 --> 00:25:40,760
make life a little bit easier by you to

00:25:37,040 --> 00:25:46,520
do things quickly with some pre-planning

00:25:40,760 --> 00:25:49,850
of course I've just put a blog post on

00:25:46,520 --> 00:25:52,100
torque magazine so it is a two part

00:25:49,850 --> 00:25:55,100
series about well I've talked about

00:25:52,100 --> 00:25:57,650
today the first part is live and this is

00:25:55,100 --> 00:26:00,260
talking about aliases the second part

00:25:57,650 --> 00:26:02,990
goes into the script with the database

00:26:00,260 --> 00:26:08,240
network which I talked about that will

00:26:02,990 --> 00:26:12,610
be live tomorrow ish and I've also added

00:26:08,240 --> 00:26:15,140
some links some reference essentially

00:26:12,610 --> 00:26:16,730
yeah there's a lot a lot of information

00:26:15,140 --> 00:26:20,929
here so if you want to learn more about

00:26:16,730 --> 00:26:23,450
SSH that's here I've added a alternative

00:26:20,929 --> 00:26:25,550
to you know maybe you don't wanna use

00:26:23,450 --> 00:26:27,980
WPC live for this at all because it

00:26:25,550 --> 00:26:28,910
actually is a process that other things

00:26:27,980 --> 00:26:31,970
will do so

00:26:28,910 --> 00:26:34,270
WP migrate is available you can do this

00:26:31,970 --> 00:26:38,140
in a plugin that be a lot simpler

00:26:34,270 --> 00:26:41,390
there's a reference / WP select man's

00:26:38,140 --> 00:26:42,830
link to a script tutorial so if you want

00:26:41,390 --> 00:26:45,679
to learn further about bash scripting

00:26:42,830 --> 00:26:47,390
you can go in and do that there and also

00:26:45,679 --> 00:26:49,640
you know of course you don't have to use

00:26:47,390 --> 00:26:53,210
BB you can use and other approach may be

00:26:49,640 --> 00:26:58,429
forward-looking would be to check out WP

00:26:53,210 --> 00:27:00,710
local doctor so that's that's really

00:26:58,429 --> 00:27:03,140
what I came here to talk about I hope

00:27:00,710 --> 00:27:06,620
you guys enjoyed it and I've got some

00:27:03,140 --> 00:27:10,040
slides available on SlideShare and you

00:27:06,620 --> 00:27:12,920
can reach out you can get me at admin

00:27:10,040 --> 00:27:15,820
dr. minute WP engine calm and on twitter

00:27:12,920 --> 00:27:15,820
at spice it out

00:27:16,890 --> 00:27:31,370
[Applause]

00:27:25,090 --> 00:27:36,799
any questions Fred yes as well as

00:27:31,370 --> 00:27:39,580
capturing what both of you saying all

00:27:36,799 --> 00:27:39,580
for counseling

00:27:44,679 --> 00:27:51,140
so copying the files as well I would I

00:27:50,000 --> 00:27:54,320
would do it in a different way

00:27:51,140 --> 00:27:57,320
yes I would I would probably be using

00:27:54,320 --> 00:27:59,360
github or git repository and I would

00:27:57,320 --> 00:28:04,130
sink that way so just deploy the changes

00:27:59,360 --> 00:28:10,159
to both when you pull down in the

00:28:04,130 --> 00:28:12,500
production to staging about any like

00:28:10,159 --> 00:28:14,299
probably date site users think that's

00:28:12,500 --> 00:28:16,610
inside the production things makes it

00:28:14,299 --> 00:28:18,470
might come down with it depends yeah

00:28:16,610 --> 00:28:20,390
yeah and then there's definitely so in

00:28:18,470 --> 00:28:26,330
the case of like full commerce of you're

00:28:20,390 --> 00:28:28,970
taking transactions yeah so I haven't

00:28:26,330 --> 00:28:32,210
had to but I imagine that you would want

00:28:28,970 --> 00:28:33,950
to if it was sensitive information and

00:28:32,210 --> 00:28:36,140
some people will not want to use

00:28:33,950 --> 00:28:38,480
production in staging environment so

00:28:36,140 --> 00:28:40,820
it's perfectly valid I've done much

00:28:38,480 --> 00:28:42,529
smaller stuff then yeah those can almost

00:28:40,820 --> 00:28:44,929
around that can you be selective about

00:28:42,529 --> 00:28:47,480
what tables you know what do you do I

00:28:44,929 --> 00:28:49,789
bet you could yes I think you could

00:28:47,480 --> 00:28:52,429
export and exclude certain tables yeah

00:28:49,789 --> 00:28:54,289
so and and there's you know you can use

00:28:52,429 --> 00:28:57,830
you know you can write custom queries

00:28:54,289 --> 00:28:59,120
and do that with WC liens and then you

00:28:57,830 --> 00:29:01,580
know there's other tools that will allow

00:28:59,120 --> 00:29:03,679
you to select so I know for WP engine

00:29:01,580 --> 00:29:05,360
there's a way to use our legacy staging

00:29:03,679 --> 00:29:07,760
which will allow you to get certain

00:29:05,360 --> 00:29:09,470
tables and not other ones so but that

00:29:07,760 --> 00:29:12,070
doesn't really help me to get it to the

00:29:09,470 --> 00:29:12,070
local park

00:29:12,690 --> 00:29:18,210
you see light or and if you do did you

00:29:16,320 --> 00:29:22,790
do it fairly often enough you can use

00:29:18,210 --> 00:29:22,790
your downloa file to specify what tables

00:29:29,350 --> 00:29:32,789
alright anybody else

00:29:37,100 --> 00:29:45,030

YouTube URL: https://www.youtube.com/watch?v=k89HATPboDo


