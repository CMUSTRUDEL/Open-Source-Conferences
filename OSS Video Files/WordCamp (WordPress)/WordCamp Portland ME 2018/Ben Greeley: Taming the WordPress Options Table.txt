Title: Ben Greeley: Taming the WordPress Options Table
Publication date: 2019-04-13
Playlist: WordCamp Portland ME 2018
Description: 
	The wp_options database table is the center of all WordPress websites. It stores critical site data and is used on nearly every page in WordPress. However, itâ€™s also very easy for the wp_options table to slow your site to a grinding halt. This talk will review best practices for keeping your wp_options table in check to keep your site performant.

WPTV link: https://wordpress.tv/2019/02/02/ben-greeley-taming-the-wordpress-options-table/
Captions: 
	00:00:03,550 --> 00:00:08,889
hey my name is Ben really I live up in

00:00:07,420 --> 00:00:11,889
Brunswick which is about 30 minute drive

00:00:08,889 --> 00:00:13,510
from here if you guys are missing

00:00:11,889 --> 00:00:15,070
Portland's and this thing maybe we

00:00:13,510 --> 00:00:16,270
should make a drive up the highway visit

00:00:15,070 --> 00:00:18,369
Brunswick because it's a beautiful

00:00:16,270 --> 00:00:22,870
little downtown and place to check out

00:00:18,369 --> 00:00:24,490
but I'm not here to promote Brunswick

00:00:22,870 --> 00:00:28,030
I'm here to talk about WordPress and

00:00:24,490 --> 00:00:30,910
often staple I am director of

00:00:28,030 --> 00:00:33,520
engineering at antenna tech is Mitchell

00:00:30,910 --> 00:00:37,450
Agency where we specialize in developing

00:00:33,520 --> 00:00:38,640
large websites for enterprise clients if

00:00:37,450 --> 00:00:40,989
you have any questions for me about

00:00:38,640 --> 00:00:43,450
tenant or about the presentation that

00:00:40,989 --> 00:00:46,060
I'm going to give that we reject me or

00:00:43,450 --> 00:00:47,470
see me after the presentation but yeah

00:00:46,060 --> 00:00:49,960
I'm gonna be talking about the word

00:00:47,470 --> 00:00:52,720
press options table which it can cause

00:00:49,960 --> 00:00:55,660
many headaches and because both sides

00:00:52,720 --> 00:00:57,130
give their hair out sometimes so a

00:00:55,660 --> 00:00:59,440
little background what the word press

00:00:57,130 --> 00:01:01,719
options table is the word press options

00:00:59,440 --> 00:01:04,149
table is where we're pet stores all

00:01:01,719 --> 00:01:05,049
sorts of site settings such as plug-in

00:01:04,149 --> 00:01:08,170
settings

00:01:05,049 --> 00:01:10,869
theme settings pretty much anything else

00:01:08,170 --> 00:01:13,179
that developers may want over there it's

00:01:10,869 --> 00:01:15,880
a pretty simple table you can see that

00:01:13,179 --> 00:01:17,619
basically you specify an option name of

00:01:15,880 --> 00:01:19,749
value for the option and whether or not

00:01:17,619 --> 00:01:22,779
the option should be a lot loaded into

00:01:19,749 --> 00:01:24,850
memory and that's about it

00:01:22,779 --> 00:01:26,529
but even though this is a simple table

00:01:24,850 --> 00:01:28,209
you should pay particular attention to

00:01:26,529 --> 00:01:30,789
this presentation if you develop

00:01:28,209 --> 00:01:32,920
WordPress themes or plugins or even just

00:01:30,789 --> 00:01:35,139
maintain a WordPress website because

00:01:32,920 --> 00:01:37,480
like I said before I left untamed the

00:01:35,139 --> 00:01:40,390
word press options table can slow

00:01:37,480 --> 00:01:42,460
let's say or even worse as I learned the

00:01:40,390 --> 00:01:46,090
hard way and I'll tell you a little bit

00:01:42,460 --> 00:01:48,820
about that story so a while back I was

00:01:46,090 --> 00:01:51,520
working on a high traffic high traffic

00:01:48,820 --> 00:01:53,170
website there were thousands of pages on

00:01:51,520 --> 00:01:55,390
the site it got lots of traffic every

00:01:53,170 --> 00:01:57,130
day and we started getting complaints

00:01:55,390 --> 00:01:59,350
that the website is running much slower

00:01:57,130 --> 00:02:03,700
than usual also started hearing

00:01:59,350 --> 00:02:05,980
complaints about the WordPress admin not

00:02:03,700 --> 00:02:07,750
saving correctly when people would go

00:02:05,980 --> 00:02:10,000
into the WordPress admin and try to save

00:02:07,750 --> 00:02:11,350
the setting the changes weren't being

00:02:10,000 --> 00:02:13,570
reflected on the front-end for some

00:02:11,350 --> 00:02:15,910
reason so I decided to take a look and

00:02:13,570 --> 00:02:18,010
see what was going on my natural

00:02:15,910 --> 00:02:21,460
instinct was to blame caching because

00:02:18,010 --> 00:02:23,950
every time we reset the cache seem to

00:02:21,460 --> 00:02:26,020
magically fix it and so basically I

00:02:23,950 --> 00:02:28,150
reset the cache every day for a couple

00:02:26,020 --> 00:02:30,370
of weeks until I figured out that

00:02:28,150 --> 00:02:31,660
something else must be going on and it's

00:02:30,370 --> 00:02:35,920
time to take a deeper look into this

00:02:31,660 --> 00:02:37,810
situation so when I took a look at the

00:02:35,920 --> 00:02:40,720
options table I saw quite a few things

00:02:37,810 --> 00:02:42,490
going on there that were problematic you

00:02:40,720 --> 00:02:44,920
know it was about 20 megabytes in size

00:02:42,490 --> 00:02:47,410
which is over 20 times larger than it

00:02:44,920 --> 00:02:49,450
should be it turns out a popular

00:02:47,410 --> 00:02:51,430
wordpress plugin has synced with google

00:02:49,450 --> 00:02:54,550
search console and pulled over all the

00:02:51,430 --> 00:02:56,680
data for that large website so Google

00:02:54,550 --> 00:02:58,840
search console stores like keywords or

00:02:56,680 --> 00:03:00,730
how people find your website Elsa says

00:02:58,840 --> 00:03:02,920
like what the top pages are the

00:03:00,730 --> 00:03:05,470
penalties on these keywords and so

00:03:02,920 --> 00:03:07,690
there's a ton of data for a lot of pages

00:03:05,470 --> 00:03:10,250
and that just filled the optimist table

00:03:07,690 --> 00:03:13,190
so that plugin was not doing what

00:03:10,250 --> 00:03:15,560
been doing you know the recommended size

00:03:13,190 --> 00:03:17,540
for the option staples about one

00:03:15,560 --> 00:03:20,120
megabyte or less and the reason for that

00:03:17,540 --> 00:03:22,790
limit is that WordPress versus means

00:03:20,120 --> 00:03:24,380
that many caching plugins actually by

00:03:22,790 --> 00:03:26,540
default have a one megabyte limit by

00:03:24,380 --> 00:03:28,820
default so if you have a caching plug-in

00:03:26,540 --> 00:03:31,010
installed and you try to pull over or

00:03:28,820 --> 00:03:32,780
like a 20 megabytes of data over on the

00:03:31,010 --> 00:03:35,630
root page load that's not going to

00:03:32,780 --> 00:03:37,790
update your pages on every page load so

00:03:35,630 --> 00:03:39,320
it's going to be storing stale data and

00:03:37,790 --> 00:03:41,510
that's it's what's going on with the

00:03:39,320 --> 00:03:45,920
admin options not saving those tell me

00:03:41,510 --> 00:03:48,380
about earlier next time goes into the

00:03:45,920 --> 00:03:50,090
things the custom themes keys peacoat

00:03:48,380 --> 00:03:52,880
and saw some of your things going on

00:03:50,090 --> 00:03:54,950
there that we cover sugar the add

00:03:52,880 --> 00:03:57,920
option and update option Publishing's

00:03:54,950 --> 00:03:59,600
weren't being used correctly you can see

00:03:57,920 --> 00:04:02,120
here these are the definitions of

00:03:59,600 --> 00:04:04,880
adoption update option and you pass over

00:04:02,120 --> 00:04:06,440
a name for the option the value and

00:04:04,880 --> 00:04:09,530
whether whether or not you want to auto

00:04:06,440 --> 00:04:12,950
load so yes or no bite the fall you can

00:04:09,530 --> 00:04:14,330
see the other load is it defaults to

00:04:12,950 --> 00:04:16,459
either no or yes

00:04:14,330 --> 00:04:20,419
and let's know it actually saves is yes

00:04:16,459 --> 00:04:22,370
so if you just update option and or add

00:04:20,419 --> 00:04:24,800
option and don't specify all the load

00:04:22,370 --> 00:04:27,729
every single option that you are saving

00:04:24,800 --> 00:04:27,729
it's going to be model

00:04:28,060 --> 00:04:32,889
you know what allotted other limited

00:04:30,400 --> 00:04:34,840
options are very helpful so let's say

00:04:32,889 --> 00:04:36,639
you would have 50 options that you want

00:04:34,840 --> 00:04:38,169
to use on every single page this

00:04:36,639 --> 00:04:41,289
basically lets you grab all the options

00:04:38,169 --> 00:04:42,490
at once but that's not very good when

00:04:41,289 --> 00:04:43,780
you have a lot of options that don't

00:04:42,490 --> 00:04:45,729
need to feel an every page so if you

00:04:43,780 --> 00:04:47,020
have you know just some sort of weird

00:04:45,729 --> 00:04:48,370
thing you're storing there for one

00:04:47,020 --> 00:04:51,130
particular plug-in and one particular

00:04:48,370 --> 00:04:54,160
page it's very inefficient that will

00:04:51,130 --> 00:04:55,780
load that on every page to illustrate

00:04:54,160 --> 00:04:58,509
the point of what should have been

00:04:55,780 --> 00:05:01,180
happening there's functions this first

00:04:58,509 --> 00:05:03,699
example is storing a very large value so

00:05:01,180 --> 00:05:06,220
this is the letter X repeated about a

00:05:03,699 --> 00:05:11,139
million times and it speaks store in the

00:05:06,220 --> 00:05:12,849
options table and because the not being

00:05:11,139 --> 00:05:15,849
specified this is gonna be loaded on

00:05:12,849 --> 00:05:18,310
every single page on the website where

00:05:15,849 --> 00:05:20,199
it's like if we have passed over no to

00:05:18,310 --> 00:05:22,030
me as a third parameter for the update

00:05:20,199 --> 00:05:23,500
option that would have not loaded on the

00:05:22,030 --> 00:05:25,630
page and we could have just pulled that

00:05:23,500 --> 00:05:28,810
option when we needed it

00:05:25,630 --> 00:05:31,720
so I talked a little bit about what

00:05:28,810 --> 00:05:33,370
autoloading does you know it basically

00:05:31,720 --> 00:05:35,020
loads things in members so we don't have

00:05:33,370 --> 00:05:36,639
to make like 50 calls to the database

00:05:35,020 --> 00:05:41,680
which is actually more efficient in the

00:05:36,639 --> 00:05:43,539
long run so WordPress runs this very

00:05:41,680 --> 00:05:46,720
sequel query on every single page on the

00:05:43,539 --> 00:05:48,490
website what's doing isn't selecting all

00:05:46,720 --> 00:05:52,570
the options and the options table that

00:05:48,490 --> 00:05:54,430
are set to yes or other go and when the

00:05:52,570 --> 00:05:56,710
tables very small or I should say very

00:05:54,430 --> 00:05:57,550
slow but it's a small number of rows on

00:05:56,710 --> 00:05:59,560
the table

00:05:57,550 --> 00:06:01,870
this is very efficient and it's pretty

00:05:59,560 --> 00:06:02,889
fast however we have a lot of routing

00:06:01,870 --> 00:06:05,400
options table

00:06:02,889 --> 00:06:07,229
this can take expert millisecond

00:06:05,400 --> 00:06:09,419
I seem to actually take an extra second

00:06:07,229 --> 00:06:11,400
or so it's actually execute this and it

00:06:09,419 --> 00:06:15,720
can slow down your page load every page

00:06:11,400 --> 00:06:17,610
of your site and the reason that this is

00:06:15,720 --> 00:06:18,720
so slow you would think that like this

00:06:17,610 --> 00:06:20,190
would be something that we should

00:06:18,720 --> 00:06:22,050
actually be able to store a lot of

00:06:20,190 --> 00:06:24,180
options in but the reason for the

00:06:22,050 --> 00:06:25,949
slowness is that WordPress does not have

00:06:24,180 --> 00:06:30,419
index on the envelope column in

00:06:25,949 --> 00:06:33,900
WordPress so little background on

00:06:30,419 --> 00:06:36,540
database indexes database indexes are a

00:06:33,900 --> 00:06:38,789
data structure that allows simple and my

00:06:36,540 --> 00:06:41,580
sequel to quickly look up values in the

00:06:38,789 --> 00:06:43,889
options table or any table really so

00:06:41,580 --> 00:06:45,900
this is another lookup table where you

00:06:43,889 --> 00:06:49,919
could look for the value yes and it

00:06:45,900 --> 00:06:51,810
would know exactly what rows and without

00:06:49,919 --> 00:06:53,430
that index my sequel is basically

00:06:51,810 --> 00:06:55,560
looking at every single row and saying

00:06:53,430 --> 00:06:58,470
are you yes are you yes are you yes and

00:06:55,560 --> 00:07:01,949
that could take a long time there are

00:06:58,470 --> 00:07:04,110
some disadvantages to using an index it

00:07:01,949 --> 00:07:06,870
does slow the insert update and delete

00:07:04,110 --> 00:07:09,419
performance and the reason for that is

00:07:06,870 --> 00:07:12,030
that when you run those commands it has

00:07:09,419 --> 00:07:14,099
to update the index again so let's say

00:07:12,030 --> 00:07:17,630
you're updating a post in the backend or

00:07:14,099 --> 00:07:17,630
actually updating options in the backend

00:07:21,050 --> 00:07:27,360
another disadvantage is that to have

00:07:25,229 --> 00:07:29,039
this index so if you have a hosting

00:07:27,360 --> 00:07:31,099
company that doesn't want you to store a

00:07:29,039 --> 00:07:34,220
lot of data this could be problematic

00:07:31,099 --> 00:07:36,360
but if you have a large options table

00:07:34,220 --> 00:07:37,770
you might want to think about using an

00:07:36,360 --> 00:07:39,479
index because the queries will get

00:07:37,770 --> 00:07:43,590
slower the more options you have in

00:07:39,479 --> 00:07:46,020
there and to illustrate this point this

00:07:43,590 --> 00:07:48,120
is a graph actually that our director of

00:07:46,020 --> 00:07:50,699
systems engineering created a while back

00:07:48,120 --> 00:07:53,490
to illustrate the difference on the

00:07:50,699 --> 00:07:56,130
options table with an index versus not

00:07:53,490 --> 00:07:59,370
having index so the red line here

00:07:56,130 --> 00:08:02,840
represents a query that with that very

00:07:59,370 --> 00:08:08,789
same query that we saw back here so this

00:08:02,840 --> 00:08:10,590
the options table where yes that

00:08:08,789 --> 00:08:12,630
particular query on the table that does

00:08:10,590 --> 00:08:14,219
not have an index versus the blue line

00:08:12,630 --> 00:08:18,510
on the bottom if you can tell there's a

00:08:14,219 --> 00:08:21,090
line down there and that represents a

00:08:18,510 --> 00:08:23,130
query that very same query on a table

00:08:21,090 --> 00:08:25,500
that does have an index and you can see

00:08:23,130 --> 00:08:28,380
as the table size grows the amount of

00:08:25,500 --> 00:08:31,020
time it takes for the pair to execute

00:08:28,380 --> 00:08:33,120
becomes quite substantial there is this

00:08:31,020 --> 00:08:36,089
sweet spot down here where there isn't

00:08:33,120 --> 00:08:37,800
much of a difference between index are

00:08:36,089 --> 00:08:39,630
not having index and that's kind of

00:08:37,800 --> 00:08:43,440
where you want to shoot for for for

00:08:39,630 --> 00:08:44,730
default you know you could have an index

00:08:43,440 --> 00:08:46,680
if you need to the store a million

00:08:44,730 --> 00:08:48,240
records you definitely could but by

00:08:46,680 --> 00:08:50,010
default most people probably don't and

00:08:48,240 --> 00:08:56,579
you know you should be shooting for that

00:08:50,010 --> 00:08:59,550
like thousand five hundred records so

00:08:56,579 --> 00:09:01,790
widens up WordPress including index that

00:08:59,550 --> 00:09:04,640
was a question I was asking myself

00:09:01,790 --> 00:09:06,740
this it turns out there's actually a

00:09:04,640 --> 00:09:08,810
pretty hot discussion about this going

00:09:06,740 --> 00:09:11,090
on the WordPress community there's a

00:09:08,810 --> 00:09:13,940
wordpress core ticket going back over

00:09:11,090 --> 00:09:15,890
like five years or so where developers

00:09:13,940 --> 00:09:18,860
are debating this is quite a lengthy

00:09:15,890 --> 00:09:21,020
conversation but that's the great thing

00:09:18,860 --> 00:09:22,880
about WordPress and open source software

00:09:21,020 --> 00:09:24,710
is that you can be a part of the

00:09:22,880 --> 00:09:28,690
conversation and try to change these

00:09:24,710 --> 00:09:30,980
things that but basically you know that

00:09:28,690 --> 00:09:33,410
summarizes what the conversation is you

00:09:30,980 --> 00:09:35,600
know one reason that people are arguing

00:09:33,410 --> 00:09:37,250
against having an index is that the

00:09:35,600 --> 00:09:40,160
options table was never meant to store

00:09:37,250 --> 00:09:42,170
logic options or a lot of growth in the

00:09:40,160 --> 00:09:43,580
options table so there's really no

00:09:42,170 --> 00:09:46,340
reason to have it if people keep the

00:09:43,580 --> 00:09:47,660
options table small but as we saw with

00:09:46,340 --> 00:09:50,420
the functions that I was using earlier

00:09:47,660 --> 00:09:52,130
those functions are very easy to use and

00:09:50,420 --> 00:09:53,420
so if developers don't really know what

00:09:52,130 --> 00:09:55,550
they're doing and just want to store

00:09:53,420 --> 00:09:58,280
everything that they have in the options

00:09:55,550 --> 00:10:00,320
table they can very easily build up so

00:09:58,280 --> 00:10:01,850
you know that might be a reason for us

00:10:00,320 --> 00:10:04,940
in the future to consider having an

00:10:01,850 --> 00:10:07,670
index on the options table if you do

00:10:04,940 --> 00:10:09,980
have an option that's it's very easy to

00:10:07,670 --> 00:10:10,400
do so you can run a query like the one

00:10:09,980 --> 00:10:13,370
here

00:10:10,400 --> 00:10:16,520
sequel and what you're doing is you say

00:10:13,370 --> 00:10:18,860
create an index give the index of unique

00:10:16,520 --> 00:10:20,570
name and you say what table you want to

00:10:18,860 --> 00:10:23,570
create that impacts on and halves over

00:10:20,570 --> 00:10:27,110
the columns that you want to have that

00:10:23,570 --> 00:10:29,440
index index and once you run that it's

00:10:27,110 --> 00:10:35,020
pretty quick and there's really

00:10:29,440 --> 00:10:36,490
cheated so going back to the original

00:10:35,020 --> 00:10:38,290
story I was telling you know there were

00:10:36,490 --> 00:10:41,890
some other things going on besides that

00:10:38,290 --> 00:10:43,660
large that that plug-in that pulled over

00:10:41,890 --> 00:10:46,480
from Google search console there was

00:10:43,660 --> 00:10:49,780
another bad plug-in I would say that but

00:10:46,480 --> 00:10:51,310
a plug-in that had a bug that in the

00:10:49,780 --> 00:10:54,430
filling the options table with over

00:10:51,310 --> 00:10:56,680
5,000 rows and what I was doing was it

00:10:54,430 --> 00:10:59,140
was performing a sink and so every

00:10:56,680 --> 00:11:00,850
minute that the that the plugin was

00:10:59,140 --> 00:11:03,280
performing a sink it would add a row

00:11:00,850 --> 00:11:04,780
it's the office table and you know that

00:11:03,280 --> 00:11:07,180
sinks might run for a couple minutes at

00:11:04,780 --> 00:11:09,430
a time but after many weeks after many

00:11:07,180 --> 00:11:11,770
months or years the office table got

00:11:09,430 --> 00:11:13,810
filled up and there was just a buckin

00:11:11,770 --> 00:11:16,930
the plugin that let those live on and

00:11:13,810 --> 00:11:18,400
they clean them up later as I was

00:11:16,930 --> 00:11:19,750
talking about earlier with like the

00:11:18,400 --> 00:11:21,610
sweet spot where you should be shooting

00:11:19,750 --> 00:11:23,050
for when the options table you should

00:11:21,610 --> 00:11:24,760
try to make sure that you have less than

00:11:23,050 --> 00:11:29,200
five hundred rows and the options table

00:11:24,760 --> 00:11:30,970
for performance you know the only way

00:11:29,200 --> 00:11:32,260
that you can do that is to make sure

00:11:30,970 --> 00:11:34,060
that you're regularly checking the

00:11:32,260 --> 00:11:36,280
options table it's you know something

00:11:34,060 --> 00:11:37,690
that probably you don't really think of

00:11:36,280 --> 00:11:38,980
having to check because it's something

00:11:37,690 --> 00:11:40,690
that's actually very difficult to check

00:11:38,980 --> 00:11:43,320
unless you're familiar with sequel or

00:11:40,690 --> 00:11:43,320
some other tools

00:11:46,500 --> 00:11:50,610
this is just an example of what an

00:11:49,230 --> 00:11:53,580
options table looks like when it's

00:11:50,610 --> 00:11:58,080
filled up in this particular example the

00:11:53,580 --> 00:12:00,420
plug-in WP SEO which is us it decided to

00:11:58,080 --> 00:12:02,430
add in the Cache Valley the record which

00:12:00,420 --> 00:12:04,080
it uses internally I assume for

00:12:02,430 --> 00:12:06,030
something I didn't actually look up to

00:12:04,080 --> 00:12:07,650
see but it uses the score but it

00:12:06,030 --> 00:12:09,660
basically it's just a temporary record

00:12:07,650 --> 00:12:12,690
that's adding the office table and this

00:12:09,660 --> 00:12:14,220
is a very common issue that you see it's

00:12:12,690 --> 00:12:16,500
basically just a bug in there plug-in

00:12:14,220 --> 00:12:23,970
that fellow you have to pick some day or

00:12:16,500 --> 00:12:27,210
people they already have fixed it so I

00:12:23,970 --> 00:12:29,910
figured out what's going on so to fix it

00:12:27,210 --> 00:12:31,470
these are the steps I took to do so the

00:12:29,910 --> 00:12:34,020
first thing I did is I ran a sequel

00:12:31,470 --> 00:12:36,720
query to delete all those extra rows so

00:12:34,020 --> 00:12:38,730
in this sequel query it deletes all the

00:12:36,720 --> 00:12:39,700
rows from the options table that start

00:12:38,730 --> 00:12:42,880
with

00:12:39,700 --> 00:12:43,870
you sitemap so all those 5,000 rows I

00:12:42,880 --> 00:12:45,850
got pulled over

00:12:43,870 --> 00:12:48,730
I got cleaned up in a definitely held

00:12:45,850 --> 00:12:51,040
performance I also ran another simple

00:12:48,730 --> 00:12:54,340
query this one updates

00:12:51,040 --> 00:12:56,530
specific options to not alowed so I

00:12:54,340 --> 00:12:59,230
figured out you know name that big

00:12:56,530 --> 00:13:02,500
option that I store that sort of sorts

00:12:59,230 --> 00:13:04,600
of other X million times does need to be

00:13:02,500 --> 00:13:06,160
on every page so I made sure to run up

00:13:04,600 --> 00:13:08,980
datum and to make sure that wasn't

00:13:06,160 --> 00:13:12,220
loading another page and that definitely

00:13:08,980 --> 00:13:15,880
helped performance I went into the

00:13:12,220 --> 00:13:18,070
themes and I updated the options are

00:13:15,880 --> 00:13:21,820
happy with the functions that updated

00:13:18,070 --> 00:13:23,380
options and added options to specify

00:13:21,820 --> 00:13:26,170
whether or not I wanted the option to

00:13:23,380 --> 00:13:28,120
load for the most part most the options

00:13:26,170 --> 00:13:33,430
did not need to load so I just passed a

00:13:28,120 --> 00:13:36,220
note and then these for some pretty easy

00:13:33,430 --> 00:13:38,590
fixes I made to the plug-in that seemed

00:13:36,220 --> 00:13:40,150
to a Google search console talks to the

00:13:38,590 --> 00:13:41,890
client and they actually didn't need to

00:13:40,150 --> 00:13:43,930
have all the Google search consoles data

00:13:41,890 --> 00:13:45,430
in progress they could just both Google

00:13:43,930 --> 00:13:48,900
search console and go through it so we

00:13:45,430 --> 00:13:51,040
turned that that sync off which was a

00:13:48,900 --> 00:13:53,020
and also it took the opportunity to

00:13:51,040 --> 00:13:54,700
clean up any unnecessary plugins on the

00:13:53,020 --> 00:13:56,890
site there were some things that were

00:13:54,700 --> 00:13:59,440
just adding some options that were huge

00:13:56,890 --> 00:14:00,460
but you know you have 1020 plugins that

00:13:59,440 --> 00:14:03,550
aren't being used and they're each

00:14:00,460 --> 00:14:06,040
adding 20 options that can add up over

00:14:03,550 --> 00:14:10,090
time so I just install things that were

00:14:06,040 --> 00:14:12,730
needed so I talked a little bit about

00:14:10,090 --> 00:14:13,570
the tools you can use or actually

00:14:12,730 --> 00:14:15,850
definitely

00:14:13,570 --> 00:14:18,610
all right I lose it to the facts I'm

00:14:15,850 --> 00:14:21,610
gonna talk about one of the tools I

00:14:18,610 --> 00:14:23,550
highly recommend is you relic so what

00:14:21,610 --> 00:14:26,230
new relic is is it's a service that

00:14:23,550 --> 00:14:29,740
shows you specific performance on your

00:14:26,230 --> 00:14:32,529
site so in this graph here you can see

00:14:29,740 --> 00:14:34,779
that this is the performance of a

00:14:32,529 --> 00:14:38,319
specific page or maybe the website in

00:14:34,779 --> 00:14:41,290
general over a period of time and it

00:14:38,319 --> 00:14:43,000
shows that the performance is this and

00:14:41,290 --> 00:14:45,819
you can kind of just see like weirdest

00:14:43,000 --> 00:14:47,290
illnesses in this particular graph you

00:14:45,819 --> 00:14:49,000
know the slowness is in my sequel query

00:14:47,290 --> 00:14:50,860
so if I was going to kind of optimize

00:14:49,000 --> 00:14:52,560
the site that's probably where I'd try

00:14:50,860 --> 00:14:55,810
to spend most of my time

00:14:52,560 --> 00:14:57,880
but numeric is awesome it also shows you

00:14:55,810 --> 00:15:00,339
reports like this one here which I'll be

00:14:57,880 --> 00:15:02,949
drilling to specific like repress hooks

00:15:00,339 --> 00:15:06,970
and functions you know I was trying to

00:15:02,949 --> 00:15:09,279
figure out for this particular page why

00:15:06,970 --> 00:15:14,230
it's bonded 46 seconds for the page to

00:15:09,279 --> 00:15:16,420
load which is pretty slow page and this

00:15:14,230 --> 00:15:20,620
this particular page was the admin Ajax

00:15:16,420 --> 00:15:22,149
up you can drill into like the do action

00:15:20,620 --> 00:15:24,550
so you can see it was actually an action

00:15:22,149 --> 00:15:26,529
that was being slow and look at the

00:15:24,550 --> 00:15:29,790
first one curry initial post types I'm

00:15:26,529 --> 00:15:33,310
not sure that was actually pretty slow

00:15:29,790 --> 00:15:35,709
that's actually a pretty fast process or

00:15:33,310 --> 00:15:37,149
function that ran three milliseconds you

00:15:35,709 --> 00:15:38,769
can just go through and look at the time

00:15:37,149 --> 00:15:43,029
it's over there was this one down here

00:15:38,769 --> 00:15:44,649
that was four capabilities ad caps 746

00:15:43,029 --> 00:15:46,839
seconds for some reason and you know

00:15:44,649 --> 00:15:47,810
that gives me the information to dig

00:15:46,839 --> 00:15:51,050
into the PHP

00:15:47,810 --> 00:15:52,399
figure out why that's slow this example

00:15:51,050 --> 00:15:55,370
doesn't have anything to do the options

00:15:52,399 --> 00:15:58,370
table but if the options table was being

00:15:55,370 --> 00:16:00,740
slow I could basically drill into the

00:15:58,370 --> 00:16:02,540
performance likewise and be able to see

00:16:00,740 --> 00:16:06,559
exactly how slow that was be able to

00:16:02,540 --> 00:16:09,649
tweak things as needed another tool that

00:16:06,559 --> 00:16:11,420
I highly recommend using is WP CLI which

00:16:09,649 --> 00:16:13,939
is command line tool which lets you

00:16:11,420 --> 00:16:17,629
execute repressed commands via your

00:16:13,939 --> 00:16:19,790
command line this particular commands

00:16:17,629 --> 00:16:21,829
here lets you see all the options and

00:16:19,790 --> 00:16:40,749
the options table and also let you see

00:16:21,829 --> 00:16:43,220
the size and bytes of each option so

00:16:40,749 --> 00:16:45,499
this returns like all the options the

00:16:43,220 --> 00:16:48,980
options table this is a number of bytes

00:16:45,499 --> 00:16:50,990
that are on each option and you can see

00:16:48,980 --> 00:16:55,009
that everything is pretty small like

00:16:50,990 --> 00:16:57,470
this is like you know kilobyte kilobytes

00:16:55,009 --> 00:16:59,180
so there's really not a lot here to

00:16:57,470 --> 00:17:02,300
worry about there's probably like a

00:16:59,180 --> 00:17:04,549
hundred options or so here so it's a

00:17:02,300 --> 00:17:06,439
pretty you know small options table if I

00:17:04,549 --> 00:17:07,450
ran this on another site that was having

00:17:06,439 --> 00:17:10,589
issues

00:17:07,450 --> 00:17:10,589
[Music]

00:17:12,159 --> 00:17:17,149
so this one you can see the numbers are

00:17:14,480 --> 00:17:18,110
much larger so this options table is

00:17:17,149 --> 00:17:21,019
full

00:17:18,110 --> 00:17:23,179
there's WP SEO is pretty problematic

00:17:21,019 --> 00:17:24,799
it's like I would say problematic but

00:17:23,179 --> 00:17:28,519
having a lot of options the options

00:17:24,799 --> 00:17:30,230
table you know the overall number isn't

00:17:28,519 --> 00:17:31,850
that different in this one as well

00:17:30,230 --> 00:17:34,580
there's like 100 rows and the options

00:17:31,850 --> 00:17:36,500
table but this size is well I'm

00:17:34,580 --> 00:17:38,360
concerned about here and so this just

00:17:36,500 --> 00:17:40,250
lets you check in and see what plugins

00:17:38,360 --> 00:17:46,789
or how plugins are filling your options

00:17:40,250 --> 00:17:49,760
table another another tool you can use

00:17:46,789 --> 00:17:51,789
is just using sequel or my sequel if you

00:17:49,760 --> 00:17:53,929
have access to run sequel commands

00:17:51,789 --> 00:18:00,399
basically run a command like the one

00:17:53,929 --> 00:18:02,960
here and this tells me all the options

00:18:00,399 --> 00:18:23,630
so if you remember I told you you should

00:18:02,960 --> 00:18:26,990
have your that's problematic especially

00:18:23,630 --> 00:18:29,260
if I was using a caching plugin because

00:18:26,990 --> 00:18:33,350
that wouldn't be refreshing on the page

00:18:29,260 --> 00:18:36,110
likewise if I had if I had a site that

00:18:33,350 --> 00:18:37,970
wasn't doing well so I just switched to

00:18:36,110 --> 00:18:39,649
like a different different database and

00:18:37,970 --> 00:18:41,990
so this one is actually more around what

00:18:39,649 --> 00:18:43,330
you should be seeing this is a fresh

00:18:41,990 --> 00:18:46,649
word presence

00:18:43,330 --> 00:18:46,649
while you sing at best moment

00:18:50,180 --> 00:18:55,860
okay so it's to summarize what I've been

00:18:53,730 --> 00:18:57,810
talking about today you know the best

00:18:55,860 --> 00:18:59,370
practice is to make sure that your

00:18:57,810 --> 00:19:02,220
options tables less than one megabyte

00:18:59,370 --> 00:19:04,680
size always make sure that you're you

00:19:02,220 --> 00:19:08,040
know monitoring your website to make

00:19:04,680 --> 00:19:10,560
sure that's less than a megabyte be sure

00:19:08,040 --> 00:19:12,180
to check the functions of your PHP code

00:19:10,560 --> 00:19:14,370
it's a specifying whether or not the

00:19:12,180 --> 00:19:15,510
options should be unloaded that's

00:19:14,370 --> 00:19:17,130
something that's instantly missed

00:19:15,510 --> 00:19:19,890
especially if you don't understand what

00:19:17,130 --> 00:19:22,370
the public Wrangler does keeps number of

00:19:19,890 --> 00:19:24,630
rows you have to stable less than 500

00:19:22,370 --> 00:19:26,370
you know you can't go a bit above that

00:19:24,630 --> 00:19:32,570
if you need to but you know performance

00:19:26,370 --> 00:19:34,830
is degraded especially if you have small

00:19:32,570 --> 00:19:36,660
and if you need to have a lot of roads

00:19:34,830 --> 00:19:41,000
you definitely can store a lot of data

00:19:36,660 --> 00:19:41,000
made off to stable TV - but you just

00:19:42,350 --> 00:19:47,580
yeah I can also insert any more specific

00:19:45,930 --> 00:19:50,040
questions anyone has about like how to

00:19:47,580 --> 00:19:53,270
store data there's a lot to talk about

00:19:50,040 --> 00:19:53,270
here and I just want to make sure

00:20:13,580 --> 00:20:19,670
you know one thing I did not touch on

00:20:15,650 --> 00:20:21,530
but I think that the whole time it's so

00:20:19,670 --> 00:20:23,420
you know but if you didn't want to store

00:20:21,530 --> 00:20:24,650
a lot of data somewhere like obviously

00:20:23,420 --> 00:20:27,679
the options table isn't where you want

00:20:24,650 --> 00:20:29,420
to store everything for your plugin you

00:20:27,679 --> 00:20:31,100
know I would recommend to actually

00:20:29,420 --> 00:20:32,990
create a custom post type that is

00:20:31,100 --> 00:20:35,150
private and that nobody can that receive

00:20:32,990 --> 00:20:38,540
and just use stats to store all the data

00:20:35,150 --> 00:20:40,100
and so that adds your your your data

00:20:38,540 --> 00:20:42,710
that you need to add your plugin into

00:20:40,100 --> 00:20:45,290
the table and the books table has

00:20:42,710 --> 00:20:47,390
indexes that are very efficient it works

00:20:45,290 --> 00:20:52,130
very well and you can keep millions of

00:20:47,390 --> 00:20:54,559
records in there that's you know a

00:20:52,130 --> 00:20:57,200
natural progression from the options

00:20:54,559 --> 00:21:00,679
table also the office table stores

00:20:57,200 --> 00:21:02,600
transients so transients is like

00:21:00,679 --> 00:21:03,920
WordPress is way of bashing if you don't

00:21:02,600 --> 00:21:05,390
have a plug-in setup

00:21:03,920 --> 00:21:07,370
it's worse things in the options table

00:21:05,390 --> 00:21:12,670
and that can also fill the options table

00:21:07,370 --> 00:21:12,670
up and so having object batching

00:21:14,420 --> 00:21:24,450
any questions sir could you write like a

00:21:21,390 --> 00:21:25,800
small plug in to like monitor the size

00:21:24,450 --> 00:21:27,720
of the options table and then just like

00:21:25,800 --> 00:21:30,060
report to you and it hits 500 rows or

00:21:27,720 --> 00:21:32,730
like one day that some people actually

00:21:30,060 --> 00:21:34,860
happen to go to fight you or or just

00:21:32,730 --> 00:21:36,870
don't have it notify you when it hits

00:21:34,860 --> 00:21:38,730
like 500 or something yeah yeah I think

00:21:36,870 --> 00:21:39,930
it definitely couldn't be done I know

00:21:38,730 --> 00:21:41,820
that there are some plugins out there

00:21:39,930 --> 00:21:44,370
that people created to basically look at

00:21:41,820 --> 00:21:50,490
the same thing so maybe plugins already

00:21:44,370 --> 00:21:52,170
do this close they themselves right let

00:21:50,490 --> 00:21:53,760
me let me just make one thing clear like

00:21:52,170 --> 00:21:55,950
it's not bad it's a storm thanks to the

00:21:53,760 --> 00:21:57,810
option staple just excessive amounts of

00:21:55,950 --> 00:22:00,570
things you can say bleh maybe it's not

00:21:57,810 --> 00:22:03,390
racist or a record of everybody that

00:22:00,570 --> 00:22:05,160
logged in over the past year but it

00:22:03,390 --> 00:22:07,059
might be the right place to store like

00:22:05,160 --> 00:22:08,870
the setting this

00:22:07,059 --> 00:22:12,110
whether they want to be able to

00:22:08,870 --> 00:22:16,279
background or read backgrounds and you

00:22:12,110 --> 00:22:19,730
said the better option is to put your

00:22:16,279 --> 00:22:21,620
data into the WP post that's one

00:22:19,730 --> 00:22:23,149
recommendation yeah so if you have a

00:22:21,620 --> 00:22:25,070
custom you can create custom folks take

00:22:23,149 --> 00:22:28,190
some WordPress and those can be private

00:22:25,070 --> 00:22:34,519
and not accessible and you can basically

00:22:28,190 --> 00:22:36,230
set up a recommendation but it all

00:22:34,519 --> 00:22:38,600
depends some people decide to make

00:22:36,230 --> 00:22:41,990
custom tables I've never run into a

00:22:38,600 --> 00:22:45,019
situation where I need to but it all

00:22:41,990 --> 00:22:49,159
depends on what you buy not a custom

00:22:45,019 --> 00:22:50,929
table figure out yeah so a lot of the

00:22:49,159 --> 00:22:53,509
WordPress functions work really well

00:22:50,929 --> 00:22:55,970
with the posts so like there's a lot of

00:22:53,509 --> 00:22:57,769
WordPress functions then based on assume

00:22:55,970 --> 00:22:59,960
you're using the post table and so you

00:22:57,769 --> 00:23:01,850
can pass over the post type and you can

00:22:59,960 --> 00:23:04,840
reuse all of those if you have their own

00:23:01,850 --> 00:23:04,840
table you got two

00:23:08,399 --> 00:23:11,940
he's certainly good I know a lot of

00:23:09,960 --> 00:23:14,669
plugins to do that

00:23:11,940 --> 00:23:18,899
I think gravity forms has a lot of

00:23:14,669 --> 00:23:20,340
tables I think it all depends on how

00:23:18,899 --> 00:23:23,129
much data you want to store - I know

00:23:20,340 --> 00:23:24,989
that gravity forms actually blogs every

00:23:23,129 --> 00:23:35,909
single view of form which blows things

00:23:24,989 --> 00:23:38,669
up probably thank you there's a plugin

00:23:35,909 --> 00:23:40,169
called WPC mm I think that sort of saves

00:23:38,669 --> 00:23:41,669
you're off trend is allowed to it load

00:23:40,169 --> 00:23:44,820
every both on your community with that

00:23:41,669 --> 00:23:46,559
does it collide okay what's that it's a

00:23:44,820 --> 00:23:48,539
way of saving complete configuration of

00:23:46,559 --> 00:23:50,609
a website so you can blow it out your

00:23:48,539 --> 00:24:00,029
plugins are just low and all the other

00:23:50,609 --> 00:24:01,529
ones oh yeah that's interesting yeah I

00:24:00,029 --> 00:24:03,869
think the options table is one area

00:24:01,529 --> 00:24:05,549
where you know it's often overlooked for

00:24:03,869 --> 00:24:07,139
improvements but as you can see like

00:24:05,549 --> 00:24:09,570
these queries are brought every single

00:24:07,139 --> 00:24:14,009
page so it's definitely an area that

00:24:09,570 --> 00:24:15,720
were question looking - I haven't

00:24:14,009 --> 00:24:17,759
actually comment on that thread yet but

00:24:15,720 --> 00:24:19,739
I'm kind of inspired to actually put my

00:24:17,759 --> 00:24:21,899
two cents in there because I've had this

00:24:19,739 --> 00:24:25,009
talk it was talked before word and the

00:24:21,899 --> 00:24:25,009
more I talk about it the more

00:24:29,470 --> 00:24:33,700
those people are just gonna try to have

00:24:31,080 --> 00:24:36,669
incredible yeah it is it really that

00:24:33,700 --> 00:24:39,669
simple to make up index which you both

00:24:36,669 --> 00:24:47,620
end up online yeah so I can execute it

00:24:39,669 --> 00:25:01,419
and just prove that it works so if I go

00:24:47,620 --> 00:25:02,769
into so this is basically now has an

00:25:01,419 --> 00:25:05,159
indexing options table if I go to

00:25:02,769 --> 00:25:05,159
options

00:25:19,560 --> 00:25:24,450
there is a place they're gonna create

00:25:21,750 --> 00:25:28,290
syntax what's that it's there in the

00:25:24,450 --> 00:25:30,530
create table statement Oh down here okay

00:25:28,290 --> 00:25:30,530
there we go

00:25:39,210 --> 00:25:45,180
so yeah it's you know but it does have

00:25:42,690 --> 00:25:47,310
some performance downsides as I was

00:25:45,180 --> 00:25:49,980
pointing out but you know if you have

00:25:47,310 --> 00:25:51,960
people using the they might be a little

00:25:49,980 --> 00:25:53,580
more patient you know they can say stop

00:25:51,960 --> 00:26:05,430
I get that next four five seconds it's

00:25:53,580 --> 00:26:07,350
more like milliseconds yeah yeah exactly

00:26:05,430 --> 00:26:10,530
let me post sector one in Texas that's

00:26:07,350 --> 00:26:13,080
updating over time so you know sometimes

00:26:10,530 --> 00:26:14,670
people find that the options maybe the

00:26:13,080 --> 00:26:23,310
post table can be slow for certain

00:26:14,670 --> 00:26:25,170
queries in this is the next help it

00:26:23,310 --> 00:26:31,560
helps us significantly right you have

00:26:25,170 --> 00:26:33,930
the two graphs yeah yeah it's just great

00:26:31,560 --> 00:26:36,360
surprise that my mind it out of indexes

00:26:33,930 --> 00:26:38,550
and if your charters doing totally

00:26:36,360 --> 00:26:41,490
different yep I mean there's a lot more

00:26:38,550 --> 00:26:43,830
stuff going on behind the scenes so you

00:26:41,490 --> 00:26:45,900
know this could be detrimental to a site

00:26:43,830 --> 00:26:48,960
if you have you know a million rows in

00:26:45,900 --> 00:26:51,740
your table and you don't have much dis

00:26:48,960 --> 00:26:53,529
storage or whatever reason

00:26:51,740 --> 00:26:57,710
the same company or something like that

00:26:53,529 --> 00:27:00,700
you might not have yeah it's pretty easy

00:26:57,710 --> 00:27:05,570
that this is built into most database

00:27:00,700 --> 00:27:08,049
single databases so this isn't just on

00:27:05,570 --> 00:27:08,049

YouTube URL: https://www.youtube.com/watch?v=g8-9mUgJblo


