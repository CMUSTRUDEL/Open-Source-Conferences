Title: David Greenwald: How to Clean the WordPress Database
Publication date: 2020-04-08
Playlist: WordCamp Seattle 2018
Description: 
	Is your website running slowly? If you’ve had a WordPress site for a few years, it could be the MySQL database—the silent killer of WordPress performance. The database can be the biggest drain on WordPress speed and stability but for many of us, it’s the most intimidating part to address, which can leave sites bloated, expensive, and ready to crash under high traffic.
But it’s actually not that scary. Using WordPress plugins and phpMyAdmin, we’ll build the skills to diagnose database issues, go over some common problems and a few weird edge cases from abandoned plugin data to blog imports gone wrong, and learn how to safely fix and maintain the database for top performance.

Presentation slides: https://drive.google.com/file/d/0B9ly5Ai4pWfgZjQ3RnRWVWF3TENOajVVak5LWVdRSFk0Tjdr/view?usp=sharing
WPTV link: https://wordpress.tv/2019/12/19/david-greenwald-how-to-clean-the-wordpress-database/
Captions: 
	00:00:02,720 --> 00:00:08,240
david greenwald

00:00:04,560 --> 00:00:09,440
how to clean the wordpress database

00:00:08,240 --> 00:00:11,120
david greenwald used to be a

00:00:09,440 --> 00:00:12,559
professional music critic and has

00:00:11,120 --> 00:00:15,679
interviewed radiohead

00:00:12,559 --> 00:00:17,920
eric brooks and finney center now i'm

00:00:15,679 --> 00:00:19,840
super excited about making wordpress run

00:00:17,920 --> 00:00:22,560
tens of milliseconds faster

00:00:19,840 --> 00:00:24,000
and keeping websites about 50 cent from

00:00:22,560 --> 00:00:26,240
crashing

00:00:24,000 --> 00:00:28,400
he's a freelance wordpress developer and

00:00:26,240 --> 00:00:31,840
performance engineer in fort lauderdale

00:00:28,400 --> 00:00:31,840
thank you let's get around

00:00:32,570 --> 00:00:37,760
[Applause]

00:00:34,719 --> 00:00:39,920
everybody hear me okay okay

00:00:37,760 --> 00:00:41,600
great uh thanks for coming this is how

00:00:39,920 --> 00:00:43,200
to clean up wordpress database

00:00:41,600 --> 00:00:45,440
i'm gonna run this on my phone with

00:00:43,200 --> 00:00:50,640
magic i'm not checking my twitter

00:00:45,440 --> 00:00:50,640
don't worry okay too far

00:00:50,960 --> 00:00:56,399
okay so i'm david greenwald like you

00:00:54,079 --> 00:00:57,239
said i'm from portland oregon

00:00:56,399 --> 00:00:59,520
you can check me out at

00:00:57,239 --> 00:01:00,719
davidgreenwall.com or on github you're

00:00:59,520 --> 00:01:02,239
actually going to want to

00:01:00,719 --> 00:01:04,320
go take a look at that because i have

00:01:02,239 --> 00:01:05,760
some uh code examples that you can take

00:01:04,320 --> 00:01:06,960
home it's a cheat sheet of

00:01:05,760 --> 00:01:08,880
things you can bring home to your

00:01:06,960 --> 00:01:11,760
database and run your own

00:01:08,880 --> 00:01:12,720
detective work so here is a link to that

00:01:11,760 --> 00:01:14,960
actually

00:01:12,720 --> 00:01:16,320
if you want to check that out and we're

00:01:14,960 --> 00:01:17,280
going to run through some examples but

00:01:16,320 --> 00:01:20,240
this is a full

00:01:17,280 --> 00:01:23,439
list so there's that link these slides

00:01:20,240 --> 00:01:23,439
will be up online as well

00:01:24,080 --> 00:01:27,360
so this is passionate device this is a

00:01:26,240 --> 00:01:29,840
music blog

00:01:27,360 --> 00:01:30,560
run by my friend jeff down in l.a um

00:01:29,840 --> 00:01:32,159
this is a

00:01:30,560 --> 00:01:33,920
great site he's been doing it for many

00:01:32,159 --> 00:01:36,560
years has a lot of readers

00:01:33,920 --> 00:01:38,400
i think he gets about 100 000 unique

00:01:36,560 --> 00:01:40,880
visitors per month something like that

00:01:38,400 --> 00:01:41,520
so pretty good traffic uh not quite

00:01:40,880 --> 00:01:43,680
enough to

00:01:41,520 --> 00:01:45,119
break the internet this was originally a

00:01:43,680 --> 00:01:46,320
kim kardashian photo which we took out

00:01:45,119 --> 00:01:49,600
for copyright reasons

00:01:46,320 --> 00:01:51,200
so just have to imagine um but so

00:01:49,600 --> 00:01:52,960
with you know a few thousand visitors a

00:01:51,200 --> 00:01:54,240
day most websites should be able to

00:01:52,960 --> 00:01:56,399
handle that jeff should not have been

00:01:54,240 --> 00:01:58,640
having any problems with this site

00:01:56,399 --> 00:01:59,439
instead his site was crashing almost

00:01:58,640 --> 00:02:01,600
every day

00:01:59,439 --> 00:02:03,280
and this went on for years this was a

00:02:01,600 --> 00:02:04,479
constant problem

00:02:03,280 --> 00:02:06,880
so here's some of the things that he

00:02:04,479 --> 00:02:08,640
tried to do

00:02:06,880 --> 00:02:11,680
he switched from his cheap shared host

00:02:08,640 --> 00:02:14,239
to a faster vpn server

00:02:11,680 --> 00:02:14,239
not great

00:02:14,879 --> 00:02:19,120
he thought he was being hacked so he set

00:02:16,720 --> 00:02:21,360
up cloudflare instead of ddos protection

00:02:19,120 --> 00:02:24,319
all that good stuff

00:02:21,360 --> 00:02:24,319
not super helpful

00:02:24,640 --> 00:02:28,480
and he finally thought oh maybe it's the

00:02:26,480 --> 00:02:29,920
database i don't know what that is i'm a

00:02:28,480 --> 00:02:30,879
music blogger but let's see if i can

00:02:29,920 --> 00:02:33,680
deal with that

00:02:30,879 --> 00:02:34,160
and so he set up the wp optimized plugin

00:02:33,680 --> 00:02:36,879
and

00:02:34,160 --> 00:02:38,080
tried to clean his database and this

00:02:36,879 --> 00:02:40,160
continued to not get

00:02:38,080 --> 00:02:41,519
great results so eventually i got in

00:02:40,160 --> 00:02:43,280
touch with jeff and took a look at it

00:02:41,519 --> 00:02:45,599
and we found it was the database

00:02:43,280 --> 00:02:46,640
and the issue was his database was full

00:02:45,599 --> 00:02:49,680
of trash

00:02:46,640 --> 00:02:51,840
it was full of junk all left over from a

00:02:49,680 --> 00:02:53,760
facebook share counter plugin that he

00:02:51,840 --> 00:02:55,599
deleted in like 2013

00:02:53,760 --> 00:02:57,120
and it had just left all of its stuff

00:02:55,599 --> 00:03:00,480
behind in his database

00:02:57,120 --> 00:03:02,400
for years so

00:03:00,480 --> 00:03:04,720
here's before i cleaned it up had about

00:03:02,400 --> 00:03:06,400
252 megabytes of stuff sitting in the

00:03:04,720 --> 00:03:08,400
options table of this database

00:03:06,400 --> 00:03:10,000
and we'll talk about what that is uh

00:03:08,400 --> 00:03:12,800
after two megabytes

00:03:10,000 --> 00:03:15,840
so that's a lot better obviously and

00:03:12,800 --> 00:03:15,840
here's why this matters

00:03:15,920 --> 00:03:19,440
so the options table saves all the

00:03:18,000 --> 00:03:20,560
settings for your wordpress site for

00:03:19,440 --> 00:03:24,080
your plugins and for

00:03:20,560 --> 00:03:26,159
wordpress core as well and so if you uh

00:03:24,080 --> 00:03:28,000
part of that are things that auto load

00:03:26,159 --> 00:03:28,400
they load automatically with every page

00:03:28,000 --> 00:03:29,840
view

00:03:28,400 --> 00:03:31,440
so that anyone coming to your site gets

00:03:29,840 --> 00:03:32,879
all the right settings some things only

00:03:31,440 --> 00:03:33,280
load conditionally when they're needed

00:03:32,879 --> 00:03:35,040
to

00:03:33,280 --> 00:03:36,319
but a lot of stuff that's in this table

00:03:35,040 --> 00:03:37,840
is automatically running

00:03:36,319 --> 00:03:39,519
so every time someone is coming to a

00:03:37,840 --> 00:03:42,720
page of jeff's site they're getting all

00:03:39,519 --> 00:03:44,560
this data that's 252 megabytes of data

00:03:42,720 --> 00:03:46,720
so what would happen was he was tweet a

00:03:44,560 --> 00:03:48,319
link to his site five people would look

00:03:46,720 --> 00:03:50,000
at it and it would overload his server

00:03:48,319 --> 00:03:51,519
which had one gigabyte of ram

00:03:50,000 --> 00:03:53,280
so that's not really the position that

00:03:51,519 --> 00:03:56,400
you want to be in where you can't have

00:03:53,280 --> 00:03:58,000
six people on your website

00:03:56,400 --> 00:03:59,840
so what we can learn from jeff's story

00:03:58,000 --> 00:04:01,120
is that database problems are sneaky

00:03:59,840 --> 00:04:02,159
they're not the first thing that people

00:04:01,120 --> 00:04:04,159
are looking for

00:04:02,159 --> 00:04:05,519
uh they're expensive you're probably

00:04:04,159 --> 00:04:07,200
going to upgrade your server

00:04:05,519 --> 00:04:09,519
your hosting because you think that's

00:04:07,200 --> 00:04:11,120
the real problem which it cannot be

00:04:09,519 --> 00:04:12,640
and it's bad for business and traffic

00:04:11,120 --> 00:04:14,560
because if your site is crashing

00:04:12,640 --> 00:04:15,840
if it's slow these are things that hurt

00:04:14,560 --> 00:04:18,560
you in google results

00:04:15,840 --> 00:04:20,079
and they hurt you with your customers so

00:04:18,560 --> 00:04:21,600
this is a problem that you can solve for

00:04:20,079 --> 00:04:23,040
your clients it's going to be a big win

00:04:21,600 --> 00:04:26,479
for them financially

00:04:23,040 --> 00:04:26,479
and for you financially

00:04:26,720 --> 00:04:30,240
so what is the wordpress database raise

00:04:28,880 --> 00:04:31,919
your hand if you think you sort of know

00:04:30,240 --> 00:04:33,360
what it does

00:04:31,919 --> 00:04:35,919
that's great that's awesome that was

00:04:33,360 --> 00:04:37,600
better than the portland top last week

00:04:35,919 --> 00:04:40,080
so all your wordpress content lives in

00:04:37,600 --> 00:04:40,639
the database uh basically what happens

00:04:40,080 --> 00:04:42,479
is

00:04:40,639 --> 00:04:43,919
someone comes to your website there was

00:04:42,479 --> 00:04:46,240
a great discussion of this in

00:04:43,919 --> 00:04:48,479
uh zach's caching yesterday he caught

00:04:46,240 --> 00:04:49,919
that but somebody comes to your website

00:04:48,479 --> 00:04:51,520
and wordpress goes and talks to the

00:04:49,919 --> 00:04:52,880
database and says i need the information

00:04:51,520 --> 00:04:55,360
that goes on this

00:04:52,880 --> 00:04:57,280
blog post the database says here you go

00:04:55,360 --> 00:04:58,479
wordpress feeds that into your theme and

00:04:57,280 --> 00:05:01,440
then it makes a

00:04:58,479 --> 00:05:04,639
html page to serve out to your visitor

00:05:01,440 --> 00:05:04,639
so it basically looks like this

00:05:06,800 --> 00:05:10,000
the dot is wordpress the pig is minus 2l

00:05:09,680 --> 00:05:12,080
and that

00:05:10,000 --> 00:05:14,000
tennis ball is your blog post so we need

00:05:12,080 --> 00:05:14,720
the dog to get the tennis ball to bring

00:05:14,000 --> 00:05:18,080
it back to you

00:05:14,720 --> 00:05:21,039
the visitor to this website

00:05:18,080 --> 00:05:22,160
so database queries which is a search

00:05:21,039 --> 00:05:24,320
for this information

00:05:22,160 --> 00:05:26,240
they take time and then they use data

00:05:24,320 --> 00:05:29,280
which fills up your ram because of your

00:05:26,240 --> 00:05:30,880
uh your server's uh memory

00:05:29,280 --> 00:05:32,720
so we want to really optimize both of

00:05:30,880 --> 00:05:34,639
these we want things to run fast

00:05:32,720 --> 00:05:36,560
we want them to use as little data as

00:05:34,639 --> 00:05:38,080
possible so we can have

00:05:36,560 --> 00:05:41,199
lots of people come to our site and not

00:05:38,080 --> 00:05:41,199
crash when six people come

00:05:41,440 --> 00:05:45,199
so what is a database just to scale out

00:05:44,320 --> 00:05:47,440
a little bit

00:05:45,199 --> 00:05:48,560
um a database every wordpress website

00:05:47,440 --> 00:05:52,400
has a database

00:05:48,560 --> 00:05:54,800
uh they organize their data in tables

00:05:52,400 --> 00:05:56,240
and those tables are basically you can

00:05:54,800 --> 00:05:58,479
think of it as a spreadsheet

00:05:56,240 --> 00:05:59,360
it's storing information in rows and

00:05:58,479 --> 00:06:01,600
columns

00:05:59,360 --> 00:06:04,000
so the way that's set up in wordpress is

00:06:01,600 --> 00:06:06,400
your rows are for each individual item

00:06:04,000 --> 00:06:08,319
so blog post one blog post two one plus

00:06:06,400 --> 00:06:09,440
three each one of those will be a row in

00:06:08,319 --> 00:06:11,120
your database

00:06:09,440 --> 00:06:13,360
uh and then you have columns that break

00:06:11,120 --> 00:06:15,680
up those rows so you would have your

00:06:13,360 --> 00:06:17,360
post title your host content your post

00:06:15,680 --> 00:06:19,199
extra so this is how the database

00:06:17,360 --> 00:06:22,240
organizes things

00:06:19,199 --> 00:06:24,400
and here is what wordpress comes with

00:06:22,240 --> 00:06:26,160
it's a whole bunch of tables i'm just

00:06:24,400 --> 00:06:28,520
going to talk about a few

00:06:26,160 --> 00:06:30,160
posts comments users those are pretty

00:06:28,520 --> 00:06:31,919
self-explanatory

00:06:30,160 --> 00:06:33,600
terms is where your categories and your

00:06:31,919 --> 00:06:35,680
tags live

00:06:33,600 --> 00:06:36,639
options like we said is where your

00:06:35,680 --> 00:06:38,400
settings are

00:06:36,639 --> 00:06:40,000
all the settings across the site and

00:06:38,400 --> 00:06:40,800
plugins like to dump a lot of things in

00:06:40,000 --> 00:06:42,479
there

00:06:40,800 --> 00:06:44,160
page builder tools that might come with

00:06:42,479 --> 00:06:44,720
your theme we'll put a lot of stuff in

00:06:44,160 --> 00:06:47,520
there

00:06:44,720 --> 00:06:48,880
and also temporary data called

00:06:47,520 --> 00:06:50,800
transients can also live

00:06:48,880 --> 00:06:52,319
in that options table so that's really

00:06:50,800 --> 00:06:54,080
the most important for performance where

00:06:52,319 --> 00:06:57,280
we really want to look

00:06:54,080 --> 00:06:59,199
the meta tables most tables come with a

00:06:57,280 --> 00:07:01,039
meta table and what that means is

00:06:59,199 --> 00:07:02,960
if you're running advanced custom fields

00:07:01,039 --> 00:07:05,440
if you're running a social media plug-in

00:07:02,960 --> 00:07:07,039
anything that would add new columns to

00:07:05,440 --> 00:07:08,720
it to your post table

00:07:07,039 --> 00:07:10,560
instead of going into posts that extra

00:07:08,720 --> 00:07:13,120
information goes into the meta table

00:07:10,560 --> 00:07:13,759
so again plugins that add extra

00:07:13,120 --> 00:07:15,520
information

00:07:13,759 --> 00:07:17,919
that's all going to go in post method

00:07:15,520 --> 00:07:19,280
and those are the two tables that we are

00:07:17,919 --> 00:07:19,759
really looking forward to see extra

00:07:19,280 --> 00:07:21,919
stuff

00:07:19,759 --> 00:07:23,199
and generate in our database which isn't

00:07:21,919 --> 00:07:24,560
supposed to be there

00:07:23,199 --> 00:07:25,840
so here are a couple of good database

00:07:24,560 --> 00:07:27,000
guides you can check out for a little

00:07:25,840 --> 00:07:30,639
bit more

00:07:27,000 --> 00:07:32,080
deliciousbrains.com premium.wpmd

00:07:30,639 --> 00:07:35,120
if you want to get a little bit deeper

00:07:32,080 --> 00:07:35,120
into how this stuff works

00:07:36,479 --> 00:07:43,199
so plugins also add their own tables uh

00:07:39,759 --> 00:07:45,520
workbence is here this weekend thank

00:07:43,199 --> 00:07:47,680
were you workbench sponsor they add a

00:07:45,520 --> 00:07:49,919
bunch of tables to your database

00:07:47,680 --> 00:07:51,360
so it is yoast sodas with commerce a lot

00:07:49,919 --> 00:07:52,800
of plugins you're probably using are

00:07:51,360 --> 00:07:54,319
adding tables to your database

00:07:52,800 --> 00:07:56,479
this is actually really good because it

00:07:54,319 --> 00:07:58,400
means the information is organized

00:07:56,479 --> 00:07:59,840
it's not sitting in your post meta table

00:07:58,400 --> 00:08:01,199
so it's going to be better organized and

00:07:59,840 --> 00:08:03,280
a lot faster

00:08:01,199 --> 00:08:05,039
but still we have to make sure we are

00:08:03,280 --> 00:08:05,520
looking for bad actors and making sure

00:08:05,039 --> 00:08:08,000
that

00:08:05,520 --> 00:08:12,080
plugins are not adding extra data bad

00:08:08,000 --> 00:08:14,479
data that we don't want on our site

00:08:12,080 --> 00:08:15,520
so you might see you notice that in our

00:08:14,479 --> 00:08:17,840
list of wordpress

00:08:15,520 --> 00:08:19,599
tables they're all wp underscore this is

00:08:17,840 --> 00:08:20,960
the default for wordpress your host

00:08:19,599 --> 00:08:21,919
might have to be different you can also

00:08:20,960 --> 00:08:23,680
change this yourself

00:08:21,919 --> 00:08:25,199
but just so you in case you run into

00:08:23,680 --> 00:08:28,720
anything weird uh

00:08:25,199 --> 00:08:28,720
that's why that's what the previous says

00:08:28,879 --> 00:08:33,440
so what actually causes database

00:08:30,400 --> 00:08:35,360
problems a large number of rows

00:08:33,440 --> 00:08:37,039
and a large data size of the road

00:08:35,360 --> 00:08:40,159
content like we saw with jeff site

00:08:37,039 --> 00:08:42,640
where he has 250 megabytes of stuff

00:08:40,159 --> 00:08:44,000
mysql the database software that we

00:08:42,640 --> 00:08:45,920
mostly all use

00:08:44,000 --> 00:08:48,080
uh is really good at searching through

00:08:45,920 --> 00:08:50,160
thousands of rows that is its job

00:08:48,080 --> 00:08:51,920
so we can be less concerned with having

00:08:50,160 --> 00:08:53,120
a lot of rows and more concerned with

00:08:51,920 --> 00:08:55,760
the data

00:08:53,120 --> 00:08:57,519
and let me show you how that works if

00:08:55,760 --> 00:08:58,080
you have private prejudice in a blog

00:08:57,519 --> 00:08:59,920
post

00:08:58,080 --> 00:09:01,839
that's going to be 700 kilobytes of

00:08:59,920 --> 00:09:03,839
information whereas if you put my tweet

00:09:01,839 --> 00:09:06,000
in a blog post that's 0.09

00:09:03,839 --> 00:09:07,519
so if you have 5 000 blog posts and each

00:09:06,000 --> 00:09:09,040
one is pride and prejudice you're gonna

00:09:07,519 --> 00:09:10,240
have a much bigger database than if you

00:09:09,040 --> 00:09:12,880
have 5000

00:09:10,240 --> 00:09:14,480
tweets uh in your database so we really

00:09:12,880 --> 00:09:16,959
want to be conscientious about

00:09:14,480 --> 00:09:19,200
data that we're using and another reason

00:09:16,959 --> 00:09:21,040
for that is not just performance

00:09:19,200 --> 00:09:22,560
but also it's taking up room on your

00:09:21,040 --> 00:09:24,880
server which you were paying for

00:09:22,560 --> 00:09:27,200
so if you have an account with a managed

00:09:24,880 --> 00:09:28,880
host like flywheel or wp engine

00:09:27,200 --> 00:09:30,959
you are paying for every gigabyte of

00:09:28,880 --> 00:09:31,680
storage uh it's not an unlimited amount

00:09:30,959 --> 00:09:33,440
of space

00:09:31,680 --> 00:09:35,760
and if you have somehow a database that

00:09:33,440 --> 00:09:38,000
balloons out to

00:09:35,760 --> 00:09:39,200
500 megabytes you only have five

00:09:38,000 --> 00:09:40,560
gigabytes to use

00:09:39,200 --> 00:09:42,000
that's something else to be aware of

00:09:40,560 --> 00:09:42,959
even if it's not causing a performance

00:09:42,000 --> 00:09:44,399
burden on your site

00:09:42,959 --> 00:09:46,880
it's still taking up space so we really

00:09:44,399 --> 00:09:48,399
want to be conscious about that

00:09:46,880 --> 00:09:51,040
so how can we tell if our database is

00:09:48,399 --> 00:09:54,000
slow this is the fun part

00:09:51,040 --> 00:09:55,600
speed tests uh so here's a couple tools

00:09:54,000 --> 00:09:56,640
that are very accessible you can get

00:09:55,600 --> 00:09:58,720
more into

00:09:56,640 --> 00:10:00,399
uh new relic and some other things that

00:09:58,720 --> 00:10:02,839
are high end but just to get started

00:10:00,399 --> 00:10:04,399
these are great

00:10:02,839 --> 00:10:05,920
bikecheck.comtools.kingdom.com and gt

00:10:04,399 --> 00:10:08,079
metrics

00:10:05,920 --> 00:10:09,839
this is fight check and this gives you a

00:10:08,079 --> 00:10:10,320
measure of what's called time to first

00:10:09,839 --> 00:10:11,760
bite

00:10:10,320 --> 00:10:13,920
which is how long it takes for someone

00:10:11,760 --> 00:10:15,519
to click on your website and

00:10:13,920 --> 00:10:18,000
for some other things to happen and then

00:10:15,519 --> 00:10:18,959
for the wordpress dog to go talk to the

00:10:18,000 --> 00:10:20,480
database pig

00:10:18,959 --> 00:10:22,079
get the tennis ball and bring it back to

00:10:20,480 --> 00:10:23,839
you and have the page ready to go

00:10:22,079 --> 00:10:26,160
so we're looking for what's called the

00:10:23,839 --> 00:10:27,200
wait time which is how long the server

00:10:26,160 --> 00:10:28,880
is doing that

00:10:27,200 --> 00:10:30,240
uh turn around and actually getting the

00:10:28,880 --> 00:10:32,640
information to make the page

00:10:30,240 --> 00:10:33,920
so in this example 29 milliseconds

00:10:32,640 --> 00:10:36,240
that's super good we're going to have a

00:10:33,920 --> 00:10:37,839
problem with this website

00:10:36,240 --> 00:10:39,279
pingdom will give you more information

00:10:37,839 --> 00:10:41,040
this is called the waterfall

00:10:39,279 --> 00:10:42,959
this is a whole rundown of all the

00:10:41,040 --> 00:10:45,200
information all the data that's loading

00:10:42,959 --> 00:10:46,160
on your web page so the page itself and

00:10:45,200 --> 00:10:49,200
all your javascript

00:10:46,160 --> 00:10:51,040
css uh in that top bar

00:10:49,200 --> 00:10:52,880
you can see it's broken into the steps

00:10:51,040 --> 00:10:56,000
of our time first fight and again

00:10:52,880 --> 00:10:57,839
we want that yellow bar uh the wait time

00:10:56,000 --> 00:11:00,399
so we just want that little sliver to be

00:10:57,839 --> 00:11:02,640
really fast

00:11:00,399 --> 00:11:03,920
so uh wait time is part of the time for

00:11:02,640 --> 00:11:05,040
spite as you can see they're in the

00:11:03,920 --> 00:11:06,560
waterfall

00:11:05,040 --> 00:11:08,399
bike check will break it out but if you

00:11:06,560 --> 00:11:09,279
want to do more of a bigger speed test

00:11:08,399 --> 00:11:12,240
you would use

00:11:09,279 --> 00:11:12,959
kingdom or gt metrics so wait time

00:11:12,240 --> 00:11:14,480
should be

00:11:12,959 --> 00:11:16,959
google says it should be under 200

00:11:14,480 --> 00:11:18,720
milliseconds in real world scenarios you

00:11:16,959 --> 00:11:21,200
can absolutely get it under 200

00:11:18,720 --> 00:11:22,320
you can get it to 100 if you have if

00:11:21,200 --> 00:11:24,640
you're on a good server

00:11:22,320 --> 00:11:26,079
you have a clean database this is

00:11:24,640 --> 00:11:27,519
something you can very realistically

00:11:26,079 --> 00:11:30,240
shoot for

00:11:27,519 --> 00:11:32,079
something to remember is as your site

00:11:30,240 --> 00:11:33,760
scales and you have more traffic

00:11:32,079 --> 00:11:35,120
that will put more strain on the server

00:11:33,760 --> 00:11:36,720
more ram or cpu

00:11:35,120 --> 00:11:38,320
and so things will go slower so you

00:11:36,720 --> 00:11:39,200
really want to make sure it is as fast

00:11:38,320 --> 00:11:40,959
as it can be

00:11:39,200 --> 00:11:42,320
before your server is under load and

00:11:40,959 --> 00:11:43,440
you're having a big traffic day

00:11:42,320 --> 00:11:46,079
and all of a sudden you're going from

00:11:43,440 --> 00:11:49,200
100 milliseconds to 300 to 500 and

00:11:46,079 --> 00:11:51,839
things start to get really slow

00:11:49,200 --> 00:11:52,880
so slow wake times uh can be caused by

00:11:51,839 --> 00:11:55,120
several factors

00:11:52,880 --> 00:11:57,120
your server it could be old hardware it

00:11:55,120 --> 00:11:59,760
might not be on the solid state drive

00:11:57,120 --> 00:12:03,360
uh an old php version a lot of us are

00:11:59,760 --> 00:12:06,800
still on 5.6 or 5.3 or who even knows

00:12:03,360 --> 00:12:07,839
we should all be on 7.0 or better uh or

00:12:06,800 --> 00:12:09,839
the slow database

00:12:07,839 --> 00:12:11,600
and so in jeff's case he had just moved

00:12:09,839 --> 00:12:13,760
over to a fast server so

00:12:11,600 --> 00:12:15,360
we knew he was on a move to digitalocean

00:12:13,760 --> 00:12:18,720
so we knew he had a good server

00:12:15,360 --> 00:12:20,639
we knew he was on php 7.1 so

00:12:18,720 --> 00:12:22,320
no problems there so when i was doing my

00:12:20,639 --> 00:12:23,040
speed tests you can do process of

00:12:22,320 --> 00:12:24,959
elimination

00:12:23,040 --> 00:12:26,160
see that slow wait time it's probably

00:12:24,959 --> 00:12:28,079
because of the data fees

00:12:26,160 --> 00:12:29,600
so that's something to solve uh if

00:12:28,079 --> 00:12:31,120
you're on slower hosting

00:12:29,600 --> 00:12:33,360
you definitely want to upgrade it's not

00:12:31,120 --> 00:12:34,959
a lot more money it's really worthwhile

00:12:33,360 --> 00:12:36,160
and then you can do these tests and see

00:12:34,959 --> 00:12:38,320
if you think your database is going to

00:12:36,160 --> 00:12:39,760
be a problem

00:12:38,320 --> 00:12:41,279
so caching is probably something that

00:12:39,760 --> 00:12:42,399
you have heard of who's your caption

00:12:41,279 --> 00:12:44,000
raise your hands

00:12:42,399 --> 00:12:45,440
okay so we all know about caching i'm

00:12:44,000 --> 00:12:47,360
sure it's running on your website that's

00:12:45,440 --> 00:12:49,440
great you should absolutely do that

00:12:47,360 --> 00:12:50,560
but caption is a band-aid for the

00:12:49,440 --> 00:12:53,200
database because

00:12:50,560 --> 00:12:54,800
what happens is it uh the cache page is

00:12:53,200 --> 00:12:56,560
built from the database information

00:12:54,800 --> 00:12:58,800
and then we skip right over it every

00:12:56,560 --> 00:13:00,160
single time after so if you have a slow

00:12:58,800 --> 00:13:02,320
database and you're caching on

00:13:00,160 --> 00:13:03,440
it's fine you're never going to know

00:13:02,320 --> 00:13:05,040
until you do

00:13:03,440 --> 00:13:06,639
so you always want to test with cashing

00:13:05,040 --> 00:13:08,160
off make sure you're really getting the

00:13:06,639 --> 00:13:10,079
correct results from the database and

00:13:08,160 --> 00:13:13,760
not from your cash

00:13:10,079 --> 00:13:15,680
one more slide about that basically uh

00:13:13,760 --> 00:13:17,279
this is zach's in one slide tax

00:13:15,680 --> 00:13:19,519
talking yesterday which is great

00:13:17,279 --> 00:13:21,040
caching builds your html web pages once

00:13:19,519 --> 00:13:22,480
and then saves them for future use

00:13:21,040 --> 00:13:24,959
so we don't have a docker database

00:13:22,480 --> 00:13:26,160
anymore it makes wait time super fast

00:13:24,959 --> 00:13:28,079
because you are no longer doing that

00:13:26,160 --> 00:13:30,720
step you're ready to go

00:13:28,079 --> 00:13:32,480
but it is not a fix for dynamic pages

00:13:30,720 --> 00:13:33,440
and pages that have to be generated on

00:13:32,480 --> 00:13:35,120
the fly so

00:13:33,440 --> 00:13:36,720
if you were a logged in user if you were

00:13:35,120 --> 00:13:38,000
on the back end of your site none of

00:13:36,720 --> 00:13:39,600
that's cached

00:13:38,000 --> 00:13:41,360
if you're running e-commerce that's not

00:13:39,600 --> 00:13:42,959
going to be cached if you have a site

00:13:41,360 --> 00:13:44,639
with thousands of pages that can't all

00:13:42,959 --> 00:13:46,160
be cached

00:13:44,639 --> 00:13:48,079
i have one client who does have about

00:13:46,160 --> 00:13:49,920
three or four thousand blog posts and if

00:13:48,079 --> 00:13:51,440
you wanted to cash all that you know

00:13:49,920 --> 00:13:53,680
that's not something that would be very

00:13:51,440 --> 00:13:55,199
realistic um so if you do want to do

00:13:53,680 --> 00:13:57,279
some caching if you're not using it

00:13:55,199 --> 00:13:58,880
i like cash enabler i like wp rocket

00:13:57,279 --> 00:13:59,920
that's a great plugin it's really easy

00:13:58,880 --> 00:14:01,279
to use

00:13:59,920 --> 00:14:02,720
but again this is not going to be fixed

00:14:01,279 --> 00:14:03,920
in all situations and we want to make

00:14:02,720 --> 00:14:06,560
sure we are

00:14:03,920 --> 00:14:08,399
testing our database learning about it

00:14:06,560 --> 00:14:09,680
so the most important tables for cleanup

00:14:08,399 --> 00:14:11,279
for performance

00:14:09,680 --> 00:14:13,040
uh are going to be the opposite table

00:14:11,279 --> 00:14:14,720
because that's loading every time

00:14:13,040 --> 00:14:16,639
uh the post meta table because that's

00:14:14,720 --> 00:14:18,560
where plug-in data goes to die

00:14:16,639 --> 00:14:20,480
and then also posts and comments can get

00:14:18,560 --> 00:14:22,240
out of hand and of course any plug-in

00:14:20,480 --> 00:14:24,160
tables that get added we really want to

00:14:22,240 --> 00:14:26,000
be policing

00:14:24,160 --> 00:14:27,519
so here's some database detective tools

00:14:26,000 --> 00:14:28,639
that we can use to start getting into

00:14:27,519 --> 00:14:29,920
this

00:14:28,639 --> 00:14:32,079
some wordpress plugins we're going to

00:14:29,920 --> 00:14:33,680
look at and also sql

00:14:32,079 --> 00:14:35,120
uh ultimately you have to write some

00:14:33,680 --> 00:14:36,079
code if you really want to get into

00:14:35,120 --> 00:14:38,000
advanced cleanup

00:14:36,079 --> 00:14:39,600
and do it yourself no plugin can do it

00:14:38,000 --> 00:14:41,040
for you because you have to be the one

00:14:39,600 --> 00:14:41,920
to say i think this is from this plugin

00:14:41,040 --> 00:14:43,839
that i don't use

00:14:41,920 --> 00:14:45,600
and i need to delete this specific thing

00:14:43,839 --> 00:14:46,880
and let's find out how much information

00:14:45,600 --> 00:14:49,120
that that is using and we're going to

00:14:46,880 --> 00:14:50,000
run that today if we don't run out of

00:14:49,120 --> 00:14:52,399
time here

00:14:50,000 --> 00:14:54,720
uh and you can also go on you can do any

00:14:52,399 --> 00:14:56,880
of this in phpmyadmin this is a

00:14:54,720 --> 00:14:58,000
mysql tool that probably is on your

00:14:56,880 --> 00:15:00,480
server it's certainly

00:14:58,000 --> 00:15:01,920
on cpanel if you're using that if you

00:15:00,480 --> 00:15:04,160
don't have access to that

00:15:01,920 --> 00:15:06,000
you can go on the command line and log

00:15:04,160 --> 00:15:06,720
into mysql and you can do any of the

00:15:06,000 --> 00:15:08,480
same code

00:15:06,720 --> 00:15:10,000
but you probably have phpmyadmin you

00:15:08,480 --> 00:15:11,440
probably have another similar tool

00:15:10,000 --> 00:15:13,920
that you can use to interact with your

00:15:11,440 --> 00:15:15,600
database you don't want to be doing this

00:15:13,920 --> 00:15:16,800
in the wordpress dashboard with a plugin

00:15:15,600 --> 00:15:18,160
because that leaves you really

00:15:16,800 --> 00:15:19,040
vulnerable to hacking and you want to be

00:15:18,160 --> 00:15:21,920
doing it with

00:15:19,040 --> 00:15:23,519
an outside tool so before you do

00:15:21,920 --> 00:15:24,160
anything always back up your database

00:15:23,519 --> 00:15:25,440
because

00:15:24,160 --> 00:15:26,959
as soon as you delete something if

00:15:25,440 --> 00:15:27,440
you're not 100 sure what that's going to

00:15:26,959 --> 00:15:29,279
do

00:15:27,440 --> 00:15:30,720
you want to have your backup ready to go

00:15:29,279 --> 00:15:33,440
i use wp

00:15:30,720 --> 00:15:34,720
migrate db it's a free plug-in it does

00:15:33,440 --> 00:15:37,680
have a pro version but

00:15:34,720 --> 00:15:38,079
works great free it's super reliable

00:15:37,680 --> 00:15:40,000
just

00:15:38,079 --> 00:15:41,680
save your database do something save

00:15:40,000 --> 00:15:43,839
another copy make sure you've got that

00:15:41,680 --> 00:15:46,160
database backed up ready to go

00:15:43,839 --> 00:15:47,920
before you do anything so here is a

00:15:46,160 --> 00:15:49,360
great tool called server status this is

00:15:47,920 --> 00:15:50,880
a plugin from global busy

00:15:49,360 --> 00:15:52,399
and this can help us start to understand

00:15:50,880 --> 00:15:54,240
what is going on on our server if we

00:15:52,399 --> 00:15:56,480
don't have any information about it

00:15:54,240 --> 00:15:58,079
i don't know if that's too small to see

00:15:56,480 --> 00:16:00,000
but it gives us some good information

00:15:58,079 --> 00:16:02,720
like disk space and database science

00:16:00,000 --> 00:16:03,680
so we can see here we have 9 gigabytes

00:16:02,720 --> 00:16:06,079
of space

00:16:03,680 --> 00:16:07,680
on our server we're only using 27

00:16:06,079 --> 00:16:08,399
megabytes of our database so that's

00:16:07,680 --> 00:16:10,079
great

00:16:08,399 --> 00:16:11,680
uh you might have a situation where you

00:16:10,079 --> 00:16:13,680
have a two gigabyte database

00:16:11,680 --> 00:16:15,199
on a five gigabyte server and that can

00:16:13,680 --> 00:16:16,639
tell you well it's time to clean the

00:16:15,199 --> 00:16:18,639
database or upgrade the server

00:16:16,639 --> 00:16:20,160
get some more room so that's a great

00:16:18,639 --> 00:16:20,880
place to start just looking at the size

00:16:20,160 --> 00:16:23,199
and everything

00:16:20,880 --> 00:16:25,199
you can get your php version your mysql

00:16:23,199 --> 00:16:26,880
version make sure your php is up to date

00:16:25,199 --> 00:16:28,560
you do it on 7.0

00:16:26,880 --> 00:16:30,720
i think uh some hosting companies are

00:16:28,560 --> 00:16:33,040
rolling out 7.3

00:16:30,720 --> 00:16:34,800
and 7.2 is supported by wordpress right

00:16:33,040 --> 00:16:36,000
now might not be supported by some of

00:16:34,800 --> 00:16:38,240
your older plugins but

00:16:36,000 --> 00:16:39,839
certainly most things should be ready

00:16:38,240 --> 00:16:42,240
for 7.0 at this time and you should be

00:16:39,839 --> 00:16:42,240
safe too

00:16:42,320 --> 00:16:46,320
so wp optimized we talked a little bit

00:16:44,240 --> 00:16:47,279
about it doesn't solve every problem but

00:16:46,320 --> 00:16:50,160
it can solve some

00:16:47,279 --> 00:16:51,759
really easy ones that we can knock out

00:16:50,160 --> 00:16:53,839
so when we look at this plugin

00:16:51,759 --> 00:16:55,120
this gives us basically some information

00:16:53,839 --> 00:16:56,880
about our database

00:16:55,120 --> 00:16:59,040
we can get the records which is what

00:16:56,880 --> 00:16:59,920
they call rows and also the data size

00:16:59,040 --> 00:17:01,600
which is our

00:16:59,920 --> 00:17:04,000
our megabytes that are being filled up

00:17:01,600 --> 00:17:04,559
by facebook sure counter plugins that

00:17:04,000 --> 00:17:07,760
from

00:17:04,559 --> 00:17:09,039
2013 that never got erased so this is a

00:17:07,760 --> 00:17:11,439
really great time to

00:17:09,039 --> 00:17:13,120
just use some common sense and say what

00:17:11,439 --> 00:17:14,640
are the biggest tables as far as grows

00:17:13,120 --> 00:17:15,760
what are the biggest tables as far as

00:17:14,640 --> 00:17:18,480
data

00:17:15,760 --> 00:17:19,199
i have 300 posts on my blog why do i

00:17:18,480 --> 00:17:22,000
have 30

00:17:19,199 --> 00:17:23,120
000 rows in the post table right or if

00:17:22,000 --> 00:17:25,600
you have

00:17:23,120 --> 00:17:26,160
your post option or your wp options

00:17:25,600 --> 00:17:27,679
table

00:17:26,160 --> 00:17:29,120
you really want that to be as small as

00:17:27,679 --> 00:17:30,240
possible it should just be one or two

00:17:29,120 --> 00:17:32,480
megabytes

00:17:30,240 --> 00:17:35,600
maybe about 500 rows wordpress comes

00:17:32,480 --> 00:17:36,960
with about 250 rows of built-in options

00:17:35,600 --> 00:17:39,440
and so once you start getting to a

00:17:36,960 --> 00:17:40,240
thousand two thousand five megabytes ten

00:17:39,440 --> 00:17:43,360
megabytes

00:17:40,240 --> 00:17:44,799
252 megabytes uh that's a time when you

00:17:43,360 --> 00:17:45,440
want to go in and really see what's

00:17:44,799 --> 00:17:47,280
going on

00:17:45,440 --> 00:17:48,880
so we can look at use some common sense

00:17:47,280 --> 00:17:49,280
learn what we use what we've learned

00:17:48,880 --> 00:17:51,600
about

00:17:49,280 --> 00:17:54,880
our database to see what we need to

00:17:51,600 --> 00:17:57,200
start uh owning it

00:17:54,880 --> 00:17:58,640
so some things that wp optimize can do

00:17:57,200 --> 00:18:01,039
the first thing you want to do is clean

00:17:58,640 --> 00:18:01,760
your post revisions anytime you hit save

00:18:01,039 --> 00:18:04,240
or publish

00:18:01,760 --> 00:18:06,160
on a post or page in wordpress what that

00:18:04,240 --> 00:18:07,120
is doing is saving a version of that

00:18:06,160 --> 00:18:08,799
post

00:18:07,120 --> 00:18:10,240
which is awesome because you have every

00:18:08,799 --> 00:18:12,840
version you've ever

00:18:10,240 --> 00:18:15,360
published on your site but if you have

00:18:12,840 --> 00:18:17,520
5000 pride and prejudice blog posts

00:18:15,360 --> 00:18:19,360
and you have 30 copies of each one you

00:18:17,520 --> 00:18:20,640
now have a gigantic day of things

00:18:19,360 --> 00:18:22,480
so this is something that you should go

00:18:20,640 --> 00:18:22,880
in and clean every so often make sure

00:18:22,480 --> 00:18:24,559
you

00:18:22,880 --> 00:18:25,679
especially on an older site you really

00:18:24,559 --> 00:18:26,080
want to make sure you're cleaning that

00:18:25,679 --> 00:18:28,160
out

00:18:26,080 --> 00:18:30,240
and you don't have five years of drafts

00:18:28,160 --> 00:18:32,160
from your 5000 blog posts that are all

00:18:30,240 --> 00:18:34,000
sent out that you don't need anymore

00:18:32,160 --> 00:18:35,280
uh you can clean out spam and trash

00:18:34,000 --> 00:18:37,280
comments that's a

00:18:35,280 --> 00:18:38,559
one click thing that's great to do one

00:18:37,280 --> 00:18:40,480
thing that this plug-in does that we

00:18:38,559 --> 00:18:43,440
don't need to do anymore is clean out

00:18:40,480 --> 00:18:44,960
expired transients which is temporary

00:18:43,440 --> 00:18:46,400
data that can be generated by the

00:18:44,960 --> 00:18:46,880
woocommerce sessions and things like

00:18:46,400 --> 00:18:48,720
that

00:18:46,880 --> 00:18:50,480
and wordpress since version 4.0 will

00:18:48,720 --> 00:18:52,880
actually clear that up for us so we

00:18:50,480 --> 00:18:54,080
probably don't need to do that anymore

00:18:52,880 --> 00:18:56,080
and the other thing is checking the

00:18:54,080 --> 00:18:58,160
optimized database tables at the top

00:18:56,080 --> 00:18:59,440
and that will just empty the recycle bin

00:18:58,160 --> 00:19:01,039
basically and make sure you actually

00:18:59,440 --> 00:19:03,760
clean out your trash and you can

00:19:01,039 --> 00:19:04,960
get a clean database so this is spring

00:19:03,760 --> 00:19:06,400
cleaning basically

00:19:04,960 --> 00:19:08,720
you want to look in on this make sure

00:19:06,400 --> 00:19:10,160
you're doing it every so often

00:19:08,720 --> 00:19:11,440
but it's not going to solve advanced

00:19:10,160 --> 00:19:12,799
problems it's not going to delete old

00:19:11,440 --> 00:19:16,080
plug-in data

00:19:12,799 --> 00:19:19,120
it does have a setting for uh orphan

00:19:16,080 --> 00:19:20,640
relationship data and open post metadata

00:19:19,120 --> 00:19:22,799
which means if you have a post

00:19:20,640 --> 00:19:24,240
it has some post metadata maybe somehow

00:19:22,799 --> 00:19:26,080
that post got deleted and it didn't

00:19:24,240 --> 00:19:27,280
delete its five rows of metadata so

00:19:26,080 --> 00:19:28,400
that's something you can clean out here

00:19:27,280 --> 00:19:29,039
but that's not going to be a major

00:19:28,400 --> 00:19:30,559
problem

00:19:29,039 --> 00:19:32,720
in general because wordpress does a good

00:19:30,559 --> 00:19:34,480
job of cleaning that stuff out

00:19:32,720 --> 00:19:36,320
and what this plug-in cannot do is look

00:19:34,480 --> 00:19:37,600
up orphan data from its plugins

00:19:36,320 --> 00:19:39,520
so that's something that we have to do

00:19:37,600 --> 00:19:42,720
by hand which we're going to do

00:19:39,520 --> 00:19:44,400
in just a couple of slides so

00:19:42,720 --> 00:19:46,240
advanced cleanup this is the stuff that

00:19:44,400 --> 00:19:47,919
humans have to do i don't know

00:19:46,240 --> 00:19:49,679
if there are any advanced plugins which

00:19:47,919 --> 00:19:51,039
can do this so we're going to get into

00:19:49,679 --> 00:19:52,320
it right now

00:19:51,039 --> 00:19:54,240
we're gonna look at the options table

00:19:52,320 --> 00:19:55,919
and post meta and of course plugins

00:19:54,240 --> 00:19:56,960
tables are also what we want to make

00:19:55,919 --> 00:20:00,080
sure we are

00:19:56,960 --> 00:20:02,080
uh keeping an eye on so what causes some

00:20:00,080 --> 00:20:02,640
problems bad active plugins currently on

00:20:02,080 --> 00:20:04,159
your site

00:20:02,640 --> 00:20:06,320
which are just filling up your database

00:20:04,159 --> 00:20:07,679
you didn't even know uh abandoned data

00:20:06,320 --> 00:20:08,799
from old plugins that you haven't used

00:20:07,679 --> 00:20:10,400
since 2013

00:20:08,799 --> 00:20:11,600
which is slowing your site to a crawl

00:20:10,400 --> 00:20:12,480
you really want to make sure you get

00:20:11,600 --> 00:20:14,559
that stuff out

00:20:12,480 --> 00:20:16,640
and then another edge case i found is

00:20:14,559 --> 00:20:17,840
import data so if you brought your site

00:20:16,640 --> 00:20:21,440
over from blogger

00:20:17,840 --> 00:20:22,720
in 2010 like i did um i found all the

00:20:21,440 --> 00:20:25,760
stuff that was supposed to go into

00:20:22,720 --> 00:20:27,760
posts which did also went into post meta

00:20:25,760 --> 00:20:29,760
so i had like an entire extra copy of my

00:20:27,760 --> 00:20:31,360
site sitting in post meta

00:20:29,760 --> 00:20:32,799
not a big deal but something that should

00:20:31,360 --> 00:20:34,240
be cleaned out it doesn't need to be in

00:20:32,799 --> 00:20:35,840
your database

00:20:34,240 --> 00:20:37,440
so a lot of these issues are for older

00:20:35,840 --> 00:20:38,559
sites if you have a site that's been

00:20:37,440 --> 00:20:41,200
around for a few years

00:20:38,559 --> 00:20:41,760
you have more older information uh older

00:20:41,200 --> 00:20:44,240
code from

00:20:41,760 --> 00:20:46,080
wordpress was not as wonderful as it is

00:20:44,240 --> 00:20:47,840
now of course

00:20:46,080 --> 00:20:49,520
older plugins you probably used a lot of

00:20:47,840 --> 00:20:51,200
different plugins and deleted them

00:20:49,520 --> 00:20:52,640
so if you have a site that's two months

00:20:51,200 --> 00:20:53,440
old you're not going to have a lot of

00:20:52,640 --> 00:20:55,280
these problems

00:20:53,440 --> 00:20:56,799
if your site or your client side is five

00:20:55,280 --> 00:20:58,080
years eight years old

00:20:56,799 --> 00:21:01,120
these are things that you really want to

00:20:58,080 --> 00:21:04,640
go through and be looking for

00:21:01,120 --> 00:21:06,480
so facts only uh most serious database

00:21:04,640 --> 00:21:07,840
issues are because of plug-ins so that's

00:21:06,480 --> 00:21:09,280
what we want to focus on

00:21:07,840 --> 00:21:10,960
if you're running 20 different plug-ins

00:21:09,280 --> 00:21:12,320
on your site your client has all this

00:21:10,960 --> 00:21:14,320
stuff that's been sitting there since

00:21:12,320 --> 00:21:15,760
2012 they don't know what it is

00:21:14,320 --> 00:21:17,919
we really need to go and see what's

00:21:15,760 --> 00:21:20,240
going on

00:21:17,919 --> 00:21:21,440
so some problem plugins to watch out for

00:21:20,240 --> 00:21:23,679
uh social media share

00:21:21,440 --> 00:21:25,200
counters uh anything that is saving data

00:21:23,679 --> 00:21:27,039
for every post on your site

00:21:25,200 --> 00:21:28,799
uh that's a whole that's a one row in

00:21:27,039 --> 00:21:30,799
your database for every single post

00:21:28,799 --> 00:21:32,320
uh popular post counters same kind of

00:21:30,799 --> 00:21:34,720
thing they might be saving

00:21:32,320 --> 00:21:35,600
all the popular posts from every day for

00:21:34,720 --> 00:21:36,960
as long as you've been running

00:21:35,600 --> 00:21:38,559
encounters you might have five years of

00:21:36,960 --> 00:21:42,080
data sitting there

00:21:38,559 --> 00:21:43,760
logging word fence uh keeps a live log

00:21:42,080 --> 00:21:44,400
of every ip address that hits your

00:21:43,760 --> 00:21:46,080
website

00:21:44,400 --> 00:21:47,440
as part of its security measures you

00:21:46,080 --> 00:21:48,080
don't need that live traffic on it turn

00:21:47,440 --> 00:21:49,440
that off

00:21:48,080 --> 00:21:50,799
and you will not be writing to your

00:21:49,440 --> 00:21:52,159
database and storing all that extra

00:21:50,799 --> 00:21:53,919
information

00:21:52,159 --> 00:21:55,280
and then search program search plugins

00:21:53,919 --> 00:21:57,520
like relevancy

00:21:55,280 --> 00:21:58,720
that creates a database in your database

00:21:57,520 --> 00:22:00,880
so that you can have

00:21:58,720 --> 00:22:02,720
more stuff indexed and better search

00:22:00,880 --> 00:22:03,840
results that's really great but it also

00:22:02,720 --> 00:22:05,280
takes up a lot of space

00:22:03,840 --> 00:22:07,520
so i'm not saying not to use these

00:22:05,280 --> 00:22:09,600
things i'm saying make sure you're aware

00:22:07,520 --> 00:22:10,559
of what kind of load these plugins are

00:22:09,600 --> 00:22:12,159
having on your site

00:22:10,559 --> 00:22:13,679
maybe you do need to upgrade your server

00:22:12,159 --> 00:22:14,000
so you can use the plugins you want to

00:22:13,679 --> 00:22:15,360
and

00:22:14,000 --> 00:22:17,919
just be aware of what's going on in

00:22:15,360 --> 00:22:18,559
there so something really important to

00:22:17,919 --> 00:22:20,960
do

00:22:18,559 --> 00:22:22,080
is vet your plugins wordfence is a great

00:22:20,960 --> 00:22:24,000
example because

00:22:22,080 --> 00:22:25,520
what that does is you have to go all the

00:22:24,000 --> 00:22:28,159
way through the 5000 options

00:22:25,520 --> 00:22:29,280
and check a box that says please delete

00:22:28,159 --> 00:22:30,799
my database stuff

00:22:29,280 --> 00:22:32,400
all my information when you delete this

00:22:30,799 --> 00:22:34,000
play if you don't do it

00:22:32,400 --> 00:22:35,520
it leaves its tables in your database

00:22:34,000 --> 00:22:37,039
forever if you delete that plugin and

00:22:35,520 --> 00:22:39,120
that's something that you have to go in

00:22:37,039 --> 00:22:40,400
and turn on it is not a default so you

00:22:39,120 --> 00:22:41,200
really want to go through the options of

00:22:40,400 --> 00:22:42,880
your plugins

00:22:41,200 --> 00:22:45,280
make sure you are checking that box so

00:22:42,880 --> 00:22:47,440
it doesn't leave stuff behind

00:22:45,280 --> 00:22:48,720
you want to do a test delete and see if

00:22:47,440 --> 00:22:50,080
it doesn't have that option

00:22:48,720 --> 00:22:52,960
if it is going to take its stuff with

00:22:50,080 --> 00:22:54,400
you with it i think wp optimized

00:22:52,960 --> 00:22:56,000
i'm pretty sure it doesn't actually

00:22:54,400 --> 00:22:57,520
clean up after itself and it will leave

00:22:56,000 --> 00:22:58,960
a couple of rows in your database

00:22:57,520 --> 00:23:01,280
which is hilarious because there's a

00:22:58,960 --> 00:23:03,679
cleanup plug-in i'm not 100 sure it

00:23:01,280 --> 00:23:05,120
still does that but it did before

00:23:03,679 --> 00:23:07,120
so these are plug-ins that you're going

00:23:05,120 --> 00:23:09,039
to be using on these sites for years

00:23:07,120 --> 00:23:10,640
right so it's worth it to take 15

00:23:09,039 --> 00:23:12,000
minutes put it on a test site

00:23:10,640 --> 00:23:13,440
make sure you know what it's doing and

00:23:12,000 --> 00:23:15,360
you give it uh you give it a good

00:23:13,440 --> 00:23:18,640
examination before you actually

00:23:15,360 --> 00:23:20,960
give it to the client and get going

00:23:18,640 --> 00:23:22,240
so let's do some actual cleaning our

00:23:20,960 --> 00:23:24,320
goals today

00:23:22,240 --> 00:23:25,840
our mission if you choose to accept it

00:23:24,320 --> 00:23:27,760
uh we want to get the options table

00:23:25,840 --> 00:23:30,080
under 500 rows if we can

00:23:27,760 --> 00:23:32,960
uh under two megabytes especially for

00:23:30,080 --> 00:23:34,480
the parts of it that are auto loading

00:23:32,960 --> 00:23:36,559
and then we want to drill down into any

00:23:34,480 --> 00:23:38,799
other big tables with sql

00:23:36,559 --> 00:23:39,679
queries and find the junk database table

00:23:38,799 --> 00:23:41,679
and find the junk

00:23:39,679 --> 00:23:43,600
uh plug in data and get rid of it so it

00:23:41,679 --> 00:23:46,559
is not taking on memory taking up space

00:23:43,600 --> 00:23:50,240
that it can be using for faster results

00:23:46,559 --> 00:23:51,840
so this is an sql query and we do have

00:23:50,240 --> 00:23:52,559
some time so we're going to try to teach

00:23:51,840 --> 00:23:54,559
you all

00:23:52,559 --> 00:23:56,240
a little bit of sql this has written sql

00:23:54,559 --> 00:23:58,559
before

00:23:56,240 --> 00:24:00,080
that's amazing i was expecting two hands

00:23:58,559 --> 00:24:03,840
that's great so you're all set

00:24:00,080 --> 00:24:05,679
okay so basically the magic of

00:24:03,840 --> 00:24:07,039
getting into your database is the second

00:24:05,679 --> 00:24:08,799
function here we have our

00:24:07,039 --> 00:24:11,039
select statement so we're going to do a

00:24:08,799 --> 00:24:12,559
search we're going to count everything

00:24:11,039 --> 00:24:14,240
as an autoload row count so we're going

00:24:12,559 --> 00:24:15,440
to get a count of all the rows

00:24:14,240 --> 00:24:17,279
in the options table that are

00:24:15,440 --> 00:24:19,360
autoloading and then this big thing that

00:24:17,279 --> 00:24:21,520
makes up a bunch of lines here

00:24:19,360 --> 00:24:23,039
round sum length and cap what we're

00:24:21,520 --> 00:24:25,520
doing in there is getting

00:24:23,039 --> 00:24:26,799
uh we're adding up all the data of each

00:24:25,520 --> 00:24:29,120
column in the table

00:24:26,799 --> 00:24:30,320
and we're going to get that data for the

00:24:29,120 --> 00:24:33,200
rows that we're looking at

00:24:30,320 --> 00:24:34,640
so you can apply this function to any

00:24:33,200 --> 00:24:36,000
table in the database you just have to

00:24:34,640 --> 00:24:38,320
change the columns

00:24:36,000 --> 00:24:40,000
so in case the meta tables they are the

00:24:38,320 --> 00:24:41,840
options table has option id

00:24:40,000 --> 00:24:43,520
option name and a meta table it would

00:24:41,840 --> 00:24:44,080
have a different list same for the post

00:24:43,520 --> 00:24:46,640
tables

00:24:44,080 --> 00:24:48,720
but all you have to do is put in your

00:24:46,640 --> 00:24:50,799
the column names of the table

00:24:48,720 --> 00:24:51,760
uh so you can get the total information

00:24:50,799 --> 00:24:54,159
the whole

00:24:51,760 --> 00:24:55,840
megabyte uh data that's using and then

00:24:54,159 --> 00:24:57,840
we can do our search we can do our where

00:24:55,840 --> 00:25:00,000
auto load equals yes

00:24:57,840 --> 00:25:01,200
so we're going to run this live right

00:25:00,000 --> 00:25:04,720
now

00:25:01,200 --> 00:25:04,720
i'm going to switch over to the computer

00:25:08,880 --> 00:25:14,480
so i use map to do my local development

00:25:12,159 --> 00:25:15,840
that comes with phpmyadmin

00:25:14,480 --> 00:25:17,679
any tool is going to give you a pretty

00:25:15,840 --> 00:25:20,559
similar setup

00:25:17,679 --> 00:25:21,679
but basically this is a database a

00:25:20,559 --> 00:25:23,520
client database

00:25:21,679 --> 00:25:24,880
as you can see it has five million

00:25:23,520 --> 00:25:26,320
tables in here from all the plugins that

00:25:24,880 --> 00:25:28,159
they've been using

00:25:26,320 --> 00:25:29,760
so this is a good way to get started you

00:25:28,159 --> 00:25:30,880
can say am i using what is this

00:25:29,760 --> 00:25:34,400
underscore

00:25:30,880 --> 00:25:35,840
rg uh the prefix is where you're going

00:25:34,400 --> 00:25:37,279
to get the information on what plugin

00:25:35,840 --> 00:25:38,080
this is and sometimes you have to do

00:25:37,279 --> 00:25:40,080
some googling

00:25:38,080 --> 00:25:41,360
but if you know what tables are supposed

00:25:40,080 --> 00:25:44,480
to be there already

00:25:41,360 --> 00:25:45,760
you can look in and say ecpt

00:25:44,480 --> 00:25:47,679
that's not something that goes with

00:25:45,760 --> 00:25:49,520
wordpress eww

00:25:47,679 --> 00:25:51,039
oh i know that's an image plugin so you

00:25:49,520 --> 00:25:52,240
can look and see what are the extra

00:25:51,039 --> 00:25:52,880
tables that are getting added to your

00:25:52,240 --> 00:25:54,159
database

00:25:52,880 --> 00:25:56,080
and if you did your vetting you already

00:25:54,159 --> 00:25:57,360
know but if you see anything in here

00:25:56,080 --> 00:25:59,039
that's a plug-in that you don't

00:25:57,360 --> 00:26:00,559
use anymore you can back up your

00:25:59,039 --> 00:26:00,960
database and then you can just delete it

00:26:00,559 --> 00:26:03,200
and you

00:26:00,960 --> 00:26:05,440
save yourself that space so if this site

00:26:03,200 --> 00:26:08,240
was no longer using the eww

00:26:05,440 --> 00:26:10,159
plugin you can just check this box and

00:26:08,240 --> 00:26:10,799
go all the way down to the bottom keep

00:26:10,159 --> 00:26:12,559
scrolling

00:26:10,799 --> 00:26:13,919
all the way down and then with that

00:26:12,559 --> 00:26:15,840
selected table

00:26:13,919 --> 00:26:17,039
we can just hit drop and delete it and

00:26:15,840 --> 00:26:18,960
then it's gone

00:26:17,039 --> 00:26:20,400
so again back it up before you start

00:26:18,960 --> 00:26:22,880
dropping tables you don't want to break

00:26:20,400 --> 00:26:24,400
anybody's buttons

00:26:22,880 --> 00:26:26,320
so that's the first thing that we can do

00:26:24,400 --> 00:26:27,679
and we can also uh

00:26:26,320 --> 00:26:29,440
clearly see we need to make this a

00:26:27,679 --> 00:26:32,960
little bit bigger

00:26:29,440 --> 00:26:34,960
okay we can see how many rows we have

00:26:32,960 --> 00:26:36,799
we can see what the size is so if we do

00:26:34,960 --> 00:26:40,559
the number of rows here

00:26:36,799 --> 00:26:42,240
we have 400 000 rows in post meta so

00:26:40,559 --> 00:26:43,440
there is a lot of plug-in junk in there

00:26:42,240 --> 00:26:45,520
that we can probably rid of

00:26:43,440 --> 00:26:47,520
and then we can see here top 10 daily

00:26:45,520 --> 00:26:48,240
top 10 is a plug-in that this site is

00:26:47,520 --> 00:26:50,159
using

00:26:48,240 --> 00:26:51,279
and i happen to know that they have some

00:26:50,159 --> 00:26:52,880
settings to say

00:26:51,279 --> 00:26:54,400
cap the data in 30 days and then clear

00:26:52,880 --> 00:26:54,960
it out or calculate the weight and clear

00:26:54,400 --> 00:26:56,480
it out

00:26:54,960 --> 00:26:58,880
if you don't do that it stores it

00:26:56,480 --> 00:27:02,080
forever which is why we have

00:26:58,880 --> 00:27:03,600
100 000 rows instead of 20 000. so you

00:27:02,080 --> 00:27:04,559
can look at this and start to see where

00:27:03,600 --> 00:27:07,039
the problems are

00:27:04,559 --> 00:27:08,400
you can look at the size and again this

00:27:07,039 --> 00:27:11,120
is where i really want to look

00:27:08,400 --> 00:27:13,600
so we have 68 megabytes of stuff in

00:27:11,120 --> 00:27:13,600
posts

00:27:14,080 --> 00:27:17,360
we've already cleaned out and for this

00:27:15,840 --> 00:27:18,000
particular site and other revisions are

00:27:17,360 --> 00:27:19,760
clean

00:27:18,000 --> 00:27:21,200
and you can't do a whole lot about this

00:27:19,760 --> 00:27:21,679
table if it's already been cleaned out

00:27:21,200 --> 00:27:23,279
because

00:27:21,679 --> 00:27:24,640
you're posting your content you can't

00:27:23,279 --> 00:27:25,840
have less content on your website so

00:27:24,640 --> 00:27:27,279
that's something you have to live with

00:27:25,840 --> 00:27:29,840
and we just have to clean everything out

00:27:27,279 --> 00:27:32,159
around it so let's do some code on this

00:27:29,840 --> 00:27:33,679
and see what's going on in here

00:27:32,159 --> 00:27:35,840
and i definitely do not have this all

00:27:33,679 --> 00:27:36,399
memorized so we're going to copy paste a

00:27:35,840 --> 00:27:37,679
little bit

00:27:36,399 --> 00:27:40,000
and then i'm going to explain what i'm

00:27:37,679 --> 00:27:40,000
doing

00:27:41,760 --> 00:27:45,279
so let's get a look here

00:27:47,200 --> 00:27:51,039
and so you would click the sql tab so

00:27:49,039 --> 00:27:53,520
you can write actual code in here

00:27:51,039 --> 00:27:54,799
and um so what we're going to do here is

00:27:53,520 --> 00:27:56,480
select account

00:27:54,799 --> 00:27:58,240
and then you can say as this is going to

00:27:56,480 --> 00:27:59,520
be the name of your information so you

00:27:58,240 --> 00:28:03,039
know it is

00:27:59,520 --> 00:28:04,320
from the wp options table in this case

00:28:03,039 --> 00:28:06,240
they use a different prefix so we

00:28:04,320 --> 00:28:07,520
actually have to change our sql here

00:28:06,240 --> 00:28:09,120
so when you take these home make sure

00:28:07,520 --> 00:28:10,159
you are matching it to the actual prefix

00:28:09,120 --> 00:28:14,640
on your site

00:28:10,159 --> 00:28:16,880
so we're just going to do iu j a k o

00:28:14,640 --> 00:28:18,080
and we're going to look for anything

00:28:16,880 --> 00:28:20,320
that matches

00:28:18,080 --> 00:28:22,240
transient so uh if you use the light

00:28:20,320 --> 00:28:23,840
keyword in your query

00:28:22,240 --> 00:28:24,880
that means it's not going to do an exact

00:28:23,840 --> 00:28:25,679
match but it's going to look for a

00:28:24,880 --> 00:28:27,679
partial match

00:28:25,679 --> 00:28:29,039
so that allows us to look for keywords

00:28:27,679 --> 00:28:32,799
or terms within

00:28:29,039 --> 00:28:36,159
uh our information so hit go

00:28:32,799 --> 00:28:37,679
on that we have exactly one auto loading

00:28:36,159 --> 00:28:39,840
transit in the options table

00:28:37,679 --> 00:28:41,120
so this options table is clean that's

00:28:39,840 --> 00:28:43,919
great if you get

00:28:41,120 --> 00:28:45,440
2 000 rows then it's time to go in and

00:28:43,919 --> 00:28:45,840
probably delete some of those and figure

00:28:45,440 --> 00:28:47,600
out

00:28:45,840 --> 00:28:49,360
what is generating those transients it's

00:28:47,600 --> 00:28:50,480
probably woocommerce it's probably an

00:28:49,360 --> 00:28:53,360
old plug-in

00:28:50,480 --> 00:28:54,640
that left them behind so let's find

00:28:53,360 --> 00:28:57,120
something a little bit more

00:28:54,640 --> 00:28:58,240
interesting on this site let's go into

00:28:57,120 --> 00:28:59,679
the options table and see what's going

00:28:58,240 --> 00:29:01,840
on here

00:28:59,679 --> 00:29:02,960
so we can just hit browse here and a

00:29:01,840 --> 00:29:05,120
great way to get started

00:29:02,960 --> 00:29:06,960
is just to look at the database uh just

00:29:05,120 --> 00:29:08,799
put it up to a couple hundred rows and

00:29:06,960 --> 00:29:10,840
i know that the options table starts

00:29:08,799 --> 00:29:12,080
with about 250 rows so you can scroll

00:29:10,840 --> 00:29:14,080
down and

00:29:12,080 --> 00:29:15,760
see what's on the next page so here we

00:29:14,080 --> 00:29:17,840
have wp seo

00:29:15,760 --> 00:29:18,799
site map and again we're looking at the

00:29:17,840 --> 00:29:21,279
prefix here

00:29:18,799 --> 00:29:22,480
in this option name so i know wp seo

00:29:21,279 --> 00:29:23,360
that's not wordpress that's something to

00:29:22,480 --> 00:29:26,480
plug it at

00:29:23,360 --> 00:29:30,080
you can keep going down and here we get

00:29:26,480 --> 00:29:32,799
ecpt that's what we'll plug in to press

00:29:30,080 --> 00:29:34,399
that sounds like a plug-in also so again

00:29:32,799 --> 00:29:35,120
this is like where you have to do it

00:29:34,399 --> 00:29:36,799
yourself

00:29:35,120 --> 00:29:39,360
and google is your friend trying to

00:29:36,799 --> 00:29:41,360
figure out what plug-in added what data

00:29:39,360 --> 00:29:42,960
do i need it anymore this can't really

00:29:41,360 --> 00:29:45,360
be automated you have to go and look at

00:29:42,960 --> 00:29:48,399
it and make some decisions

00:29:45,360 --> 00:29:50,960
so i know one another one that's in here

00:29:48,399 --> 00:29:52,399
is uh pyre and i think that's from a

00:29:50,960 --> 00:29:53,840
page builder

00:29:52,399 --> 00:29:55,600
so we can let's let's check that out

00:29:53,840 --> 00:29:58,320
let's see what information we can get

00:29:55,600 --> 00:29:58,320
for that tire

00:29:59,760 --> 00:30:03,039
so i'm going to go back to sql around

00:30:01,279 --> 00:30:06,320
this query

00:30:03,039 --> 00:30:06,320
and we can just hit go

00:30:06,799 --> 00:30:10,880
so we have 45 rows uh from this pirate

00:30:10,080 --> 00:30:12,960
plug-in

00:30:10,880 --> 00:30:14,720
and so if we're not using that anymore

00:30:12,960 --> 00:30:16,240
and we want to delete them

00:30:14,720 --> 00:30:17,840
we can just switch that over from a

00:30:16,240 --> 00:30:18,960
select statement which is a search

00:30:17,840 --> 00:30:22,640
statement

00:30:18,960 --> 00:30:26,799
to a delete statement

00:30:22,640 --> 00:30:28,640
sql and something to do first is always

00:30:26,799 --> 00:30:29,679
run the select first don't delete

00:30:28,640 --> 00:30:30,240
something without knowing what you're

00:30:29,679 --> 00:30:31,760
deleting

00:30:30,240 --> 00:30:33,600
so we did our search we know exactly

00:30:31,760 --> 00:30:35,120
what we're going to get rid of uh we can

00:30:33,600 --> 00:30:36,080
hit simulate make sure we're getting the

00:30:35,120 --> 00:30:38,000
right thing

00:30:36,080 --> 00:30:39,200
match rows 45 that's what we got in our

00:30:38,000 --> 00:30:41,360
previous test

00:30:39,200 --> 00:30:43,600
so that's great uh let's just delete it

00:30:41,360 --> 00:30:45,360
from this database why not

00:30:43,600 --> 00:30:47,679
do you really want to do it sure we're

00:30:45,360 --> 00:30:49,520
ready to go

00:30:47,679 --> 00:30:51,840
okay great we deleted 45 rows from our

00:30:49,520 --> 00:30:51,840
database

00:30:52,159 --> 00:30:57,760
so let's go into post meta because that

00:30:54,559 --> 00:30:57,760
is a little bit trickier

00:30:59,440 --> 00:31:03,840
and here this is where we have about 400

00:31:02,159 --> 00:31:06,960
000 rows

00:31:03,840 --> 00:31:09,279
and one thing we can do in here

00:31:06,960 --> 00:31:10,399
post meta gives you the meta key so in

00:31:09,279 --> 00:31:12,080
the options table

00:31:10,399 --> 00:31:13,919
uh every option is going to have

00:31:12,080 --> 00:31:16,640
different values because each one is

00:31:13,919 --> 00:31:18,559
one option whereas in post meta everyone

00:31:16,640 --> 00:31:21,200
is going to be a particular

00:31:18,559 --> 00:31:21,760
a key for a value that goes on every

00:31:21,200 --> 00:31:24,240
post

00:31:21,760 --> 00:31:26,240
right so if you have uh this underscore

00:31:24,240 --> 00:31:27,840
wp attached file which might be

00:31:26,240 --> 00:31:29,840
the picture the featured image or

00:31:27,840 --> 00:31:30,240
something like that every post is going

00:31:29,840 --> 00:31:32,480
to have

00:31:30,240 --> 00:31:33,600
a medicaid with wp attach file and the

00:31:32,480 --> 00:31:35,039
value will change

00:31:33,600 --> 00:31:36,720
so if you have five thousand posts you

00:31:35,039 --> 00:31:37,200
would have five thousand this particular

00:31:36,720 --> 00:31:40,320
key

00:31:37,200 --> 00:31:40,720
so what we can do is see um what are the

00:31:40,320 --> 00:31:43,760
top

00:31:40,720 --> 00:31:44,320
menus what what medicaid are taking up

00:31:43,760 --> 00:31:45,760
space

00:31:44,320 --> 00:31:47,200
and that will tell us what plug-ins are

00:31:45,760 --> 00:31:48,159
causing us problems this is how you plan

00:31:47,200 --> 00:31:49,679
it post-method

00:31:48,159 --> 00:31:52,240
so we're going to use this gigantic

00:31:49,679 --> 00:31:53,360
statement over here

00:31:52,240 --> 00:31:55,200
so we're doing here is we're doing a

00:31:53,360 --> 00:31:56,080
search of meta keys we're going to count

00:31:55,200 --> 00:31:57,679
them

00:31:56,080 --> 00:32:00,000
we're going to get a sum of all the data

00:31:57,679 --> 00:32:02,399
by using the column names

00:32:00,000 --> 00:32:03,360
all contact pages and measure here we're

00:32:02,399 --> 00:32:04,720
going to group them

00:32:03,360 --> 00:32:06,559
by the meta key so we're going to get a

00:32:04,720 --> 00:32:07,840
quarter list uh we're going to order

00:32:06,559 --> 00:32:09,600
them by the size and

00:32:07,840 --> 00:32:11,039
descending order and then we're going to

00:32:09,600 --> 00:32:12,320
limit that to 10

00:32:11,039 --> 00:32:14,880
because otherwise it's going to give you

00:32:12,320 --> 00:32:16,399
your 500 different medicaids

00:32:14,880 --> 00:32:17,760
so it's a good idea when you're doing

00:32:16,399 --> 00:32:19,360
these kinds of searches to put in a

00:32:17,760 --> 00:32:20,399
limit so that your database isn't just

00:32:19,360 --> 00:32:21,840
spinning over and over

00:32:20,399 --> 00:32:23,120
you can see where the top five the top

00:32:21,840 --> 00:32:24,159
10 are that's where all your problems

00:32:23,120 --> 00:32:24,720
are going to be anyway you're not going

00:32:24,159 --> 00:32:26,320
to have

00:32:24,720 --> 00:32:28,000
20 different things that are all causing

00:32:26,320 --> 00:32:29,679
a problem i hope usually

00:32:28,000 --> 00:32:31,679
it's one or two plug-ins that's going to

00:32:29,679 --> 00:32:33,120
be 80 of your problem and you can just

00:32:31,679 --> 00:32:36,000
get rid of that so let's see what

00:32:33,120 --> 00:32:36,000
information we get here

00:32:36,799 --> 00:32:43,760
that's bad oh okay so we got an error

00:32:39,200 --> 00:32:47,679
because but then you run

00:32:43,760 --> 00:32:48,159
oh that's bad i always worked 10 minutes

00:32:47,679 --> 00:32:49,840
ago

00:32:48,159 --> 00:32:52,159
let's get rid of that and see if that

00:32:49,840 --> 00:32:52,159
helps

00:32:54,840 --> 00:32:57,840
also

00:33:04,480 --> 00:33:08,159
well this didn't work this is the

00:33:08,840 --> 00:33:11,840
dangerous

00:33:12,110 --> 00:33:15,400
[Music]

00:33:22,559 --> 00:33:25,919
and we can grab that directly and i know

00:33:24,240 --> 00:33:28,559
that will work

00:33:25,919 --> 00:33:29,679
so this is the uh the github repository

00:33:28,559 --> 00:33:32,720
that's me

00:33:29,679 --> 00:33:33,840
sorry about that but so you can you can

00:33:32,720 --> 00:33:35,360
go in here and

00:33:33,840 --> 00:33:36,799
get all the information that we are

00:33:35,360 --> 00:33:37,600
discussing i'm just going to zoom down

00:33:36,799 --> 00:33:42,080
here

00:33:37,600 --> 00:33:42,080
to post meta and get this information

00:33:43,360 --> 00:33:47,279
and so we're going to go back up here

00:33:45,360 --> 00:33:50,399
into let's just go back up here

00:33:47,279 --> 00:33:52,640
to the database sql and again i'm going

00:33:50,399 --> 00:33:57,519
to change the prefix

00:33:52,640 --> 00:33:58,640
from wp to iuj akdl

00:33:57,519 --> 00:34:06,720
and we'll see what this gives us

00:33:58,640 --> 00:34:09,839
hopefully this one works

00:34:06,720 --> 00:34:10,800
excellent so this is great because if

00:34:09,839 --> 00:34:12,560
you plug that in

00:34:10,800 --> 00:34:14,800
then you get a chart of what the biggest

00:34:12,560 --> 00:34:18,079
meta keys are and so here we have wp

00:34:14,800 --> 00:34:20,800
attachment metadata uh the underscore wp

00:34:18,079 --> 00:34:22,560
that means it's wordpress uh wp attached

00:34:20,800 --> 00:34:24,320
file so we would expect to have a lot of

00:34:22,560 --> 00:34:26,000
information for those because wordpress

00:34:24,320 --> 00:34:28,800
just fixed that into every page

00:34:26,000 --> 00:34:30,320
but seo smart cache uh that's from a

00:34:28,800 --> 00:34:32,639
plug-in that's something else

00:34:30,320 --> 00:34:34,960
same thing with radium post fuse count

00:34:32,639 --> 00:34:37,280
radium is not wordpress that's a plug-in

00:34:34,960 --> 00:34:38,960
so what we can do here is say okay these

00:34:37,280 --> 00:34:40,480
are the top 10 things that are taking up

00:34:38,960 --> 00:34:42,480
space in our database

00:34:40,480 --> 00:34:44,560
i know this is a plug-in i'm not using

00:34:42,480 --> 00:34:46,240
it anymore i want to delete it

00:34:44,560 --> 00:34:48,320
so you can go ahead and get rid of radio

00:34:46,240 --> 00:34:50,159
and clear those 14 000 rows

00:34:48,320 --> 00:34:51,359
and what you can do there is a really

00:34:50,159 --> 00:34:54,320
simple

00:34:51,359 --> 00:34:56,720
statement and you can just go back to

00:34:54,320 --> 00:34:59,680
sql

00:34:56,720 --> 00:35:01,280
and hit just delete from the table where

00:34:59,680 --> 00:35:03,680
the meta key is that

00:35:01,280 --> 00:35:05,200
all you have to do let's see okay so

00:35:03,680 --> 00:35:05,920
that's going to give us 14 000 like we

00:35:05,200 --> 00:35:07,119
saw before

00:35:05,920 --> 00:35:09,280
so we know we're deleting the right

00:35:07,119 --> 00:35:11,760
thing this is safe to do

00:35:09,280 --> 00:35:16,000
hit go yes we're sure please please

00:35:11,760 --> 00:35:18,560
don't break our site

00:35:16,000 --> 00:35:20,079
and it will delete those 14 000 lines so

00:35:18,560 --> 00:35:21,440
this is basically what you want to do is

00:35:20,079 --> 00:35:22,400
you want to get your ranked list of

00:35:21,440 --> 00:35:23,520
everything that's going on in your

00:35:22,400 --> 00:35:25,760
postpan table

00:35:23,520 --> 00:35:28,480
figure out what's fluff what's from

00:35:25,760 --> 00:35:29,680
plugins i'm not using anymore

00:35:28,480 --> 00:35:31,760
and the same thing with the options

00:35:29,680 --> 00:35:33,040
table figure out what's the plot what

00:35:31,760 --> 00:35:35,200
can i get rid of

00:35:33,040 --> 00:35:36,720
um and that's basically how to clean up

00:35:35,200 --> 00:35:38,560
your options table and you can

00:35:36,720 --> 00:35:40,240
customize these queries and and really

00:35:38,560 --> 00:35:42,960
get a lot of good information

00:35:40,240 --> 00:35:45,839
and uh that's the end of my talk and i

00:35:42,960 --> 00:35:45,839
can take some questions

00:35:50,720 --> 00:35:53,680
okay any questions

00:35:55,680 --> 00:35:59,280
i know we went from zero to 60 on this

00:35:57,280 --> 00:36:01,839
top so i hope you can all take away

00:35:59,280 --> 00:36:03,119
a really good theoretical basis for how

00:36:01,839 --> 00:36:05,680
this stuff works and then get at the

00:36:03,119 --> 00:36:05,680
application

00:36:08,800 --> 00:36:12,400
this might not have a lot to do with

00:36:10,400 --> 00:36:16,320
your talk but um

00:36:12,400 --> 00:36:18,640
with the uh my iceland and indodb

00:36:16,320 --> 00:36:20,000
tables what's your thinking of those

00:36:18,640 --> 00:36:22,000
going forward

00:36:20,000 --> 00:36:23,119
well so i'm not an expert on it but

00:36:22,000 --> 00:36:25,680
wordpress does use

00:36:23,119 --> 00:36:27,280
uh innodb as the default from wordpress

00:36:25,680 --> 00:36:30,079
i think 4.4 on

00:36:27,280 --> 00:36:31,119
uh just in my nco experience it is a

00:36:30,079 --> 00:36:32,800
little bit faster

00:36:31,119 --> 00:36:35,040
and it gives you some benefits as far as

00:36:32,800 --> 00:36:36,960
being able to back up with uh

00:36:35,040 --> 00:36:40,000
transactional stuff and have safer

00:36:36,960 --> 00:36:41,839
backups um so yeah definitely be using

00:36:40,000 --> 00:36:43,119
the more modern version and i think

00:36:41,839 --> 00:36:45,760
that's going to be the default on any

00:36:43,119 --> 00:36:47,599
new wordpress site you're setting up

00:36:45,760 --> 00:36:49,040
and generally it is pretty safe to

00:36:47,599 --> 00:36:52,079
convert if you're on

00:36:49,040 --> 00:36:52,880
mysql 5.6 so as always you know take it

00:36:52,079 --> 00:36:54,720
back up

00:36:52,880 --> 00:36:56,160
go in and change all the tables make

00:36:54,720 --> 00:36:57,440
sure you didn't break anything and

00:36:56,160 --> 00:37:00,160
yeah so i would definitely go ahead and

00:36:57,440 --> 00:37:00,160
modernize that

00:37:07,280 --> 00:37:13,839
all right so i'm wondering about

00:37:10,400 --> 00:37:15,440
moving a site to be internationalized

00:37:13,839 --> 00:37:17,520
you know if you had something with the

00:37:15,440 --> 00:37:18,640
just the the default encoding and you

00:37:17,520 --> 00:37:21,680
want to convert it to

00:37:18,640 --> 00:37:24,240
utf-8 is is there

00:37:21,680 --> 00:37:26,160
are there good commands you could use to

00:37:24,240 --> 00:37:27,359
like can you do that with just sql or do

00:37:26,160 --> 00:37:31,119
you have to do some sort of

00:37:27,359 --> 00:37:33,520
custom you know php code plus sql to

00:37:31,119 --> 00:37:34,400
convert your entire database no you can

00:37:33,520 --> 00:37:38,000
absolutely do it

00:37:34,400 --> 00:37:39,040
uh in sql and you can switch from utf-8

00:37:38,000 --> 00:37:41,040
to youtube

00:37:39,040 --> 00:37:43,040
mp4 or whatever you want yeah it's just

00:37:41,040 --> 00:37:44,960
a it's just a command and i think you do

00:37:43,040 --> 00:37:46,480
have to go table by cable

00:37:44,960 --> 00:37:48,160
because i just did this the other day it

00:37:46,480 --> 00:37:49,599
was a little bit aggravating you can

00:37:48,160 --> 00:37:52,640
actually just go in

00:37:49,599 --> 00:37:55,280
in mysql here or in phpmyadmin

00:37:52,640 --> 00:37:57,440
and you can go over to go into your

00:37:55,280 --> 00:37:59,920
table and hit operations

00:37:57,440 --> 00:38:01,200
and you can just switch that over in the

00:37:59,920 --> 00:38:04,079
storage engine

00:38:01,200 --> 00:38:04,560
or in the collation and you can put that

00:38:04,079 --> 00:38:07,440
over

00:38:04,560 --> 00:38:08,240
into you know whichever one of these you

00:38:07,440 --> 00:38:10,800
want to

00:38:08,240 --> 00:38:11,440
use and then you just hit go and you're

00:38:10,800 --> 00:38:13,359
all done

00:38:11,440 --> 00:38:14,800
so you can just do it that way there is

00:38:13,359 --> 00:38:16,079
some code into it which i don't know

00:38:14,800 --> 00:38:18,480
and but you can certainly just do it

00:38:16,079 --> 00:38:20,000
with a couple lines of code

00:38:18,480 --> 00:38:22,160
and just the thing to watch there that

00:38:20,000 --> 00:38:24,079
i've run into is if you have different

00:38:22,160 --> 00:38:24,720
versions of mysql that you're moving

00:38:24,079 --> 00:38:28,800
between

00:38:24,720 --> 00:38:30,960
5.5 5.6 for instance 5.6

00:38:28,800 --> 00:38:33,359
is not friendly with some of the new

00:38:30,960 --> 00:38:35,119
utf-8 mb4 or 5.5

00:38:33,359 --> 00:38:36,480
is not friendly with empty some of the

00:38:35,119 --> 00:38:38,320
me4 versions so

00:38:36,480 --> 00:38:39,760
you know just make sure you're saving

00:38:38,320 --> 00:38:41,359
everything everywhere make sure

00:38:39,760 --> 00:38:42,640
everything actually works in the right

00:38:41,359 --> 00:38:43,839
environment when you're moving things

00:38:42,640 --> 00:38:47,839
around

00:38:43,839 --> 00:38:47,839
and just going

00:38:51,760 --> 00:38:55,440
i was just wondering if you know the

00:38:53,040 --> 00:38:58,320
good plugin or easy method for

00:38:55,440 --> 00:38:59,119
routinely dumping revisions like i have

00:38:58,320 --> 00:39:00,800
a site where

00:38:59,119 --> 00:39:02,240
there's a lot of like editorial process

00:39:00,800 --> 00:39:03,200
that happens before goals are published

00:39:02,240 --> 00:39:04,960
but then when they're published or

00:39:03,200 --> 00:39:07,760
revisions aren't really needed

00:39:04,960 --> 00:39:08,079
anymore so something that like you know

00:39:07,760 --> 00:39:11,119
just

00:39:08,079 --> 00:39:12,240
does a regular job or a process

00:39:11,119 --> 00:39:13,839
was not like i've been plugged in for

00:39:12,240 --> 00:39:14,800
that or is that easiest just to do with

00:39:13,839 --> 00:39:17,359
the

00:39:14,800 --> 00:39:17,920
wordpress scheduled tasks in my sequel

00:39:17,359 --> 00:39:19,599
yeah

00:39:17,920 --> 00:39:21,359
you know uh there's a couple ways to

00:39:19,599 --> 00:39:23,280
deal with that one is that you can set

00:39:21,359 --> 00:39:26,800
the amount of revisions

00:39:23,280 --> 00:39:28,640
in wp config so you can set it to zero

00:39:26,800 --> 00:39:31,040
and not have any uh you can set it to

00:39:28,640 --> 00:39:32,640
three and so it never becomes a problem

00:39:31,040 --> 00:39:34,800
so that's one thing to just limit it

00:39:32,640 --> 00:39:36,160
from there as far as clearing it i don't

00:39:34,800 --> 00:39:37,599
know if there is a plugin that

00:39:36,160 --> 00:39:39,839
automatically clears it but

00:39:37,599 --> 00:39:42,640
what you could do is just write out the

00:39:39,839 --> 00:39:44,720
sql to delete revisions and just run it

00:39:42,640 --> 00:39:46,160
like with a cron job every day or

00:39:44,720 --> 00:39:47,920
every week or whatever it is or you

00:39:46,160 --> 00:39:49,920
could go in with

00:39:47,920 --> 00:39:52,560
wp optimize and just check that box and

00:39:49,920 --> 00:39:52,560
just do it once a

00:39:55,200 --> 00:39:59,280
uh week like leave the last week or last

00:39:57,680 --> 00:40:03,440
two weeks for the revisions

00:39:59,280 --> 00:40:11,839
uh also so yeah so that's great

00:40:03,440 --> 00:40:11,839
i think it's in the advanced settings

00:40:22,079 --> 00:40:24,960
how many days are

00:40:30,160 --> 00:40:33,520
excellent and yeah and you could write a

00:40:31,839 --> 00:40:35,200
query that just says

00:40:33,520 --> 00:40:37,599
look for stuff in the last that's older

00:40:35,200 --> 00:40:39,040
than you know date next and all that

00:40:37,599 --> 00:40:39,359
stuff out but yeah that's great that's

00:40:39,040 --> 00:40:42,319
an

00:40:39,359 --> 00:40:42,319
excellent plugin to use

00:40:43,200 --> 00:40:48,800
great any more all set all right good

00:40:45,680 --> 00:40:48,800
luck planning your databases thanks

00:40:50,839 --> 00:40:54,640
everybody

00:40:52,560 --> 00:40:54,640

YouTube URL: https://www.youtube.com/watch?v=oiEoStIzDjk


