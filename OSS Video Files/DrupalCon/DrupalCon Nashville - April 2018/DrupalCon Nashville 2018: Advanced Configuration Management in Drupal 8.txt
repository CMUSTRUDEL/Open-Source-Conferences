Title: DrupalCon Nashville 2018: Advanced Configuration Management in Drupal 8
Publication date: 2018-04-11
Playlist: DrupalCon Nashville - April 2018
Description: 
	In Drupal 8, Configuration Management is part of Core rather than relying on the Features module. However, in practice there are still many challenges remaining:

How to manage environment-specific or multi-site configuration (Config Split)
How to install sites using pre-defined configuration (Config Installer, Core patches)
How to create reusable configuration "templates" (Config Actions)
How to override configuration (Config Override vs Config Actions vs settings.php)
How to switch from a "Features-based" workflow to a more standard D8 config workflow.
This session will go through all of the above topics and discuss the various modules that are useful for managing configuration and give examples of real-life use-cases where these modules are needed.

Some basic knowledge of the Configuration Management system in Drupal 8 will be useful, but a brief overview will be provided at the beginning of the session.
Captions: 
	00:00:23,410 --> 00:00:29,119
all right I'm gonna get started right on

00:00:26,600 --> 00:00:31,369
time here because I always run long so I

00:00:29,119 --> 00:00:34,600
want to squeeze as much into this time

00:00:31,369 --> 00:00:36,830
as possible so hopefully you're here to

00:00:34,600 --> 00:00:39,379
hear about advanced configuration

00:00:36,830 --> 00:00:42,050
management in Drupal 8 first I have to

00:00:39,379 --> 00:00:43,550
apologize this is a intermediate session

00:00:42,050 --> 00:00:46,129
so I'm assuming some knowledge of

00:00:43,550 --> 00:00:48,410
configuration management but there is

00:00:46,129 --> 00:00:50,900
actually a beginners configuration

00:00:48,410 --> 00:00:52,460
management session tomorrow so kind of

00:00:50,900 --> 00:00:54,140
the wrong order so maybe even if you're

00:00:52,460 --> 00:00:55,940
a beginner sit through it try to absorb

00:00:54,140 --> 00:00:57,350
it go to the beginner one tomorrow and

00:00:55,940 --> 00:00:59,660
then maybe you can go back in time and

00:00:57,350 --> 00:01:01,340
remember this one and and you'll have

00:00:59,660 --> 00:01:04,100
the full thing otherwise watch watch the

00:01:01,340 --> 00:01:05,990
video is online so anyways if stuff does

00:01:04,100 --> 00:01:07,100
kind of go over and you're like what is

00:01:05,990 --> 00:01:10,430
he talking about there's a session

00:01:07,100 --> 00:01:14,060
tomorrow go to it it's it's going to be

00:01:10,430 --> 00:01:17,300
a good one we've already talked so I'm

00:01:14,060 --> 00:01:19,039
Mike Potter I'm the prime maintainer of

00:01:17,300 --> 00:01:21,289
the features module that some of you

00:01:19,039 --> 00:01:23,149
might have used also the architect of

00:01:21,289 --> 00:01:25,910
the atrium open atrium to distribution

00:01:23,149 --> 00:01:27,710
in Drupal 7 so I've been doing drupal

00:01:25,910 --> 00:01:30,500
for a long time now this is my tenth

00:01:27,710 --> 00:01:32,900
Drupal con and what I want to talk about

00:01:30,500 --> 00:01:34,670
today was a lot of topics around

00:01:32,900 --> 00:01:38,390
configuration management but not just

00:01:34,670 --> 00:01:40,549
the basic how you do it but what

00:01:38,390 --> 00:01:42,979
problems are people having and if you're

00:01:40,549 --> 00:01:44,720
at the Driss note this morning you heard

00:01:42,979 --> 00:01:46,189
Reese mention that one of the problems

00:01:44,720 --> 00:01:48,290
people are having with Drupal 8 is still

00:01:46,189 --> 00:01:51,560
configuration management even though

00:01:48,290 --> 00:01:53,420
it's great and it works pretty well we

00:01:51,560 --> 00:01:54,470
want to have some tweaks to it and so

00:01:53,420 --> 00:01:56,509
I'm going to talk about some of these

00:01:54,470 --> 00:01:58,310
things and how you do it today

00:01:56,509 --> 00:02:00,320
and knowing that some of these things

00:01:58,310 --> 00:02:03,590
are probably going to be addressed in

00:02:00,320 --> 00:02:05,540
the future by the CMI 2 initiative but

00:02:03,590 --> 00:02:07,100
this is more of a real-world you know

00:02:05,540 --> 00:02:10,310
for people actually building Drupal 8

00:02:07,100 --> 00:02:12,260
sites what problems do you actually run

00:02:10,310 --> 00:02:13,670
into in building really large Drupal

00:02:12,260 --> 00:02:15,440
sites around configuration management

00:02:13,670 --> 00:02:17,000
and how do you solve some of those so

00:02:15,440 --> 00:02:18,860
we're going to go really briefly through

00:02:17,000 --> 00:02:20,630
the core workflow then we're going to

00:02:18,860 --> 00:02:22,370
get into environment specific config

00:02:20,630 --> 00:02:25,489
we're going to talk about how you can

00:02:22,370 --> 00:02:27,170
install sites using config we're going

00:02:25,489 --> 00:02:28,579
to talk about how you override config

00:02:27,170 --> 00:02:31,459
I'm going to talk a little bit about

00:02:28,579 --> 00:02:32,730
features some other topics like

00:02:31,459 --> 00:02:34,709
templates and

00:02:32,730 --> 00:02:37,250
some other miscellaneous topics there at

00:02:34,709 --> 00:02:39,659
the end all right good

00:02:37,250 --> 00:02:42,780
so let's do a really quick review of

00:02:39,659 --> 00:02:44,700
config workflow in Drupal 8 core so in

00:02:42,780 --> 00:02:47,190
Drupal 8 core the first thing you do and

00:02:44,700 --> 00:02:49,470
and I here I'm talking about you know

00:02:47,190 --> 00:02:50,700
not initially what you do that Drupal

00:02:49,470 --> 00:02:52,650
tells you to do but what you do on a

00:02:50,700 --> 00:02:54,569
real site so hopefully all of you are

00:02:52,650 --> 00:02:56,819
building real sites this is probably

00:02:54,569 --> 00:02:58,260
your first step which is the whole idea

00:02:56,819 --> 00:03:00,060
of config management is you want to

00:02:58,260 --> 00:03:02,040
treat configures code so you've got to

00:03:00,060 --> 00:03:04,799
get your config into your code

00:03:02,040 --> 00:03:06,480
repository so you're gonna go into your

00:03:04,799 --> 00:03:08,849
settings dot PHP file and you're gonna

00:03:06,480 --> 00:03:11,160
tell Drupal where do you want the config

00:03:08,849 --> 00:03:12,420
to be stored because by default Drupal

00:03:11,160 --> 00:03:14,489
is going to put that in your files

00:03:12,420 --> 00:03:15,599
directory and your files directory is

00:03:14,489 --> 00:03:17,670
probably not something that you're

00:03:15,599 --> 00:03:18,690
checking in to your git repo right so

00:03:17,670 --> 00:03:20,160
you've got to get it out of your files

00:03:18,690 --> 00:03:21,540
directory put it somewhere else it

00:03:20,160 --> 00:03:23,190
doesn't really matter where you put it I

00:03:21,540 --> 00:03:25,530
like to stick it in just a top-level

00:03:23,190 --> 00:03:27,540
directory called config config slash

00:03:25,530 --> 00:03:28,890
default if you're on hosting where you

00:03:27,540 --> 00:03:31,799
need to put it like one level above that

00:03:28,890 --> 00:03:33,780
feel free it's your choice here but just

00:03:31,799 --> 00:03:36,180
someplace that you can then add to your

00:03:33,780 --> 00:03:39,780
git repository so that changes to that

00:03:36,180 --> 00:03:42,419
directory we'll get committed so make

00:03:39,780 --> 00:03:44,239
sure it's in your git repo so then what

00:03:42,419 --> 00:03:47,040
happens is on your development machine

00:03:44,239 --> 00:03:49,319
when you do and I'm gonna show a lot of

00:03:47,040 --> 00:03:51,269
examples for drush here and if you're a

00:03:49,319 --> 00:03:52,470
group or console user there's similar

00:03:51,269 --> 00:03:54,510
commands I just didn't go through an

00:03:52,470 --> 00:03:56,340
update on my slides too to put two

00:03:54,510 --> 00:03:57,780
things on every slide but if you're

00:03:56,340 --> 00:03:59,970
using brush and we're gonna be doing

00:03:57,780 --> 00:04:02,280
stuff on the command line rather than

00:03:59,970 --> 00:04:04,049
through the UI here Yusei config export

00:04:02,280 --> 00:04:05,970
and that's gonna take all of the config

00:04:04,049 --> 00:04:08,430
from your database and it's gonna write

00:04:05,970 --> 00:04:11,310
it as files as gamma files into that

00:04:08,430 --> 00:04:13,829
sync directory that you just set up and

00:04:11,310 --> 00:04:16,500
now you push that to your git repo and

00:04:13,829 --> 00:04:18,959
you go over to your you know make sure

00:04:16,500 --> 00:04:20,370
everything's looking good your review

00:04:18,959 --> 00:04:23,160
your changes go ahead and push that up

00:04:20,370 --> 00:04:25,919
and now you go on to your QA server and

00:04:23,160 --> 00:04:27,479
you do config import and it's going to

00:04:25,919 --> 00:04:29,849
take that same directory which you've

00:04:27,479 --> 00:04:32,099
just pulled from your git repo and it's

00:04:29,849 --> 00:04:34,650
going to load that config into your

00:04:32,099 --> 00:04:36,599
database and so now you've just moved

00:04:34,650 --> 00:04:38,669
your config from dev to stage and you do

00:04:36,599 --> 00:04:42,349
the same thing from stage to prod so

00:04:38,669 --> 00:04:42,349
basically you're gonna run config.xml

00:04:46,230 --> 00:04:50,820
- - help and see the details on it

00:04:48,680 --> 00:04:53,160
specifically you can give it an argument

00:04:50,820 --> 00:04:56,220
which is the label it defaults to

00:04:53,160 --> 00:04:57,870
default so that config / default

00:04:56,220 --> 00:05:00,300
directory when we set it up in our

00:04:57,870 --> 00:05:02,220
settings dot PHP you can set up

00:05:00,300 --> 00:05:05,190
additional directories if you want and

00:05:02,220 --> 00:05:08,730
then use that that key that you give in

00:05:05,190 --> 00:05:11,040
settings PHP as the label so for

00:05:08,730 --> 00:05:12,870
advanced things you might have maybe

00:05:11,040 --> 00:05:13,740
more than one config sync directory you

00:05:12,870 --> 00:05:16,830
can do it this way

00:05:13,740 --> 00:05:19,020
for example some people like to have a

00:05:16,830 --> 00:05:21,450
on their production environments maybe a

00:05:19,020 --> 00:05:23,550
read-only config directory and then a

00:05:21,450 --> 00:05:25,680
read/write config directory and so you

00:05:23,550 --> 00:05:27,750
can you know import from one export to

00:05:25,680 --> 00:05:29,870
the other that kind of stuff there are a

00:05:27,750 --> 00:05:33,090
lot of options on the dresse command for

00:05:29,870 --> 00:05:36,270
for doing get like stuff there's add

00:05:33,090 --> 00:05:38,370
commit and push my personal opinion is

00:05:36,270 --> 00:05:40,140
like just learn git and use git I don't

00:05:38,370 --> 00:05:41,790
try to like force everything into one

00:05:40,140 --> 00:05:43,200
giant dress command I kind of want to

00:05:41,790 --> 00:05:45,240
control my git and know what it's doing

00:05:43,200 --> 00:05:47,040
a little bit more so I don't use those

00:05:45,240 --> 00:05:49,950
but if you're comfortable with those go

00:05:47,040 --> 00:05:52,650
ahead then there's the configure import

00:05:49,950 --> 00:05:54,840
command takes the same label a couple

00:05:52,650 --> 00:05:56,610
interesting flags on this one if you

00:05:54,840 --> 00:05:58,650
actually want to see what's about to be

00:05:56,610 --> 00:06:00,090
changed normally when you do a config

00:05:58,650 --> 00:06:01,680
import it will give you a list of things

00:06:00,090 --> 00:06:03,330
they're gonna be changed and you type

00:06:01,680 --> 00:06:05,070
yes or no as to whether you want to

00:06:03,330 --> 00:06:07,320
import that or not sometimes you really

00:06:05,070 --> 00:06:08,850
want to know well what what changed my

00:06:07,320 --> 00:06:10,950
about to blow away like what's really

00:06:08,850 --> 00:06:13,440
going to change so you can do the - -

00:06:10,950 --> 00:06:15,390
preview diff and it will actually show

00:06:13,440 --> 00:06:17,460
you a diff of the config changes so you

00:06:15,390 --> 00:06:19,320
can say oh hey when I do this config

00:06:17,460 --> 00:06:21,480
import it's gonna change my site name or

00:06:19,320 --> 00:06:23,760
you know whatever it is so that's a

00:06:21,480 --> 00:06:25,080
really useful command another command

00:06:23,760 --> 00:06:28,590
I've seen people or another option I've

00:06:25,080 --> 00:06:32,730
seen people use is - - partial so be

00:06:28,590 --> 00:06:35,610
very careful what - - partial does is it

00:06:32,730 --> 00:06:37,830
will import config but if a file is

00:06:35,610 --> 00:06:40,650
missing config imports are only going to

00:06:37,830 --> 00:06:43,560
delete that config if you do - - partial

00:06:40,650 --> 00:06:45,120
it won't delete the config so I've seen

00:06:43,560 --> 00:06:47,310
some developers use this because they

00:06:45,120 --> 00:06:49,320
think it's somehow safer like although I

00:06:47,310 --> 00:06:51,150
you know I just created a content type

00:06:49,320 --> 00:06:53,670
and I need to pull my other devs code

00:06:51,150 --> 00:06:55,620
and I need to import it and I don't want

00:06:53,670 --> 00:06:56,969
to lose that content type that I'm in

00:06:55,620 --> 00:06:59,129
the middle of working on because

00:06:56,969 --> 00:07:00,749
you do a config import it's gonna blow

00:06:59,129 --> 00:07:03,149
away your entire config database right

00:07:00,749 --> 00:07:05,249
so they'll do a dash dash partial so it

00:07:03,149 --> 00:07:06,779
doesn't remove their stuff and the

00:07:05,249 --> 00:07:08,729
problem with doing that is now you're

00:07:06,779 --> 00:07:10,139
that same dev and now you say okay I've

00:07:08,729 --> 00:07:12,029
done my little hot fix I'm gonna do a

00:07:10,139 --> 00:07:13,739
config export well now you've not only

00:07:12,029 --> 00:07:15,299
exported your hot fix but you just

00:07:13,739 --> 00:07:16,559
exported that content type you were in

00:07:15,299 --> 00:07:17,339
the middle of working on that maybe

00:07:16,559 --> 00:07:19,289
isn't done yet

00:07:17,339 --> 00:07:21,419
and so if you're not careful with that

00:07:19,289 --> 00:07:23,879
next git commit you might just be

00:07:21,419 --> 00:07:25,619
committing code to your fellow devs that

00:07:23,879 --> 00:07:27,449
isn't ready yet or is broken or

00:07:25,619 --> 00:07:28,979
something like that so you know don't if

00:07:27,449 --> 00:07:31,499
you do this don't automatically do it

00:07:28,979 --> 00:07:34,799
get at all you know review your changes

00:07:31,499 --> 00:07:37,169
and this is just general good getting me

00:07:34,799 --> 00:07:40,439
its anyway right before you do a push

00:07:37,169 --> 00:07:42,360
you know review your changes so the one

00:07:40,439 --> 00:07:45,389
useful thing for partial however is

00:07:42,360 --> 00:07:47,909
sometimes you've got config in a single

00:07:45,389 --> 00:07:49,289
module you want to import a really great

00:07:47,909 --> 00:07:51,629
case for this is if you're playing with

00:07:49,289 --> 00:07:54,209
the migrate module and you're doing you

00:07:51,629 --> 00:07:55,889
know data migrations migrate module is

00:07:54,209 --> 00:07:56,399
all driven by a bunch of yamo config

00:07:55,889 --> 00:07:58,079
files

00:07:56,399 --> 00:07:59,339
so as you're debugging your migration

00:07:58,079 --> 00:08:02,459
you're going through and you're tweaking

00:07:59,339 --> 00:08:03,989
things but just changing the file in the

00:08:02,459 --> 00:08:05,429
your migrate module isn't going to do

00:08:03,989 --> 00:08:07,139
anything you've got to get that loaded

00:08:05,429 --> 00:08:09,149
into the database before the migrate

00:08:07,139 --> 00:08:12,269
module is gonna do it so here you can

00:08:09,149 --> 00:08:14,669
say - - partial - - source equals and

00:08:12,269 --> 00:08:16,709
then the path to your modules configure

00:08:14,669 --> 00:08:18,989
install directory and then that will

00:08:16,709 --> 00:08:20,879
read that config and update it so that

00:08:18,989 --> 00:08:23,159
might be your migrate module config for

00:08:20,879 --> 00:08:25,289
example so that's the one used for

00:08:23,159 --> 00:08:26,489
partial where you don't want it deleting

00:08:25,289 --> 00:08:29,069
things you just want it kind of

00:08:26,489 --> 00:08:30,869
overriding stuff if you're using

00:08:29,069 --> 00:08:32,939
features this is kind of the equivalent

00:08:30,869 --> 00:08:36,029
of doing a feature revert of one

00:08:32,939 --> 00:08:39,779
specific module okay

00:08:36,029 --> 00:08:41,430
so that's basic config workflow the

00:08:39,779 --> 00:08:43,199
headaches that are caused by config and

00:08:41,430 --> 00:08:46,589
the reason why we still are talking

00:08:43,199 --> 00:08:48,750
about config is you run into some some

00:08:46,589 --> 00:08:50,850
problems sometimes so the first thing to

00:08:48,750 --> 00:08:52,470
remember and and I think even in the

00:08:50,850 --> 00:08:55,050
intro talk they've talked about this

00:08:52,470 --> 00:08:57,389
config management in Drupal the config

00:08:55,050 --> 00:09:00,449
import config export it only works if

00:08:57,389 --> 00:09:02,250
your site IDs are identical so if I'm on

00:09:00,449 --> 00:09:04,680
a website if I want a Drupal site and I

00:09:02,250 --> 00:09:06,540
do a config export and I send that git

00:09:04,680 --> 00:09:08,190
repo to you and you do a poll and you

00:09:06,540 --> 00:09:09,870
try to import it

00:09:08,190 --> 00:09:13,170
it's gonna fail unless your Drupal site

00:09:09,870 --> 00:09:15,660
ID is the same as mine the site ID is

00:09:13,170 --> 00:09:17,190
actually a piece of config itself it's

00:09:15,660 --> 00:09:19,950
something that is set up when you

00:09:17,190 --> 00:09:21,930
install Drupal for the first time if you

00:09:19,950 --> 00:09:23,760
and I have installed Drupal separately

00:09:21,930 --> 00:09:24,960
we're gonna have two different uu IDs

00:09:23,760 --> 00:09:27,240
and we aren't gonna be able to share

00:09:24,960 --> 00:09:28,560
config so that can be a problem we'll

00:09:27,240 --> 00:09:31,170
talk about how to fix that a little

00:09:28,560 --> 00:09:33,000
later another problem is when you

00:09:31,170 --> 00:09:35,910
actually create config when you

00:09:33,000 --> 00:09:38,940
initially import config especially from

00:09:35,910 --> 00:09:41,910
a future if that config yamo file

00:09:38,940 --> 00:09:43,830
doesn't already have a UUID in it then

00:09:41,910 --> 00:09:45,840
Drupal is gonna create one randomly for

00:09:43,830 --> 00:09:47,850
you when you export something with

00:09:45,840 --> 00:09:50,700
features features are stripping out the

00:09:47,850 --> 00:09:52,740
UUID so if i send you a module that has

00:09:50,700 --> 00:09:54,510
config in it and you do an install of

00:09:52,740 --> 00:09:56,610
that module you're going to get that

00:09:54,510 --> 00:09:58,800
content type or fields or whatever is in

00:09:56,610 --> 00:10:00,630
that config if your other developer then

00:09:58,800 --> 00:10:01,860
installs that same module they'll get

00:10:00,630 --> 00:10:04,230
the same config but they'll have

00:10:01,860 --> 00:10:06,390
separate uu IDs and now when you start

00:10:04,230 --> 00:10:09,180
exporting importing each other's config

00:10:06,390 --> 00:10:11,340
what you'll find is it won't fail like

00:10:09,180 --> 00:10:13,230
the case or the site ID it's just always

00:10:11,340 --> 00:10:15,060
recreating it with different IDs and

00:10:13,230 --> 00:10:16,290
then when you export it wants to change

00:10:15,060 --> 00:10:18,540
it and so you're just always getting

00:10:16,290 --> 00:10:21,390
these changes in your git repo that are

00:10:18,540 --> 00:10:24,210
you UID changes so it's useful to be

00:10:21,390 --> 00:10:28,050
able to have the UID in the config so

00:10:24,210 --> 00:10:29,370
you all have consistent ones the other

00:10:28,050 --> 00:10:30,750
thing that causes people trouble the

00:10:29,370 --> 00:10:32,160
first time they start using config

00:10:30,750 --> 00:10:34,110
management is this whole idea that

00:10:32,160 --> 00:10:37,560
config import will actually delete stuff

00:10:34,110 --> 00:10:39,960
so if you delete a file you delete a

00:10:37,560 --> 00:10:42,030
content config file out of your config

00:10:39,960 --> 00:10:43,620
sync directory when you do config import

00:10:42,030 --> 00:10:46,110
it's gonna delete that content type

00:10:43,620 --> 00:10:48,180
where it's going to try to it will

00:10:46,110 --> 00:10:49,770
actually complain if you have content

00:10:48,180 --> 00:10:52,050
that exists so if you've already created

00:10:49,770 --> 00:10:54,750
like blog content and you delete the

00:10:52,050 --> 00:10:56,250
blog content type file it's actually

00:10:54,750 --> 00:10:57,980
going to give you an exception and it

00:10:56,250 --> 00:11:00,210
won't actually delete that for you

00:10:57,980 --> 00:11:02,790
fields however it will actually go ahead

00:11:00,210 --> 00:11:04,890
and delete field storages will delete

00:11:02,790 --> 00:11:07,020
leave orphan content behind in the

00:11:04,890 --> 00:11:08,520
database this could actually be good and

00:11:07,020 --> 00:11:10,200
bad sometimes like if you're trying to

00:11:08,520 --> 00:11:12,839
change something in the field storage

00:11:10,200 --> 00:11:15,150
like the cardinality you actually can

00:11:12,839 --> 00:11:17,460
delete that field storage and change the

00:11:15,150 --> 00:11:19,500
cardinality and restore the config and

00:11:17,460 --> 00:11:21,200
everything works and your contents all

00:11:19,500 --> 00:11:23,000
still there and it's all hunky-dory so

00:11:21,200 --> 00:11:24,350
sometimes it's useful that it doesn't

00:11:23,000 --> 00:11:26,600
warn you and that it actually retains

00:11:24,350 --> 00:11:30,470
content but just keep in mind you can

00:11:26,600 --> 00:11:32,209
actually delete stuff this way so how do

00:11:30,470 --> 00:11:34,700
we fix some of this stuff let's first

00:11:32,209 --> 00:11:36,740
talk about the first big reason why

00:11:34,700 --> 00:11:38,959
we're probably here which is how do we

00:11:36,740 --> 00:11:40,639
handle environment specific config and

00:11:38,959 --> 00:11:43,130
Driss talked about this in the keynote a

00:11:40,639 --> 00:11:45,410
little bit but this comes up whenever

00:11:43,130 --> 00:11:47,000
you're doing a large Drupal site that

00:11:45,410 --> 00:11:49,240
has multiple environments like your

00:11:47,000 --> 00:11:52,399
local dev your stage and your prod

00:11:49,240 --> 00:11:54,260
you've got different configuration and

00:11:52,399 --> 00:11:56,329
so you know you might have one thing

00:11:54,260 --> 00:11:57,560
enabled on your production server but

00:11:56,329 --> 00:11:58,850
like three said this morning you don't

00:11:57,560 --> 00:12:00,620
want to send emails to all your users

00:11:58,850 --> 00:12:02,690
you probably don't want to have your

00:12:00,620 --> 00:12:04,010
Google Analytics key on your dev

00:12:02,690 --> 00:12:05,959
environment because now you're polluting

00:12:04,010 --> 00:12:08,029
the clients Google Analytics page with

00:12:05,959 --> 00:12:10,130
your own testing you know lots of things

00:12:08,029 --> 00:12:12,649
like that so there's this great module

00:12:10,130 --> 00:12:16,040
called config split written by Fabian

00:12:12,649 --> 00:12:19,610
richer and it lets you split the config

00:12:16,040 --> 00:12:22,120
into different sink directories so when

00:12:19,610 --> 00:12:25,070
you do and it ties into the normal

00:12:22,120 --> 00:12:26,660
import/export mechanism so what we're

00:12:25,070 --> 00:12:29,750
going to talk about here is how this

00:12:26,660 --> 00:12:31,250
works so what you first do is you create

00:12:29,750 --> 00:12:33,230
a sink directory for each of those

00:12:31,250 --> 00:12:35,120
environments so you have normally the

00:12:33,230 --> 00:12:37,040
config default directory right which

00:12:35,120 --> 00:12:39,110
Drupal uses now you're going to create

00:12:37,040 --> 00:12:41,360
like a config dev a config stage a

00:12:39,110 --> 00:12:43,070
config prod like whatever a number of

00:12:41,360 --> 00:12:45,290
environments you have and you can have

00:12:43,070 --> 00:12:46,640
as many environments as you want after

00:12:45,290 --> 00:12:48,740
you've created the directories you go

00:12:46,640 --> 00:12:52,010
under the config split UI you enable the

00:12:48,740 --> 00:12:53,449
module and you create a what's called

00:12:52,010 --> 00:12:55,040
you create a split for each one of those

00:12:53,449 --> 00:12:57,440
directories so you create a dev split

00:12:55,040 --> 00:12:58,699
and the stage split and prod split make

00:12:57,440 --> 00:13:01,610
sure that they're all disabled by

00:12:58,699 --> 00:13:05,300
default so by default there's no active

00:13:01,610 --> 00:13:08,240
splits and then you export your full

00:13:05,300 --> 00:13:11,180
configuration just like normal and now

00:13:08,240 --> 00:13:13,160
in your settings PHP file you're going

00:13:11,180 --> 00:13:15,410
to tell config split what environment

00:13:13,160 --> 00:13:17,660
you're on so you're going to enable one

00:13:15,410 --> 00:13:18,980
of these splits so somehow some way you

00:13:17,660 --> 00:13:20,540
need to figure out what environment

00:13:18,980 --> 00:13:21,560
you're on so a lot of hosting companies

00:13:20,540 --> 00:13:23,779
they'll have like an environment

00:13:21,560 --> 00:13:25,310
variable you can check you know if you

00:13:23,779 --> 00:13:27,319
really have to you can check like the

00:13:25,310 --> 00:13:29,060
host name or something like that but

00:13:27,319 --> 00:13:30,949
somehow someway you need to figure out

00:13:29,060 --> 00:13:34,880
what environment you're on and enable

00:13:30,949 --> 00:13:37,010
that split then when you do the config

00:13:34,880 --> 00:13:39,560
korte it imports the normal default

00:13:37,010 --> 00:13:41,960
directory but it also will import the

00:13:39,560 --> 00:13:44,450
config from the split and it will merge

00:13:41,960 --> 00:13:45,890
the two together so you'll get all your

00:13:44,450 --> 00:13:47,420
default and then if you're on the prod

00:13:45,890 --> 00:13:48,560
environment you'll get the prod config

00:13:47,420 --> 00:13:51,290
if you're on the local environment

00:13:48,560 --> 00:13:53,330
you'll get your local config okay but it

00:13:51,290 --> 00:13:55,010
just ties into the whole import/export a

00:13:53,330 --> 00:13:56,750
mechanism so if you're already used to

00:13:55,010 --> 00:13:58,670
using configure important config export

00:13:56,750 --> 00:14:01,180
this becomes really seamless once you

00:13:58,670 --> 00:14:04,460
set it up it just works and it's great

00:14:01,180 --> 00:14:06,710
if you have to export just the config

00:14:04,460 --> 00:14:08,450
that goes into the split so like let's

00:14:06,710 --> 00:14:11,870
say you're using the devel module on

00:14:08,450 --> 00:14:14,570
your local dev server you can say config

00:14:11,870 --> 00:14:14,960
split export and it will just export

00:14:14,570 --> 00:14:17,270
that

00:14:14,960 --> 00:14:20,270
davell configure won't touch your config

00:14:17,270 --> 00:14:21,770
default directory so let's do this a

00:14:20,270 --> 00:14:23,030
little visually for people that want to

00:14:21,770 --> 00:14:25,820
see a picture so you've got your dev

00:14:23,030 --> 00:14:27,470
environment you do a config import that

00:14:25,820 --> 00:14:29,300
config um kourt's going to take your

00:14:27,470 --> 00:14:31,700
default directory your default Drupal

00:14:29,300 --> 00:14:33,410
config and it's gonna look in the local

00:14:31,700 --> 00:14:35,750
directory and it's gonna merge those to

00:14:33,410 --> 00:14:37,490
put that in the database so now your

00:14:35,750 --> 00:14:41,000
develop module is turned on everything

00:14:37,490 --> 00:14:42,710
else now you export that config it only

00:14:41,000 --> 00:14:44,960
is exporting the stuff to the config

00:14:42,710 --> 00:14:46,280
default directory but if you've changed

00:14:44,960 --> 00:14:49,310
like the site name or something you'll

00:14:46,280 --> 00:14:51,200
get that change now you go over to your

00:14:49,310 --> 00:14:52,910
QA or staging server you do a config

00:14:51,200 --> 00:14:55,280
import it's going to take that new

00:14:52,910 --> 00:14:56,480
updated default config but now it's

00:14:55,280 --> 00:14:58,550
going to merge in whatever is in the

00:14:56,480 --> 00:15:00,170
config stage directory and that might be

00:14:58,550 --> 00:15:02,120
your you know the solar server

00:15:00,170 --> 00:15:04,340
configuration for your staging server or

00:15:02,120 --> 00:15:06,800
something like that I mean now you could

00:15:04,340 --> 00:15:08,930
export that exports back to the config

00:15:06,800 --> 00:15:11,090
default and then on your production

00:15:08,930 --> 00:15:13,400
server it's merging the default with the

00:15:11,090 --> 00:15:15,320
production so as you go through it's

00:15:13,400 --> 00:15:20,000
just merging what is needed for each

00:15:15,320 --> 00:15:22,000
individual split so the config split has

00:15:20,000 --> 00:15:24,080
a couple concepts that take a little

00:15:22,000 --> 00:15:26,120
it's kind of jargony takes a little

00:15:24,080 --> 00:15:28,100
getting used to the first time they're

00:15:26,120 --> 00:15:30,260
trying to start to change the kind of UI

00:15:28,100 --> 00:15:32,060
and definitions here so this is kind of

00:15:30,260 --> 00:15:33,530
in flux but traditionally it's had

00:15:32,060 --> 00:15:35,990
something called a black list and a grey

00:15:33,530 --> 00:15:39,170
list and it gets confusing so a black

00:15:35,990 --> 00:15:41,150
list the paint line how you think of it

00:15:39,170 --> 00:15:42,950
it's actually a white list but it's

00:15:41,150 --> 00:15:45,260
called a black list but it's basically

00:15:42,950 --> 00:15:48,440
it's the module or config that you only

00:15:45,260 --> 00:15:50,930
want in the split so if you want to

00:15:48,440 --> 00:15:52,070
installed the devel module on your dev

00:15:50,930 --> 00:15:56,180
environment

00:15:52,070 --> 00:15:58,240
you put devel in the blacklist even

00:15:56,180 --> 00:15:59,900
though you want it enabled on

00:15:58,240 --> 00:16:02,330
development okay

00:15:59,900 --> 00:16:06,980
so like I said terminology is a little

00:16:02,330 --> 00:16:09,320
weird so when it exports the config the

00:16:06,980 --> 00:16:10,940
config doesn't go the config doesn't

00:16:09,320 --> 00:16:13,760
actually even exist in the default

00:16:10,940 --> 00:16:16,400
directory there is no develop it in the

00:16:13,760 --> 00:16:19,250
default directory it only exists in the

00:16:16,400 --> 00:16:21,260
split that you export it to the trick

00:16:19,250 --> 00:16:22,940
here also is config split will

00:16:21,260 --> 00:16:24,620
automatically enable the module 4 you

00:16:22,940 --> 00:16:26,960
don't mess around with the core

00:16:24,620 --> 00:16:29,120
extensions config don't try to get over

00:16:26,960 --> 00:16:31,220
smart and say I'm gonna put core

00:16:29,120 --> 00:16:33,260
extensions in my split and change it

00:16:31,220 --> 00:16:35,810
here and change it here the config split

00:16:33,260 --> 00:16:39,380
module handles module enabling for you

00:16:35,810 --> 00:16:41,830
so if it's in the blacklist config split

00:16:39,380 --> 00:16:44,780
will enable it when that split is

00:16:41,830 --> 00:16:48,350
imported so don't mess with core

00:16:44,780 --> 00:16:50,030
extensions in fact if you if you

00:16:48,350 --> 00:16:51,680
blacklist this is why it's called a

00:16:50,030 --> 00:16:53,330
blacklist if you put it in the blacklist

00:16:51,680 --> 00:16:54,830
the reason it's called that is it's

00:16:53,330 --> 00:16:56,840
actually removing it from core

00:16:54,830 --> 00:16:58,580
extensions so if you look at the core

00:16:56,840 --> 00:17:00,800
extensions that gets exported to the

00:16:58,580 --> 00:17:02,390
default directory it won't have the

00:17:00,800 --> 00:17:06,110
devel module in it right so it's been

00:17:02,390 --> 00:17:08,510
blacklisted from the default so then

00:17:06,110 --> 00:17:10,730
what's the gray list so the grey list is

00:17:08,510 --> 00:17:13,010
config that exists in both places

00:17:10,730 --> 00:17:14,959
it has config in the default directory

00:17:13,010 --> 00:17:17,199
and it has the same configure a

00:17:14,959 --> 00:17:19,339
different config in the split directory

00:17:17,199 --> 00:17:22,910
and so what happens when you do the

00:17:19,339 --> 00:17:25,100
import is if you have config in your

00:17:22,910 --> 00:17:26,089
split directory it overrides what's in

00:17:25,100 --> 00:17:28,670
the default directory

00:17:26,089 --> 00:17:30,080
so if I have site settings in both

00:17:28,670 --> 00:17:32,240
places with different site names

00:17:30,080 --> 00:17:35,540
whatever site name is in my split

00:17:32,240 --> 00:17:38,600
directory will take effect so it's in

00:17:35,540 --> 00:17:41,270
both places and if the split exists then

00:17:38,600 --> 00:17:43,820
it's override overridden it also won't

00:17:41,270 --> 00:17:46,370
delete it when it's exported so if it's

00:17:43,820 --> 00:17:49,610
in the grey list then you will always

00:17:46,370 --> 00:17:51,530
get a llamó file it will put it in the

00:17:49,610 --> 00:17:55,490
the default directory and it won't

00:17:51,530 --> 00:17:56,810
actually delete the config and it will

00:17:55,490 --> 00:17:58,820
only export that config if it's

00:17:56,810 --> 00:18:01,029
different so if I don't change my site

00:17:58,820 --> 00:18:03,339
name it just exports it to

00:18:01,029 --> 00:18:05,949
the default directory if I change my

00:18:03,339 --> 00:18:08,139
site name and I'm in a local environment

00:18:05,949 --> 00:18:11,469
it's going to export that difference to

00:18:08,139 --> 00:18:14,049
the local settings to the local sync

00:18:11,469 --> 00:18:15,639
directory so let's look at a real

00:18:14,049 --> 00:18:16,959
example so there was a lot of a lot of

00:18:15,639 --> 00:18:18,099
complex words there let's look at

00:18:16,959 --> 00:18:20,109
something real here and we've kind of

00:18:18,099 --> 00:18:21,759
talked about a little bit this let's say

00:18:20,109 --> 00:18:23,199
okay I'm dev we want the develop module

00:18:21,759 --> 00:18:25,419
like that's pretty common we probably

00:18:23,199 --> 00:18:27,189
all do this we've got a complicated

00:18:25,419 --> 00:18:28,869
server setup so we're doing solar

00:18:27,189 --> 00:18:30,999
searching of some sorts so we've got a

00:18:28,869 --> 00:18:33,519
solar config you know we're not going to

00:18:30,999 --> 00:18:35,409
use the clients production solar server

00:18:33,519 --> 00:18:37,059
for our little dev environment because

00:18:35,409 --> 00:18:38,439
we probably don't have all their content

00:18:37,059 --> 00:18:40,629
on our local environment we just got our

00:18:38,439 --> 00:18:41,949
our own stuff and we don't want changes

00:18:40,629 --> 00:18:43,479
we make locally to get pushed their

00:18:41,949 --> 00:18:45,429
solar server so we got our own config

00:18:43,479 --> 00:18:47,679
and let's say we changed the site name

00:18:45,429 --> 00:18:49,329
to dev because we really want to know

00:18:47,679 --> 00:18:50,739
like when we're working on it that we're

00:18:49,329 --> 00:18:52,239
not messing with production we're

00:18:50,739 --> 00:18:55,089
working on our dev server so we've got a

00:18:52,239 --> 00:18:57,669
different site name and then on our

00:18:55,089 --> 00:18:59,079
staging QA server we're going to do some

00:18:57,669 --> 00:19:00,999
other things maybe we've got the shield

00:18:59,079 --> 00:19:02,619
module here because we're we're enabling

00:19:00,999 --> 00:19:04,209
the QA servers in the clients

00:19:02,619 --> 00:19:06,969
environment we don't necessarily want

00:19:04,209 --> 00:19:08,739
everyone in the clients organization to

00:19:06,969 --> 00:19:10,659
be looking at our new server yet because

00:19:08,739 --> 00:19:12,099
they haven't launched it so we're gonna

00:19:10,659 --> 00:19:14,409
put the shield module on there to kind

00:19:12,099 --> 00:19:16,809
of password protect the site so we've

00:19:14,409 --> 00:19:18,609
got a username password config and

00:19:16,809 --> 00:19:22,359
they've got their own solar server for

00:19:18,609 --> 00:19:23,919
testing on the stage QA server and then

00:19:22,359 --> 00:19:25,329
on production we don't have the shield

00:19:23,919 --> 00:19:26,859
module we want it to be available to

00:19:25,329 --> 00:19:29,949
everybody and now we're using the

00:19:26,859 --> 00:19:31,569
production solar configuration so lots

00:19:29,949 --> 00:19:33,249
of configuration changes right and with

00:19:31,569 --> 00:19:33,849
cork and fig management you couldn't do

00:19:33,249 --> 00:19:37,449
any of this

00:19:33,849 --> 00:19:39,219
you need config split for it so here's

00:19:37,449 --> 00:19:40,389
the config split UI and I know you can't

00:19:39,219 --> 00:19:42,759
read it especially with all the glare

00:19:40,389 --> 00:19:43,989
you can't read probably any of this but

00:19:42,759 --> 00:19:45,579
I did want to step you through it feel

00:19:43,989 --> 00:19:47,349
free to watch the video afterwards and

00:19:45,579 --> 00:19:50,019
zoom in and do whatever you need to do

00:19:47,349 --> 00:19:52,239
but I did take a screenshot of what the

00:19:50,019 --> 00:19:54,009
dev split looks like so the first thing

00:19:52,239 --> 00:19:56,379
is the label which is just your machine

00:19:54,009 --> 00:19:58,419
name called dev then it wants to know

00:19:56,379 --> 00:19:59,919
what folder you're putting it into so

00:19:58,419 --> 00:20:02,499
you can again use whatever folder name

00:19:59,919 --> 00:20:04,479
you want I usually use config slash the

00:20:02,499 --> 00:20:07,839
name of my split so in this case it's

00:20:04,479 --> 00:20:10,690
config slash dev notice that the active

00:20:07,839 --> 00:20:12,159
flag is not enabled so you leave these

00:20:10,690 --> 00:20:12,590
disabled in the UI because you're gonna

00:20:12,159 --> 00:20:16,010
a

00:20:12,590 --> 00:20:17,840
pull it through settings.php then the

00:20:16,010 --> 00:20:20,390
next comes the blacklist which they now

00:20:17,840 --> 00:20:22,250
have renamed in the UI it's called the

00:20:20,390 --> 00:20:24,320
complete split and I'm not sure that's

00:20:22,250 --> 00:20:26,510
any better but at least it's different

00:20:24,320 --> 00:20:28,159
and it will say down there and really

00:20:26,510 --> 00:20:31,400
fine print at the very bottom it says

00:20:28,159 --> 00:20:33,950
the complete split slash blacklist

00:20:31,400 --> 00:20:35,450
listed Lee here will be removed from the

00:20:33,950 --> 00:20:37,130
sync directory and so it actually

00:20:35,450 --> 00:20:38,299
explains if you just read the screen

00:20:37,130 --> 00:20:39,860
which I know some of us don't do

00:20:38,299 --> 00:20:41,390
sometimes it actually explains

00:20:39,860 --> 00:20:44,090
everything it's doing it's the UI is

00:20:41,390 --> 00:20:45,679
actually very nicely verbose if you read

00:20:44,090 --> 00:20:48,529
it and what we're doing here is we're

00:20:45,679 --> 00:20:50,690
saying we want the module devel to be

00:20:48,529 --> 00:20:52,899
enabled in this split so we stick it in

00:20:50,690 --> 00:20:55,730
the modules list but then we have

00:20:52,899 --> 00:20:57,559
special config we have our solar server

00:20:55,730 --> 00:20:59,809
so you have to figure out what the name

00:20:57,559 --> 00:21:02,330
of your solar configuration is in this

00:20:59,809 --> 00:21:04,659
case it's you know search underscore API

00:21:02,330 --> 00:21:06,890
dot server using the Search API module

00:21:04,659 --> 00:21:10,100
whatever your solar service so we want

00:21:06,890 --> 00:21:11,899
that configuration to be active for this

00:21:10,100 --> 00:21:15,110
split and we're gonna have a different

00:21:11,899 --> 00:21:16,880
file for each environment and then if

00:21:15,110 --> 00:21:18,620
you keep scrolling on the UI these are

00:21:16,880 --> 00:21:20,120
all one page I'm just splitting this on

00:21:18,620 --> 00:21:22,250
two pages so we can read it but it's one

00:21:20,120 --> 00:21:24,260
long page so then we have the grey list

00:21:22,250 --> 00:21:26,870
which is now called conditional split

00:21:24,260 --> 00:21:29,600
and in the grey list we have a different

00:21:26,870 --> 00:21:31,520
site name site name exists whether this

00:21:29,600 --> 00:21:32,840
split is on or not right so here this is

00:21:31,520 --> 00:21:34,940
the case of the grey list we're just

00:21:32,840 --> 00:21:37,309
going to override the site name with the

00:21:34,940 --> 00:21:38,870
dev site name and then down there we

00:21:37,309 --> 00:21:41,840
tell it to only split when it's

00:21:38,870 --> 00:21:44,450
different so when you go ahead and do

00:21:41,840 --> 00:21:46,490
your config import or config export

00:21:44,450 --> 00:21:49,520
here's the kind of directory structure

00:21:46,490 --> 00:21:51,440
you get so when your config your config

00:21:49,520 --> 00:21:53,059
default directory that's the big long

00:21:51,440 --> 00:21:55,220
huge directory that has everything in it

00:21:53,059 --> 00:21:57,289
so there's a lot of dot dot dots but

00:21:55,220 --> 00:21:59,120
you'll see that system dot site is in

00:21:57,289 --> 00:22:01,970
there that has your default site name

00:21:59,120 --> 00:22:04,390
and then in the dev split you've got

00:22:01,970 --> 00:22:07,850
whatever config the devel module needs

00:22:04,390 --> 00:22:10,669
then you've got your solar server config

00:22:07,850 --> 00:22:13,399
your solar server config does not exist

00:22:10,669 --> 00:22:14,779
in the default directory it only exists

00:22:13,399 --> 00:22:16,630
in these split directories because it

00:22:14,779 --> 00:22:19,100
specifically marked in the blacklist and

00:22:16,630 --> 00:22:20,809
then system dot site that's where you're

00:22:19,100 --> 00:22:22,880
overridden site name it for Diwali is

00:22:20,809 --> 00:22:25,020
and then on your stage server you've got

00:22:22,880 --> 00:22:26,490
its solar API certain

00:22:25,020 --> 00:22:28,290
see I solar server config and then

00:22:26,490 --> 00:22:30,570
you've got the shield settings that have

00:22:28,290 --> 00:22:32,160
your username password and then for

00:22:30,570 --> 00:22:34,800
production finally you just have the

00:22:32,160 --> 00:22:37,650
solar server for production so you'll

00:22:34,800 --> 00:22:39,360
notice that the this Search API file

00:22:37,650 --> 00:22:41,070
names are the same for each one but if

00:22:39,360 --> 00:22:43,320
you looked in each of those files and

00:22:41,070 --> 00:22:45,270
you looked at the yamo files you no

00:22:43,320 --> 00:22:47,130
one's gonna have the hostname for your

00:22:45,270 --> 00:22:48,960
local servers for solar one's going to

00:22:47,130 --> 00:22:50,400
have your your staging in solar ones

00:22:48,960 --> 00:22:51,510
going to have your production solar so

00:22:50,400 --> 00:22:53,100
the contents of those files are

00:22:51,510 --> 00:22:54,870
different and when you do a config

00:22:53,100 --> 00:22:56,880
import it's just gonna merge whatever it

00:22:54,870 --> 00:22:58,590
needs so you'll notice that core

00:22:56,880 --> 00:23:01,080
extensions doesn't show up in any of the

00:22:58,590 --> 00:23:04,110
splits core extension is still in your

00:23:01,080 --> 00:23:05,880
default directory your system sites

00:23:04,110 --> 00:23:15,630
great listed so it shows up in those two

00:23:05,880 --> 00:23:21,110
places your developer key figures in all

00:23:15,630 --> 00:23:23,010
three okay so that's config split so

00:23:21,110 --> 00:23:24,360
hopefully that makes sense I'll take

00:23:23,010 --> 00:23:25,890
questions at the end I want to kind of

00:23:24,360 --> 00:23:27,290
get done but I'm happy to answer

00:23:25,890 --> 00:23:29,460
questions at the end

00:23:27,290 --> 00:23:31,110
ok so let's switch gear so that tells

00:23:29,460 --> 00:23:33,559
you how to do environment specific stuff

00:23:31,110 --> 00:23:36,870
and by the way this is this can be taken

00:23:33,559 --> 00:23:39,660
amazingly far you can have more than one

00:23:36,870 --> 00:23:41,429
split enabled so I gave you the simple

00:23:39,660 --> 00:23:42,480
case of environment right you're not

00:23:41,429 --> 00:23:44,880
going to have more than one environment

00:23:42,480 --> 00:23:47,880
enabled at a time but you can have other

00:23:44,880 --> 00:23:50,100
splits for example when we did the

00:23:47,880 --> 00:23:51,090
weight watchers site may have an

00:23:50,100 --> 00:23:53,390
interesting situation where it's a

00:23:51,090 --> 00:23:56,910
multilingual site that they wanted

00:23:53,390 --> 00:23:57,809
multi-site by country countries have

00:23:56,910 --> 00:24:00,000
more than one language

00:23:57,809 --> 00:24:07,830
right so for Canada for example they

00:24:00,000 --> 00:24:09,630
needed to English and French enabled so

00:24:07,830 --> 00:24:11,880
they created split directories free xx

00:24:09,630 --> 00:24:13,380
which and so if you're on the Canada

00:24:11,880 --> 00:24:17,690
site they enable both the English and

00:24:13,380 --> 00:24:17,690
the French with config split

00:24:20,770 --> 00:24:28,670
sorry for my cough okay let's talk about

00:24:24,950 --> 00:24:30,080
installing from config so one thing

00:24:28,670 --> 00:24:32,870
that's really useful to be able to do on

00:24:30,080 --> 00:24:35,320
projects with lots of developers is all

00:24:32,870 --> 00:24:37,910
install the same site with the same UID

00:24:35,320 --> 00:24:39,770
like we talked about if I do an install

00:24:37,910 --> 00:24:41,810
you do an install we're gonna have non

00:24:39,770 --> 00:24:47,810
matching you IDs and we can't import an

00:24:41,810 --> 00:24:50,060
export so there's been a couple ways to

00:24:47,810 --> 00:24:52,310
do this the way I'm going to talk about

00:24:50,060 --> 00:24:58,550
here is using something called the

00:24:52,310 --> 00:24:59,750
configure installer profile so the

00:24:58,550 --> 00:25:01,160
config installer profile you can get

00:24:59,750 --> 00:25:04,700
from drupal.org you can get it with

00:25:01,160 --> 00:25:06,590
composer basically what you do is you go

00:25:04,700 --> 00:25:08,330
make sure your config sync is in your

00:25:06,590 --> 00:25:12,650
settings dot PHP which it should be

00:25:08,330 --> 00:25:14,360
already anyway and then via the UI you

00:25:12,650 --> 00:25:16,520
can do a normal Drupal install and it

00:25:14,360 --> 00:25:19,280
will prompt you for either the location

00:25:16,520 --> 00:25:19,790
of that config sync directory or for a

00:25:19,280 --> 00:25:21,890
tarball

00:25:19,790 --> 00:25:24,170
that contains you know at our version of

00:25:21,890 --> 00:25:26,510
that config sync directory if you're

00:25:24,170 --> 00:25:28,610
doing dress and you do a site install

00:25:26,510 --> 00:25:30,080
via the site install command and you

00:25:28,610 --> 00:25:32,420
give it config installer as the profile

00:25:30,080 --> 00:25:34,100
name it will install using the location

00:25:32,420 --> 00:25:36,290
that you gave it for the config sync

00:25:34,100 --> 00:25:39,110
directory there so what is this do this

00:25:36,290 --> 00:25:41,150
installs Drupal and then it

00:25:39,110 --> 00:25:44,060
automatically does a config import of

00:25:41,150 --> 00:25:46,150
the config sync directory so when you're

00:25:44,060 --> 00:25:48,620
done what you have is whatever site you

00:25:46,150 --> 00:25:50,300
exported so whatever site you know you

00:25:48,620 --> 00:25:52,190
work on your site you get it all working

00:25:50,300 --> 00:25:54,140
you create all your content types you

00:25:52,190 --> 00:25:56,960
create all your fields you do a config

00:25:54,140 --> 00:25:58,610
export it's in your git repo you take

00:25:56,960 --> 00:26:00,230
that config sync directory and you

00:25:58,610 --> 00:26:02,330
install it using the config installer

00:26:00,230 --> 00:26:04,340
profile when this is done you'll now

00:26:02,330 --> 00:26:06,950
have a clean Drupal site with no content

00:26:04,340 --> 00:26:08,510
but all of your config so you'll have

00:26:06,950 --> 00:26:12,110
all your content types all your fields

00:26:08,510 --> 00:26:14,210
all your views everything else there the

00:26:12,110 --> 00:26:16,850
way it does this is really clean it

00:26:14,210 --> 00:26:18,980
ensures that your site you UID matches

00:26:16,850 --> 00:26:21,020
whatever was in the config export

00:26:18,980 --> 00:26:23,570
directory so you don't get a new random

00:26:21,020 --> 00:26:26,060
ID you get the one that was in your sync

00:26:23,570 --> 00:26:28,040
directory so if you do a config install

00:26:26,060 --> 00:26:30,110
with this and I do a config install with

00:26:28,040 --> 00:26:32,250
this we both now have matching inside

00:26:30,110 --> 00:26:34,860
IDs and we have matching config

00:26:32,250 --> 00:26:36,990
these it also actually works properly

00:26:34,860 --> 00:26:41,220
with if you're installing your own

00:26:36,990 --> 00:26:44,400
profile your profile name is a piece of

00:26:41,220 --> 00:26:46,610
config it's in the system sites config

00:26:44,400 --> 00:26:49,980
directory so let's say I'm installing

00:26:46,610 --> 00:26:51,930
you know I don't know open atrium which

00:26:49,980 --> 00:26:54,060
doesn't exist in d8 I know but it's my

00:26:51,930 --> 00:26:56,160
favorite profile when I'm done with

00:26:54,060 --> 00:26:58,950
config installer and I go look at what

00:26:56,160 --> 00:27:00,600
profile my sites using it no longer says

00:26:58,950 --> 00:27:02,340
that it's using config installer it's

00:27:00,600 --> 00:27:03,780
now says that it's using atrium or

00:27:02,340 --> 00:27:05,790
lightning is probably a better example

00:27:03,780 --> 00:27:07,530
if you install a lightning site with

00:27:05,790 --> 00:27:09,450
this when you're done it will actually

00:27:07,530 --> 00:27:15,210
say that your profiles lightning not

00:27:09,450 --> 00:27:17,250
config installer on any configuration

00:27:15,210 --> 00:27:19,620
that profile installed would be

00:27:17,250 --> 00:27:22,050
installed now - so it looks just like

00:27:19,620 --> 00:27:24,540
you've got a clone of whatever that site

00:27:22,050 --> 00:27:28,620
was so it's a really clean and easy way

00:27:24,540 --> 00:27:29,460
now to clone sites from config this is

00:27:28,620 --> 00:27:35,340
something else that you're probably

00:27:29,460 --> 00:27:36,900
gonna see moving up to core very soon so

00:27:35,340 --> 00:27:39,990
there's the issue or there's the of the

00:27:36,900 --> 00:27:41,520
project URL now there was a way to do

00:27:39,990 --> 00:27:42,840
this before I talked about this when I

00:27:41,520 --> 00:27:45,210
gave this talk a little bit last summer

00:27:42,840 --> 00:27:47,910
before the config installer project was

00:27:45,210 --> 00:27:49,980
really ready so I know some people are

00:27:47,910 --> 00:27:51,870
still doing this there's basically if

00:27:49,980 --> 00:27:53,520
you have your own custom profile if

00:27:51,870 --> 00:27:57,390
you've created a profile for the client

00:27:53,520 --> 00:28:00,360
in your profiles info file you can add a

00:27:57,390 --> 00:28:02,130
key called config install give it the

00:28:00,360 --> 00:28:04,470
path to your config sync directory and

00:28:02,130 --> 00:28:07,140
then with this patch that I linked down

00:28:04,470 --> 00:28:09,630
here to Drupal 8 you can then do address

00:28:07,140 --> 00:28:12,000
site and install of that custom profile

00:28:09,630 --> 00:28:13,590
so if I'm building the site for like the

00:28:12,000 --> 00:28:15,330
NBA or something and I have an NBA

00:28:13,590 --> 00:28:17,400
profile I can say dress site installer

00:28:15,330 --> 00:28:19,440
be a profile and with that patch it will

00:28:17,400 --> 00:28:21,420
go load the config from that config

00:28:19,440 --> 00:28:22,920
scene directory this is the issue we're

00:28:21,420 --> 00:28:25,440
kind of a lot of the work that went into

00:28:22,920 --> 00:28:28,500
config installer was done this is I

00:28:25,440 --> 00:28:30,300
think pretty much deprecated now the

00:28:28,500 --> 00:28:31,980
config installer is working well but

00:28:30,300 --> 00:28:34,530
this will also ensure that your site uu

00:28:31,980 --> 00:28:37,350
IDs are the same because the problem is

00:28:34,530 --> 00:28:39,390
if you just do if you like install

00:28:37,350 --> 00:28:41,730
standard or install minimal and then do

00:28:39,390 --> 00:28:43,470
a config import that's not going to work

00:28:41,730 --> 00:28:44,250
because your site IDs not going to be

00:28:43,470 --> 00:28:46,200
set properly

00:28:44,250 --> 00:28:48,930
any config created by the profiles not

00:28:46,200 --> 00:28:50,430
going to get created properly the other

00:28:48,930 --> 00:28:53,870
thing I've seen people do is there's a

00:28:50,430 --> 00:28:55,860
dress shop ssin called - - config der

00:28:53,870 --> 00:28:58,740
where when you're doing your site

00:28:55,860 --> 00:29:01,380
install again of a of a profile you can

00:28:58,740 --> 00:29:02,820
specify where you configure stored the

00:29:01,380 --> 00:29:04,530
problem with this is it also has

00:29:02,820 --> 00:29:06,990
problems with config created by the

00:29:04,530 --> 00:29:09,780
profile and it's being deprecated for

00:29:06,990 --> 00:29:11,640
address 9 so trying if you're using this

00:29:09,780 --> 00:29:16,290
try to get away from it

00:29:11,640 --> 00:29:18,540
try the config installer profile ok if

00:29:16,290 --> 00:29:20,460
you really have to if you're in a bind

00:29:18,540 --> 00:29:24,210
and you've got two sites with different

00:29:20,460 --> 00:29:26,310
IDs you can make them the same so you go

00:29:24,210 --> 00:29:30,150
look in your system site that config

00:29:26,310 --> 00:29:32,190
file and you'll see the very first live

00:29:30,150 --> 00:29:36,180
is your site UUID and it's that long

00:29:32,190 --> 00:29:39,660
string so you can copy that and you can

00:29:36,180 --> 00:29:41,700
paste it into a dress config set so now

00:29:39,660 --> 00:29:46,110
you go to your other site you do dress

00:29:41,700 --> 00:29:49,080
config set system that site you ID paste

00:29:46,110 --> 00:29:50,730
in that long string say yes and now

00:29:49,080 --> 00:29:53,820
you've just made that site have the same

00:29:50,730 --> 00:29:55,500
ID as your first site definitely doable

00:29:53,820 --> 00:29:58,980
if you then have to do it config imports

00:29:55,500 --> 00:30:01,860
to make that the same ok another

00:29:58,980 --> 00:30:03,630
question I get a lot is when do you do

00:30:01,860 --> 00:30:05,360
it sniffing import and when do you run

00:30:03,630 --> 00:30:09,150
updates and what order do you run them

00:30:05,360 --> 00:30:11,520
so the order to do things is let's say

00:30:09,150 --> 00:30:13,440
you've got some changes to bring in you

00:30:11,520 --> 00:30:15,270
do a git pull to pull in all your code

00:30:13,440 --> 00:30:16,800
changes including your config I know I

00:30:15,270 --> 00:30:18,660
need to update the dress support right

00:30:16,800 --> 00:30:20,460
now it only supports dress 8 I'm sorry

00:30:18,660 --> 00:30:24,840
so if you've already upgraded to dress 9

00:30:20,460 --> 00:30:30,000
now the dress commands will work ok this

00:30:24,840 --> 00:30:32,940
is a whole separate problem yes yes I

00:30:30,000 --> 00:30:35,220
know ok so I've got a few minutes left

00:30:32,940 --> 00:30:36,630
here before Q&A I just wanted to cover

00:30:35,220 --> 00:30:39,390
cutting I have a couple little tips and

00:30:36,630 --> 00:30:42,000
tricks that I've run into this is by no

00:30:39,390 --> 00:30:44,090
means all of them I'm sure you will tell

00:30:42,000 --> 00:30:46,230
me your stories of your config horror

00:30:44,090 --> 00:30:47,690
but just after building lots of sites

00:30:46,230 --> 00:30:49,830
these are things that come up sometimes

00:30:47,690 --> 00:30:51,800
remember in the old features days where

00:30:49,830 --> 00:30:54,300
a feature was stuck as being overridden

00:30:51,800 --> 00:30:56,060
anybody run into that no matter what you

00:30:54,300 --> 00:30:57,290
did it just always said over in

00:30:56,060 --> 00:30:58,970
well we still kind of have that in

00:30:57,290 --> 00:31:00,080
Drupal 8 like Drupal 8 hasn't like

00:30:58,970 --> 00:31:02,750
magically solved all the world's

00:31:00,080 --> 00:31:04,850
problems they're just different you can

00:31:02,750 --> 00:31:08,450
have something where every time you do a

00:31:04,850 --> 00:31:11,090
config export it exports it again and

00:31:08,450 --> 00:31:12,770
you're like wait it's it's the same are

00:31:11,090 --> 00:31:14,090
you exporting the game like you imported

00:31:12,770 --> 00:31:15,470
and it says yes I'll change that and you

00:31:14,090 --> 00:31:17,090
only export it's like yes I'll change it

00:31:15,470 --> 00:31:19,040
and it's like this thing is stuck like

00:31:17,090 --> 00:31:21,920
Drupal doesn't know that it's really

00:31:19,040 --> 00:31:25,130
been exported oh I'm sorry I'm on the

00:31:21,920 --> 00:31:26,660
wrong side so when you export you know

00:31:25,130 --> 00:31:28,460
every time the config gets gets react

00:31:26,660 --> 00:31:32,300
sporting this can this can happen

00:31:28,460 --> 00:31:34,220
sometimes with your entity view modes so

00:31:32,300 --> 00:31:36,710
it's usually fields in your View mode

00:31:34,220 --> 00:31:38,600
and what you still can do and it's it's

00:31:36,710 --> 00:31:40,700
usually complicated as to why Drupal

00:31:38,600 --> 00:31:41,690
thinks it's bad but the way you can fix

00:31:40,700 --> 00:31:43,670
this and it's usually different

00:31:41,690 --> 00:31:45,920
developers that have done the same thing

00:31:43,670 --> 00:31:48,320
at the same time you can do this trick

00:31:45,920 --> 00:31:50,510
with config delete so there take a look

00:31:48,320 --> 00:31:52,790
at the dress we talked about config set

00:31:50,510 --> 00:31:56,780
before to set the UUID there's also a

00:31:52,790 --> 00:31:57,950
config delete it's not as bad and I hate

00:31:56,780 --> 00:31:59,840
say this but it I don't think it's as

00:31:57,950 --> 00:32:00,620
bad as people think it is this is kind

00:31:59,840 --> 00:32:02,300
of what we were talking about before

00:32:00,620 --> 00:32:05,420
Drupal won't actually delete your

00:32:02,300 --> 00:32:08,180
content so if I go into say drush config

00:32:05,420 --> 00:32:10,580
delete and I delete a field that might

00:32:08,180 --> 00:32:12,110
sound horrible but the fields data is

00:32:10,580 --> 00:32:14,330
actually still in the database all the

00:32:12,110 --> 00:32:16,370
tables are still there and now I can do

00:32:14,330 --> 00:32:18,860
a configure import and restore that

00:32:16,370 --> 00:32:20,960
field and everything's fine

00:32:18,860 --> 00:32:23,240
so if you get this thing where a field

00:32:20,960 --> 00:32:23,630
is stuck and it won't it won't revert or

00:32:23,240 --> 00:32:25,160
it won't

00:32:23,630 --> 00:32:27,260
it keeps importing and exporting all the

00:32:25,160 --> 00:32:29,330
time try deleting it and then doing an

00:32:27,260 --> 00:32:31,280
import and see if that fixes it a lot of

00:32:29,330 --> 00:32:33,080
times that will that's also like I said

00:32:31,280 --> 00:32:35,080
before how you fix like the cardinality

00:32:33,080 --> 00:32:37,010
where the you I won't let you change it

00:32:35,080 --> 00:32:39,140
or I think actually it doesn't I think

00:32:37,010 --> 00:32:40,610
they fixed it but if you if you have

00:32:39,140 --> 00:32:41,870
these kind of schema changes where the

00:32:40,610 --> 00:32:44,150
Drupal you I won't let you change

00:32:41,870 --> 00:32:47,110
something just go in edit your config

00:32:44,150 --> 00:32:49,460
file manually delete it rien port it

00:32:47,110 --> 00:32:51,230
this one I was talking about first the

00:32:49,460 --> 00:32:52,970
other slide so config versus content

00:32:51,230 --> 00:32:54,980
just be aware that there's still this

00:32:52,970 --> 00:32:56,990
gray area that not everything in Drupal

00:32:54,980 --> 00:33:00,170
that you might like to be config is

00:32:56,990 --> 00:33:03,260
considered to fit so like menu links

00:33:00,170 --> 00:33:04,820
menu links or content blocks that you

00:33:03,260 --> 00:33:07,070
create if you create a custom block it

00:33:04,820 --> 00:33:08,730
says I want to say welcome user on every

00:33:07,070 --> 00:33:10,980
one of my pages so I go and I create

00:33:08,730 --> 00:33:13,080
block say welcome that's actually

00:33:10,980 --> 00:33:15,330
considered content it's not exportable

00:33:13,080 --> 00:33:18,150
or its exportable but it's not going to

00:33:15,330 --> 00:33:20,430
be in your config sing directory so if

00:33:18,150 --> 00:33:22,610
you run into those cases a good module

00:33:20,430 --> 00:33:25,110
for this is the default content module

00:33:22,610 --> 00:33:27,570
specifically for blocks if I create a

00:33:25,110 --> 00:33:29,430
block that has some text I want to put

00:33:27,570 --> 00:33:32,070
on every page and I want to put that

00:33:29,430 --> 00:33:34,890
basically into code I can use default

00:33:32,070 --> 00:33:37,920
content to export that block entity as a

00:33:34,890 --> 00:33:40,800
JSON file and then put that JSON file

00:33:37,920 --> 00:33:42,420
obviously in my code in my code repo and

00:33:40,800 --> 00:33:45,000
then I use address command called

00:33:42,420 --> 00:33:46,680
default default content import all and

00:33:45,000 --> 00:33:48,690
it will actually import that JSON file

00:33:46,680 --> 00:33:51,630
and it will create that content and you

00:33:48,690 --> 00:33:54,540
can do that for nodes or for blocks for

00:33:51,630 --> 00:33:56,910
any kind of entity that you want for

00:33:54,540 --> 00:33:58,770
things like menu links taxonomy terms I

00:33:56,910 --> 00:34:01,470
tend to use the migrate module in the

00:33:58,770 --> 00:34:03,090
migrate CSV source plug-in so now I can

00:34:01,470 --> 00:34:05,700
just have a CSV file that says like

00:34:03,090 --> 00:34:07,890
here's my clients taxonomy terms and it

00:34:05,700 --> 00:34:10,170
just creates those and now I can run the

00:34:07,890 --> 00:34:11,820
migrate script I can roll it back to

00:34:10,170 --> 00:34:14,220
delete them rerun it if they add new

00:34:11,820 --> 00:34:18,750
ones that works really well for menus in

00:34:14,220 --> 00:34:20,880
taxonomy terms okay we talked about that

00:34:18,750 --> 00:34:22,650
some other possible config modules

00:34:20,880 --> 00:34:24,630
there's actually a lot of config modules

00:34:22,650 --> 00:34:27,090
and I kind of stopped here the two

00:34:24,630 --> 00:34:28,770
useful ones are that the one really

00:34:27,090 --> 00:34:31,140
useful one that I definitely used is the

00:34:28,770 --> 00:34:32,490
configure read-only clients find this

00:34:31,140 --> 00:34:34,140
really nice on their production site

00:34:32,490 --> 00:34:35,670
because they can guarantee that there's

00:34:34,140 --> 00:34:37,410
absolutely no way that someone's going

00:34:35,670 --> 00:34:39,870
to change something in the UI and get it

00:34:37,410 --> 00:34:41,310
exported to the code if they mess it up

00:34:39,870 --> 00:34:42,780
in the UI you can just do a config

00:34:41,310 --> 00:34:45,380
import and you're back to where you were

00:34:42,780 --> 00:34:48,270
so read-only is really useful for that

00:34:45,380 --> 00:34:50,910
and I think actually aqueon I do that by

00:34:48,270 --> 00:34:52,560
default this other one is interesting

00:34:50,910 --> 00:34:54,210
config sweet I've just started dabbling

00:34:52,560 --> 00:34:57,950
in it was brought to my attention a few

00:34:54,210 --> 00:35:01,460
weeks ago it kind of scares me to death

00:34:57,950 --> 00:35:03,630
but they say it's good what this does is

00:35:01,460 --> 00:35:05,910
why do you configure import and export

00:35:03,630 --> 00:35:07,680
at all why not have it automatically be

00:35:05,910 --> 00:35:09,900
that when I save something in the UI it

00:35:07,680 --> 00:35:12,630
automatically exports it and when I do a

00:35:09,900 --> 00:35:14,610
git pull and get new config it

00:35:12,630 --> 00:35:15,990
automatically imports it and then I

00:35:14,610 --> 00:35:17,790
don't have to do any dress commands at

00:35:15,990 --> 00:35:21,030
all well that'd be great to not have to

00:35:17,790 --> 00:35:24,320
do any address commands at all maybe try

00:35:21,030 --> 00:35:24,320
it let me know what your experience is

00:35:24,470 --> 00:35:28,849
for me that I like I like to look at my

00:35:26,690 --> 00:35:30,020
stuff and see my changes you know the

00:35:28,849 --> 00:35:32,000
idea that I might be working on

00:35:30,020 --> 00:35:33,980
something and then it magically imports

00:35:32,000 --> 00:35:35,480
and my stuff's gone like I worry about

00:35:33,980 --> 00:35:38,119
this but it apparently has really good

00:35:35,480 --> 00:35:41,510
support for config split as well so

00:35:38,119 --> 00:35:46,190
might be something to take a look at so

00:35:41,510 --> 00:35:48,470
to summarise stop using features use

00:35:46,190 --> 00:35:50,839
normal config export config import get

00:35:48,470 --> 00:35:52,220
used to the new workflow use config

00:35:50,839 --> 00:35:54,800
split for your environment specific

00:35:52,220 --> 00:35:57,380
configure gonna see config split as part

00:35:54,800 --> 00:35:59,900
of this CMI 2.0 initiative likely moving

00:35:57,380 --> 00:36:01,700
the core at some point use config

00:35:59,900 --> 00:36:03,200
installer if you need to clone a site

00:36:01,700 --> 00:36:04,910
and build it from config you'll likely

00:36:03,200 --> 00:36:07,460
see that going into core at some point

00:36:04,910 --> 00:36:09,319
in the future managed to get used to

00:36:07,460 --> 00:36:11,210
managing all your config with git and

00:36:09,319 --> 00:36:12,890
manage all your changes like this the

00:36:11,210 --> 00:36:14,660
config becomes no different from code

00:36:12,890 --> 00:36:16,730
hopefully you're used to using git to

00:36:14,660 --> 00:36:17,750
manage your code and it's no different

00:36:16,730 --> 00:36:20,510
here if you want to see what's

00:36:17,750 --> 00:36:22,099
overridden you do a git diff after you

00:36:20,510 --> 00:36:24,650
and do an export that shows you what's

00:36:22,099 --> 00:36:26,750
being overwritten if you want to revert

00:36:24,650 --> 00:36:28,280
stuff you you know do it get pull and

00:36:26,750 --> 00:36:32,119
config imports so just get used to using

00:36:28,280 --> 00:36:33,650
a bigoted tool feel free to play with

00:36:32,119 --> 00:36:37,010
config actions if you think you want to

00:36:33,650 --> 00:36:39,589
generate config and use templates don't

00:36:37,010 --> 00:36:42,380
be afraid of llamó files one thing

00:36:39,589 --> 00:36:44,420
you'll notice in Drupal 8 is it's fine

00:36:42,380 --> 00:36:45,829
go you know those those gamma files live

00:36:44,420 --> 00:36:47,569
in your config default directory they're

00:36:45,829 --> 00:36:49,520
part of your code repo now you're not

00:36:47,569 --> 00:36:51,650
afraid of editing PHP code so why are

00:36:49,520 --> 00:36:53,270
you afraid of editing the ammo file do

00:36:51,650 --> 00:36:55,520
you want to change the site name you

00:36:53,270 --> 00:36:57,230
don't need to go to the UI and put it in

00:36:55,520 --> 00:36:58,609
the box just go to the system site the

00:36:57,230 --> 00:37:01,099
mo file and change it right there

00:36:58,609 --> 00:37:02,630
now you'll hate me for that when you go

00:37:01,099 --> 00:37:04,040
edit one of those files and get yourself

00:37:02,630 --> 00:37:05,809
in trouble and change it to something

00:37:04,040 --> 00:37:07,970
and now and suddenly you've you know

00:37:05,809 --> 00:37:10,520
added a comma or something and now the

00:37:07,970 --> 00:37:13,010
mo parser complains and won't import but

00:37:10,520 --> 00:37:14,480
you know we're learning right so you

00:37:13,010 --> 00:37:15,829
know but learn take a look those gamma

00:37:14,480 --> 00:37:18,260
files there's some fascinating stuff

00:37:15,829 --> 00:37:20,030
some files are better than others but

00:37:18,260 --> 00:37:21,589
you can definitely hand edit those if

00:37:20,030 --> 00:37:24,410
you need to or move them around and play

00:37:21,589 --> 00:37:27,559
with them and then yeah stay tuned for

00:37:24,410 --> 00:37:29,210
CMI 2.0 that we talked about I think

00:37:27,559 --> 00:37:31,700
hopefully within a year or so you'll see

00:37:29,210 --> 00:37:33,380
some improvements to the whole system so

00:37:31,700 --> 00:37:34,690
we don't need Nestle all of these extra

00:37:33,380 --> 00:37:37,849
contribute

00:37:34,690 --> 00:37:41,530
so with that thanks and I'm happy to

00:37:37,849 --> 00:37:44,590
take questions in the small timer

00:37:41,530 --> 00:37:46,369
[Applause]

00:37:44,590 --> 00:37:49,279
[Music]

00:37:46,369 --> 00:37:52,099
also wanted to give a shout out you know

00:37:49,279 --> 00:37:55,099
feel free to to join us for contribs

00:37:52,099 --> 00:37:57,380
Sprint's on Friday and please go review

00:37:55,099 --> 00:37:58,849
the session I look at all the reviews

00:37:57,380 --> 00:38:00,589
that people give and all the feedback

00:37:58,849 --> 00:38:02,779
and I love to get better at this

00:38:00,589 --> 00:38:06,769
so definitely sending your feedback and

00:38:02,779 --> 00:38:08,329
things I have a question yes oh good

00:38:06,769 --> 00:38:11,619
okay we have a mic Oh awesome

00:38:08,329 --> 00:38:14,509
okay my questions about the layout

00:38:11,619 --> 00:38:17,539
initiative and blocks being placed and

00:38:14,509 --> 00:38:20,719
field layouts and how blocks are both

00:38:17,539 --> 00:38:22,579
config and contents and how all that

00:38:20,719 --> 00:38:24,680
works together with configuration so I

00:38:22,579 --> 00:38:26,119
haven't tried it with the latest 8/5

00:38:24,680 --> 00:38:29,029
stuff I have to admit which looks

00:38:26,119 --> 00:38:30,949
awesome and I tend to be a panels

00:38:29,029 --> 00:38:32,689
panelizer guy right now but I know it's

00:38:30,949 --> 00:38:34,729
the same developer who's working on that

00:38:32,689 --> 00:38:37,160
so they're you know they're doing things

00:38:34,729 --> 00:38:40,819
in similar ways layout is still

00:38:37,160 --> 00:38:43,009
considered config so you know the fact

00:38:40,819 --> 00:38:44,959
that you know a given block is on the

00:38:43,009 --> 00:38:47,029
left or right like you'll you'll export

00:38:44,959 --> 00:38:51,109
that layout as config just like you do

00:38:47,029 --> 00:38:53,779
now now sometimes that will have uu IDs

00:38:51,109 --> 00:38:55,309
or blocks in it and you have to again be

00:38:53,779 --> 00:38:58,279
careful as to whether that block is a

00:38:55,309 --> 00:38:59,599
piece of content or not and and make

00:38:58,279 --> 00:39:00,170
sure you're really working with config

00:38:59,599 --> 00:39:02,390
blocks

00:39:00,170 --> 00:39:04,099
alright the layout itself and if you

00:39:02,390 --> 00:39:05,900
drag stuff to the left or the right or

00:39:04,099 --> 00:39:08,239
add something that should all get

00:39:05,900 --> 00:39:10,309
exported to config okay so it's

00:39:08,239 --> 00:39:13,549
basically it'll really work basically

00:39:10,309 --> 00:39:16,039
kind of the same way I guess with blocks

00:39:13,549 --> 00:39:18,140
still being kind of yeah I don't think

00:39:16,039 --> 00:39:19,999
blocks aren't changing this is just a

00:39:18,140 --> 00:39:25,219
way to organize the blocks okay yeah

00:39:19,999 --> 00:39:26,839
yeah thanks yep next yeah hi thanks for

00:39:25,219 --> 00:39:29,109
all your work on content on

00:39:26,839 --> 00:39:31,459
configuration management over the years

00:39:29,109 --> 00:39:33,499
so we're in this little bit of a weird

00:39:31,459 --> 00:39:36,650
space right now with media coming into

00:39:33,499 --> 00:39:38,390
core and it's leading some configuration

00:39:36,650 --> 00:39:42,769
issues that I've been trying to deal

00:39:38,390 --> 00:39:45,229
with where some of the media core in

00:39:42,769 --> 00:39:47,599
stable oh sorry in standard profile

00:39:45,229 --> 00:39:49,339
kicks in from the optional folder so

00:39:47,599 --> 00:39:51,529
that when I'm trying to create a module

00:39:49,339 --> 00:39:54,829
that's just the way that I typically

00:39:51,529 --> 00:39:56,420
configure media so the error comes up

00:39:54,829 --> 00:39:58,810
when it tries to enable them on that

00:39:56,420 --> 00:39:59,860
module that has that configuration

00:39:58,810 --> 00:40:02,800
already exists in the active

00:39:59,860 --> 00:40:04,870
configuration and so I've been talking

00:40:02,800 --> 00:40:06,550
to folks the answer so far I've gotten

00:40:04,870 --> 00:40:07,750
the best answer seems to be well maybe

00:40:06,550 --> 00:40:09,250
it should be an install profile if

00:40:07,750 --> 00:40:11,260
you're gonna keep reusing that but that

00:40:09,250 --> 00:40:12,790
to me isn't a good argument because a

00:40:11,260 --> 00:40:14,500
lot of people just want to be able to

00:40:12,790 --> 00:40:17,350
drop in a media configuration or some

00:40:14,500 --> 00:40:20,040
other set of configurations so I'm

00:40:17,350 --> 00:40:24,240
curious I do have a workaround for it

00:40:20,040 --> 00:40:25,780
that involves the hook install loading

00:40:24,240 --> 00:40:28,180
configuration files

00:40:25,780 --> 00:40:31,660
Emel in there and then loading up a

00:40:28,180 --> 00:40:34,570
config object and saving it so that

00:40:31,660 --> 00:40:37,270
works but it feels a little hacky and so

00:40:34,570 --> 00:40:38,920
I'm wondering yeah it's the the the

00:40:37,270 --> 00:40:40,300
optional stuff I mean we've had troubles

00:40:38,920 --> 00:40:41,740
with this and features too and we

00:40:40,300 --> 00:40:43,120
actually in a way kind of stopped

00:40:41,740 --> 00:40:44,650
supporting it and we just tell people

00:40:43,120 --> 00:40:45,640
this instead of putting in the optional

00:40:44,650 --> 00:40:47,320
directory put it in the install

00:40:45,640 --> 00:40:48,730
directory and then tell the person they

00:40:47,320 --> 00:40:50,800
just need to have media module installed

00:40:48,730 --> 00:40:52,960
you know it comes up with views two of

00:40:50,800 --> 00:40:54,130
you know right but it box there and says

00:40:52,960 --> 00:40:55,810
it already exists in the active

00:40:54,130 --> 00:40:58,960
configuration it won't actually import

00:40:55,810 --> 00:41:01,300
so with features features we'll get

00:40:58,960 --> 00:41:03,850
around that I'll allow it to exist but

00:41:01,300 --> 00:41:06,250
if you use config installer config

00:41:03,850 --> 00:41:07,510
installer won't botch with that so it's

00:41:06,250 --> 00:41:09,280
it's only if you try to enable the

00:41:07,510 --> 00:41:10,870
module normally because yeah normally

00:41:09,280 --> 00:41:13,510
it's not gonna let you install a module

00:41:10,870 --> 00:41:14,980
so so that's that's one of the reasons

00:41:13,510 --> 00:41:16,720
we had features was to get around that

00:41:14,980 --> 00:41:18,430
but then if you're not putting the

00:41:16,720 --> 00:41:20,080
config in the module like if you get

00:41:18,430 --> 00:41:21,490
used to this idea that the site owns the

00:41:20,080 --> 00:41:23,200
config and it's all in the default

00:41:21,490 --> 00:41:25,510
directory then there's no config in your

00:41:23,200 --> 00:41:27,430
module it's all coming from from the

00:41:25,510 --> 00:41:29,440
default directory and it can import that

00:41:27,430 --> 00:41:31,090
to spine so that's kind of going back to

00:41:29,440 --> 00:41:32,620
the profile of yeah you create a profile

00:41:31,090 --> 00:41:34,120
you put everything in the config sync

00:41:32,620 --> 00:41:35,980
directory and you install the profile at

00:41:34,120 --> 00:41:38,320
once rather than trying to turn on this

00:41:35,980 --> 00:41:40,090
one module at a time but definitely the

00:41:38,320 --> 00:41:42,520
optional config is where there's still

00:41:40,090 --> 00:41:44,350
hiccups yeah okay so you would just

00:41:42,520 --> 00:41:46,300
recommend creating the config and then

00:41:44,350 --> 00:41:50,710
throwing it into your default folder

00:41:46,300 --> 00:41:53,770
yeah okay thanks Mike thank you for the

00:41:50,710 --> 00:41:55,300
great talk the thing that I really love

00:41:53,770 --> 00:41:58,720
about features is it allows me to

00:41:55,300 --> 00:42:01,840
organize config into little packages

00:41:58,720 --> 00:42:03,850
that are you know makes sense is there a

00:42:01,840 --> 00:42:06,010
way to do that now with this it seems to

00:42:03,850 --> 00:42:08,140
be all or nothing or go through things

00:42:06,010 --> 00:42:09,080
when you start committing and figure out

00:42:08,140 --> 00:42:11,150
which ones you

00:42:09,080 --> 00:42:12,860
to add or not yeah because the problem

00:42:11,150 --> 00:42:14,900
is it is kind of all or nothing so let

00:42:12,860 --> 00:42:17,390
me give you an example this is my this

00:42:14,900 --> 00:42:20,420
actually came up on a client project so

00:42:17,390 --> 00:42:22,880
you have an article and a blog content

00:42:20,420 --> 00:42:24,950
types right and your client says we'd

00:42:22,880 --> 00:42:26,660
really like to show related content on

00:42:24,950 --> 00:42:27,800
the page so we we want to show the

00:42:26,660 --> 00:42:29,330
article and then over in the right

00:42:27,800 --> 00:42:31,820
sidebar we want a view that shows

00:42:29,330 --> 00:42:34,010
related stuff okay so this is a

00:42:31,820 --> 00:42:35,750
multi-value entity reference field right

00:42:34,010 --> 00:42:37,550
and as in any reference field that can

00:42:35,750 --> 00:42:39,800
reference it in content because articles

00:42:37,550 --> 00:42:42,200
might have related blogs blogs might

00:42:39,800 --> 00:42:44,480
have related articles when you export

00:42:42,200 --> 00:42:46,490
this if you go look at the export of

00:42:44,480 --> 00:42:50,900
that any of the reference field it

00:42:46,490 --> 00:42:53,180
depends on blog and article that article

00:42:50,900 --> 00:42:55,340
has that field and blog has that field

00:42:53,180 --> 00:42:58,490
and so you end up with really a circular

00:42:55,340 --> 00:43:00,410
reference okay no way of exporting that

00:42:58,490 --> 00:43:02,540
with features is going to really help

00:43:00,410 --> 00:43:03,680
you because one's going to be dependent

00:43:02,540 --> 00:43:05,030
on the other which is dependent on the

00:43:03,680 --> 00:43:07,070
other there's no order you can enable

00:43:05,030 --> 00:43:09,020
that the only way to do it is if it's in

00:43:07,070 --> 00:43:11,240
one giant directory and it all gets

00:43:09,020 --> 00:43:12,470
imported at the same time the only way

00:43:11,240 --> 00:43:14,090
to get around it with features is

00:43:12,470 --> 00:43:17,780
actually if you make the content type

00:43:14,090 --> 00:43:19,970
itself a separate feature so now you

00:43:17,780 --> 00:43:22,070
have the content type feature the field

00:43:19,970 --> 00:43:23,990
storage feature the field instance

00:43:22,070 --> 00:43:26,510
feature for both article and blog you've

00:43:23,990 --> 00:43:27,770
got six modules now just throw it just

00:43:26,510 --> 00:43:30,350
put it in one directory rather than

00:43:27,770 --> 00:43:32,990
having like one per so it's like yet I

00:43:30,350 --> 00:43:34,580
feel you I want to organize to like this

00:43:32,990 --> 00:43:36,590
is why we write modules right we don't

00:43:34,580 --> 00:43:38,330
have all of our code and one giant PHP

00:43:36,590 --> 00:43:41,600
directory you know we have it separated

00:43:38,330 --> 00:43:43,010
into modules we have classes hopefully

00:43:41,600 --> 00:43:44,150
we'll have a way to figure it out you

00:43:43,010 --> 00:43:45,830
know in the future of some way of

00:43:44,150 --> 00:43:48,410
organizing maybe sub directories or

00:43:45,830 --> 00:43:50,930
something but for now really the the

00:43:48,410 --> 00:43:52,940
idea that you can organize it really

00:43:50,930 --> 00:43:55,520
only works for the simpler websites you

00:43:52,940 --> 00:43:58,250
know yeah simple content types it kind

00:43:55,520 --> 00:43:59,600
of works but it's it takes a little

00:43:58,250 --> 00:44:01,310
getting used to but play with it for a

00:43:59,600 --> 00:44:05,060
while and you actually like I don't miss

00:44:01,310 --> 00:44:07,580
it that much right so the the process is

00:44:05,060 --> 00:44:10,040
or the best best practice is pull a

00:44:07,580 --> 00:44:12,110
fresh database down from prod and then

00:44:10,040 --> 00:44:15,680
do your changes and then export them and

00:44:12,110 --> 00:44:18,260
don't mix but you know potentially take

00:44:15,680 --> 00:44:20,480
different JIRA tickets into one yeah

00:44:18,260 --> 00:44:28,510
into one export thing I'm about to be

00:44:20,480 --> 00:44:28,510
told that we're done yeah thanks a lot

00:44:29,020 --> 00:44:35,710

YouTube URL: https://www.youtube.com/watch?v=x2kYZhgUSU0


