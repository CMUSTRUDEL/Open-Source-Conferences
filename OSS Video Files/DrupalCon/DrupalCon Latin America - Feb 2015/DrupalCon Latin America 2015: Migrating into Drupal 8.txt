Title: DrupalCon Latin America 2015: Migrating into Drupal 8
Publication date: 2015-02-11
Playlist: DrupalCon Latin America - Feb 2015
Description: 
	Speakers: Ryan Wealitaliatina
The migrate module is now part of core! This means that migrate is no longer a secondary option when upgrading your sites to Drupal 8, but is in fact the preferred route for upgrading. The previous in-place “upgrade” path has been removed from the system.

Find out what this means for your team and learn how to migrate Drupal 6 (and Drupal 7) sites directly into Drupal 8 using Drush. Learn what the plans are for the user interface. Know what differences to expect from the old version of migrate. Get up-to-date on the migration initiative progress at recent DrupalCon sprints in Austin and Amsterdam.

At the end of this session you will have the tools you need to help test the migration system and begin using your own data in Drupal 8.
Captions: 
	00:00:00,299 --> 00:00:02,000
Okay, welcome.

00:00:02,000 --> 00:00:05,250
Welcome, amigos, to DrupalCon, of course.

00:00:05,250 --> 00:00:08,650
We're at day two, so I hope everyone's having fun.

00:00:08,650 --> 00:00:11,930
We've been having fun.

00:00:11,930 --> 00:00:15,680
We're here to talk about migration into Drupal 8.

00:00:15,680 --> 00:00:19,289
Some people say that there's no migration path in Drupal, but that's not true, so we're

00:00:19,289 --> 00:00:24,210
going to talk about how you can actually get stuff into Drupal 8 today, and we will talk

00:00:24,210 --> 00:00:27,619
about what's coming in the future.

00:00:27,619 --> 00:00:29,099
My name is Ryan Weal.

00:00:29,099 --> 00:00:32,619
I work based out of Montreal in Canada.

00:00:32,619 --> 00:00:34,699
This is my colleague Novella.

00:00:34,699 --> 00:00:38,300
Do you want to say hello en Español?

00:00:38,300 --> 00:00:42,170
-[Spanish] My name is Novella, and this presentation

00:00:42,170 --> 00:00:47,780
of course will be about migration.

00:00:47,780 --> 00:01:02,949
As Ryan said, we work in Montreal, and we are 2/3 of the Kafei team.

00:01:02,949 --> 00:01:08,960
We do a lot of migrations and we are very interested in migrations especially for Drupal

00:01:08,960 --> 00:01:10,160
8, mostly because it's a lot of fun.

00:01:10,160 --> 00:01:12,470
-What is migration?

00:01:12,470 --> 00:01:15,860
How many people have used Migrate in Drupal 7?

00:01:15,860 --> 00:01:17,130
Is this familiar to people?

00:01:17,130 --> 00:01:18,340
Roughly half probably, okay.

00:01:18,340 --> 00:01:24,400
-How many people are missing some chunks of hair from this migration experience?

00:01:24,400 --> 00:01:28,640
Can you raise your hand?

00:01:28,640 --> 00:01:34,880
-How many people have upgraded Drupal sites in the past using the upgrade.php page?

00:01:34,880 --> 00:01:40,030
A little bit more, but about half as well.

00:01:40,030 --> 00:01:41,030
Okay.

00:01:41,030 --> 00:01:45,980
Migration and upgrade are different things when we're talking about this stuff.

00:01:45,980 --> 00:01:51,740
Migration is a set of templates that you can use to port your data, and it ports your data

00:01:51,740 --> 00:01:55,110
by connecting to your old data source.

00:01:55,110 --> 00:02:00,680
In this case, we're going to be talking about Drupal 6 because that is what is currently

00:02:00,680 --> 00:02:02,590
in Drupal 8 core.

00:02:02,590 --> 00:02:07,550
There is a plan to get Drupal 7 to migrate as well in addition to other things.

00:02:07,550 --> 00:02:12,480
Let's talk a bit more about that.

00:02:12,480 --> 00:02:18,810
In Drupal 7 there was a package called Migrate Drupal-to-Drupal, and this was a set of templates

00:02:18,810 --> 00:02:25,420
for bringing data from Drupal 5, Drupal 6, and Drupal 7 into Drupal 7.

00:02:25,420 --> 00:02:32,370
It was originally done as a proof of concept for maybe doing a new migration path, and

00:02:32,370 --> 00:02:37,260
it has now been declared the new standard.

00:02:37,260 --> 00:02:42,170
That old upgrade.php page is gone.

00:02:42,170 --> 00:02:49,690
That one had used to work that you would take your Drupal 6 site and you would just drop

00:02:49,690 --> 00:02:53,990
your D7 site on top of it and run upgrade.php.

00:02:53,990 --> 00:02:59,260
It's a little bit different now that we're actually connecting to an old site and not

00:02:59,260 --> 00:03:05,510
changing it at all, but just changing our new site and using that.

00:03:05,510 --> 00:03:08,880
A little bit more about the Drupal-to-Drupal template is that

00:03:08,880 --> 00:03:13,920
if you were using them in Drupal 7 they are object-oriented, which is great news for many

00:03:13,920 --> 00:03:14,920
people.

00:03:14,920 --> 00:03:23,640
Obviously the Drupal 8 system is more object-oriented and they continue to be so in Drupal 8.

00:03:23,640 --> 00:03:28,781
It's also worth noting, this happened later in the development process in Drupal 8.

00:03:28,781 --> 00:03:34,880
It was actually after Feature Freeze, I believe, that it was decided to put Migrate into core,

00:03:34,880 --> 00:03:42,050
so as a result some things are still in progress.

00:03:42,050 --> 00:03:47,500
You may have noticed I talked about Drupal 6 as opposed to Drupal 7 as the initial path.

00:03:47,500 --> 00:03:51,260
We're now able to skip over versions.

00:03:51,260 --> 00:03:57,630
This is really great when you're looking at older sites that are now nearing end of life.

00:03:57,630 --> 00:04:05,750
As many of you know, when Drupal 8 gets released, in theory, Drupal 6 will be no longer supported

00:04:05,750 --> 00:04:12,470
for security updates, so there's an urgent need to move Drupal 6 sites to something else.

00:04:12,470 --> 00:04:17,989
Rather than drag people through two versions, which can be very difficult to upgrade, we

00:04:17,989 --> 00:04:23,750
can skip right over that and just say, "Okay, we can connect to D6, pull all of the data

00:04:23,750 --> 00:04:29,889
out, and make a wonderful new Drupal 8 site."

00:04:29,889 --> 00:04:36,740
There is still a plan to replicate that old upgrade.php page with all of this working

00:04:36,740 --> 00:04:47,819
magically under the hood, and that is currently flagged for not 8.0.0, but the 8.1.x for release.

00:04:47,819 --> 00:04:55,330
It may or may not be there in 8.0.0, but before you go and say, "There's no Migrate in core,"

00:04:55,330 --> 00:04:58,610
there are actually two migrate modules in core.

00:04:58,610 --> 00:05:01,960
The migrate module that runs the migration is there.

00:05:01,960 --> 00:05:03,300
It's working.

00:05:03,300 --> 00:05:04,939
It can be used today.

00:05:04,939 --> 00:05:12,210
Then the Migrate_Drupal module, which is the equivalent to Migrate D2D in the old version.

00:05:12,210 --> 00:05:17,860
What that one does is that has all of the mappings in D6 to say a D6 UID is going to

00:05:17,860 --> 00:05:19,860
become a D8 UID.

00:05:19,860 --> 00:05:27,449
It has mappings for each of the fields so that you don't have to do that.

00:05:27,449 --> 00:05:30,240
Here's what we're looking at for version support.

00:05:30,240 --> 00:05:36,020
Currently D6 to D8 is in core right now and it has been for months.

00:05:36,020 --> 00:05:43,810
D7 to D8 is in the process of development, and that's happening in a sandbox off of the

00:05:43,810 --> 00:05:48,629
main migrate path, so what's going to happen there is people are going to build the templates

00:05:48,629 --> 00:05:53,930
to a point where the quality is really good, and then those will get brought into the Migrate_Drupal

00:05:53,930 --> 00:05:58,169
module in D8 core.

00:05:58,169 --> 00:06:03,650
The templates between D6 and D7 are not very different, so it's probably going to start

00:06:03,650 --> 00:06:07,159
moving very fast in the near future.

00:06:07,159 --> 00:06:11,340
If you're interested in helping with that process, we'll give you some information at

00:06:11,340 --> 00:06:16,650
the end of this presentation on how you can connect to people that will allow you to get

00:06:16,650 --> 00:06:19,749
in there into the sandbox and work with that.

00:06:19,749 --> 00:06:27,009
Lastly, D8 to D8 because sometimes you need to rescue projects.

00:06:27,009 --> 00:06:32,050
In D7 this became a really popular option when you take on a rescue project and you

00:06:32,050 --> 00:06:39,580
go, "Okay, well the data is in that D7 site, but the code in that site may not be what

00:06:39,580 --> 00:06:41,479
we want to use."

00:06:41,479 --> 00:06:46,409
For people that were doing rescue projects, having a path within the same version is very

00:06:46,409 --> 00:06:47,770
important.

00:06:47,770 --> 00:06:55,659
There is also talk about using Migrate to do migrations between the different beta versions

00:06:55,659 --> 00:06:56,659
of D8.

00:06:56,659 --> 00:07:04,479
I still haven't seen any templates for that yet, but this little rumor has been around,

00:07:04,479 --> 00:07:07,340
so it's something that's out there.

00:07:07,340 --> 00:07:14,069
Lastly, I put an asterisk here that, of course, D6 support should, in theory, stop when D8

00:07:14,069 --> 00:07:18,509
is released, but there has also been some discussion about extending that temporarily

00:07:18,509 --> 00:07:22,800
for a period to allow people to do that transition.

00:07:22,800 --> 00:07:30,409
There's really an imminent need to move away from D6 because as security updates get applied,

00:07:30,409 --> 00:07:34,719
there is not as much testing framework in D6 to make sure that's all stable, so there's

00:07:34,719 --> 00:07:38,939
always a risk every time we make a change.

00:07:38,939 --> 00:07:43,199
In the long term, we would like to see D6 kind of move on.

00:07:43,199 --> 00:07:45,490
Here's the exciting stuff.

00:07:45,490 --> 00:07:46,991
Do you want to talk a little bit about this?

00:07:46,991 --> 00:07:47,991
-Yeah, I can talk a little bit about this, although you're definitely more the multilingual

00:07:47,991 --> 00:07:48,991
guy than I am.

00:07:48,991 --> 00:07:51,119
As it says, everything that's in D8 core now will be pulled in from D6.

00:07:51,119 --> 00:07:56,669
Even if it was in contrib for D6 but it's in core now, then it will definitely come.

00:07:56,669 --> 00:08:04,569
Configuration is a very important part, at least for site builders.

00:08:04,569 --> 00:08:15,740
One thing that has been very troublesome for D7 was to have to replicate every click manually.

00:08:15,740 --> 00:08:17,059
Not fun.

00:08:17,059 --> 00:08:24,939
For D8, that's not something that we really have to worry about.

00:08:24,939 --> 00:08:37,570
That comes over with all of the database and the code when you migrate.

00:08:37,570 --> 00:08:42,409
-Multilingual is a big aspect of this, as many of you have probably heard today.

00:08:42,409 --> 00:08:48,660
The new multilingual system in Drupal 8 is, as Gabor describes it, a wonderland.

00:08:48,660 --> 00:08:51,089
It's so much easier to use than other systems.

00:08:51,089 --> 00:08:56,769
D7 was well supporting for multilingual as compared to other content management solutions.

00:08:56,769 --> 00:09:03,149
D8 goes way further with this, extends it throughout the systems so all aspects of the

00:09:03,149 --> 00:09:10,709
system can be translated, but in the old system you needed 10 modules, 12 modules, 15 modules

00:09:10,709 --> 00:09:14,250
to make everything translatable.

00:09:14,250 --> 00:09:16,000
Almost everything is translatable by default now.

00:09:16,000 --> 00:09:20,220
I can't think of a single thing that isn't.

00:09:20,220 --> 00:09:27,279
That stuff was contrib, but because it's now in core, we're actually reaching back into

00:09:27,279 --> 00:09:31,389
the old system and we're grabbing that contrib data and pulling it in.

00:09:31,389 --> 00:09:34,880
-Pro tip: If you had a contrib module in D6 that is now in core, even if you've disabled

00:09:34,880 --> 00:09:45,320
it and uninstalled it and you think that it went bye-bye, it might not have completely

00:09:45,320 --> 00:09:46,320
done so.

00:09:46,320 --> 00:09:47,320
For instance, one really big thing that people have run into is Book module.

00:09:47,320 --> 00:09:48,320
In D6 a lot of people had it on, then you turn it off.

00:09:48,320 --> 00:09:49,320
Will you use it?

00:09:49,320 --> 00:09:57,560
Now it's in core, so remember to enable it when you go into D8 when you're doing your

00:09:57,560 --> 00:09:58,560
migrations.

00:09:58,560 --> 00:10:07,029
Otherwise, you'll just get a whole bunch of cruft.

00:10:07,029 --> 00:10:12,440
This is kind of an open bug because what happens here is that in past versions we always supported

00:10:12,440 --> 00:10:14,050
moving the data forward.

00:10:14,050 --> 00:10:19,860
If you enabled a module that's in core now at some point and you have data there, we

00:10:19,860 --> 00:10:24,250
want to bring it across, but it needs somewhere to go.

00:10:24,250 --> 00:10:28,530
If you don't have the target module enabled, you're going to need to enable that.

00:10:28,530 --> 00:10:34,250
There will be better support for catching those errors in the future, but something

00:10:34,250 --> 00:10:36,350
to watch out for.

00:10:36,350 --> 00:10:41,709
A couple other points on this note: Views were initially talked about as being

00:10:41,709 --> 00:10:48,000
maybe an exception to this, but currently they're not in core as being supported for

00:10:48,000 --> 00:10:53,600
the migration, but there is work being done on making a migration for Views.

00:10:53,600 --> 00:10:58,550
I guess it's also worth noting that your content types get set up.

00:10:58,550 --> 00:11:02,580
If you were looking at your D7 migrations and thinking, "I have to set up all these

00:11:02,580 --> 00:11:08,079
content types," you don't even need to do that because the idea is that when we do have

00:11:08,079 --> 00:11:15,279
that replacement for upgrade.php, which we'll talk about in a minute, the ideal is that

00:11:15,279 --> 00:11:17,170
we have the same process.

00:11:17,170 --> 00:11:23,220
You should be able to go to a page and click "upgrade," and "bam," everything is there.

00:11:23,220 --> 00:11:26,440
This stuff should come through.

00:11:26,440 --> 00:11:33,529
Another example of areas that are kind of tepid support is migrating your blocks.

00:11:33,529 --> 00:11:37,540
Blocks come across, but if you're not using one of the default themes, we don't really

00:11:37,540 --> 00:11:39,529
know where to put things.

00:11:39,529 --> 00:11:42,240
What's going to happen is your blocks are going to come across and you're going to have

00:11:42,240 --> 00:11:44,600
to place them in your new theme.

00:11:44,600 --> 00:11:48,129
Something to watch out for as well.

00:11:48,129 --> 00:11:53,870
There's even more wonderful stuff in Migrate that handles the multilingual stuff because

00:11:53,870 --> 00:11:56,310
multilingual structures have changed.

00:11:56,310 --> 00:12:04,089
The biggest one of these is that in the past if you had translations you would have one

00:12:04,089 --> 00:12:09,680
node for English and one node for Spanish, and they would have to know about each other.

00:12:09,680 --> 00:12:15,089
Sometimes you had to do the node in English before Spanish or in Spanish before English,

00:12:15,089 --> 00:12:17,680
and it always had to be the same process.

00:12:17,680 --> 00:12:19,649
All of that is gone.

00:12:19,649 --> 00:12:21,990
It's now one node.

00:12:21,990 --> 00:12:30,190
If you have a car in English and an automobile in French, you know that it's one object.

00:12:30,190 --> 00:12:32,939
Now in Drupal 8, they are one object.

00:12:32,939 --> 00:12:37,200
During the migration, all of these pieces get merged into one object.

00:12:37,200 --> 00:12:44,190
-One thing to watch out for then is when you're bringing things over, say you had however

00:12:44,190 --> 00:12:51,269
many nodes because you had X number of languages, now they will all be one node.

00:12:51,269 --> 00:12:54,370
If you don't see them, don't worry.

00:12:54,370 --> 00:12:59,959
-Yeah, you'll see them in the interface, and we'll show you an example of that in a minute.

00:12:59,959 --> 00:13:02,189
Configuration of translations should come through as well.

00:13:02,189 --> 00:13:08,850
There are more details of that in the config management side of things.

00:13:08,850 --> 00:13:12,399
Just be aware that that's out there.

00:13:12,399 --> 00:13:17,350
Most importantly, test these things a lot because not everyone has multilingual sites.

00:13:17,350 --> 00:13:20,709
I suspect many people in this room do.

00:13:20,709 --> 00:13:25,180
You will want to run some tests on these things while we have the chance now.

00:13:25,180 --> 00:13:29,089
Maybe at the sprint tomorrow you can come and try running some stuff.

00:13:29,089 --> 00:13:31,300
Try it on your own time.

00:13:31,300 --> 00:13:35,449
Try it on your agency sites.

00:13:35,449 --> 00:13:42,459
Report issues if you find issues with particularly multilingual migrations because sometimes

00:13:42,459 --> 00:13:48,860
these cases don't get covered, as I'm sure we all know if we work on multilingual sites.

00:13:48,860 --> 00:13:54,589
Now let's talk a little bit about how this is envisioned to work in the user interface.

00:13:54,589 --> 00:14:00,999
First, we need to know that we need to enable the Migrate Drupal modules.

00:14:00,999 --> 00:14:06,390
We mentioned just a second ago that you do need to have all of your target modules enabled,

00:14:06,390 --> 00:14:09,339
so if you were using Aggregator, make sure that's enabled.

00:14:09,339 --> 00:14:12,189
If you're using Book, make sure it's enabled.

00:14:12,189 --> 00:14:13,189
Translation Support, make sure it's enabled.

00:14:13,189 --> 00:14:14,189
Then you're ready to go.

00:14:14,189 --> 00:14:17,550
-One thing that has definitely tripped people up while they were getting things set up was

00:14:17,550 --> 00:14:18,829
just the PHP and Drush versions.

00:14:18,829 --> 00:14:20,199
I know people are always harping on this, and I'll do it again.

00:14:20,199 --> 00:14:29,970
Make sure that your PHP and Drush versions are proper for Drupal 8 because they are a

00:14:29,970 --> 00:14:32,839
bit different from Drupal 7.

00:14:32,839 --> 00:14:36,540
-Yeah, first step: Install Drupal 8.

00:14:36,540 --> 00:14:39,009
Second step: Enable all the modules.

00:14:39,009 --> 00:14:43,610
Then third step is make sure you have enabled Migrate and Migrate Drupal.

00:14:43,610 --> 00:14:46,199
Now you're kind of ready to do the basics.

00:14:46,199 --> 00:14:49,870
We're going to go one step further, though, because in the initial part of our presentation,

00:14:49,870 --> 00:14:56,100
we want to talk about the Migrate Upgrade module, which is the replacement for the upgrade.php

00:14:56,100 --> 00:14:59,360
page.

00:14:59,360 --> 00:15:02,509
Migrate Upgrade is contrib at the moment.

00:15:02,509 --> 00:15:11,910
This is the one that will be merged into probably 8.1.x, and it replaces upgrade.php with just

00:15:11,910 --> 00:15:12,910
"/upgrade."

00:15:12,910 --> 00:15:20,129
We couldn't put ".php" because then we would have to put a file there.

00:15:20,129 --> 00:15:23,960
Right now this is just a config page in Drupal, so it's great.

00:15:23,960 --> 00:15:26,660
We can just use this.

00:15:26,660 --> 00:15:30,959
It's going to ask us to input our credentials for the D6 site, so it's important that these

00:15:30,959 --> 00:15:35,040
live on the same host because that way it can run really fast, and we don't have to

00:15:35,040 --> 00:15:36,040
worry about firewalls.

00:15:36,040 --> 00:15:39,130
We don't have to worry about the WiFi stopping.

00:15:39,130 --> 00:15:42,769
We don't have to worry about any of that stuff.

00:15:42,769 --> 00:15:47,319
We do need to put in an address where we can access the files.

00:15:47,319 --> 00:15:54,790
I believe right now at the moment, this interface also uses this to do some text handling, so

00:15:54,790 --> 00:16:00,600
it may look for this address pattern in your body text and other things like that.

00:16:00,600 --> 00:16:05,230
In any case, you do need to have your files somewhere, and you can put in a path as well

00:16:05,230 --> 00:16:07,860
for your private files.

00:16:07,860 --> 00:16:13,629
Of course, in Drupal 6 I think you had the option of public or private, and then there

00:16:13,629 --> 00:16:20,329
were some hacks you could do to do both, but they were kind of weird, but it's in core

00:16:20,329 --> 00:16:22,709
and it has been since D7, so private files can be put into this interface.

00:16:22,709 --> 00:16:23,709
-It's the public files.

00:16:23,709 --> 00:16:24,709
If it throws an error with the public files address that you stick in there through the

00:16:24,709 --> 00:16:32,970
interface, you may need to put a snippet of code, which you can copy and paste, luckily

00:16:32,970 --> 00:16:44,360
for me, in your manifest file, which we'll talk about in just a bit.

00:16:44,360 --> 00:16:45,740
-Right now we're looking at the UI.

00:16:45,740 --> 00:16:51,199
It is the most buggy part of the system, so let's get through the UI and let's get to

00:16:51,199 --> 00:16:52,199
the good stuff.

00:16:52,199 --> 00:16:55,600
This is what the Migrate Upgrade page looks like.

00:16:55,600 --> 00:17:00,899
We put in some database credentials and an address, and then we scroll down, if you can

00:17:00,899 --> 00:17:01,899
imagine.

00:17:01,899 --> 00:17:03,819
We're not doing a live demo here.

00:17:03,819 --> 00:17:07,190
There's your public files directory, and then it just says, "Perform upgrade."

00:17:07,190 --> 00:17:10,540
Then things are going to run.

00:17:10,540 --> 00:17:14,330
The configuration is going to import first because we need our node types to be there

00:17:14,330 --> 00:17:17,450
so that we can put stuff into them.

00:17:17,450 --> 00:17:18,680
We get the site name.

00:17:18,680 --> 00:17:20,820
We get all of those types of settings.

00:17:20,820 --> 00:17:25,810
We get whatever preferences you configured when you first installed Drupal are all going

00:17:25,810 --> 00:17:29,440
to come through and be what you set them to.

00:17:29,440 --> 00:17:33,600
Then there's a hook that runs that you can take advantage of, which we'll get into more

00:17:33,600 --> 00:17:34,600
later.

00:17:34,600 --> 00:17:39,620
You can use the hook to override what's being done in this if you want to minimize the amount

00:17:39,620 --> 00:17:42,080
of code you want to do.

00:17:42,080 --> 00:17:44,570
Ideally you don't have to do any if you're running it this way.

00:17:44,570 --> 00:17:49,110
Then, "boom," it's just going to do a status bar and it's going to run.

00:17:49,110 --> 00:17:54,690
In D7 it was discouraged to run stuff in the user interface due to a bug in batch API that

00:17:54,690 --> 00:17:57,860
would time out on you and die.

00:17:57,860 --> 00:18:00,640
It doesn't do that anymore.

00:18:00,640 --> 00:18:04,350
Because this is what we've always done in Drupal is we've always gone to the upgrade.php

00:18:04,350 --> 00:18:10,310
page, the intention is it will work in this way, so we are working out all the bugs, and

00:18:10,310 --> 00:18:13,640
that is hopefully going to work perfectly.

00:18:13,640 --> 00:18:21,050
This is a snapshot of kind of an older version of the upgrade process, but it's pretty much

00:18:21,050 --> 00:18:23,500
the same.

00:18:23,500 --> 00:18:25,890
It's going to say, "Yay, everything works."

00:18:25,890 --> 00:18:27,370
It might tell you if something failed here.

00:18:27,370 --> 00:18:29,920
It might say a couple things failed.

00:18:29,920 --> 00:18:35,040
Things go into the Watchdog now, so if you're like, "Okay, where do I find out what happened?"

00:18:35,040 --> 00:18:40,260
you can just go to the Watchdog like everything else, and that's on the reports page, as we

00:18:40,260 --> 00:18:42,470
all know.

00:18:42,470 --> 00:18:44,990
I put in this special slide because of what we said earlier.

00:18:44,990 --> 00:18:53,130
I want to point out we've got three nodes here, but as you can see we've got five entries.

00:18:53,130 --> 00:18:58,710
What this was in the old site, this first one was language-neutral, so that appeared

00:18:58,710 --> 00:19:00,440
on all languages.

00:19:00,440 --> 00:19:02,050
That's node one.

00:19:02,050 --> 00:19:06,270
The second node had a translation, so node two and three on the old site were like a

00:19:06,270 --> 00:19:09,210
French version and an English version.

00:19:09,210 --> 00:19:12,850
We've got links to each of those, but they're actually one node under the hood.

00:19:12,850 --> 00:19:17,400
Then we've got a third node that was also translated, and again that's showing us two

00:19:17,400 --> 00:19:22,220
entries in the interface, but in reality it's actually one node.

00:19:22,220 --> 00:19:27,620
If you hover over those edit links, you're going to see that the node ID's, there are

00:19:27,620 --> 00:19:30,130
actually only three of them there.

00:19:30,130 --> 00:19:31,130
That's what you want.

00:19:31,130 --> 00:19:33,880
In D7 this was called Entity Translations.

00:19:33,880 --> 00:19:38,650
If you've used Entity Translation, you're probably going to be very excited about this.

00:19:38,650 --> 00:19:41,640
Do you want to talk a little bit about Drush?

00:19:41,640 --> 00:19:42,640
-Oh, yeah.

00:19:42,640 --> 00:19:43,640
As maybe you can tell, most of my comments are geared toward site builders, and this

00:19:43,640 --> 00:19:51,870
is actually something that I've tried to convince other site builders of, but do Drush.

00:19:51,870 --> 00:19:59,490
Use it and use it wisely, of course.

00:19:59,490 --> 00:20:00,710
This is one place where you really do want to use it.

00:20:00,710 --> 00:20:01,710
As you saw in the UI, it was very simple.

00:20:01,710 --> 00:20:03,090
You put in your database credentials, and you hit "go," and you just cross your fingers.

00:20:03,090 --> 00:20:05,880
I've done a lot of test migrations with the Drupal 8 path, and I've done it both in the

00:20:05,880 --> 00:20:07,180
UI and with Drush.

00:20:07,180 --> 00:20:15,130
One thing I found was that when I did it in the UI, if something screwed up, everything

00:20:15,130 --> 00:20:16,130
would stop.

00:20:16,130 --> 00:20:24,330
With Drush, luckily I can run it, but I can make sure that I'm only running one piece

00:20:24,330 --> 00:20:29,860
at a time, and that's really nice.

00:20:29,860 --> 00:20:36,931
Of course, that is Drush with a combination of the manifest file, which we'll get to in

00:20:36,931 --> 00:20:37,931
a second.

00:20:37,931 --> 00:20:46,940
You can do both Drush and the user interface just to see what's really going on behind

00:20:46,940 --> 00:20:51,050
the scenes, but this is basically just a plug for using Drush as site builders.

00:20:51,050 --> 00:20:56,070
-If you want to just use core and not use that contrib module, this is the way that

00:20:56,070 --> 00:21:00,920
people are usually building migrations and testing them in real life.

00:21:00,920 --> 00:21:05,750
This is what the developers are using, so as developers this is the most accessible

00:21:05,750 --> 00:21:08,190
thing to most people.

00:21:08,190 --> 00:21:14,070
There are a few components of what is happening in the background.

00:21:14,070 --> 00:21:18,130
The first thing is that in order to do this in Drush, you're going to need a manifest

00:21:18,130 --> 00:21:19,400
file.

00:21:19,400 --> 00:21:20,530
That's just a YAML file.

00:21:20,530 --> 00:21:23,720
It's just a text file that lists out the names of migrations.

00:21:23,720 --> 00:21:29,470
There's a bit more detail of that, but think of it just as a list of migrations you want

00:21:29,470 --> 00:21:30,920
to run.

00:21:30,920 --> 00:21:36,170
There's a hook which we mentioned earlier, and you can use that hook to look at each

00:21:36,170 --> 00:21:40,031
item that you're pulling through as it comes in, and if you don't want it, you cay say

00:21:40,031 --> 00:21:41,031
"bye-bye."

00:21:41,031 --> 00:21:42,560
"I don't want this one."

00:21:42,560 --> 00:21:43,960
"I don't want this node type."

00:21:43,960 --> 00:21:45,970
"I don't want this particular node."

00:21:45,970 --> 00:21:50,840
"I don't want this setting to come through because I'm going to do that myself."

00:21:50,840 --> 00:21:56,660
This is the type of stuff that's very useful when you're building a site because maybe

00:21:56,660 --> 00:22:01,450
you want an entirely new site and you just want the blog posts.

00:22:01,450 --> 00:22:07,010
That's important, so you could use the manifest file to specify what migrations to run, and

00:22:07,010 --> 00:22:10,150
then you can do a bit of processing just using a hook.

00:22:10,150 --> 00:22:15,740
By doing that, you can just put things into a .module file and just implement a hook,

00:22:15,740 --> 00:22:21,320
which is something that's very familiar if you're using Drupal 6 or Drupal 7.

00:22:21,320 --> 00:22:27,310
That's the easy way to get into this without having to learn a whole bunch of crazy new

00:22:27,310 --> 00:22:28,600
things.

00:22:28,600 --> 00:22:41,840
-One really good thing about the hook is that even if you were using Drush and a manifest

00:22:41,840 --> 00:22:43,980
file, all your fields, for instance, may try to run at the same time.

00:22:43,980 --> 00:22:46,420
I know recently I had a problem with running image fields as opposed to text fields and

00:22:46,420 --> 00:22:47,420
integer fields and things like that, so I just used a hook to print everything out so

00:22:47,420 --> 00:22:57,440
I could really narrow it down and see what I needed to exclude in order to make the other

00:22:57,440 --> 00:22:59,910
fields come through.

00:22:59,910 --> 00:23:09,090
That's a really great process for debugging, which is certainly necessary now and will

00:23:09,090 --> 00:23:10,090
probably be necessary even when things are a lot more stable.

00:23:10,090 --> 00:23:16,670
The last thing, which is really where Migrate gets really awesome compared to the old version,

00:23:16,670 --> 00:23:18,380
is the plugins.

00:23:18,380 --> 00:23:24,640
If you haven't used plugins, you should use them because they are awesome.

00:23:24,640 --> 00:23:29,450
Plugins in Drupal 8 are just files that live in a special directory where they're known

00:23:29,450 --> 00:23:30,980
to be.

00:23:30,980 --> 00:23:38,320
In this case, they could go into your custom module under the source folder, under "plugin,"

00:23:38,320 --> 00:23:42,620
under "migrate," and then further into one of three different folders depending on what

00:23:42,620 --> 00:23:44,659
type of plugin you're using.

00:23:44,659 --> 00:23:52,780
You can go into the core module's migrate folder or the "migrate_drupal" folder and

00:23:52,780 --> 00:23:57,760
find examples of these and just copy them into your own module if they don't do what

00:23:57,760 --> 00:24:00,190
you want.

00:24:00,190 --> 00:24:02,770
You can make them do whatever you want.

00:24:02,770 --> 00:24:10,750
All you need to do is make sure you update the name which appears in the comment.

00:24:10,750 --> 00:24:14,450
Install your module, and then you have a new plugin.

00:24:14,450 --> 00:24:20,640
Plugins can then be referenced in your manifest file as an override, so there's lots of opportunity

00:24:20,640 --> 00:24:25,500
here to just take something that's close to what you want and either modify it with a

00:24:25,500 --> 00:24:29,530
hook or just go and create your own implementation.

00:24:29,530 --> 00:24:38,530
I know with Drupal 7 we had people write migrations for WordPress, for Joomla, for Microsoft SQL

00:24:38,530 --> 00:24:43,450
Server, things for XML, all sorts of different handlers.

00:24:43,450 --> 00:24:48,870
You can go into your "migrate_drupal" folder, look at all those implementations, and go,

00:24:48,870 --> 00:24:53,730
"Hmm, I bet I could write one for some other legacy platform," and you can make a module

00:24:53,730 --> 00:24:59,300
for that just by copying those files, renaming them, changing exactly what the schema of

00:24:59,300 --> 00:25:04,200
the database needs to be to make it work, and registering my own migrations that way.

00:25:04,200 --> 00:25:10,260
There are also things called process plugins, and these are things that are used to modify

00:25:10,260 --> 00:25:14,900
things as you go in, so you can do things like change all the titles to lowercase, and,

00:25:14,900 --> 00:25:17,770
again, you can just reference that in the manifest file.

00:25:17,770 --> 00:25:20,850
There are a lot of cool things that you can do with that.

00:25:20,850 --> 00:25:24,990
Basically, it's all plugin based, so you can just remix these things.

00:25:24,990 --> 00:25:25,990
You can chain them.

00:25:25,990 --> 00:25:31,341
You can say, "Change all the titles to lowercase and then add three numbers to the end of it

00:25:31,341 --> 00:25:34,270
and remove all the spaces."

00:25:34,270 --> 00:25:37,140
You can just chain all these plugins together.

00:25:37,140 --> 00:25:40,140
It's very extensible in that way.

00:25:40,140 --> 00:25:41,760
A manifest file looks like this.

00:25:41,760 --> 00:25:46,270
Kind of ignore the bullet points along the side if you will.

00:25:46,270 --> 00:25:50,390
We put it in the root, but it could go anywhere as long as you reference it when you run the

00:25:50,390 --> 00:25:51,520
Drush command.

00:25:51,520 --> 00:25:55,560
In this case, we've just provided a short example, but "d6_user_role," "d6_user," "d6_filter_format."

00:25:55,560 --> 00:26:02,970
These can go in any order, so you don't need to worry about what order they're in.

00:26:02,970 --> 00:26:03,970
You just put them there.

00:26:03,970 --> 00:26:06,830
These are the names of the migrations.

00:26:06,830 --> 00:26:11,340
If you wanted to change the process plugin that was used, you could indent underneath

00:26:11,340 --> 00:26:16,480
one of those and change that by just saying what the process plugin you want to run will

00:26:16,480 --> 00:26:17,590
be.

00:26:17,590 --> 00:26:20,430
You could also change the source or the destination.

00:26:20,430 --> 00:26:24,091
If maybe you wanted to turn users into nodes, you could do that.

00:26:24,091 --> 00:26:26,361
That would be really weird, but you could do that.

00:26:26,361 --> 00:26:27,361
-Another good thing about doing it with Drush and using a manifest file to declare all these

00:26:27,361 --> 00:26:32,170
things is that when you run it in Drush, if you're missing anything in your manifest file,

00:26:32,170 --> 00:26:39,080
it will just tell you right there, and then you just go put it in.

00:26:39,080 --> 00:26:41,780
-Yeah.

00:26:41,780 --> 00:26:47,070
It's going to calculate the dependencies, and it's going to say, "I can't run nodes

00:26:47,070 --> 00:26:52,650
until I have users because there's a user field on nodes, so I need a user to be there."

00:26:52,650 --> 00:26:56,200
It's going to tell you, "You must run d6_user."

00:26:56,200 --> 00:26:58,500
This is very helpful.

00:26:58,500 --> 00:27:00,560
As well, you can find out about all of the migrations.

00:27:00,560 --> 00:27:02,980
I've got a command listed here.

00:27:02,980 --> 00:27:05,160
If you're using the most recent Drush, of course...

00:27:05,160 --> 00:27:08,720
It's very important to note, actually, we didn't have a slide about this.

00:27:08,720 --> 00:27:10,740
You need to have the latest Drush.

00:27:10,740 --> 00:27:13,740
It needs to be Drush 7.

00:27:13,740 --> 00:27:19,460
You install that with Composer, so you also need to get Composer, and you get that from

00:27:19,460 --> 00:27:20,940
getcomposer.org, I believe.

00:27:20,940 --> 00:27:23,110
-There's also the option of using the Drupal.org/tools.

00:27:23,110 --> 00:27:28,110
I think that is the correct URL.

00:27:28,110 --> 00:27:33,670
-Yeah, and Acquia Dev Desktop does have this installed as well, so you could use Acquia

00:27:33,670 --> 00:27:40,610
Dev Desktop to do your migrations in this way, but you will need a bit of customization

00:27:40,610 --> 00:27:43,230
around the database connect string.

00:27:43,230 --> 00:27:57,690
We don't have that in the slide, but instead of local host it would be 127.00:3307.

00:27:57,690 --> 00:28:01,130
I have this in a blog post.

00:28:01,130 --> 00:28:03,250
If people need it, they can feel free to contact me.

00:28:03,250 --> 00:28:09,610
In any case, you can run "drush config/list," and then do "grep" to narrow it down to only

00:28:09,610 --> 00:28:14,790
migrate items, and this will list out all of the migrations that the system knows about.

00:28:14,790 --> 00:28:19,240
These are all things that can be put directly into your manifest file.

00:28:19,240 --> 00:28:26,700
Then you can run the command "drush migrate-manifest," provided a database connection string.

00:28:26,700 --> 00:28:31,160
This should be familiar if you've used other things on the command line that connect to

00:28:31,160 --> 00:28:40,270
databases, so I put here d6user:d6password@localhost/database name, which in this case is D6, and then the

00:28:40,270 --> 00:28:43,320
path to the manifest.yml file.

00:28:43,320 --> 00:28:45,640
That should be enough to get you there.

00:28:45,640 --> 00:28:55,410
-One thing to note is that on the slide, although it's two lines, it should be one line when

00:28:55,410 --> 00:28:56,410
you do it.

00:28:56,410 --> 00:28:59,370
-Yeah, so that Drush manifest, it's legacy-db-url all as one, so just be mindful that the slides

00:28:59,370 --> 00:29:05,200
couldn't quite fit that long string in there.

00:29:05,200 --> 00:29:09,410
Sometimes you'll need to customize stuff, especially if you have a custom module that

00:29:09,410 --> 00:29:11,260
you yourself have written.

00:29:11,260 --> 00:29:13,500
Perhaps you have a custom field type.

00:29:13,500 --> 00:29:18,940
A good example of something like this that took a while to get support in D7 was the

00:29:18,940 --> 00:29:20,310
address field.

00:29:20,310 --> 00:29:25,190
Maybe you're moving address field into something else or maybe you're the author of that module

00:29:25,190 --> 00:29:29,140
and you want to make a migration path for your users.

00:29:29,140 --> 00:29:34,750
You can put your plugins into your custom module, and then you will need to deal with

00:29:34,750 --> 00:29:38,310
the fact that this is a custom entity type.

00:29:38,310 --> 00:29:39,930
Nodes, those are in every site.

00:29:39,930 --> 00:29:41,490
Those are in core.

00:29:41,490 --> 00:29:46,810
We're going to deal with those, but if core doesn't know about it, then we need to deal

00:29:46,810 --> 00:29:47,810
with it.

00:29:47,810 --> 00:29:51,060
Cleanup tasks, like Novella was suggesting, with...

00:29:51,060 --> 00:29:54,570
Maybe you don't want your image fields to come through or maybe they're broken, and

00:29:54,570 --> 00:29:55,570
you don't care.

00:29:55,570 --> 00:30:00,650
Cleanup tasks could be done with some customization as well.

00:30:00,650 --> 00:30:08,150
You could actually go as far as making some of your theme, like moving your blocks into

00:30:08,150 --> 00:30:10,280
the locations in your new theme.

00:30:10,280 --> 00:30:14,700
You could do some customization for that as well, so these are just some examples of things

00:30:14,700 --> 00:30:19,850
you may wish to customize.

00:30:19,850 --> 00:30:25,740
This is just a really rough look at what the hook looks like.

00:30:25,740 --> 00:30:28,740
We were just running this before the presentation.

00:30:28,740 --> 00:30:32,690
It's really awesome if you just wanted to cycle through those elements and say, "If

00:30:32,690 --> 00:30:36,330
the field name is this, false.

00:30:36,330 --> 00:30:37,330
We don't want it.

00:30:37,330 --> 00:30:38,580
Go away.

00:30:38,580 --> 00:30:41,660
We don't need this in the new site."

00:30:41,660 --> 00:30:45,130
Another thing that's kind of important if you're new to programming in Drupal 8 is that

00:30:45,130 --> 00:30:51,480
you'll see that instead of like we have the row variable here and it's prefixed with the

00:30:51,480 --> 00:30:57,310
row type, row is a type of object.

00:30:57,310 --> 00:30:59,440
It's not an array like it was in D7.

00:30:59,440 --> 00:31:05,030
You'll have to look at the row method to see what the commands are to dump out all of the

00:31:05,030 --> 00:31:06,030
data.

00:31:06,030 --> 00:31:10,320
If you are new to working with object-oriented stuff, it's a fairly simple thing to do, but

00:31:10,320 --> 00:31:15,020
just a fair warning that this is no longer just strictly an array as with many things

00:31:15,020 --> 00:31:16,020
in the new system.

00:31:16,020 --> 00:31:20,010
-Just another tip whether you're new or not: You can run a "drush_print_r" with the hooks,

00:31:20,010 --> 00:31:23,200
and that's what really helped us out when we were doing it all afternoon.

00:31:23,200 --> 00:31:31,770
We were just looking at things as they were coming through.

00:31:31,770 --> 00:31:36,440
-Yeah, "drush_print_r," and then you put in your variable there, will give you stuff dumped

00:31:36,440 --> 00:31:37,890
out on the command line.

00:31:37,890 --> 00:31:42,070
It's a tip that works in Drupal 7 as well, so it's worth looking at.

00:31:42,070 --> 00:31:46,950
If you are like, "Why isn't this working?" and then you're like, "Okay, those three ran

00:31:46,950 --> 00:31:51,780
and then suddenly that's where it went kaboom, okay," and then you realize that maybe you

00:31:51,780 --> 00:31:58,200
have some corrupted data in your old system that maybe you want to fix.

00:31:58,200 --> 00:31:59,960
We talked a little bit about plugins already.

00:31:59,960 --> 00:32:04,210
Sorry for jumping ahead there.

00:32:04,210 --> 00:32:08,040
One important point when you do make plugins: You don't need to register them anywhere.

00:32:08,040 --> 00:32:10,380
You don't need to put them into your info file.

00:32:10,380 --> 00:32:11,380
Nothing.

00:32:11,380 --> 00:32:15,020
You just need to put it in the folder where it wants to go.

00:32:15,020 --> 00:32:26,260
If you went into "core," "modules," "migrate_drupal," "source," "plugin," "six," "source," no, sorry,

00:32:26,260 --> 00:32:28,550
almost there.

00:32:28,550 --> 00:32:33,260
Anyway, you're in the plugin, you're in "migrate," you're in "source," and then you're in "D6,"

00:32:33,260 --> 00:32:34,290
for example.

00:32:34,290 --> 00:32:35,540
You would put it in a like place.

00:32:35,540 --> 00:32:46,110
You'd put it in the same naming convention in the same folder in your own module.

00:32:46,110 --> 00:32:49,120
-Right, so really the only place, then, that you'll need to declare the plugin is on a

00:32:49,120 --> 00:32:50,120
Post-It note on your wall so you can actually list those folders out.

00:32:50,120 --> 00:32:55,010
-If you've never used plugins, there's a really awesome way you can try, and that is to make

00:32:55,010 --> 00:32:56,870
a custom block.

00:32:56,870 --> 00:33:01,350
Blocks are plugins in D8, so under your source folder or under your plugin folder, you can

00:33:01,350 --> 00:33:06,970
have a block folder, go copy an existing block from somewhere you know that's easy to use,

00:33:06,970 --> 00:33:11,230
and you can just put it there and change the name in the comments, because comments are

00:33:11,230 --> 00:33:13,990
now code.

00:33:13,990 --> 00:33:16,620
Weird.

00:33:16,620 --> 00:33:23,610
Some things that need polish.

00:33:23,610 --> 00:33:30,460
D6 migrations do have small bugs, and that's what trips up the user interface.

00:33:30,460 --> 00:33:37,190
That's what trips up the "migrate_upgrade" module.

00:33:37,190 --> 00:33:40,550
If you're able to go in there and do lots of testing when you're doing migrations for

00:33:40,550 --> 00:33:47,200
D6, please submit your patches to the core issue queue.

00:33:47,200 --> 00:33:51,590
If you have to jump over stuff, we've given you some tips on how you may be able to override

00:33:51,590 --> 00:33:56,320
that or just skip those things if they're not necessary for you.

00:33:56,320 --> 00:34:01,350
Template development is needed for Drupal 7 to Drupal 8 as well as Drupal 8 to Drupal

00:34:01,350 --> 00:34:08,089
8 because that will be a thing at some point, whether it's during beta or whether it's post-beta.

00:34:08,089 --> 00:34:09,880
There will be rescue projects.

00:34:09,880 --> 00:34:13,580
I'm looking at some smiles in the audience.

00:34:13,580 --> 00:34:15,270
Yeah, there will be.

00:34:15,270 --> 00:34:21,310
I know there are live Drupal 8 sites right now, and those are obviously not on the stable

00:34:21,310 --> 00:34:26,740
version because there is no stable version, so at some point there will need to be D8

00:34:26,740 --> 00:34:29,850
to D8 migrations.

00:34:29,850 --> 00:34:35,389
A major feature that existed in Drupal 7--well major features I guess I should say--there

00:34:35,389 --> 00:34:37,970
were things like roll-backs.

00:34:37,970 --> 00:34:40,260
You can't roll back right now.

00:34:40,260 --> 00:34:42,500
You just reinstall.

00:34:42,500 --> 00:34:45,070
Start over.

00:34:45,070 --> 00:34:50,620
Build things in modules that create your site at this point in time, and that way you can

00:34:50,620 --> 00:34:56,050
keep moving with things, build and destroy, build and destroy, use continuous integration

00:34:56,050 --> 00:35:00,150
if we're going to go buzz words here.

00:35:00,150 --> 00:35:04,600
Continuous integration is wonderful for this because it already embraces that build and

00:35:04,600 --> 00:35:06,140
destroy methodology.

00:35:06,140 --> 00:35:15,540
There were things called incremental migration.

00:35:15,540 --> 00:35:19,460
You can rerun the migration twice, three times, four times, 400 times.

00:35:19,460 --> 00:35:20,490
That's fine.

00:35:20,490 --> 00:35:26,880
It's going to be additive, so if you've added new nodes, more new nodes will come through,

00:35:26,880 --> 00:35:32,680
but you can't do things yet like limit how many things you want to import.

00:35:32,680 --> 00:35:38,190
In D7, you could say, "Limit 10," and you'd only get 10 nodes.

00:35:38,190 --> 00:35:42,830
You can't do that yet, but it was put on the road map at the end of January, so it's going

00:35:42,830 --> 00:35:43,830
to be coming very soon.

00:35:43,830 --> 00:35:45,670
-As a silver lining to the no roll-backs thing yet, you have Drush SI where, you know, you

00:35:45,670 --> 00:35:56,020
can really just site install one more time, and it'll drop your database and do everything

00:35:56,020 --> 00:35:57,470
for you.

00:35:57,470 --> 00:36:02,561
You also have Drush CEX, which is config export.

00:36:02,561 --> 00:36:05,570
-Yeah, config export will let you see all the details.

00:36:05,570 --> 00:36:08,790
If you're like, "What's happening in D6 user?

00:36:08,790 --> 00:36:09,920
How did they set that up?

00:36:09,920 --> 00:36:15,470
How was it configured?" you can either go into the module that created it, so Migrate

00:36:15,470 --> 00:36:19,560
Drupal, and under "config install" that will be there.

00:36:19,560 --> 00:36:23,230
If something has changed in the system--maybe you overrode something or maybe you want to

00:36:23,230 --> 00:36:28,760
override something--you can use config management to dump the config, see what's happening there,

00:36:28,760 --> 00:36:32,870
and then make some plans to change it.

00:36:32,870 --> 00:36:34,080
Not an expert in config management.

00:36:34,080 --> 00:36:42,890
I know there are people in the room who are, so I defer to them for more details on that.

00:36:42,890 --> 00:36:46,620
Rest assured that you can look at the YAML files that are provided by the system that

00:36:46,620 --> 00:36:50,450
provide the default implementations of each of these migrations.

00:36:50,450 --> 00:36:57,800
You can see the details of like, "This D6 UID equals D8 UID, D6 whatever the field name

00:36:57,800 --> 00:37:00,780
was gets changed into this new field name."

00:37:00,780 --> 00:37:04,430
Those things are all available to you.

00:37:04,430 --> 00:37:10,010
Of course, we've just said this many times, but it's worth repeating: Expect to re-migrate.

00:37:10,010 --> 00:37:14,410
Expect to reinstall because it's not final yet.

00:37:14,410 --> 00:37:18,920
I know if you've tried Drupal 8 and you've gone away for a couple weeks and come back,

00:37:18,920 --> 00:37:22,220
you'll probably have to reinstall.

00:37:22,220 --> 00:37:27,910
Just be aware that's going to happen until everything is stable and finally in that final

00:37:27,910 --> 00:37:34,810
0.0 branch.

00:37:34,810 --> 00:37:36,120
How you can get involved.

00:37:36,120 --> 00:37:40,010
This is kind of important because if you run into trouble maybe you'll want to tap into

00:37:40,010 --> 00:37:43,810
the community who can give you answers really quick because they're like, "Oh, yeah.

00:37:43,810 --> 00:37:48,500
We know about that," or "Oh, we should deal with that," and other things.

00:37:48,500 --> 00:37:53,330
This is how you would also get involved in developing the D7 templates or if you wanted

00:37:53,330 --> 00:37:59,300
to build templates for other platforms to bring them into Drupal.

00:37:59,300 --> 00:38:03,120
There's this Drupal Groups page, IMP.

00:38:03,120 --> 00:38:04,690
It's short for import.

00:38:04,690 --> 00:38:06,960
I think it was an acronym at some point, but I don't know what it is.

00:38:06,960 --> 00:38:09,360
There's an IRC group.

00:38:09,360 --> 00:38:13,090
There's almost always somebody in this IRC group.

00:38:13,090 --> 00:38:20,280
It's "#drupal-migrate," and it's on Freenode like every other Drupal chat that's in IRC.

00:38:20,280 --> 00:38:25,730
I believe if you've never used IRC, there's a page on Drupal.org/IRC that will give you

00:38:25,730 --> 00:38:29,600
details on how to do that.

00:38:29,600 --> 00:38:33,610
Recently we've changed the time of this, but there is a weekly call that you can do on

00:38:33,610 --> 00:38:36,170
Google Hangouts.

00:38:36,170 --> 00:38:41,680
It's important to join the IRC group before this call happens because that's how you get

00:38:41,680 --> 00:38:44,310
the URL.

00:38:44,310 --> 00:38:53,160
That happens at 9 p.m. Eastern Standard Time, which I believe is where we are right now.

00:38:53,160 --> 00:38:54,720
It's difficult to coordinate times.

00:38:54,720 --> 00:38:59,900
We're dealing with people in every time zone almost.

00:38:59,900 --> 00:39:04,220
People are scattered throughout the globe, and we've got people from Europe to Australia

00:39:04,220 --> 00:39:09,560
and everywhere in between and other places far-flung all over the globe.

00:39:09,560 --> 00:39:13,970
9 p.m. Hope you can make it.

00:39:13,970 --> 00:39:18,630
It's a great place to get support for creating your own custom plugins, and it's a good place

00:39:18,630 --> 00:39:21,680
to report problems in tests that you've run.

00:39:21,680 --> 00:39:25,700
If you're running a migration on multilingual data and you've run into something that you

00:39:25,700 --> 00:39:32,850
think is unexpected, it can be good to check in in this group, so report the problems,

00:39:32,850 --> 00:39:33,850
please.

00:39:33,850 --> 00:39:37,300
If you report the problems, that means it's going to be automatically resolved for the

00:39:37,300 --> 00:39:42,960
next person if we're able to put some code in there to fix that.

00:39:42,960 --> 00:39:50,450
-And one really important way that you can get involved: Come to the sprint tomorrow.

00:39:50,450 --> 00:39:51,450
-Yes.

00:39:51,450 --> 00:39:55,160
If you can't get Drupal 8 installed, and you're like, "Aw, this is terrible.

00:39:55,160 --> 00:40:02,930
I can't get it installed," we actually built some virtual machines that we can spin up

00:40:02,930 --> 00:40:05,280
for you if you're absolutely desperate.

00:40:05,280 --> 00:40:10,880
I hope not to do a ton of these things, but if you're absolutely stuck and you can't get

00:40:10,880 --> 00:40:15,560
it installed, do come talk to us because we would rather people are able to get in there

00:40:15,560 --> 00:40:19,280
and do some work, so we will try to help you out with that.

00:40:19,280 --> 00:40:23,619
If your machine blows up and you need to use a tablet, we can actually support that, which

00:40:23,619 --> 00:40:29,330
is sort of ridiculous but kind of awesome.

00:40:29,330 --> 00:40:31,610
I mentioned this earlier, but Drupal.org/project/drupal...

00:40:31,610 --> 00:40:38,590
I always get mixed up with these issue URLs.

00:40:38,590 --> 00:40:43,050
Anyway, the core issue queue is where you put your stuff for the D6 migrations.

00:40:43,050 --> 00:40:47,470
For D7 stuff if you're interested in that, we're going to connect you with the sandbox,

00:40:47,470 --> 00:40:49,430
and the stuff lives there for now.

00:40:49,430 --> 00:40:55,080
I tend to stay away from the sandbox myself because I like to just work with core.

00:40:55,080 --> 00:41:01,960
Again, just come to the IRC group, say "hello," as people how to connect if you're very interested

00:41:01,960 --> 00:41:02,960
in D7.

00:41:02,960 --> 00:41:08,750
Again, test, test, test your multilingual stuff.

00:41:08,750 --> 00:41:12,530
We've mentioned this.

00:41:12,530 --> 00:41:14,830
Yes, very important point.

00:41:14,830 --> 00:41:17,100
Do you want to mention this last one?

00:41:17,100 --> 00:41:18,450
No, okay.

00:41:18,450 --> 00:41:23,170
-It's a really big can of worms.

00:41:23,170 --> 00:41:26,790
-I've been through the upgrade process many times, and for my own blog, it was on D5,

00:41:26,790 --> 00:41:32,800
and I moved it to D7, and I sat down at a cafe where I could make my angry face, and

00:41:32,800 --> 00:41:34,890
someone would bring me coffee.

00:41:34,890 --> 00:41:42,381
It took me about six hours of: Okay, I went from D5 to D6, and there's bugs in the upgrade

00:41:42,381 --> 00:41:45,730
process, and then I resolved the bugs, and then I spent an hour looking for the image

00:41:45,730 --> 00:41:49,869
fields, and then I was like, "Oh, I guess I'll redo it," so I redid it.

00:41:49,869 --> 00:41:50,950
"Where are the image fields?"

00:41:50,950 --> 00:41:58,260
Then I realized there were only five images on the site.

00:41:58,260 --> 00:42:01,520
Then I upgraded to D7.

00:42:01,520 --> 00:42:07,700
All of these things sort of introduced problems because in D5 the way that we error-checked

00:42:07,700 --> 00:42:11,330
and validated things may be different than D6.

00:42:11,330 --> 00:42:16,210
Sites that have moved between different versions over and over and over, those sites are the

00:42:16,210 --> 00:42:20,880
riskiest ones to migrate, and those are the ones that we need to test the most because

00:42:20,880 --> 00:42:26,330
we may not know that sometimes user names could be formatted this weird way that we

00:42:26,330 --> 00:42:31,980
don't allow in D6, but they maybe got through the upgrade process.

00:42:31,980 --> 00:42:37,140
It would be weird, but it is possible.

00:42:37,140 --> 00:42:42,430
If you're planning on some site that was perhaps in Drupal 4.7 and then got upgraded to D5

00:42:42,430 --> 00:42:47,550
and then got upgraded to D6, and now you're like, "Okay, let's skip D7," that's a great

00:42:47,550 --> 00:42:52,150
opportunity to test that site and contribute feedback, because that's the type of site

00:42:52,150 --> 00:42:55,670
that's going to have the most unusual data in it.

00:42:55,670 --> 00:43:02,990
Then, of course, when I mentioned those five images, this is another good point.

00:43:02,990 --> 00:43:09,550
Novella recently did a brochure site for her mom, and it was new content.

00:43:09,550 --> 00:43:11,640
There was really nothing to migrate.

00:43:11,640 --> 00:43:14,010
Copy and paste would work if you're doing a five-page site.

00:43:14,010 --> 00:43:17,050
It's worth noting.

00:43:17,050 --> 00:43:22,130
Don't kill yourself on doing all this stuff unless you really want to learn.

00:43:22,130 --> 00:43:29,210
If it's a really small site, there are always these other options, but they're not the most

00:43:29,210 --> 00:43:30,210
ideal.

00:43:30,210 --> 00:43:33,860
If you do want to learn this stuff for your bigger projects, then investing that time

00:43:33,860 --> 00:43:35,290
can be very valuable.

00:43:35,290 --> 00:43:39,230
-Just to put a plug in there for copy and paste.

00:43:39,230 --> 00:43:45,670
It's a really great way to learn the interface for D8, and the interface for D8 is excellent.

00:43:45,670 --> 00:43:57,360
I was able to actually teach it to my mom in one evening.

00:43:57,360 --> 00:43:58,360
Let me just say it's for individuals.

00:43:58,360 --> 00:43:59,360
It's for businesses.

00:43:59,360 --> 00:44:00,360
It's for everybody, and that is a completely legit way to migrate your stuff.

00:44:00,360 --> 00:44:02,200
-If it's a very small site, you may just want to do this for research purposes.

00:44:02,200 --> 00:44:07,320
It will get you there, but it is worth noting Drupal 8's great for small sites.

00:44:07,320 --> 00:44:12,700
As Larry mentioned earlier this morning, you can do big or small and all sorts of different

00:44:12,700 --> 00:44:15,870
types of sites.

00:44:15,870 --> 00:44:20,880
I mentioned doing continuous integration.

00:44:20,880 --> 00:44:24,060
We've kind of been working with this on a new site that we're kind of doing a mixed

00:44:24,060 --> 00:44:28,010
thing, so we're working on our own agency sites.

00:44:28,010 --> 00:44:31,170
We have new content for most of the front-end stuff.

00:44:31,170 --> 00:44:37,619
We're actually using a module that we built that sets most of our new settings and creates

00:44:37,619 --> 00:44:41,760
some of our new content, and then we're using a migration for the rest.

00:44:41,760 --> 00:44:46,520
These mixed mode kind of things will work with your continuous integration practices,

00:44:46,520 --> 00:44:52,050
so that's another thing to be mindful of, and, again, another reason to use Drush if

00:44:52,050 --> 00:44:56,150
you don't just want to, "boom," import everything.

00:44:56,150 --> 00:45:00,580
Nobody likes to migrate and then have to do a whole bunch of little tasks afterward, because

00:45:00,580 --> 00:45:02,810
then you have to remember all of those tasks.

00:45:02,810 --> 00:45:06,490
If the project gets put on hold, you have to remember all those tasks, and you can't

00:45:06,490 --> 00:45:09,980
sleep at night because you're remembering all these tasks.

00:45:09,980 --> 00:45:17,260
We're at the end.

00:45:17,260 --> 00:45:21,450
I've got four links that I've been plugging since I was at BADCamp, and these things are

00:45:21,450 --> 00:45:24,869
things that you can use to teach yourself Drupal 8.

00:45:24,869 --> 00:45:29,140
By teaching yourself Drupal 8, all of the stuff that we cover today will be really,

00:45:29,140 --> 00:45:31,100
really easy.

00:45:31,100 --> 00:45:36,010
The first is the developer guide that's on www.drupal.org.

00:45:36,010 --> 00:45:40,480
That one is edited frequently by people, and if it goes out of date please click "edit"

00:45:40,480 --> 00:45:43,190
and update it.

00:45:43,190 --> 00:45:50,280
If you're logged in to Drupal.org, go to this page, scroll to the bottom, click the "printer

00:45:50,280 --> 00:45:59,020
friendly" link because it will render all the sub-pages in one long HTML file, then

00:45:59,020 --> 00:46:02,130
you can just read it like a book.

00:46:02,130 --> 00:46:05,010
It's fabulous doing that.

00:46:05,010 --> 00:46:11,260
That will get you through most of the API changes that you need to know about as a developer,

00:46:11,260 --> 00:46:15,800
and that will get you a background on configuration management, which is how all of this stuff

00:46:15,800 --> 00:46:19,050
like the manifest files, how those are constructed.

00:46:19,050 --> 00:46:21,620
All of that stuff is configuration management.

00:46:21,620 --> 00:46:25,220
If you read the developer guide, even the first couple chapters, you're going to have

00:46:25,220 --> 00:46:32,370
a really good understanding of how you can override all this stuff really easily.

00:46:32,370 --> 00:46:36,430
Examples module has been used for years.

00:46:36,430 --> 00:46:41,160
It's up-to-date as well, so if you're looking for, "How do I make a block in code?

00:46:41,160 --> 00:46:42,470
How do I do stuff like that?"

00:46:42,470 --> 00:46:48,460
go into that module if you're curious about how to do an implementation of something because

00:46:48,460 --> 00:46:51,000
there is up-to-date stuff in there.

00:46:51,000 --> 00:46:58,660
I actually went into the examples module and used those to upgrade the developer guide.

00:46:58,660 --> 00:47:03,040
Examples module is very up-to-date, so that's very useful.

00:47:03,040 --> 00:47:11,030
The API docs on api.drupal.org are also up-to-date, but this is the documentation that's generated

00:47:11,030 --> 00:47:14,770
from the comments in code.

00:47:14,770 --> 00:47:20,760
It's useful, but that needs to go through code review before it gets in.

00:47:20,760 --> 00:47:25,180
There's less opportunity to add in a little "oh, you need to do this also."

00:47:25,180 --> 00:47:30,100
It's harder to change that stuff because it's not just something you can click edit.

00:47:30,100 --> 00:47:37,310
Lastly, the most important, awesome one on this list: Change records.

00:47:37,310 --> 00:47:42,670
If you're going in and starting to code something for your site, if you're doing a continuous

00:47:42,670 --> 00:47:46,810
integration module or just, "Where did this go?"

00:47:46,810 --> 00:47:53,540
I know one time I was trying to use the Watchdog command, and I was like, "Watchdog does not

00:47:53,540 --> 00:47:54,540
exist."

00:47:54,540 --> 00:47:55,540
Okay.

00:47:55,540 --> 00:47:58,500
What do I do?

00:47:58,500 --> 00:48:00,400
There's no Watchdog.

00:48:00,400 --> 00:48:03,520
No, I shouldn't do any crazy things.

00:48:03,520 --> 00:48:08,340
I should go to the change records page, and I just put in the word "watchdog" or whatever

00:48:08,340 --> 00:48:13,790
the command I'm trying to run that no longer exists, paste it into the search form, and

00:48:13,790 --> 00:48:20,580
it's going to give you a change record that says, "Watchdog became this and here's how

00:48:20,580 --> 00:48:23,550
you use it--the old way and the new way."

00:48:23,550 --> 00:48:26,180
You can copy and paste that into your code and go home.

00:48:26,180 --> 00:48:27,180
-It's also just a good general resource when you have errors.

00:48:27,180 --> 00:48:28,180
Sometimes they are just because something may have changed, so list changes if you can't

00:48:28,180 --> 00:48:30,630
find it in the issue queue or just search both.

00:48:30,630 --> 00:48:40,280
List changes is definitely a really great place for that.

00:48:40,280 --> 00:48:43,960
This can also be really useful if you started working on a Drupal 8 site and then you got

00:48:43,960 --> 00:48:48,869
distracted for two weeks, and then it's broken for some reason when you update it, and you're

00:48:48,869 --> 00:48:50,180
like, "What changed?"

00:48:50,180 --> 00:48:51,180
That's what changed.

00:48:51,180 --> 00:48:54,950
There will be entries in there that will say, "These three things changed since you were

00:48:54,950 --> 00:48:59,750
here two weeks ago," and you can just look at them and go, "Ah, it's probably that because

00:48:59,750 --> 00:49:01,990
I'm using that function.

00:49:01,990 --> 00:49:03,110
Okay, cool."

00:49:03,110 --> 00:49:05,040
Change records, wonderful.

00:49:05,040 --> 00:49:09,890
Thanks, change record team.

00:49:09,890 --> 00:49:11,730
We've got a few minutes for questions.

00:49:11,730 --> 00:49:16,410
Four minutes for questions, so Jess?

00:49:16,410 --> 00:49:18,030
Microphone.

00:49:18,030 --> 00:49:33,070
-I have a correction/clarification, a recommendation, and then an actual question.

00:49:33,070 --> 00:49:34,070
-Okay.

00:49:34,070 --> 00:49:40,100
-The clarification, I just wanted to say regarding Drupal 8 to Drupal 8 updates and migrations,

00:49:40,100 --> 00:49:41,770
we didn't kill update.php.

00:49:41,770 --> 00:49:44,780
Update.php is still in core.

00:49:44,780 --> 00:49:50,190
What we did kill is that you can't ever use it for upgrading from one version of Drupal,

00:49:50,190 --> 00:49:52,530
like a major version like Drupal 7 to Drupal 8.

00:49:52,530 --> 00:49:57,440
By default, when Drupal 8 ships you will still be using update.php to upgrade from 8.0.0

00:49:57,440 --> 00:50:04,760
to 8.0.1, for example, and also between betas you'll also be using update.php.

00:50:04,760 --> 00:50:07,950
If you're a developer, you've written a module, you'll be writing the same old hook update

00:50:07,950 --> 00:50:14,280
for that, but eventually we would also like to include on Drupal 8 source plugins, so

00:50:14,280 --> 00:50:17,590
that you can do those Drupal 8 to Drupal 8 migrations as well.

00:50:17,590 --> 00:50:22,470
The idea being that when you're running a minor update, you don't necessarily want to

00:50:22,470 --> 00:50:24,790
create and build out a second site for that.

00:50:24,790 --> 00:50:28,540
Sometimes you just need to fix one little thing, and so an update hook is all you need.

00:50:28,540 --> 00:50:33,950
That's just a minor clarification there, but soon update.php is still there, you just can't

00:50:33,950 --> 00:50:35,880
use it to migrate anymore.

00:50:35,880 --> 00:50:42,990
Then the recommendation is regarding Views migrations.

00:50:42,990 --> 00:50:47,359
I worked on the Views and core team, and I would strongly recommend that you consider

00:50:47,359 --> 00:50:54,530
just rebuilding your views in the UI after you've migrated the rest of your data.

00:50:54,530 --> 00:50:59,491
It's great that someone's trying to build a plugin for that, but the Views API is so

00:50:59,491 --> 00:51:07,220
complex, the data model is so full of things, not only is it very different under the hood

00:51:07,220 --> 00:51:11,280
than it was in Drupal 7, but also that last link on Ryan's last slide about change records,

00:51:11,280 --> 00:51:13,900
we kind of sort of don't really have them.

00:51:13,900 --> 00:51:19,460
There are two of them about minor things, maybe, but the major ones that tell you the

00:51:19,460 --> 00:51:23,619
important things to change aren't there, so it's going to be difficult to write accurate

00:51:23,619 --> 00:51:25,720
migrations for Views for that reason.

00:51:25,720 --> 00:51:29,450
You might want to consider: Do everything else, and then just rebuild the view because,

00:51:29,450 --> 00:51:34,190
honestly, it's probably going to be faster than trying to fix all of the bugs with it.

00:51:34,190 --> 00:51:37,550
I don't want to take up too much time, but my question was about the manifest files.

00:51:37,550 --> 00:51:38,620
You said that...

00:51:38,620 --> 00:51:40,390
First of all they're not required, right?

00:51:40,390 --> 00:51:42,940
It's just an optional thing that you can add on?

00:51:42,940 --> 00:51:46,590
-They are required if you're running them in Drush.

00:51:46,590 --> 00:51:47,590
It's the only way, yeah.

00:51:47,590 --> 00:51:51,940
-The second thing was you said that it would give you an error message if you, for example,

00:51:51,940 --> 00:51:55,580
tried to put a line in for importing nodes before users.

00:51:55,580 --> 00:51:58,960
-No, not the order, but just if you omitted something.

00:51:58,960 --> 00:52:00,000
-Oh, if you omitted.

00:52:00,000 --> 00:52:01,720
Okay, yeah.

00:52:01,720 --> 00:52:03,440
It will actually order them for you.

00:52:03,440 --> 00:52:04,440
-Yeah, it will.

00:52:04,440 --> 00:52:10,740
There was a bug during BADCamp where one of them was out of line, and it was fixed.

00:52:10,740 --> 00:52:13,109
I believe it was fixed at least.

00:52:13,109 --> 00:52:17,800
It will automatically resolve all the dependencies and order them correctly, but if you forgot

00:52:17,800 --> 00:52:19,920
one, it will be like, "Oh, I do need that.

00:52:19,920 --> 00:52:21,810
Please add that."

00:52:21,810 --> 00:52:23,190
Thanks for those tips.

00:52:23,190 --> 00:52:24,190
That's wonderful.

00:52:24,190 --> 00:52:29,010
Actually, one quick question back to you: Did upgrade.php get removed and brought back

00:52:29,010 --> 00:52:30,210
in?

00:52:30,210 --> 00:52:33,810
No, it didn't.

00:52:33,810 --> 00:52:36,210
Okay, interesting.

00:52:36,210 --> 00:52:39,930
Rebuilding Views as been something that we've often redone between versions, so that is

00:52:39,930 --> 00:52:43,869
really important to know, so thank you again for those tips.

00:52:43,869 --> 00:52:45,170
-In Spanish.

00:52:45,170 --> 00:52:52,980
-Okay, we'll direct to Novella.

00:52:52,980 --> 00:53:14,530
-[Spanish] -Do you want to just repeat that 

00:53:14,530 --> 00:53:15,530
in English?

00:53:15,530 --> 00:53:20,290
-No, I didn't understand the question.

00:53:20,290 --> 00:53:21,290
-Okay.

00:53:21,290 --> 00:53:24,340
-Maybe somebody else can.

00:53:24,340 --> 00:53:30,270
-[Spanish] -He is saying that in Drupal 6, user passwords

00:53:30,270 --> 00:53:36,050
were stored in MD5 but in Drupal 7 it is hush.

00:53:36,050 --> 00:53:42,930
I really don't know how it is in Drupal 8, but how are you dealing with that?

00:53:42,930 --> 00:53:47,770
-It's dealt with in the same way it was between the upgrade from Drupal 6 to Drupal 7.

00:53:47,770 --> 00:53:52,680
I believe it's actually the same code, just running in a different place, and I believe,

00:53:52,680 --> 00:53:58,230
if I'm not mistaken, the format I think is the same between 7 and 8.

00:53:58,230 --> 00:54:01,050
The hushing strategy is the same.

00:54:01,050 --> 00:54:04,260
It's the same idea that it did from Drupal 6 to Drupal 7.

00:54:04,260 --> 00:54:10,430
It will convert them, and it deals with it in a way that is secure.

00:54:10,430 --> 00:54:16,500
I don't know the specific details because I haven't dealt with this in D8, but I have

00:54:16,500 --> 00:54:31,950
looked at the function in D7, and it does a transformation, and 

00:54:31,950 --> 00:54:36,310
that code has been brought over.

00:54:36,310 --> 00:54:37,980
Other questions?

00:54:37,980 --> 00:54:41,020
-Can I speak in Spanish?

00:54:41,020 --> 00:54:42,650
-You can try.

00:54:42,650 --> 00:54:48,090
-[Spanish] -Do you mean what is our experience with trying

00:54:48,090 --> 00:54:49,510
to do things...

00:54:49,510 --> 00:55:07,690
-I'm saying that now the migration process is not ready to do Drupal 7 to Drupal 8, but

00:55:07,690 --> 00:55:10,180
you know how to do it with Drupal 6 to Drupal 8.

00:55:10,180 --> 00:55:16,480
How do you think that is going to be, the migration process, in the future of course

00:55:16,480 --> 00:55:19,099
about Drupal 7 to Drupal 8?

00:55:19,099 --> 00:55:20,960
-The same strategy exactly.

00:55:20,960 --> 00:55:25,910
We will put a copy of the Drupal 7 templates.

00:55:25,910 --> 00:55:27,590
The same strategies will apply.

00:55:27,590 --> 00:55:32,400
If you go to migrate upgrade user interface, you just put in the database credential.

00:55:32,400 --> 00:55:34,540
It will detect that it is Drupal 7.

00:55:34,540 --> 00:55:40,150
It will know that it understands Drupal 7, and it will run them.

00:55:40,150 --> 00:55:44,859
This is why we have Migrate module and Migrate Drupal module, so that the Migrate module

00:55:44,859 --> 00:55:52,160
is generic, and it can run any platform, and then Migrate Drupal is just the specific.

00:55:52,160 --> 00:55:54,240
Then on Drush, again, same thing.

00:55:54,240 --> 00:55:56,240
You just list the name of migration.

00:55:56,240 --> 00:56:05,240
In that case, the name of migration will be "D7_user," so the naming will be different.

00:56:05,240 --> 00:56:07,420
I think we've been called for time.

00:56:07,420 --> 00:56:09,710
Thank you, everyone.

00:56:09,710 --> 00:56:10,470

YouTube URL: https://www.youtube.com/watch?v=sxNCSrDSI6g


