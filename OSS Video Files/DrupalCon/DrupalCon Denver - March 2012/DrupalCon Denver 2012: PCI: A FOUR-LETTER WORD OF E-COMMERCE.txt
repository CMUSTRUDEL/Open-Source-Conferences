Title: DrupalCon Denver 2012: PCI: A FOUR-LETTER WORD OF E-COMMERCE
Publication date: 2013-03-28
Playlist: DrupalCon Denver - March 2012
Description: 
	The Payment Card Industry Data Security Standard (PCI DSS) is a huge, scary set of policies and procedures intended to optimize the security of credit, debit and cash card transactions. When you first get started the idea of becoming (and staying) compliant seems like a Labor of Sisyphus. We know we should comply with the PCI Security Standards, right? But at first glance, it seems like a lot of effort, and confusing to boot. But not only is compliance becoming increasingly important, it may not be the problem you expected. (Then again...) During this session we will briefly go over the PCI-DSS and basic do's and don'ts to get you on your way to PCI Compliance.
Captions: 
	                              good afternoon everyone it seems awfully                               quiet yeah hello                               I wanted to walk around anyway good                               afternoon hi my name is Matt I work at a                               company called Lola BOTS we're doing                               talk here about pci compliance and how                               it would apply to your Drupal sites so                               this is kind of really what we want                               right it's the end game everybody wants                                to be able to collect credit card data                                or at least collect payments on their                                website because hey making money is fun                                hey ecommerce is kind of the goal here's                                a little bit about me I've been doing                                Drupal for about five years and I'm                                going to tell the story today a little                                bit about my past and doing pci from the                                trenches if you will I'm a member of the                                Drupal security team and I'm a senior                                development at a company called lullaby                                we've had the great opportunity to work                                with a lot of these cool companies but a                                lot of my pc i experience doesn't come                                from lowell the bots for what it's worth                                but who am I not right i am not a pci                                dia qualified security assessor i'm not                                a qsa just wanted to throw that out                                there right now i'm also not a lawyer                                and today i'm not going to be willing to                                provide references for web hosting                                scanning vendors consultants that kind                                of thing i'm not sure that that's a                                discussion that can lead to anything                                productive so we'll just avoid that kind                                of talk today I will tell you a little                                bit of a story back from my previous job                                I was in the nonprofit world doing web                                development doing Drupal development and                                I had a co-worker come down the hall and                                give me one of these looks Matt yeah                                you've been doing some really great                                Drupal work yeah I hear this makes                                websites easy oh yeah I suppose so                                Regina is in charge of the development                                department she's wants fundraising to                                happen and there are things that she                                wants fundraising wise on her website                                and there's a way that she wants it to                                work Regina explained to me that you                                know I really need to collect credit                                card information and I need that                                information to get plugged into our                                database because our database does the                                recurring billing we have this fancy                                database and you know it's got all our                                customer records in it I got all their                                history in it and being able to                                right in there off of our website that                                collects credit card data and you know                                maybe charge the card the first time so                                they're making a donation to us right                                away and I thought yeah why not right                                it's forms i know drupal form api there                                are plenty of other ways to go about                                this in Drupal I'd love to be able to                                integrate this directly with our                                database system but you know I'm not all                                that familiar with that API and it's                                very complicated and probably doesn't                                want to play well with PHP anyway so I                                go back to my desk and I keep back a                                little bit start running through the                                google honestly that probably is about                                what my desk looked like start running                                through google thinking okay we're                                dealing with credit cards it's something                                that's new to me it's probably going to                                be a little bit difficult and i                                definitely want to do it the right way                                right especially if i'm going to be                                storing credit cards and i started                                scratching my head on that one a little                                bit it's like you know boy this is going                                to be a secure data pretty pretty I mean                                there's going to be a need for a pretty                                secure data store I better make sure I                                do that right and the server that I have                                running you know in the in the supply                                room running my or my other little micro                                sites probably wouldn't be a good idea                                to do it there so and security and                                encryption trying to figure out all                                these things and i ran across the                                document that probably looked about like                                that and i started reading it yeah it's                                a tough one and i thought wow this is a                                very detail there's a lot of good                                information here and it's probably going                                to tell me the right way to do it but                                 it's not going to be as easy as I                                 initially thought so I got on the phone                                 and I called my boss I called Bob and I                                 said Bob you know Regina came down the                                 hall and described this great projects                                 mean it's gonna help fund raising out a                                 bit and it's really going to help our                                 position you know in the in the company                                 you know being the IT folks you're                                 always trying to help people out because                                 you're always telling people no and                                 telling them you know don't break the                                 other computer and that kind of thing                                 Bob I'd really like to be able to do                                 this but I found this thing called pci                                 and it's probably going to affect the                                 way we're dealing with credit cards in                                 the organization otherwise and you know                                 they're probably some challenges that                                 are going to have to come about about                                 that time you know that's about what                                 that phone call started to look like and                                 Bob started getting upset not about what                                 I was saying but knowing that                                 he was probably going to have to spend                                 the next year or so of his life sitting                                 in conference rooms about like this                                 discussing it because one thing that psi                                 PCI isn't it's not a just a problem for                                 the IT staff it's not just a problem for                                 the people who are collecting credit                                 card information it's really going to                                 affect anyone's organization or anyone's                                 business business wide everyone in the                                 organization will probably see at least                                 some touch of PCI so PCI is the payment                                 card industry data security standard the                                 PCI DSS that's what we're talking about                                 here today primarily so the payment card                                 industry consists of the major card                                 payment brands who came together and                                 decided that this is going to be one                                 standard that will rule them all it's                                 going to be the way that it will be done                                 properly and this is what we were going                                 to expect of everyone because originally                                 everybody tried to go off on their own                                 tangent and say this is the way visa                                 wants to do it this is the way                                 MasterCard wants to do it and they                                 decided that getting it all together in                                 one list of standards is probably the                                 best way of going about it and that                                 document is the pci data security                                 standard it's also important to point                                 out that the PCI DSS is not a law it's                                 not legislation and forced by the                                 government anything like that it's only                                 the credit card companies that hold                                 these policies over us this is the                                 probably the most important thing if                                 you're interested in pci if you're                                 charging transmitting processing or                                 storing credit card data it applies to                                 you period but I'm not storing it you're                                 right it applies to you but I'm using                                 SSL guess what it applies to you you're                                 going to probably have to go a little                                 bit further into the way that you're                                 currently doing things to make sure                                 you're doing it along the right the                                 lines that the PCI DSS asks you to do                                 in the end we really just want to avoid                                 data breaches right that's a article                                 that's probably a little difficult to                                 read but I'm not expecting you to read                                 it talking about the heartland payment                                 system it's a very famous big data                                 breach from a few years ago tons of                                 credit card information was stolen but                                 they're a pendant but they are a payment                                 vendor but it's something that has                                 really affected them right dozens of                                 lawsuits formal inquiry by federal                                 organizations of course it affects their                                 stock value that's a huge example and                                 you probably don't process that many                                 credit cards so you're thinking you know                                 I'm just the little guy here right I am                                 NOT heartland I am NOT you know Walmart                                 I am NOT amazon I'm just a little guy                                 trying to sell t-shirts in my uber cart                                 store you have to keep in mind that most                                 of the examples of unauthorized access                                 to sensitive information like credit                                 card data come from the little guys and                                 the little guys make up most of the                                 vendors also there are people looking                                 for you about the third of data breaches                                 come out of malicious attacks so it's                                 also something that's going to be pretty                                 expensive for you if something bad were                                 to happen and here might be a good thing                                 for you to see that the credit card                                 provider can then become liable if the                                 retailer was PCI compliant if you're                                 doing things the right way you can rest                                 assured that things will be out of your                                 hands here's another major data breach                                 that you've probably all heard of within                                 the last year or so the Sony network                                 lost a lot of information and I'm not                                 going to say that this I mean I'm sure                                 this affected them financially without a                                 doubt but I think in my opinion this                                 probably affected them on a reputational                                 level more than a financial level this                                 came across my twitter feed and if you                                 read what my friend shawn has to say you                                 might think he's a little bit nutty                                 there's a access from an IP on china                                 my box because of the PlayStation breach                                 now i would think that too if I didn't                                 know that Sean was the former CTO of a                                 publicly traded software company and                                 definitely was the propeller head and                                 kind of knows what he's talking about is                                 this really true is this what happened I                                 don't know but really it doesn't matter                                 because in today's social world this is                                 the kind of thing that people are going                                 to see this is what I remember from that                                 actual exploit so there's a financial                                 risk the vendors have a data breach will                                 cost you in fees as well as perhaps                                 fines and suits but there's that                                 reputation illrick as well and you need                                 to make sure that you're dealing with                                 your clients payment information                                 personal information in the best manner                                 possible so hopefully I've convinced you                                 that this is actually probably a good                                 thing right that we have these                                    requirements set forth by the PCI                                 Council that are going to outline the                                 best ways for us to handle sensitive                                 credit card data and information we like                                 to calm the Dirty Dozen anyway I'm going                                 to run through the                                                      won't have time to get into a lot of                                 detail but keep in mind all of this                                 information is out there and you can go                                 read it for yourself I'm just going to                                 touch on the                                                        quickly you'll find that a lot of them                                 are really security best practices and                                 it's something that you probably should                                 be doing anyway but this is making sure                                 that you understand that for example                                 requirement number one you need your                                 firewall to protect your cardholder data                                 right everybody should have a fire while                                 you probably have a firewall anyway one                                 thing that the requirement does say is                                 it does need to be a stateful firewall                                 and it needs to be configured properly                                 and you'll have to document that                                 configuration but right who doesn't want                                 to firewall in the first place yeah a                                 firewall requirement number two is                                 another one that is going to kind of                                 sound like a no-brainer but don't use                                 vendor-supplied defaults for your system                                 passwords and security parameters this                                 is another one of those                                 really people do that right you're going                                 to log onto your computer and you look                                 for a Wi-Fi network and you see one                                 called linksys and you think the                                 password is admin and there's no                                 username I can get into this one right                                 the same holds true to a lot of other                                 network quick equipment as well you need                                 to make sure that you're not subject to                                 doing silly things like this requirement                                 number three is protect stored                                 cardholder data requirement number three                                 has to do with a lot of the encryption                                 that might take place behind the scenes                                 as well as what types of data are okay                                 to store what types of data are not okay                                 to store it's it's a fairly interesting                                 one to read actually requirement number                                 three number four is encrypting the                                 transmission a lot of times you hear                                 people say yeah I use SSL and so I must                                 be doing things right yeah great you're                                 all set with requirement number                                         go requirement number                                                   an update your antivirus software and                                 programs you have to keep in mind that                                 the PCI DSS was written for a very broad                                 scope of possible applications right                                 this could be a desktop application that                                 someone from data entry is going through                                 the mail entering credit card data                                 submitting some kind of form that's                                 going off to the payment gateway and                                 perhaps logging that that tracks that                                 transaction happened so on that Windows                                 machine you definitely want that to                                 happen and actually the standard says                                 you need to have an antivirus on types                                 of os's that don't that you don't need                                 to have an antivirus on types of s's                                 that are not subject to viruses trojans                                 that kind of thing and the example that                                 it gives is a mainframe good times                                 requirement number                                               maintain secure systems and applications                                 this really has to do with how you're                                 developing your software your practices                                 for dev staging and release code reviews                                 really come in in requirement number                                   is just kind of making sure that you                                 know and understand your code base as                                 well as promotions to live servers that                                 kind of thing number                                               cardholder data by business need to know                                 so if you don't need to know this                                 information by golly you shouldn't have                                 it it's another one of those best                                 security practices right the least                                 permissions needed to get the job done                                 so obviously if there's a business need                                 to know then you know if you need to                                 know some sensitive information or have                                 access to sensitive systems then you                                 have to do it to do your job but that                                 kind of thing needs to be documented                                 will learn about documentation here a                                 little bit more as far as the                                 requirements are concerned require and                                 number eight is asking that we everyone                                 who logs on to a system gets a unique ID                                 something that's fairly important I know                                 that I've worked on systems often that                                 have an administrator account or people                                 share access to servers that kind of                                 thing everybody needs to have unique ID                                 because that really comes into play when                                 you're talking about logging you need to                                 be able to reconstruct where things                                 happen when things happens why things                                 happen who changed what and if someone                                 does not have their own account it's                                 much harder for that to be tracked                                 requirement number nine deals with                                 physical security you can do it all                                 right from the ones and zeros side of                                 things but if you leave the door                                 unlocked or keep your server in the                                 break room nothing is stopping someone                                 for picking it up and walking away with                                 it so physical security is definitely                                 something that might need to be                                 considered if you're in your own hosting                                 environment which I've been before                                 that's kind of fun requirement number                                 ten you need to be able to track and                                 monitor all network resources and                                 cardholder data this really comes into                                 play with the logging side of things and                                 the logging requirements that are                                 involved and then number                                           testing of security systems and                                 processes you'll need that those                                 official testing procedures in place and                                 documented and number                                                 the documentation you need information                                 security policies there is a training                                 requirement for your people that kind of                                 thing you need to keep stuff on paper or                                 at least written down here's some of my                                 favorite takeaways from the standard                                 itself my favorite one is you really                                 shouldn't be storing cardholder data                                 unless you absolutely need to and if you                                 need to you're probably going to be way                                 cooler than me                                 and you're going to have some serious                                 security professionals looking at your                                 setup the requirement states that you                                 shouldn't source certain types of data                                 certainly the credit card number                                 shouldn't be stored in plain text but                                 there's also a full track data that                                 comes on the credit card extra                                 information that you may not know that                                 exists as a part of your magnetic strip                                 as well as pin numbers or that CV to cv                                 to cvv that code on the back of your                                 card that's information that you should                                 never store the first six and the last                                 four digits of the credit card number or                                 fair game that's the maximum that should                                 be displayed keep in mind that there's a                                 very specific algorithm to credit card                                 numbers and the more information people                                 have about the numbers that exist the                                 easier it might be to reconstruct a                                 credit card number based on the                                 information that you have so the less                                 data that you have the better off you'll                                 be this is really the big one read                                 through requirement over                                         carefully document everything if it's                                 not on paper it never happened and again                                 on paper get it in writing from your                                 vendors and service providers frequently                                 you'll have to work with other companies                                 be them hosting companies be then your                                 payment processor or perhaps some other                                 third-party vendors that you need to                                 work with you need to understand that                                 their compliance their non-compliance                                 will mean your non-compliance so you                                 need to make sure that they're doing                                 everything properly from a compliance                                 perspective because it means that you'll                                 be doing everything compliant correctly                                 from a compliance perspective this is a                                 process that means you're never done                                 when you're finished with compliance if                                 you will you've you've gone through all                                 of the proper steps and you can say yes                                 I'm compliant keep in mind that tomorrow                                 if somebody does something you may not                                 can be compliant so it compliances the                                 idea of compliance is a snapshot in time                                 you're always it's always in motion you                                 need to always be assessing remediating                                 problems that you might find and                                 reporting and documenting that                                 of information okay we got through the                                                                                                       some math but don't worry ill be too                                 easy that test comes in the form of the                                 saq the self-assessment questionnaire                                 there are five different ones depending                                 on what type of business you do keeping                                 in mind that the PCI DSS applies to the                                 local gas station as much as it applies                                 to amazon com as much as it applies to                                 Frank's t-shirt store so here are the                                 five and here kind of what they do but                                 since we're all at drupalcon I'm going                                 to knock a couple off the list because                                 they don't involve e-commerce they're                                 more manual storefront type methods                                 perhaps even the old-school knuckle                                 Buster card swipers but SI q ay SI q SI                                 and si QD are going to be the tests that                                 you'll take if you will to prove your                                 compliance when you're dealing with                                 e-commerce one or one of these three                                 depending on your particular situation                                 I'll talk about these three and a little                                 more depth SI q ii has SI q a has to do                                 with an e-commerce set up where all                                 payment card processing is out sourced                                 so no sensitive information ever hits                                 your server it's the most easiest one by                                 far there'll be about                                              covering two of the                                                    really is going to deal with your                                 physical security if you happen to have                                 access to data and your information                                 security possible the pilot policies the                                 stuff that's on paper documenting that                                 you're doing everything in the proper                                 manner possible SI QA is most likely                                 found in folks who do the whole paypal                                 go to the paypal site and pay the bill                                 and then your return back to your                                 website after the bill is paid a lot of                                 folks really try to avoid that because                                 they feel that someone wanting to buy                                 something from them site their site will                                 kind of back out when they go to paypal                                 and you know the transaction isn't as                                 smooth that kind of thing there are some                                 really cool vendors out there now doing                                 tokenization which allows the sensitive                                 data to be offloaded from your server                                 but allows a seamless checkout process                                 here's a little neck here's a little                                 network diagram kind of                                 showing how that might work at the                                 bottom is the user of your website who                                 puts in their credit card information                                 into your form in your check out that                                 form is then submitted but instead of                                 going to your website the sensitive                                 information is then posted directly to                                 the payment processor who then returns a                                 meaningless token to the user often                                 times you'll see that that was that's a                                 client-side request it could be a                                 server-side request but that meaningless                                 token comes back to the user and then                                 the form is and then immediately posted                                 to your web server with the token as                                 well as any other information that you                                 want a check out so your web server then                                 says hey I have a token I also have this                                 secret key that my administrator has set                                 up so I'm going to give this token and                                 the secret key over to the payment                                 processor the payment processor is going                                 to say hey this is that token I just                                 gave out and here's that key for my my                                 favorite merchant and now I get to                                 charge this person forty dollars or                                 whatever and then it's returned as                                 successful or whatever back to the user                                 saq see us for more of a standard                                 ecommerce setup where you may be sending                                 sensitive data through your server but                                 you're not necessarily storing you're                                 not storing your sensitive data if                                 you're able to fill out saq see it is a                                 little bit longer                                                    covering about                                                     requirements it really has to do with                                 how well you're securing that sensitive                                 data and it's transfer as well as any                                 sorts of monitoring and testing and of                                 course the documentation and that kind                                 of thing that comes with the other                                 systems and because I liked building                                 network diagrams and that was really a                                 whole lot of fun it's more of a standard                                 set up right where that sensitive data                                 is then sent straight to your web server                                 the web server turns around and says hey                                 I need to make payment here's the data                                 to the payment processor and the payment                                 processors has great and then success is                                 returned throughout the chain                                 SI q de is really the other form anyone                                 who may not necessarily fit any of the                                 slots that have been outlined end up                                 with SI QD also if you end up in the                                 world where you're storing sensitive                                 information you'll end up filling out SI                                 QD as well it can be fairly fairly                                 upsetting because it is fairly long and                                 you are getting a full overview of the                                 requirements that I've outlined                                        of                                                                       looks into how you might be doing                                 sensitive data storage that kind of                                 thing but as a QD is something that if                                 you can avoid filling out sa QD it's                                 going to save you a lot of time and                                 possibly expense by not storing credit                                 card information and we're being                                 required to fill out a say QD that kind                                 of thing so along with which SI q you'll                                 need to fill out it's also something to                                 note that you'll have a merchant level                                 as given to you by the different credit                                 card brands there are levels                                             and sadly even though the data security                                 standard is one standard to rule them                                 all each of the merchants have their own                                 slightly different version of what these                                 levels mean to them but if you are a                                 level                                                               level to other merchants as long as it's                                 the higher one so if I'm a level                                       one merchant i'm also a level                                           of the other merchants as well and the                                 levels really dictate what you'll have                                 to do to gain compliance according to                                 the credit card grant                                 this is a screenshot taken off of the                                 visa website dictating those levels and                                 what those levels mean to them just note                                 that there's levels one through four and                                 it's asking every for each of those                                 levels that they have a quarterly                                 network scan done by an approved                                 scanning vendor as approved by the pc                                 ice council it also says that you'll                                 probably you'll have to do the annual                                 saq for all of the levels level one our                                 folks who do over six million                                 transactions per card type so that means                                 i'm doing six million in one visa                                 transactions or mastercard or discover                                 card it will be a full overview of your                                 security procedures and you won't be                                 able to fill out your own as you won't                                 be able to fill out your own                                 self-assessment questionnaire they will                                 make a qsa a qualified security assessor                                 someone who's been blessed by the                                 council that this person has been                                 trained and they know what they're doing                                 to you'll have to hire them and bring                                 them in and make them a part of your                                 process to a compliance also merchants                                 who have had a previous data breach will                                 likely get bumped up to become level one                                 which can be a very expensive thing for                                 a small business level two merchants are                                 doing less trans yes sir question okay                                 the last fighter level two you're doing                                 fewer transactions one thing to point                                 out is that level two merchants have a                                 new june thirtieth                                                      being sent a cent stroke it stricken                                 down by mastercard saying that you're                                 saq will have to be done by a QSI                                 someone who's the you know pci                                 professional as blessed by the council                                 or a certified is a an internal scanning                                 person who has received training and                                 they are confident that this internal                                 person can do york USA properly so                                 there's some changes coming for level                                 two merchants level two merchants will                                 also have to have their quarterly scans                                 done as well levels three and four have                                 their quarterly quarterly scans and they                                 have to complete their self-assessment                                 questionnaire level four                                 time says depending on which brands you                                 look at which Visa Mastercard Discover                                 card are the same says that the saq is                                 recommended that said if you take                                 American Express or JCB their levels are                                 all slightly different and you can gain                                 a higher level via that shared                                 reciprocity between the brands because                                 you take these card types something to                                 keep in mind this is kind of the bottom                                 line of all of these levels and                                 questionnaires and that kind of thing it                                 really is going to come down to what                                 your payment processor or what they call                                 their the acquiring bank has wants you                                 to do they will have the final say they                                 will say you know we want you to have                                 the scans done we need you to fill out                                 the saq that kind of thing or we need a                                 qsa to do your essay q so it comes down                                 to the payment processor in regards to                                 which level they want you to be my                                 goodness I've been yammering on now for                                 about                                                                haven't heard Drupal that's probably                                 like the first session of the day huh                                 sorry about that but I find it necessary                                 to get people up to speed because a lot                                 of times there are some misconceptions                                 in the PCI world and that was kind of                                 necessary to see exactly what we have to                                 do in Drupal to be PCI but you have to                                 kind of know what PC is going for in the                                 first place so how does Drupal work in                                 this PCI world Drupal is open source but                                 chances are you have customized it right                                 you have custom modules you have custom                                 themes that kind of thing so because                                 those things are true you'll end up                                 treating it like it's one hundred                                 percent your code base so you'll end up                                 being very familiar with requirement                                 number six which has to do with                                 development practices and that kind of                                 thing code reviews you're going to have                                 to make sure that you understand your                                 code base because you're treating this                                 like it is your code you'll have to have                                 folks who can jump in and read through                                 the the code that makes up your shopping                                 cart this is code from Drupal commerce                                 can you spot the vulnerability huh just                                 kidding I don't know that there's one                                 there I just                                 I just copied and pasted something I                                 found you also have to keep in mind that                                 within Drupal there are some other                                 dragons that you may need to look for so                                 where might those dragons be one thing                                 that I like to keep in mind is that in                                 Drupal there's this cache form right                                 it's the form cash that comes from                                 Drupal's form API it's a database table                                 that stores form data for multi-step                                 forms and that kind of thing sometimes                                 validation what that might be doing for                                 you is sticking sensitive information in                                 your database unencrypted without your                                 knowing that so you have to be aware of                                 the workflows of the forms that are in                                 play and making sure that it's not                                 sticking data into your form cash the                                 second thing you definitely want to look                                 for is to make sure you're not doing it                                 wrong in the first place I suppose the                                 order is wrong here this would be number                                 one don't be doing it wrong in the first                                 place there's a fairly popular module                                 that exists for recurring billing and it                                 comes with several different ways that                                 you can do recurring billing one of                                 those ways is their test gateway right                                 so that you can test to see how this API                                 works and perhaps write your own code                                 around it based on this great example                                 anyway this great example allows you to                                 stick credit card information in your                                 database and it will just run through                                 the recurring billing on charge on cron                                 when it needs to be charged so you have                                 a database table full of unencrypted                                 credit card numbers it sounds like a                                 terrible thing and it sounds like                                 somebody should notice that but I've                                 heard lots of stories of people coming                                 across that when they've been called in                                 to work on a commerce site not a                                 commerce module site but a commerce site                                 within Drupal someone who is                                 misconfigured and misunderstood what                                 that module is supposed to be doing so                                 you need to make sure that something                                 like that isn't happening in the first                                 place another place you might look when                                 you're looking through your code or                                 writing code for your custom                                 applications within Drupal                                 is things sticking information into the                                 session array and that's a big PHP                                 superglobal that allows information to                                 be shared across a user session Drupal                                 sticks that information into the                                 sessions table in the database and there                                 you can see you might be able to                                 unknowingly put unencrypted information                                 in your database just because you didn't                                 understand exactly what was going on                                 with drupal's API or perhaps PHP session                                 superglobal another triple security                                 thing that you might want to keep and                                 keep in mind when it comes to commerce                                 is cooking session hijacking there's a                                 really amazing blog post that exists on                                 the secure pages module page so                                 drupal.org / project / secure pages                                 where you would go download the secure                                 pages module the secure pages module                                 allows you to configure different                                 sections of your sight to the SSL or not                                 the SSL given your secure server has                                 already been configured to handle SSL or                                 not SSL so go to that session or go to                                 that project page there's a great blog                                 post about session hijacking and how you                                 can avoid that kind of thing if you look                                 for Drupal and start searching PCI with                                 in Drupal of course there's stuff in the                                 in the forums and other you know people                                 asking questions about PCI because there                                 are people a lot of people want to ask                                 questions about PCI it's a confusing                                 thing there's this pc i update module                                 that exists I've never actually ended up                                 using it but I know that it's there what                                 happens is when you have your quarterly                                 scans they will return things that the                                 scanning the the scanning robot didn't                                 like about your site one of those things                                 that some scanning robots don't like is                                 that the login form of Drupal has the                                 autocomplete turned on so your browser                                 might be storing those passwords so the                                 scanning bot says no that's not allowed                                 you can't do that in order to fix that                                 it's a fairly straightforward hook form                                 alter a very short module to be able to                                 change that that is what this module is                                 according to the project page I don't                                 know this may                                 taner I'm not sure exactly what his or                                 her plans are according to the project                                 page as they come across other issues                                 they will probably continue to update                                 the module and make changes as needed                                 also you need to have a basic                                 understanding of general Drupal issues                                 when it comes to security and code as                                 well cross-site scripting where you're                                 able to i have untrusted users executing                                 javascript on your site could be a bad                                 thing obviously sequel injection where                                 folks can do things do nasty things to                                 your database may expose bad may expose                                 data to bad people as well as cross-site                                 request forgery these are kind of the                                 three most common vulnerabilities found                                 in Drupal modules being able to                                 understand them and know them and write                                 code so that kind of thing doesn't                                 happen is something that whoever is                                 doing your code reviews needs to be                                 familiar with                                 I hope everyone here in the room is                                 familiar with the Drupal security team                                 I'll tell you a little bit about the                                 security team it's a group of volunteers                                 who work on drupal websites themselves                                 and they have security knowledge and                                 they're able to help out the community                                 with that knowledge the Drupal security                                 team receives reports of vulnerabilities                                 under of Drupal core or from contribs                                 and then they deal with those reports                                 they figure out what needs to happen                                 they get maintained errs involved to fix                                 vulnerabilities they might jump in and                                 do some work on a Drupal core bug that                                 kind of thing the way the Drupal                                 security team works is that security is                                 handled in private until something has                                 been fixed at which point it becomes as                                 public as possible I hope you're all                                 signed up to receive Drupal security                                 updates either from the Twitter feed                                 that exists from an RSS feed or from                                 emails all of which can be found on the                                 triple drupal.org / security to get that                                 information great so now I've all scared                                 the stuff out of you right we're worried                                 about what we can be doing wrong there's                                 a lot we need to know to be able to do                                 it right don't be scared have a plan                                 right hopefully I can empower you this                                 afternoon in this last little section                                 here's my plan this is what I'd like for                                 you to do if you need to do something                                 about your current status when it comes                                 to compliance step one you need to go to                                 PCI security Sanders org that's the                                 website of the PCI council it has the                                 information that you need you need to                                 download and read the standard the PCI                                 DSS version                                                           downloading that document there are two                                 other documents I'd like you to get                                 navigating PCI DSS and the glossary of                                 terms and abbreviations and acronyms                                 because pc IQ SAS like to use lots of                                 acronyms because they're pdq anyway                                 the navigating the PCI DSS document i                                 think is very vital because as you go                                 through and you read the standard and                                 you later move on and read the                                 questionnaire itself you need to                                 determine what exactly are they trying                                 to do here and that is what's in the                                 navigating the PCI DSS document it                                 really kind of tells the intentions of                                 the council and allows you to understand                                 what they want of you if you're confused                                 so those three documents sit down with                                 them together and get reading I know                                 that's no fun reading technical                                 documents the second thing after you                                 have a great knowledge base on the PCI                                 standard is go get the self-assessment                                 questionnaire that fits for you on that                                 website is well there will be                                 descriptions about each of the                                 questionnaires and you need to determine                                 which one is going to probably fit you                                 based on the type of business you to do                                 you have credit card information that's                                 crossing your server it's encrypted when                                 it gets there but you know that                                 sensitive data is there you'll likely                                 end up filling out saq see if you don't                                 if you use one of these cool new hot                                 tokenization things and that sensitive                                 data never hits your server pcrs AQA is                                 probably something that's going to be                                 more likely suited to you but you need                                 to be able to sit down read through the                                 questions and see exactly what they say                                 needs to be done and you need to                                 determine what you don't have done yet                                 because the next step is to go get                                 another document yet another document                                 from that website which is the                                 prioritized approach to pursuing                                 compliance they understand that you're                                 not always going to be perfect and that                                 there will probably be problems with                                 your current setups you need to                                 understand that they also want you to be                                 improving your current setup in order to                                 achieve compliance you need to find the                                 order of operations in how you should be                                 improving things so what is more of a                                 problem than something else if you're                                 deficient in                                                             help you rank those                                                   sure that you hit the vital ones first                                 and maybe hit the ones that                                 aren't necessarily as important towards                                 the end I'm expecting a bunch of                                 questions so now would be that time and                                 I've been told that there is a                                 microphone in the center and the folks                                 doing the recording would prefer you use                                 that hi thank you you bet my question                                 has to do with the I guess the section a                                 PCI compliant sqa a and what I'm                                 wondering is if you use one of these                                 forms that doesn't go directly to your                                 site but go system some other side don't                                 you still have I mean if somebody has                                 javascript or something on the you on                                 the client side something could still go                                 wrong so I'm not quite sure why it's                                 less relaxed I guess that's good great                                 question yeah it is a lot less relaxed                                 if you're using one of these third-party                                 things the what it comes down to is you                                 can't be responsible for what's                                 happening on the client side your                                 application is designed to act in a                                 certain way so you need to make sure                                 that it can it can act in that certain                                 way people may put themselves at risk if                                 their own computers have issues sadly                                 the standard can't reach out and touch                                 everyone's browser and make them upgrade                                 that kind of thing or ensure that they                                 have iris scans running on their local                                 machines as well does that kind of make                                 sense just I'm just wondering about like                                 the issues having to do with let's say                                 if you have a developer adding something                                 to the page not necessarily something                                 that the user is the problem with the                                 client but it's coming from your server                                 yet you know what I mean it's like so                                 all of these quality controls and                                 checking the your you still have I mean                                 this one still have to do that that's                                 what                                 wondering about ya so what you're saying                                 is is that your developed in it or using                                 a certain type of application that                                 doesn't necessarily need the higher                                 level but it's still a custom ruled                                 application read there's a lot that                                 could go wrong right you're right and in                                 my opinion I'd like to see more of a                                 requirement                                                         required yeah it's something that you                                 definitely need to make sure that you're                                 doing right in-house you'll find that                                 being compliant doesn't necessarily mean                                 you have good security or good practices                                 it means you're filling out the square                                 right you check in the box things are                                 okay you need to make sure you're doing                                 it well beyond compliance in cases like                                 that sir I I wandered into the lung into                                 the wrong presentation and you just                                 squirt scared the hell out of me we're                                 just getting into this our boss said oh                                 we're going to start selling education                                 courses and continuing education credits                                 on the on the web I think we did it all                                 wrong we're small we we were saving                                 credit card numbers and we think that's                                 a bad idea so we're going to stop doing                                 that we're using a payment gateway but                                 we don't have the manpower to figure                                 this out where do we go out what are we                                 going to do next the problem is is that                                 it's a hard problem to have and there                                 aren't a whole lot of easy solutions                                  within Drupal there are some great                                  commerce packages that allow you to do a                                  lot but I've never had a commerce                                  install where you haven't had to write                                  your own code at some point it's                                  something that's going to take manpower                                  is what you're doing requiring recurring                                  billing no no well we could recurring                                  billing but we think for simplicity's                                  sake we just ask the client to reenter                                  his credit card and tell them we're                                  doing it for security reasons and                                  hopefully give them a warm fuzzy at the                                  same time yeah for sure once again I                                  can't stress enough if you can avoid                                  storing credit card data's we're not                                  going to we're not going to do that at                                  all but they're still gonna be entering                                  data through a web                                  when we're done sending that sending                                  that to a payment gateway so I guess we                                  want to put in one of these tokenization                                  solutions right but we still we still                                  probably wouldn't pass an audit it                                  spends an audit in a scanner different                                  things that the lower level of any                                  vendors will be required to do exactly                                  what their payment gateways ask them to                                  do well we got alone that we are low                                  level so that's we're doing very few                                  turns on actually maybe a couple hundred                                  a month so you'll have to get in touch                                  with your payment gateway and see what                                  they wanted you mm-hmm likely they'll                                  want you to fill out an SI q okay and                                  they'll require the outside network                                  scans okay okay micron remember that if                                  you're doing something like web form and                                  charging your credit card and going                                  through the Gateway you're responsible                                  for that code so you need to understand                                  what's going on within the web for                                  module you need to understand what's                                  going on with your custom code or plug                                  you know if you're using paint module                                  that kind of thing you need to                                  understand what's happening there and be                                  responsible for that and I think it's a                                  good idea too bad news is we outsource                                  them yeah sure okay thanks my questions                                  about pa-dss which you obviously clearly                                  made a note to make that disconnected                                  from this because I feel like some of                                  the questions that they're asking or                                  more pa-dss focus so my question is                                  going through this process are they also                                  auditing on pa-dss and looking at the                                  solutions for the payment enrollment                                  sort of do you understand what I'm                                  asking are they nested together so if i                                  go for PCI compliance II does it depend                                  on license love does it pan end on the                                  level of what I have to worry about in                                  pa-dss i'm sure most you may hold on the                                  PA DSS which is the payment application                                  data security standard just as long and                                  just as complicated document as compared                                  to the PCI DSS the payment application                                  data security standard as I understand                                  it and as I've dealt with in the past                                  doesn't apply to the sites that I've                                  worked with and here's why the payment                                  application data security standard                                  applies to software that's been licensed                                  to third parties and commercial software                                  that                                  kind of thing I'm sure there's a better                                  description on the website outlining                                  what types of software applied to the                                  pa-dss doesn't Drupal fall in that                                  though because that's a very gray great                                  catch yeah doesn't Drupal fall in that                                  it's very great yes it is a third-party                                  license by the GPL right that said it                                  the pa-dss does not apply to custom                                  applications you are making the                                  customizations to this application that                                  are one-off or perhaps sir bespoke you                                  know custody it becomes a bespoke                                  application and you're responsible for                                  the codebase thanks my question is                                  regarding the responsibility and where                                  that wise whether it be the web designer                                  developer compared to the store owner                                  like who should be in charge of making                                  sure that site is PCI compliant who                                  should be paying for the scans and                                  filling out the questionnaires sure                                  great question I take it are you a                                  smaller shop kind of thing and you're                                  working with folks building ecommerce                                  sir yeah we we were accompanying                                  building websites for school customers                                  yeah so great there's a number of                                  stories that we build                                  anyway yes the it is it is kind of a                                  problem space and you as someone who's                                  building this website for this vendor                                  need to understand that you need to keep                                  it not your issue you're the one who                                  doesn't end up signing the bottom line                                  as the vendor on the saq in the end they                                  need to be responsible and understand                                  that they're the ones who are end up you                                  know dealing with this information                                  because they're the ones who have this                                  website they need to end up owning it ok                                  so if on our ability was broken through                                  and information got let out they would                                  go to the store owner for that correct                                  in most cases now i'm not going to say                                  that they're not going to come to you                                  right at least the store owner isn't                                  right but ok thank you well that's the                                                                                                        process of moving our credit card data                                  to a third party and my question is a                                  couple different pieces regarding to                                  hosting the forum for the credit card                                  entry from the third party of the                                  different levels between doing it from                                  page that we host in an iframe versus                                  having them host the forum in masking                                  the URL to show our domain versus the                                  final one of having them host the form                                  and showing their domain for example you                                  flip over to paypal think before he                                  coming back to us of obviously i know                                  each in that order they're better but to                                  stay PCI compliant and keep the keep                                  everyone happy how far down can I go on                                  that least away from the trickery with                                  iframes yeah for sure stay away from                                  they stay away from the trickery of you                                  and do I have to show can I mass the URL                                  to be our domain or should I show the                                  third party it's a great question i                                  would prefer showing the third party                                  yeah just trying to get another opinion                                  thank you thinking of your first slide                                  and you said you're not a lawyer so                                  maybe this isn't fair to ask but i'm                                  glad i put that thing exactly we have it                                  happens pretty rare I mean at once in a                                  blue moon but every once while we may                                  have someone who will contact us through                                  our website and just                                  I passed the store all together and may                                  send us an email talking about this that                                  and at the end say hey can you sign me                                  up for your publication here's my credit                                  card information short of deleting that                                  and maybe anything on the servers is                                  there anything else we should be doing                                  to protect ourselves are we responsible                                  for anything I malicious may happen or                                  how would you handle that yeah great                                  question so you're saying some client                                  said here's my credit card number and                                  they sent it to you yes yes boy don't                                  ever send credit card information in                                  emails remember that email is like a                                  postcard great question there's also                                  another question about faxing that can                                  be the same thing sure and pc i will                                  apply to think you know credit cards                                  coming in in the mail or faxes or that                                  kind of thing for sure you know people                                  can mail off a credit card i'm paying my                                  bill it just needs to be handled                                  properly and you know you'll have to                                  jump in and read the standard and figure                                  out that kind of thing but to answer                                  your question about email you know hey i                                  really like what you're doing and sign                                  me up here's my information when i was                                  working in a nonprofit organization one                                  thing that our data folks who sent                                  emails and had the touch points with our                                  constituents regularly they made sure in                                  their email signature to say please                                  don't send us credit card information or                                  a credit card or other sensitive                                  information and emails just as kind of                                  that reminder another thing that we did                                  as a good policy is we made sure that                                  that email was you know deleted from                                  everywhere we could find it before it                                  got on backups because you end up                                  storing you know information on backups                                  and you know you need to do what you can                                  to get rid of it at that point just for                                  sure I understand like you said at the                                  beginning that this isn't like a you                                  know law these compliances but are they                                  covered in like the contracts or                                  agreements that you have with your your                                  merchant account and so forth great                                  question yes absolutely I it's all a                                  part of your contract that says yes I'm                                  a grain that this is the way it's going                                  to be and they're expecting you to a                                  read that and understand what it means                                  yeah hi so I'm work at a non-profit as                                  well and we're in the process of                                  switching over a system will be                                  processing donations on our website                                  sorry ok speak up I'm we're in the                                  process of switching I'm sure I                                  understand my tiptoes um we're in the                                  process of beginning to process                                  donations in our website in the next                                  probably month or so so we're looking at                                  all the PCI complications and one of the                                  things you said unnerved me was we need                                  to own Drupal one hundred percent we                                  obviously haven't made customizations to                                  all of Drupal and for the areas where we                                  are vendors and have made customizations                                  we have most of that documented and                                  pretty well understood but certainly we                                  don't know the entire Drupal stack in                                  every piece of it and it seems like a                                  really high bar in general do you have                                  any like guidance on where that line                                  really is and how much we need to be                                  able to                                                                  need to own your software that said you                                  need to be darn sure wherever the credit                                  card is traveling in your software has                                  been done right it can be depending on                                  your particular implementation or so                                  there's a little bit of a flame war                                  going on on drupal.org right now about                                  pa-dss and I don't think we need to                                  engage in it here but it's around                                  whether or not uber cart needs to meet                                  pa-dss as a standard and the comment you                                  made about well if it's if you've                                  modified it then it's custom code as far                                  as I understand if it's custom code then                                  you need to pay for a third party code                                  audit to ensure that that that meets                                  sort of whatever compliance is necessary                                  and you know we're looking at e-commerce                                  options and there's no way we we're a                                  small nonprofit no way we could afford                                  for a third party code audit of all of                                  Drupal and all of uber cart and and and                                  if you don't end up modifying you broke                                  our code at all then it seems really                                  clear in my mind that it is does have to                                  meet the pa-dss requirement which                                  requires you know                                  coding practices that will never happen                                  in the open source community and                                  actually there's a blog post by one of                                  the people who's on the pci council                                  talking about open source software and                                  he makes it really mad karu yeah payment                                  guru yeah pci driving that comment                                  thread yeah so he you know he makes                                  bakes the argument that all open source                                  systems need to meet pa-dss standards as                                  well I don't know if you have any                                  comment a comment he said unless they're                                  customized yes that's true and then it's                                  going to be a part of your other your                                  PCI audit yes it's going to be more                                  expensive than you would like it to be                                  you have to pay for the code on it yeah                                  in question in in times of questions                                  like this i will refer to you to to a                                  pci professional there is a company here                                  today who is on the list of approved                                  vendors and they also do your fault                                  which one there's a company here today                                  he's our guy crude was the best i also                                  do drupal I have a follow-up to the                                  emailing of credit card information                                  which obviously in plain text is a no-no                                  but I mean / the PCI standard as long as                                  the data is encrypted across the entire                                  path of the message it should be                                  acceptable should be and what our client                                  we have a recent Drupal                                                  client required that the credit card                                  information be sent be a strong                                  encryption to their their email system                                  and they were very PC eyewear almost to                                  a fault there is no fault but you know                                  to to an extreme so not being encryption                                  experts ourselves we looked for modules                                  thinking that this was a common issue we                                  look for modules out there that could                                  perform strong email encryption whether                                  it be s mine or PGP or gpg something                                  like that and to our surprise there were                                  none at least that we could find I think                                  there was a Drupal                                                     not well supported so we had to go in                                  and build our own i guess my question is                                  did we miss something and this seems                                  like a fairly common                                  you know email encryption seems a pretty                                  basic thing and it wasn't too tough to                                  build our own but obviously ours is not                                  robust it's not community supported so I                                  guess my question is is there a better                                  method that you can think of that would                                  be no pci compliant did we miss                                  something just looking for another                                  perspective I'm not sure about your use                                  case about setting it over the email why                                  is it happened in the first place why do                                  they require an email actually to avoid                                  some of the PCI compliance issues you                                  said they don't want it stored on the                                  server they wanted around the web server                                  which they consider to be relatively                                  insecure they consider their email                                  server secure they also considered that                                  the email would remain encrypted because                                  the entire body is encrypted and would                                  remain encrypted until the client you                                  know i'm on the pc itself had their key                                  and typed in their password so they from                                  their perspective actually was more                                  secure to be encrypted right off the bat                                  and be encrypted you know forever and                                  never be unencrypted it's a tough                                  problem and I'm unfamiliar with Drupal                                  and security encryption modules okay so                                  sorry i thought i'd ask thank you it's                                  gonna increase the height cuz everyone                                  so tall here haha you're all bending                                  down okay so my apologies i don't know                                  too much about this stuff and that's why                                  i was really interested in what you're                                  talking about now so I know there's a                                  whole session after this on recurring                                  billing but one of the slides that did                                  confuse me and Lowell was I don't know                                  at what stage it was in which you said                                  you can store the credit card numbers                                  but you can't store the pin I don't know                                  what what implications are then in                                  respect to a recurring billing but                                  what's the point of storing the credit                                  card number without showing the pin fu                                  if you can't do the if you can't do                                  anything with it the pin is designed to                                  be kept separate so storing the two                                  together is is kind of outside of the                                  way that they want credit card data to                                  be stored so that's just the way that                                  the council is decided that this is how                                  you need to be handling credit card data                                  so no sure but what's the point of the                                  credit card data without                                  if we're talking about recurring billing                                  it depends on the payment gateway and                                  their needs as far as what they need to                                  make a charge and yes wonderful session                                  coming up next my colleague a Joe will                                  be speaking about recurring billing and                                  yeah it will be absolutely great I just                                  wanted to expand a little bit on what                                  you're talking about when the lady from                                  the nonprofit asked you about owning                                  your site and how the credit card it is                                  a difficult I guess process but                                  generally what you're looking for is to                                  make sure that your site is not                                  permanently exploitable so somebody can                                  take your site and create new forms and                                  then therefore control the user                                  interface on your site and so you can                                  you can find out what most of the                                  problems with your site are just through                                  security scans and things of that nature                                  and again like you said to pretty much                                  owned your site but you don't have to                                  own Drupal collectively and I think that                                  to me was coming across as as invoking                                  some fear and some folks here point                                  taken and my opinion is a scary thing so                                  I was thinking during the presentation                                  that kind of worrying actually because                                  we've done work on Drupal commerce sites                                  from contract perspective and I'm                                  assuming if they ever got pulled into                                  court we would get pulled along with                                  them because there's a documentation                                  process that i'm assuming spreads to                                  every developer that touches the code                                  and on that note is there something that                                  you have seen or noticed in the forums                                  I'm sort of new Drupal is there a                                  certain area where people routinely make                                  mistakes that cause security compromises                                  I mean I'm sure it sounds like forms API                                  might be an area where people go wild                                  and start making a security compromises                                  unknowingly but you're something that we                                  should look for especially if it's not                                  that we've built a few things that I've                                  mentioned if you have a credit card                                  that's being taken in a multi-step form                                  that credit card information is probably                                  being stored someplace yeah well that                                  request is happening and they hang                                  around in your form cash things you need                                  to keep in mind so yeah the things that                                  I've mentioned but generally good Drupal                                  security practices as well ensuring that                                  any sort of user generated text is                                  filtered prominently that kind of thing                                  gotcha cool thanks um having done a                                  little bit of searching on this before                                  I've found different answers I don't                                  want to know your take on it there                                  there's a question on one of the forms                                  that makes it seem that you cannot be                                  PCI compliant on a managed or not on a                                  management on a shared hosting                                  environment is that your take it's a                                  great question on the latest round of                                  standards has ways that you can become                                  compliant in virtual environments it's                                  going to be it's going to come down to                                  how the hosting provider is doing it so                                  yes there is a recommendation for                                  virtualization and if they're doing it                                  right then yes there are unmanaged VPS                                  type places that do say that their                                  infrastructure has been blessed thanks                                  our times up have a great day
YouTube URL: https://www.youtube.com/watch?v=nMF044n-3ag


