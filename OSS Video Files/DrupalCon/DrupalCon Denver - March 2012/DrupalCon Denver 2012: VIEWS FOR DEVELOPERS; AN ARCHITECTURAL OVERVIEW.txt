Title: DrupalCon Denver 2012: VIEWS FOR DEVELOPERS; AN ARCHITECTURAL OVERVIEW
Publication date: 2013-03-28
Playlist: DrupalCon Denver - March 2012
Description: 
	Views is an immensely powerful and extensible system. It can be used to solve a wide range of problems and present many different types of displays; More than what most people realise, even after working with Views for considerable time. This session will demonstrate some advanced but poorly-understood features of Views, such as grouping, "count" and "group by" queries, summary views, non-standard pagers and attached-views. This session will cover an architectural overview of Views 3's classes, and how to extend it's object-oriented code to present data in alternate formats ("Display" or "View" in MVC-speak), allow views to understand and filter data in a specific way ("Controller" in MVC-speak) and to access alternate data sources ("Model" in MVC-speak). A demonstration of extending views in code will follow. Attendees should be familiar with building and editing Views, although it is not necessary they consider themselves "advanced" in this area. It is also assumed that attendees are familiar with object-oriented terminology and the OO concepts of objects, classes and inheritance. This session is inspired by Larry Garfield's "Views for Developers" and "Views to the next level" sessions at past DrupalCons and Drupal camps.

Questions answered by this session: 
What can Views do "out of the box" that I thought I needed custom code for?
How is Views' code structured and what is it's general architecture?
Where and how can I find detail about Views' APIs, classes and other code?
How can I extend Views for my website/app/custom data source?
What are the major differences between Views 2, Views 3 for D6 and Views 3 for D7?
Captions: 
	                              um today we are talking about views for                               developers so I'm assuming that you use                               views and you're familiar with building                               views and is it quiet I'll try and get a                               bit closer is there better so today                               we're talking about views of use for                               developers I'm assuming that you are                               pretty familiar with views and how to                               use it and how to build interesting                                things with it I'm also assuming that if                                you're not a programmer you're that way                                inclined and becoming a programmer we                                will be talking about object-oriented                                programming concepts and the the latter                                half of the presentation so being                                familiar with those concepts is pretty                                useful almost necessary there's a lot of                                other content in the session that is                                useful even if you're not familiar with                                that but we'll talk a bit more about                                their leader with regards to the                                questions there's a microphone here in                                the middle for the most part I would                                like to keep questions to the end if                                there's something that you think is                                really important with un interject                                that's ok but there's a fair bit of                                content to get through but I'll expect                                to have time at the end for questions so                                for the most part key questions to the                                end please so there's kind of two parts                                to the presentation today first we're                                going to look at existing features in                                views and in the second part we're going                                to look at how to extend views and add                                additional features to it now the first                                part I think is really quite important                                because views is a really powerful tool                                and there it actually is a lot of                                features that people aren't aware of i                                haven't discovered despite heavy news                                views for a long time i've been using                                views for six years or so and i'm still                                finding little features here and there                                that I didn't know about                                so site building can be really quite                                difficult it is it's engineering really                                in any medium or large website there's                                going to be several content types                                they're probably all related to each                                other and vocabularies and other entity                                types and there's there's a lot of                                moving parts to keep track of and to                                keep an eye on and to get your head                                around and it can get really complicated                                but as software engineers we're always                                looking for the the simplest solutions                                to those complex complex problems and                                someone once said i couldn't find who                                this quote came from something along the                                lines of don't tell me how complicated                                the problem is instead tell me just how                                simple your solution is and i think                                that's a good guideline as software                                engineers to to help keep problem                                solving and solution implementations on                                track and avoid things getting out of                                control and over bloated and over                                abstracted so if users a great tool for                                keeping things simple because you can                                build an awfully wide range of quiet                                complex views and displays with it and                                you can just build some fantastic things                                with them I'm just going to flip through                                a few screenshots of some sites that                                have some interesting views on them very                                quickly so this is a the landing page of                                a website called gossiping it's got two                                carousels on the homepage I think this                                uses the views carousel module the view                                slideshow module I forget which one this                                thus website lists news items and the                                interesting thing I want to pull out                                here is the bit of text here displaying                                                                                                    whole page is done with views including                                that bit users excellent it's at showing                                tabular data like in this table so this                                is part of a kind of data crunching                                application and the only bit of custom                                code here is that there's a bit of CSS                                to align the                                the the numbers to the right and add                                some coloring and theming to it this is                                a grid which is distinct from a views                                table because each data row is a table                                cell and contrasts with the previous                                table each data row is a table room                                grids are of course very popular for a                                 lot of websites these days the                                 screenshots from the same website we                                 looked at earlier but instead of showing                                 the news articles it's showing                                 collections of news articles so each                                 collection is topical and it has a                                 number of stories in it the interesting                                 thing about this view is that it is                                 sorted by the number of stories in each                                 collection so the first story has the                                 most sorry the first collection has the                                 most stories in it and the last                                 collection has the least numbers the                                 reason this is a user profile page                                 that's not me I know this is this is in                                 development said URL here you probably                                 can't see it on the event user                                        there we go user /                                                       profile page but the interesting thing                                 here is that the content region doesn't                                 have the content you would expect to                                 find in the user page it's been                                 overridden with views and it shows                                 instead blog posts by the user and a                                 views block has been configured to                                 render the user profile in a block in                                 the sidebar this is also interesting                                 because this view on the left is still a                                 list of things but there's only one item                                 in this list and of course you can have                                                                                                        that has only one item can be quite                                 useful for an hour reviews cases this                                 page is quite a bit more complicated                                 this is an admin user interface to                                 configure verifiers of areas of                                 expertise this organization has an                                 internal application that                                 tracks experts in their industry and in                                 which particular niche areas of                                 expertise in that industry they have                                 expertise and the level of that                                 expertise so we can see here in the main                                 column we've got names and the                                 organization the level of expertise and                                 their verified status whether someone                                 has verified their expertise or not and                                 on the left here we can see the areas of                                 expertise and this is actually a                                 hierarchical vocabulary so we have                                 regulations policy industry commercial                                 and finance etc and then under each of                                 those there's a number of sub areas of                                 expertise these are taxonomy terms and                                 the implementation and there's actually                                 three views that have gone into building                                 this administrative interface there's                                 the main view in the center here the                                 table view there's a header area view                                 which has just a little bit of more                                 context and information for the                                 administrator that's using this                                 interface and on the left there's an                                 attached view which renders the taxonomy                                 terms for the areas of expertise now the                                 attached view is quite interesting                                 because we're showing the count of the                                 number of experts in each area of                                 expertise so that uses a sequel count                                 query and it's actually the same because                                 it's an attached view it's the same view                                 that renders this table here on the left                                 but it's using an aggregation query to                                 instead of rendering the expert to                                 render the the area of expertise with a                                 count of the number of experts in it so                                 in addition to the the sequel count                                 Claus and the group by part of that                                 sequel course there's another level of                                 grouping going on here and shall                                 highlighted in blue which groups each                                 area of expertise by its parent taxonomy                                 term now that grouping happens at the                                 views render layer not at the sequel air                                 and that's what a                                 what allows that to be rendered in that                                 way and the last part of this view is a                                 little bit of custom code that                                 implements jquery accordion so that each                                 parent area of expertise can be opened                                 and closed and expanded and navigated                                 because it's a fairly large vocabulary                                 and it wouldn't fit comfortably on the                                 page the main view is fairly                                 straightforward it's a tabular view with                                 fields but the interesting thing here is                                 these check boxes in the right column                                 that was implemented using vuze bulk                                 operations if you have not used or tribe                                 use bulk operations I highly recommend                                 you spend an hour or two just trying it                                 out Twain with it and playing with it                                 it's very very powerful and very useful                                 for building administrative interfaces                                 like this so most of the views we looked                                 at just now had a little bit of custom                                 code a lot of it was just in the theme                                 layer but one of the advantages of                                 Drupal is it you can get an awful long                                 way in building out of sight without                                 custom code which is fantastic and makes                                 site building cheap because custom code                                 is expensive it takes time to implement                                 it's usually buggy the first time you do                                 it because you forgot about some edge                                 case so it needs fixing when you upgrade                                 the Drupal website across a major Drupal                                 version for example                                                     has to be upgraded manually which takes                                 more time and if you want to add other                                 features related to it that's going to                                 take more time again and you're probably                                 going to start the process of debugging                                 it and fixing it all over again and for                                 most organizations the more time you                                 spend on it the more expensive or kids                                 obviously for professional service                                 services companies like most of the                                 sponsors of Drupal gone time is                                 literally money because he charge hour                                 for each hour by the dollar but even for                                 organizations that have staff and work                                 on internal projects time is still                                 critical because the more time spent on                                 one project is is less time spent on the                                 next project and it gets delayed so                                 before you start writing custom code and                                 that's why I wanted to spend                                 terminus in the the first sections                                 presentation before you extend Drupal of                                 views of custom code or add things to it                                 it's it's really useful to find a way or                                 to look for ways that you can get closer                                 to what you need or perhaps exactly what                                 you need using existing code using                                 contributed modules and existing                                 features and the closer you get of                                 course the less custom code you need to                                 write and the less triskin and expense                                 and time you spend on that so                                 essentially the more config you know in                                 views the less custom code you're going                                 to need to write in the fuse so just                                 jump into some of the more advanced                                 config features which you may or may not                                 be aware of in views but just before we                                 do that I want to review the anatomy of                                 the view to make sure that we're all on                                 the same page as to what part of the                                 viewers what and what's a called and how                                 it relates to to everything so the top                                 level there's two parts to a view the                                 title and the display the display                                 obviously obviously has everything                                 interesting and in fact views doesn't                                 usually render the title itself it just                                 hands it off to to Drupal to render it                                 as the page title if it's a page view or                                 the block title if it's a block view etc                                 in the display itself is the header area                                 which can have zero or more area plugins                                 in it an area plug-in is often just some                                 custom text it can also be another view                                 you can embed a view as an area plugin                                 can also be a result summary and a few                                 other things if you extend views with                                 additional modules at the at the top of                                 the display of the view we also have                                 exposed filters which we saw in one of                                 the screenshots earlier which will often                                 be a form that allows the site visitor                                 to further filter and reduce the results                                 in the and the view then the reviews                                 attachments then into the body of the                                 view they were obviously the rows and                                 each row might be an entity such as a                                 node teaser or a full mode                                 or a comment or it could be won on war                                 fields and in the case that there's zero                                 rows then views renders the empty area                                 or the no results behavior area as it's                                 called an user interface and the empty                                 area can have area plugins just like the                                 header area for example some custom                                 decks or another embedded view and in                                 the footer there is first of all the                                 pager any views that are attached sorry                                 any attachment views that are attached                                 to the view then the footer area which                                 again has area plugins just like the                                 empty area in the header area and feed                                 icons okay so here's a feature that                                 you've probably seen in views but I find                                 is often under you so I want to spend a                                 little bit of time on this views three                                 and in views too if you install and                                 enable the symantec views module you can                                 configure you can customize the element                                 that the HTML element that wraps each                                 field and is actually three levels to                                 this you can configure the element that                                 wraps the the field itself the value                                 sorry the label for that field and then                                 there's another rapper for both the                                 label and the field itself so in this                                 screenshot a field probably a node title                                 or something like that has been                                 configured to render as an h                                         class of title and so it's going to look                                 a little bit like a teaser title and                                 then there's no wrapper for the field                                 and label the label HTML is not                                 customized in this case probably because                                 there is no label for it now if you use                                 this feature of views a lot you'll                                 probably find yourself configuring all                                 of the fields to have no wrappers and                                 then just adding a single wrapping                                 element for the fields that you need it                                 but views has a little feature in the                                 Rose style options which lets you do                                 that by default for the whole view                                 which quickly gets rid of all of use for                                 both rapping elements around fields                                 labels and fields and abel's together                                 which is essentially the same as                                 selecting none for all three of these                                 for all of the fields and then you can                                 just go and add the ones add the markup                                 elements that you want so that can speed                                 things up and make that feature more                                 useful and quicker to configure however                                 if you have multiple views that need the                                 same configuration for that marker                                 you're quickly going to run into                                 duplicate configuration across your                                 views which makes the website more                                 difficult to maintain so at that point                                 you want to think about something                                 outside of use to manage that such as                                 view modes like teaser and teaser for                                 nodes and the full view mode for nodes                                 and if you need more view modes is a                                 logical display swing which is                                 essentially extends the view modes                                 concept in Drupal and allows you to                                 create custom view modes so it's a                                 powerful way of doing that that takes                                 more time to to build out their                                 configuration with display sweet then in                                 views but if you need to reuse it a lot                                 it's going to make a site more                                 maintainable and it might work out to be                                 quicker anyway another option that I                                 haven't tried myself yet I've only                                 recently learned about it this week                                 there's the fences module and fences                                 allows you to configure that wrapping                                 element in the field configuration via                                 the field API configuration form as I                                 said I haven't used it so I can't speak                                 about it much more than that but it's                                 probably worth checking out I'll                                 definitely be checking it out next week                                 so another feature of use that is easily                                 missed is the ability to concatenate                                 fields together or to wrap some custom                                 text around the field so here we've got                                 a title field and a field API field                                 called country and they concatenated                                 together in field country is wrapped in                                 round parenthesis these tokens come from                                 the replacement patterns which are                                 exposed in the user interface I don't                                 think they're actually token module                                 tokens I think views has its own                                 token system that manages that but it                                 works in the same way as far as user                                 interface is concerned another fantastic                                 feature in views is the ability to link                                 a field to to the content item for                                 example you might want to link an                                 arbitrary field to the full node page                                 however views also has the ability to                                 customize the target that a field links                                 to in the rewrite results section again                                 we can put in a custom system path and                                 you can even put on those same                                 replacement patterns into that path so                                 this is useful for example if you want a                                 row or a field in your configuration to                                 link to another view that takes the node                                 ID as an argument rather than linking to                                 the node page itself of course if you                                 configure the field to the output as a                                 link you they're going to want to                                 disable this otherwise you're going to                                 end up with two a elements wrap in the                                 field last time I tried that views                                 wasn't smart enough to automatically                                 disable the other one yeah so no results                                 behavior obviously views has the ability                                 to render some custom ticks or an area                                 plugin in the case that there are no                                 results there are no rows and the whole                                 result set for the whole view but as                                 well as that views has a feature that                                 allows you to configure what should be                                 rendered for a field in the case that                                 the value for that field is null or zero                                 or missing and yeah I just wanted to                                 highlight this as it's heading away in                                 the field configuration settings summary                                 views you've probably come across so I                                 went too much time on this but a summary                                 view can list the summary view is                                 configured in the settings for a                                 contextual filter and a summary view                                 will render if they're contextual photo                                 is configured                                 in this way in the case that the                                 argument for that contextual filter is                                 missing and it will render a list of                                 potential arguments that you can use                                 with that view so that you can drill                                 down further into the content so you                                 could actually build a summary view                                 using the feature we looked at earlier                                 where you implement another view and                                 some custom links and if you did it this                                 way you would have a lot more control                                 over that because you would have access                                 to other fields in relationships and                                 configuration for that however summary                                 views are a quick way to to create that                                 list that links out to that links deeper                                 into that view and or filters sorry                                 enduring the filters so I think this                                 feature is new and views three and is an                                 immediately obvious and user interface                                 obviously here we have got a couple of                                 groups for our filters the first group                                 is and those filters together the second                                 groups all's those Hilton's together and                                 in the two groups are ended together and                                 this is highly configure configurable                                 through the user interface you can quite                                 make quite a mess of your view and have                                 unintended results if you're not careful                                 but it is a very powerful feature and                                 you've probably seen that before but                                 what very few people are aware of is                                 that you can actually configure                                 contextual filters in here as well they                                 don't appear in the interface but                                 because they all get rendered into the                                 where Clause of sequel they are still                                 kind of taken into account when views                                 builds the where clause and contextual                                 filters will always be included in the                                 first and or group so what that means is                                 that roop singh begin the preview there                                 we go what that means is that contextual                                 filters despite not appearing in the                                 user interface you should assume that                                 they're in this first group                                 here as if they are in the user                                 interface so what that means is that you                                 could actually or together your                                 contextual filters and that would kind                                 of override if those contextual filters                                 are required then it would mean that I                                 knew one of them needs to be required if                                 you've awed the contextual filters                                 together yeah so that's not obvious from                                 the user interface but either is a a                                 great way to take advantage of semester                                 showing things in views and make a big                                 mess of it if you don't understand                                 what's going on there as well results                                 summaries we looked at a screenshot of                                 this at the beginning I only just                                 discovered this feature in views so                                 that's why I wanted to include this                                 maybe everyone else knew about it                                 already but it allows you to to add a                                 little bit of text along the lines of                                 this here displaying                                                  distinct from a summary view despite                                 having a similar name and of highlighted                                 the difference here between a result                                 summary in a summary view                                           armies the area plugins you can add them                                 to the header footer or even the empty                                 area although it probably wouldn't make                                 sense to add a result summary to the                                 empty area because it would probably say                                 something like displaying                                             which wouldn't be pretty useful this is                                 the configuration for the result                                 summaries and you can see here that you                                 can configure the text and change that                                 and include various different numbers in                                 that text so aggregate count queries                                 this feature is intentionally quite                                 difficult to activate and find in views                                 because it clutters the user interface                                 despite views                                                      interface and far better than views                                                                                                            the level that this feature needs it to                                 and as well as that it is a complex                                 concept to get your head around if you                                 don't understand what's happening at the                                 sequel level here if you can't if you're                                 not familiar with a sequel to                                 read and debug that sequel while you're                                 configuring the count query you might                                 not want to try this feature because it                                 is really complicated but if you do                                 understand it is very powerful the way                                 you configure it is in the advanced                                 settings of the view you turn user                                 aggregation on and that adds this                                 aggregation settings configuration                                 option to all of your filters sorts                                 fields and I think relationships and                                 contextual filters as well in most cases                                 you're only going to want to configure                                 the aggregation settings for one or two                                 of your sorts or filters or fields and                                 yeah that's fairly straightforward once                                 you get to this point you click on                                 aggregation settings and you can choose                                 to run that field or or filter or sort                                 through a count function as a popular                                 one or sum or average and there's a few                                 other options                                                       pages so sometimes it's useful to to                                 have a pager that groups your content by                                 date such as month week or year or an                                 alphabetic pager that works a bit like                                 an address book so you have ABCD along                                 the bottom and confined perhaps people                                 by their the first letter of their                                 surname in most cases alternative pages                                 actually contextual filters but the date                                 pager is configured via the pager                                 settings as we see in the screenshot                                 here and alphabetic pager is configured                                 by enabling the glossary mode of a                                 contextual filter you can set a                                 character limit to decide how many                                 letters should go into that their pager                                 you can also build an alternative pages                                 like this using vuze attachments and in                                 most cases you get some more flexibility                                 in that way but they might not be you                                 get some more flexibility in regards to                                 the rendering of each page writing but                                 it might be a bit harder to                                 to get it to render like a pager and                                 finally this is actually a contrib                                 module for views which is very very                                 useful and just does one simple little                                 thing it exposes an area plugin that you                                 can add to header footer in empty areas                                 to add a link of course you can do this                                 with the custom text area plugin but you                                 have to type in the a tag and you have                                 to you you end up assuming that the base                                 path you end up having to assume the                                 base path for the website so if you then                                 move the website to a subdirectory of a                                 domain or disable clean urls the link                                 might not work anymore and it also won't                                 go through aliases this module runs the                                 link path through the L function so it                                 will elias any system paths and it also                                 handles query strings and a few other                                 little things relating to links ok so                                 that's the first section we've looked at                                 why you shouldn't write custom code if                                 you can avoid it and wasting simple                                 solutions for your complex problems                                 reviewed the anatomy of a view and we                                 looked at a few several advanced                                 configuration options in views how do                                 for example how to wrap fields with                                 custom markup elements without having to                                 get your hands dirty in the theme layer                                 just through configuration how to                                 concatenate fields together how to                                 render fields as links to custom paths                                 and the no results behavior for fields                                 as opposed to the no results behavior                                 for the view result set some reviews the                                 configuration of that and or groups of                                 filters and also the configuration of                                 the and or groups with regards to                                 contextual filters result summaries for                                 example showing                                                         looked at how to enable aggregate count                                 queries and views                                 and it looks about seven we looked at                                 some alternative pages and the view sink                                 area module so that brings us to the                                 second section but before we dive into                                 this does anyone have any burning                                 questions at this point that they don't                                 want to keep to the end yeah                                 the                                 the question was do you know about                                 adding access controls to area plugins                                 oh yeah actually I wrote a patch for                                 that the other week so currently views                                 link area doesn't check that the user                                 currently viewing the view has                                 permission to access their system path I                                 thought that it did and then I                                 configured of you with that assumption                                 and it didn't work well it did work but                                 it worked for anonymous users as well as                                 administrators which I didn't expect so                                 there's a patch in the issue queue for                                 that I don't think it's been reviewed                                 that though so if you have a look and                                 review it and make it committed free                                 yeah um could you go into a little more                                 detail regarding the count function                                 function the count sort that you                                 mentioned before um what sort of detail                                 um how would you configure that um yeah                                 I can do that really quick but I'll be                                 really quick so that we can move on                                 thank you so I have a view here which I                                 used to make some of these screenshots                                 and it's probably not going to work                                 because I haven't really thought about                                 what I'm going to add here but basically                                 you took that now use irrigation is set                                 to yes and we've got to lose additional                                 aggregation settings here now it's not                                 going to make sense for this you to                                 aggregate it but for example I could set                                 a count function here or count distinct                                 some average men max and those will                                 relate to the sequel functions are the                                 same names okay so let's move on to the                                 second part which is about writing that                                 nasty custom code which is going to cost                                 us so much time and money before we dive                                 into this there's no way I could                                 possibly tell you everything you need to                                 know in this session and if I did you                                 would forget                                                             need to know where to get the detailed                                 documentation views three documentation                                 is now                                 as of just a couple of weeks ago                                 available on API drupal.org which is                                 absolutely fantastic because you can use                                 the search feature there and in the same                                 way that you do with Drupal core                                 functions there is also topical                                 documentation on a piada drupal.org                                 although I haven't worked out how to                                 navigate to it yet because this is a new                                 feature on Apr drupal.org so this is a                                 useful URL to to find it or write down                                 and that talking about topical                                 documentation is actually very well                                 presented on AP out of Drupal dog and                                 very very useful it's a great way to                                 dive into some of the concepts of views                                 and get your head around them at a more                                 general level as well as that there is                                 the doxygen documentation which has been                                 available on low gress com for many                                 years but that documentation is still                                 for views to it hasn't been updated for                                 views                                                                  the oxygen configuration and generated                                 views                                                                   on Drupal geek nzd / views if you prefer                                 that I prefer the docs                                        documentation sometimes for depending on                                 what I'm looking from the documentation                                 one thing I like about it is its                                 presentation of the classes and the                                 relationships between those classes the                                 class hierarchy in particular it has                                 this fantastic navigatable tree so you                                 can see exactly which class is                                 inheriting from which other class and                                 this is a great place to start to work                                 out how to add a particular feature two                                 views because most of the time you're                                 going to need to create a class that                                 inherits from one of these handlers or                                 from one of these plugins yeah so let's                                 look at an example I'm actually gonna                                 look at the views link area module                                 because it's a nice simple                                 implementation which serves as a great                                 example for                                 for how to extend views so the first                                 thing the first thing you need to do to                                 tell views that your module integrates                                 with views is implement hook views API                                 and you tell it which version of use                                 your module supports in this case                                 everything from three dot                                               up and you can also tell it where in                                 your module your views include files are                                 you can omit this if they're in your if                                 they're in the home to victory I believe                                 but check the documentation for for more                                 details and the other options there once                                 you've got that the next thing is to                                 actually create that subclass so views                                 handler area link implemented by the                                 views lincare a module extends views                                 handler area and views handler area we                                 can find out about the documentation for                                 that in the doxygen documentation which                                 i have open here you use handler area we                                 can see already that there is some                                 default implementations of this in views                                 itself views area view which is the area                                 plugin that allows you to embed a view                                 into a views area text which is just the                                 generic custom text one result which has                                 result summaries for example the text                                 displaying                                                            results and broken which handles the                                 case where a module has been disabled                                 and the the area handler no longer is                                 available so using Korea extends views                                 handler area and if we wanted to get in                                 with documentation about that we can see                                 it all here I'm not going to look into                                 the methods that have been implemented                                 here because that's kind of low level                                 detail and it'll be vastly different for                                 every every use case the next thing los                                 ms here we go the next thing you need                                 to implement is what makes you need to                                 do is tell Drupal about your classes so                                 it can store that information in the                                 registry and automatically load the                                 include files when it instantiates that                                 class so in drupal                                                      these lines here and we can see here                                 that view sling carrier module has put                                 that class in a file called views Hamlet                                 area link Inc which is consistent with                                 the convention of Drupal of defining                                 classes in a file of the same name and                                 include file of the same name view sink                                 area modulus also put its                                 implementations of views hooks in a file                                 called views link area Inc which is the                                 Drupal convention for putting                                 implementations of another modules hooks                                 and it's exposed that file here as well                                 to Drupal so I can keep track of it in                                 Drupal                                                                   a little bit more complicated but                                 hopefully you're not doing too much                                 Drupal                                                                 you will need to tell views how your how                                 your new class integrates with the data                                 schema in the case of views link area it                                 doesn't actually integrate with the                                 scheme s so it's kind of using a pseudo                                 column of the views table to expose the                                 the area plugin but most of the other                                 classes will somehow integrate with the                                 schema and they might for example if the                                 n-terminal implement a relationship they                                 will refer to the table that they're                                 building that relationship from and the                                 column again the detail for their                                 documentation you can find them an API                                 dr. Patil and ok so we've got we're                                 going good for time the last thing I                                 want to do in order to show you is which                                 classes that we looked at in the class                                 hierarchy here how these relate to                                 features in the user interface I think                                 this is important because as developers                                 we usually build our mental model of how                                 a system like views works based on its                                 user interface                                 and often the way that you work out                                 what's missing in order like the piece                                 that's missing to to complete your                                 requirements or get that feature you                                 need is is through user interface you                                 like I need to add another one of these                                 things that does something differently                                 so I'm not gonna go through all of them                                 because some of them aren't don't appear                                 and user interface and some of them are                                 used very often that will go through the                                 most important ones so views handler                                 field and as a parent class for                                 subclasses that expose fields that's                                 fairly straight for views handler filter                                 no surprises there context views hammer                                 argument is for contextual filters if                                 you use vuze two views version                                          past you'll know that context your                                 filters used to be called arguments                                 views handler relationship there's a                                 pair in class to the classes which at                                 different types of relationships which                                 you can add through the user interface                                 here views handler sort use handler area                                 now this appears in several places and                                 user interfaces because area plugins can                                 appear in the header area in the photo                                 area and the no results behavior area or                                 the empty area views plugin display now                                 this appears a bit differently in the                                 user interface of course and it's going                                 to jump over to the view i have here so                                 we can see that the existing                                 implementations for different types of                                 displays you can add our attachment                                 block date browser feed page references                                 and if we look at documentation use plug                                 and display we can see that the                                 subclasses for that pretty much mapped                                 to those options and of course as we can                                 see here that views plug and display                                 feed as a subclass of views plugin                                 display page so you don't have to                                 inherit directly from use plug and                                 display if you just want to tweak                                 something                                 and for example the block display you                                 can inherit from that instead and and                                 and just over add the bits of that you                                 need you don't have to copy the whole                                 thing views plugin style the sads                                 formatter options look at this a new                                 user interface too so the options for                                 for matters by default grid HTML list                                 jump menu table and formatted list and                                 in the class hierarchy we can see grid                                 jump menu HTML list here is a school                                 list RSS table down here jump menu                                 default is unformatted list and we've                                 got a few others here that have the                                 namespace summary these don't appear in                                 the user interface because they relate                                 to summary views rather than the the                                 main view formatter views plugin row                                 this is very much dependent on the                                 formatter some for matters require you                                 have the Rose style that they use for                                 example a table view must have a fields                                 for matter at the row level but a HTML                                 list can have fields or or entities                                 views plugin pager views plugin access                                 usually you only use permissions for                                 this but you could actually extend this                                 with a custom system that works our                                 permissions and some other arbitrary                                 views plugin case again you can                                 implement your own occasionally of                                 reviews them so outside of the main user                                 interface looking at the interface for                                 contextual filters we came across a                                 couple more views plugin argument                                 default so this takes effect when a                                 contextual filter is configured to find                                 the value of its argument from somewhere                                 other than the URL because the URL has                                 not been explicitly passed                                 and again let's just jump back to                                 documentation we can see how that maps                                 to the options in their user interface                                 current user fixed node PHP raw etc and                                 they map fairly straight forward to                                 these here and another one for                                 contextual filters is views plugin                                 argument valid a and again in the                                 dachshund doxygen documentation we can                                 see that these subclasses user taxonomy                                 term PHP numeric node map pretty much                                 directly to the options here node fixed                                 PHP tech-savvy too amusing okay so that                                 brings us to the end of the second                                 section we've looked at where you can                                 find documentation to get implementation                                 detail about for developers about the                                 functions and methods of use on a PR                                 Drupada dog and drupal kikouden said /                                 of views for the doxygen documentation                                 we've looked at the classes and                                 subclasses and the hierarchy of those                                 and how to navigate them and oxygen and                                 we looked at how you can extend views to                                 add another one of these subclasses with                                 your own particular feature set and that                                 there are four steps to that you've got                                 implement view hook views API you do                                 that once in your whole module of course                                 not for each class that you've created a                                 subclass form then you create the                                 subclass of the appropriate views class                                 that that adds the type of feature you                                 need you have to expose that class in                                 the in your module info file and finally                                 you also need to expose that class two                                 views using hook views data so that                                 views knows how that relates to the                                 schemer and the other entities and the                                 data model that your website users                                 and finally we looked at how the classes                                 map to various configuration figuration                                 features in the user interface so that                                 brings us to the end of the content                                 we've got a fair bit of time for                                 questions still which is great I hope                                 you've learned something and that you                                 can go build awesome things with use now                                 just over we getting sorry just before                                 we get into questions and please please                                 please take the time to take the survey                                 on the drupalcon Denver website I really                                 appreciate feedback it helps me learn                                 what information is useful and not                                 useful and how I can better present that                                 information so I can do it better next                                 time and as well as that it helps the                                 drupalcon organizers builds put together                                 better programs and schedules for future                                 Drupal guns you can do that by going to                                 the website to the program finding this                                 session and filling out the information                                 and you should do that for all the                                 sessions if you can they'll be fantastic                                 yes please oberlin could you help me out                                 wit with a recipe how would I create a                                 view that would display the output of a                                 web service like a third-party web                                 service you would need to build an                                 alternative backend for views which is                                 something that I would have loved to                                 have demoed in this session but it would                                 take quite a bit of time to do that the                                 class that you want to extend in order                                 to create an alternative back-end is I                                 think views plugin query so this by                                 default and views is sequel it's a                                 sequel database but you can expose a                                 REST API a file system if you wanted or                                 any other type of data store two views                                 and list all sorts of different things                                 now if it's a common API that you're                                 integrating with like Flickr chances are                                 that someone's done it already so you                                 should look for an appropriate module                                 that you can use and perhaps complete if                                 it's not done but you wouldn't go the                                 entity well if you want to duplicate all                                 that data in Drupal you could but I                                 would probably be inclined to do that at                                 a case layer rather than an interview                                 there because all you're doing is                                 catching a data that's primarily stored                                 somewhere else                                 in your hook views API implementation                                 you had a very sorry it's very quiet can                                 you get close to the mic yes in your                                 hook views API implementation you had a                                 very specific view number three dash                                 alpha one what happens if views gets                                 updated and your custom module is                                 implementing like a beta version of the                                 use or something that's a great question                                 I don't know the answer I would look at                                 the documentation for hook views API in                                 this case Larry Garfield implemented                                 this module and I suspect at the time he                                 implemented it views while didn't have a                                  stable release yet which is why he went                                  with three dot zero alpha one I expect                                  the way it works is probably something                                  like it will work with all API versions                                  that are in the three series but it                                  won't work with the API two series or                                  four series of course the                                           doesn't exist you could you elaborate                                  that a on the difference between a                                  handler and a plug-in and when you use                                  one versus the other that's an excellent                                  question as well and I used to know                                  exactly the answer for that they'll have                                  to have a quick look to remind myself                                  so I think basically the difference is                                  that views every view has to have                                  exactly one of each plugin oh but on the                                  other hand it can have zero or more of                                  each of the handlers so it's as far as                                  you're concerned when it comes to                                  extending views it doesn't really matter                                  you just got to get the right one like                                  views is already decided for you which                                  ones are handlers and plugins and it's                                  it's a imagine there's something going                                  on further up in this class hierarchy                                  that's relevant for views to distinguish                                  between them well would it be fair to                                  say that a handler is for getting data                                  and a plugin is for displaying it or                                  that being accurate handlers for getting                                  data plugins for displaying it yeah that                                  looks around about right for the most                                  part yeah hi um there many differences                                  between a triple six view and Drupal                                    views we have a bunch of the triple six                                  views is that include a way to migrate                                  to Drupal                                                        interesting question I on Drupal sexy                                  using vuze to a fuse                                                     so one probably going to have is as well                                  as my grade in the day to have cross in                                  the cross and the fact that the day                                  model has changed is that on Drupal                                    there is only use three not views two                                  I'd probably suggest well that's a                                  tricky one it's probably an take a lot                                  of time to work it out and you probably                                  can have to rebuild most of your views                                  anyway because the data model has                                  changed so it might be easier in many                                  cases to throw out the views to that was                                  sorry the views to view that was                                  configured and just rebuild it and views                                                                                                      migrated thank you the problem so to                                  what I hope were really quick questions                                  one is I had a recent use case where I                                  was using and abusing rewrites as I                                  often do and                                  but I have certain rewrites like in a                                  views results area you want to be able                                  to say you know X number of views within                                  and then include maybe one of the                                  contextual filters like a zip code or                                  something like that for a location                                  search and those aren't exposed in the                                  in the views token system so I basically                                  had to hook in using one of the you know                                  the pre pre render hooks to look at the                                  views object and pull out the argument                                  from that is that the most elegant way                                  to do it or is there a better way to                                  expose those so I just want to check out                                  I stood what the problem we had was you                                  wanted to include data from the argument                                  for a contextual filter in those squares                                  of token in the field yeah to use that                                  as a token basically like another fear                                  so if users aren't very good at that                                  because because the field is a separate                                  entity to the contextual filter the                                  contextual filter applies to all of the                                  rows not just one particular row so that                                  value is going to be the same for all of                                  your fields so I suspect if you tried to                                  step back and look at things from a                                  bigger picture in a different angle and                                  you might find a better way to do that I                                  have come across a similar problem                                  before where I had a view that was a                                  list of length                                                            information about the contextual filter                                  and that and actually it was one of the                                  ones in the screenshots I'll pull it up                                  real quick this one here so this views                                  header area does exactly that and it's                                  another view which inherits the                                  contextual argument but it's listing                                  taxonomy terms instead of nodes so I                                  haven't got it at the field level but I                                  am able to provide a lot of information                                  about the argument that was hacked that                                  was passed into this contextual filter                                  on this display but it's a separate view                                  that's embedded via the views header                                  area that wasn't very quick but I don't                                  know if you can riff at some point on                                  performance tweaking because views can                                  be awesome but very slow yeah                                  wasn't really time to get to add in this                                  session but basically configure your                                  cases carefully and and do as much                                  occasion as you can on the front end                                  using varnish whatever and if that's not                                  enough you need to look and how you can                                  catch the data queries themselves and                                  again you can extend views with a paper                                  mention your own case layer if you like                                  and that will give you a lot more                                  control over that in options what's your                                  thoughts on the views of PHP being used                                  apart from it being a security                                  vulnerability what are my thoughts on                                  views views PHP module so you can use                                  PHP indirectly interviews you I her oh                                  so you can only do that in Drupal                                       you're logged in as root user even if                                  you have an administrator role you can't                                  do that you have to login as user ID one                                  which I think solves a lot of the                                  potential security issues because                                  otherwise it could be easy to configure                                  a kind of lower level site builder to                                  have PHP access when they configure                                  their view in terms of whether you                                  should do it or not that's tricky and                                  general knows the correct answer you                                  should look at how to do it by extending                                  a class instead but sometimes it's                                  really simple and quick and convenient                                  and if you're building out the prototype                                  or and very early phase at the website                                  I've done it before cheers I have a view                                  that it uses a contextual filter to this                                  taxonomy terms and then it has another                                  contextual filter as an attachment view                                  in glossary mode to list the first                                  letter of surnames the problem is my                                  users can only select either taxonomy                                  term to filter by or the last last name                                  filter by how would I allow them do both                                  so you have to context your filters and                                  you want a summary view for each yes and                                  you want both summary views to appear at                                  once yes yeah I don't think these does                                  then um I would                                  you could probably do it a few added                                  them as attachment views I've never                                  tried that though yeah one is an                                  attachment of you should I would I have                                  to make the other one attachment view                                  and they could I use that and or group                                  yeah we're getting too deep                                               conversation like this if you like we                                  could ever look after all right yeah hey                                  good morning my question is about                                  configuring a search term or a search                                  filter and let's just assume I have a                                  title field that I'm wanting to search                                  by your filter by in a in a description                                  filter when I display those filters to                                  the user I'm interested in having one                                  search box instead of two search boxes                                  is there a way in views to aggregate                                  that search box where it all just                                  searches both of those terms see you                                  want one search boxes and expose filter                                  that searches across two fields yes does                                  it matter if it searches the whole mode                                  or the whole entity it does not matter                                  okay so there is a exposed filter for                                  that that works at least four nodes and                                  I think for users and comments and I                                  prodromou can be able to find it on the                                  flavor I've got search module disabled                                  so it's not going to be here but I'm                                  pretty sure that if you enable the core                                  search module you can add something like                                  Oh full text yeah I think it's called                                  the full text filter and you can                                  configure to be exposed and it will work                                  kind of like a search box but only on                                  the nodes in the data that oh that come                                  through the result set for that view                                  great thank you as well as that there is                                  a Search API which is another big can of                                  worms I don't want to start talking                                  about but is very powerful for that sort                                  of thing and gives you a whole lot more                                  options as well in terms of searching in                                  expose filters thank you yeah I have a                                  quick question about performance I guess                                  I'm what are some of my sites I have                                  definitely you know in the contextual                                  filters a bunch of like PHP that kinda                                  sigh so I can you get a bit closer to                                  the mic what's it sorry yeah sorry um                                  I'm some some of my sites i have a lot                                  of contextual filters which have a lot                                  of PHP that                                  you know provides a default argument                                  kind of in the whole block there is it                                  something that we should be maybe                                  absolutely we were writing my own                                  contextual filter class for or something                                  for better performance yes okay or it                                  would caching physical performance I                                  don't know if it matters um but in terms                                  of sight maintainability for example                                  what happens if you disable a module or                                  rename a function that that PHP snippet                                  depends on yeah your site's going to die                                  if you put that in a class you're going                                  to discover that more easy to be able to                                  handle that more efficiently with your                                  version control system ah if if I I have                                  a content type which stores the XML and                                  if I want to expose the XML tags as a                                  fields to view on the Flies is possible                                  Jupiter like I have a content type which                                  stores the XML data and there are                                  different tax in that XML I want to                                  expose those tax as the fields in the to                                  the views so that you know views can                                  display certain tax sorry yeah I think                                  it's a bit complicated answer here                                  perhaps you can ask me afterwards and a                                  logger put you in a direction hi I was                                  wondering can views read data from MySQL                                  that's not exposed to Drupal yeah and                                  that's exactly what hook views data is                                  for he's a pedo Drupal a dog you need to                                  be very familiar with the schema that                                  you with the the data that you want to                                  add in the schema for that data and you                                  need to understand how hook views data                                  works well the documentation for it's                                  great so read that and learn it but that                                  that's the way to to go about doing that                                  okay thank you if you do do that                                  and assuming it is data that is an                                  existing contrib or core table please do                                  it as a patch and contribute it on                                  Jupiter dork rather than just in your                                  custom herbs or that way someone else                                  can reuse that feature will do two more                                  okay um I have a view that has an                                  exposed filter that's based on a tagging                                  taxonomy and what I would really like it                                  to do rather than require them to enter                                  something and you know the drop-down                                  happens and and if it they don't enter                                  the right exact tag they don't get                                  anything back what am I missing on that                                  um I would need to have a closer look                                  chase me after we can have a look at                                  length okay yeah the the attachment                                  display you have with the taxonomy is                                  that our accordions sorry can you hear                                  me okay yep the attachment display you                                  have with the accordion right here um is                                  that it just a summary or is that a                                  count Corey attachment display just kind                                  of curious how deep that nesting goes                                  and how you sorted it so this high right                                  here we have two levels I got to mention                                  that so it's just grouped by their                                  parent and that's it yeah guys if the                                  hierarchy had more than two levels then                                  analyzed this would have been a lot more                                  complicated to build implement in use                                  but the way that it works is as as far                                  as the rendering goes of that hierarchy                                  is it's using the the group by option                                  and i think the Rose style settings or                                  something like that I don't have access                                  to that view here to show you the                                  configuration that exact view but I                                  think it's                                  I think it's using this grouping feature                                  and so that's not a sequel group by                                  cause that's just that happens in the                                  rendering layer reviews it's just                                  happening anything do you know anything                                  oh and the way I so in the fit in the                                  view that displays that I configured I                                  configured a relationship for the parent                                  term for each of the terms and I also                                  added a filter where parent term is not                                  now so the view was only listing child                                  terms but it had the parent term as a                                  field or as a related entity and then I                                  added the parent terms name as a field                                  but excluded it from the display so it                                  was still available at the rendering                                  layer but it wasn't being rendered with                                  each row and then finally here I select                                  the parent title as the group by field                                  and so and then views uses that to group                                  each row by that that field awesome                                  thanks do you one quick final question                                  do you have any recommendations on how                                  to actually get that tree to render                                  right so it could be infinitely deep or                                  uh exactly what i just said it'll render                                  it in a well in a semantic tree at least                                  yeah like but then to make it look like                                  a tree you can do that with CSS medical                                  center so efficient yeah it kind of I'll                                  catch you later okay thanks thank you                                  very much                                  cool to meet by the city huh there we go                                  sorry
YouTube URL: https://www.youtube.com/watch?v=6SqcRbe_m2w


