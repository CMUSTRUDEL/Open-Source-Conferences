Title: Extending Commerce: Drupal's architecture in action   DrupalCon Global 2020
Publication date: 2020-08-25
Playlist: DrupalCon Global 2020
Description: 
	Examine how Drupalâ€™s design patterns become building blocks to create a custom donation process.
Captions: 
	00:00:02,399 --> 00:00:05,759
once again this is extending

00:00:03,679 --> 00:00:06,960
commerce drupal's architecture in action

00:00:05,759 --> 00:00:09,200
and if you're looking for a different

00:00:06,960 --> 00:00:13,920
session click over on the session screen

00:00:09,200 --> 00:00:13,920
tab and thank you for stopping by

00:00:14,080 --> 00:00:17,600
so i'm sean duncan i am a technical

00:00:16,080 --> 00:00:21,359
architect with digital pulp

00:00:17,600 --> 00:00:23,439
um i live in brooklyn and uh

00:00:21,359 --> 00:00:24,960
our offices when we were open uh are in

00:00:23,439 --> 00:00:26,560
manhattan at the moment like everybody

00:00:24,960 --> 00:00:27,680
else we were dispersed

00:00:26,560 --> 00:00:30,320
but this is where to find me on

00:00:27,680 --> 00:00:32,640
drupal.org and on twitter

00:00:30,320 --> 00:00:34,320
and these slides are written in css and

00:00:32,640 --> 00:00:36,960
html and javascript

00:00:34,320 --> 00:00:38,879
and they're available online and so you

00:00:36,960 --> 00:00:41,920
can find them after the session

00:00:38,879 --> 00:00:45,840
at talks.shawndunkin.org

00:00:41,920 --> 00:00:45,840
extend commerce

00:00:46,079 --> 00:00:50,160
so i'm going to briefly very quickly go

00:00:48,320 --> 00:00:52,160
over

00:00:50,160 --> 00:00:53,680
coding concepts because most people are

00:00:52,160 --> 00:00:55,120
comfortable with these but there were a

00:00:53,680 --> 00:00:58,000
few people who weren't

00:00:55,120 --> 00:00:59,840
and i don't want anybody to feel feel

00:00:58,000 --> 00:01:02,079
left out

00:00:59,840 --> 00:01:02,079
so

00:01:04,960 --> 00:01:09,680
so php has had elementary objects for a

00:01:08,640 --> 00:01:12,560
really long time

00:01:09,680 --> 00:01:14,400
but it didn't have a full object model

00:01:12,560 --> 00:01:18,000
until php5

00:01:14,400 --> 00:01:21,119
and it's really come into its own

00:01:18,000 --> 00:01:21,119
in php7

00:01:21,520 --> 00:01:27,759
so my metaphor for an interface is the

00:01:24,720 --> 00:01:30,000
specification for the usb protocol

00:01:27,759 --> 00:01:30,000
uh

00:01:30,799 --> 00:01:34,880
the specification for for the usb

00:01:32,640 --> 00:01:35,920
protocol describes how usb signals are

00:01:34,880 --> 00:01:38,479
supposed to travel through

00:01:35,920 --> 00:01:40,079
a usb cable and and then it describes

00:01:38,479 --> 00:01:41,439
how a usb cable

00:01:40,079 --> 00:01:43,520
should be constructed all the kinds of

00:01:41,439 --> 00:01:44,960
things that it should do

00:01:43,520 --> 00:01:46,799
but it's actually nothing's being

00:01:44,960 --> 00:01:50,479
manufactured here there's nothing

00:01:46,799 --> 00:01:51,600
you can use and so interfaces are much

00:01:50,479 --> 00:01:53,439
like that

00:01:51,600 --> 00:01:55,520
they define the things that classes must

00:01:53,439 --> 00:01:57,920
implement but they don't actually do

00:01:55,520 --> 00:01:57,920
anything

00:01:58,320 --> 00:02:02,320
so i'm going to skip over these code

00:01:59,520 --> 00:02:04,240
examples since

00:02:02,320 --> 00:02:06,840
people are mostly familiar with them but

00:02:04,240 --> 00:02:09,599
i want to give everybody else at least a

00:02:06,840 --> 00:02:12,400
basic so

00:02:09,599 --> 00:02:14,319
for for classes our our analogy becomes

00:02:12,400 --> 00:02:18,239
a little less precise

00:02:14,319 --> 00:02:20,400
but there are a lot of different uh

00:02:18,239 --> 00:02:21,760
usb manufacturers out there and each of

00:02:20,400 --> 00:02:23,520
them has to come up with a way to

00:02:21,760 --> 00:02:25,520
manufacture their usb

00:02:23,520 --> 00:02:27,840
cable and the model of cable they have

00:02:25,520 --> 00:02:29,599
to come up with a detailed design

00:02:27,840 --> 00:02:31,040
that's going to get implemented and a

00:02:29,599 --> 00:02:32,720
class is much like that

00:02:31,040 --> 00:02:37,840
they're a variety of designs but they're

00:02:32,720 --> 00:02:37,840
all usb

00:02:39,280 --> 00:02:43,440
and so finally object is the actual usb

00:02:41,599 --> 00:02:45,920
cable that you hold in your hand

00:02:43,440 --> 00:02:46,879
um and in programming it's it's the

00:02:45,920 --> 00:02:48,640
class that's been

00:02:46,879 --> 00:02:50,319
instantiated it's been it's been

00:02:48,640 --> 00:02:52,400
initialized with all of its values

00:02:50,319 --> 00:02:54,560
stored in a variable and it's ready to

00:02:52,400 --> 00:02:54,560
work

00:02:58,000 --> 00:03:01,280
so then there's other two other concepts

00:03:00,480 --> 00:03:03,840
that i'm going to use

00:03:01,280 --> 00:03:05,280
talking about the architecture the

00:03:03,840 --> 00:03:08,159
object composition

00:03:05,280 --> 00:03:08,159
and inheritance

00:03:08,720 --> 00:03:13,280
so inheritance the ancestry of our

00:03:11,920 --> 00:03:16,720
family dogs

00:03:13,280 --> 00:03:19,680
is ancient this is recognizably

00:03:16,720 --> 00:03:21,120
a canine-like creature it's from a

00:03:19,680 --> 00:03:23,519
petroglyph

00:03:21,120 --> 00:03:24,720
very very very very very long time ago

00:03:23,519 --> 00:03:28,080
and it looks much like

00:03:24,720 --> 00:03:29,760
a dog because our dogs today have

00:03:28,080 --> 00:03:32,000
inherited common characteristics from

00:03:29,760 --> 00:03:34,640
our from our ancestors

00:03:32,000 --> 00:03:35,519
in programming class inheritance means

00:03:34,640 --> 00:03:38,000
extending

00:03:35,519 --> 00:03:40,159
some other class which we call a parent

00:03:38,000 --> 00:03:42,799
and the child class inherits

00:03:40,159 --> 00:03:47,280
all the parents qualities but then is

00:03:42,799 --> 00:03:50,239
able to override some of them

00:03:47,280 --> 00:03:51,599
composition um in the real world my

00:03:50,239 --> 00:03:54,799
metaphor is a car

00:03:51,599 --> 00:03:56,480
and here's an assembly line and

00:03:54,799 --> 00:03:58,400
cars are made of many distinct

00:03:56,480 --> 00:04:00,640
components exposed here

00:03:58,400 --> 00:04:02,080
looks like we can see a brake drum and

00:04:00,640 --> 00:04:04,959
lots of other components and each of

00:04:02,080 --> 00:04:07,519
those is a discrete object

00:04:04,959 --> 00:04:08,879
and when you put them together you get a

00:04:07,519 --> 00:04:10,239
car

00:04:08,879 --> 00:04:12,840
and you can get different kinds of cars

00:04:10,239 --> 00:04:14,720
by swapping in and out different

00:04:12,840 --> 00:04:17,199
components

00:04:14,720 --> 00:04:19,040
so as a programming concept composition

00:04:17,199 --> 00:04:22,320
means designing a class to hold

00:04:19,040 --> 00:04:22,320
objects from other classes

00:04:23,919 --> 00:04:27,199
all right so here's the part that seems

00:04:25,840 --> 00:04:28,400
like most everybody came to my session

00:04:27,199 --> 00:04:32,000
for we're going to talk about

00:04:28,400 --> 00:04:32,000
some elements of drupal architecture

00:04:36,880 --> 00:04:40,880
today i'm going to talk about

00:04:38,240 --> 00:04:43,840
controllers and plugins

00:04:40,880 --> 00:04:43,840
and services

00:04:44,720 --> 00:04:47,600
so a controller

00:04:48,080 --> 00:04:53,919
a controller is a class whose job is to

00:04:51,680 --> 00:04:56,560
process a user's request

00:04:53,919 --> 00:04:58,160
and return an appropriate response

00:04:56,560 --> 00:05:00,400
drupal as a whole

00:04:58,160 --> 00:05:01,759
uses a front controller architecture and

00:05:00,400 --> 00:05:02,880
there's a single point which all the

00:05:01,759 --> 00:05:04,800
requests come in

00:05:02,880 --> 00:05:07,919
and then they get have to get dispatched

00:05:04,800 --> 00:05:07,919
to the appropriate place

00:05:08,840 --> 00:05:14,000
and a lot of the times

00:05:11,199 --> 00:05:15,600
that place is a controller most of the

00:05:14,000 --> 00:05:16,560
time when you're writing a controller

00:05:15,600 --> 00:05:18,800
you don't have to write the whole thing

00:05:16,560 --> 00:05:21,759
from scratch there's

00:05:18,800 --> 00:05:22,960
a class in drupal core called base

00:05:21,759 --> 00:05:25,440
controller

00:05:22,960 --> 00:05:27,280
and you can extend that class using the

00:05:25,440 --> 00:05:29,039
pattern we just briefly looked at

00:05:27,280 --> 00:05:30,880
called inheritance so here's a little

00:05:29,039 --> 00:05:32,880
snippet from the

00:05:30,880 --> 00:05:34,240
um the block content controller in

00:05:32,880 --> 00:05:36,400
drupal core

00:05:34,240 --> 00:05:39,360
and you can see that it's control its

00:05:36,400 --> 00:05:41,919
extending controller base

00:05:39,360 --> 00:05:43,520
and uh we've gotten a lot of good

00:05:41,919 --> 00:05:45,759
documentation now

00:05:43,520 --> 00:05:47,919
that we're come transitioning out of

00:05:45,759 --> 00:05:49,919
drupal 8 into drupal 9.

00:05:47,919 --> 00:05:52,000
but one of the things that one of the

00:05:49,919 --> 00:05:54,320
learnings i will be taking with me from

00:05:52,000 --> 00:05:55,840
from eight to nine is at the beginning

00:05:54,320 --> 00:05:57,840
uh there wasn't a whole lot of

00:05:55,840 --> 00:05:58,800
documentation written for drupal 8's new

00:05:57,840 --> 00:06:01,440
architecture

00:05:58,800 --> 00:06:03,360
and there what there was we're used to

00:06:01,440 --> 00:06:04,639
being able to go to blog post upon blog

00:06:03,360 --> 00:06:07,360
posts of people who solve

00:06:04,639 --> 00:06:07,919
problems drupal 8 was in development so

00:06:07,360 --> 00:06:09,680
long

00:06:07,919 --> 00:06:11,520
and the architecture evolved so much

00:06:09,680 --> 00:06:13,120
over the five years it was being built

00:06:11,520 --> 00:06:14,880
sometimes you would find blog posts that

00:06:13,120 --> 00:06:16,240
were four years old and they weren't

00:06:14,880 --> 00:06:18,160
accurate anymore

00:06:16,240 --> 00:06:19,520
so the learning that i'm taking with me

00:06:18,160 --> 00:06:22,080
is to go and look at the code

00:06:19,520 --> 00:06:23,520
so if you're new to creating custom

00:06:22,080 --> 00:06:26,240
features in drupal

00:06:23,520 --> 00:06:26,720
uh one of the places that you can learn

00:06:26,240 --> 00:06:28,400
a lot

00:06:26,720 --> 00:06:30,160
is by going actually to drupal core and

00:06:28,400 --> 00:06:34,800
finding something similar and looking at

00:06:30,160 --> 00:06:37,680
how it was implemented

00:06:34,800 --> 00:06:39,440
now it's a double tap so how do we get

00:06:37,680 --> 00:06:41,360
to the controller how do we how do we

00:06:39,440 --> 00:06:43,199
connect that user's request with the

00:06:41,360 --> 00:06:44,800
controller it happens in the routing

00:06:43,199 --> 00:06:46,560
system

00:06:44,800 --> 00:06:48,560
the routing system connects the user's

00:06:46,560 --> 00:06:51,039
request with the controller

00:06:48,560 --> 00:06:52,639
and drupal discovers routes by looking

00:06:51,039 --> 00:06:56,400
in specially named files

00:06:52,639 --> 00:06:59,080
yaml files that are named

00:06:56,400 --> 00:07:01,280
in a naming pattern which is your

00:06:59,080 --> 00:07:04,560
modulename.routing.yaml

00:07:01,280 --> 00:07:05,039
so here is the block content routing

00:07:04,560 --> 00:07:06,880
file

00:07:05,039 --> 00:07:08,160
that routes to the controller we were

00:07:06,880 --> 00:07:11,759
just looking at

00:07:08,160 --> 00:07:13,599
and you can see that each entry starts

00:07:11,759 --> 00:07:16,560
with an identifier

00:07:13,599 --> 00:07:18,560
so we have block content dot add page is

00:07:16,560 --> 00:07:21,840
the name of this route

00:07:18,560 --> 00:07:22,880
the path that it uses is slash block

00:07:21,840 --> 00:07:26,639
slash ad

00:07:22,880 --> 00:07:29,120
and if you enter that route into drupal

00:07:26,639 --> 00:07:30,000
drupal is going to send that request to

00:07:29,120 --> 00:07:32,400
the block content

00:07:30,000 --> 00:07:33,840
controllers add method which is listed

00:07:32,400 --> 00:07:36,639
on the controller line this is how you

00:07:33,840 --> 00:07:36,639
wire them together

00:07:39,919 --> 00:07:46,720
plugins so plugins

00:07:43,759 --> 00:07:48,240
i look at them as configuration packaged

00:07:46,720 --> 00:07:51,520
with functionality

00:07:48,240 --> 00:07:54,639
all plugins have

00:07:51,520 --> 00:07:57,759
a batch of configuration and

00:07:54,639 --> 00:08:00,000
then those are those are loaded into the

00:07:57,759 --> 00:08:02,720
plugins class and you can add on

00:08:00,000 --> 00:08:04,879
methods to those to those plugins do

00:08:02,720 --> 00:08:07,919
things with that configuration

00:08:04,879 --> 00:08:09,759
and typically plug-ins are the kinds of

00:08:07,919 --> 00:08:13,440
tasks and configuration that

00:08:09,759 --> 00:08:16,879
you have multiple similar cases and

00:08:13,440 --> 00:08:19,919
there's some variation so rather than

00:08:16,879 --> 00:08:22,879
creating classes

00:08:19,919 --> 00:08:25,199
sort of whole cloth or coming up with

00:08:22,879 --> 00:08:27,280
some way to create them yourselves

00:08:25,199 --> 00:08:29,520
these plug the plug-in system allows you

00:08:27,280 --> 00:08:30,800
to create plug-ins that can get

00:08:29,520 --> 00:08:33,200
created for you in the right

00:08:30,800 --> 00:08:35,200
circumstances

00:08:33,200 --> 00:08:38,839
and again plug-ins usually use the

00:08:35,200 --> 00:08:40,240
inheritance pattern of extending a base

00:08:38,839 --> 00:08:43,680
class

00:08:40,240 --> 00:08:46,959
so field formatters in drupal core

00:08:43,680 --> 00:08:50,880
are plugins here we have the

00:08:46,959 --> 00:08:50,880
the plugin for the image formatter

00:08:50,959 --> 00:08:57,440
you can see that it's extending another

00:08:54,560 --> 00:08:58,080
class the numeric formatter base class

00:08:57,440 --> 00:09:00,640
and

00:08:58,080 --> 00:09:02,720
there's these this comment stuff up here

00:09:00,640 --> 00:09:05,519
at the top

00:09:02,720 --> 00:09:07,360
if you're coming to drupal from some

00:09:05,519 --> 00:09:09,200
other programming system

00:09:07,360 --> 00:09:10,480
there are some other languages that have

00:09:09,200 --> 00:09:11,440
that have been doing this in recent

00:09:10,480 --> 00:09:14,000
years

00:09:11,440 --> 00:09:16,560
but really pioneered by symphony and

00:09:14,000 --> 00:09:19,440
with their annotation system

00:09:16,560 --> 00:09:20,240
comments are not just text that gets

00:09:19,440 --> 00:09:22,480
ignored

00:09:20,240 --> 00:09:24,800
but actually text that gets processed

00:09:22,480 --> 00:09:27,519
when it's formatted in a particular way

00:09:24,800 --> 00:09:28,480
so this part up here at the top is

00:09:27,519 --> 00:09:32,000
actually

00:09:28,480 --> 00:09:34,480
part of the plugin's information um

00:09:32,000 --> 00:09:36,080
it says what kind of plugin this is it's

00:09:34,480 --> 00:09:38,880
a field formatter plugin

00:09:36,080 --> 00:09:40,399
states its id its label and the kind of

00:09:38,880 --> 00:09:42,720
field types

00:09:40,399 --> 00:09:43,519
that it applies to every group of

00:09:42,720 --> 00:09:45,920
plugins

00:09:43,519 --> 00:09:47,040
will have particular information that's

00:09:45,920 --> 00:09:51,839
expected

00:09:47,040 --> 00:09:51,839
to be up here in these annotations

00:09:54,800 --> 00:10:00,080
plugins are assembled by a factory class

00:09:57,839 --> 00:10:05,200
a factory class is a class whose whole

00:10:00,080 --> 00:10:08,959
job is to make other classes

00:10:05,200 --> 00:10:11,040
and then there are services services

00:10:08,959 --> 00:10:12,720
are classes that are specifically

00:10:11,040 --> 00:10:14,880
created to be used by

00:10:12,720 --> 00:10:17,839
other classes to use the composition

00:10:14,880 --> 00:10:20,720
pattern that we were looking at earlier

00:10:17,839 --> 00:10:23,920
since since service objects are used by

00:10:20,720 --> 00:10:26,000
other objects they're kind of hidden

00:10:23,920 --> 00:10:28,000
drupal discovers services by looking

00:10:26,000 --> 00:10:31,120
also in specially named files

00:10:28,000 --> 00:10:32,160
the modulename.services.yaml and

00:10:31,120 --> 00:10:33,800
drupal's core

00:10:32,160 --> 00:10:35,360
services are listed in

00:10:33,800 --> 00:10:38,480
core.services.emil

00:10:35,360 --> 00:10:40,399
in the core directory so here's a

00:10:38,480 --> 00:10:42,079
service definition again from the block

00:10:40,399 --> 00:10:44,640
module

00:10:42,079 --> 00:10:46,640
and you you can see that for example the

00:10:44,640 --> 00:10:50,000
block repository service

00:10:46,640 --> 00:10:52,959
it's named block.repository and

00:10:50,000 --> 00:10:54,160
it calls a particular class and we're

00:10:52,959 --> 00:10:56,000
going to look at these arguments and

00:10:54,160 --> 00:11:01,839
what they're for

00:10:56,000 --> 00:11:01,839
here in a little bit

00:11:03,519 --> 00:11:07,519
a powerful approach to composition it's

00:11:05,680 --> 00:11:09,120
not the only way to do composition but a

00:11:07,519 --> 00:11:10,880
powerful approach to composition that's

00:11:09,120 --> 00:11:13,120
particularly common in drupal is called

00:11:10,880 --> 00:11:15,760
dependency injection

00:11:13,120 --> 00:11:16,560
and in dependency injection the specific

00:11:15,760 --> 00:11:18,880
objects

00:11:16,560 --> 00:11:20,000
that are added to the class are injected

00:11:18,880 --> 00:11:22,800
at runtime

00:11:20,000 --> 00:11:23,200
rather than being statically declared

00:11:22,800 --> 00:11:26,640
and

00:11:23,200 --> 00:11:28,160
hardwired into the class so let's go

00:11:26,640 --> 00:11:30,079
back to this

00:11:28,160 --> 00:11:31,600
service definition that we saw in

00:11:30,079 --> 00:11:34,079
services.yaml

00:11:31,600 --> 00:11:35,839
you see in the arguments section that

00:11:34,079 --> 00:11:38,480
it's calling for

00:11:35,839 --> 00:11:40,079
something called add entitytype.manager

00:11:38,480 --> 00:11:44,000
at theme.manager

00:11:40,079 --> 00:11:45,720
and at dot manager these are service

00:11:44,000 --> 00:11:48,959
identifiers just like

00:11:45,720 --> 00:11:52,800
block.repository and those

00:11:48,959 --> 00:11:54,880
end up being arguments

00:11:52,800 --> 00:11:56,880
objects that are going to get passed to

00:11:54,880 --> 00:11:58,959
the constructor for this service

00:11:56,880 --> 00:12:00,079
so down here is the constructor for this

00:11:58,959 --> 00:12:02,440
service

00:12:00,079 --> 00:12:03,920
you can see that where we called for

00:12:02,440 --> 00:12:07,440
entitytype.manager

00:12:03,920 --> 00:12:09,600
we're getting something that is of the

00:12:07,440 --> 00:12:11,680
entity type manager interface we're

00:12:09,600 --> 00:12:13,519
getting a theme manager interface

00:12:11,680 --> 00:12:14,800
and we're getting a context handler

00:12:13,519 --> 00:12:16,240
interface

00:12:14,800 --> 00:12:17,920
this is where the power of interfaces

00:12:16,240 --> 00:12:20,079
starts to come in

00:12:17,920 --> 00:12:21,680
there can be lots of classes that

00:12:20,079 --> 00:12:23,360
implement those interfaces as long as

00:12:21,680 --> 00:12:25,600
they have all the right methods

00:12:23,360 --> 00:12:27,600
so when you declare that you are

00:12:25,600 --> 00:12:31,760
dependent upon the entity type

00:12:27,600 --> 00:12:34,720
dot manager service drupal is free

00:12:31,760 --> 00:12:35,920
to completely change all kinds of things

00:12:34,720 --> 00:12:38,320
about the entity

00:12:35,920 --> 00:12:39,040
type manager service your service will

00:12:38,320 --> 00:12:41,680
still work

00:12:39,040 --> 00:12:43,040
as long as it's still in any type

00:12:41,680 --> 00:12:45,040
manager interface

00:12:43,040 --> 00:12:46,720
and you're not saying i want this

00:12:45,040 --> 00:12:48,240
specific class

00:12:46,720 --> 00:12:50,000
with dependency injection you're saying

00:12:48,240 --> 00:12:52,320
i want a class of this interface i want

00:12:50,000 --> 00:12:55,360
a class of these capabilities

00:12:52,320 --> 00:12:56,720
and you need to give me what it is that

00:12:55,360 --> 00:12:58,480
is currently defined as that

00:12:56,720 --> 00:13:00,560
so that's why i say it's injected at

00:12:58,480 --> 00:13:02,240
runtime and that's very powerful because

00:13:00,560 --> 00:13:04,839
it gives us a lot of flexibility

00:13:02,240 --> 00:13:07,760
and room room to adapt to new

00:13:04,839 --> 00:13:12,800
circumstances

00:13:07,760 --> 00:13:12,800
okay let's talk about extending commerce

00:13:15,680 --> 00:13:21,839
so here's the goal our goal was to have

00:13:18,320 --> 00:13:24,959
a donation specific flow

00:13:21,839 --> 00:13:27,440
in standard e-commerce you

00:13:24,959 --> 00:13:29,120
you you browse through a catalog you

00:13:27,440 --> 00:13:31,200
pick a product

00:13:29,120 --> 00:13:33,360
you choose that product you add it into

00:13:31,200 --> 00:13:36,399
your shopping cart

00:13:33,360 --> 00:13:38,160
and for certain um circumstances

00:13:36,399 --> 00:13:39,920
that can work for a donation especially

00:13:38,160 --> 00:13:41,839
if you have uh

00:13:39,920 --> 00:13:43,519
circumstances where you have actual

00:13:41,839 --> 00:13:46,160
physical products

00:13:43,519 --> 00:13:47,760
that are also available but a lot of

00:13:46,160 --> 00:13:49,839
non-profits

00:13:47,760 --> 00:13:50,959
are simply what they're trying what

00:13:49,839 --> 00:13:52,399
they're doing is they're fundraising

00:13:50,959 --> 00:13:54,720
online they're just taking

00:13:52,399 --> 00:13:57,040
donations so putting something in the

00:13:54,720 --> 00:13:59,600
cart doesn't really make sense

00:13:57,040 --> 00:14:01,199
they want to donate the user wants to

00:13:59,600 --> 00:14:02,240
donate and you want it to be seamless

00:14:01,199 --> 00:14:04,160
and frictionless

00:14:02,240 --> 00:14:05,519
so you just want to go into the donation

00:14:04,160 --> 00:14:07,920
so this is where we're headed

00:14:05,519 --> 00:14:09,839
we're headed toward the goal of a

00:14:07,920 --> 00:14:13,839
visitor being able to click on

00:14:09,839 --> 00:14:15,360
something that kicks off a donation and

00:14:13,839 --> 00:14:17,760
the traditional ecommerce model really

00:14:15,360 --> 00:14:19,760
isn't there the information is collected

00:14:17,760 --> 00:14:21,040
their donation is collected and they're

00:14:19,760 --> 00:14:24,000
thanked

00:14:21,040 --> 00:14:26,480
so so we gonna start off with a

00:14:24,000 --> 00:14:26,480
controller

00:14:26,800 --> 00:14:29,760
because we're going to have a user

00:14:27,920 --> 00:14:31,360
request to make a donation and we want

00:14:29,760 --> 00:14:32,560
to respond to it in a particular way

00:14:31,360 --> 00:14:36,800
that's a little different

00:14:32,560 --> 00:14:36,800
than what ecommerce normally does

00:14:41,199 --> 00:14:48,959
so we have a couple of routes here

00:14:45,279 --> 00:14:52,560
um we have uh

00:14:48,959 --> 00:14:55,279
we have a route for kicking things off

00:14:52,560 --> 00:14:56,320
because nothing exists yet we also have

00:14:55,279 --> 00:14:59,680
a route for getting to

00:14:56,320 --> 00:15:01,199
various steps in the order and they both

00:14:59,680 --> 00:15:05,199
they both connect the user or send the

00:15:01,199 --> 00:15:05,199
request to the donation controller

00:15:07,680 --> 00:15:13,040
so here's the here is that donation

00:15:10,839 --> 00:15:14,800
controller

00:15:13,040 --> 00:15:16,639
you can see that it implements container

00:15:14,800 --> 00:15:20,560
injection interface

00:15:16,639 --> 00:15:25,040
this is the magic that makes drupal's

00:15:20,560 --> 00:15:25,040
dependency injection system work

00:15:25,440 --> 00:15:32,320
normally when an object is created php

00:15:28,560 --> 00:15:35,120
calls the constructor but in

00:15:32,320 --> 00:15:36,160
in our system there is a point in the

00:15:35,120 --> 00:15:40,000
code that watches

00:15:36,160 --> 00:15:41,839
for objects that have this interface

00:15:40,000 --> 00:15:43,839
container injection interface and

00:15:41,839 --> 00:15:44,959
instead invokes a factory a factory

00:15:43,839 --> 00:15:47,440
class remember

00:15:44,959 --> 00:15:48,320
is a class whose whole business is

00:15:47,440 --> 00:15:50,480
creating

00:15:48,320 --> 00:15:52,720
or instantiating other objects but in

00:15:50,480 --> 00:15:55,360
this case rather than calling

00:15:52,720 --> 00:15:56,240
calling the constructor the factory

00:15:55,360 --> 00:15:58,079
calls

00:15:56,240 --> 00:15:59,279
the create method because this container

00:15:58,079 --> 00:16:01,279
injection interface

00:15:59,279 --> 00:16:03,120
the thing that it enforces is that there

00:16:01,279 --> 00:16:06,480
is a create method

00:16:03,120 --> 00:16:06,480
so here we have the properties of the

00:16:06,839 --> 00:16:10,959
object

00:16:08,720 --> 00:16:12,240
this is my this is um this is my

00:16:10,959 --> 00:16:14,959
constructor so i'm

00:16:12,240 --> 00:16:16,079
i'm perfectly comfortable uh having a

00:16:14,959 --> 00:16:19,199
constructor

00:16:16,079 --> 00:16:21,279
um and uh here is

00:16:19,199 --> 00:16:22,959
the create method that gets called and

00:16:21,279 --> 00:16:27,279
we pick out

00:16:22,959 --> 00:16:29,199
the the services from the container

00:16:27,279 --> 00:16:30,399
that we want to inject and we send them

00:16:29,199 --> 00:16:33,839
to the constructor

00:16:30,399 --> 00:16:36,399
through a call to static

00:16:33,839 --> 00:16:38,320
so we're going to look at two methods in

00:16:36,399 --> 00:16:40,880
this controller

00:16:38,320 --> 00:16:42,399
we're going to look at what i call the

00:16:40,880 --> 00:16:45,440
front controller method

00:16:42,399 --> 00:16:47,440
because the user is going to click on on

00:16:45,440 --> 00:16:49,680
slash donate

00:16:47,440 --> 00:16:51,199
to kick off a donation what we need to

00:16:49,680 --> 00:16:53,839
do is we need to create

00:16:51,199 --> 00:16:54,880
behind the scenes we need to create

00:16:53,839 --> 00:16:56,240
something that the user is going to

00:16:54,880 --> 00:16:57,839
purchase

00:16:56,240 --> 00:16:59,199
and we're going to we need to kick off

00:16:57,839 --> 00:17:00,480
we also need to create an order to

00:16:59,199 --> 00:17:01,920
contain that thing that the user is

00:17:00,480 --> 00:17:05,360
going to purchase

00:17:01,920 --> 00:17:06,480
so it's also possible that the user has

00:17:05,360 --> 00:17:08,720
left their donation

00:17:06,480 --> 00:17:12,559
for some reason and come back so we look

00:17:08,720 --> 00:17:12,559
to see if we have any stored order

00:17:14,240 --> 00:17:21,360
and then

00:17:18,559 --> 00:17:23,039
if we do we load that order otherwise we

00:17:21,360 --> 00:17:26,799
get a new order

00:17:23,039 --> 00:17:28,799
and now we have an order we also create

00:17:26,799 --> 00:17:30,480
a custom checkout flow for this process

00:17:28,799 --> 00:17:32,240
because it's a little bit different

00:17:30,480 --> 00:17:35,360
to check out a donation than a regular

00:17:32,240 --> 00:17:37,679
checkout so we get that checkout process

00:17:35,360 --> 00:17:39,120
and we redirect the user into that

00:17:37,679 --> 00:17:42,160
checkout process

00:17:39,120 --> 00:17:42,160
at the appropriate step

00:17:42,240 --> 00:17:46,480
the next step method's pretty similar

00:17:44,480 --> 00:17:47,679
the only difference is that we're not

00:17:46,480 --> 00:17:49,200
creating any orders

00:17:47,679 --> 00:17:51,039
and we're simply getting the order

00:17:49,200 --> 00:17:54,880
that's stored in the

00:17:51,039 --> 00:17:57,039
url and

00:17:54,880 --> 00:17:59,520
we're pulling it up and we're we're

00:17:57,039 --> 00:18:02,799
redirecting the user to the form builder

00:17:59,520 --> 00:18:02,799
for that checkout order

00:18:02,960 --> 00:18:05,840
so that's a controller

00:18:08,720 --> 00:18:12,160
there's nothing about php that would

00:18:10,720 --> 00:18:14,400
keep us from

00:18:12,160 --> 00:18:16,960
putting into the donation controller the

00:18:14,400 --> 00:18:19,520
logic to create new orders

00:18:16,960 --> 00:18:22,320
but it's really much a much better

00:18:19,520 --> 00:18:25,360
programming methodology for your classes

00:18:22,320 --> 00:18:30,400
to be focused at one job

00:18:25,360 --> 00:18:32,400
and so we create a new order service

00:18:30,400 --> 00:18:34,720
this new order service has only one job

00:18:32,400 --> 00:18:36,400
which is to create new orders

00:18:34,720 --> 00:18:38,400
but that allows the donation controller

00:18:36,400 --> 00:18:40,320
to have only one job which is to respond

00:18:38,400 --> 00:18:42,480
to user requests

00:18:40,320 --> 00:18:44,240
and route the user to the appropriate

00:18:42,480 --> 00:18:45,440
code that's going to

00:18:44,240 --> 00:18:47,760
bring up on the screen the thing that

00:18:45,440 --> 00:18:51,440
they want to see

00:18:47,760 --> 00:18:53,679
so and this new order service is

00:18:51,440 --> 00:18:55,679
in the in the donation container

00:18:53,679 --> 00:18:59,360
controller by dependency injection

00:18:55,679 --> 00:19:01,840
so here's the new order class

00:18:59,360 --> 00:19:04,160
it's a service so it can get dependency

00:19:01,840 --> 00:19:06,480
injected

00:19:04,160 --> 00:19:07,520
other services so we're getting a

00:19:06,480 --> 00:19:09,919
service that

00:19:07,520 --> 00:19:11,600
provides the current store that's being

00:19:09,919 --> 00:19:14,160
used in drupal commerce

00:19:11,600 --> 00:19:17,120
a proxy for the user account and the

00:19:14,160 --> 00:19:17,120
current request stack

00:19:18,160 --> 00:19:22,880
this is the primary method of the new

00:19:20,320 --> 00:19:26,559
order service

00:19:22,880 --> 00:19:26,559
and it creates an order

00:19:26,720 --> 00:19:33,200
and then it

00:19:29,840 --> 00:19:33,200
initiates it with an empty price

00:19:33,440 --> 00:19:39,840
and it gives it back that's really all

00:19:35,919 --> 00:19:39,840
it does

00:19:41,120 --> 00:19:45,679
now plugins plugins within plugins

00:19:43,679 --> 00:19:48,400
within plugins

00:19:45,679 --> 00:19:49,200
the checkout process in drupal commerce

00:19:48,400 --> 00:19:50,240
is a plug-in

00:19:49,200 --> 00:19:52,559
because you can have more than one

00:19:50,240 --> 00:19:55,840
checkout process

00:19:52,559 --> 00:19:58,080
you tied the checkout process for uh

00:19:55,840 --> 00:20:00,320
to to an order type you can have more

00:19:58,080 --> 00:20:02,080
than one order type in drupal commerce

00:20:00,320 --> 00:20:03,360
and then within checkout there are

00:20:02,080 --> 00:20:07,760
multiple steps

00:20:03,360 --> 00:20:11,039
each of those steps is a plugin

00:20:07,760 --> 00:20:11,919
so here's the checkout flow which is

00:20:11,039 --> 00:20:15,520
extending

00:20:11,919 --> 00:20:15,520
triple commerce's checkout flow

00:20:17,360 --> 00:20:21,919
i'm not going to go through every method

00:20:19,200 --> 00:20:24,880
but this

00:20:21,919 --> 00:20:27,360
this checkout flow is designed to to add

00:20:24,880 --> 00:20:29,280
some additional steps

00:20:27,360 --> 00:20:30,640
and also to customize the checkout form

00:20:29,280 --> 00:20:34,960
a little bit to add

00:20:30,640 --> 00:20:36,720
an offline donation link sometimes uh

00:20:34,960 --> 00:20:38,159
certain nonprofits in addition to

00:20:36,720 --> 00:20:39,679
collecting online donations want to have

00:20:38,159 --> 00:20:43,039
an option for somebody to

00:20:39,679 --> 00:20:46,480
download a form to mail it in

00:20:43,039 --> 00:20:48,799
and to add in some

00:20:46,480 --> 00:20:50,159
some purpose some additional steps to

00:20:48,799 --> 00:20:52,400
the default checkout flow

00:20:50,159 --> 00:20:54,159
it's its primary purpose it also is

00:20:52,400 --> 00:20:55,840
designed to pull in summaries and

00:20:54,159 --> 00:21:02,320
present them above the order

00:20:55,840 --> 00:21:04,960
rather than in a sidebar

00:21:02,320 --> 00:21:06,320
um the checkout pro the checkout panes

00:21:04,960 --> 00:21:07,919
we

00:21:06,320 --> 00:21:09,679
you can now you can design custom steps

00:21:07,919 --> 00:21:12,640
in drupal commerce and

00:21:09,679 --> 00:21:13,840
now there's no need to have a product to

00:21:12,640 --> 00:21:14,799
purchase but you have to have something

00:21:13,840 --> 00:21:16,640
to purchase

00:21:14,799 --> 00:21:18,799
well in drupal commerce's architecture

00:21:16,640 --> 00:21:21,919
it turns out that the line items

00:21:18,799 --> 00:21:25,039
are our or order items

00:21:21,919 --> 00:21:29,280
are are purchasable

00:21:25,039 --> 00:21:30,640
so we cr we define a custom order item

00:21:29,280 --> 00:21:33,039
donation

00:21:30,640 --> 00:21:35,360
and then we created two plugins to

00:21:33,039 --> 00:21:38,960
display different parts of that

00:21:35,360 --> 00:21:41,440
that order item entities forms for

00:21:38,960 --> 00:21:42,559
capturing information about the donation

00:21:41,440 --> 00:21:46,240
so

00:21:42,559 --> 00:21:48,480
this plugin is the um

00:21:46,240 --> 00:21:49,679
it's the first of those and one of the

00:21:48,480 --> 00:21:51,840
things that it does

00:21:49,679 --> 00:21:53,200
right up at the beginning is it sets the

00:21:51,840 --> 00:21:56,799
the form display mode

00:21:53,200 --> 00:21:58,960
for for this checkout step which will be

00:21:56,799 --> 00:21:59,760
used to render a certain subset of

00:21:58,960 --> 00:22:03,840
fields

00:21:59,760 --> 00:22:03,840
from the donation item

00:22:05,760 --> 00:22:08,880
so let's have a look we're going to do

00:22:07,679 --> 00:22:11,440
the the

00:22:08,880 --> 00:22:14,159
always wildly risky thing and look at

00:22:11,440 --> 00:22:14,159
some live demo

00:22:14,960 --> 00:22:18,960
so here we have uh drupal 8 installed

00:22:17,679 --> 00:22:20,799
but just drupal commerce

00:22:18,960 --> 00:22:22,960
um and the code that we've been talking

00:22:20,799 --> 00:22:27,840
about

00:22:22,960 --> 00:22:27,840
and so we click on donate

00:22:29,120 --> 00:22:32,320
i'm just going to go through the

00:22:30,000 --> 00:22:35,440
simplest case here

00:22:32,320 --> 00:22:36,080
i have a test payment gateway installed

00:22:35,440 --> 00:22:37,679
which

00:22:36,080 --> 00:22:39,360
collects billing information but doesn't

00:22:37,679 --> 00:22:40,080
actually charge anybody anything because

00:22:39,360 --> 00:22:44,240
we're not

00:22:40,080 --> 00:22:47,280
actually paying anyone anything um

00:22:44,240 --> 00:22:49,760
and we donate and

00:22:47,280 --> 00:22:50,559
that created uh an order in

00:22:49,760 --> 00:22:52,159
drupalcommerce

00:22:50,559 --> 00:22:54,799
it's very seamless and that's the whole

00:22:52,159 --> 00:22:56,320
point of this there's no

00:22:54,799 --> 00:22:58,240
going to there's no sense that you're

00:22:56,320 --> 00:22:59,280
checking out um other than

00:22:58,240 --> 00:23:01,760
you have to give your credit card

00:22:59,280 --> 00:23:01,760
information

00:23:02,080 --> 00:23:08,880
so it's also possible

00:23:06,080 --> 00:23:10,080
sometimes these sites are content rich

00:23:08,880 --> 00:23:12,240
and you want the user to

00:23:10,080 --> 00:23:13,760
return to where it was that they were

00:23:12,240 --> 00:23:16,559
and so we could also

00:23:13,760 --> 00:23:19,919
have added in the ability to carry with

00:23:16,559 --> 00:23:23,360
us a parameter that brings the user back

00:23:19,919 --> 00:23:26,559
to where they started so we donate

00:23:23,360 --> 00:23:29,679
again and back to the site and we go

00:23:26,559 --> 00:23:29,679
back to the node that we were on

00:23:29,919 --> 00:23:33,840
so that's the basic that's that's the

00:23:32,080 --> 00:23:36,320
whole functionality right there

00:23:33,840 --> 00:23:38,240
i'm using controller the service is

00:23:36,320 --> 00:23:41,919
instantiating a new order

00:23:38,240 --> 00:23:44,880
and setting default values

00:23:41,919 --> 00:23:45,760
so it's also we have an optional middle

00:23:44,880 --> 00:23:46,960
step

00:23:45,760 --> 00:23:50,000
so if i want to donate in honor of

00:23:46,960 --> 00:23:52,400
someone this is now a second plugin

00:23:50,000 --> 00:23:54,000
a second checkout step plugin that's

00:23:52,400 --> 00:23:57,679
using a form mode

00:23:54,000 --> 00:24:01,440
to display a part of that donation item

00:23:57,679 --> 00:24:05,919
to give fields to put in

00:24:01,440 --> 00:24:08,720
additional information for a dedication

00:24:05,919 --> 00:24:09,039
so we get to the end we've got a summary

00:24:08,720 --> 00:24:11,760
up

00:24:09,039 --> 00:24:13,279
up at the top to so the user can see

00:24:11,760 --> 00:24:16,159
what it is that they're doing

00:24:13,279 --> 00:24:17,840
this was a real commerce transaction

00:24:16,159 --> 00:24:19,840
there'd be a credit card form underneath

00:24:17,840 --> 00:24:22,880
this billing information form

00:24:19,840 --> 00:24:23,600
we make our donation and the thank you

00:24:22,880 --> 00:24:28,480
screen

00:24:23,600 --> 00:24:28,480
also carries the information about the

00:24:30,840 --> 00:24:33,840
donation

00:24:35,760 --> 00:24:39,840
that's that's the pre-planned

00:24:38,080 --> 00:24:42,960
presentation i intentionally

00:24:39,840 --> 00:24:44,640
i'm leaving 15 minutes at the end

00:24:42,960 --> 00:24:46,480
to answer questions so let me go over to

00:24:44,640 --> 00:24:49,120
the scroll because i'm all

00:24:46,480 --> 00:24:51,919
it's just me to see what kind of

00:24:49,120 --> 00:24:51,919
questions people have

00:24:55,120 --> 00:25:00,960
how do we get access to the slides the

00:24:56,960 --> 00:25:02,720
slides are online

00:25:00,960 --> 00:25:05,200
and i will paste the link in the chat

00:25:02,720 --> 00:25:05,200
how's that

00:25:09,520 --> 00:25:18,000
there we go um

00:25:14,480 --> 00:25:19,679
oh i see that uh thank you selwyn for

00:25:18,000 --> 00:25:21,440
helping out before i even saw that you

00:25:19,679 --> 00:25:23,360
answered that for them

00:25:21,440 --> 00:25:25,039
so plugins are used to add some more

00:25:23,360 --> 00:25:28,720
features to existing ones

00:25:25,039 --> 00:25:29,440
am i correct um oftentimes that's the

00:25:28,720 --> 00:25:32,640
case

00:25:29,440 --> 00:25:32,640
especially when you're starting out

00:25:33,919 --> 00:25:39,039
uh as i said the checkout flow is

00:25:37,120 --> 00:25:40,720
built with a plug-in and steps in the

00:25:39,039 --> 00:25:43,440
checkout flow are built

00:25:40,720 --> 00:25:45,200
with plugin you could write one of those

00:25:43,440 --> 00:25:46,720
plugins completely from scratch and not

00:25:45,200 --> 00:25:50,080
overwrite anything else

00:25:46,720 --> 00:25:52,400
um they have an interface

00:25:50,080 --> 00:25:52,400
that

00:25:53,840 --> 00:25:57,840
that it looks for let's see

00:26:04,480 --> 00:26:07,760
go back to that code sample

00:26:08,480 --> 00:26:11,679
you see that it's implementing a

00:26:09,679 --> 00:26:13,440
checkout pane interface

00:26:11,679 --> 00:26:14,880
so if you create a new plugin from

00:26:13,440 --> 00:26:16,960
scratch and you want to use as

00:26:14,880 --> 00:26:19,200
a checkout pane um you have to implement

00:26:16,960 --> 00:26:22,400
that interface you don't have to enter

00:26:19,200 --> 00:26:23,520
extend something else but you could

00:26:22,400 --> 00:26:25,840
because it's probably going to save you

00:26:23,520 --> 00:26:25,840
time

00:26:26,159 --> 00:26:29,279
see what test payment module am i using

00:26:28,320 --> 00:26:32,320
there's a payment

00:26:29,279 --> 00:26:35,600
example module in the

00:26:32,320 --> 00:26:37,120
in the commerce project um it's really

00:26:35,600 --> 00:26:38,480
meant to be an example for how to write

00:26:37,120 --> 00:26:43,520
a gateway no

00:26:38,480 --> 00:26:46,480
but the uh the off-site referral

00:26:43,520 --> 00:26:47,840
gateway that's in that it's in that

00:26:46,480 --> 00:26:53,840
example module

00:26:47,840 --> 00:26:53,840
it doesn't take any payments

00:26:54,960 --> 00:27:01,120
see yes

00:26:58,640 --> 00:27:02,720
so i request to demo the ajax amount

00:27:01,120 --> 00:27:04,159
update that was in the checkout pane

00:27:02,720 --> 00:27:06,320
i love it when people look at my code

00:27:04,159 --> 00:27:08,400
like that it's a really

00:27:06,320 --> 00:27:09,840
on the ball question so what that's

00:27:08,400 --> 00:27:12,960
about

00:27:09,840 --> 00:27:14,640
is i

00:27:12,960 --> 00:27:17,039
didn't test it in this implementation in

00:27:14,640 --> 00:27:19,919
this installation before but we'll

00:27:17,039 --> 00:27:20,399
we'll see what we have so when you're if

00:27:19,919 --> 00:27:22,159
you're done

00:27:20,399 --> 00:27:23,440
if you're donating monthly you probably

00:27:22,159 --> 00:27:26,480
don't want to donate 500

00:27:23,440 --> 00:27:28,960
a month so uh the formatter that we

00:27:26,480 --> 00:27:30,320
that we have for the amount um gives you

00:27:28,960 --> 00:27:33,200
the ability to put in

00:27:30,320 --> 00:27:34,000
different amounts for uh one time and

00:27:33,200 --> 00:27:38,159
monthly

00:27:34,000 --> 00:27:40,799
so when you change to monthly that ajax

00:27:38,159 --> 00:27:42,320
amount update comes in and it changes

00:27:40,799 --> 00:27:49,780
the amounts that are listed here on

00:27:42,320 --> 00:27:53,660
these radio buttons

00:27:49,780 --> 00:27:53,660
[Music]

00:27:55,600 --> 00:27:58,480
question is commerce so nicely

00:27:57,039 --> 00:28:00,399
documented that you could figure out

00:27:58,480 --> 00:28:02,080
your way around the myriad of classes to

00:28:00,399 --> 00:28:03,919
create your modules or did you just dig

00:28:02,080 --> 00:28:07,360
through miles of code

00:28:03,919 --> 00:28:10,799
um well it is nicely documented um but

00:28:07,360 --> 00:28:14,000
shout out to the the

00:28:10,799 --> 00:28:16,240
devs at centauro um they're just

00:28:14,000 --> 00:28:17,840
enormously helpful there's a commerce

00:28:16,240 --> 00:28:21,919
channel in drupal slack

00:28:17,840 --> 00:28:22,720
and then they answered all my questions

00:28:21,919 --> 00:28:24,240
when i was first

00:28:22,720 --> 00:28:26,480
trying to get to know drupal commerce

00:28:24,240 --> 00:28:29,520
several years ago

00:28:26,480 --> 00:28:30,080
but also they have i use them for this

00:28:29,520 --> 00:28:32,640
example

00:28:30,080 --> 00:28:33,679
one because we have code for that we

00:28:32,640 --> 00:28:36,559
think works really well

00:28:33,679 --> 00:28:37,360
but also commerce itself is really well

00:28:36,559 --> 00:28:40,480
architected

00:28:37,360 --> 00:28:43,600
in line with drupal architecture system

00:28:40,480 --> 00:28:45,200
so it's actually a really great place to

00:28:43,600 --> 00:28:48,000
go learn a lot about how drupal's

00:28:45,200 --> 00:28:48,000
architecture works

00:28:49,840 --> 00:28:56,240
and 100 with uh demetrius

00:28:53,919 --> 00:28:58,000
the code is really well documented it's

00:28:56,240 --> 00:29:00,159
really easy to read

00:28:58,000 --> 00:29:02,000
going back to what i said earlier uh

00:29:00,159 --> 00:29:02,720
used to be that we would go to blog

00:29:02,000 --> 00:29:04,640
posts

00:29:02,720 --> 00:29:05,760
to figure out things and there's lots of

00:29:04,640 --> 00:29:07,600
good blog posts now

00:29:05,760 --> 00:29:13,840
but it's taught me that um the first

00:29:07,600 --> 00:29:13,840
thing to do is is go look at the code

00:29:18,320 --> 00:29:23,039
now what are tags in services

00:29:24,480 --> 00:29:31,600
there are some services um

00:29:29,120 --> 00:29:32,480
that the whole the whole batch of them

00:29:31,600 --> 00:29:35,360
get run through

00:29:32,480 --> 00:29:35,360
based upon a tag

00:29:36,159 --> 00:29:39,600
and that's as much as i remember

00:29:37,600 --> 00:29:40,640
standing here um thank you for your

00:29:39,600 --> 00:29:44,240
question

00:29:40,640 --> 00:29:44,880
uh i would have i would have to go back

00:29:44,240 --> 00:29:47,440
and look at

00:29:44,880 --> 00:29:48,080
uh look at some of those implementations

00:29:47,440 --> 00:29:51,440
but

00:29:48,080 --> 00:29:53,919
but for example um no there are uh

00:29:51,440 --> 00:29:55,200
there are access services that are that

00:29:53,919 --> 00:29:58,799
they're all tagged so at a particular

00:29:55,200 --> 00:29:58,799
point all the access services run

00:30:05,600 --> 00:30:10,320
so this code that we're demonstrating

00:30:07,679 --> 00:30:12,880
today it's very close to being available

00:30:10,320 --> 00:30:14,799
on drupal.org a couple wrinkles

00:30:12,880 --> 00:30:15,840
introduced by the latest version of

00:30:14,799 --> 00:30:18,640
commerce that i'm

00:30:15,840 --> 00:30:20,240
making sure that our code is happy with

00:30:18,640 --> 00:30:21,679
so currently you can find it in my

00:30:20,240 --> 00:30:25,039
sandbox

00:30:21,679 --> 00:30:27,520
which you can find off of my

00:30:25,039 --> 00:30:28,960
my user tab in drupal.org but you'll

00:30:27,520 --> 00:30:30,159
also see

00:30:28,960 --> 00:30:32,080
you'll also be able to find it within

00:30:30,159 --> 00:30:37,840
the next within the next day or two

00:30:32,080 --> 00:30:37,840
at commerce donation flow

00:30:40,080 --> 00:30:44,880
that's right uh grender

00:30:43,679 --> 00:30:46,720
sorry if i'm not pronouncing your name

00:30:44,880 --> 00:30:48,399
correctly is reminding us that tags are

00:30:46,720 --> 00:30:50,080
used to register services that are

00:30:48,399 --> 00:30:53,039
that are used differently than others

00:30:50,080 --> 00:30:55,760
event subscribers is a great example

00:30:53,039 --> 00:30:57,519
an event subscriber is a service that

00:30:55,760 --> 00:31:00,080
watches for a particular event

00:30:57,519 --> 00:31:01,200
to occur and then um reacts to that and

00:31:00,080 --> 00:31:03,760
where

00:31:01,200 --> 00:31:04,799
we heard from in the dress note that

00:31:03,760 --> 00:31:07,840
we're continuing

00:31:04,799 --> 00:31:08,559
our evolution to move away from php

00:31:07,840 --> 00:31:11,919
hooks towards

00:31:08,559 --> 00:31:11,919
event driven code

00:31:14,000 --> 00:31:17,679
other question is would i use commerce

00:31:15,519 --> 00:31:19,039
for donations or rather roll something

00:31:17,679 --> 00:31:19,360
custom now that i've been through this

00:31:19,039 --> 00:31:22,080
fun

00:31:19,360 --> 00:31:23,840
i would 100 use commerce without any

00:31:22,080 --> 00:31:26,720
question

00:31:23,840 --> 00:31:28,640
because if you roll something custom you

00:31:26,720 --> 00:31:31,279
have to decide how it is you're going to

00:31:28,640 --> 00:31:32,159
interact with payments or services you

00:31:31,279 --> 00:31:33,840
have to interact

00:31:32,159 --> 00:31:35,840
decide how you're how you're going to

00:31:33,840 --> 00:31:37,679
deal with refunds you're going to you're

00:31:35,840 --> 00:31:41,279
going to have to decide

00:31:37,679 --> 00:31:41,279
everything from scratch

00:31:41,760 --> 00:31:45,760
the beauty of of drupal and the beauty

00:31:45,120 --> 00:31:48,080
of

00:31:45,760 --> 00:31:49,440
contributed modules and collaborative

00:31:48,080 --> 00:31:53,840
open source development

00:31:49,440 --> 00:31:57,039
is i was able to come in and figure out

00:31:53,840 --> 00:31:59,919
what was different about our case but

00:31:57,039 --> 00:32:02,240
all of the common things charging a

00:31:59,919 --> 00:32:04,159
credit card

00:32:02,240 --> 00:32:07,120
being able to swap one payment using any

00:32:04,159 --> 00:32:08,960
payment gateway that you want

00:32:07,120 --> 00:32:11,519
all of that stuff i didn't have to worry

00:32:08,960 --> 00:32:15,840
about a bit because the commerce

00:32:11,519 --> 00:32:15,840
developers had it all handled

00:32:18,880 --> 00:32:22,240
i have to say after many years of being

00:32:21,519 --> 00:32:23,519
in a room

00:32:22,240 --> 00:32:25,360
making these presentations and people

00:32:23,519 --> 00:32:27,519
coming to a microphone

00:32:25,360 --> 00:32:28,799
just feels really odd to have the

00:32:27,519 --> 00:32:31,760
questions coming in and chat

00:32:28,799 --> 00:32:32,320
i wish i could hear the tone to better

00:32:31,760 --> 00:32:42,480
understand

00:32:32,320 --> 00:32:43,679
where people are coming from oh cool you

00:32:42,480 --> 00:32:45,760
can invite people to join you

00:32:43,679 --> 00:32:48,000
um does anybody have a longer question

00:32:45,760 --> 00:32:48,000
um

00:32:49,260 --> 00:32:52,309
[Music]

00:32:54,840 --> 00:32:57,840
no

00:32:58,399 --> 00:33:02,480
you still have about five minutes

00:33:03,360 --> 00:33:11,840
i'll look at that okay someone

00:33:06,720 --> 00:33:11,840
showed up i clicked a plus

00:33:11,919 --> 00:33:17,360
there he is awesome

00:33:15,120 --> 00:33:18,799
i i have not fiddled with the commerce

00:33:17,360 --> 00:33:21,919
and drupal 8

00:33:18,799 --> 00:33:25,279
world yet i i did in 7 and

00:33:21,919 --> 00:33:26,559
before and it was wildly complicated and

00:33:25,279 --> 00:33:28,480
i remember ryan

00:33:26,559 --> 00:33:30,399
presenting over and over and over again

00:33:28,480 --> 00:33:32,240
about you know this is the flow

00:33:30,399 --> 00:33:34,080
has it gotten much much better and much

00:33:32,240 --> 00:33:38,720
smoother

00:33:34,080 --> 00:33:41,039
it has and um i think credit for that

00:33:38,720 --> 00:33:42,480
definitely goes to as kelly's pointing

00:33:41,039 --> 00:33:45,120
out um

00:33:42,480 --> 00:33:47,039
to the folks on the commerce team um but

00:33:45,120 --> 00:33:49,360
also credit goes to drupal for

00:33:47,039 --> 00:33:50,640
for taking the plunge with triple eight

00:33:49,360 --> 00:33:53,760
um to go

00:33:50,640 --> 00:33:57,000
all in on object-oriented architecture

00:33:53,760 --> 00:33:58,559
you know before this there were a few

00:33:57,000 --> 00:34:00,640
object-oriented

00:33:58,559 --> 00:34:02,559
packages in drupal but most of them were

00:34:00,640 --> 00:34:06,640
completely procedural

00:34:02,559 --> 00:34:08,320
and and so that means that um

00:34:06,640 --> 00:34:09,919
everything's in functions it's in all

00:34:08,320 --> 00:34:13,119
kinds of different places

00:34:09,919 --> 00:34:14,320
and uh and so then you have to try and

00:34:13,119 --> 00:34:18,839
trace it through

00:34:14,320 --> 00:34:21,200
um but for example uh uh with

00:34:18,839 --> 00:34:23,599
uh with

00:34:21,200 --> 00:34:25,599
checkout panes all checkout panes

00:34:23,599 --> 00:34:27,119
implement the checkout pane interface

00:34:25,599 --> 00:34:28,960
so if you want to look at all the

00:34:27,119 --> 00:34:31,520
checkout panes that are in commerce

00:34:28,960 --> 00:34:32,480
um if you have an ide integrated

00:34:31,520 --> 00:34:34,480
development environment

00:34:32,480 --> 00:34:36,159
you can say show me all the classes that

00:34:34,480 --> 00:34:39,119
implement checkout pain interface

00:34:36,159 --> 00:34:39,679
sure and then then you can see them all

00:34:39,119 --> 00:34:43,040
um

00:34:39,679 --> 00:34:44,320
so from my from my experience

00:34:43,040 --> 00:34:46,320
i did a little bit with commerce in

00:34:44,320 --> 00:34:48,960
seven but

00:34:46,320 --> 00:34:51,839
this is this is the beauty of drupal 8's

00:34:48,960 --> 00:34:53,679
object-oriented architecture and

00:34:51,839 --> 00:34:56,000
and then also the gift of services and

00:34:53,679 --> 00:34:58,720
dependency injection

00:34:56,000 --> 00:34:59,119
yeah which which id do you use php storm

00:34:58,720 --> 00:35:02,400
or

00:34:59,119 --> 00:35:04,079
yeah i'm a php storm yeah me too i'm i'm

00:35:02,400 --> 00:35:07,839
such a fanboy

00:35:04,079 --> 00:35:07,839
what an amazingly nice product

00:35:08,800 --> 00:35:12,240
and george is pointing out that there

00:35:10,160 --> 00:35:16,079
are a lot of blank pages on

00:35:12,240 --> 00:35:17,440
on drupal commerce's documentation i'm

00:35:16,079 --> 00:35:20,000
sure the commerce guys would love to

00:35:17,440 --> 00:35:20,000
have people

00:35:20,560 --> 00:35:23,920
come and extend

00:35:26,880 --> 00:35:30,640
dale's pointing out that the problem

00:35:29,200 --> 00:35:31,839
with quote just read the code

00:35:30,640 --> 00:35:34,000
because they have a lot of things that

00:35:31,839 --> 00:35:37,040
are defined but how they fit together

00:35:34,000 --> 00:35:40,720
um you know isn't always obvious

00:35:37,040 --> 00:35:43,119
um uh and and that's definitely true

00:35:40,720 --> 00:35:43,760
um and we're now at a place where people

00:35:43,119 --> 00:35:45,200
have

00:35:43,760 --> 00:35:46,400
you know we're almost back in my

00:35:45,200 --> 00:35:47,119
experience the place where we were with

00:35:46,400 --> 00:35:49,119
drupal 8

00:35:47,119 --> 00:35:51,040
or drupal 7 where there's plenty of of

00:35:49,119 --> 00:35:54,160
how to's that people have written

00:35:51,040 --> 00:35:55,760
um but i guess the point i was trying to

00:35:54,160 --> 00:35:58,880
make earlier dale was

00:35:55,760 --> 00:36:00,320
uh i just googled blog posts you know

00:35:58,880 --> 00:36:01,920
five or six years ago when i was trying

00:36:00,320 --> 00:36:03,599
to figure something out um

00:36:01,920 --> 00:36:04,960
now i often go to the code first and

00:36:03,599 --> 00:36:07,280
then i go try to read what people are

00:36:04,960 --> 00:36:07,280
writing

00:36:08,720 --> 00:36:12,000
anybody else uh have a extended question

00:36:11,200 --> 00:36:13,920
they'd like to be

00:36:12,000 --> 00:36:16,400
able to say out loud rather than type in

00:36:13,920 --> 00:36:18,160
the chat um

00:36:16,400 --> 00:36:19,359
someone maybe maybe you could tell say

00:36:18,160 --> 00:36:20,960
how it is that you got down on my

00:36:19,359 --> 00:36:21,200
moderation panel so that i could click

00:36:20,960 --> 00:36:23,359
you

00:36:21,200 --> 00:36:25,680
what did you have to do oh i just hit

00:36:23,359 --> 00:36:30,000
that big red button at the top that says

00:36:25,680 --> 00:36:30,000
share audio and video okay

00:36:34,400 --> 00:36:37,680
but you know maybe maybe if you're an

00:36:36,400 --> 00:36:40,240
introvert it's uh

00:36:37,680 --> 00:36:41,680
pushing that big red buttons a bit scary

00:36:40,240 --> 00:36:45,280
sure

00:36:41,680 --> 00:36:47,520
um so uh so we have a question

00:36:45,280 --> 00:36:47,520
um

00:36:50,960 --> 00:36:54,000
if we make two or more plugins how does

00:36:53,599 --> 00:36:56,079
drupal

00:36:54,000 --> 00:36:59,920
find which one to use i'm going to

00:36:56,079 --> 00:37:04,320
pronounce that nana go with them

00:36:59,920 --> 00:37:04,320
thank you so uh

00:37:04,960 --> 00:37:11,119
it depends upon the situation now

00:37:08,000 --> 00:37:15,839
so for example we were looking at

00:37:11,119 --> 00:37:15,839
drupal commerce and um

00:37:16,320 --> 00:37:19,440
there's usually something in an

00:37:17,680 --> 00:37:20,079
administrative ui in which you're

00:37:19,440 --> 00:37:23,280
choosing

00:37:20,079 --> 00:37:26,560
uh things or setting things up uh

00:37:23,280 --> 00:37:26,560
here for the checkout flow

00:37:27,520 --> 00:37:31,440
they're they're in the checkout flow you

00:37:29,440 --> 00:37:35,040
can choose the order of the steps

00:37:31,440 --> 00:37:38,079
um and when you go to load that checkout

00:37:35,040 --> 00:37:40,880
flow commerce runs a discovery process

00:37:38,079 --> 00:37:42,240
that looks for all of the plug-in the

00:37:40,880 --> 00:37:45,040
commerce

00:37:42,240 --> 00:37:46,320
pane interface plug-ins and it lists

00:37:45,040 --> 00:37:50,160
them all here

00:37:46,320 --> 00:37:51,200
and so then um there we drag and drop

00:37:50,160 --> 00:37:52,160
them into different steps in the

00:37:51,200 --> 00:37:54,640
checkout flow

00:37:52,160 --> 00:37:55,599
and that gets saved as configuration for

00:37:54,640 --> 00:37:59,599
this plugin

00:37:55,599 --> 00:37:59,599
the donation the checkout flow plugin

00:38:02,800 --> 00:38:06,400
and eric points out coming up to the end

00:38:04,720 --> 00:38:09,520
of the time um

00:38:06,400 --> 00:38:13,200
uh once again uh the survey

00:38:09,520 --> 00:38:14,240
uh result the evaluation link was at the

00:38:13,200 --> 00:38:17,760
top

00:38:14,240 --> 00:38:18,640
um and please uh go and fill that out oh

00:38:17,760 --> 00:38:19,440
looks like we have somebody else who's

00:38:18,640 --> 00:38:24,079
got a

00:38:19,440 --> 00:38:25,760
out loud question so adding that person

00:38:24,079 --> 00:38:27,359
yeah and you should guys should look if

00:38:25,760 --> 00:38:27,920
you have your laptop set up separately

00:38:27,359 --> 00:38:32,400
you can

00:38:27,920 --> 00:38:35,520
look at all the drupal pets live

00:38:32,400 --> 00:38:37,839
sorry okay

00:38:35,520 --> 00:38:40,320
i clicked on the click plus there ah

00:38:37,839 --> 00:38:41,680
there we are

00:38:40,320 --> 00:38:44,560
i'm going to drop you off someone so we

00:38:41,680 --> 00:38:44,560
can save some bandwidth

00:38:44,800 --> 00:38:47,839
yes sir

00:39:10,880 --> 00:39:29,839
okay um well um i have one minute

00:39:14,000 --> 00:39:29,839
left anybody else with a question

00:39:30,880 --> 00:39:34,320
welcome glad you all enjoyed it um and

00:39:33,760 --> 00:39:36,640
uh

00:39:34,320 --> 00:39:37,520
feel free to reach out through

00:39:36,640 --> 00:39:39,599
drupal.org

00:39:37,520 --> 00:39:42,480
if you have any questions if you're

00:39:39,599 --> 00:39:44,240
interested in commerce donations

00:39:42,480 --> 00:39:45,520
watch for our module to go live in the

00:39:44,240 --> 00:39:57,839
next day or two and

00:39:45,520 --> 00:39:57,839

YouTube URL: https://www.youtube.com/watch?v=CKrY__6Rf7g


