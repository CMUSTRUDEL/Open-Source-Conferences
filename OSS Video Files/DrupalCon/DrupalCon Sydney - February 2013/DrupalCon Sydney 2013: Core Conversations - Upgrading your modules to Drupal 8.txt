Title: DrupalCon Sydney 2013: Core Conversations - Upgrading your modules to Drupal 8
Publication date: 2013-03-29
Playlist: DrupalCon Sydney - February 2013
Description: 
	This talk, led by webchick, will demonstrate how to take the code from a Drupal 7 module and convert it to Drupal 8. You'll learn about many of the new Drupal core APIs that are coming down the pipe, as well as some "gotchas" to be aware of. The hope is that this talk can be both fun and educational, but also serve as "usability testing" for the Drupal 8 developer experience, since we will still have time to refine APIs before Drupal 8's release (hopefully with *your* help!).
Captions: 
	00:00:00,000 --> 00:00:03,659
welcome everybody I hope that you're in

00:00:02,070 --> 00:00:05,730
here to learn about how to upgrade your

00:00:03,659 --> 00:00:09,120
modules to Drupal 8 if not this is gonna

00:00:05,730 --> 00:00:11,490
be a really boring talk so so about me

00:00:09,120 --> 00:00:14,040
I'm my name is web chick or Angie Byron

00:00:11,490 --> 00:00:16,440
as I'm sometimes known in like law

00:00:14,040 --> 00:00:19,890
offices and stuff I work at aqua in the

00:00:16,440 --> 00:00:21,960
office of the CTO Drees is my boss which

00:00:19,890 --> 00:00:23,789
is really fun i'm a board member to

00:00:21,960 --> 00:00:26,279
drupal association i wrote a book about

00:00:23,789 --> 00:00:27,630
drupal and i'm the engineering manager

00:00:26,279 --> 00:00:29,640
for the spark team who's working on

00:00:27,630 --> 00:00:32,070
making Drupal authoring experience

00:00:29,640 --> 00:00:34,559
awesome and if anybody here knows anyone

00:00:32,070 --> 00:00:36,270
from Brisbane who might think it was

00:00:34,559 --> 00:00:37,920
cool to like work with really high

00:00:36,270 --> 00:00:40,260
profile clients as a client advisory

00:00:37,920 --> 00:00:42,239
please go to our booth outside just

00:00:40,260 --> 00:00:43,469
outside this door because aakhri would

00:00:42,239 --> 00:00:46,649
love to hire you and pay you money for

00:00:43,469 --> 00:00:47,700
that so so our agenda is we're going to

00:00:46,649 --> 00:00:49,649
do a little bit of a walk through

00:00:47,700 --> 00:00:51,329
through the module that reporting will

00:00:49,649 --> 00:00:53,670
cover some basics that sort of apply to

00:00:51,329 --> 00:00:56,910
every type of module will also cover

00:00:53,670 --> 00:00:58,410
some some kind of the main sort of some

00:00:56,910 --> 00:01:00,270
of the main thrust in Drupal 8 as you're

00:00:58,410 --> 00:01:02,430
coming to it from Drupal 7 so there's

00:01:00,270 --> 00:01:04,280
this funny thing called PSR 0 and also

00:01:02,430 --> 00:01:06,900
PHP namespaces which might be new to you

00:01:04,280 --> 00:01:09,119
the configuration system is new in

00:01:06,900 --> 00:01:10,860
Drupal 8 blocks and plugins are also

00:01:09,119 --> 00:01:13,229
very different in Drupal 8 than they

00:01:10,860 --> 00:01:14,939
were in Drupal 7 the router system is

00:01:13,229 --> 00:01:17,310
also very different and then finally

00:01:14,939 --> 00:01:18,420
twig which now that general absence of

00:01:17,310 --> 00:01:19,920
the audience really nervous about but I

00:01:18,420 --> 00:01:21,659
hope that I converted it properly but

00:01:19,920 --> 00:01:24,330
today is a new theme system interpolate

00:01:21,659 --> 00:01:25,950
so lots of new stuff to cover so the

00:01:24,330 --> 00:01:28,200
first thing is that we will not be able

00:01:25,950 --> 00:01:30,060
to port this entire module in an hour

00:01:28,200 --> 00:01:31,770
that's just not going to work but if

00:01:30,060 --> 00:01:33,750
you're the type of person who likes take

00:01:31,770 --> 00:01:36,329
home work home with them this page on

00:01:33,750 --> 00:01:38,130
drupal.org has a list like all my notes

00:01:36,329 --> 00:01:39,630
of every step that I took through the

00:01:38,130 --> 00:01:41,579
whole process and they're also get

00:01:39,630 --> 00:01:43,890
commits for every single step so if you

00:01:41,579 --> 00:01:45,720
wanted to kind of take time and analyze

00:01:43,890 --> 00:01:47,970
how this works on a one-to-one basis

00:01:45,720 --> 00:01:49,350
that's out there for you and I'll make

00:01:47,970 --> 00:01:51,420
sure these slides are up on the on the

00:01:49,350 --> 00:01:54,240
website shortly so you can get that to

00:01:51,420 --> 00:01:55,799
the second disclaimer is that all of

00:01:54,240 --> 00:01:57,420
this stuff is heavily under construction

00:01:55,799 --> 00:02:00,090
so I'm going to tell you something today

00:01:57,420 --> 00:02:02,100
and it's true right now but next week it

00:02:00,090 --> 00:02:03,509
could not be true anymore because that's

00:02:02,100 --> 00:02:05,430
how fast Drupal 8 is changing right now

00:02:03,509 --> 00:02:07,320
but it's still really good particularly

00:02:05,430 --> 00:02:09,090
right now where there's a lot of

00:02:07,320 --> 00:02:11,220
backwards compatibility layers still in

00:02:09,090 --> 00:02:12,840
place to sort of get your feet wet with

00:02:11,220 --> 00:02:13,330
Drupal 8 because there's still time to

00:02:12,840 --> 00:02:15,130
change it

00:02:13,330 --> 00:02:16,810
and you know you can have a lot of

00:02:15,130 --> 00:02:18,850
influence on the direction of jubilee

00:02:16,810 --> 00:02:25,990
stone so the module that we're going to

00:02:18,850 --> 00:02:27,640
port is the pants module whoo pants

00:02:25,990 --> 00:02:29,020
module is actually a blast in the past

00:02:27,640 --> 00:02:31,960
this was a presentation that James

00:02:29,020 --> 00:02:34,960
Walker gave in 2006 so this was a Drupal

00:02:31,960 --> 00:02:37,020
4.7 module that imported a tuple 7 and

00:02:34,960 --> 00:02:39,490
then head to ported again to Drupal 8 so

00:02:37,020 --> 00:02:40,720
it was a bit of a process but it's great

00:02:39,490 --> 00:02:43,000
because this little module has

00:02:40,720 --> 00:02:45,760
everything it's got permissions it has a

00:02:43,000 --> 00:02:46,960
settings page it has form changes that

00:02:45,760 --> 00:02:49,180
goes in there and monkeys around with

00:02:46,960 --> 00:02:51,040
forms it has a user profile change it

00:02:49,180 --> 00:02:52,720
has blocks it has automated tests

00:02:51,040 --> 00:02:54,520
everything that you could need to know

00:02:52,720 --> 00:02:56,020
so it's a really good example module to

00:02:54,520 --> 00:02:58,540
kind of expose you to a lot of the

00:02:56,020 --> 00:03:00,370
different api's in Drupal so let's go

00:02:58,540 --> 00:03:02,650
ahead and see this in action and see how

00:03:00,370 --> 00:03:04,450
it works by the way did you know that

00:03:02,650 --> 00:03:06,459
you can google for literally any now and

00:03:04,450 --> 00:03:08,350
you can think of plus pants and someone

00:03:06,459 --> 00:03:12,870
has done that I mean it's amazing all

00:03:08,350 --> 00:03:16,270
right that was action pants by the way

00:03:12,870 --> 00:03:19,269
all right so I've got a few too many

00:03:16,270 --> 00:03:20,830
windows this is the pants module project

00:03:19,269 --> 00:03:23,739
page by the way so if you want to

00:03:20,830 --> 00:03:25,600
resolution is terrible anyway so if you

00:03:23,739 --> 00:03:27,940
wanted to get to that documentation page

00:03:25,600 --> 00:03:29,680
you can just click read documentation or

00:03:27,940 --> 00:03:33,340
if you go to the repository bueller

00:03:29,680 --> 00:03:34,720
viewer mm-hmm down here this is where I

00:03:33,340 --> 00:03:36,910
have these all broken out in two steps

00:03:34,720 --> 00:03:40,090
so you can start with Drupal 7 you can

00:03:36,910 --> 00:03:42,940
go to date point x 1 dou dou basics twit

00:03:40,090 --> 00:03:45,040
our tests config blocks router twig and

00:03:42,940 --> 00:03:46,600
all the steps along so you know if

00:03:45,040 --> 00:03:49,180
there's anything I like doing its over

00:03:46,600 --> 00:03:50,320
engineering something very much so but

00:03:49,180 --> 00:03:52,690
anyway hopefully it's helpful to

00:03:50,320 --> 00:03:55,480
somebody all right so let's look at our

00:03:52,690 --> 00:03:57,190
Drupal 7 side sporting the non

00:03:55,480 --> 00:04:01,330
responsive toolbar that's always really

00:03:57,190 --> 00:04:02,709
really sweet so we'll just walk through

00:04:01,330 --> 00:04:04,300
the pants model really quick so how the

00:04:02,709 --> 00:04:07,750
pants module works is if you go on your

00:04:04,300 --> 00:04:09,489
User Profile and you click Edit there's

00:04:07,750 --> 00:04:12,910
a little checkbox here to ask you are

00:04:09,489 --> 00:04:14,260
you wearing pants okay and of course I'm

00:04:12,910 --> 00:04:16,330
not wearing pants that's why I'm

00:04:14,260 --> 00:04:18,190
standing behind a podium and so I'm

00:04:16,330 --> 00:04:20,070
going to take that off and then it'll

00:04:18,190 --> 00:04:23,200
tell me my pants status is currently off

00:04:20,070 --> 00:04:25,300
all right I also have a nice little Ajax

00:04:23,200 --> 00:04:26,320
block where i can go 0 and turn it on

00:04:25,300 --> 00:04:28,660
and then i reload

00:04:26,320 --> 00:04:30,340
ode and notes on oh right that I'd even

00:04:28,660 --> 00:04:34,240
show you yet this is cool so if you go

00:04:30,340 --> 00:04:36,730
to configuration pants you can specify

00:04:34,240 --> 00:04:39,580
what pants type so there's MC Hammer

00:04:36,730 --> 00:04:41,740
pants yeah yeah okay Liz stupid and then

00:04:39,580 --> 00:04:43,270
this pants api key doesn't actually do

00:04:41,740 --> 00:04:45,160
anything but i need an example for later

00:04:43,270 --> 00:04:48,400
but say you were integrating with the

00:04:45,160 --> 00:04:49,680
pants api which i'm sure someone will

00:04:48,400 --> 00:04:51,970
invent by the end of this presentation

00:04:49,680 --> 00:04:55,240
then you could use that so if i choose

00:04:51,970 --> 00:04:58,420
NC hammer pants now i have awesome gold

00:04:55,240 --> 00:05:00,100
i'm seeking pants so this module is

00:04:58,420 --> 00:05:01,930
great and then there's a recent pants

00:05:00,100 --> 00:05:04,450
block that tells me all the times i turn

00:05:01,930 --> 00:05:06,520
off took off and on my pants okay so

00:05:04,450 --> 00:05:08,560
it's kind of a dumb little thing but

00:05:06,520 --> 00:05:11,020
it's a lot of fun and so the other thing

00:05:08,560 --> 00:05:13,060
that it has is automated tests how many

00:05:11,020 --> 00:05:15,730
people have written automated tests

00:05:13,060 --> 00:05:17,710
before oh good it's a really good idea

00:05:15,730 --> 00:05:19,630
actually to write automated tests before

00:05:17,710 --> 00:05:20,980
you start porting stuff because it's a

00:05:19,630 --> 00:05:24,790
really great way to tell if you've

00:05:20,980 --> 00:05:27,340
actually done it yet or not so so i'm

00:05:24,790 --> 00:05:29,620
going to run the pants tests I of course

00:05:27,340 --> 00:05:32,350
have two different versions crud on your

00:05:29,620 --> 00:05:36,130
pants and you I on your pants so I split

00:05:32,350 --> 00:05:39,370
them into two so you run those just let

00:05:36,130 --> 00:05:40,750
that go for a while so I'm assuming if

00:05:39,370 --> 00:05:43,170
you're in this room you are a module

00:05:40,750 --> 00:05:45,880
developer can I get a show of hands for

00:05:43,170 --> 00:05:47,740
okay great because I can't really spend

00:05:45,880 --> 00:05:49,210
time explaining what hook menu is and

00:05:47,740 --> 00:05:51,100
things like that but we'll cover through

00:05:49,210 --> 00:05:52,330
a lot of this stuff pretty quickly but

00:05:51,100 --> 00:05:55,000
anyway so the automated tests are

00:05:52,330 --> 00:06:00,060
running a lot that that the tub and then

00:05:55,000 --> 00:06:06,640
finally eventually someday hopefully

00:06:00,060 --> 00:06:09,130
it'll say dude seriously so one thing

00:06:06,640 --> 00:06:10,660
that's cool is in Drupal 8 we have a

00:06:09,130 --> 00:06:12,700
testing profile which makes this all

00:06:10,660 --> 00:06:15,280
much much faster so there we go Saudi

00:06:12,700 --> 00:06:18,310
excuse me 35 passes 0 fails your

00:06:15,280 --> 00:06:21,520
exceptions wonderful so this is our

00:06:18,310 --> 00:06:24,010
lovely working Drupal 7 module so let's

00:06:21,520 --> 00:06:28,720
go ahead and look at how we would do

00:06:24,010 --> 00:06:31,300
this in Drupal 8 so the basics underwear

00:06:28,720 --> 00:06:32,620
pants okay first you grab a copy of

00:06:31,300 --> 00:06:35,140
Drupal 8 you're going to want to do that

00:06:32,620 --> 00:06:36,190
from get because we change it 50 times a

00:06:35,140 --> 00:06:39,010
day and you're going to want to always

00:06:36,190 --> 00:06:40,240
be on the latest version you want to

00:06:39,010 --> 00:06:44,080
copy the module

00:06:40,240 --> 00:06:45,970
so uh in drupal 7 and below you know how

00:06:44,080 --> 00:06:47,229
we had that thing was like if you're

00:06:45,970 --> 00:06:49,300
going to put your module somebody put in

00:06:47,229 --> 00:06:50,949
sites all modules because only an idiot

00:06:49,300 --> 00:06:52,000
puts things in the core modules you

00:06:50,949 --> 00:06:53,830
reckon because that would just be stupid

00:06:52,000 --> 00:06:57,190
right and you like mock people who don't

00:06:53,830 --> 00:06:59,169
do that right so in Drupal 8 we created

00:06:57,190 --> 00:07:01,389
a core directory where the core modules

00:06:59,169 --> 00:07:02,710
go and now you actually do put your

00:07:01,389 --> 00:07:05,740
modules in the root modules directory

00:07:02,710 --> 00:07:07,270
wah wah so it's the exact opposite of

00:07:05,740 --> 00:07:09,430
what you're used to basically but hey

00:07:07,270 --> 00:07:10,810
the drop is always moving um but this is

00:07:09,430 --> 00:07:13,060
actually kind of a nice change because

00:07:10,810 --> 00:07:14,680
people wanted to do that anyway so now

00:07:13,060 --> 00:07:15,789
it's just sort of natural in terms of

00:07:14,680 --> 00:07:17,199
what people are going to do anyway so

00:07:15,789 --> 00:07:21,159
you take your module and you stick it in

00:07:17,199 --> 00:07:23,590
the modules directory for Drupal 8 then

00:07:21,159 --> 00:07:26,770
the next thing you do is you change the

00:07:23,590 --> 00:07:28,930
core version so on the info file there's

00:07:26,770 --> 00:07:30,220
a core equals 7x you just switch that to

00:07:28,930 --> 00:07:32,409
an eight that X and until you do that

00:07:30,220 --> 00:07:34,990
you get this little X that won't let you

00:07:32,409 --> 00:07:36,940
turn the module on and then you turn it

00:07:34,990 --> 00:07:42,370
on and see what happens I lied I do have

00:07:36,940 --> 00:07:44,320
a cat yeah a cat and then you find your

00:07:42,370 --> 00:07:45,639
errors you search for them and then you

00:07:44,320 --> 00:07:47,199
repeat over and over and over again

00:07:45,639 --> 00:07:50,259
until your modules working that's pretty

00:07:47,199 --> 00:07:52,810
much it this page is amazing drupal.org

00:07:50,259 --> 00:07:54,909
/ list hyphen changes this is where

00:07:52,810 --> 00:07:57,250
every single time we make an API change

00:07:54,909 --> 00:07:58,960
in Drupal we create a critical task that

00:07:57,250 --> 00:08:01,270
people have to fix to make sure that

00:07:58,960 --> 00:08:02,710
it's document in this list and you know

00:08:01,270 --> 00:08:04,240
I went through this whole thing with all

00:08:02,710 --> 00:08:06,099
these different api's and on Sammy I

00:08:04,240 --> 00:08:07,630
think I may be made three pages that

00:08:06,099 --> 00:08:08,770
weren't in here and there was like 50 of

00:08:07,630 --> 00:08:11,469
them that were so that was actually

00:08:08,770 --> 00:08:12,639
really really cool so yeah so we'll go

00:08:11,469 --> 00:08:15,250
ahead and walk through that and see that

00:08:12,639 --> 00:08:16,960
oh by the way if you get stuck like for

00:08:15,250 --> 00:08:19,479
example drupal's barfing out horrible

00:08:16,960 --> 00:08:22,210
errors at you probably what happened is

00:08:19,479 --> 00:08:23,969
we change the api's on you so you need

00:08:22,210 --> 00:08:25,960
to just reinstall your site from scratch

00:08:23,969 --> 00:08:29,229
because we don't have an upgrade path

00:08:25,960 --> 00:08:30,610
yet sorry and when you do that there's a

00:08:29,229 --> 00:08:32,560
special thing you have to do in Drupal 8

00:08:30,610 --> 00:08:34,270
which is you have to not only you know

00:08:32,560 --> 00:08:36,130
get rid of your settings that PHP that's

00:08:34,270 --> 00:08:37,959
normal but you also need to remove

00:08:36,130 --> 00:08:40,240
everything under your files directory

00:08:37,959 --> 00:08:43,209
because in Drupal 8 the files directory

00:08:40,240 --> 00:08:46,120
contains both a symphony compiled PHP

00:08:43,209 --> 00:08:49,870
thinger thing mer I don't know ask Larry

00:08:46,120 --> 00:08:51,220
Garfield and the configuration files for

00:08:49,870 --> 00:08:52,540
your site and if you keep those around

00:08:51,220 --> 00:08:53,370
they can get stale and can cause

00:08:52,540 --> 00:08:56,050
problems

00:08:53,370 --> 00:08:58,660
you'll do this a lot by the way all

00:08:56,050 --> 00:09:01,270
right so let's go ahead and see this in

00:08:58,660 --> 00:09:06,190
action so let's go over to our

00:09:01,270 --> 00:09:09,070
handy-dandy command line whoop all right

00:09:06,190 --> 00:09:14,200
where am i right so I'm going to go to

00:09:09,070 --> 00:09:17,530
my sights pants aight folder are yall

00:09:14,200 --> 00:09:21,300
command-line savvy I'm hearing nods I'm

00:09:17,530 --> 00:09:24,160
hearing nods I'm very tired okay um

00:09:21,300 --> 00:09:27,010
alright so we're going to go into our

00:09:24,160 --> 00:09:29,740
modules directory our pants directory

00:09:27,010 --> 00:09:30,760
and here's just the Drupal 7 version of

00:09:29,740 --> 00:09:32,700
our module so you can see there's a

00:09:30,760 --> 00:09:36,910
pants that info a passed-out install

00:09:32,700 --> 00:09:40,120
JavaScript module tests etc so let's

00:09:36,910 --> 00:09:47,440
start actually by seeing what happens if

00:09:40,120 --> 00:09:48,940
we go on our Drupal 8 site by the way

00:09:47,440 --> 00:09:52,870
this is the new responsive swishy

00:09:48,940 --> 00:09:55,720
toolbar oh it goes like this and it's

00:09:52,870 --> 00:09:58,930
all fancy with the icons okay sorry we

00:09:55,720 --> 00:10:01,450
worked really hard on that and so right

00:09:58,930 --> 00:10:03,720
so let's go to extend by the way that's

00:10:01,450 --> 00:10:07,600
what we rename the modules page much to

00:10:03,720 --> 00:10:08,650
that was a little contentious um but

00:10:07,600 --> 00:10:10,090
people couldn't figure out what modules

00:10:08,650 --> 00:10:11,530
were so you know whatever so right now

00:10:10,090 --> 00:10:13,540
it's telling me you can't turn the

00:10:11,530 --> 00:10:15,250
module on bozo because you just put a 7

00:10:13,540 --> 00:10:17,170
module in your Drupal 8 side how stupid

00:10:15,250 --> 00:10:19,780
are you and I say very stupid but I'll

00:10:17,170 --> 00:10:22,600
show you alright so i go into pants info

00:10:19,780 --> 00:10:25,630
and i just do what the presentation said

00:10:22,600 --> 00:10:27,730
which i turn this 28 ok everybody got

00:10:25,630 --> 00:10:31,170
that so core equals 7 now its core

00:10:27,730 --> 00:10:35,740
equals 8 and then just like that the

00:10:31,170 --> 00:10:37,660
magic of text editing tada there's a

00:10:35,740 --> 00:10:41,430
checkbox now what do you think is going

00:10:37,660 --> 00:10:49,960
to happen when I do this hammer pants

00:10:41,430 --> 00:10:58,630
maybe not yet widescreen yeah check this

00:10:49,960 --> 00:11:01,540
out nothing happened it worked we're

00:10:58,630 --> 00:11:03,370
done yeah okay maybe not do it okay so

00:11:01,540 --> 00:11:04,930
um so that's great it didn't blow up

00:11:03,370 --> 00:11:07,030
usually it does blow up so that was a

00:11:04,930 --> 00:11:09,100
really good guess but I did it this time

00:11:07,030 --> 00:11:10,720
that's that's awesome and in fact

00:11:09,100 --> 00:11:12,550
there's actually surprising amount of

00:11:10,720 --> 00:11:14,770
this module that works even right now so

00:11:12,550 --> 00:11:19,300
if I like go under the say if I go under

00:11:14,770 --> 00:11:24,430
the permissions page um you know I

00:11:19,300 --> 00:11:26,530
scroll down to my pants that could be

00:11:24,430 --> 00:11:29,890
taken out of context so badly all right

00:11:26,530 --> 00:11:31,630
so pants i still have my you know i

00:11:29,890 --> 00:11:34,240
still have my permissions that's pretty

00:11:31,630 --> 00:11:37,930
cool you know if i go to my

00:11:34,240 --> 00:11:40,270
configuration page this is temporary by

00:11:37,930 --> 00:11:43,000
the way but i see that my administration

00:11:40,270 --> 00:11:44,650
page is still there with my form so

00:11:43,000 --> 00:11:47,100
there is some stuff in Drupal 8 that

00:11:44,650 --> 00:11:50,110
didn't change there's a couple of things

00:11:47,100 --> 00:11:52,120
the form API stay the same the database

00:11:50,110 --> 00:11:53,680
API stay the same the permissions API

00:11:52,120 --> 00:11:54,940
stay the same a lot of this stuff so

00:11:53,680 --> 00:11:57,280
it's not like you have to rewrite your

00:11:54,940 --> 00:11:58,390
entire module from scratch but the real

00:11:57,280 --> 00:11:59,590
are a lot of changes that you have to

00:11:58,390 --> 00:12:01,780
make so we'll start we'll start walking

00:11:59,590 --> 00:12:03,760
to us all right so then you're like yeah

00:12:01,780 --> 00:12:05,290
but that wasn't what the module actually

00:12:03,760 --> 00:12:06,970
did what the module actually did is it

00:12:05,290 --> 00:12:08,200
like lets you go in your User Profile

00:12:06,970 --> 00:12:09,880
and do some stuff so let's go ahead and

00:12:08,200 --> 00:12:13,690
you know check that out so I'm going to

00:12:09,880 --> 00:12:15,550
go to my profile and close that so I get

00:12:13,690 --> 00:12:18,610
this weird off just in the middle of the

00:12:15,550 --> 00:12:21,010
page somewhere that's a little odd so it

00:12:18,610 --> 00:12:23,140
looks like it's missing the label for my

00:12:21,010 --> 00:12:24,400
pants status okay so that's kind of a

00:12:23,140 --> 00:12:27,160
first indication something might be up

00:12:24,400 --> 00:12:31,840
here so let's go into the module code

00:12:27,160 --> 00:12:34,840
and I'm going to spoiler alert that

00:12:31,840 --> 00:12:36,880
happens in a hook user view so there's

00:12:34,840 --> 00:12:38,410
this thing you know like this renderable

00:12:36,880 --> 00:12:40,120
array or whatever that's like okay

00:12:38,410 --> 00:12:42,850
you've got a content of pants it's a

00:12:40,120 --> 00:12:44,140
user profile item pants that is and then

00:12:42,850 --> 00:12:46,150
you theme your pants data so those pants

00:12:44,140 --> 00:12:48,220
status is ending up there okay but

00:12:46,150 --> 00:12:50,500
what's not ending up there okay is the

00:12:48,220 --> 00:12:52,240
actual title so what I might start doing

00:12:50,500 --> 00:12:53,590
is I might start going well hmm I wonder

00:12:52,240 --> 00:12:56,380
what's going on here so I might I might

00:12:53,590 --> 00:12:58,510
start looking for hook user view that

00:12:56,380 --> 00:13:07,080
might be a good thing to do so go over

00:12:58,510 --> 00:13:07,080
to what's that oh really sorry

00:13:11,460 --> 00:13:18,100
mm-hmm well that's all fancy you know

00:13:15,610 --> 00:13:21,310
I'm just a simple gal but yes okay fair

00:13:18,100 --> 00:13:23,740
enough so mostly the render API

00:13:21,310 --> 00:13:25,750
maintainer has informed me that my pants

00:13:23,740 --> 00:13:27,459
status is due sheet and I should not be

00:13:25,750 --> 00:13:29,680
doing pound mark up at all and I should

00:13:27,459 --> 00:13:32,740
be doing a render bol rahe there so bear

00:13:29,680 --> 00:13:34,600
that in mind but in the meantime I

00:13:32,740 --> 00:13:36,730
search for hook user view and I got a

00:13:34,600 --> 00:13:39,580
couple of things one is that type user

00:13:36,730 --> 00:13:41,500
profile item is now type item so that

00:13:39,580 --> 00:13:43,060
would do it right if I'm using a type

00:13:41,500 --> 00:13:48,750
that no longer exists that might cause a

00:13:43,060 --> 00:13:52,270
problem so let me try oh I lost my place

00:13:48,750 --> 00:13:55,510
so let me try leading that and replacing

00:13:52,270 --> 00:13:58,660
it with that and see what happens okay

00:13:55,510 --> 00:14:01,779
so just a little one line change let's

00:13:58,660 --> 00:14:05,010
go back to here reload wow we have a

00:14:01,779 --> 00:14:08,080
label now parting and Drupal 8 is easy

00:14:05,010 --> 00:14:10,270
okay so cool now let's take a look at

00:14:08,080 --> 00:14:12,670
our form so we're gonna edit that oh god

00:14:10,270 --> 00:14:14,890
errors jeez what is that all right so

00:14:12,670 --> 00:14:16,570
undefined index user category blah blah

00:14:14,890 --> 00:14:18,310
blah alright so the first thing I might

00:14:16,570 --> 00:14:20,500
do is say what the heck is user category

00:14:18,310 --> 00:14:22,060
so I go back to that magical Drupal

00:14:20,500 --> 00:14:23,950
adore glist changes page that I

00:14:22,060 --> 00:14:27,670
mentioned now I'm going to search for

00:14:23,950 --> 00:14:29,410
use your category and it says the

00:14:27,670 --> 00:14:32,860
category system is removed from user

00:14:29,410 --> 00:14:34,510
edit and view so i click that and it has

00:14:32,860 --> 00:14:36,279
a nice light couple of examples so in

00:14:34,510 --> 00:14:38,800
Drupal 7 you know you might have this

00:14:36,279 --> 00:14:40,570
you know form alter that would check up

00:14:38,800 --> 00:14:43,720
a forum user categories account and blah

00:14:40,570 --> 00:14:45,790
blah blah but instead it's saying oh you

00:14:43,720 --> 00:14:47,920
know like don't do that just take it out

00:14:45,790 --> 00:14:49,510
altogether so that we used to do if

00:14:47,920 --> 00:14:52,000
forum user categories account because

00:14:49,510 --> 00:14:53,620
the user profile forms used to be like

00:14:52,000 --> 00:14:55,060
there was a main profile form and then a

00:14:53,620 --> 00:14:57,220
bunch of other sub form so it's very

00:14:55,060 --> 00:15:00,209
silly I think most did you were you one

00:14:57,220 --> 00:15:03,790
who got rid of that yeah good job so now

00:15:00,209 --> 00:15:04,959
so now it's way easier um and if all

00:15:03,790 --> 00:15:07,180
these changed on us are really cool

00:15:04,959 --> 00:15:08,860
because it'll it'll link you back to the

00:15:07,180 --> 00:15:10,360
description so if you want to read the

00:15:08,860 --> 00:15:11,890
whole discussion that happened like why

00:15:10,360 --> 00:15:13,510
did they remove the user category system

00:15:11,890 --> 00:15:15,640
that was pretty great they'll give you

00:15:13,510 --> 00:15:16,930
all the reasons for that if you have a

00:15:15,640 --> 00:15:20,050
lot of time on your hands and want to

00:15:16,930 --> 00:15:27,850
learn a lot so so I'm going to

00:15:20,050 --> 00:15:31,240
um see where is that user what that's

00:15:27,850 --> 00:15:35,860
not going to work Thanks so I'm going to

00:15:31,240 --> 00:15:37,240
look for user category all right and I'm

00:15:35,860 --> 00:15:39,160
just going to basically take out any

00:15:37,240 --> 00:15:42,010
whoa not that bad but I'm going to take

00:15:39,160 --> 00:15:44,079
out any reference to that user category

00:15:42,010 --> 00:15:47,680
thing so now this just becomes if user

00:15:44,079 --> 00:15:48,430
access is pants or whatever I'm not

00:15:47,680 --> 00:15:49,660
going to do this for the whole

00:15:48,430 --> 00:15:50,890
presentation but at the beginning I

00:15:49,660 --> 00:15:53,200
think it's important so that you can

00:15:50,890 --> 00:15:55,089
kind of see how this iterates all right

00:15:53,200 --> 00:15:56,230
so I did that I'm going to reload by the

00:15:55,089 --> 00:15:58,120
way what does the form look like right

00:15:56,230 --> 00:15:59,740
now basically it doesn't look like

00:15:58,120 --> 00:16:04,779
anything our pants thing is completely

00:15:59,740 --> 00:16:08,200
not here so if I reload now I see my

00:16:04,779 --> 00:16:10,089
pants things showing up great hello it

00:16:08,200 --> 00:16:11,829
looks a little funny like see how these

00:16:10,089 --> 00:16:13,660
all have little drop-down thingies and

00:16:11,829 --> 00:16:16,480
this one doesn't that's a little weird

00:16:13,660 --> 00:16:18,220
so what I might say is oh that's odd why

00:16:16,480 --> 00:16:21,459
did my field set end up like that so I'd

00:16:18,220 --> 00:16:24,130
search for a field side and then I would

00:16:21,459 --> 00:16:25,810
see oh all collapse will field sets have

00:16:24,130 --> 00:16:27,700
been replaced with the html5 details

00:16:25,810 --> 00:16:30,100
elements so this was another initiative

00:16:27,700 --> 00:16:31,660
in Drupal 8 was the html5 initiative

00:16:30,100 --> 00:16:34,060
which introduced all these new crazy

00:16:31,660 --> 00:16:36,190
HTML functions so we have I don't know

00:16:34,060 --> 00:16:37,810
we've all kinds of things we have great

00:16:36,190 --> 00:16:40,540
like not rated ones we have like email

00:16:37,810 --> 00:16:43,240
fields and number fields and crazy stuff

00:16:40,540 --> 00:16:47,230
like that so basically all i have to do

00:16:43,240 --> 00:16:52,170
here is change it from a field set to a

00:16:47,230 --> 00:16:52,170
details so let me do that real quick

00:16:52,290 --> 00:16:57,970
fieldset but you notice everything else

00:16:56,560 --> 00:16:59,920
about hook for melter is working fine

00:16:57,970 --> 00:17:02,529
like it found the form it replaced the

00:16:59,920 --> 00:17:08,140
thing it's it's all fine so it's not too

00:17:02,529 --> 00:17:10,360
bad not yet anyway all right there we go

00:17:08,140 --> 00:17:12,579
now it's all swishy and Spanky and

00:17:10,360 --> 00:17:14,319
lovely so I'm gonna say yes i am wearing

00:17:12,579 --> 00:17:18,699
pants and let's save that and see what

00:17:14,319 --> 00:17:20,709
happens Oh more errors so now that's

00:17:18,699 --> 00:17:22,329
saying parameter 12 pants for user pre

00:17:20,709 --> 00:17:23,470
save expected to be a reference blah

00:17:22,329 --> 00:17:25,929
blah blah okay I don't know what that

00:17:23,470 --> 00:17:30,220
means but I know what that is so I'm

00:17:25,929 --> 00:17:32,049
going to search for this pants use your

00:17:30,220 --> 00:17:37,389
pre save

00:17:32,049 --> 00:17:40,600
oh crap oh no that's not gonna work how

00:17:37,389 --> 00:17:43,299
would be cool if that word um hokies

00:17:40,600 --> 00:17:45,450
your pre save its linking me again to

00:17:43,299 --> 00:17:48,820
that thing that I oh wait no this one

00:17:45,450 --> 00:17:50,559
the Edit argument was removed from hook

00:17:48,820 --> 00:17:52,929
user update and such and such and such

00:17:50,559 --> 00:17:55,239
so hook user pre save use did you edit

00:17:52,929 --> 00:17:57,100
account category and now it just does

00:17:55,239 --> 00:18:00,129
account so this is another fallout from

00:17:57,100 --> 00:18:06,419
the removing the user category system so

00:18:00,129 --> 00:18:10,570
okay let's look for edit under pre save

00:18:06,419 --> 00:18:11,950
so what I'm going to do here and again I

00:18:10,570 --> 00:18:13,330
encourage you to look at all these pages

00:18:11,950 --> 00:18:14,529
in more depth I'm just trying to make

00:18:13,330 --> 00:18:16,899
sure we can get through our agenda today

00:18:14,529 --> 00:18:22,059
oops there's all my private email okay

00:18:16,899 --> 00:18:24,249
um I'm gonna remove my edits and it's

00:18:22,059 --> 00:18:27,879
recorded someone can still screen that

00:18:24,249 --> 00:18:32,019
um alright don't get any bright ideas

00:18:27,879 --> 00:18:33,970
people all right so um so I'm just going

00:18:32,019 --> 00:18:35,139
to take account in there but then the

00:18:33,970 --> 00:18:36,820
problem I have is that i'm still

00:18:35,139 --> 00:18:39,070
referring to things in edit which is

00:18:36,820 --> 00:18:44,200
gone now so these just end up changing

00:18:39,070 --> 00:18:45,580
to properties on the object and I

00:18:44,200 --> 00:18:46,960
believe that's in that page somewhere or

00:18:45,580 --> 00:18:48,129
else i bringed around with it long

00:18:46,960 --> 00:18:53,919
enough that i figured this out but

00:18:48,129 --> 00:18:56,379
anyway so you do this looks good should

00:18:53,919 --> 00:19:02,289
we try it and see what happens don don

00:18:56,379 --> 00:19:06,460
don alright let's go back here and turn

00:19:02,289 --> 00:19:08,950
my pants on save oh that looks promising

00:19:06,460 --> 00:19:14,859
should we see if it worked so I should

00:19:08,950 --> 00:19:16,330
have my pants on and I do yay and let's

00:19:14,859 --> 00:19:17,859
ride let's make sure I can turn them off

00:19:16,330 --> 00:19:20,379
again because of course we love having

00:19:17,859 --> 00:19:23,280
your pants off more than they are on yay

00:19:20,379 --> 00:19:30,780
it's working yay

00:19:23,280 --> 00:19:33,720
oh that was a great session huh all

00:19:30,780 --> 00:19:35,460
right so you know feeling pretty good

00:19:33,720 --> 00:19:37,740
right getting the hang of this it's

00:19:35,460 --> 00:19:40,050
tedious but it's like you go around you

00:19:37,740 --> 00:19:43,140
find an error yet Google or Google you

00:19:40,050 --> 00:19:44,580
list changes for it and you find the

00:19:43,140 --> 00:19:46,080
thing you read up on what the change was

00:19:44,580 --> 00:19:47,910
and why it happened and then you use the

00:19:46,080 --> 00:19:49,800
code examples to change the code it's

00:19:47,910 --> 00:19:52,350
pretty straightforward but don't worry

00:19:49,800 --> 00:19:54,090
it's about to get a lot worse those are

00:19:52,350 --> 00:19:59,010
worst pants by the way that's the google

00:19:54,090 --> 00:20:02,130
turn all right yeah it's it's pretty

00:19:59,010 --> 00:20:03,960
terrible all right so so one problem

00:20:02,130 --> 00:20:06,210
that we have is our tests aren't showing

00:20:03,960 --> 00:20:07,680
up like if I went to if I were to turn

00:20:06,210 --> 00:20:09,390
on the testing module and go to the

00:20:07,680 --> 00:20:11,310
testing page I wouldn't actually see

00:20:09,390 --> 00:20:15,120
pants I can just do that I don't have to

00:20:11,310 --> 00:20:17,490
tell you about it so if i go here and i

00:20:15,120 --> 00:20:23,600
go to extend drew prefer when I turn on

00:20:17,490 --> 00:20:23,600
the testing module and save it

00:20:27,550 --> 00:20:34,850
there we go um if I go under

00:20:30,950 --> 00:20:38,630
configuration development testing and

00:20:34,850 --> 00:20:40,460
what I'm going to find is that nowhere

00:20:38,630 --> 00:20:42,290
in my list of alphabetical things is

00:20:40,460 --> 00:20:45,290
pants it goes right from pager to

00:20:42,290 --> 00:20:46,730
parameter and so it's not fun of my

00:20:45,290 --> 00:20:50,420
classes for some reason so something's

00:20:46,730 --> 00:20:51,920
up so let's talk about that so when the

00:20:50,420 --> 00:20:53,900
olden days in Drupal 7 we had a class

00:20:51,920 --> 00:20:56,690
loader that was like this right you'd

00:20:53,900 --> 00:20:58,550
have your example duck test you know and

00:20:56,690 --> 00:21:00,650
then you might have a few different you

00:20:58,550 --> 00:21:02,390
know classes in there and that would

00:21:00,650 --> 00:21:03,230
just be right in the base of your module

00:21:02,390 --> 00:21:04,640
directory you can put in another

00:21:03,230 --> 00:21:07,130
directory whatever you wanted to do and

00:21:04,640 --> 00:21:09,650
then you would also have this info file

00:21:07,130 --> 00:21:12,080
where you'd add a little files entry to

00:21:09,650 --> 00:21:14,180
example that test people familiar with

00:21:12,080 --> 00:21:16,970
this construct it's called the registry

00:21:14,180 --> 00:21:18,890
in Drupal 7 so the problem with this is

00:21:16,970 --> 00:21:20,810
it's a journalism right you don't do

00:21:18,890 --> 00:21:22,790
that in any other software that you've

00:21:20,810 --> 00:21:24,770
ever used in your entire life probably

00:21:22,790 --> 00:21:29,900
it was very chicks invented that it was

00:21:24,770 --> 00:21:31,310
very unique um unique so in the rest of

00:21:29,900 --> 00:21:34,070
the PHP world they use this construct

00:21:31,310 --> 00:21:35,120
called PSR 0 so PS r0 is basically an

00:21:34,070 --> 00:21:39,680
auto loading standard that was developed

00:21:35,120 --> 00:21:41,780
by the PHP framework interoperability I

00:21:39,680 --> 00:21:43,520
can't say that word group which

00:21:41,780 --> 00:21:44,960
basically takes PHP people from all over

00:21:43,520 --> 00:21:46,370
different projects and brings them

00:21:44,960 --> 00:21:47,840
together and tries to decide on

00:21:46,370 --> 00:21:50,330
standards that would allow for better

00:21:47,840 --> 00:21:52,790
reuse between projects great idea

00:21:50,330 --> 00:21:55,190
horrible execution sometimes but you

00:21:52,790 --> 00:21:57,110
know whatever so this particular

00:21:55,190 --> 00:21:59,270
standard PSR 0 is the autoloading

00:21:57,110 --> 00:22:01,190
standard so they basically developed a

00:21:59,270 --> 00:22:02,960
standard way of structuring your

00:22:01,190 --> 00:22:04,490
directories and file names and things

00:22:02,960 --> 00:22:05,990
like that so that you can develop these

00:22:04,490 --> 00:22:09,020
autoloaders that work seamlessly between

00:22:05,990 --> 00:22:10,790
projects so it's a good idea here's what

00:22:09,020 --> 00:22:13,190
it looks like in practice so you know

00:22:10,790 --> 00:22:16,910
you have your modules example ready for

00:22:13,190 --> 00:22:18,830
this poem and then you have a lib Drupal

00:22:16,910 --> 00:22:21,080
example tests and then you have to split

00:22:18,830 --> 00:22:22,910
your two tests out into two separate

00:22:21,080 --> 00:22:25,430
files because every single class can

00:22:22,910 --> 00:22:30,200
only have one or every single file

00:22:25,430 --> 00:22:32,420
coming of a class in it but you don't

00:22:30,200 --> 00:22:34,760
have an info file so yay what's probably

00:22:32,420 --> 00:22:36,440
found elsewhere so this really screwed

00:22:34,760 --> 00:22:38,210
me up the first time and I was doing but

00:22:36,440 --> 00:22:39,650
there's a lot of things that get stored

00:22:38,210 --> 00:22:40,250
into this directory so it's a good thing

00:22:39,650 --> 00:22:42,020
to know

00:22:40,250 --> 00:22:43,640
so the naming convention is live and

00:22:42,020 --> 00:22:45,860
then Drupal because that's the name of

00:22:43,640 --> 00:22:48,020
our application and then your module

00:22:45,860 --> 00:22:50,300
name lower case like your module is and

00:22:48,020 --> 00:22:54,020
then whatever after that and there is

00:22:50,300 --> 00:22:56,180
different types of PSR classes I'll

00:22:54,020 --> 00:23:00,260
getting on that in a second so there oh

00:22:56,180 --> 00:23:03,620
I don't want to do that slugging there's

00:23:00,260 --> 00:23:05,540
different types of classes plugins tests

00:23:03,620 --> 00:23:06,530
lots of different things go in there and

00:23:05,540 --> 00:23:08,750
we'll get into a few of them in this

00:23:06,530 --> 00:23:11,570
presentation so then namespaces is

00:23:08,750 --> 00:23:13,580
another thing which is a PHP 5.3

00:23:11,570 --> 00:23:15,290
features so what this is trying to do is

00:23:13,580 --> 00:23:16,940
like by default everything in PHP is in

00:23:15,290 --> 00:23:19,550
the global namespace what that means you

00:23:16,940 --> 00:23:21,170
do find a function anywhere you can't

00:23:19,550 --> 00:23:23,000
ever define another function named the

00:23:21,170 --> 00:23:25,580
same or you blow up with fatal errors

00:23:23,000 --> 00:23:28,130
anybody ever done that already defined

00:23:25,580 --> 00:23:30,080
yeah I do that on a minute Lee basis in

00:23:28,130 --> 00:23:32,750
PHP it seems like so what namespaces let

00:23:30,080 --> 00:23:34,460
you do is they say this file is only in

00:23:32,750 --> 00:23:35,840
this particular context so it's very

00:23:34,460 --> 00:23:38,570
similar to what other languages do we

00:23:35,840 --> 00:23:40,910
have to import like say the Python math

00:23:38,570 --> 00:23:42,650
libraries before you actually use the

00:23:40,910 --> 00:23:44,030
math libraries so that way you can name

00:23:42,650 --> 00:23:45,230
a function called add in your

00:23:44,030 --> 00:23:48,500
application doesn't blow up with

00:23:45,230 --> 00:23:50,360
something else but the disadvantages is

00:23:48,500 --> 00:23:52,010
a little bit weird in terms of what you

00:23:50,360 --> 00:23:54,500
have to do so you have to put at the top

00:23:52,010 --> 00:23:56,300
of your file any dependencies that you

00:23:54,500 --> 00:23:58,580
have on anything that's object-oriented

00:23:56,300 --> 00:24:00,320
in Drupal so here are some examples if

00:23:58,580 --> 00:24:02,450
you're calling any kind of specific

00:24:00,320 --> 00:24:04,070
library in Drupal like the cash system

00:24:02,450 --> 00:24:05,600
or the database system you have to put a

00:24:04,070 --> 00:24:07,040
little used statement at the top to

00:24:05,600 --> 00:24:09,290
point to it if you're dealing with

00:24:07,040 --> 00:24:11,480
entities if you're dealing with blocks

00:24:09,290 --> 00:24:14,120
if you're dealing with different types

00:24:11,480 --> 00:24:16,640
of components you know like the testing

00:24:14,120 --> 00:24:18,590
stuff components libraries all these

00:24:16,640 --> 00:24:20,120
kinds of things more and more Drupal 8

00:24:18,590 --> 00:24:21,740
is heading in a very object-oriented

00:24:20,120 --> 00:24:23,180
direction which is a good news for a lot

00:24:21,740 --> 00:24:25,840
of people but it's also a big adjustment

00:24:23,180 --> 00:24:27,890
if you're very used to be drupal 7 works

00:24:25,840 --> 00:24:29,210
so let's see what that looks like in

00:24:27,890 --> 00:24:31,850
action and this one I'm not going to do

00:24:29,210 --> 00:24:34,130
step by step but I'm going to cheat I'll

00:24:31,850 --> 00:24:36,590
show you how you can cheat at home so if

00:24:34,130 --> 00:24:37,880
you do a git branch you can see a list

00:24:36,590 --> 00:24:40,010
of all of the branches that are

00:24:37,880 --> 00:24:45,260
available in this git repository so I'm

00:24:40,010 --> 00:24:48,260
just going to get check out eight decks

00:24:45,260 --> 00:24:51,280
Oh two tests just so we can skip ahead

00:24:48,260 --> 00:24:51,280
oh shut up

00:24:52,119 --> 00:24:57,139
okay so the first thing that you'll

00:24:55,639 --> 00:24:58,820
notice that's different from here is we

00:24:57,139 --> 00:25:02,059
now have this lib directory so we have

00:24:58,820 --> 00:25:04,519
lib Drupal pants tests and then in that

00:25:02,059 --> 00:25:06,830
directory there's now two different

00:25:04,519 --> 00:25:08,809
files there's pants crud that test and

00:25:06,830 --> 00:25:11,090
pants you I thought test and the reason

00:25:08,809 --> 00:25:12,440
I had to do that is because before those

00:25:11,090 --> 00:25:14,599
were two different classes in the same

00:25:12,440 --> 00:25:16,489
file but PSR 0 doesn't allow for that it

00:25:14,599 --> 00:25:19,879
only allows for one class profiles that

00:25:16,489 --> 00:25:23,409
make sense okay then inside one of these

00:25:19,879 --> 00:25:27,139
like let's take pants pants UI tests

00:25:23,409 --> 00:25:32,419
come on dude oh yeah it helps when I

00:25:27,139 --> 00:25:35,960
type the whole ah okay and that's not

00:25:32,419 --> 00:25:37,970
what I meant okay so in here I've

00:25:35,960 --> 00:25:40,460
declared a namespace at the top which is

00:25:37,970 --> 00:25:43,279
saying everything in this file is scoped

00:25:40,460 --> 00:25:44,690
to only the namespace module tests so

00:25:43,279 --> 00:25:46,070
that allows me to Dupree Lee name my

00:25:44,690 --> 00:25:47,599
functions whatever they want they won't

00:25:46,070 --> 00:25:50,059
conflict with anyone elses as long as

00:25:47,599 --> 00:25:54,279
they haven't pulled in my name space but

00:25:50,059 --> 00:25:58,070
I'm using the simple test web test base

00:25:54,279 --> 00:25:59,509
library from elsewhere in contribs think

00:25:58,070 --> 00:26:00,919
of this is like an include once

00:25:59,509 --> 00:26:02,479
statement like you've all used those

00:26:00,919 --> 00:26:04,609
includes requires or stuff like that

00:26:02,479 --> 00:26:06,289
it's it's very similar to that except

00:26:04,609 --> 00:26:08,479
instead of like specifying the file name

00:26:06,289 --> 00:26:09,830
you specify the name space there's a

00:26:08,479 --> 00:26:12,019
little bit better because then the file

00:26:09,830 --> 00:26:14,029
can move around wherever it needs to go

00:26:12,019 --> 00:26:15,440
but you can always refer to it by the

00:26:14,029 --> 00:26:18,019
same name so that's actually kind of

00:26:15,440 --> 00:26:20,690
nice and then otherwise not a lot

00:26:18,019 --> 00:26:23,899
changed here it's now web test base

00:26:20,690 --> 00:26:25,639
instead of Drupal web test case you can

00:26:23,899 --> 00:26:28,940
now specify the profile that it should

00:26:25,639 --> 00:26:30,979
use so the standard profile when you

00:26:28,940 --> 00:26:32,749
enable modules in your test you now do

00:26:30,979 --> 00:26:35,330
it through this kind of weird static

00:26:32,749 --> 00:26:37,070
modules array and a couple of other

00:26:35,330 --> 00:26:38,599
things but more or less other than that

00:26:37,070 --> 00:26:40,820
this is just the same test code as it

00:26:38,599 --> 00:26:44,059
ever was so it's pretty pretty

00:26:40,820 --> 00:26:47,749
straightforward any questions on PS r0

00:26:44,059 --> 00:26:49,129
or namespaces before we move on you'll

00:26:47,749 --> 00:26:52,779
see them a lot and it just kind of takes

00:26:49,129 --> 00:26:52,779
some getting used to yeah

00:26:52,800 --> 00:27:00,720
I know isn't that kind of just make you

00:26:57,690 --> 00:27:02,760
go hola yeah it's it's true so he's

00:27:00,720 --> 00:27:05,670
saying the the only part of this path

00:27:02,760 --> 00:27:12,840
that's in lowercase well in Libya is

00:27:05,670 --> 00:27:16,560
pants yeah it's it's also cuz it's dumb

00:27:12,840 --> 00:27:18,660
but you know but yeah but you know this

00:27:16,560 --> 00:27:20,760
is the same things you know other

00:27:18,660 --> 00:27:21,840
projects that people use their coming

00:27:20,760 --> 00:27:31,830
from this and they understand that

00:27:21,840 --> 00:27:33,480
that's how it works yeah yeah that's a

00:27:31,830 --> 00:27:35,460
wonderful question and I don't remember

00:27:33,480 --> 00:27:37,350
because we argued about it for a long

00:27:35,460 --> 00:27:48,140
time and then we were like leave it and

00:27:37,350 --> 00:27:48,140
we'll discuss it later sorry correct

00:27:49,250 --> 00:27:54,030
yeah the key thing like he was saying is

00:27:51,870 --> 00:27:56,370
the lib folder that tell that informs

00:27:54,030 --> 00:27:58,680
that the autoloader that there's classes

00:27:56,370 --> 00:28:00,510
in here so it finds all of those and

00:27:58,680 --> 00:28:01,950
then this is just a way of namespacing

00:28:00,510 --> 00:28:08,070
it so that your tests don't conflict

00:28:01,950 --> 00:28:13,650
with anyone elses tests that's debatable

00:28:08,070 --> 00:28:15,120
it's supposed to yes yeah then yeah

00:28:13,650 --> 00:28:16,620
that's true the nice thing about this is

00:28:15,120 --> 00:28:17,760
that because it's directory and file

00:28:16,620 --> 00:28:19,020
based you don't have to go to the

00:28:17,760 --> 00:28:20,400
database in order to look things up

00:28:19,020 --> 00:28:22,140
worries you do with the registry you

00:28:20,400 --> 00:28:25,520
have to check the table for what files

00:28:22,140 --> 00:28:25,520
us in and then you come back to it

00:28:39,280 --> 00:28:46,450
yeah I learned about make derpy and that

00:28:42,970 --> 00:28:48,010
changed my life because if you're trying

00:28:46,450 --> 00:28:49,180
to like make their live CD make their

00:28:48,010 --> 00:28:52,480
blah blah but it takes a really long

00:28:49,180 --> 00:28:54,130
time so anyway so that's cool I'm going

00:28:52,480 --> 00:28:56,680
to keep rolling because we do have a lot

00:28:54,130 --> 00:28:59,200
of stuff to cover so great we run the

00:28:56,680 --> 00:29:00,760
things we find that has fails that's not

00:28:59,200 --> 00:29:02,980
entirely unexpected because there's big

00:29:00,760 --> 00:29:04,150
chunks of the module not working yet so

00:29:02,980 --> 00:29:07,930
let's talk about the configuration

00:29:04,150 --> 00:29:10,090
system in Drupal 8 so the configuration

00:29:07,930 --> 00:29:11,290
system is intended to get around some of

00:29:10,090 --> 00:29:13,300
these problems so what we're trying to

00:29:11,290 --> 00:29:15,100
do is you're trying to kill the variable

00:29:13,300 --> 00:29:16,810
system in Drupal 7 and we're actually

00:29:15,100 --> 00:29:19,300
just about done it's pretty pretty

00:29:16,810 --> 00:29:22,420
awesome but why why Oh are we going to

00:29:19,300 --> 00:29:24,160
clap for that all right today but why

00:29:22,420 --> 00:29:26,230
wedge why do we want to kill the poor

00:29:24,160 --> 00:29:28,000
variable system well the huge problem

00:29:26,230 --> 00:29:29,830
with the variables table is that you're

00:29:28,000 --> 00:29:32,110
combining configuration and content in

00:29:29,830 --> 00:29:34,330
the same database and so it's really

00:29:32,110 --> 00:29:35,770
really difficult to say I want this part

00:29:34,330 --> 00:29:37,300
of this database changes but not that

00:29:35,770 --> 00:29:39,070
part of the database changes because I

00:29:37,300 --> 00:29:40,270
care about that setting I just changed

00:29:39,070 --> 00:29:41,590
but I don't want to destroy all the

00:29:40,270 --> 00:29:44,830
comments that have been posted in the

00:29:41,590 --> 00:29:46,120
last two hours there's also a problem

00:29:44,830 --> 00:29:47,830
where the entire contents of the

00:29:46,120 --> 00:29:49,360
variables tables loaded into memory on

00:29:47,830 --> 00:29:52,540
every single page load so that's really

00:29:49,360 --> 00:29:53,920
expensive and the API is limited which

00:29:52,540 --> 00:29:55,030
causes all these other modules and

00:29:53,920 --> 00:29:56,800
contribute to invent their own ways of

00:29:55,030 --> 00:29:58,540
doing things so there's features there's

00:29:56,800 --> 00:30:00,340
CTools exportable there's all of these

00:29:58,540 --> 00:30:01,960
different things and a lot of times are

00:30:00,340 --> 00:30:03,910
incompatible or they're very complicated

00:30:01,960 --> 00:30:06,310
so the idea was like let's scrap that

00:30:03,910 --> 00:30:08,980
new configuration system bacon into core

00:30:06,310 --> 00:30:10,450
so it works so there's two AP is as part

00:30:08,980 --> 00:30:13,690
of the new system there may be three by

00:30:10,450 --> 00:30:16,690
the end of next week literally but for

00:30:13,690 --> 00:30:18,550
now there's configuration API which is

00:30:16,690 --> 00:30:20,380
for most things so most settings forms

00:30:18,550 --> 00:30:21,760
that you develop you want to use the

00:30:20,380 --> 00:30:23,380
configuration API and I'll show you an

00:30:21,760 --> 00:30:24,820
example of that what that will do is

00:30:23,380 --> 00:30:27,190
when you save the contents of that form

00:30:24,820 --> 00:30:29,860
it writes it out to a llamo file on the

00:30:27,190 --> 00:30:31,990
disk and that's great because yamo files

00:30:29,860 --> 00:30:34,510
are just files and they can be moved

00:30:31,990 --> 00:30:36,340
around with ftp if you're lame or they

00:30:34,510 --> 00:30:38,160
can be moved around with gits or

00:30:36,340 --> 00:30:40,360
something like that if you're awesome

00:30:38,160 --> 00:30:42,130
you can keep track of what you've

00:30:40,360 --> 00:30:43,720
changed and why you changed it and you

00:30:42,130 --> 00:30:47,050
can roll back if you don't like the way

00:30:43,720 --> 00:30:48,760
the configuration is the state API is a

00:30:47,050 --> 00:30:50,650
little bit different so the state API is

00:30:48,760 --> 00:30:53,049
for TV track of various environment

00:30:50,650 --> 00:30:55,960
specific stuff so say for example the

00:30:53,049 --> 00:30:57,639
api key for Amazon Web Services you

00:30:55,960 --> 00:31:02,080
don't necessarily want that in the files

00:30:57,639 --> 00:31:04,600
directory in your you know you know in

00:31:02,080 --> 00:31:06,669
your git repository it's also for things

00:31:04,600 --> 00:31:07,809
like the last time cron ran you wouldn't

00:31:06,669 --> 00:31:09,549
want to deploy that and then the

00:31:07,809 --> 00:31:11,200
production server thanks cron ran later

00:31:09,549 --> 00:31:14,559
than it did so those kinds of things we

00:31:11,200 --> 00:31:16,840
put into the state API so the config API

00:31:14,559 --> 00:31:18,610
looks like this let's config contact out

00:31:16,840 --> 00:31:20,710
settings and then you have a set command

00:31:18,610 --> 00:31:22,090
so you can set a different option and

00:31:20,710 --> 00:31:24,220
then you save it at the end when you're

00:31:22,090 --> 00:31:25,779
done setting all your things and what

00:31:24,220 --> 00:31:28,359
that will do is it will save a file

00:31:25,779 --> 00:31:31,419
called contact settings yamo which is

00:31:28,359 --> 00:31:34,320
based off that key up there and it just

00:31:31,419 --> 00:31:36,489
puts the contents of it in yamel format

00:31:34,320 --> 00:31:37,869
which is basic it's a lot like an info

00:31:36,489 --> 00:31:39,929
file really it's got a couple of other

00:31:37,869 --> 00:31:43,119
quirks but that's essentially what it is

00:31:39,929 --> 00:31:44,590
and there's two of these directories

00:31:43,119 --> 00:31:46,239
there's an active directory which is

00:31:44,590 --> 00:31:48,279
what it actively reads configuration

00:31:46,239 --> 00:31:50,230
from and there's a staging directory so

00:31:48,279 --> 00:31:51,429
when you're moving your configuration

00:31:50,230 --> 00:31:52,570
from your dev to your production

00:31:51,429 --> 00:31:54,759
environment you take it out of the

00:31:52,570 --> 00:31:55,989
Active Directory the files chuck them

00:31:54,759 --> 00:31:57,779
over into the staging directory and then

00:31:55,989 --> 00:32:02,649
there's a UI to actually import those

00:31:57,779 --> 00:32:04,929
kind of similar to the features you I so

00:32:02,649 --> 00:32:07,450
state API that's for stuff like update

00:32:04,929 --> 00:32:08,830
last check and that will actually store

00:32:07,450 --> 00:32:10,570
it in the equivalent of a variables

00:32:08,830 --> 00:32:12,220
table although it's swappable so it

00:32:10,570 --> 00:32:14,470
could be sorted memcache or anything

00:32:12,220 --> 00:32:16,419
else but the key thing is that storing

00:32:14,470 --> 00:32:18,399
way less information that it used to and

00:32:16,419 --> 00:32:19,809
these things are lazy loaded only when

00:32:18,399 --> 00:32:21,429
needed you're not loading the entire

00:32:19,809 --> 00:32:24,159
contents of that database every single

00:32:21,429 --> 00:32:29,950
time so if you want to see that in

00:32:24,159 --> 00:32:39,909
action it's pretty straightforward oops

00:32:29,950 --> 00:32:42,249
ah typing there we go so now there's a

00:32:39,909 --> 00:32:46,539
config directory in my module and a pan

00:32:42,249 --> 00:32:48,190
settings yamo file and here I just have

00:32:46,539 --> 00:32:50,470
a pants type and by default it's nothing

00:32:48,190 --> 00:32:53,320
okay and then it could be MC Hammer it

00:32:50,470 --> 00:32:54,730
could be you know anything else but for

00:32:53,320 --> 00:32:56,109
right now is nothing and if I had any

00:32:54,730 --> 00:32:59,080
other settings on that form they would

00:32:56,109 --> 00:33:00,850
go like that the API key setting on that

00:32:59,080 --> 00:33:02,679
form i didn't put into this i put that

00:33:00,850 --> 00:33:04,330
into the state system because it's

00:33:02,679 --> 00:33:06,240
possible that you want your development

00:33:04,330 --> 00:33:07,620
server to be talking to a sandbox

00:33:06,240 --> 00:33:09,660
whereas you want your production server

00:33:07,620 --> 00:33:10,860
to be talking to actual amazon web

00:33:09,660 --> 00:33:12,600
service because a lot of these api's are

00:33:10,860 --> 00:33:14,760
sometimes liberate limited and you don't

00:33:12,600 --> 00:33:16,920
want your like you know site that you're

00:33:14,760 --> 00:33:19,590
doing like a data migration practice run

00:33:16,920 --> 00:33:22,679
on to sort of run that up so if i go to

00:33:19,590 --> 00:33:26,910
pants module and i look up that settings

00:33:22,679 --> 00:33:30,000
forum there's a couple of things that

00:33:26,910 --> 00:33:31,800
have changed here so in the past what

00:33:30,000 --> 00:33:34,140
you do is you name your elements like

00:33:31,800 --> 00:33:36,000
forum pants type and form pants key and

00:33:34,140 --> 00:33:37,500
then you recall this system settings

00:33:36,000 --> 00:33:39,120
forum at the bottom and then

00:33:37,500 --> 00:33:40,559
automatically every one thing would be

00:33:39,120 --> 00:33:41,670
taken care of for you right you'd say

00:33:40,559 --> 00:33:43,170
the form it would save it to the

00:33:41,670 --> 00:33:44,340
variables table it would automatically

00:33:43,170 --> 00:33:47,429
read it out as a default value is

00:33:44,340 --> 00:33:48,780
beautiful in Drupal 8 we make you do a

00:33:47,429 --> 00:33:50,730
little bit more work so there's still

00:33:48,780 --> 00:33:52,710
system config forum which wraps the

00:33:50,730 --> 00:33:53,970
button so at least that's consistent but

00:33:52,710 --> 00:33:56,130
you actually have to define your own

00:33:53,970 --> 00:33:57,870
submit handler for that form that will

00:33:56,130 --> 00:33:59,940
actually write the config and state

00:33:57,870 --> 00:34:01,380
parameters to it so just something to be

00:33:59,940 --> 00:34:03,570
aware of if you're used to kind of

00:34:01,380 --> 00:34:06,150
having that magic for you in Drupal 7 we

00:34:03,570 --> 00:34:08,340
took that out in Drupal 8 the thinking

00:34:06,150 --> 00:34:09,510
there was that it's more explicit you

00:34:08,340 --> 00:34:11,280
know it causes people cuz a lot of

00:34:09,510 --> 00:34:13,710
people are confused by the magic of you

00:34:11,280 --> 00:34:17,609
know system settings forms so now it's a

00:34:13,710 --> 00:34:18,899
little bit more explicit yep too easy to

00:34:17,609 --> 00:34:20,520
get yourself in a lot of trouble the

00:34:18,899 --> 00:34:22,080
worst exact the worst abuse of the

00:34:20,520 --> 00:34:24,389
variables table I ever saw was a legal

00:34:22,080 --> 00:34:26,129
module back in the day because what it

00:34:24,389 --> 00:34:28,139
would do is it would it would take your

00:34:26,129 --> 00:34:29,700
entire terms of service so for some

00:34:28,139 --> 00:34:32,040
modules there are some sites that might

00:34:29,700 --> 00:34:34,080
be seventy thousand words long and it

00:34:32,040 --> 00:34:35,580
would soar every single revision of that

00:34:34,080 --> 00:34:37,530
terms of service in your variables table

00:34:35,580 --> 00:34:40,679
so on every single page load you could

00:34:37,530 --> 00:34:42,270
be loading like eight megs of text so

00:34:40,679 --> 00:34:45,119
this will stop that from happening so

00:34:42,270 --> 00:34:53,490
that's good questions on the

00:34:45,119 --> 00:34:56,040
configuration API yeah ah yes that

00:34:53,490 --> 00:34:59,880
doesn't work with the config API if you

00:34:56,040 --> 00:35:03,240
want a default value then you just have

00:34:59,880 --> 00:35:05,369
to do like a ternary operator and say if

00:35:03,240 --> 00:35:12,780
it's set then do this otherwise do that

00:35:05,369 --> 00:35:14,970
ah try it and see and report back to the

00:35:12,780 --> 00:35:16,080
class that would be a wonderful it might

00:35:14,970 --> 00:35:17,580
be no that's actually a good question

00:35:16,080 --> 00:35:19,170
because it would be the question of how

00:35:17,580 --> 00:35:19,859
to differentiate a real null and a fake

00:35:19,170 --> 00:35:20,999
null so

00:35:19,859 --> 00:35:25,799
I don't actually know the answer that

00:35:20,999 --> 00:35:27,210
question that's a good one yeah yeah

00:35:25,799 --> 00:35:28,920
that's true so the default will be

00:35:27,210 --> 00:35:30,660
defined there but you can get yourself

00:35:28,920 --> 00:35:33,299
into a weird situation where like for

00:35:30,660 --> 00:35:34,650
the state API particularly there isn't

00:35:33,299 --> 00:35:36,150
anything in the table yet because you

00:35:34,650 --> 00:35:37,619
haven't saved the form and it still

00:35:36,150 --> 00:35:39,630
needs to initialize with default values

00:35:37,619 --> 00:35:40,950
so but yes where the defaults will come

00:35:39,630 --> 00:35:42,630
from normally that's a good point is

00:35:40,950 --> 00:35:44,460
from that Yamaha be put in your mazel

00:35:42,630 --> 00:35:46,170
directory oh and this is a hot tip if

00:35:44,460 --> 00:35:49,470
you're lazy and you don't like writing

00:35:46,170 --> 00:35:50,940
yambol by hand if you make your form or

00:35:49,470 --> 00:35:52,650
sorry if you write your form submit

00:35:50,940 --> 00:35:54,749
function like this that will

00:35:52,650 --> 00:35:56,220
automatically right I llamo file for you

00:35:54,749 --> 00:35:58,049
and then you can just copy and paste it

00:35:56,220 --> 00:36:02,999
into your into your module directory so

00:35:58,049 --> 00:36:05,009
yay laziness whoo okay efficiency yes

00:36:02,999 --> 00:36:07,619
that's a much better word all right so

00:36:05,009 --> 00:36:11,069
I'm going to clip along here so blocks

00:36:07,619 --> 00:36:13,589
and plugins is another big thing the

00:36:11,069 --> 00:36:15,900
plug-in system is this crazy thing that

00:36:13,589 --> 00:36:18,749
is basically a unified object-oriented

00:36:15,900 --> 00:36:20,819
API for anything that's pluggable so in

00:36:18,749 --> 00:36:22,049
Drupal 7 we had a bunch of different

00:36:20,819 --> 00:36:23,489
ways to make something pluggable you

00:36:22,049 --> 00:36:27,359
could have info hooks that had altar

00:36:23,489 --> 00:36:29,099
hooks on them you could have I don't

00:36:27,359 --> 00:36:31,559
know you could have like the you know

00:36:29,099 --> 00:36:33,180
for the caching back end for example was

00:36:31,559 --> 00:36:35,430
a variable in the variables table and it

00:36:33,180 --> 00:36:36,569
would swap it out based on memcache wear

00:36:35,430 --> 00:36:38,369
whatever that variable is set to and

00:36:36,569 --> 00:36:40,950
there's a bunch of different things so

00:36:38,369 --> 00:36:42,180
like all good over architecting software

00:36:40,950 --> 00:36:44,039
engineers we said you know there ought

00:36:42,180 --> 00:36:46,920
to be a way to invent one thing that

00:36:44,039 --> 00:36:48,359
sells 75 problems in a really abstract

00:36:46,920 --> 00:36:50,579
way so that's what we did with the

00:36:48,359 --> 00:36:52,710
plugin manager so basically there's a

00:36:50,579 --> 00:36:54,390
few different elements of this there's a

00:36:52,710 --> 00:36:56,369
discovery mechanism where you teach the

00:36:54,390 --> 00:36:58,170
plug-in system how to find your thing so

00:36:56,369 --> 00:36:59,579
that might be an info hook it might be

00:36:58,170 --> 00:37:01,230
annotations which we'll talk about in a

00:36:59,579 --> 00:37:02,849
second or something like that which says

00:37:01,230 --> 00:37:04,859
it show me all of this stuff that there

00:37:02,849 --> 00:37:06,390
is so examples about systems that are

00:37:04,859 --> 00:37:08,489
using plugins are like blocks entities

00:37:06,390 --> 00:37:09,569
field for matters a lot of different

00:37:08,489 --> 00:37:11,519
things are starting to move to the

00:37:09,569 --> 00:37:13,200
plugin system so for example on the

00:37:11,519 --> 00:37:15,089
discovery mechanisms like how do I find

00:37:13,200 --> 00:37:17,339
out what blocks there are in the system

00:37:15,089 --> 00:37:18,960
and then you can decorate those finder

00:37:17,339 --> 00:37:20,819
things and you can say I want this thing

00:37:18,960 --> 00:37:23,579
to be cacheable I wanted to be alterable

00:37:20,819 --> 00:37:24,960
I I want derivatives on it which is a

00:37:23,579 --> 00:37:26,309
whole fancy thing that I don't really

00:37:24,960 --> 00:37:28,549
understand but I have a really great

00:37:26,309 --> 00:37:31,109
graphic for it on the next slide and

00:37:28,549 --> 00:37:32,609
then a factory which says now that I

00:37:31,109 --> 00:37:33,450
found all of those things and what they

00:37:32,609 --> 00:37:35,490
are and they've been

00:37:33,450 --> 00:37:37,920
fine let's go ahead and create instances

00:37:35,490 --> 00:37:40,440
of them so here's your system powered by

00:37:37,920 --> 00:37:42,270
block here's your you know your your

00:37:40,440 --> 00:37:44,280
recent users block that sort of stuff

00:37:42,270 --> 00:37:46,550
there's actually really great

00:37:44,280 --> 00:37:48,869
documentation on this at that URL

00:37:46,550 --> 00:37:50,310
there's like I know seven or eight pages

00:37:48,869 --> 00:37:53,280
of the plug-in system it kind of walks

00:37:50,310 --> 00:37:55,170
through everything there this is the

00:37:53,280 --> 00:37:56,520
funny rafic so it says yo dawg i heard

00:37:55,170 --> 00:37:57,869
you like plug ability so we put

00:37:56,520 --> 00:37:59,750
derivatives in your plug-in so you can

00:37:57,869 --> 00:38:02,609
have plugins inside your plugins that

00:37:59,750 --> 00:38:04,470
pretty much sums up the plugin system it

00:38:02,609 --> 00:38:06,150
is very flexible for anything you might

00:38:04,470 --> 00:38:08,820
need but it's a little complicated to

00:38:06,150 --> 00:38:11,070
get started with it and annotations is

00:38:08,820 --> 00:38:13,829
an interesting one thing we added in

00:38:11,070 --> 00:38:15,210
Drupal 8 so in Drupal 7 when you define

00:38:13,829 --> 00:38:17,609
blocks you typically use like a hook

00:38:15,210 --> 00:38:19,020
block info or hook you know formatter

00:38:17,609 --> 00:38:21,869
info or whatever there's all these info

00:38:19,020 --> 00:38:23,910
hooks all around and Drupal 8 we've

00:38:21,869 --> 00:38:25,410
moved away from defining a raise of a

00:38:23,910 --> 00:38:27,000
raise of a raise of things to defining

00:38:25,410 --> 00:38:28,260
classes and then the way that we

00:38:27,000 --> 00:38:30,510
register classes is through the

00:38:28,260 --> 00:38:31,800
annotations which is really strange to

00:38:30,510 --> 00:38:33,599
get your head around if you're like a

00:38:31,800 --> 00:38:35,820
traditional PHP develop because what it

00:38:33,599 --> 00:38:40,530
is is essentially like codifying this

00:38:35,820 --> 00:38:42,150
array in comments in PHP and there's no

00:38:40,530 --> 00:38:43,650
syntax checking for this by the way so

00:38:42,150 --> 00:38:46,589
it's a lot of fun trying to figure out

00:38:43,650 --> 00:38:48,210
that you forgot a comma somewhere but

00:38:46,589 --> 00:38:49,770
you know how it works is essentially the

00:38:48,210 --> 00:38:52,410
same information so you give it an ID

00:38:49,770 --> 00:38:53,760
which is sort of like a machine name you

00:38:52,410 --> 00:38:55,470
give it a subject and then there's a

00:38:53,760 --> 00:38:57,540
little at translation function as

00:38:55,470 --> 00:38:59,250
opposed to the T function because

00:38:57,540 --> 00:39:02,310
apparently we just can't be consistent

00:38:59,250 --> 00:39:04,380
and then you also tell what module it

00:39:02,310 --> 00:39:07,170
belongs to so that when the modules on

00:39:04,380 --> 00:39:08,280
installed it knows what to clear out so

00:39:07,170 --> 00:39:10,619
a lot of things are moving to the

00:39:08,280 --> 00:39:12,599
annotation system because it's a much

00:39:10,619 --> 00:39:14,790
nicer syntax than having to define

00:39:12,599 --> 00:39:16,109
arrays all over the place the other

00:39:14,790 --> 00:39:18,300
thing that they like about it is that

00:39:16,109 --> 00:39:20,609
because those are possible they can be

00:39:18,300 --> 00:39:22,800
lazy loaded as well so with info hooks

00:39:20,609 --> 00:39:24,300
every time you load a module file you

00:39:22,800 --> 00:39:25,859
have to load this huge array of gunk

00:39:24,300 --> 00:39:28,920
even if you never actually need it on

00:39:25,859 --> 00:39:30,000
the page load but annotations on classes

00:39:28,920 --> 00:39:35,579
they can be loaded whenever they're

00:39:30,000 --> 00:39:38,810
needed so let's see that in action these

00:39:35,579 --> 00:39:38,810
are block pants by the way

00:39:42,270 --> 00:39:46,119
how am i doing for time I'm not doing

00:39:44,740 --> 00:39:52,450
great for time we might need to blow

00:39:46,119 --> 00:39:54,309
through a couple of days looks okay and

00:39:52,450 --> 00:39:57,309
let's see what we got in here so one

00:39:54,309 --> 00:40:00,480
thing we have is under lib Drupal oh I

00:39:57,309 --> 00:40:06,630
should close you guys where is it lib

00:40:00,480 --> 00:40:06,630
live Drupal then what tance and then

00:40:08,160 --> 00:40:16,359
plug in very good and then and then

00:40:12,839 --> 00:40:18,760
block again in case you forgot two

00:40:16,359 --> 00:40:25,569
blocks and then finally pants change

00:40:18,760 --> 00:40:28,569
block PHP yeah we have some work to do

00:40:25,569 --> 00:40:31,240
with this yeah that's like no I can't

00:40:28,569 --> 00:40:33,819
not one more block I can't take it so

00:40:31,240 --> 00:40:35,319
here's how that this is the change pants

00:40:33,819 --> 00:40:36,790
blog I didn't bother doing the recent

00:40:35,319 --> 00:40:40,930
pants block because what would I turn

00:40:36,790 --> 00:40:42,220
that too in Drupal 8 of you yes if you

00:40:40,930 --> 00:40:43,780
go into the eight decks branch of

00:40:42,220 --> 00:40:45,309
Panthers bleeding-edge code that has a

00:40:43,780 --> 00:40:48,010
view but I couldn't get it cleaned up in

00:40:45,309 --> 00:40:49,990
time for this presentation so sorry so

00:40:48,010 --> 00:40:51,549
here's more namespaces that's my pants

00:40:49,990 --> 00:40:53,829
plugin block block block block block and

00:40:51,549 --> 00:40:56,710
then it's telling me I'm deriving from

00:40:53,829 --> 00:40:58,510
block base so I need to pull that in i'm

00:40:56,710 --> 00:41:01,329
also using the plug-in system so i pull

00:40:58,510 --> 00:41:03,040
that in and the annotation system are

00:41:01,329 --> 00:41:06,760
sorry the translation of the annotation

00:41:03,040 --> 00:41:09,069
so here's my ID subject module pretty

00:41:06,760 --> 00:41:11,380
straightforward and then instead of a

00:41:09,069 --> 00:41:13,450
hook block view what i have instead is a

00:41:11,380 --> 00:41:14,980
build function which essentially has

00:41:13,450 --> 00:41:17,200
everything that used to be in the old

00:41:14,980 --> 00:41:20,200
view function but now it's just called

00:41:17,200 --> 00:41:23,940
build and you can add your j/s there and

00:41:20,200 --> 00:41:23,940
so most did I do this one right at least

00:41:26,970 --> 00:41:36,010
is that the proper way to define a block

00:41:30,000 --> 00:41:37,960
in the rinse oh all right don't ever use

00:41:36,010 --> 00:41:40,750
this presentation for anything but the

00:41:37,960 --> 00:41:42,339
point is that you have you returned to

00:41:40,750 --> 00:41:45,450
render array from this block and then it

00:41:42,339 --> 00:41:47,980
gets rendered out on the screen later on

00:41:45,450 --> 00:41:49,420
and the other plugins are you know they

00:41:47,980 --> 00:41:51,470
don't all use the build function but you

00:41:49,420 --> 00:41:53,150
know like they all have this same you

00:41:51,470 --> 00:41:55,760
sort of annotations describing like the

00:41:53,150 --> 00:41:57,590
info file type of thing and then they

00:41:55,760 --> 00:41:58,940
all have other namespaces that they use

00:41:57,590 --> 00:42:00,609
and then they all define functions and

00:41:58,940 --> 00:42:02,930
you just implement them stuff like that

00:42:00,609 --> 00:42:07,760
our people generally a fan of object

00:42:02,930 --> 00:42:09,080
orientation object oriented whoa okay

00:42:07,760 --> 00:42:11,780
there's there's that we're gonna have a

00:42:09,080 --> 00:42:13,609
fight later this would be great it was a

00:42:11,780 --> 00:42:15,380
little weird to get used to but it one

00:42:13,609 --> 00:42:17,690
thing that's really nice is unlike info

00:42:15,380 --> 00:42:19,550
files or sorry info arrays which

00:42:17,690 --> 00:42:20,930
requires you to look on API to drupal

00:42:19,550 --> 00:42:23,060
org and copy and paste them and sit

00:42:20,930 --> 00:42:25,010
there and twiddle with them the nice

00:42:23,060 --> 00:42:26,480
thing about classes is that properties

00:42:25,010 --> 00:42:28,430
and methods and things that you can do

00:42:26,480 --> 00:42:30,950
are all nicely auto completed by your

00:42:28,430 --> 00:42:32,510
IDE they're easy to search for this kind

00:42:30,950 --> 00:42:34,250
of thing so the actual like working of

00:42:32,510 --> 00:42:36,109
this stuff is actually a lot nicer once

00:42:34,250 --> 00:42:38,320
you get used to it I'm still not a fan

00:42:36,109 --> 00:42:41,720
of the directory structure though yeah

00:42:38,320 --> 00:42:44,240
alright so that's blocks let's talk

00:42:41,720 --> 00:42:48,920
about routing so symphony and Drupal in

00:42:44,240 --> 00:42:51,050
a tree k-i-s-s-i-n-g so the routing

00:42:48,920 --> 00:42:54,619
system in Drupal so this is the thing

00:42:51,050 --> 00:42:56,750
that takes a incoming URL request and

00:42:54,619 --> 00:42:59,660
maps it to what page callback that you

00:42:56,750 --> 00:43:01,460
go to as we use Quick Menu for this so

00:42:59,660 --> 00:43:03,020
we're using symphony now so symphony is

00:43:01,460 --> 00:43:05,900
now embedded in drupal's bootstrap

00:43:03,020 --> 00:43:08,450
process we're using a few different

00:43:05,900 --> 00:43:09,920
components of sympathy there's more than

00:43:08,450 --> 00:43:11,570
this actually but as it relates to

00:43:09,920 --> 00:43:14,900
routing these are the main ones I hope I

00:43:11,570 --> 00:43:16,520
go right HTTP foundation what that does

00:43:14,900 --> 00:43:20,359
this essentially turns every single page

00:43:16,520 --> 00:43:22,700
into or page run through as an incoming

00:43:20,359 --> 00:43:25,670
request that gets transferred and

00:43:22,700 --> 00:43:27,890
returns a response and just with regular

00:43:25,670 --> 00:43:29,359
HTTP standard stuff that you may be

00:43:27,890 --> 00:43:33,200
played around with in curl or whatever

00:43:29,359 --> 00:43:35,630
the HTTP kernel can help route their

00:43:33,200 --> 00:43:36,950
kind of help manage those requests and

00:43:35,630 --> 00:43:38,420
then route them to where they need to go

00:43:36,950 --> 00:43:40,520
and then the routing component actually

00:43:38,420 --> 00:43:43,820
takes the oral and maps it over to some

00:43:40,520 --> 00:43:45,260
sort of code that returns some some sort

00:43:43,820 --> 00:43:47,570
of output to that people who do it and

00:43:45,260 --> 00:43:50,450
here's a nice graph that i blatantly

00:43:47,570 --> 00:43:52,910
shamelessly ripped off from the symphony

00:43:50,450 --> 00:43:55,520
site but so requests come in two

00:43:52,910 --> 00:43:57,260
different urls just like in drupal you

00:43:55,520 --> 00:43:59,720
know you define whatever URL that you

00:43:57,260 --> 00:44:01,310
want those go into a controller that

00:43:59,720 --> 00:44:03,230
sort of sorts them out it passes them

00:44:01,310 --> 00:44:04,770
off to the symphony to kernel which in

00:44:03,230 --> 00:44:05,970
Drupal is the Drupal colonel

00:44:04,770 --> 00:44:07,680
but it's derived from the sympathy

00:44:05,970 --> 00:44:09,240
kernel and think of that is just like

00:44:07,680 --> 00:44:11,940
the lower lying guts that sort of run

00:44:09,240 --> 00:44:13,470
the framework and then what it does is

00:44:11,940 --> 00:44:15,030
it says oh this is an incoming request

00:44:13,470 --> 00:44:16,770
URI let me pass it off to the routing

00:44:15,030 --> 00:44:18,060
system and just like in Drupal the

00:44:16,770 --> 00:44:21,300
routing system will look it up and say

00:44:18,060 --> 00:44:23,400
oh that URL maps to this function except

00:44:21,300 --> 00:44:26,460
and drew in something it's a class or a

00:44:23,400 --> 00:44:27,750
method sorry on a class it pass it back

00:44:26,460 --> 00:44:29,340
to controller back to the colonel and

00:44:27,750 --> 00:44:31,050
then it will call whatever function it

00:44:29,340 --> 00:44:33,540
is that defines the output for that page

00:44:31,050 --> 00:44:35,550
so in the case of contact that might

00:44:33,540 --> 00:44:36,600
contact action and then what it will

00:44:35,550 --> 00:44:38,970
return at the very end of that is a

00:44:36,600 --> 00:44:43,050
symphony response that then people can

00:44:38,970 --> 00:44:45,030
act on and do whatever they want so in

00:44:43,050 --> 00:44:47,040
symphony how your route definition goes

00:44:45,030 --> 00:44:49,410
is like this you have a blog underscores

00:44:47,040 --> 00:44:50,880
show some sign of a machine name there

00:44:49,410 --> 00:44:53,850
you define a pattern which is the

00:44:50,880 --> 00:44:55,500
equivalent of our path and then you give

00:44:53,850 --> 00:44:58,590
it a controller which is sort of like a

00:44:55,500 --> 00:45:00,710
page call back in Drupal and then you

00:44:58,590 --> 00:45:03,660
define what's called a controller class

00:45:00,710 --> 00:45:07,260
and then you create a function that just

00:45:03,660 --> 00:45:08,700
returned some output somewhere so to

00:45:07,260 --> 00:45:11,130
show this side by side from just sent me

00:45:08,700 --> 00:45:12,690
on a Drupal 7 to Drupal 8 so here's an

00:45:11,130 --> 00:45:15,600
example from book modules so here's all

00:45:12,690 --> 00:45:16,800
a book stuff in a hook menu and as we

00:45:15,600 --> 00:45:19,440
like to have a raise of a raise of a

00:45:16,800 --> 00:45:21,540
raise it looks like this in Drupal 8 how

00:45:19,440 --> 00:45:25,580
you define those as in a book routing

00:45:21,540 --> 00:45:29,580
llamo file okay so parts of hook menu

00:45:25,580 --> 00:45:32,700
become yeah malefic I just coined that

00:45:29,580 --> 00:45:34,950
by the way um and so things like you

00:45:32,700 --> 00:45:36,600
know % % what that used to be those wild

00:45:34,950 --> 00:45:39,210
cards you now name them in Symphony

00:45:36,600 --> 00:45:41,220
which is actually kind of nice and those

00:45:39,210 --> 00:45:43,080
name things like type and n ID in this

00:45:41,220 --> 00:45:44,730
case it's very smart and will

00:45:43,080 --> 00:45:47,070
automatically map them to function

00:45:44,730 --> 00:45:49,410
arguments in those functions so if you

00:45:47,070 --> 00:45:51,720
have a function called export that takes

00:45:49,410 --> 00:45:53,370
two parameters type in n idee it will

00:45:51,720 --> 00:45:56,910
take the values from the URL and

00:45:53,370 --> 00:45:59,160
automatically send them down to the to

00:45:56,910 --> 00:46:02,840
the function using the right names it's

00:45:59,160 --> 00:46:02,840
very smart do you have a question donna

00:46:03,890 --> 00:46:11,900
Oh in the controller because those are

00:46:09,250 --> 00:46:14,150
those are namespaces the namespaces go

00:46:11,900 --> 00:46:15,289
in the opposite direction I guess

00:46:14,150 --> 00:46:17,599
because they don't want them to be

00:46:15,289 --> 00:46:19,010
confused by the ones the the other thing

00:46:17,599 --> 00:46:21,289
that the pattern to point out is that it

00:46:19,010 --> 00:46:24,200
leads they had a leading / which they

00:46:21,289 --> 00:46:25,880
didn't injure plus 7 the rest of the

00:46:24,200 --> 00:46:27,140
stuff in hook menu is sort of an open

00:46:25,880 --> 00:46:29,390
question right now as far as what's

00:46:27,140 --> 00:46:31,519
going to happen with that they've talked

00:46:29,390 --> 00:46:33,619
about like splitting apart into multiple

00:46:31,519 --> 00:46:35,720
things like a hook tabs and a hook

00:46:33,619 --> 00:46:37,250
action tabs or stuff like that or

00:46:35,720 --> 00:46:38,569
leaving it in hook menu or whatever

00:46:37,250 --> 00:46:41,059
we're going to do this is still sort of

00:46:38,569 --> 00:46:42,769
being fleshed out but the actual routing

00:46:41,059 --> 00:46:46,250
components stuff that gets passed a

00:46:42,769 --> 00:46:50,210
symphony now um so we'll go ahead and

00:46:46,250 --> 00:46:54,170
see this in action everyone got really

00:46:50,210 --> 00:46:57,849
quiet right here I'm sorry it's symphony

00:46:54,170 --> 00:47:00,920
it's it's all cool and stuff right oh i

00:46:57,849 --> 00:47:03,279
know i should like right here they're

00:47:00,920 --> 00:47:06,049
gonna need a cat I just know it this is

00:47:03,279 --> 00:47:09,160
all right so now what's new is I have

00:47:06,049 --> 00:47:12,109
this pants that routing that Yama file

00:47:09,160 --> 00:47:14,019
so I had two things defined in might

00:47:12,109 --> 00:47:23,329
well let's look at that first actually

00:47:14,019 --> 00:47:25,450
let's go back to this module so here was

00:47:23,329 --> 00:47:29,299
our old hook menu so it's defined two

00:47:25,450 --> 00:47:30,920
URLs one was just an AJAX call back for

00:47:29,299 --> 00:47:33,259
that little change link so let me change

00:47:30,920 --> 00:47:35,900
my pants and the other one was a

00:47:33,259 --> 00:47:38,779
configuration page that the form that we

00:47:35,900 --> 00:47:40,640
saw and so one thing that's interesting

00:47:38,779 --> 00:47:43,299
about about this is like you know my

00:47:40,640 --> 00:47:46,220
ajax call back if i go and look at that

00:47:43,299 --> 00:47:51,289
function wherever the heck it is it's

00:47:46,220 --> 00:47:53,150
apparently a horrible thing to there I

00:47:51,289 --> 00:47:54,799
have to do this janky thing which is

00:47:53,150 --> 00:47:56,509
where I print a theme something and then

00:47:54,799 --> 00:47:59,269
I exit out of the request because in

00:47:56,509 --> 00:48:01,069
Drupal 7 that's the only way to stop the

00:47:59,269 --> 00:48:03,500
system from theming the entire page as

00:48:01,069 --> 00:48:06,319
though it's a you know regular desktop

00:48:03,500 --> 00:48:07,789
sort of requests so that's one nice

00:48:06,319 --> 00:48:11,059
thing about Symphony is it real imitates

00:48:07,789 --> 00:48:13,930
that as a default assumption so that's

00:48:11,059 --> 00:48:16,250
that's that's pants change and then the

00:48:13,930 --> 00:48:17,630
the settings form we already looked at

00:48:16,250 --> 00:48:21,500
that's just a separate form at the

00:48:17,630 --> 00:48:26,720
admin config blah blah blah URL so if I

00:48:21,500 --> 00:48:31,039
go to the new symphony eyes way pants

00:48:26,720 --> 00:48:32,720
routing gemmell so the URLs pretty much

00:48:31,039 --> 00:48:34,309
stayed the same the differences pants

00:48:32,720 --> 00:48:37,369
changed I now pass account because

00:48:34,309 --> 00:48:38,329
that's the name of the argument i canna

00:48:37,369 --> 00:48:40,000
have to walk through this stuff myself

00:48:38,329 --> 00:48:42,859
because this is really strange alright

00:48:40,000 --> 00:48:44,059
so content is saying this is where the

00:48:42,859 --> 00:48:46,039
content for this page is being generated

00:48:44,059 --> 00:48:48,500
okay so this is going to be a class

00:48:46,039 --> 00:48:49,730
called pants controller and it's going

00:48:48,500 --> 00:48:51,920
to have a function in there called

00:48:49,730 --> 00:48:53,869
settings and what settings is going to

00:48:51,920 --> 00:48:55,880
do is it's going to return the output of

00:48:53,869 --> 00:48:57,650
that page and I'll show you that in a

00:48:55,880 --> 00:48:59,630
second that one isn't pretty that isn't

00:48:57,650 --> 00:49:01,099
very scary and the requirements is sort

00:48:59,630 --> 00:49:02,599
of like what access callback used to be

00:49:01,099 --> 00:49:04,069
right so I'm saying my ax the

00:49:02,599 --> 00:49:07,910
requirements is a permission called

00:49:04,069 --> 00:49:09,920
administer pants everyone cool with that

00:49:07,910 --> 00:49:11,299
one at least in concept will take a look

00:49:09,920 --> 00:49:13,880
at pants controller in a second and that

00:49:11,299 --> 00:49:15,259
will make a little bit more sense okay

00:49:13,880 --> 00:49:18,079
so what about this weird thing alright

00:49:15,259 --> 00:49:20,440
so this one we have a wild card because

00:49:18,079 --> 00:49:23,150
we don't know whose pants were changing

00:49:20,440 --> 00:49:25,700
so comes in as a variable so we put the

00:49:23,150 --> 00:49:28,309
little squiggly brackets around it and

00:49:25,700 --> 00:49:29,390
then I'm giving it a converter so we

00:49:28,309 --> 00:49:31,160
have this thing called a converter so I

00:49:29,390 --> 00:49:33,410
can take that account and i can say that

00:49:31,160 --> 00:49:36,140
account is a user so when an account

00:49:33,410 --> 00:49:38,539
comes in is a one transmogrify that into

00:49:36,140 --> 00:49:40,339
a user object for user ID one so it's

00:49:38,539 --> 00:49:43,400
very similar to the way in Drupal 7 if

00:49:40,339 --> 00:49:46,579
you name an argument percent user it

00:49:43,400 --> 00:49:48,319
knows to call user load on it you guys

00:49:46,579 --> 00:49:50,569
use that before yeah so it's the same

00:49:48,319 --> 00:49:52,880
thing in symfony just what it's called

00:49:50,569 --> 00:49:53,990
the converter which is a little bit more

00:49:52,880 --> 00:49:55,849
straightforward honestly because I've

00:49:53,990 --> 00:49:57,589
tried to explain that weird percent user

00:49:55,849 --> 00:49:59,210
like it magically calls a function

00:49:57,589 --> 00:50:00,890
called thing underscore load and that's

00:49:59,210 --> 00:50:03,470
very confusing to people so at least

00:50:00,890 --> 00:50:05,089
this way not only can you name this

00:50:03,470 --> 00:50:08,440
whatever you want but you can be very

00:50:05,089 --> 00:50:08,440
explicit about what that maps to

00:50:14,710 --> 00:50:19,400
yeah yeah well anything that there is a

00:50:17,390 --> 00:50:20,859
conversion for so I think right now

00:50:19,400 --> 00:50:24,410
there's only converters for entities

00:50:20,859 --> 00:50:25,660
there might be some for like views and

00:50:24,410 --> 00:50:28,010
some other things I'm not really sure

00:50:25,660 --> 00:50:29,480
right like this patch literally just

00:50:28,010 --> 00:50:30,829
went in last week so I've been very busy

00:50:29,480 --> 00:50:33,260
like trying to keep this up with the

00:50:30,829 --> 00:50:34,760
bleeding edge but yeah it's an API and

00:50:33,260 --> 00:50:37,730
you can define additional converters so

00:50:34,760 --> 00:50:40,250
say you and your module had a need to

00:50:37,730 --> 00:50:41,720
convert to a web services call or

00:50:40,250 --> 00:50:43,010
something silly like that you could you

00:50:41,720 --> 00:50:46,549
could define your own converted and just

00:50:43,010 --> 00:50:48,410
reference it here this one uses a

00:50:46,549 --> 00:50:50,030
controller as opposed to eight content

00:50:48,410 --> 00:50:52,460
because this is an AJAX call back and

00:50:50,030 --> 00:50:54,770
it's not actually returning like HTML

00:50:52,460 --> 00:50:57,559
content it's instead returning a JSON

00:50:54,770 --> 00:50:59,150
response and then instead of this being

00:50:57,559 --> 00:51:00,410
done by a permission it's actually done

00:50:59,150 --> 00:51:02,900
by a function because we want to check a

00:51:00,410 --> 00:51:06,140
couple of different things okay does

00:51:02,900 --> 00:51:08,569
that kind of make sense just a scarier

00:51:06,140 --> 00:51:10,220
version of hook menu but honestly like I

00:51:08,569 --> 00:51:12,200
actually like this a lot better because

00:51:10,220 --> 00:51:15,579
it's a lot more straightforward I think

00:51:12,200 --> 00:51:15,579
once you know what all the parts are ya

00:51:21,690 --> 00:51:27,490
right now i believe ya milles the only

00:51:25,210 --> 00:51:28,870
thing we support but that seems like

00:51:27,490 --> 00:51:30,610
something that would be pretty easy that

00:51:28,870 --> 00:51:32,500
we it's really important in core that we

00:51:30,610 --> 00:51:35,920
pick one way to do it because otherwise

00:51:32,500 --> 00:51:38,050
it's going to be a mess and contribute

00:51:35,920 --> 00:51:39,430
any particular like functionality there

00:51:38,050 --> 00:51:42,850
so it should be possible to override it

00:51:39,430 --> 00:51:45,070
to do whatever Symphony can do so that's

00:51:42,850 --> 00:51:46,720
one part of it the other part is this

00:51:45,070 --> 00:51:49,660
magical controller thing that we talked

00:51:46,720 --> 00:51:59,350
about so that one doesn't go in a funny

00:51:49,660 --> 00:52:01,300
directory that's just like here so we

00:51:59,350 --> 00:52:02,830
call in a namespace Drupal pants so that

00:52:01,300 --> 00:52:04,870
we can name it whatever we want or name

00:52:02,830 --> 00:52:06,340
the functions whatever we want we're

00:52:04,870 --> 00:52:07,750
pulling in the user entity because

00:52:06,340 --> 00:52:09,160
remember that was an argument coming

00:52:07,750 --> 00:52:10,570
into the function was the accounts you

00:52:09,160 --> 00:52:13,360
want to change it to a user so we pulled

00:52:10,570 --> 00:52:15,070
a user entity in and then we're using

00:52:13,360 --> 00:52:18,040
the JSON response because that's how we

00:52:15,070 --> 00:52:19,210
output JSON from one of these so the

00:52:18,040 --> 00:52:21,490
settings form is actually really

00:52:19,210 --> 00:52:23,890
straightforward all you do is return

00:52:21,490 --> 00:52:25,210
duplicate form pants settings that's it

00:52:23,890 --> 00:52:26,740
and that's very that's pretty much

00:52:25,210 --> 00:52:28,510
exactly what you would do if you had a

00:52:26,740 --> 00:52:30,730
page callback that return to form so

00:52:28,510 --> 00:52:32,410
this actually isn't that scary I don't

00:52:30,730 --> 00:52:33,610
find any way the scary part is that it's

00:52:32,410 --> 00:52:34,990
in a Lib blah blah blah blah blah blah

00:52:33,610 --> 00:52:36,790
blah and then you have the you know

00:52:34,990 --> 00:52:39,520
thing in a class but once you get there

00:52:36,790 --> 00:52:41,560
is actually pretty straightforward this

00:52:39,520 --> 00:52:42,940
one is a little bit funky but it's still

00:52:41,560 --> 00:52:45,700
pretty much the same you have an

00:52:42,940 --> 00:52:47,290
incoming thing it's a user the entity

00:52:45,700 --> 00:52:49,660
system in Drupal is all object or in and

00:52:47,290 --> 00:52:51,310
that's really nice too I'm going to get

00:52:49,660 --> 00:52:53,410
their status and then I'm going to set

00:52:51,310 --> 00:52:55,540
it and switch it to the whatever it was

00:52:53,410 --> 00:52:57,490
before and then what I'm going to do

00:52:55,540 --> 00:53:00,190
from here is returned a response a JSON

00:52:57,490 --> 00:53:03,340
response from Symphony and so I just

00:53:00,190 --> 00:53:05,230
wrap my theme pants status in there in a

00:53:03,340 --> 00:53:06,580
thing called new JSON response i set a

00:53:05,230 --> 00:53:08,530
header to tell it that it's a type

00:53:06,580 --> 00:53:10,810
application JSON and then I just return

00:53:08,530 --> 00:53:12,250
it which is actually quite a bit better

00:53:10,810 --> 00:53:15,510
than just like killing the entire

00:53:12,250 --> 00:53:17,590
request after the theme function runs so

00:53:15,510 --> 00:53:19,030
but unfortunately making a hello world

00:53:17,590 --> 00:53:21,700
application is a little bit more

00:53:19,030 --> 00:53:23,710
complicated than it used to be so I have

00:53:21,700 --> 00:53:27,010
five minutes so I'm going to close this

00:53:23,710 --> 00:53:30,700
real quick and talk about twig for a

00:53:27,010 --> 00:53:32,740
millisecond so twig is a templating

00:53:30,700 --> 00:53:34,000
language and I can sum it up in one

00:53:32,740 --> 00:53:36,700
slide

00:53:34,000 --> 00:53:38,830
basically this is the new node dot

00:53:36,700 --> 00:53:41,380
actually SAT HTML that twig now as of

00:53:38,830 --> 00:53:44,530
last week again with all these different

00:53:41,380 --> 00:53:45,640
funny characters we're trying to get rid

00:53:44,530 --> 00:53:47,890
of a whole bunch of problems with the

00:53:45,640 --> 00:53:49,030
PHP template system including the fact

00:53:47,890 --> 00:53:50,800
that like you don't know if that's

00:53:49,030 --> 00:53:52,270
attributes arrow class or attributes

00:53:50,800 --> 00:53:54,280
bracketing class or what the hell is

00:53:52,270 --> 00:53:56,980
going on there so in twig it's all just

00:53:54,280 --> 00:53:59,320
attributes dot class it figures that out

00:53:56,980 --> 00:54:01,060
for you it can automatically do

00:53:59,320 --> 00:54:04,270
sanitization of variables you don't need

00:54:01,060 --> 00:54:06,070
to take care of that yourself and all of

00:54:04,270 --> 00:54:07,450
this stuff isn't executable so it's nice

00:54:06,070 --> 00:54:09,220
if you're running some kind of software

00:54:07,450 --> 00:54:10,480
as a service platform with Drupal you

00:54:09,220 --> 00:54:11,560
can give people a lot more control over

00:54:10,480 --> 00:54:15,550
their themes because they can't actually

00:54:11,560 --> 00:54:17,740
embed executable code so there's

00:54:15,550 --> 00:54:19,210
basically three things if you put things

00:54:17,740 --> 00:54:22,600
in double brackets like food out bar

00:54:19,210 --> 00:54:25,600
that means print it if you use little

00:54:22,600 --> 00:54:28,510
percent signs that means it's PHP ish

00:54:25,600 --> 00:54:30,310
stuff so do this logic and then finally

00:54:28,510 --> 00:54:33,010
if you put little hash tags around it

00:54:30,310 --> 00:54:33,940
it's comments and then pretty much you

00:54:33,010 --> 00:54:35,380
can look through any of these and

00:54:33,940 --> 00:54:36,880
there's a huge movement going on in Jen

00:54:35,380 --> 00:54:40,330
is there a sprint going on tomorrow

00:54:36,880 --> 00:54:42,490
around this awesome so if you want to

00:54:40,330 --> 00:54:44,440
clean up Drupal's markup if it drives

00:54:42,490 --> 00:54:46,480
you nuts every single day you should

00:54:44,440 --> 00:54:48,160
totally go to that and they're they're

00:54:46,480 --> 00:54:49,600
basically going through and converting

00:54:48,160 --> 00:54:52,210
all of the templates to this new twig

00:54:49,600 --> 00:55:02,340
system so i can show you that real

00:54:52,210 --> 00:55:06,360
quickly dude

00:55:02,340 --> 00:55:10,740
I have a new templates directory and it

00:55:06,360 --> 00:55:12,780
has two things in there one is pants

00:55:10,740 --> 00:55:14,610
changed block HTML twig and the other

00:55:12,780 --> 00:55:19,380
one is pants status that HTML that twig

00:55:14,610 --> 00:55:23,550
and where these used to come from is in

00:55:19,380 --> 00:55:25,290
my hook theme I had these defined as

00:55:23,550 --> 00:55:27,510
just regular functions that I would like

00:55:25,290 --> 00:55:29,640
pass whatever to but i just added a

00:55:27,510 --> 00:55:31,490
little template index to hook theme to

00:55:29,640 --> 00:55:34,110
say go look in a template file instead

00:55:31,490 --> 00:55:36,420
because with the transition to twig we

00:55:34,110 --> 00:55:38,730
do away with theme functions ideally and

00:55:36,420 --> 00:55:42,390
everything becomes templates I can be

00:55:38,730 --> 00:55:43,890
easily modified by people and so let's

00:55:42,390 --> 00:55:45,330
take a look at one of them just to show

00:55:43,890 --> 00:55:47,970
you what it looks like pants status is

00:55:45,330 --> 00:55:51,390
actually really simple it's just if the

00:55:47,970 --> 00:55:53,850
person has pants say on otherwise say

00:55:51,390 --> 00:55:55,920
off that's it but you can see a little

00:55:53,850 --> 00:55:59,940
bit of like the PHP logic thing

00:55:55,920 --> 00:56:05,340
happening in there the change block is a

00:55:59,940 --> 00:56:07,140
little bit different it has this div

00:56:05,340 --> 00:56:08,940
around it called pant status and then

00:56:07,140 --> 00:56:11,160
I'm just printing pants status and then

00:56:08,940 --> 00:56:14,070
I'm printing a link but where do those

00:56:11,160 --> 00:56:16,080
things come from it's magic I'm just

00:56:14,070 --> 00:56:21,180
kidding where do variables come from in

00:56:16,080 --> 00:56:22,770
Drupal 7 yeah they're passing the theme

00:56:21,180 --> 00:56:25,620
function we can use something called a

00:56:22,770 --> 00:56:27,030
pre process function to say before you

00:56:25,620 --> 00:56:28,560
render this thing out I want to actually

00:56:27,030 --> 00:56:31,050
see what's in it so that's how i did

00:56:28,560 --> 00:56:34,830
this particular one so if i go to

00:56:31,050 --> 00:56:36,810
pre-process i defined a variable called

00:56:34,830 --> 00:56:38,670
pant status which is calling theme pant

00:56:36,810 --> 00:56:40,830
status and i define it a link that's

00:56:38,670 --> 00:56:42,570
calling the l function and the reason i

00:56:40,830 --> 00:56:44,010
did that here and not in the template is

00:56:42,570 --> 00:56:46,140
because i can't execute PHP in the

00:56:44,010 --> 00:56:48,090
template so I prepare the variables in

00:56:46,140 --> 00:56:51,570
pre process and then I just print them

00:56:48,090 --> 00:56:54,030
out when I'm actually my twig file and I

00:56:51,570 --> 00:56:56,780
hope I did that right that's what Fabian

00:56:54,030 --> 00:56:59,010
told me to do so I hope that it's ok

00:56:56,780 --> 00:57:03,720
yeah well this will all change before

00:56:59,010 --> 00:57:08,090
but yeah all right twig yay whoo bracket

00:57:03,720 --> 00:57:12,320
ease let's hear it for bracket ease hey

00:57:08,090 --> 00:57:15,320
briney's ok so finally to wrap this up

00:57:12,320 --> 00:57:18,050
the diff between 70 X and Twitter

00:57:15,320 --> 00:57:20,960
is 11 files change 318 insertions and

00:57:18,050 --> 00:57:22,790
182 deletions if this sounds scary to

00:57:20,960 --> 00:57:25,280
you or if this sounds awesome to view

00:57:22,790 --> 00:57:27,710
now is exactly the right time to jump in

00:57:25,280 --> 00:57:29,810
and help because we still have time

00:57:27,710 --> 00:57:32,000
before july to fix all this stuff and

00:57:29,810 --> 00:57:33,650
change it up and try and reach a balance

00:57:32,000 --> 00:57:35,090
between flexibility and developer

00:57:33,650 --> 00:57:37,310
experience was particular for new people

00:57:35,090 --> 00:57:38,510
coming in so it'd be great to see you go

00:57:37,310 --> 00:57:40,820
through this process with your own

00:57:38,510 --> 00:57:42,770
modules and give usability feedback on

00:57:40,820 --> 00:57:44,540
how Drupal is to work with you because

00:57:42,770 --> 00:57:46,730
we still have a lot of leeway to be able

00:57:44,540 --> 00:57:47,930
to change it right now and now that

00:57:46,730 --> 00:57:49,430
you're all Drupal 8 experts because

00:57:47,930 --> 00:57:50,990
you've been exposed to all the major AP

00:57:49,430 --> 00:57:53,900
is you should totally come to the sprint

00:57:50,990 --> 00:57:55,220
tomorrow which is here in this room if

00:57:53,900 --> 00:57:56,810
you want a community tools workshop

00:57:55,220 --> 00:57:59,000
which you probably don't because I think

00:57:56,810 --> 00:58:00,440
you're a little beyond that or the code

00:57:59,000 --> 00:58:03,620
sprint it selves having centennial which

00:58:00,440 --> 00:58:05,090
is just over that way so that's all I've

00:58:03,620 --> 00:58:07,460
got thank you so much everybody for

00:58:05,090 --> 00:58:08,720
coming and I can take I think I'm off

00:58:07,460 --> 00:58:11,620
the stage now but I can go ahead and

00:58:08,720 --> 00:58:11,620

YouTube URL: https://www.youtube.com/watch?v=mGqK205g7c0


