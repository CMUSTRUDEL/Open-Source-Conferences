Title: DrupalCon London 2011: UPDATES FROM THE DRUPAL 8 INITIATIVE OWNERS
Publication date: 2013-03-23
Playlist: DrupalCon London - August 2011
Description: 
	Problem: 
Updates on current initiatives.

Proposed solution: 
Updates on the Drupal 8 core initiatives:

Configuration Management by Greg Dunlap
Web Services by Larry Garfield
Design by Jeff Burnz
Multilingual by GÃ¡bor Hojtsy
HTML5 by Tim Plunkett
Captions: 
	                              hi thank you all for coming this is the                               first of five status reports from the                               Drupal                                                             Greg Dunlap I'm the Drupal                                 configuration management initiative lead                               I work a node one in Sweden and I also                               helped organize the core conversations                               this year I don't really we have we have                               a long time set aside I think two and a                                half total hours to do all of these                                initiative updates I tried to set a lot                                of time because I assume that there was                                going to be a lot of discussion around                                some of them and I wanted to give                                everyone time to you know collect up                                their rocks and stones to throw but it's                                entirely possible that this won't last                                the entire time and we might be done                                early I don't know we'll just have to                                see how it goes so but we've got a lot                                of time and so if we have questions and                                stuff at the end of them please feel                                free to get them to bring them up yes                                Larry uh he's asking if we can do all                                the presentations back to back and then                                QA I don't really think that's going to                                be necessary or efficient necessarily                                and I don't really have an order in mind                                either I was just going to see who                                happened to make it and then and then                                call them up next but I think all of us                                are here right now too so we'll just                                have to see how it goes so that's me I'm                                hey rock around Twitter and on                                drupal.org so as some background last                                year not last year six months ago in                                drupalcon Chicago I gave a core                                conversation called what's wrong with                                our staging and deployment processes and                                why were why we why our approach why our                                approach decision and deployment is all                                wrong what really well I was really                                happy with it and I outlined all sorts                                of big grand ideas that I had about a                                waste that we could fix this going                                forward and that different that                                differentiated a little bit in a ways                                that I thought that other people were                                doing them and after that drees                                approached me and asked me if i would                                like to run the initiative for that and                                i said to myself oh crap                                because now I've actually got to do all                                this stuff it's easy to stand up here in                                rat and raven front of you guys it's                                actually kind of fun but so I said yes                                and so it's a lesson to anybody who has                                this big idea to do a core conversation                                and try and get a big initiative the off                                the ground i would say this so after                                adrees asked me to do this and i said                                yes and i worked it out with my work to                                get some time to work on it and stuff i                                started doing some research and looking                                into how other systems work and how                                other systems do their deployment                                problems um I posted some of those notes                                but what really came out of that is that                                a lot of the problems we have are unique                                not because we're the only system with                                deployment problems but because almost                                all of the other CMS products on the                                market have have a much much much                                stricter line between content                                configuration than we do I don't think                                this is really you know brain rocket                                science to anybody who's dealt with                                Drupal for a while I was a little                                surprised to find that everybody else                                had really started that way from the                                beginning as a concept I thought I might                                find some other systems that were a                                little more in tune with us but I really                                didn't so what I started putting                                together is what I thought would be a                                workable battle plan for getting this                                stuff going so I wrote that up and                                published it and if you want to see it                                it's it that it's at that URL what it                                really outlined was to main to main tax                                that we are going to approach and one                                was doing a standardized file-based                                configuration system that went over here                                and then doing getting you you IDs in                                the core and improving the any dapi over                                here so that we could do content staging                                and we still had this problem of content                                and configuration and so what I proposed                                was that anything that's an entity                                 should be considered content and                                 anything that's not should be considered                                 configuration this wasn't really a                                 idea that I put forth because I believed                                 in it because I actually believe that a                                 separating cutting configuration is sort                                 of an impossible task at this point a                                 lot of the strengths of Drupal come from                                 the fact that they're so tightly melded                                 together but on the other hand I                                 realized that this is new and it's a                                 learning experience and that actually                                 doing it this way would teach us a lot                                 about our content and our configuration                                 and if we ever wanted to go with a more                                 unified system down the road what we                                 learned from doing this and from where                                 our differences in similarities lie                                 would be would be really helpful since                                 then there have been a lot of talks                                 about moving entities into things that                                 we would probably consider configuration                                 like menu items and content types and                                 stuff like this so I consider this an                                 involving discussion basically but I                                 don't think that necessarily for a lot                                 of our use cases it affects a lot of                                 what we're doing going forward but it's                                 worth continuing to talk and think about                                 and it's an important question so the                                 first pass at this was starting to talk                                 about centralized configuration a lot of                                 this was initiated and based on a core                                 conversation that David Strauss gave in                                 Chicago last year where he proposed that                                 all of our configuration should be done                                 on the filesystem solely on the file                                 system basically what you did in the you                                 I would write two files that lived on                                 the file system where we wouldn't have                                 any database access at all for them and                                 that those files should be stored in a                                 standardized human readable format like                                 Jason we had a code sprint in Denver                                 that's Larry Garfield me checks Angie                                 and David at the Aten design lab offices                                 in Denver and we SAT there and hacked                                 away at thanks for about four days we                                 came up with this idea of doing things                                 in files but also storing them in the                                 database at the same time so you have                                 kind of a two storage system the files                                 would be canonical and the database                                 storage would be the stuff that you                                 access most often it allows us to sort                                 of do one of the things that we were                                 concerned about was the security because                                 we're doing Jason files they're readable                                 by anybody who can browse the inner who                                 can browse to the directory and knows                                 that                                 with the files and so and and but that                                 file directory also has to be world                                 writable so that the Apache can write to                                 it and so we're really concerned about                                 the security of that and we came up with                                 some ideas around that and this to Sage                                 system was also part of that because we                                 were going to key the files and if you                                 could and if you saw that the key was                                 busted that the key was wrong and your                                 data had changed out from underneath you                                 you still had this database storage that                                 you could fall back on it meant your                                 site didn't die if your files were                                 messed up which we thought was important                                 I had some other benefits too but so at                                 the end of that at the end of and this                                 would also be designed to replace what                                 is our variable system now and probably                                 parts or at least some use cases for the                                 system table and some other things and                                 after that was over I posted a ng posted                                 actually we wrote it together a big                                 outline of our proposal for what we were                                 going to do with this and we linked to                                 the to the sandbox where he had written                                 our prototype code and then we opened it                                 up for comments and wow did you guys                                 deliver so a lot of good things came out                                 of that discussion we improve the                                 security model i think we change some of                                 the ways that we were going to store the                                 files because originally to secure them                                 we had kind of we were kind of going to                                 make this bastardized jason PHP formats                                 so that they would still be Jason but                                 they'd be executable so you couldn't                                 read them in blah blah that was an                                 extremely unpopular proposal so we came                                 up with some other alternatives around                                 that and worked with the security team                                 to figure that out and we also started a                                 very very very long discussion about the                                 file formats and what the file format                                 should be and should they be Jason and                                 should they be any files should they be                                 XML blah blah blah went back and forth                                 and back and forth for a long time and                                 finally I posted a thing about two weeks                                 ago where I said I'm going to say we                                 should just use XML and you give me a                                 good reason not to but if I don't get a                                 good reason not to this what we're going                                 to do and I haven't gotten any good                                 reasons not to so I'm gonna say right                                 now this is what we're going to do it's                                 I think it's I think it's I think it's                                 really important                                 that we do that and that we take the API                                 and that we don't bake the eight don't                                 bake XML into the API we should make the                                 XML as agnostic to the file format as                                 possible because we may end up digging                                 ourselves into a hole the file format or                                 making it pluggable later and stuff like                                 that but I think it's really important                                 to make these decisions and move on and                                 one of the things that I haven't really                                 done I think as well as I could in this                                 initiative as time boxing things and                                 saying we're going to talk about this                                 for a week and then we're going to move                                 on a lot of this stuff has dragged on                                 for a while and I beliefs on vacation in                                 the States for for you know I've been                                 I've been I think out of the last three                                 months I've been traveling two and a                                 half of them so you know that hasn't                                 helped anything and stuff either so                                 another thing that came out of a lot of                                 those discussions is that we kind of                                 decided that you know storing storing                                 the files and making the files canonical                                 is is um we could avoid that whole                                 problem if we didn't store the files all                                 the time at all because you know a lot                                 of what our discussions were about was                                 the security issues of having these                                 files sitting on disk and we're going                                 around around around run about this and                                 then somebody I don't remember whose it                                 might have been checks suggested that if                                 we don't store the files all the time at                                 all I mean we're using the seconds the                                 database store almost all the time when                                 we access stuff the only reason we need                                 the files is for if you happen to need                                 to edit one by hand to do overrides or                                 something like that or if you're pushing                                 your deployment so why don't we turn it                                 into the database store is the main                                 thing and and it becomes in their                                 deployments become an export and import                                 operation essentially there was a lot of                                 pop I wasn't a big fan of that but it                                 was very popular and so I think we're                                 going to do that it hasn't been written                                 but that was another change that came                                 out of the discussions from the                                 community after our original proposal                                 did I miss anything there Larry                                 yeah the summary of three long months of                                 our lives so that's sort of where the                                 file based configuration stuff stands                                 right now I think we need to get back to                                 the I think it's really important that                                 we get back to coding and prototyping                                 after a while this talking and                                 discussing I don't want to get into any                                 more analysis paralysis on this at this                                 point and maybe we'll start talking                                 about next steps about that at the code                                 sprint on Friday so that was the first                                 sort of three prongs of my initiative                                 the second prong was actually originally                                 there was a the second prong was that I                                 wanted to get you you ideas worked into                                 core and I wanted to implement them                                 throughout our entity system and Peter                                 Landon came up to me and said it's                                 really dumb for you to do this because                                 we're going to be reworking the entity                                 system anyways and then you should be a                                 waste of time you're just going to end                                 up throwing all that code away and I'm                                 like well who's redoing the entity                                 system somebody is somebody actually                                 doing it I've heard a lot of talk and                                 he's like well I want to do it and I'm                                 like well why don't you come in here and                                 do it with me and then we can turn it                                 into part of the initiative because I                                 need it and you know it's it's something                                 I want to see happen anyways and he said                                 okay so reworking the entity API got                                 moved under the auspices of my                                 initiative as it were I don't really                                 know what that means other than me                                 saying I need this and giving them                                 access to my sandbox to work but Peter                                 and Fargo and catch have been working on                                 that mostly their main first task is to                                 move the stuff in any light ink into a                                 proper module and then to build a crud a                                 peon                                 hello Cleveland so um and then building                                 a proper credai on top of it which we                                 don't really have I think that's really                                 important it enables a lot of a lot of                                 it opens the way for us to do a lot of                                 stuff with entities even outside of my                                 initiative and it will it will give us                                 it will give us a pathway towards proper                                 content import/export for maybe the                                 first time in our entire lives if                                 anybody saw Damien score conversation                                 about document-oriented storage                                 yesterday it would it would start                                 opening up a pathway for us to build                                 that underneath entities so outside of                                 my initiative or anything it's this is                                 good thing and so Peter and fog are                                 having a core conversation tomorrow at                                 eleven about this if anybody wants to                                 come this first link here is a pointer                                 to the issue that they have in the queue                                 about moving entities onto a module                                 what's the status of that issue right                                 now needs review so get on it people and                                 then that second link is a link to notes                                 from a buff that they ran about entities                                 in the path forward for entities at your                                 pecan Chicago if anybody's really                                 interested in the ideas that other                                 people have about what where the entity                                 should go forward so the last part of                                 this is the content staging thing in                                 some ways this is the easiest part of it                                 because nobody cares about this but me                                 um and so I can just do all this work                                 and nobody hassles me about it which is                                 great but um the basic plan for this is                                 that whenever there are two really big                                 problems that we have with content                                 staging right now one is that because                                 we're using Siri because we're using the                                 serialized IDs in the auto inc IDs in                                 the databases we have no control over                                 what they are and they shift from server                                 to server and so it's impossible                                 uniquely identify content the second                                 problem is that the way that drupal's                                 api's are now especially the way that                                 they're so tied into form API it's                                 extremely difficult to save to save                                 nodes or any other content in a                                 reasonable way and entities we're a step                                 forward with that but because the API                                 never really got                                 finished it's still not really there for                                 drupal                                                                  content staging was if we get you I                                 decent a proper in the API then even if                                 we don't build any content staging into                                 Drupal itself we've we've got a big win                                 and if that falls out to contribute late                                 and we never do anything more that i                                 think i'm pretty happy actually so the                                 first patch for you you IDs in core is                                 in is in the queue right now it was                                 written by dick Olson who's working                                 right now in Qatar for Al Jazeera and                                 it's really just an API patch it just                                 introduces a bunch of functions that                                 will need to do you IDs in core the next                                 steps and that will be that once the                                 entity API stuff is finished that we                                 start working the generation and saving                                 and retrieval of those uu IDs into the                                 API and then and then we decide what                                 we're going to do with it which is a                                 whole nother question needs to talk                                 about use cases and user stories and do                                 we how much of this do we want to bake                                 into Drupal as a release and how much do                                 we want to leave to contribute stuff                                 like that which is discussion we haven't                                 even started but my outline for getting                                 all of this done and my steps and plan                                 for it is it that node right there and                                 so that's really where that aspect of                                 the initiative is at at this point so                                 what are some problems that we've had as                                 we've been moving forward discussions                                 are hard and so one of one of the                                 problems with the discussions that we've                                 been having and we've talked about it a                                 lot among the initiative owners is that                                 our tools for having discussions on                                 drupal.org infrastructure are really                                 really poor we have issue queues which                                 some people say is where all the                                 discussions should happen but anybody                                 who's followed along meta issue in the                                 issue queues knows how horrifying that                                 is it's really good for jumping to the                                 end and seeing what the most recent                                 comments are and stuff but it's really                                 hard to follow the context of a                                 conversation through it on the other                                 hand we have GD                                                         ways also but some people hate threaded                                 comments and it's really hard to in both                                 of these cases to kind of tie a bunch of                                 topics to get                                 there for instance when we made our                                 first blog post about the overarching                                 proposal we had I got                                                  I'm like oh this is too much and so I                                 start breaking out into sub topics and                                 subjects but then what would happen is                                 people would jump into those sub                                 discussions without any of the                                 overarching context that we provided in                                 the first post and they're making these                                 comments where they don't understand                                 what we're getting into and what our                                 priorities are and stuff like this and I                                 don't have a really good answer for how                                 to manage that at this point I think                                 it'll be easier when we get to coding                                 because that's the way that we're all                                 used to working and we're all used to                                 working in the issue accuse and you know                                 in the past even when we've done big                                 architectural changes I don't think                                 we've really tried to open them up to                                 community input so much as I'm trying to                                 do here cuz I think it's really                                 important you know a lot of people                                 complained that when the field API was                                 designed that it was kind of five guys                                 in a smoke-filled room and they came out                                 with this proposal and anyone who didn't                                 give apropos anyone who didn't agree it                                 was kind of like well that's too bad                                 that's what we decided it didn't really                                 happen that way but that was the                                 impression that people had and so I was                                 really focused and I made clear to trees                                 that I didn't want anybody to come out                                 of this process feeling that way of                                 course now I'm feeling that the pain and                                 kind of and you know kind of like why                                 don't we all just go off in a                                 smoke-filled room and figure this out so                                 I think I still think it's really                                 important but I need to figure out a way                                 to have these discussions to have the                                 context and to get everything together                                 and keep them focused in all of this and                                 its really and it's and I'm still trying                                 to figure that out and it's hard for me                                 because I live across the sea from where                                 almost everybody who's commenting on                                 these issues live and it's nice that I                                 have people like Larry and David to keep                                 a track on of them on North American                                 time and stuff like that but still                                 that's something i'm still trying to                                 store down they one thing that's really                                 important that i haven't been doing is I                                 haven't been time boxing the discussions                                 very well so they just sort of go on and                                 on and on and on and you know I think I                                 think it's really important to open them                                 up to more of like a we're going to                                 discuss this for a week and then we're                                 going to make a decision and then we're                                 going to move forward and that leads to                                 sort of that I need to be quicker on the                                 trigger about decisions and you know and                                 push things for this is a really new                                 kind of role for me                                 and you know even when I've done core                                 development in the past it's been really                                 kind of high-impact easy win stuff a lot                                 of documentation API changes and easy                                 bugs and stuff like that so my                                 experience with the core development and                                 the team's isn't the same as a lot of                                 other people's and I don't have a lot of                                 this you know can't hurting experience                                 and so I'm trying to grow into this too                                 and I think I think I think things will                                 be better going forward and I credit web                                 chick a lot for helping me out and I've                                 been really appreciative of that so next                                 steps we need to code we need to start                                 coding I think that's really important I                                 think that's what people in the core                                 development team want to see they want                                 to see actual stuff happening and so I                                 think it's really important that we                                 start doing that so my first step will                                 be to start updating our sandbox code                                 from the code sprint with the results of                                 the discussions that we had on GD                                       then once we've done that we can start                                 once that API is finished and                                 everybody's happy with it we can start                                 actually going in and starting to                                 replace some of the stuff from variables                                 tables trying to see if we can implement                                 field configuration with this system                                 trying to rewrite system settings form                                 to use it and things like that and I                                 think that'll really teach us a lot is                                 when we start getting into those                                 implementations we need to keep for                                 moving forward on the uuid and entity                                 work and that's still happening and                                 that's and that's all good and we just                                 need to keep talking and pushing forward                                 we need to talk and push forward both we                                 can't just talk and we can't just go                                 there's a right balance we really need                                 to find and I don't think we found it                                 yet but I think it's important to keep                                 trying to figure that out this is not                                 the same slide and that's all i've got                                 to say and now i will open the floor to                                 questions from the audience yes Jennifer                                 the question is are you planning on                                 having the revisions as well as the base                                 entities have you you IDs um I've seen                                 some of the discussions around that and                                 I haven't really thought it through                                 myself but my initial my initial                                 response is I think that's probably a                                 good idea though so but I mean obviously                                 we'll turn it on why not so I'm thinking                                 about the help system that we're                                 thinking about for Drupal                                             where we would be probably importing and                                 help documents from a centralized help                                 server or maybe multiple centralized                                 help server and you could conceivably                                 revise it on your own site and then want                                 to know whether you should pull in the                                 next revision from the other site and                                 you kind of want to have a uuid on the                                 revision so you can tell where you are                                 in the revision cycle or something like                                 that um all right I you know I use you                                 know the more I think about it the                                 harder I find it to believe that we                                 wouldn't put uuid some revisions but I                                 mean it's something we have to talk                                 through to yes                                 the question was wouldn't it be better                                 to store the you IDs in the database as                                 binary instead of text I would have to                                 think about the pros and cons of that I                                 suspect Larry has an opinion about that                                 which were not by the way I didn't                                 mention that here but we're not we're                                 not planning on we're planning on                                 keeping the auto increment primary keys                                 the UU IDs will just lay next to them                                 because the process of converting to uid                                 primary keys has a mental performance                                 impact and as an upgrade path thing oh                                 my god it makes me want to shoot myself                                 so I mean that's that's our plan so                                 anyways good yes please                                 um anybody else really man I expected                                 lots of rocks all right well thanks                                 which of the initiative owners Larry                                 okay I think we can get started so this                                 is update number two this is for the web                                 services and context core initiative one                                 of the more verbose lee named                                 initiatives we have I'm Larry Garfield                                 or krill senior architect with palantir                                 Nets various other things I'm not                                 listing here and yet really mean with a                                 nerf gun and can record over here can                                 verify that so we're talking about the                                 web services and context co initiative                                 or whiskey so named because I like funny                                 acronyms that's all you know I'm an                                 open-source geek so a bit of background                                 back in                                                                 Lisa Reichelt Earl miles made the                                 comment that Drupal doesn't have                                 multiple layouts it has one layout that                                 it bends a lot and its really                                 unfortunately said that because it got                                 me thinking and that's never a good                                 thing I'm thinking okay just what could                                 we do to give Jubal multiple layouts and                                 nothing else you know make life easier                                 for designers and I thought this through                                 and then came up with a presentation at                                 the developer summit at drupalcon San                                 Francisco she's like the precursor of                                 the core conversations in which I                                 basically laid out this is what our page                                 layout system looks like now you have                                 main content area and then these block                                 regions on the side and these blocks                                 that know nothing about anything and if                                 you want to do anything that doesn't                                 look like this you're kind of screwed                                 and you know your options are half the                                 template deplete two pieces or use                                 panels and what we really want to do on                                 the front end is something that looks                                 more like this                                 where you have requests come in we build                                 up some more intelligent metadata based                                 on that that's we call context as in the                                 more robust definition of the request                                 pass that to a display controller which                                 then gets rendered into this one big                                 region inside of which our region's                                 inside of which are regions inside of                                 which are blocks and you just keep                                 passing this information down the idea                                 here is each of these blocks can be                                 rendered independently of each other you                                 can lay them out independently of each                                 other you can have complex layouts like                                 this you can change the context                                 information at this point going from one                                 layer to the next and basically if any                                 of you are looking at this and saying                                 wow this looks familiar that's because                                 this is pretty much the conceptual logic                                 behind panels you arrived at it by                                 different paths but it's essentially the                                 same concept and we identified five                                 basic things in Drupal that make it                                 impossible to do this in court right now                                 the fact that we have no unified context                                 system we have you know a half dozen                                 correction several dozen different                                 functions that work differently and some                                 Global's that you can't really override                                 without breaking things we only have the                                 ability to support one layout there's no                                 way to define multiple layouts we have                                 no good system for defining swappable                                 components we have a one-off thing for                                 blocks that sucks we have one off thing                                 for page callbacks which sucks we have a                                 one off thing for input formats or text                                 filters which sucks continue on down the                                 line the entire system assumes you're                                 returning an HTML page and even just                                 returning HTML fragment requires                                 essentially hacking around the menu                                 system and of course your performance is                                 a problem because of how much work we're                                 doing as a result of all this so this                                 gave birth in San Francisco to the                                 butler project which was basically in                                 order to solve this layout problem we                                 have to solve all these other problems                                 first                                 overall idea is to give Drupal a unified                                 powerful context system that supports                                 smarter block centric layouts using a                                 common plug-in mechanism that's a                                 mouthful and a lot of discussions                                 happened on this summer of last year                                 that kind of focused into a presentation                                 i gave it at through pecan copenhagen                                 which unfortunately was not recorded                                 because of a technical glitch but that's                                 basically you know refining this idea                                 and then find a bit more and saying some                                 code is written by Kubek on Chicago                                 where I gave ass actually earlier                                 version of this talk at the core                                 conversation track there and then drees                                 came up and said hey Larry this sounds                                 like could be useful for web services                                 you want to lead a core initiative and                                 much like Greg I'm like yes crap yeah I                                 can graduate Dolan says that's that's                                 how everything in core works so the                                 basic idea of the web service initiative                                 is more or less the same thing which is                                 we want to transform Drupal from being a                                 CMS into a rest server that happens to                                 have a damn good CMS on top of it and to                                 do that we have to do all the stuff                                 Butler was talking about so it part of                                 the challenge with Drupal right now is                                 that making our layout system not suck                                 requires a revamp rewriting our routing                                 mechanism to be a rest router because                                 those overlaps so much in core that we                                 can't do one without the other so let's                                 just solve both problems in particular                                 break it up into four pieces because                                 that's a big mouthful we're on a unified                                 powerful context system so that all                                 incoming information we access to a                                 single channel we get rid of our                                 Global's we get rid of dollar underscore                                 get dollar post all of this information                                 handle in a consistent fashion and we                                 can then use that to build a really                                 powerful in core plug-in system make                                 more things swappable in the same way                                 rather than making them swappable in a                                 different way for every single system we                                 run across                                 with those two tools we can then build a                                 much better router in core essentially a                                 replacement for hook menu that can deal                                 with the fact that not everything is an                                 HTTP GET request for a full HTML page                                 for a desktop browser within three years                                 that will be the minority of traffic on                                 the web let that sink in within three                                 years requesting a full HTML page for                                 dust cup browser will be a minority of                                 the web and then you know build these                                 smart block centric panels like layouts                                 that give us real a great deal more                                 flexibility on the design level more                                 flexibility in terms of caching pages                                 for better for performance because we                                 can partially cache based on the blocks                                 you replace the entire stack there                                 because we can't change one part of                                 Earth are changing the others so since                                 Chicago has been a ton of discussion and                                 basically everything Greg just said                                 about the challenges of doing                                 architecture in the open like that apply                                 here too so what he said there have been                                 a lot of very long threads that suck                                 your soul but need to happen anyway okay                                 but we do have a viable plan moving                                 forward at this point that we are                                 starting to work on step zero geeks like                                 star                                                                 HTTP right now we're way of handling an                                 incoming HTTP request is global dollar                                 get which we overwrite portions of                                 before Drupal even finishes booting up                                 which is already doing something bad we                                 kind of wrap dollar posts in the forum                                 system but only in the forum system if                                 you're doing non form stuff with posts                                 then you kind of are on your own and any                                 information that you derive off of that                                 even like what type of request this is                                 does the browser want JavaScript back                                 does it want HTML back we have no common                                 way of tracking that so rather than                                 write our own complete wrapper layer for                                 incoming HTTP requests there are lots of                                 them out there so we first spent some                                 time looking at the pec                                 module                                                               came to the conclusion we can't require                                 that to be installed on the server                                 porting it to user space would be way                                 too much work and probably wouldn't work                                 anyway so let's not do that so then we                                 started saying okay need to find a good                                 third party library here and Dave Hall                                 and dick Olsen our other view here okay                                 they did some excellent what's that okay                                 well I know dicks around here somewhere                                 but they did some really great research                                 for us looking at the HTTP libraries                                 inside the zend framework and inside                                 symfony                                                               component frameworks very modern freshly                                 rewritten so they've done an awful lot                                 of work that but then we don't have to                                 do and say okay can we piggyback off of                                 them in a good open source fashion and                                 their research is posted here these                                 slides will be online so you don't need                                 to write that down and contrary to all                                 of the threads that came before it the                                 conclusion that pretty much everyone in                                 thread drew was symphony so we want to                                 use the symphony to HTTP library for                                 handling incoming requests and that's                                 our level zero so hopefully this is the                                 start of you know our projects working                                 together more I let you decide which is                                 the mouse which is the cat mostly I just                                 want them to excuse to use this slide                                 and as of last night at                                                me that T's ok with doing this so I'm                                 going to be writing the patch for this                                 very soon to just drop in portions of                                 symfony                                                                now my hope is that juries was awake                                 enough at                                                              this yes Jen yeah yeah the question is                                 is this the first time we've done this                                 no there have been other examples but                                 it's not something we do often so it is                                 I made your event but the fact we got it                                 approved yesterday is means we can move                                 forward with that then step one is a                                 unified context system that's where most                                 of the work has been done we actually                                 developed an API for the most part back                                 in Copenhagen so that's now a year ago                                 it's based on the on a mediator object                                 that a butler object essentially the                                 idea being that when you want                                 information about the request which                                 includes information that derives from                                 the request like what's the current node                                 being requested you don't check that                                 directly you instead ask this common                                 broker okay what is the current node and                                 it will tell you or it can lie to you if                                 you want to you know do fancy caching                                 you can encapsulate your plug in your                                 block your whatever very well that makes                                 it unit testable that makes it easy to                                 cash it independently the rest of the                                 page it means you can do an ah-ha                                 request you can do ESI caching all kinds                                 of fun stuff basic idea you know some                                 piece of code ask this Butler objects                                 this context object you know what is the                                 value of this HTTP property what is the                                 currently active node what is the                                 current user so global user goes away                                 and gets replaced with you know some                                 handler that were just returns that                                 context information that you can use a                                 work in progress on this in a project                                 currently this is a Drupal                                               it's not like there's a difference                                 between that and Drupal                                                 and hopefully by the end of the week                                 I'll have this in a sandbox a core                                 sandbox                                 basic API if you have a class then you                                 get a context object passed into you and                                 you say that when you want to say what's                                 my current you know what's the current                                 node you access it that way what's the                                 value of this get variable you use this                                 colon delimited format which means you                                 can assign a single handler right here                                 and then you know one context handler                                 that handles all of those requests and                                 this is the only way that you access                                 this information you do not ever touch                                 dollar get directly you do not ever                                 touch global user it goes away you do                                 not ever touch global language that goes                                 away everything is accessed through this                                 context object and if you're in                                 procedural code then you have this                                 drupal get context function that gets                                 you the topmost object context object                                 you can register a new handler this way                                 so when you get this request this is the                                 class that handles it here's some                                 configuration information I'm just going                                 to let's pass this one important factor                                 it is over rideable so you can say okay                                 you know just I got this object add a                                 new layer now I've got a new context                                 object i'm going to set some additional                                 configuration of that block it and then                                 pass that along so now this code here or                                 whatever is happening inside there does                                 not know anything about this object all                                 it knows is your overridden form here                                 this is a very good thing because it                                 allows you to segment parts of the                                 system it allows you to pull pieces                                 apart by going through this mediator in                                 between we can unit test things we can                                 you know like I was saying before we can                                 ESI cash this way because you can fake                                 this out very very easily current status                                 and that there's one patch left that I                                 want to get committed before we can                                 start implementing it in court to see                                 what happens I'm going to try and get                                 that committed tonight I need to review                                 it actually two possible implementations                                 of that my my plan is if I can get that                                 in and got a sandbox going by friday                                 then come on Friday we can just start                                 influencing this in core see how far we                                 can get replacing global user                                 see how far we can get replacing global                                 language and figure out these problems                                 there where the gap still are and                                 hopefully get something going that we                                 can have drees push back into core and                                 get really get rolling in Drupal                                      least that's the plan so who's going to                                 come on Friday and help with that                                 awesome i'll see you there phase two                                 plugins yeah we've got way too many of                                 them let's unify this crap basic logic                                 we're looking at here you know you have                                 a plug-in type your various plugins that                                 conform to that type and then when you                                 want to use it you have some                                 configuration and some context the                                 current context object combine those you                                 get a plugin object and you can just use                                 that and this works for all kinds of                                 things this like the canonical example                                 would be the cash system so you've got                                 cash interface an actual PHP interface                                 language construct different possible                                 implementations of it if configuration                                 and then you just go use that object                                 cash in / formats sessions you know all                                 kinds of things that entity backends all                                 right entity storage backends I've been                                 talking to if shed mwah he really wants                                 to use the system to clean up the API                                 for for matters and widgets and fields                                 in Drupal so all of these things                                 hopefully we can get working on the same                                 interface aim architecture we all did                                 some research here as well we looked at                                 Symphony tues plugin framework Zen                                 frameworks and cojas and basic                                 conclusion was none of them were doing                                 anything even close to the level of                                 complexity be needed in fact the closest                                 system conceptually is our own see tools                                 module so thank you see tools team okay                                 so the current plan there is essentially                                 a cleaned-up purely object-oriented                                 version of c tools plugins that we slide                                 into core there's actually two different                                 implementations right now that we've put                                 together just kind of as experimental                                 work one I wrote a while back one Nick                                 lindell has been                                 hang on and honestly they're about                                     the same thing give or take some                                 terminology there they're very very                                 close I don't have the sandbox URLs off                                 available off it's not my head                                 unfortunately but we're sitting on that                                 for the moment and we come back to it                                 after we get the context in course we                                 can really get rolling with that but I'm                                 hoping that we can just build off of one                                 of those two approaches and just roll                                 with that and once we have that built                                 then we can start the fun stuff which is                                 using these plugins in this context                                 information to do real web server                                 routing to actually use HTTP properly                                 unlike most PHP frameworks current plan                                 based on conversation we had here is a                                 two-layer approach so currently request                                 comes in all we match it against is the                                 path and that's yet and we pass it off                                 to a function instead we match it                                 against as much information out of the                                 HTTP request itself as we can which is                                 the method I forgot a comma comma there                                 they path the domain and the content                                 type that is like this is a get request                                 or a post request or a delete request to                                 this domain or to any domain this path                                 and the browser is requesting type / j                                 text / jason or text HTML or application                                 PDF and we can then return a true HTTP                                                                                                         hacking our way around it or a true you                                  know moved there's a ton of information                                  in HTTP in that spec that we're not                                  using that if we really want to be                                  serious about web services we really                                  want to be serious about mobile we have                                  to use this lets us handle all of that                                  stuff in a clean fashion rather than                                  just hacking around a page system again                                  lots more detail here I encourage you                                  look at that oh yeah and other stuff                                  like no type is a secondary layer that                                  we haven't figured out the details on                                  yet yes Peter                                  because you we want that router to be                                  swappable we also want you know what                                  this is going to map to is a configured                                  plug-in object that is that display                                  controller this is again very similar to                                  the way panels works conceptually where                                  you know what you get back from here is                                  not name of function it's a knob name of                                  an object or class and configuration and                                  that's plug-in based so it's used that                                  same consistent API is everything else                                  architecture wise we're already starting                                  to work on this you know if you want to                                  help with this this is probably the best                                  place to join in the discussion right                                  now but a lot of it is we're going to                                  need some of this functionality anyway                                  so might as well again use a single                                  system for it answer your question                                  portions of it we might be able to yes                                  some parts possibly we definitely need                                  to context part for its and software                                  we'd be getting this information yeah I                                  at the moment I'm not sure yet how much                                  of this system is going to technically                                  be a plug-in that's a good conversation                                  we still need to have so let's start a                                  thread on that one actually check this                                  group we actually do have some                                  discussion there at the moment but                                  that's an open question frankly so parts                                  of this may not need plugins you're                                  right and finally I get onto the smart                                  block layout which is essentially panels                                  in core so number three is services in                                  core step forward panels in core at the                                  you know                                                                  we've not done a great deal here yet                                  because there's a lot of work left to do                                  other than try and figure out okay the                                  biggest problem with panels is that the                                  UI is way too complicated for mere                                  mortals to use people in here can figure                                  it out but most people can't wrap their                                  head around it so we're trying to figure                                  out so for the record Sam Boyer can                                  figure it out but i did say mere mortals                                  so yeah we're trying to figure out what                                  a better you i would be                                  or a layout mechanism that is all panels                                  based that people can actually                                  understand and so began and yo Roy have                                  been helping out there to figure out                                  okay let's think this thing through                                  there's still a lot of work to be done                                  here so if you're interested in UX if                                  you interested in figuring out how to                                  make a UI for all of this stuff that                                  doesn't suck talk to me talk to Bo and                                  talk to your ROI is your hear your war                                  is not here so talk to either Boyan our                                  I I joining this group is a lot of                                  discussion there and this is still a                                  ways away in terms of implementation but                                  we're going to need that long to figure                                  out the UI because we have to get that                                  right so next steps at this point Friday                                  code sprint let's try and get some                                  forward motion on context so you can                                  jump start the actual code writing if                                  you want to follow the discussions we're                                  having that groups of drupal org slash                                  whiskey wscc I if you just want to keep                                  tabs on what's going on there is a                                  tracking issue on Drupal at org is the                                  need for it we're not discussing                                  anything there it's just status updates                                  if you want to get pinged when something                                  major happens i'll be posting comments                                  there otherwise almost everything in                                  that thread is is someone saying                                  subscribe so feel free to add more I'm                                  encouraging people to say +                                             on that issue and that issue alone and                                  that's it questions no one has any                                  questions there's a question                                  the question is if the router is always                                  mapping to a response object that mean                                  that every module has to have                                           and stare for more complex two answers                                  that one first half I'm not sure yet if                                  that means that every page call back                                  turns into a new class it may be that                                  there's still a function and there's a                                  common class for the configuration is                                  sub call to this other function for the                                  body we don't know yet that's still a                                  very open question to the second                                  question and it does you know that means                                  it has a class in it and therefore it's                                  more complex something having a class in                                  it does not make it inherently more                                  complex half the time it makes a                                  ten-time simpler other questions yeah                                  you use what hmm okay I so the question                                  is does you can basically this on HTTP                                  make it harder to do command line stuff                                  like Josh actually no because if all                                  Drupal code is accessing that HTTP                                  information through this context object                                  then it becomes trivial Ford rush to                                  have its own context object that mocks                                  all of that information that's relevant                                  or has its own information so everything                                  we're doing here is viable for drush and                                  hopefully josh can actually simplify a                                  great deal by building off of that same                                  very low level it's kind of in an ideal                                  pony corn world drush and drupal and the                                  drupal installer and the ripple updater                                  are through are all different                                  applications built on top of this core                                  framework I don't want the proxy get to                                  that point but that's kind of the mystic                                  goal that we're trying to push towards                                  conceptually other questions all right                                  then I'll see you all on Friday and                                  stick around for who's next Gabbar the                                  ground for gabbar who's gonna be talking                                  about internationalization                                  and what we're doing in Drupal                                        that                                  so this is my update from the Drupal                                    multilingual initiative I'm Gabbar Ho                                  Chi and I was relatively recently named                                  an initiative lead for this project                                  after Larry and Greg and the way I                                  wanted to start this is to look at what                                  what's really the goal of what we want                                  to support in Drupal and the the most                                  basic basic thing where a language comes                                  into play interval is if you want to                                  build a foreign language site so as long                                  as you want to do an english-language                                  site is intended by the Drupal                                  developers with the original English                                  text you don't need to care about                                  language if you want to do a foreign                                  language site which can be an                                  english-language site with different                                  text in English but with like different                                  verdict then this is the foreign                                  language Senate you want to build and                                  what we need to have there is we need to                                  know the language you are building the                                  site in so we have language information                                  on what you're actually working with and                                  because the built in code indra voice is                                  all in English we also need to support                                  translating that built in code built in                                  you I to a different language if the                                  different language is just like                                  different verdict in English it's from                                  our perspective is still a different                                  language so that's that's about it for a                                  fun language site okay so if you want to                                  build like a German site on you and it's                                  purely German there's nothing else in                                  there everything's in German then we                                  need to know it's in German and we need                                  to let you translate everything in the                                  code that was in English to German and                                  all the rest of the site the views the                                  menus the blocks everything you built in                                  so you can put in German there's no need                                  to to to do anything with that it's a                                  single foreign language site but when                                  multiple languages come into play                                  there's other things to consider so we                                  need to expend the set of languages with                                  support so now we have multiple                                  languages which means we need to be able                                  to select from them we need to be able                                  to to know in this request which                                  language we use or in this part of the                                  week                                  which language we use and that ties in a                                  lot with the context initiative we have                                  there and also that's kind of an                                  interesting work anyway so we we need to                                  we need to know which language we have                                  and we need to be able to select from                                  that language and in Drupal                                            multiple types of languages i'm not sure                                  you're aware but we have content                                  language we have user interface language                                  and we have um and these can be three                                  different languages in Drupal                                             people know that but there's how it is                                  and that's a multilingual sites so if                                  you have a multilingual site that is a                                  blog and your post in German and you                                  post in English and you never translate                                  to another language then you don't need                                  to have translation support you just                                  need to have you just need to label your                                  stuff with different languages ok so we                                  need to know which part of your site is                                  in which language but we don't care                                  about it translating all those if you                                  need translation so you need to actually                                  relate different things together then                                  translation comes into play so in that                                  case we need to relate different data                                  objects together based on their relation                                  through the language so this is a                                  relation problem we have different data                                  elements and we need to relate them                                  based on they are at the translation of                                  the same thing so that is the concept                                  there so those are the main things that                                  we need to care about we need to know                                  the language of everything we need to                                  let you translate the UI we need to be                                  able to select from available data based                                  on your criteria and we need to be able                                  to support translation on a fully fully                                  multilingual site with translation so we                                  don't have a lot of that in court                                  unfortunately what we have is we have                                  languages we have you act translation we                                  have no language support in Drupal                                    with no translation we have support for                                  pet we have support for path aliases                                  kind of interestingly and we have a very                                  a very broken system for configuration                                  translation and we'll talk a little bit                                  about that later in Drupal                                             added on with field translation with                                  date format language support and with                                  common language support now you might                                  notice when you actually build Drupal                                  websites these are just like the very                                  very basic pieces that you work for                                  right so there's a lot of things you                                  built on websites that don't have any                                  language support so we have blocks we                                  have menus you have all kinds of                                  configuration like views your site name                                  your rules your panels your everything                                  and I just hold above before this                                  session on a multilingual problem                                  sharing and prominent use case                                  discussions and we felt like an                                  interesting question how you translate a                                  panel and the answer was you kind of use                                  a view because that supports translation                                  better and you use vuze to provide the                                  data for the pedal pains and you know so                                  so one of the problems is we don't have                                  any language information of that and the                                  second problem is you don't have any                                  translation support for that in core so                                  internationalization model tries to plug                                  in these holes by trainer provide some                                  language information trying to provide                                  some translation support but the the                                  most important problem is that there for                                  a lot of things we download the language                                  so when you start off with the site you                                  put in the site name you create three                                  views and we don't know the language                                  those were created and if you change the                                  site language it's going to break and we                                  don't have any language base selection                                  and displays one of the most requested                                  things it's like I've installed this                                  site I've I did content translation and                                  my homepage is showing every language                                  like yes that's how it works there's no                                  selection there so let's see content as                                  a that's the most important part I I                                  made up like a                                                          I'm trying to do a very short summary of                                  that here so i apologize for anybody who                                  have seen this but i think anybody                                  remember seeing this video that i put up                                  with these images not a lot of people                                  okay so                                  so just so you know the the what what                                  what's our way for content translation                                  is the most important part in my                                  initiative so we have Drupal                                         local support which means that when you                                  have a node with all their properties                                  what we do is that we tack on language                                  information in the note so we know it's                                  in German it's in English it's in French                                  and we have content translation which                                  means that we have that node with                                  language information and we relate other                                  nodes in other languages to that node                                  and for this relation set we call it a                                  translation set and we say this these                                  three nodes are translations of the same                                  thing and we kind of have a source note                                  there that is the source data and                                  there's those translations of that node                                  so we have a translation set of nodes ok                                  that was in Drupal                                                  translation that's a very good model for                                  a lot of reasons so for example you want                                  you have this node and you have copies                                  for this note for translation so you                                  have different copies of the nodes for                                  for these nodes all of those notes can                                  have different authors so all of those                                  nodes can have different permissions in                                  a workflow setting if you run with with                                  workbench module you can put in those                                  nodes in two different queues for                                  different people and then you can you                                  can work with like these single single                                  objects and the permissions are handled                                  separately the attributions handled                                  separately they have different status                                  field so you can have different workflow                                  in the European Union there's a                                  requirement to post when you like                                  posting official documents they need to                                  be available in certain set of languages                                  and and until the olders are available                                  they should be posted so you set up a                                  workflow you're waiting for all those                                  languages to be available before they                                  are posted they can have different                                  status than the rest of the languages                                  which are still waiting to be translated                                  that are not required for the initial                                  post these have separate menu items so                                  if you want to have language dependent                                  menus like different menu trees for                                  different languages then you can do this                                  okay so it's a very good model for these                                  reasons the problem                                  is that you have these different copies                                  of the nodes and there's a lot of things                                  that relate to notes like signups like                                  organic group memberships like votes                                  five-star whatever so a lot of things                                  relate to nodes and they say I vote for                                  this node or i'm a member of this node                                  or I sign up for this note or i buy this                                  node and if we have a translation step                                  the module that implements group                                  membership or sign up or votes they need                                  to be a very few either becoming a                                  member of a note or a translation set                                  and that's not actually happening in                                  fact there's also fields which which                                  carry a lot of data or or can be painful                                  to be duplicated in these different                                  copies so the problem is that you have                                  your source node and different copies of                                  the node and if you have an image feel                                  like a product node like on a product                                  node then those need to be duplicated or                                  if you have a product price there isn't                                  it to be duplicated so this is kind of a                                  problem so Drupal                                                     translation which solve this issue by                                  putting translation under the node okay                                  so they put in the different they put in                                  translation for fields so you can keep                                  the prize feel than the image field as                                  undetermined undetermined language and                                  you can translate the body or custom                                  field your title of course title didn't                                  actually happen unfortunately he was                                  removed so tuple course nature is that                                  sometimes stuff get added and then get                                  removed that's how it went so title is                                  not a field it's not possible to                                  translate it this way but a lot of the                                  other things are so this is very good                                  because the body field is right there in                                  core you can translate it and there's                                  all kinds of stuff you can do you can                                  add the custom field you can add an                                  image folder it's not translatable etc                                  so you can decide on the field by field                                  basis on what you want to translate and                                  you don't need to copy that day or                                  elsewhere and what's also very good is                                  that all those all those relations will                                  work because your sign ups will just                                  work with the node your organic                                  we'll just work with the entity until                                  the five star will just work with the                                  entity so everything will work nice okay                                  so this is very good however there's all                                  these problems with the same things like                                  what if you want to actually store votes                                  per language like you're interested in                                  whether the English audience voted for                                  this better or the French that's kind of                                  not in there unless they know the                                  language under the node same thing goes                                  for author it's not a field so you                                  cannot make it translatable it goes with                                  with the permission associated with the                                  author you cannot make the different                                  translations be available on the                                  different permissions because it's not a                                  field it's not translatable it has one                                  author and they have the permission same                                  goes for status same goes for menu item                                  relations so all the things that are not                                  fields now are a problem because because                                  you cannot make them translatable so we                                  have these two models and we both we                                  have both of them in Drupal                                               have the node relational model it's in                                  implementing the content translation                                  model in the field translation model as                                  well and in both cases there's a problem                                  of you need to relate to either node or                                  a translation set where node and and                                  language under there in the first case                                  shared that is replicated in the other                                  case the under the node kind of                                  structure is not well known so so                                  there's all these problems we face but                                  the main problem really with this model                                  is that you have two models okay so if                                  you are                                                            problem is okay I'm a five-star                                  maintainer and I want to solve that I                                  want to have voting for for multilingual                                  sites so the voting can either happen                                  for a node or a voting can happen for a                                  node in the translation set or the whole                                  translation set or a language under a                                  node okay so like a module maintainer                                  who wants to support multilingual needs                                  to understand two models of translation                                  and they don't understand either it's                                  not a specific comment for a five star                                  it's it's a comment for a lot of                                  Marshall interiors and why would they                                  need to understand it right if we can                                  design a system where by default it                                  would work for them we could eliminate                                  this problem that they need to                                  understand all the guts of the system to                                  work with them so the possible fix that                                  we come up and came up with but we don't                                  have any concrete solutions for that yet                                  is that is that we make stuff fields so                                  body we already solved okay somebody's a                                  field that's done that there's nothing                                  to do there for a title it would be in                                  ours in our system it would be ideal to                                  make it a field like it was it was                                  pulled out for developer experience and                                  performance reasons there's a lot of                                  work to do in full translation to                                  improve developer experience so we're                                  looking forward to working on that and                                  then the most interesting part is making                                  properties translatable so you can say                                  this author in this language or that                                  menu item in that language or the status                                  in that language and and here actually                                  status is like a real property and                                  author and menu item are just relations                                  to outside things so those are basically                                  a special case of a relation of this                                  entity to something else and of course                                  there's the general thing of likes and                                  boats and all the other kind of                                  relations outside the node so this is                                  basically this is basically the idea                                  that will that where we can go to and                                  and the best part is for the default use                                  case it's going to work for all the                                  relations for
YouTube URL: https://www.youtube.com/watch?v=GHQn4wC_1c4


