Title: DrupalCon London 2011: OG7 - THIS TIME IT'S ON!
Publication date: 2013-03-23
Playlist: DrupalCon London - August 2011
Description: 
	Presented by
Amitai Burstein
OG7 - the one that should have been in Drupalcon Chicago, but this time, I'll even be there!

Learn about all the new stuff OG7 has.

Intended audience
Humans.

Questions answered by this session
How OG uses fields and Entity API

How OG leverages Panels

What is OG's group-membership concept
Captions: 
	                              not much more because because you guys                               are already on the eighth floor and the                               elevator only seems to be spitting up on                               the                                                                    explained about it all the way to the                                                                                                 really looked at me not at yet another                               random guy telling him yet another                               elevator pitch how did you get into that                                yes I stirred back for two whole floors                                we kept quiet considering we were                                already on the                                                          then without saying anything I lean                                toward the elevator buttons and press                                the stop button we were hanging between                                two floors heavy flow mode was the                                     floor our last stop you know I said as                                if I was the Richmond and he was a                                frightened intrapreneur some stories are                                best told when hanging on the                                twenty-third and a half floor here's the                                prologue I used to be a fashion designer                                but nowadays i mostly a drupal developer                                although they are still sometimes i                                consider myself a bit of a fashion                                designer for years my interest was mass                                customization you know like a jacket a                                tailor can make it custom-made but it                                will be expensive a factory can make it                                cheaper but it won't fit exactly mass                                customization is about the technologies                                that allow you to have custom-made done                                with mass production tools now I could                                go on and on about mass customization                                but I know how it ends people start                                rolling their eyes and they asked me why                                don't I just design clothes why do I                                insist on dealing with all those                                technical aspects this whole technology                                stuff it so it's so without the soul                                they say for that I would like to finish                                the prologue and tell you three stories                                actually the first story will be                                repeated twice                                here's the first story I'm a fashion                                designer and a drupal developer although                                I haven't always been few years ago I've                                developed a new technology for mass                                customization called mtm made to measure                                it allows you to enter your body                                measurement and get a pattern a pattern                                of a garment that fits you exactly this                                new technology of mine works great I'm                                so proud of that if the next short movie                                you will see a pattern of basic pants                                being transformed four times the first                                time the change is minor the second is                                intended for a slim fit the third is for                                someone very big                                and the last one the last one doesn't                                change at all and remains the same                                here's the second story this part will                                be repeated only once i guess i could                                have repeated it a thousand times but i                                hope i will never have to that's                                yielding you'll it came from Russia when                                he was                                                               but he didn't mind because they really                                hated them he's also very poor one of                                the poorest I know few years back he met                                a girl and they decided to get way to                                get married the wedding was held in a                                tiny home they were almost no guess                                there was barely any food on the table                                Yuri's wedding never in my life have I                                been in such a happy wedding that's Alec                                Alec didn't stay with us until the end                                he couldn't hold it and it broke down                                really quickly after one year and a half                                he said he preferred hanging out with                                his friends and both parties I haven't                                seen him since but I heard some rumors                                but they got a bit crazy but he started                                taking drugs and that he became really                                thin and unhappy I don't know if I                                believe those rumors but somehow years                                later i still find myself to be the only                                one spreading them around in this                                picture traje pills we used to call him                                tough oh boy and that's a bit strange                                because it's a real giant a genuine                                Thunder giant taco still didn't find his                                own place in the world he's been                                traveling all over he worked in every                                possible job and started studying in                                every University that agreed to                                accepting but still he doesn't know what                                he wants I truly hope that one day we'll                                find that thing is looking for there                                 aren't many giants like him and he                                 deserves better                                 that's a she she she is no doubt one of                                 the funniest guys I've ever met he's                                 able to find something funny in just                                 about any situation it's extremely                                 difficult because some situations can be                                 really bad like that one time he and a                                 couple of friends went to swim in the                                 Yangtze River in China in that afternoon                                 the two friends climbed back to the                                 village to make a phone call from what                                 I've heard his body drifted                                    kilometers from where he drowned                                 recognize that that's the first story                                 but now in the second version I'm a                                 fashion designer and a drupal developer                                 although I haven't always been I'd like                                 to prepare pants to some of my old                                 friends this I'll do for you and this                                 for Alec I hope it will cheer him up                                 this one will belong to the tender giant                                 I know and the last one the one that                                 remains the same and never changes that                                 one I'll prepare for issue I know it                                 doesn't make much sense but hey what do                                 I know I can only say and just a fashion                                 designer                                 so when I've prepared this presentation                                 I realized that mass customization a                                 term I've been using for years applies                                 also to Drupal Drupal can be considered                                 custom made it can be considered mass                                 production but I believe that in its                                 core its mass customization organic                                 groups is mass customization per se each                                 group has some freedoms and autonomy but                                 they are still bound to the rules of the                                 main site in given on my company will be                                 we've been developing a new distribution                                 called open visa it's a PLM a product                                 life's of Product Lifecycle Management                                 and its intended for the textile                                 industry it allows companies and groups                                 to collaborate together in preparation                                 of garments today I would like to give a                                 sneak preview to distribution and show                                 how organic groups is playing a part of                                 it now you should understand that the                                 code is not with not ready yet really                                 really not ready in fact I asked our                                 designer to make an under construction                                 page or so it will be clear I of course                                 emphasizing it should reflect the top                                 edge technology we've been using and                                 yeah that's the dot-com if you'll tilt                                 your head a bit you will see that the                                 current release code name is Middle East                                 basically because the code is as stable                                 as the Middle East itself now we                                 actually prepared another under                                 construction page for the people who are                                 actually navigating from the Middle East                                 again very chic very classic                                 now before I dive into the distribution                                 and show you our organic groups is                                 paying playing a part in it I'd like to                                 share a small anecdote since I've been                                 talking about fashion design and about                                 Drupal I actually had a plan to do                                 fashion show if I had everything turned                                 out I will show a slide thing the first                                 Drupal fashion show in neon light loud                                 music would start I would call the                                 models out and they would present                                 clothes that was that I designed as with                                 Drupal as inspiration however one thing                                 I didn't then and somebody did it before                                 me yeah so just wanted to get it out of                                 my system because I was a little                                 depressed but although it's a bit like I                                 tell myself that amitai being original                                 is overestimated                                 you                                 everybody a big round of applause for                                 fanboy                                 Sammy's wearing the country Sammy's                                 learning the Contra church this message                                 was inspired by our model the way they                                 are interacting with each other                                 pants pants are called I causing the I                                 eat seventh and the reason is you might                                 think because maybe it looks plastic a                                 bit boring maybe only old people we use                                 it the real reason is that like I                                       you look at the pocket they are just go                                 round the corner                                 does any candidate everybody                                 petters are the atomic customs that                                 builds our Drupal and change this group                                 home cause everything changes the world                                 changes Luther changes nothing remains                                 the change elephant Simmons everybody                                 this alien entity is everything in                                 nothing in the same time at the first                                 loop is my dream entries but when you                                 fill out the first layer you add some                                 field you see beauty allison treatment                                 and the field of all dress last is Johan                                 fault                                 not everything in design should map                                 directly to drupal sometimes sometimes                                 it's enough to take a similar color from                                 New and some inspiration for me without                                 be doesn't squeeze google because it's                                 the most useful of them all of course it                                 doesn't hurt to Swagger embroided kitten                                 in the back                                 big run for up of applause for                                 attractive model                                 like                                 let's talk about the three main concept                                 the three main concept beyond organic                                 groups I don't know if you're some of                                 you might be familiar with organic group                                 six there was kind of the notion of                                 roles and permissions but in Drupal                                     would say that this is the most                                 important thing associating contents you                                 can do it with no reference and it was                                 reference whatever but really the real                                 key element of organic groups is having                                 roles and permission / group                                 the second thing is leveraging entity in                                 fields again if you're coming from                                 Drupal                                                                   thing but in Drupal core itself an                                 entity is something new in Drupal                                       are able anything you can describe a                                 node entity you can describe a user you                                 can describe a taxonomy term I would                                 even dare to say that with entity you                                 are even able to describe your true                                 feelings towards high profile Hollywood                                 celebrities the third is of course using                                 as much as possible more Fargo you know                                 Murph ago Marilyn of curls with views                                 see tools and panels Fargo with entity                                 API and rules those all those models                                 have great API and they have great UI                                 and it's just a shame not to use them                                 now I would like to take this                                 opportunity to say that I've been                                 accused many times of being a groupie of                                 these two and really people this is                                 really preposterous I mean just the fact                                 that I have a little shrine with this                                 picture inside and that I serve them as                                 offering small patches doesn't mean that                                 I'm a groupie                                 so some of you actually came to see                                 organic groups so we'll do it I will go                                 what we are saying over here is uh this                                 is the open guzra this is the                                 distribution again it's intended for the                                 textile industries so different                                 companies can work and collaborate                                 together on garment what we're seeing                                 here is the user her name is Ellen what                                 we can see on the screen that she                                 belongs to two groups one is the Manimal                                 the name of the company and the second                                 is pattern makers this is like a                                 department inside the Manimal we'll see                                 how the subgroups functionality works                                 later on and let's go for example into                                 the pattern makers age                                 into the pattern makers page what we can                                 see is like a message stream of all the                                 new activity that has been done in this                                 specific group we can see all the images                                 that are related to the pattern makers                                 for example the images over here let's                                 go into the jumper and let's start                                 seeing organic groups in action so again                                 a jumper its content type called item an                                 item can be any piece of garment a shirt                                 trousers whatever and let's as an                                 administrator                                 let's edit it so we can see what is this                                 this is actually a note a very simple                                 node we can see the title we can see the                                 group audience meaning the group that                                 this content belongs to the different                                 images if this item is public or private                                 and so on so this is like a simple note                                 but yet when we are looking at the                                 picture over here at the screen over                                 here we can see much more information                                 and I'd like to take advantage of this                                 session to explain the way I see to                                 explain sorry to explain the way that I                                 think people should be working with                                 organic groups and this is using page                                 manager and panels and I'll give some                                 explanation about it who is using panels                                 and who is not                                 why not                                 so let's take for example this block                                 over here as we can see we're talking                                 about we're talking about the jumper                                 which is an item I can see the                                 breadcrumb telling me the hierarchy and                                 see home then the company money more                                 than pattern makers and then some                                 information about the group itself this                                 is pattern makers I can see I'm                                 subscribed to the group who is the group                                 manager and so on this is done through                                 panels and in this case i'm using a mini                                 panel                                 now the key concept in understanding the                                 way of working with panels is probably                                 understanding what context is you might                                 have heard about it also there is                                 initiative for Drupal                                                 context and this is the idea of if we                                 know blocks from Drupal                                                                                                                       know nothing about where they appear                                 when we have context so I this like this                                 advanced block is saying to Drupal                                 listen if you want me to show something                                 then I must get as contacts an organic                                 group Group entity from that entity many                                 panels know how to extract through                                 relationship other other objects other                                 entities so from the group itself it                                 will extract the node because a node                                 unlike Drupal                                                           different different entities and from                                 the node it will extract the user and                                 then if I'll go to the content will see                                 that this is very simple just playing                                 displaying different fields or different                                 see tools plugins so for example here in                                 the in the body you can see this is like                                 expand and collapse this is like a model                                 I have in my sandbox called jQuery jakes                                 jquery expander or something like that                                 nothing too fancy this is just a                                 formatter on the field so over here I                                 choose the expander                                 so that's about this element the same                                 thing is going here with a mini panel                                 another type of inserting related                                 information to the pages of course using                                 vuze                                 now go ahead if it's an important calls                                 over here we have the group members view                                 to think that I would like to show you                                 and we are basically querying the user                                 requiring the user table the two                                 important thing I'll first the                                 relationship we are adding the group                                 membership entity the same thing like                                 when we have we said we have a node in a                                 group we have another entity in organic                                 groups called OG membership this entity                                 basically describes that a user relates                                 to another group or a node relates to                                 another group and it lets a meta data if                                 the user is active there or pending or                                 blocked and it is feel double so you can                                 add your own information later on we'll                                 see how we can take advantage of that so                                 that's the relationship the second thing                                 is we are passing here a contextual                                 filter or an argument of the group ID                                 again the idea of context we take                                 advantage of it using a model called use                                 content that comes with C tools we had a                                 new display called content pane and over                                 here in the argument input again views                                 is now telling Drupal I need to get the                                 group ID from somewhere and this                                 somewhere is from the context and the                                 group ID so later on panels know how to                                 pass this information along interviews                                 I forgot my list over here so                                 hey sorry                                 so the next thing I would like to to                                 explain is the DeRozan permission we                                 talked earlier about being the most                                 probably the key element in organic                                 groups again as the administrator under                                 configuration                                 we have here the global rolls it means                                 that every group that will be created                                 automatically will be assigned this                                 group rolls okay they are not related to                                 the role that we know from Drupal itself                                 just for organic groups same thing goes                                 for the permissions                                 you can see we have here different                                 permissions that we control that we can                                 control how we are interacting with the                                 group so for example if I will                                 unsubscribe from group                                 and now we can see the button became                                 request group membership it means when I                                 will click it I have to request the                                 group membership and not immediately                                 become a member that's a permission                                 thing I can change it over here I would                                 say a non-member can subscribe without                                 approval                                 so now I can just subscribe to you to                                 the group                                 and i'm subscribed again if you're                                 coming from OG six this has changed it's                                 no longer settings it's per group right                                 now we're seeing the global rosen                                 permission but we can have it very group                                 as well so over here for example just so                                 we see in another short short example                                 Helen cannot edit the pattern makers she                                 cannot edit the pattern makers item so I                                 actually have a few ways to give your                                 permission I can give her permission I                                 can give her a special role under the                                 pattern makers group but it will be more                                 interesting to see what happens if i did                                 i give her a certain permission under                                 the company which means it's higher in                                 diag hierarchy                                 so first we'll define another role                                 let's call it                                 let's call it sales                                 and now again as the administrator I'm                                 doing it right now the site                                 administrator but I could have used just                                 a group administrator over here I've got                                 the group settings I see all the people                                 list that are inside the group i can see                                 helen is here it looks very similar to                                 how Drupal core looks and i can add the                                 sales member                                 you forgot to                                 a sign of permission to the correct role                                 so it would be added any item content                                 yeah it actually works                                 she now has added permission based on                                 her permission not in the group not only                                 in the group that the jumper belongs to                                 pattern makers he does not belong                                 directly to him animal this is actually                                 the subgroups model that is working and                                 give you the hierarchy                                 so till now we talked about the global                                 rules and permission right now we are                                 able actually to override those roland                                 permission how is it done we have if we                                 have here a field that allows us to do                                 this override how did I get this field                                 under configuration I have the field                                 settings and over here I can select the                                 bundle because we're dealing with                                 different entities and different bundles                                 then I would say that I would select for                                 example under the node the company and                                 the fields i will select the group pros                                 and permission right now i'll probably                                 get an error because i already have it                                 yeah it's already existing in company                                 and actually i can say it over here the                                 company has all those fields so back in                                 the node at it if I override the default                                 roles and permissions                                 for that specific group I can have my                                 own roles and my own permissions                                 regardless of the other groups og is                                 taking care of checking the permission                                 of the user based on the different more                                 than the different permission they have                                 sight white so if the jumper for example                                 belongs to several groups he will check                                 permission in each group                                 I talked earlier about leveraging the                                 fields where can we see it we can see it                                 when we're requesting when we are                                 requesting a group membership let me                                 just make the permissions                                 we just change the permission of bits so                                 there will be approval required                                 and refresh                                 okay this is something that it's this is                                 it this is leveraging the fields again                                 if you are coming from OG six and you                                 know the code a bit so you know that                                 organic groups just did some form altor                                 and/or its own form and it jected some                                 form and we make sure that whenever you                                 write a request we catch that request                                 from the form and we send an email and                                 that's it if the email is not sent or                                 after it was sent a year later you                                 cannot know what the request is what                                 happens over here is that we have the OG                                 membership entity and we actually attach                                 a new field called request messages                                 request message it's a text field we                                 attach it to the entity which means that                                 right now if I write a request                                 you                                 and I say join what actually happens is                                 that this information is saved with the                                 membership with the OT membership so we                                 can send an email right no problem but i                                 can also later on create my own views or                                 whatever and extract this information so                                 if the email was not sent to all group                                 managers and there is another group                                 manager that want to check it they can                                 do it the way we define those fields                                 is over here in the OG membership type                                 we see we have over here two different                                 group membership type I will soon                                 explain about the expire but let's look                                 at the default if I go into the manage                                 fields I will see the request message                                 that comes automatically when organic                                 groups is being enabled and there is                                 another one that I added myself called                                 the last message ID and I explained to                                 minute about it this is related to the                                 message string the message stream is                                 using a model that far gone myself we've                                 been writing together it's very similar                                 to activity and heartbeat only very a                                 very slim model basically you have a                                 message entity and you write your own                                 messages very similar to activity                                 here I try to do a demonstration so it                                 will be clear what's going on                                 yeah so over here I see my name                                         at the makers                                                           an item                                 it belongs to sorry                                 okay another user created an item he                                 actually created an activity and now our                                 user he ceases like he got a new                                 activities to him a new message that                                 appears over here I see you are very                                 excited of that I'm very happy because                                 it took me sometimes to do it and yeah                                 thank you so what am I doing here and                                 this is actually using the new approach                                 to Drupal                                                                entities and how we can leverage the                                 fields what actually happened over here                                 is I'm using the og membership to give                                 me some metadata the og membership of                                 this specific user of user Helen the way                                 that she is associated with pattern                                 makers there is another field on that on                                 that entity that tells me or tells the                                 system sorry what was the last message                                 ID she saw right let's say she saw                                 message ID                                                       administrator created an event it was a                                 new message                                                              takes them when we are loading the page                                 the system takes the last message ID and                                 checks well what was the last one and                                 whenever I go into pattern makers and                                 actually see the new message activity it                                 is now                                                                 shy                                 so the membership type                                 again this is leveraging the idea of                                 entities we can define multiple                                 membership types so we have the default                                 one the one that we know it uses it                                 becomes a group member and that's it                                 another typical use case that we have in                                 premium sites is that the user                                 subscribed that but they should be                                 expired after certain amount of time one                                 months one year whatever so I'm able to                                 create a new membership type i called it                                 expire over here you can see it in under                                 OG expire or the experimental i created                                 a new membership type i attached a field                                 called expire it's a date field i added                                 the request message because i want to                                 have a request message                                 and currently this is something a                                 feature I plan to do in the future but                                 currently what you can already do and                                 see the way and see the different                                 membership is for example if I will go                                 to pattern makers group                                 if I'd like to add a user so over here I                                 can see that the user will be added with                                 membership default I see just one field                                 if i'll change it to expire and now has                                 the i now have the date field and it is                                 safe with the OG membership entity so it                                 means with a very simple hook cron i can                                 go over all the different memberships                                 that are expired and just set the                                 membership entity the OG membership                                 entity set it from active into pending                                 and if i would like yeah okay another                                 time yeah and if I would like to react                                 on that that's where rules kicks in so                                 either you do it with your own custom                                 code or either you use rules again if                                 you know OD six it tried to do                                 everything by itself whenever you were                                 kicking a user out or something like                                 that oh you was trying to send the email                                 that's not the case in OG                                           saying let me do as little as i can i'll                                 just explore I'll just expose this this                                 activity and you do whatever you want                                 with it so if we'll have a look in in                                 goals for example                                 and we look at the oj expire rule and                                 the model comes with with a rule bit                                 it's mostly an example model but still                                 usable so we can see the event is after                                 we update an existing organic group                                 membership the aim of this the target of                                 this rule is to notify a user that they                                 were expired they are now pending                                 they're no longer active in the group so                                 after updating an OG membership entity                                 we can check is it the group is it is                                 the members membership type indeed                                 expired is the status is the states or                                 attending is the entity type a user if                                 so just email just in on that user                                 another thing that people would probably                                 be using organic groups is for access                                 control right part of the hierarchy that                                 we have permission is also access                                 control who can see a node and who                                 cannot                                 over here right now let's just verify                                 I'm a different I'm a different user I                                 can see jumper because if I look over                                 here i can see jumper is public it's                                 accessible to all to all users if i will                                 change it i can either strictly                                 explicitly sorry say it's private or i                                 can say use group defaults so it will                                 look to the into the group it belongs to                                 and use its definition                                 and now the same user                                 is getting this I think this is probably                                 also a good time you saw the                                         access denied probably a good time to                                 show you also the edgewood found                                 it's very hard to find the unicorn and                                 it's even harder to make them cry and                                 then to write the portrait                                 Q&A                                 you ask                                 questions                                 yeah I just I'll be with two mics now                                 you wanted yeah                                 I'll repeat the question so I just need                                 to understand it first                                 ok                                 okay so the question is what's your name                                 Sam the question is how do I know the                                 group ID because like we said the node                                 ID might be                                                            one again I look if I'll have a look in                                 panels itself as an administrator of                                 course you have API to get to get the                                 group from a node but if we're talking                                 about the user interface and now panels                                 can help us so over here over here when                                 I added the panel we have this context                                 and when I press on this context up                                 right now panels got the node entity                                 that's the way it works what I did i                                 added a relationship and I say oh gee                                 group from node and then I get the group                                 ID automatically that's the way to use                                 it with panels otherwise if you're using                                 the API you have like LG get group you                                 pass the node and the node ID and you                                 get to the group itself so those are the                                 two ways to do it                                 yeah next question yeah                                 do you have another question I know the                                 answer to                                 there is an issue about it i don't                                 remember i know i know i gave an answer                                 there but remember what it was other                                 models                                 blame somebody else                                 what about subgroups it works it took me                                 like one year and I have to get to that                                 but yeah basically here's the og                                 subgroups model it's the diversion of                                 course like every other model in Drupal                                                                                                       and it works it checks the hierarchy                                 checks for the group's above your group                                 it goes all the way up the minute it                                 finds the permission it has no like                                 strict strict settings the amenities                                 find one permission then it's enough                                 then it's enough for it                                 I                                 I can't hear anything                                 another question in the main one                                 sorry                                 just just the permissions                                 currently I mean if there is a need for                                 a future you can open an issue and                                 probably i'll never get to                                 there was one again again                                 the permissions are per group right it                                 relates to the group itself the                                 membership it doesn't affect the roles                                 of the permission the Rosen the                                 permission are like related to the group                                 entity and the membership is OD                                 membership entity yeah yeah Esther                                 persistent to your L support for it                                 organic group                                                       automatically adds the name of the group                                 to the pad how did I add their name of                                 the group but the question is that the                                 name of the group there in the past is                                 the BLM is that just the URL of the demo                                 or is it to the you mean all this no no                                 if you see the URL and on top localhost                                 / PLM is their persistent URL support so                                 we can automatically add the name of the                                 group there to all notice so we know                                 that if you're viewing a note that the                                 battery automatically there or review of                                 you at the battle is matically there                                 like we didn't organic and drupal                                        spaces and pure girl basically I didn't                                 understand the question at all so I say                                 yes but maybe know and i'll catch you                                 later on and I'll better understand                                 sorry any more questions not necessarily                                 related to Drupal I really talk like                                 talking about my personal life yeah                                 an ikea                                 what                                 it took me like two months to make it so                                 I think never again                                 you're gonna replace it                                 I am Martin gave me some crap on Twitter                                 the other day because he was trying to                                 get something working with OG and rules                                 and dbo and i went to try and help him                                 with that in my d                                                   reason that it didn't work is because                                 the OG actions module in d                                          exist in d                                                        stumbling block is that going to be                                 replaced first Morton is giving                                 everybody you know hard time so don't                                 feel bad about it no I'm not I myself                                 not going to port OD actions maybe                                 somebody will do it basically because                                 there is rules which i think is a                                 superior model and one of my plans is                                 actually for the next release is what                                 we've seen all the tables like the                                 people that the list of the table right                                 now it's hard coded what I'd like to                                 have is views and video do it so it                                 should probably help you but I think                                 that there is a video and rules model                                 for Drupal                                                   so while I'm on the MC tip tonight if                                 you didn't get the tweet from drupalcon                                 and we've managed to black the bar here                                 until                                                                down here and no cost the bar will be                                 obviously your own expense but come down                                 we're going to try and get some music on                                 and just like come down towards some                                 people have some beer no running around                                 London to pubs that don't exist or shut                                 about eight hours ago or any of that                                 crap just come down and get shit-faced                                 and have things okay                                 yeah last question Robert                                 what happened with                                 what                                 for the very good question Robert                                 so                                 that was my story that was organic                                 groups welcome to the                                                  you very much
YouTube URL: https://www.youtube.com/watch?v=5ZREUgLcLdA


