Title: DrupalCon London 2011: AN INTRODUCTION TO FORM BUILDER
Publication date: 2013-03-23
Playlist: DrupalCon London - August 2011
Description: 
	Presented by
Nathan Haug
Through the history of Drupal, there have been several different modules that allow the building of forms: Profile, Flexinode, Survey, Webform, CCK, and D7's Field. All of these set out with specific purposes in mind, whether collecting surveys or creating node content. The task of actually building the form was secondary to the task of using the form. This is where the Form Builder project comes in. Form Builder provides a single, universal interface for creating form structures. Once the form structure is created and tweaked to the liking of the user, the changes are then sent to the providing module (whether Webform, CCK, Profile, or others) and that module then deals with changes to its internal settings and new fields in the database.

Form Builder represents a major jump in the administrative user interfaces for Drupal. Utilizing jQuery UI and AJAX-based editing and previews, Form Builder can speed up the process of building a form dramatically. But the fun doesn't stop there, with Form API's array-based structure now in every part of Drupal (commonly called "Renderables"), Form Builder may be used to edit not only forms but the actual display of the page.

In this talk Nathan Haug (quicksketch) will give an introduction to the Form Builder interface and show how it can be used currently. Some modules like Webform are already fully compatible with Form Builder. After an introduction to the front-end of the module, the talk will go into the API and show how any Form API element or renderable may be made editable through Form Builder.

If you're interested in hot new APIs, better UX, or you just think the current Fields UI sucks, come check out Form Builder!

Intended audience
This talk is intended for primarily for developers interested in developing using Form Builder. Users interested in user interface design and experience may also be interested.

Questions answered by this session
What is Form Builder?

How is it useful right now?

How can it be used for in the future?

How do I prepare for Form Builder?
Captions: 
	                              alright thanks everybody for for coming                               to to my talk today today I'm going to                               be talking about form builder which is a                               project that's existed for for quite a                               little while here but what I'm going to                               do today is kind of give you guys a                               three-part introduction into form                               builder an introduction into what form                               builder is what form builder does today                                ways that you can develop with it                                essentially an introduction into the API                                because this is a code talk and then                                also a short discussion of possibilities                                for Drupal                                                              replacement for our current field you I                                so the last part mostly theoretical so                                if the code stuff kind of goes over your                                head at some point don't worry we're                                going to tone it back down a little bit                                towards the end so so first off Who am I                                my name is Nathan Hale goodnight hug I'm                                quick sketch on drupal.org a lot of                                people know me from a lot of controls                                that maintain I maintain a webform                                insert flag file field image field and I                                wrote a bunch of other ones like Lincoln                                                                                                      Drupal community as well as in the                                Drupal core issue queues my most recent                                accomplishment was that I put image                                module into Drupal core including image                                passion image field an image API and                                file for yoga aw I so that was that was                                awesome but actually kind of as a funny                                side effect is of trying to put image                                module in the core we really I mean we                                had to shove through the field you I                                module which is basically the cck field                                you I from from Drupal                                                                                                                     process which is unfortunate so Drupal                                  hoping to undo some of those                                repercussions from speeding that along                                so quickly with with this form builder                                talk and I'm also the author of our                                co-author of the book using Drupal also                                i'm also very active in making a lot of                                tutorials and instructional videos on                                on Drupal and this is a pitch for my                                company lowa bot we have a site Drupal                                eyes me that has a coupon code at the                                end and I'd be happy to I'd love you                                guys to try it out and see what you                                think so let's talk about form builder                                the history of form builder form builder                                is a project on drupal.org you can see                                it's been around since jun                                              the URL of course is just drupal.org                                project / form builder and it originally                                was a google Summer of Code project this                                idea of being able to edit a form with                                then Drupal through a visual interface                                has been around for a really long time                                and a lot of lot of different attempts                                at it in jaron in                                                      again in its current incarnation and in                                                                                                      time in Drupal                                                          product and never actually went anywhere                                which basically Drupal                                              kind of came to a close and we found                                that there was no way was going to get                                in and wasn't ready yet so it kind of                                just SAT there for a little while but in                                in                                                                 builder in their implementation of web                                form in in aqua gardens so they ported                                it to Drupal                                                           form implementation which was fantastic                                so now in                                                            stabilized and fully supported in web                                form so you can actually use form                                builder with web form today largely                                because of the the good start that that                                aqua put on to it when they put it into                                gardens so the first thing we're going                                to do is we're actually just going to                                take a look at what form builder is                                today and if you aren't familiar with                                web form the module for making surveys                                in Drupal I suggest that you head over                                to archive org and just do a search for                                web form and there's a talk from                                drupalcon Chicago that I did that is an                                introduction to web form so this isn't                                really about web form this is about form                                builder today so                                I'm going to head on over here to to my                                drupal                                                                  and create a new piece of content here                                 and create a new webform so if I add any                                 web form and I've already enabled the                                 form builder module and the form builder                                 web form integration module so there's                                 the form builder module itself which is                                 nothing it doesn't do anything at all by                                 itself other than provide infrastructure                                 for other modules to implement with it                                 and then you need to implement                                 integration module like the form builder                                 webform module that comes with the form                                 builder project and you can see here                                 essentially I start out with a blank                                 form and I have a palette of fields over                                 here on the right-hand side that is all                                 of the various things that you can do                                 with web form and you simply take it and                                 drag fields over from the right-hand                                 side and a symbol assemble your form                                 essentially and obviously you can see                                 it's ridiculously fast to actually                                 implement a form like this one of the                                 reasons for that is because all of these                                 fields have essentially like reasonable                                 defaults sort of defined for all of them                                 if you were to do the same thing infield                                 you I your you're prompted with a sea of                                 like eight empty text fields where                                 you're like what do you want to name                                 your field whether you want the title of                                 your field to be what do you want your                                 options of your field to be what do you                                 want all of these settings to be and one                                 of the things that is required for form                                 builder to work is for every single                                 element have a default so as set of                                 defaults that make sense so when you                                 drag those things in things like you                                 know the choices here poor average good                                 excellent you know we're all there but                                 of course you can go in and edit them so                                 you edit by clicking on a field which                                 apparently is being weird one second                                 so you edit a field by clicking on it                                 and currently this is the way it works                                 where the options for editing field                                 appear down below some of the work that                                 operated in gardens is they wanted the                                 options to show up over here where the                                 palate is so the API has the ability to                                 display the options for it someplace                                 else but the default implementation and                                 the way that is least likely to break                                 the layout of your site is if it just                                 puts it right down below the field                                 that's being edited and then you can go                                 over here go to your options and you can                                 add in so these are the things across                                 the top poor average excellent or good                                 excellent you may add another one that                                 is you know awesome like even better                                 than everything else and you can see it                                 does an AJAX request every time you do                                 some kind of change of any kind like if                                 I want to make this field required I                                 check the box it does an AJAX request                                 and then it updates the display of that                                 element on the drupal side and then                                 replaces it into the interface so the                                 whole thing is really it's quite speedy                                 and there's very little code that is                                 actually needed in order to make this                                 work because it's all still PHP this the                                 actual javascript file for this is only                                 like oh no seven eight hundred lines                                 which isn't terrible considering the                                 amount of functionality that this does                                 in the way that it works so quickly with                                 the Drupal forms API to actually edit                                 these things so that's the basic concept                                 here I made the mistake of dragging a                                 fieldset which doesn't work so hot so uh                                 anyway you save and then I can go over                                 here to view and you can see that the                                 form that I constructed with my awesome                                 option is all all here and ready and                                 it's it's good to go incredibly quick                                 and and really user-friendly like the                                 concept behind you click on it you edit                                 it you dragged in a new field all of                                 this stuff it just goes ridiculously                                 quick so there are some advantages that                                 web form has when it comes to                                 implementation because when I was                                 running form builder my wrote it                                 basically for web form but with the                                 intention of making it work for other                                 things so                                 lots of abilities that web form is                                 utilizing but we'll need to make some                                 enhancements in order to this work with                                 field you I so let's talk a little bit                                 about the way it works so that's                                 basically you know the the what what it                                 does if you want to you can go to my                                 site click sketch doe RG and there's a                                 demo site right up there at the top of                                 the page that is like then you can play                                 around with it as much as you want or                                 you can of course just download and                                 install the module so the way it works                                 most people in here this being the                                 Carter track are probably familiar with                                 the way the dribble works when it builds                                 forms through all of dribble form                                 dribbles forms are arranged as arrays so                                 big nested arrays of things like this so                                 this would render a title field that is                                 a text field that has the label of title                                 a description a max length property it                                 would have the asterisk and validation                                 for it being required and I would have a                                 weight negative                                                        at the top of the form essentially so                                 what form builder does is it basically                                 has the ability to look at any one of                                 these arrays and then through a series                                 of hooks you can say my module knows how                                 to edit fields that are of type text                                 fields so it'll read the type and if                                 your module have you've enabled your                                 module to edit this particular type                                 property like a text field that says                                 okay well in a text field what                                 properties do I know how to edit within                                 a text field element and then you would                                 specify your title description max max                                 length required wait all of these things                                 here you would say my module knows how                                 to edit all of these things and in a lot                                 of situations your module may not be                                 able to actually edit all of the                                 available properties here that are                                 available to the forms API something                                 like you know pound process or pound                                 pre-render or pound theme you know a lot                                 of properties that are out there                                 that you wouldn't want somebody to be                                 able to edit that from from the                                 interface I mean you could form builder                                 can change any property literally any                                 property in the entire system it can                                 change it if you tell it how every                                 single one of these properties                                 essentially has a form tied to it saying                                 that if there is a title property then                                 this is the form that is available for                                 editing the title property which is just                                 a text field that lets you type in a new                                 title so the form lets you modify the                                 value and then a form builder basically                                 reads in the properties and lets you                                 edit the ones that knows how and that it                                 knows of the craziness of Drupal                                      that this approach here of using arrays                                 isn't just for forms anymore actually                                 even in Drupal                                                       that the node content property was also                                 an array so something like the title                                 this would be the display of the node                                 was actually an array also and it would                                 look something like this where it was                                 pound type equals markup the title or                                 label of it maybe it had a title whether                                 or not you want to label the show or not                                 the actual value of the title and then                                 the weight and so this means that with                                 form builder being a form API array                                 editor and as expanding the form API                                 concept to everything everything is now                                 called renderable instead of a form a                                 PIR a form builder can actually be used                                 on this stuff too there's no reason why                                 it wouldn't it's the same thing it's                                 just that the the properties are                                 different essentially so if you teach                                 form builder how to edit these                                 properties in addition to the ones that                                 already knows how to then you can have                                 form builder work not only on your back                                 end for editing your forms but also on                                 your front end for editing the display                                 of things which opens up a whole world                                 of potential here so so now that we've                                 established that it is a renderable                                 array editor how does this module                                 actually work                                 actually implementing this module into                                 our inter implementing the form builder                                 interface into your module is actually                                 really pretty simple there's one                                 function that you call to actually like                                 bootstrap the entire form builder                                 interface you can only have one of them                                 on a page but i hope that most of the                                 time that's not a problem you call form                                 builder interface and then just like you                                 have a form ID you have to specify a                                 form builder ID which sometimes if you                                 wanted to you can make that the same as                                 the for maggie and then a type so typo'd                                 be something like if you were editing an                                 entity the type would be the bundle                                 which is the node type or a few reading                                 a webform the type is actually the the                                 node ID says since every single web form                                 has a different has a different ID                                 essentially so what happens when you                                 call form builder interface is that a                                 module needs to implement hook form                                 builder load and it checks the form                                 builder ID in the type and then it loads                                 that form or renderable and then passes                                 it back to form builder and so the                                 typical thing that you'll do inside of                                 hook form builder load in your module is                                 called Drupal get form and Drupal get                                 form will actually load the renderable                                 array and then you get an array back and                                 then you just return that array back                                 from this hook and that basically says                                 here form builder here's the form make                                 it editable and then the form builder                                 interface will be built out and let you                                 edit that array or node view if you were                                 editing like the front-end you call node                                 view and that gives you the the content                                 array for a node and then you pass the                                 content array to form builder and then I                                 can edit the content it's really crazy                                 so yeah you let form builder manipulate                                 the properties it knows about so this is                                 when the user is dragging new fields                                 changing properties reordering them etc                                 and then you use a separate form to                                 actually save all of the changes by                                 loading form builder from the from the                                 cache very much like views views has the                                 the ability to edit a lot of things all                                 at once so you can change a bunch of                                 things about like the sort order or the                                 criteria the filter criteria or which                                 fields are in it and all of those                                 changes are being saved dynamically                                 through ajax requests as you're making                                 them but the changes aren't actually                                 made to your view until you click the                                 Save button right and it's the same                                 thing with form builder form builder                                 uses that an identical method                                 essentially to store a cache of what's                                 changed as you're making all the changes                                 to your form and then all of it isn't                                 actually saved until you click click the                                 Save button which will load it from the                                 cache that has been generated by all                                 those ajax requests so the hooks that                                 are available in web form or sorry in                                 form builder it's a whole set of them so                                 there is hook form builder types and hug                                 form builder types is sort of like the                                 granddaddy of form builder in the way it                                 works form builder types is basically                                 it's it's an array of arrays of arrays                                 you know kind of standard standard                                 Drupal practice here so it's an array of                                 form types such as web form or entity or                                 node so that's the key that contains a                                 list of element types that are editable                                 such as text field checkboxes I'm say                                 radio select lists whatever it is that                                 you want to actually make editable                                 within that type of form and then it                                 also determines whether or not you have                                 palette grouping and whether or not your                                 fields are unique and which fields are                                 possibly editable unique fields are                                 really interesting and something that                                 right now nothing is actually utilizing                                 but the functionality is there where if                                 you have something like you're editing                                 the node form you want to do something                                 like half the path settings you know                                 there's only one path settings on the                                 node form you can't have multiple paths                                 doesn't make any sense so if you were to                                 drag in the path settings from the                                 palette the the path settings option and                                 the palette disappears after there's one                                 hour                                 there and if you remove the past                                 settings from the form then the past                                 settings reappear in the palette so you                                 can drag it back in again so unique                                 fields are really cool that are useful                                 when there's only one of one thing                                 possibly everything else when you when                                 you drag it in it just you can add as                                 many checkboxes as you want on an                                 individual form some really cool hook                                 form builder properties and this hook                                 basically defines a global list of                                 properties that can be editable so                                 things like pound title pounds pound                                 options pounds you know pound everything                                 pound default values all of the all of                                 the properties that are within a                                 renderable array there's only one giant                                 global editable list of properties so                                 it's important that modules basically                                 choose unique property names so if you                                 have pound options pound options is used                                 equally between the types of like a                                 radio button or radio buttons and                                 checkboxes and select lists and                                 fortunately pound options is edited in                                 the exact same way for all three of                                 those things because they're all they're                                 all the same the same thing they're an                                 array of options essentially and so if                                 you're going to be making new properties                                 you want to make sure that your property                                 names are always unique so like in the                                 example that we saw with web form where                                 I pulled out a grid I didn't want to use                                 pound options there because pound                                 options I don't want I don't want to                                 conflict with the existing settings for                                 per pound options so I named it like                                 pound web form grid options or something                                 like that you can make up your own                                 properties just willy-nilly and make                                 sure that they're unique so you don't                                 have run into a namespace clash                                 essentially so so define the renderable                                 properties and forms to edit that                                 property so each individual property                                 like pound title or pound options then                                 has a call back form that is for editing                                 that particular property so if you run                                 into an element that has that property                                 it just puts in that form that that                                 corresponds with that property to edit                                 it and then there's hook form builder                                 load and I already mentioned this hook a                                 little bit earlier and this is the hook                                 that is responsible for essentially                                 finding the form API ray to actually                                 edit so when you call form builder                                 interface and say let me edit the form                                 by this name this hook responds to that                                 and says okay here's the array that is                                 editable for this particular form ID so                                 there we go and then its complement hook                                 form builder load a lot of other modules                                 actually very few people probably                                 actually need to hook phone bill they                                 load but a lot of people need hook form                                 builder load alter so the module that is                                 responsible for providing the form like                                 node module would implement node form                                 our node underscore form underscore                                 builder underscore load to load the node                                 form but then every other module like                                 path module or taxonomy or system module                                 actually maybe would provide something                                 set or menu module would actually                                 implement the load alter to then add in                                 its modifications to say oh that path                                 field set you can change that too so                                 path module would provide some                                 alterations to make it so you could edit                                 that particular section of the form if                                 no module claims a particular area of                                 the form then what form builder will                                 naturally do is it will allow you to                                 move that element up and down so let's                                 say path module didn't implement path                                 form builder load alter what end up                                 happening is you can move the path                                 options up and down in the node form but                                 you wouldn't be able to remove it and                                 you wouldn't be able to edit it in any                                 way and you would just be able to move                                 it up and down in the form so that's                                 sort of a natural effect of form                                 builders that if it doesn't know how to                                 handle something then it just lets you                                 move it around up and down and adjust                                 the pound weight property but nothing                                 else and you can't nest it either all                                 these things that are                                 or limitations if if you're working with                                 limited information essentially so let's                                 see I'm Vegas before I go on and then                                 just fire hosing hook names at you guys                                 you guys have any questions so far all                                 right it's like no no is too way over my                                 head so sorry about that so a couple                                 other hooks that are available there's                                 hook form builder add element altar and                                 I know that's just a terrible name but                                 that's exactly what it is and                                 essentially when you drag a field in                                 from the palette this is a hook that                                 fires just before that element is                                 rendered on the form so this allows you                                 to do things like give it a unique ID                                 for example if you're going to be Auto                                 incrementing your IDs of fields that                                 you're pulling in you can count the                                 number of fields that you currently have                                 and give it a unique ID right before it                                 gets added to the form and then there's                                 hook form builder preview altar and this                                 particular hook is essentially like a                                 pre render function if you will it                                 allows you to essentially make some                                 manipulations in the preview that make                                 it so that some things like an invisible                                 element would become visible in the form                                 so if you dragged in a hidden element or                                 a hidden field into the form even though                                 that's not going to show up when if it                                 were rendered on the front end it's                                 still really important that the                                 administrator can see that hidden field                                 exists so you have to alter it to make                                 maybe turn into a text field or maybe                                 just turn it into a string of text that                                 says hidden in parentheses or something                                 like that something so the user can                                 actually see that element so if your if                                 your element is going to look different                                 between when it's actually displayed and                                 when you're working on it in the foreign                                 preview then you have to give it then                                 you have to sort of modify it before                                 it's actually shown in the form preview                                 utility functions that form builder                                 provides they're actually really cool                                 there's a whole list of them                                 and these are basically just like tools                                 for manipulating a form API array of any                                 kind like form builder get element if                                 you have a big form or a big nested                                 renderable and it just has layer upon                                 layer upon layer it's really hard to                                 just find one element in that I in that                                 entire array and so form brother                                 provides a convenience function for form                                 be able to get elements that is a                                 recursive search function if you will                                 just to pull out that element and then                                 return it back to you this element ID                                 that you actually are used to find the                                 element it's not just the key of that                                 form API element it's in this special                                 property in that hook form builder load                                 and hook form builder load alter each                                 module needs to go through and basically                                 assign everything that it knows about an                                 element ID so in web form that's the the                                 component ID and then field modular cck                                 that's like field underscore fields name                                 right which isn't actually a form API                                 property anywhere so you need to                                 basically tell form builder what that                                 fields unique ID is for the entire form                                 which every individual field will have a                                 unique idea of some kind but whatever                                 that idea is you need to place it into                                 this particular property so that way                                 form builder can use this get and its                                 complement set element by checking this                                 particular ID so the compliment if you                                 make any modifications to an element                                 then you can say set this element and it                                 will find it wherever it is in the form                                 API array and insert it back into the                                 array some other like a crazy thing you                                 can do with this is you can actually                                 move an element by modifying like pound                                 parents and pound key you can actually                                 like move an element in the array by                                 getting the element changing pound key                                 to something else and then setting it                                 back again it'll actually move its                                 location in the form so a whole bunch of                                 crazy logic in there to basically                                 manipulate a form API right through                                 code and then there's this really                                 awesome function the there's whole suite                                 of functions that start with form                                 builder cash and that's that static cash                                 that was talking about that sits in the                                 database and as it adds is doing Ajax                                 requests it's updating that cash with                                 various properties there's form builder                                 cash difference where you can                                 essentially say hey since this form                                 started being edited what form elements                                 changed in the entire set of elements                                 that change so if you go in and you only                                 change one thing like you change a title                                 or a label on something and then you hit                                 save only one field is actually changed                                 in that huge array and it'd be a big                                 pain to go through and like figure out                                 what are all the elements that changed                                 here when only one property change in                                 the entire form a PIRA and this function                                 essentially does that for you where it                                 finds all of the elements that have                                 potentially changed and then you can                                 also tell it to exclude wait so if you                                 do something like you drag a field from                                 one position down just one one slot that                                 mayri wait everything in the entire form                                 and if you don't want to have that the                                 weight property essentially to make                                 every element in the entire form flagged                                 as being different then you can just say                                 just ignore the changes to wait and show                                 me only changes to other properties                                 essentially                                 okay so now that we've got done sort of                                 with the Grand Tour of hooks that form                                 bill that provides I'm going to talk a                                 little bit more about some some concrete                                 code here and that's how to actually                                 save your changes before i talk about                                 saving this is what it would look like                                 if you were actually implementing this                                 in your own module like if you want to                                 build a foreign building interface                                 somewhere on your site this would be a                                 menu call back here so my module admin                                 page and this would be returning the                                 contents of a page so the total contents                                 of a page here are pretty simple hear                                 you say output in Drupal                                             instead of returning a string and menu                                 callbacks you now return an array so the                                 entire page itself is also a renderable                                 array and you only need to put to prop                                 or two parts into this page you need to                                 load the form builder interface itself                                 so this is where i was saying form                                 builder interface and you say the form                                 ID or that this is a little bit off it                                 should be a form ID first here so so you                                 basically say load the form form ID and                                 then initialize the interface and then                                 in addition to that that would allow                                 that that would load the entire                                 interface for editing a particular form                                 API array that matches to to form ID but                                 the user doesn't actually have any way                                 to save their changes there's no Save                                 button that is provided by by the form                                 builder interface so you need to make                                 another form that is nothing but the                                 Save button which is really kind of                                 interesting so so the form builder                                 interface will ultimately call hook form                                 builder load and then your module would                                 return back the form API rate inside of                                 that function and then you specify the                                 form itself when you called your book                                 get form the string that you pass in                                 here maps one-to-one the form ID maps                                    to a function name so here's the form                                 callback for actually returning the form                                 and as you can see in here there's                                 nothing                                 here but a submit button which is kind                                 of crazy so the submit button when you                                 actually click Save inside of this                                 button what this looks like is it would                                 execute the name of your form so module                                 underscore save underscore form                                 underscore submit so a submit handler                                 function and this is generally what it                                 would look like so you would use the                                 form builder cash load and you would                                 load the particular form that had just                                 been edited and so this gives you the                                 form API array as it is currently like                                 and the modified one that's been updated                                 or an alternative to that that gives you                                 the entire form if you wanted to you                                 could use this function form builder                                 cash difference and pass in the form ID                                 once again and that would return just                                 the elements that have changed so this                                 actually this line up here isn't                                 actually necessary it's just an option                                 but most of the time I think this                                 difference is is actually what's                                 important here and then you loop through                                 the differences who'd say for each the                                 differences as element ID so this is the                                 unique element ID again you get two                                 properties inside of that array the                                 original one so what it was before the                                 changes and then the modified one after                                 the user had made some changes to that                                 particular element and then you have to                                 go back through and this is where you do                                 like the database changes to like insert                                 a record or updated records save the                                 settings somewhere that record what that                                 property or like the mappings of what                                 changed in that property so if you                                 change the label and it's update the                                 field table that stores what the label                                 of the field is and things like that so                                 that's the the general idea of the way                                 the form builder module actually                                 operates it's basically a whole set of                                 hooks that's allow form builder too fine                                 to form modules that then say these are                                 the fields that are actually edible                                 within a form and these are the                                 properties within those fields that form                                 builder should have the knowledge to                                 actually modify so there's sort of a                                 tiered approach there what forms are                                 possibly editable what fields within                                 those forms and what properties within                                 those fields within those forms so it's                                 it's it seems a little bit complicated                                 but actually implementing it once you                                 get over like form builder provides                                 basically forms for editing every                                 property in all of core so anything that                                 is in the form API documentation form                                 API RT is our form builder has already                                 provided a forum for you to be able to                                 edit that property if it's provided by                                 core form builder already supports it so                                 it makes it so that the amount of reuse                                 of forms is extremely high so in right                                 now every time you need to edit a title                                 field or a title property in any number                                 of form editing systems you have to                                 write the form all over again whereas                                 form builder gets a extremely high                                 amount of reuse of the same forms sort                                 of assembled from pieces and then put                                 into a big form to to control the                                 overall all over all settings for that                                 particular field so some nice reuse                                 there do we have any questions so far on                                 the architecture like the way that that                                 form builder works and the way that you                                 might be able to use it in your own in                                 your own solutions yeah                                 yeah so that's a great question is there                                 any reason not to use this for front-end                                 display instead of forms maybe even                                 emails or just the display of the                                 content on your site and no there's no                                 reason why you wouldn't want to do that                                 I actually think that that is going to                                 be the future of this project is editing                                 front-end display things and you                                 mentioned emails which is really                                 interesting thinking about emails as a                                 renderable array that's exactly what web                                 form does when it sends out emails is it                                 basically builds up the entire form as                                 if it were going to display the form but                                 instead of showing the form it displays                                 a whole bunch of text and then that text                                 is plain text emails that then gets sent                                 out whenever you whenever user completes                                 the submission so absolutely i mean that                                 this will eventually be seen i think                                 everywhere yeah any other questions yeah                                 yeah do I see something like this making                                 it into core of course that's like the                                 big question right why don't we talk                                 about that since that's the that's the                                 next topic so what is the potential here                                 for using form builder in core I                                 actually really wanted to show you guys                                 a usable demo because I actually did                                 this I wrote the cck integration and                                 note integration and path and menu                                 integration and all of these                                 integrations but all for drupal                                       when drupal                                                              the form builder project kind of                                 stagnated there because i wasn't very                                 motivated to work on something when                                 Korra was frozen now with Drupal                                   unfortunately we're not actually really                                 in a code thaw right now for Drupal                                   it's still kind of like a slusher a                                 freeze even because of the number of                                 bugs we have so we're not really moving                                 forward on new features right now so                                 anyway so I just have mock-ups to show                                 you guys and I hope that's not not too                                 disappointing so originally this was the                                 approach that I was going to use where                                 exactly like a webform there's a field                                 palette over here on the right-hand side                                 and what you would do is you drag in                                 what field module would call the widget                                 so the widget being like a text field or                                 select check boxes or radio buttons or                                 something like that and then it makes                                 that particular element and then you                                 would click on it and you would edit the                                 properties and display you know exactly                                 exactly like what we just saw but                                 there's a difference here and that cck                                 or field module both they also have to                                 do with the structure of your database                                 right like what type of data is actually                                 being saved into this select list and so                                 my original thought was I was like oh                                 that's a piece of cake we just add a new                                 tab here for type and then we let you                                 choose the widget and the data type so                                 the data type would be text integer                                 decimal whatever type the field module                                 would actually use in the database to                                 store that particular property and of                                 course these                                 things don't have form API properties                                 and the only thing form builder is                                 capable of editing as things that are                                 properties so easy enough you just make                                 up two new properties like pound field                                 widget for editing the widget and pound                                 field type for editing the type and then                                 you define in form builder this is how                                 you edit the field type property and                                 this is how you edit the field widget                                 property and then you allow the user to                                 change those things so that was the the                                 initial thought here and of course there                                 are some things that you would need to                                 lock down just like in field module                                 right now after you set the data type                                 text integer decimal VAR car whatever                                 you're going to what your what are we                                 going to set it to it becomes locked                                 after you set it so if you messed up the                                 field type original or the day type                                 originally you have to delete the field                                 and add it again but a nice thing about                                 doing this with form builder at least is                                 that we don't need to lock the data type                                 until after the entire form has been                                 built and the user click Save so we have                                 this nice opportunity essentially that                                 when the user clicks save I showed you                                 the submit button that I had where it's                                 literally just a nothing but a button                                 and then in the save process it                                 immediately just injects all that stuff                                 in the database annales analyzes the the                                 changes saves them you could very easily                                 build in a multi-step form there instead                                 though when when the user click Save you                                 give them like a review screen of all of                                 the action that's about to occur and in                                 the case of field module at least in cck                                 when it used to do all the crazy data                                 juggling when it was like normalizing                                 ordinal analyzing your database I was                                 suggesting that people put their site                                 offline before they make a whole bunch                                 of crazy database changes so that way                                 you don't get somebody writing to the                                 database at the same time as data is                                 being flown around so all kinds of great                                 things you could do where after the user                                 has set up set up all of their fields                                 then you can do like a nice like warning                                 screen of these are the things that are                                 about to occur which would be really                                 cool                                 so so how does this how does this                                 proposition sound yeah it's a yes hun                                 sounds pretty cool right so this I                                 thought it made total sense because this                                 is the way I think that if I want a text                                 field I dragged in a text field and then                                 i set the data type on that text field i                                 think that that makes a lot of sense to                                 assemble the form first however after                                 having a lot of conversations about this                                 I was there was a suggestion that I                                 don't do the widgets over here this is                                 essentially a list of widgets right and                                 then you set the field type or the data                                 type inside of here that's backwards                                 from the way cck or field module works                                 right now and what would it look like if                                 you put the data type over here instead                                 in the palette and you dragged in like                                 text or integer or float or something                                 like that and it sounds like a terrible                                 idea right at least I think so so if we                                 if we look at this so text field file                                 select text area checkboxes radios this                                 instead maybe you'd get text long text                                 decimal integer float boolean list you                                 know it's like well what's going to                                 happen when I pull in a long text right                                 you know what would happen then well I                                 think it would be a natural thing for                                 long text would be a text area right and                                 a natural thing for text to be a text                                 field and if you drag them something                                 like a decimal or an integer it will                                 probably also be a text field right it's                                 a little bit puzzling like what would                                 happen as you were pulling those things                                 in but if you bear with me here and we                                 think about this and it seems like it's                                 not as good an idea as the first one but                                 then I had this crazy revelation of you                                 can edit not only the forum at this                                 point because you're just pulling in                                 data types right so if you already know                                 the data type the data type essentially                                 is bound to a form element and then on                                 the front end display it's bound to a                                 formatter so why not make it so you can                                 edit both at the same time so you could                                 actually toggle                                 between the form here so what I've done                                 here is I took the form preview and I                                 turned into a tab and made it so there's                                 a display option at the same time and                                 you could toggle back and forth between                                 them and assemble the display parts and                                 the form at the same time and if you                                 drag in a decimal at this point it would                                 drag in a sample decimal number like                                   point                                                                  and if you dragged in a long text it                                 would be a big blob of text and then you                                 could go back to your form and you could                                 change the form at the same time and so                                 essentially this part is like                                 configuring your display for matters and                                 this part is to configuring your fields                                 so instead of those being two different                                 pages it would be one big interface and                                 you could edit both at the same time and                                 save a content type that is completely                                 finished all in one big screen which                                 sounds kind of crazy so does that sound                                 like it's a little like feasible I mean                                 that sounds better let's take a vote who                                 likes option one dragging in form fields                                 first and who likes option to dragging                                 in data types and then displays Wow well                                 I thought that I was like completely                                 convinced I'm like this is totally                                 awesome it's way better but so for                                 people not in the room and listening on                                 the on the recording that was like an                                 overwhelming majority preferred option                                 one probably                                                right what happens when a user changes                                 the data type after the form has been                                 built and there's already data in the                                 database and that's actually one of the                                 limitations of field module right now                                 you can never change the data type after                                 the field has been added so as soon as                                 you hit the Save button which I don't                                 have on this this screen as soon as you                                 get the save button and those database                                 tables are created you can never change                                 the type if you need to change the type                                 you literally need to delete the field                                 add another one and that does exactly                                 what you'd expect to the data deletes                                 the data and then starts out with a                                  fresh new table essentially yeah okay                                  what about basically a mixed approach                                  gabor suggests swear on the form tab                                  let's see if I can get there on the form                                  tab you drag in the widgets like option                                  of one but we still include the display                                  option and the display option you would                                  then dragged in the data types I don't                                  know about that mm-hmm                                  yep so so basically the statement was                                  that on the display side you're actually                                  looking at data so it makes sense that                                  if you pulled in text you would see text                                  and if you pulled in an integer you                                  would see an integer and on the form                                  side if you pull in an integer who knows                                  what the hell that's going to look like                                  in the form but if it were text field                                  you would get a text field and then I                                  guess it has its merits and that if you                                  toggle back and forth because you could                                  do this really quickly if you toggle                                  back and forth you'd probably see that                                  all text fields that you dragged out all                                  our texts like text x they're not                                  numbers and if you wanted to make it                                  into a number or a list you would be                                  able to make that change very quickly                                  back here in the middle                                  hmm so the same it was that the data                                  types is not actually that's a really                                  good point actually that what you're                                  doing is you're not actually dragging in                                  data what you're doing is you're                                  dragging in for matters so you would say                                  you dragged in a formatter for image or                                  something like that or an image cache                                  preset or something like a plain text or                                  trimmed text or a list of all the four                                  matters and that the four matters are of                                  course only associated with particular                                  data types so you'll be able to drag in                                  which format or you want it immediately                                  without having to change it and I think                                  you're totally right i think that makes                                  more sense if you're going to be taking                                  the widget approach the display side                                  should be the formatter and the                                  formatter then can sort of inherently                                  decide the data type but only to a                                  certain degree because there's a lot of                                  for matters like plain text that apply                                  to multiple types of data of course so                                  let's go back here                                  all types of killing fields or field                                  types                                  okay gotcha yeah so a combination                                  approach being suggested where in                                  addition to a list of widgets so we go                                  back to option one because option one is                                  is winning the battle right now option                                  one where you have text field select                                  checkboxes text area and all of these                                  things can have multiple data types                                  associated with them so why not have a                                  list essentially of text fields you know                                  for text field for text text field                                  furniture text field for decimal yes and                                  then it would allow you to set better                                  default values when you drag things in                                  it would also be less clicking at least                                  I think it would be more direct form                                  builder does already have the option of                                  categorizing fields within a palette by                                  default it just puts them all in a                                  generic group and the generic group                                  there's only nothing but the generic                                  group then it doesn't display a title                                  here that labels them as generic or or                                  standard or something like that but if                                  you have multiple groups such as the                                  unique fields and the node form I've                                  called them special so things like path                                  and menu settings and things like that                                  and there's no reason why we couldn't                                  use that grouping ability to do the data                                  type so you could have like and then                                  instead of displaying it as just a long                                  list on in the right-hand sidebar you                                  might do tabs tabs of field so you want                                  to say a tab that is integers a tab that                                  is text a tab that is decimal and then                                  inside of each one of those you would                                  have a different collection of widgets                                  to drag in I don't know if just kind of                                  thinking out loud here or UI design on                                  the fly                                  mmhmm yeah or instead of using tabs use                                  a drop-down that filters or switches                                  between available data types hurry go up                                  here first and we'll come back so would                                  it be this one where it's going to be                                  picking so a date or telephone or email                                  would it be a text field yeah so the                                  question was thinking about future                                  proofing how would we handle things like                                  html                                                                      equals phone and type equals email yeah                                  those would definitely be they did hmm                                  good question whether or not that the                                  data is actually because those fields in                                  the database are still like VAR car or                                  text or something like that but there                                  are special kind of texts like                                  especially formatted text date of course                                  would be a date field or datetime field                                  so that that's definitely would be                                  listed in both as a widget and as a data                                  type but yeah you can you can make up                                  your own data types that could be                                  something like you would have an email                                  field and that would be both email and                                  data storage and email in in the widget                                  and there's a lot of modules that do                                  that kind of specialized things like                                  link module actually I think there is an                                  email module that provides an email cck                                  field that is specialized and even                                  though it saves it as text it provides                                  like additional validation and make sure                                  that it's an email and same sort of                                  thing for phones or for link module is a                                  really good example of that where it's                                  still just text that's a URL + like                                  whether or not you wanted to open a new                                  window or not but it's just like a                                  combined field so yes to all of that if                                  you were using email or phone or some                                  kind of dedicated html                                                   say that should probably both be a                                  specialized data and a specialized                                  widget so it would be it would show up                                  in either one of these options as is                                  something you would drag in in the back                                  yeah so basically could you choose your                                  own defaults here so you like your own                                  sample text yeah your own visual so you                                  could in a lot of ways if you wanted to                                  you could do it per instance so if you                                  were editing the particular field there                                  would be no reason why we come have like                                  sample text here so you could type in                                  your own sample text or upload your own                                  sample image to make it so you can get a                                  better visual of what it was you're                                  talking about and that that sounds                                  awesome I do think that we would need to                                  provide some kind of default for if you                                  dragged in an image field it would just                                  be the default and then you could upload                                  your own if you wanted to but like image                                  cache or image module in Drupal                                       just provides that nice picture of the                                  balloons that's the theme function that                                  you can you can override so if you                                  wanted to change the generic one change                                  it there yeah that's like that's a great                                  suggestion so and just like over here                                  we've got default values over here we                                  could have sample display I think that's                                  a great idea yeah                                  okay so so there was a comment about we                                  may not be able to use the data type                                  here when we drag in a field because                                  that's not always just a single field                                  that's being configured like an address                                  field where you have city state or                                  province I suppose here country all of                                  these various fields that are all sort                                  of together I need to be able to                                  configure those well form builder                                  doesn't need to be able to edit just one                                  field as long as there's a parent that                                  wraps around all of those then you can                                  edit the group as a whole which is                                  really cool like in and in Drupal                                      suppose when you drag in like the menu                                  settings for a node the menu settings                                  are actually a group of fields right                                  it's a drop-down select list and it's a                                  text field and it's all inside of a                                  fieldset and you get to configure all of                                  that you got to configure if the field                                  set is collapsed or not by default                                  whether or not it's in a vertical tab                                  which menu you want to be selected as                                  the default all of those things and you                                  can you basically configure it as a                                  group so if you had a big address field                                  that had a whole bunch of options you                                  would you would the list of options                                  would probably be pretty formidable for                                  something like that if you're                                  configuring five fields at once but you                                  configure them all as a group so i think                                  i think that problem can be solved                                  there's one over here i think in middle                                  no let's go on the back then                                  yeah that's an excellent question                                  something that almost always comes up                                  when I'm thinking about this which is                                  that if you're looking at the display                                  side if you give a user this much like                                  if you get them this close they're going                                  to want to be able to do everything                                  they're going to want to be able to do                                  layout right they're going to want to be                                  able to do columns they want their                                  they'll be want to be able to do                                  everything and unfortunately what you're                                  doing here is you're just configuring an                                  array right an array is by definition                                  its linear right top to bottom and so                                  the interface that you have here is also                                  linear because it's essentially an array                                  editor but that doesn't mean that you                                  couldn't do something to sort of fake                                  some layout in here and I'm not sure                                  that's a good idea but you could do                                  something like add in as many rappers as                                  you wanted like the forms already have                                  the ability to do field sets you could                                  drag in a div that is maybe called left                                  column and a div that is right column                                  and then put stuff into it and form                                  builder would work fine with that so you                                  basically could drag in structural                                  elements than nest things inside of                                  there and how that would actually work I                                  don't know you have some additional                                  things that say                                  yeah so could you provide like a set of                                  templates or something like that that                                  that provide layouts not at this moment                                  I mean and think it's it's technically                                  possible but how you do that I'm not                                  sure so we've only got a couple minutes                                  left here so I've got one or two more                                  slides I'd like to run through and then                                  we'll do the last questions that we can                                  so let's talk about what sort of                                  requirements we have for actually                                  getting this into core like actually                                  making this into a reality and rather                                  than something that's think and trib                                  well there's a couple really obvious                                  ones like stated data object cache                                  storage from c tools like the way that                                  views has the ability to edit a whole                                  bunch of stuff all at once and then safe                                  and form builder does the exact same                                  thing right now form builder is just                                  imitating the approach used by views                                  when it could be using c tools that                                  provides the exact same functionality                                  and that should go into core there's no                                  reason why we wouldn't want that it                                  would also be nice because with multiple                                  modules doing this right now well now                                  see tools this is a central place but                                  would be nice if that was in court                                  there's also a module called options                                  element that I didn't really mention as                                  I was using it but when I was editing                                  that grid and I added another option                                  there there's a special module that                                  provides nothing but the ability to                                  provide select list options or radio                                  buttons that provides you know field                                  field field field field with little                                  pluses and minuses and drag and drop                                  handles which is way better than asking                                  users to type a list of options into a                                  text area with a pipe in between them                                  right that's just like it's a little bit                                  a little bit kludgy so options element                                  solves that problem specifically we need                                  to convert all settings as much as                                  possible on the field level the widget                                  level and the formatter level into                                  properties like pound properties so that                                  when you render something out of the                                  formatter you're not just checking                                  directly against the field settings                                  which is what a lot of modules to right                                  now they just look inside what's the                                  pound fields type and what's the pound                                  field name and then they load the field                                  from the database and then check the                                  settings                                  what we should be doing is we should be                                  doing that loading earlier on and                                  setting properties on there so form API                                  or so form builder is aware of those                                  properties and can actually edit them                                  every field must have a discrete                                  function for generating a preview so if                                  you do something I can drag in the menu                                  from there the menu options there needs                                  to be a function that provides exactly                                  the menu options and right now things                                  like the menu options are basically                                  hard-coded into a hook form altar and                                  it's impossible to get them out                                  specifically without a discrete function                                  and lastly each field must be able to                                  provide a set of defaults including the                                  label default value a list of options                                  etc so this is a good idea anyway                                  providing good defaults speeds up the                                  processes in a lot of areas but this is                                  an absolutely necessity if you're going                                  to be dragging in fields you need to                                  have enough information actually render                                  that thing immediately which means                                  setting a good set of defaults so we                                  actually don't have any time at all from                                  for more questions but I feel like we                                  got a lot of them covered and actually                                  the small discussion that we had here                                  today actually was worth about three                                  months of issue queue back and forth                                  bantering so I feel like this is a                                  really productive session for us but if                                  you can locate this session on the                                  London                                                                    session link there's also the slides are                                  already up on on the site and as                                  promised if you would like to receive                                  twenty dollars off first month of                                  dribble eyes me video dribble tutorials                                  there's a coupon code specifically for                                  your attendees here thanks very much for                                  coming guys                                  you
YouTube URL: https://www.youtube.com/watch?v=A-gNQp2kzM0


