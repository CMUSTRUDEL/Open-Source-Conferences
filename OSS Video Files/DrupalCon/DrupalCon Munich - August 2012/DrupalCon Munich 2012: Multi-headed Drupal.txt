Title: DrupalCon Munich 2012: Multi-headed Drupal
Publication date: 2013-03-29
Playlist: DrupalCon Munich - August 2012
Description: 
	One of the strengths of Drupal is that it's not just a tool for building a single website. It can be used equally well for managing multiple companion sites together. This capability has existed for many years, but is not always well understood. And in true Drupal fashion, modern Drupal has several different options available for users looking to run a series of Drupal sites together, each with its own trade-offs.

This session will explore several leading ways to handle a multi-headed Drupal installation, including Domain Access, Organic Groups, and Multi-site. It will also ask the question of whether a multi-headed Drupal is necessary in the first place; often it is not. Attendees should come away better-armed to evaluate how, and if, to roll out Drupal for a multi-part site.

Slides are online here: http://www.garfieldtech.com/presentations/dcmunich2012-multihead/
Captions: 
	                              okay all right thank you everyone for                               coming I think we're getting a little                               bit of echo on this thing the session is                               multi-headed drupal my name is Larry                               Garfield you may know me as Krell online                               i'm a senior architect at palantir net                               or a drupal development shop based in                               chicago in the united states I'm an                               advisor to the drupal association for                                Drupal                                                           context core initiative lead a co-author                                of Drupal                                                              publishing who here is actually also                                does programming okay wow this is a site                                building track right okay making sure                                and I talked about software architecture                                lot and shoot my colleagues with nerf                                guns that's pretty much all you need to                                know about me a palantir we work mostly                                with institutional not-for-profits so                                universities museums newspapers and                                these papers are not for profits or if                                these days right okay a couple of people                                in here who used to work for a newspaper                                so it's like a the Journal of Foreign                                Affairs Field Museum of Natural History                                in Chicago sort of ours one of the                                largest natural history museums in the                                world open source com run by red hats we                                helped build that along with Aria                                marketplace org which is a major public                                radio station in the United States and a                                lot of the institution's we work with                                run into a common problem where they                                want lots and lots of Drupal sites but                                they don't want lots and lots of Drupal                                sites and so you've had to figure out                                what to do with that problem a number of                                times and I refer to this as                                multi-headed Drupal multiple Drupal head                                saying okay all right so let's have an                                example say you're building a site for a                                university who's built sites for                                universities before yeah you probably                                know everything I'm talking                                out here so they've got three different                                colleges within the university or maybe                                they have                                                              has four different departments or maybe                                they have                                                               large number of different subgroups                                within the organization that's all have                                different needs maybe and your van IT                                department who because it's university                                are woefully underfunded and woefully                                understaffed and they just want to keep                                things simple for themselves they don't                                want to have to coordinate you know a                                thousand different websites that's with                                what they're trying to get away from by                                moving to Drupal of course each of the                                departments wants to be their own unique                                special snowflake because their                                academics and so of course they are                                special and important and different than                                everyone else in the exact same ways                                everyone else in the university who is                                run into this problem before yeah I feel                                your pain so how do we go about                                balancing these different needs there                                are a lot of different ways to do that                                actually as in everything else in Drupal                                the answer is it depends you have                                options there's more than one way to do                                it what we're going to talk about in the                                next hour is a variety of different ways                                that you can go about addressing this                                problem of I want one site but I want                                many sites at the same time and try to                                provide a framework and a guideline for                                how you go about deciding which of these                                is going to be appropriate if you're                                here looking for a silver bullet I                                apologize you're not going to find it                                because there isn't one oh that the                                people are laughing was that people who                                are looking for a silver bullet the                                really important slide with the                                information you want us at the very end                                so you can't leave yet so we're not                                talking about hard rules here we're                                talking about guidelines about a                                heuristic for deciding which set of                                tools is appropriate for each case and                                all of them will have their use case                                so option one point is don't unify them                                just go ahead and run a bunch of                                different Drupal sites there's nothing                                inherently wrong with dealing with a                                 single web presence by having lots of                                 different sites biggest advantage it's                                 simple everything you need to know you                                 already know or have gotten from some                                 other session already and you can just                                 give each departments each organization                                 each subgroup whatever their own drupal                                 install and maybe you centralize the                                 build of it maybe you don't but it's                                 just a separate Drupal don't complicate                                 matters this is a viable option benefits                                 of that you have a standard platform in                                 Drupal you don't need to worry about                                 some people in Drupal salon joomla among                                 sharepoint someone WordPress it's all                                 Drupal and you still have that                                 standardization that still helps your IT                                 department there's no added complexity                                 everything you already know about Drupal                                 still applies everything you know what                                 views is the exact same way this way                                 it's just more of it everything you know                                 about panels or context module or fields                                 whatever you're doing it you already                                 know all of these things it also means                                 each implementation each site can be                                 different it means you can have                                 different content types on different                                 sites because they are different it also                                 means you can mix drupal versions who                                 here has worked with a site that are a                                 client that has wanted to roll out a                                 couple of sites over the course of two                                 years mm-hmm and in two years time you                                 really want to be working on whatever                                 the next version of Drupal is two years                                 from now I plan to be using Drupal                                      you have that kind of situation this is                                 the only option that will let you say                                 these sites aren't triple six these are                                                                                                      that you have to make them separate                                 sites on the downside though you really                                 don't get any economy of scale you're                                 not taking advantage of any of drupal's                                 ability to centralize things aside from                                 the fact that it's all Drupal and you                                 don't automatically get any                                 standardization so                                 just because you know how the content                                 structure is on this department site                                 doesn't mean you know anything about                                 this department site the history                                 department and the biology department                                 have nothing to do with each other so                                 it's harder to retrain administrators                                 from one to the other and if you're an                                 admin then it's more work for you                                 because if a new security release comes                                 out that's                                                              go an update and QA before you update                                 right you're all nodding your head ok                                 ways to improve that and mitigate some                                 of these downsides features module is                                 anyone not heard of the features module                                 good features module we all use at this                                 point dump configuration to code builds                                 packages of functionality and then                                 sometimes you can easily distribute that                                 we've done this for a client where we                                 rolled out a multi-site for them at one                                 point really early on and then they                                 wanted to add some functionality to all                                 of their sites so he said okay built a                                 new feature module for them email the to                                 them and they just dumped it on each one                                 of their sites and enabled it good to go                                 and had a content type or to a couple of                                 use some new module dependencies worked                                 great install profiles if you're rolling                                 out a lot of similar sites these are                                 really helpful slope profiles have been                                 around since Drupal                                                      of Drupal                                                                themselves there's a few differences but                                 for the most part you can treat them as                                 if they were a complete module which                                 means you can do anything you can do in                                 a module with an installed profile they                                 can implement hooks they can especially                                 implement alter hooks at palantir we                                 have a small install profile that we use                                 that doesn't do a great deal except it                                 for Moltres out the promoter front page                                 and sticky flags on all node forms                                 because really who uses those anymore                                 now that we've got the flag module that                                 isn't limited to just administrators so                                 you can do that kind of stuff in an                                 install profile                                 you also get however a complete install                                 wizard these can be really simple or                                 really really complex you can have them                                 create content types for you just as                                 part of the install and in fact if you                                 just run the normal drupal install                                 process the content types you get out of                                 the box page and article those come from                                 the install profile there's nothing                                 baked into drupal about those you can                                 create default content if you want so if                                 you want to pre-populate some sample                                 contents if you want to pre-populate you                                 know every department is going to have                                 an about page that works almost exactly                                 the same go ahead and throw that in                                 there makes life easier you can set up                                 user roles if you want to and users so                                 you know you have five administrators                                 are part of every site go ahead and set                                 up that user just a part of the install                                 anything that's a variable in the                                 configuration where you give the                                 settings system settings form you can                                 set those pretty much anything in Drupal                                 that has a solid API which is                                 unfortunately not everything but it's                                 most things you can pre-configure in an                                 installed profile these can be really                                 really simple or really really                                 complicated and when you combine an                                 install profile especially the more                                 advanced ones with features you get                                 distributions this is probably where you                                 want to go if you're rolling out a bunch                                 of similar sites internally in your                                 organization a distribution is a web                                 application that happens to have been                                 built with Drupal that's pretty much                                 what it comes down to one of the                                 earliest was open atrium people heard of                                 this before open atrium mm-hmm project                                 management tool built on Drupal                                        doesn't look a great deal like drupal                                 managing news and other early                                 distribution it's good for us content                                 aggregation and stuff for building new                                 sites drupal commons is an internet in a                                 box from aquia more recently things like                                 open scholar are aimed at academia for                                 an academic department so if you just                                 want to roll out a bunch of different                                 academic department sites just install                                 this and be done with it it covers a lot                                 of what you need who actually seen the                                 drupalcon website                                 why did it take so long for you to raise                                 your hands they hope you've all have                                 seen that that's running a distribution                                 called Cod conference organizing                                 distribution which is used by at this                                 point all drupalcon sites and most                                 drupalcamp sites it's a net distribution                                 that out of the box offers session                                 management it offers tracks it offers                                 voting on sessions all of that kind of                                 fun stuff just right there for you open                                 Academy is a fairly recent one similar                                 to open scholar and that it's targeted                                 at academia but it's built with panels                                 top to bottom it's kind of cool have a                                 look at it and you can build your own                                 these are not difficult things to build                                 it's just uninstalled profile and a                                 couple of features modules can be as                                 simple as complicated as you want and                                 there's two hundred some-odd listed on                                 drupal.org if you want these slides will                                 be online you can follow these links or                                 just go to Drupal that org slash                                 projects less distributions and you see                                 if any of these Drupal in a box solve                                 your problem or are close enough to                                 solving your problem good example here                                 the Field Museum I mentioned earlier we                                 built a microsite system for them they                                 wanted to spin up a brand new website                                 for each one of their exhibitions they                                 had and the horse was their first                                 exhibition and we just built an install                                 profile for them that covered eighty                                 percent of what they wanted for any                                 given exhibition based theme some basic                                 content types media module came                                 pre-configured WYSIWYG already set up                                 don't don't need to download anything                                 extra all of their text formats are                                 configured with the right tags they want                                 to allow the custom user role they had                                 just all of it done out of the box and                                 they can then build a new exhibition                                 site in an afternoon building a drupal                                 site in the afternoon is pretty cool                                 okay they all look alike they wanted                                 them to all look alike very often that's                                 fine another option though if you want                                 to get some efficiency is multi-site in                                 this case you've got a single Drupal                                 code base but splits configuration split                                 database                                 separate content separate users miss                                 Bella features since at least Drupal                                     I came into Drupal in                                                I've talked to said well it's been                                 around its Lee since                                                   older than that i'm not entirely sure                                 basic idea you have a single drupal code                                 base but you run many sites off of it                                 who's done this before wow so you all                                 know everything i'm talking about why                                 are you even here I'll just go home this                                 lets you run sites that are for all                                 intents and purposes separate websites                                 but with a single code base and you know                                 it's fairly simple to set up you say                                 okay off your Drupal root directory you                                 have a sites directory we all know this                                 and there's the site's default directory                                 wonder why that's there settings PHP is                                 their configuration for that site but if                                 you set up a different directory that                                 matches the domain name that gets                                 requested then it uses that instead you                                 get a different settings file that                                 different settings file points with a                                 different database you have a completely                                 different site and you can have as many                                 of these as you want they don't have to                                 all be on the same main domain if you                                 don't want them to be as of Drupal                                       can now alias them too so I think this                                 is the only PHP code in this session so                                 don't be scared so you can say you know                                 if a request comes in for this domain                                 use this directory name under sites                                 progress comes in for this domain use                                 this one and so forth and you can                                 actually have multiple domains that                                 point to the same directory and then you                                 set up your DNS records that say all of                                 these                                                                    on disk the same virtual hosts and                                 apache and this is really helpful for                                 development I've got my development                                 server I've got five other people                                 working on there on the site and their                                 own directories but you don't want to                                 have to change the site directory                                 structure all the time so just say okay                                 layer                                 sandbox maps to dev Bob sandbox map the                                 dev Jill sandbox map the dev and so                                 forth and then the domain part still                                 works but all of these aliases do as                                 well you technically can also use sub                                 directories in here and different port                                 numbers but honestly in my experience                                 sub directories are just way too hard to                                 sit up and they're kind of buggy so                                 don't bother assume that you can only                                 view do domains it's just going to be                                 easier trade-offs hear everything I said                                 about separate sites is true here you                                 get all the same benefits in terms of                                 Independence except you only have one                                 code base to update which means you only                                 have one git repository because you are                                 using version control for your site                                 right I hear a couple of nervous laughs                                 so when you start using version control                                 pretty sight you only need one                                 repository another important one that is                                 often overlooked is the lower memory                                 overhead who hears running a PC or an                                 opcode cash on their sites good if                                 you're running Drupal do you want to be                                 doing that an opcode cash like a PC                                 caches the compiled version of all of                                 the code files which is a huge memory a                                 huge performance improvement it caches                                 it / filing so if you have                                           sites installed separately on the same                                 server then you have                                                     ink that are cash in memory if you have                                                                                                        with multi-site you have one copy of                                 commenting Cashin memory and you use                                                                                                          means you need                                                          keep up with demand and your budget                                 people will love you for that something                                 else you can do is table sharing duple                                 does have the ability to prefix tables                                 in the database and change the prefix                                 per day per table which means you can                                 have tables that are shared between                                 different Drupal sites please do never                                 never ever do this I've done it exactly                                 once                                 it was a mistake the site works mostly                                 it makes upgrade and maintenance a                                 nightmare so it's a feature but please                                 don't use it I don't think it's going to                                 get taken out at any point but please                                 don't use it it's more of a side effect                                 than anything else on the downside                                 pretty much all of the same downsides we                                 talked about before except that you can                                 only have one core version at a time not                                 just major version but minor version if                                 you're going to upgrade to seven dot                                    when that bug release comes out you have                                 to upgrade every single one of your site                                 at the same time which means you only                                 have to do it once but it means you have                                 to test them all at once you can                                 maintain different versions of modules                                 for different sites but it's kind of                                 tricky because you have to have module                                 overrides and stuff and be very careful                                 like where things get cached it's just                                 kind of gross I recommend avoiding it if                                 you can as a general rule if you or your                                 client have one server administration                                 team who's responsible for a site go                                 ahead and use multi-site make life                                 easier for them if you have several                                 different teams go ahead and make them                                 separate sites and then the teams don't                                 have to coordinate and yell at each                                 other they can just do their own thing                                 good example here this is a very old                                 site that we built back in early Drupal                                                                                                         module which means we built it using a                                 partial database dump to it set up a new                                 site rather than an installed profile I                                 would recommend the install install                                 profile and features approach even for                                 multi-site these days give them for base                                 themes to choose from for each site for                                 each academic department and the process                                 for setting up a new site was dead                                 simple clone the database flush the                                 cache setup settings PHP start pushing                                 buttons they could customize the theme a                                 bit with color module Gans if they                                 really wanted to they could start                                 playing with the you know field                                 configuration and so forth generally                                 they didn't but they could but then they                                 still only have one copy the site on                                 disk worked out                                 but honestly when a client says that                                 they want multiple websites they                                 probably don't mean it not because                                 clients are stupid but because clients                                 don't understand the trade-offs in                                 Drupal that's your job a couple of                                 options here if you want to have a                                 single Drupal site domain access being                                 the first one most of the clients we                                 deal with who say they want multiple                                 sites this is actually what they want                                 with domain access you have a single                                 code base a single database single set                                 of configuration but you can split your                                 content up between different domains or                                 not and then your user base is shared                                 across all of the different sites doing                                 access is an access control module uses                                 the node access system but instead of                                 doing access control based on does this                                 user have this permission does this user                                 and have the right role it does access                                 control two nodes based on the domain                                 that was used to access the site it's a                                 really weird hack of the note access                                 system but it works very very well I                                 will warn you it does use the nose node                                 grant system so be careful if you try to                                 use multiple no taxes modules weird                                 things happen if you want to know how to                                 deal with those weird things that's an                                 entirely separate session into its own                                 but it can still work really well each                                 domain then is that subsection of your                                 site not necessarily a different sub                                 domain you can run any arbitrary domain                                 as part of a domain access setup the one                                 caveat for that is if you have one                                 Drupal edu and two def Drupal that edu                                 then you can log into one and still be                                 logged in on the other if you have                                 Drupal that edu and joomla edu then the                                 browser won't let you share a session                                 across that's just the way HTTP works                                 domain access primarily affects node                                 view it restricts when a node will be                                 available and viewable and exactly a                                 fairly decent suite of modules built up                                 around it the main modules just called                                 domain but there's a couple of modules                                 in that repository                                 as well as a number of other modules                                 maintained by other people built up                                 around it so quick very quick rock                                 through with domain access you can set                                 up different domains you give them names                                 in the UI set up which one it's going to                                 be the default which ones are active                                 this is one drupal install remember only                                 one copy of the database one copy of                                 files on disk in six different domains                                 can be set for HTTP or https if you want                                 to so you can have an administrative                                 only domain you can this is one of the                                 really cool things is the main access                                 you can actually override most variable                                 settings / site / domain so you want a                                 different site name for English                                 department German department to history                                 department biology department go ahead                                 you want to change the site slogan fine                                 different homepage fine and most                                 configuration you can override this way                                 including the theme it's very very easy                                 to have a different theme per domain now                                 you probably want those themes to be                                 sub-themes of each other find whatever                                 that doesn't matter as far as domain                                 access is concerned you can colorize it                                 / because the colors are a setting you                                 can I believe colorized that / site so                                 they use the same theme for different                                 domains but with a different color                                 scheme you can even set different time                                 zones this is really useful when you're                                 working on say a syndicated magazine and                                 you have some magazines in one time zone                                 and some magazines of another time zone                                 it's really important to show that kind                                 of information in the correct time zone                                 people get very cranky if their                                 newspaper has the wrong time zone then                                 you go and edit a node you get this                                 additional option say okay which domains                                 should this node belong to which domains                                 should return and access true for this                                 node and which should return access                                 false and then when you save it just all                                 right                                 assigned to this d'Alene is the source                                 domain that's the official domain so                                 because you with this you have content                                 showing up on multiple sites you want to                                 make sure that Google doesn't hate you                                 and think you're a spammer so this just                                 sets up a rel canonical in the header to                                 say no Google really this pic the real                                 version of this page is here I know it's                                 duplicate content don't hate me you can                                 also then take all of the same                                 information and apply it in views so you                                 can have views that only appear on                                 certain domains you can have views that                                 filter by domain so any of your domains                                 / upcoming events just have that auto                                 filter to whatever the domain is so you                                 only see content that is relevant to                                 that one domain really cool and then                                 here you can see you know this node is                                 part of these two domains this note is                                 part of these domains and so forth so                                 that's the only domains work will show                                 up benefits here you've only got one                                 Drupal site it looks like several but                                 you've only got one Drupal site you can                                 do content sharing really really easily                                 content sharing between separate Drupal                                 installs is really hard there are ways                                 to do it I've done it it's really hard                                 it requires custom work for each site                                 generally this way you push a couple of                                 buttons and note and nodes get shared                                 between different domains you have the                                 separate theme for each site you get                                 some configuration per site and you get                                 a consistent architecture your node                                 types are the same across all of your                                 domains your views are the same it's one                                 administrative experience it's one set                                 of users so you can have one                                 administrative user who handles                                    domains with one user account because he                                 just logs in and pushes buttons and goes                                 to whichever domain you want sand moves                                 content around and it's really easy on                                 the downside you you have a consistent                                 architecture you cannot vary your node                                 structure between different domains                                 because it's the same Drupal it's just                                 doing content filtering you only have                                 the option of using multiple domains if                                 you want to have different sites managed                                 together that are not really separate                                 domains which sub directories                                 not going to work they tried at one                                 point it doesn't work at all it uses the                                 net access system here be dragons there                                 are performance issues when you get into                                 super large sites with that and said if                                 you try to install multiple like domain                                 access and taxonomy access control weird                                 things happen and you have to sort it                                 out manually it's also a single point of                                 failure if you upload a broken version                                 of a module inadvertently you don't                                 break one site you break your entire web                                 presence not always the best thing and                                 everything gets a little bit more                                 complicated because everything you do                                 you need to keep track of okay what                                 domain do I need to be filtering for you                                 need to remember to set that on all of                                 your views when you're making them you                                 have to think about okay these four                                 domains they actually need different                                 fields I have to put those fields on all                                 of them just you have to be more aware                                 of what you're doing a good example here                                 who saw Ken rickards talk on Environment                                 America earlier this week few people                                 okay go back and look at the video if                                 you want to see this in more depth this                                 is a domain access site we built earlier                                 this year they have one national site in                                 the United States and then they wanted                                 easy content syndication to all of their                                 local affiliates so there's environment                                 America and then environment Illinois                                 environment Massachusetts environment                                 Texas and so forth and they wanted to                                 easily share content across all of those                                 sites so I just set up some as a domain                                 access site the sites are all fairly                                 similar but that's fine that's exactly                                 what they wanted and they only have to                                 pay to maintain one site they can have                                 one administrator take care of                                 everything much much easier it's also                                 one site to have to build which saves                                 you money too if that's not your bag                                 organic groups is another optional most                                 of the same options here with shared                                 users or split users if you want it's a                                 very important distinction organic                                 groups is a fairly old control who's                                 used groups that Drupal at org that's                                 organic groups for in Drupal                                       triple seven it was completely rewritten                                 from the ground up                                 revised again it's now I think beta                                 version of organic groups to for Drupal                                                                                                       wouldn't have recommended OGG it's                                 properly pronounced oggs an OGG the                                 caveman oh gee that maintainer say oh                                 gee they're wrong it's actually OGG took                                 your moment but it's actually fairly                                 nice in Drupal                                                           entity node user taxonomy term whatever                                 can be promoted to being a group and                                 then any other entity can be assigned to                                 be a member of that group users can then                                 join a group so you have this cluster                                 called a group that can be anything that                                 can have anything in it and users can                                 subscribe to it this could be you know a                                 department create a department node and                                 then users can join that department it                                 can be a working group like on groups of                                 drupal org you can make a user into a                                 group and then users can subscribe to                                 that user as a form of fan club lots and                                 lots of options here if you do stuff                                 with the commerce module you can make a                                 product into a group and then users can                                 subscribe to that group to get                                 information about that particular                                 product lots you can do here gives you a                                 fairly good amount of access control                                 that wouldn't wouldn't have been                                 possible in Drupal                                                       have rolls per group this is new and                                 Drupal                                                                 have members that are part of just some                                 groups and others you can add further                                 access control to say you could only see                                 content that's in your group you can                                 only edit content that's in your group                                 only delete content that's in your group                                 per node type so you can set up a system                                 that says this user is a member of this                                 group and has this particular role                                 therefore they have permission to acts                                 to edit page nodes but not news nodes in                                 this other group they have this other                                 role so they have access only to post                                 new news notes but                                 edit them and in this other group                                 they're not a members they can't do                                 anything they don't even know it's there                                 fairly straightforward to set up it has                                 very solid integration at this point                                 with views with sequels and panels this                                 is one of the big changes from organic                                 groups one to organic groups to this                                 used to be a lot clunkier the new                                 version is much much nicer comes with                                 some really nice sample views I was able                                 to pick it up in an hour or two honestly                                 in version                                                             chaos suites views panels see tools that                                 family of the world works really well                                 with organic groups is our meat I here                                 okay a maintainer of this module army                                 type burstiness here somewhere if you                                 see him give him a hug so when you're                                 editing a node or any feel double entity                                 with organic groups you can say okay                                 this node type should be a group type or                                 it should be able to be put into a group                                 and you can configure this per node type                                 and you can check both which means you                                 can have an entity that is both a group                                 and can be put into a group and you can                                 do some really weird stuff with that I                                 haven't gone to that level of complexity                                 but experiment with it see what you can                                 do again one drupal site but you're able                                 to segment your content and your users                                 this way and said you can have separate                                 roles and permissions so in this case we                                 have you know what permission do people                                 are not a member have what permission do                                 people who are members have so you can                                 say if even if you're not remember you                                 can still you know edit content if you                                 wanted to the administrator member I                                 think that one's built in you can add                                 additional roles you can even                                 reconfigure this per group so this group                                 has three roles this group has five                                 roles and the permissions are different                                 you can do that it works that's a double                                 some of the benefits with organic groups                                 again only one Drupal site that you have                                 to manage it's only one copy of the code                                 one database to backup you get really                                 easy content sharing you can configure                                 it so that a node can be placed into any                                 number of groups or just one group or no                                 more than five groups up to you you can                                 have a separate theme / group with the                                 autumn add-on module two separate                                 contribute you have to deal with could                                 be a good could be a bad depends on your                                 use case but everything is on a single                                 domain there is add on module that sort                                 of works the move pressures across                                 multiple domains but I haven't really                                 played with it a great deal I don't know                                 how well it works what's that okay and                                 again a consistent architecture all of                                 you know types are the same your                                 administrative users are the same your                                 views are the same it's much easier to                                 manage than having a bunch of different                                 sites that they go to on the downside                                 everything we just said only one domain                                 you can't really push it across multiple                                 domains well you have a consistent                                 architecture that you cannot really                                 change you do not have the ability to                                 break out settings / group the way you                                 do with domain access mostly it's                                 permission level control you can't say                                 you like the site slogan is different in                                 different groups but you can imp kind of                                 fake that using panels and hidden fields                                 as with domain access you get a single                                 point of failure break one module break                                 the entire web presence and you have to                                 keep track of that everywhere biggest                                 thing here if you're doing anything with                                 panels or views you probably need to                                 make sure to include a group context or                                 a group contextual filter everywhere                                 forget it and you're going to find stuff                                 showing up that you don't expect to                                 example here can't tell you who this is                                 we're working on this client right now                                 so I'm not allowed to talk about them by                                 name until effort launches but every                                 college                                 every department is a group so we have a                                 group node type that we can assign                                 content into we have a bunch of hidden                                 fields on that group node for things                                 like the department name the department                                 slogan an entity reference to a                                 slideshow node to control the slideshow                                 that appears the top of the page that by                                 every department gets their own                                 slideshow but they can configure we're                                 building type of panels everywhere so we                                 can use panels capabilities to pull                                 contextual information from the group                                 out into the header out into the footer                                 which on this site was a requirement                                 we're using panel Iser on this one so                                 they can customize per per page what the                                 layout is still context sensitive to the                                 group we're probably going to have a                                 consistent set of roles between                                 different departments but we are adding                                 custom roles to help support their                                 editorial workflow and it's going to be                                 multiple themes that they define on each                                 departments can then pick their own with                                 the og theme module just by editing the                                 group node again can't really tell you                                 to this one is yet that's it'll be                                 coming out soon but probably you don't                                 mean multiple sites just because your                                 client says it's multiple sites just                                 because they think of it as multiple                                 sites doesn't mean it actually is and                                 you have to keep in mind also you know                                 what is a site what does site mean if                                 the client says I've got                                             they actually have                                                     do they have                                                             groups say                                                          think there are special snowflake which                                 does not necessarily correlate to                                 anything else that's relevant a site                                 could just mean it's your presence on                                 the web it could be the homepage for a                                 particular organization or subgroup or                                 departments or working group within some                                 larger organization                                 they could just mean several paths roots                                 you know separate you know / whatever                                 that's what they mean by sight or they                                 could mean separate access groups if                                 you're talking to a client and they say                                 the word site they say we have multiple                                 sites stop and ask what it is they                                 actually mean figure out what they're                                 actually talking about they probably                                 don't know what they're talking about I                                 don't mean that in a defensive way but                                 it's true if all they want is separate                                 access control within a single site                                 there are a lot of different modules for                                 that my preferences workbench access the                                 model we developed the palantir lets you                                 divide a site in two separate                                 administrative sections users don't see                                 anything or the site visitors don't see                                 anything it's just administrative                                 sections which do not necessarily                                 correspond to paths they may if you want                                 them to usually use taxonomy to define                                 an access hierarchy and then say you                                 have access to the history departments                                 you have access to the biology                                 department you have access to the                                 Sciences College which includes the                                 biology department just a couple of                                 buttons with workbench access and then                                 you can assign users individually or                                 users by role to a section and say this                                 user has access to biology any users in                                 the sciences role have access to biology                                 whatever you want to do this is this                                 primarily affects node edit it has no                                 impact on node view so casual visitors                                 to the site they don't know the                                 difference doesn't have any impact on                                 them it's just an access control                                 mechanism to control who can actually                                 muck with content on the site if you                                 want to change your themes with four                                 different parts of the site you've got                                 options I mentioned the sections module                                 here even though it's not up to Drupal                                   yet because it's the first contributed                                 code to myself in Drupal so it has a                                 special place in my heart but I haven't                                 actually used it in years if you're                                 using panels our panels everywhere then                                 you can have different layouts based on                                 a variety of different rules                                 in context that's an entire session unto                                 itself in Drupal                                                       custom themes and you can just set what                                 your theme is going to be implement some                                 custom rules in there yourself some                                 custom code say when it's Thursday show                                 this theme on these particular pages or                                 whatever or just don't plenty of sites                                 don't actually need separate themes for                                 different quote sites they just need                                 different access control benefits here                                 you really have no additional overhead                                 as with doing separate sites everything                                 you know is already valid there's no                                 extra complexity of what domain of I in                                 which I organic group lie and you don't                                 need to worry about that you only have                                 one code base to manage and it's                                 therefore really easy for both the                                 server administrator and the site                                 administrator they don't have multiple                                 sites multiple posit orys multiple                                 domains keep track of in their head                                 downside though you get a lot fewer                                 options to vary things between different                                 sites you may not need but you have your                                 ability to customize different sections                                 of the site as far as the public is                                 concerned there is only one site maybe                                 you want that maybe you don't and for                                 the most part you only get a single                                 navigation hierarchy some of these                                 others you get the ability to have a                                 separate navigation tree for different                                 parts of your web presence with single                                 site let's assume you've only got the                                 one which again may be what you want and                                 in many cases is for example mount                                 holyoke college in the united states                                 another client of ours they've got a                                 bunch of different departments but they                                 aren't giving each department their own                                 special snowflake capabilities it's just                                 one big site the install workbench                                 accessed say okay Secretary of this                                 department so you could edit your                                 department secretary of this department                                 you can edit your news that's it and                                 that's all they needed that's all they                                 wanted makes life really really easy for                                 everyone involved and then yeah the                                 whole site is one design because they                                 don't have                                 they don't have departments that are                                 super insistent on having a custom look                                 and feel just to prove that they're                                 special it's really nice when you have                                 clients that have that don't have that                                 problem isn't it you can also mix and                                 match these for example one triple                                 install one shared database multiplying                                 mr. onclick multiple domains and then                                 another instance of drupal on the same                                 code base that's set up differently you                                 can run domain access in one site and                                 organic groups in another multi-site and                                 they won't affect each other you still                                 have the one code base benefit but you                                 have separate sites each of which is                                 split up differently so you can mix                                 multi cycle organic groups UNIX                                 multi-site domain access if you have a                                 multi-site you can put workbench access                                 on some or all of them we haven't you                                 know you can in fact mix multi-site                                 domain access and organic groups and                                 have domain access organic groups on the                                 same site on one instance on a                                 multi-site and something else on another                                 and so you can get really complicated                                 here if you want to you probably don't                                 want to unless you need to but it can be                                 a viable option we had a client's we're                                 actually recommended to them you're                                  building a small micro app and you want                                  everyone to use that same micro app                                  you've got a couple of departments that                                  want to be different for the sake of                                  being different but use but they still                                  want you to host them okay tell them                                  we're going to put you all with domain                                  access organic groups into this one site                                  and we'll manage everything for you you                                  don't have to worry or we can put you in                                  a separate instance on that same install                                  with multi-site and you're on your own                                  you don't get support from us I don't                                  think they had anyone take them up on a                                  second offer but the in fact they could                                  say that was helpful example here                                  barnard college yet another panel to                                  your client they have some odd in                                     some odd departments within the college                                  so we've got one install that's using                                  domain access to deal with different                                  comments that way and then within each                                  department they've got workbench access                                  setup so that you can have access to                                  just this part of the physics department                                  that's what they needed that's what they                                  got here's that really important slide I                                  talked about so if your most important                                  features that you want to support                                  multiple core versions then you want to                                  go separate install that's really your                                  only viable option if your most                                  important thing is different content                                  types then separate installs or                                  multi-site are viable options if you                                  want to maintain only a single user base                                  say for your administrators or for your                                  content editors domain access organic                                  groups single site multi-site is not                                  going to do that single or separate                                  installs is not going to do that if you                                  want to split your site up across                                  multiple domains you can do that with                                  separate installs you have multi site or                                  domain access odds not going to cut it                                  single side of course won't cut it if                                  your most important thing is keeping                                  everything on one domain and organic                                  groups or just one big site those are                                  your go-to options if you want to really                                  make life easy for your server                                  administrators and I encourage you to                                  keep life easy for your server                                  administrators because they can easily                                  break your account domain access organic                                  groups or single site one code base one                                  database makes life easy for them if you                                  want to share content between your                                  different sites different presence                                  domain access organic groups a single                                  site for three options that have only                                  one database I said you there are                                  options for doing content syndication                                  between separate installs they are all                                  messy we're working on that for Drupal                                    but right now they're all messy if you                                  want to have separate access control                                  rules / department / group single site                                  organic groups are your options single                                  site there you want to be using                                  workbench access if you want to allow                                  each department to be their own special                                  snowflake                                  and have their own configuration                                  separate installs multiple sites to some                                  extent organic groups if you really                                  trick it out there's a lot you can do                                  there especially when you start making                                  panel Iser and putting views into panels                                  but that also gets weird I try                                  encouraging people away from that unless                                  you really really know what you're doing                                  if you want to have separate views per                                  departments then again separate                                  installments or multi-site make it                                  easier with organic groups you can a bit                                  with domain access you sort of can with                                  some of the access rules on views but                                  it's kind of janky stack of migration                                  this is one we have really talked about                                  if you're not going to be cutting over                                  your entire site at once you're going to                                  move over from whatever you've got to                                  Drupal in bits and pieces that affect                                  your architecture that affects the way                                  you're going to build a site in this                                  case anything that involves multiple                                  separate domains makes it easier because                                  it makes your migration rules easier it                                  means you have to do fewer weird things                                  with your proxy server you can do weird                                  things with your proxy server so that                                  certain paths sometimes go to your old                                  legacy site whatever it is and sometimes                                  go to Drupal I say shenanigans for a                                  reason it's possible at least this is                                  what my server friends tell me I've                                  never actually done that myself I've                                  just been told it's possible so don't                                  ask me what the actual varnish                                  configuration is for that I could I                                  don't know if you want to vary the theme                                  for departments then most of these                                  options will work single site not so                                  much but you've got options if you've                                  got inexperienced site administrators                                  the people building the site are not                                  really experienced in Drupal yet they                                  don't you don't have a couple of sites                                  under the belts that's their first                                  Drupal project keep it simple don't                                  confuse things don't dive into the deep                                  end you're going to hit your head                                  remember these are guidelines if there                                  is no hard and fast rule if you want                                  several of those you're going to have to                                  make trade-offs somewhere                                  you figure out what's going to be the                                  best set of trade-offs in your case and                                  nope no plan a no battle plan survives                                  first contact with the enemy aka                                  actually building it so be prepared to                                  be agile about it questions is there a                                  microphone here someplace of course they                                  don't have a microphone in this room why                                  would they have a microphone in the                                  large room alright i'll go ahead and                                  repeat things yes i can speak up                                  multi-site                                  so every sub site is a separate folder                                  within a single domain probably organic                                  groups or single site multi-site                                  supposedly lets you do that but you have                                  to play games with symbolic links in the                                  file system I try to avoid doing that                                  you could go that option it's just a bit                                  weirder by the I'd look at organic                                  groups first or just making it one big                                  site depending on other factors Oh                                  yellow shirt                                  so question is better best way to                                  organize modules when you doing                                  multi-site I would recommend just                                  putting everything in sites all unless                                  you know it's specific to a single site                                  because because of that APC issue i                                  mentioned if two or three sites are                                  using it out of                                                           or three sites that would have duplicate                                  copies of a code stored in memory at all                                  times that way just because a module is                                  insights all doesn't mean you have to                                  enable it with multi site so you can                                  have you know a module that's insights                                  all disabled on exactly one site the                                  only place and the other side would know                                  about it is in there admin modules page                                  they've look in there they'll see these                                  other modules available but if you don't                                  give someone access to that page they                                  can't do anything about it they don't                                  even know it's there so I would                                  recommend just keeping a single copy                                  whenever possible                                  so the question is how a pc deals with                                  symlinks I don't know yeah I don't                                  actually know I just be guessing if I                                  answer that i would recommend against                                  doing magic with symlinks unless you                                  really know what you're doing because                                  it's one more layer of abstraction that                                  you probably don't want to deal with I                                  know there are people who do a lot of                                  siblings for their modules I don't I                                  have not really dug into how a pc                                  handles that so I don't know questions                                  over here yeah spaces module never                                  worked with it can't really speak to it                                  and I only had an hour so yeah I have                                  not really worked that module I didn't                                  from what little I've seen of it I                                  didn't really care for its approach but                                  I said I have not actually tried                                  building a site with it so i can't speak                                  to its trade-offs other questions                                  so again for the recording first point                                  organic groups does let use configure                                  site such that individual users or some                                  subset of users can spin up new groups                                  at any time which you can't do with the                                  main access you can't do with multi-site                                  that's absolutely true and then question                                  the other question was multi lingual                                  multi sites in Drupal                                                  the main access does do multi lingual                                  multi lingual is always ugly but we have                                  done multilingual domain access sites                                  before that will be my first that we                                  might go to yeah                                  so it's solar search you can either set                                  up a separate solar instance for each                                  instance if it you can set up one solar                                  search / install to excuse me for                                  instance you make sure i get my                                  terminology right per instance so each                                  database that you have can have a                                  separate solar server which means if                                  using single site or organic groups or                                  domain access you have one solar server                                  can't have multiple if you're doing                                  separate sites or multi sites you can                                  set up a separate solar server / site or                                  one solar server and use the solar                                  multi-site module which lets you index                                  multiple sites to a single solar core                                  and then search from any of them                                  filtered or not and then links point to                                  the right place that's actually what                                  rupal that org uses so jupiler org                                  groups that drupal org association that                                  drupal org and so forth are all separate                                  installs but they all use a single solar                                  instance so they're all indexing to the                                  same solar core you can set that up I                                  don't think I've worked with solar                                  multi-core myself but it's not overly                                  difficult than what I understand                                  okay so the point is organic groups does                                  do multilingual and can do separate                                  language defaults per group I'm going to                                  take his word for it this is ami ty                                  burstyn who wrote the new version of                                  organic groups everyone give him a giant                                  crowd hug at the end of the session                                  anyone else single sign-on on drupal.org                                  oh dear single sign on is again a                                  session into its own in general anything                                  with a single database you get single                                  sign-on for free anything that's                                  multiple separate instances it gets                                  weird for drupal.org in particular they                                  developed a custom module called bakery                                  that I've not looked at the code base in                                  a great deal I know it consists                                  primarily of cooking jokes and it does                                  some weird thing with cookie redirection                                  and login sharing I don't know exactly                                  how it works but the module is out on                                  Drupal at org you can install it                                  yourself if you want to and by now it's                                  gotten decent it's gotten pretty decent                                  I know there used to be a lot of issues                                  with not realizing which site you are on                                  and stuff like that but those are mostly                                  been worked out now so if you are doing                                  multiple installs but want shared user                                  base bakery is an option there what                                  actually does there is you have a                                  separate user account on each site but                                  when you login to cite a it does some                                  magic with HTTP so that you're logged in                                  to site B with the same account or with                                  your matched account over there like                                  when you log in when you visit                                  drupal.org that's one user on one                                  database you visit Munich                                                that's a different user in a different                                  database different permissions on that                                  site                                  but it does weird things with cookies so                                  that's you log in one side you get log                                  down on the other I don't know the exact                                  details how it works but the modules on                                  Drupal it or you can have a look yeah                                  I'm sorry                                  yes I'm saying I'm sorry                                  so the quick question again for the                                  recording is when you've got                                           and nine languages on a single install                                  the admin can get unwieldy and what do                                  you do about that yes it can usually                                  what I'd recommend at that point is                                  figure out what users will actually need                                  on that site and custom builds of                                  administrative views for them but do                                  just that and if you need to filter that                                  by domain do so if you need to filter                                  that by language do so if not don't in                                  Drupal                                                                    I workbench access is part of a suite of                                  modules that's intended as a here's the                                  administrative experience for content                                  editors because Drupal out of the box                                  doesn't do a good job of that workbench                                  gives you a nice little dashboard for I                                  just want to edit my content and that's                                  it and it's all built around views so                                  you can go in and tweak that to make a                                  domain sensitive language sensitive and                                  so forth if you need to but I don't                                  think there's a global answer other than                                  figure out where people will actually be                                  doing on the site in practice and custom                                  build that administrative experience for                                  them and then most people don't need to                                  worry about it because you've pre-built                                  it for them yeah that's one of the extra                                  overhead things it can get weird when                                  you have that level
YouTube URL: https://www.youtube.com/watch?v=Gdpa2ZrS30w


