Title: PLATFORM.PH - Lando and Platform.sh Demo   DrupalCon Europe 2020
Publication date: 2021-01-13
Playlist: DrupalCon Europe 2020
Description: 
	Lando and Platform.sh Demo.
Captions: 
	00:00:04,059 --> 00:00:09,889
[Music]

00:00:13,360 --> 00:00:17,520
all right

00:00:14,320 --> 00:00:19,199
well i see people are coming in and it

00:00:17,520 --> 00:00:21,920
is time to start

00:00:19,199 --> 00:00:23,680
so rather than make people wait uh i'm

00:00:21,920 --> 00:00:26,400
going to get going right away

00:00:23,680 --> 00:00:27,439
introduce myself and use all of the 15

00:00:26,400 --> 00:00:28,560
minutes that we have for this

00:00:27,439 --> 00:00:31,679
presentation

00:00:28,560 --> 00:00:33,200
my name is robert douglas and i'm from

00:00:31,679 --> 00:00:36,160
platform sh

00:00:33,200 --> 00:00:37,040
and uh today i'm going to show you the

00:00:36,160 --> 00:00:40,719
integration

00:00:37,040 --> 00:00:43,760
between platform.sh and lando

00:00:40,719 --> 00:00:44,719
which is a well-known tool in the drupal

00:00:43,760 --> 00:00:48,480
community

00:00:44,719 --> 00:00:51,199
for enabling local development

00:00:48,480 --> 00:00:52,879
of drupal sites or other sites and then

00:00:51,199 --> 00:00:56,320
coordinating usually with

00:00:52,879 --> 00:00:57,840
some cloud hosting provider to deploy

00:00:56,320 --> 00:00:59,440
the sites that you've developed with

00:00:57,840 --> 00:01:02,640
lando

00:00:59,440 --> 00:01:05,199
so let's get right into it because

00:01:02,640 --> 00:01:07,360
15 minutes is barely enough time to show

00:01:05,199 --> 00:01:10,720
the most important stuff

00:01:07,360 --> 00:01:10,720
and i'm going to share my screen

00:01:11,200 --> 00:01:16,080
great hopefully everybody sees that what

00:01:14,159 --> 00:01:19,439
am i looking at here

00:01:16,080 --> 00:01:22,720
this is a drupal project

00:01:19,439 --> 00:01:25,200
on platforms h it's called drupal 8

00:01:22,720 --> 00:01:26,400
multi-site because in fact it's

00:01:25,200 --> 00:01:29,520
demonstrating

00:01:26,400 --> 00:01:32,640
uh platform sh's native ability to run

00:01:29,520 --> 00:01:34,159
drupal in a multi-site configuration uh

00:01:32,640 --> 00:01:37,280
and i can show you that easily

00:01:34,159 --> 00:01:40,159
so i've got my master branch here

00:01:37,280 --> 00:01:41,439
and if i look at the urls i've got a url

00:01:40,159 --> 00:01:45,200
that says

00:01:41,439 --> 00:01:48,799
first and that is just a plain old

00:01:45,200 --> 00:01:49,280
drupal 8 site and i've got a url that

00:01:48,799 --> 00:01:53,040
says

00:01:49,280 --> 00:01:54,320
second which is i installed this site as

00:01:53,040 --> 00:01:56,399
the umami uh

00:01:54,320 --> 00:01:58,520
profile so these are both just you know

00:01:56,399 --> 00:02:01,759
uh basic

00:01:58,520 --> 00:02:03,920
unchanged installations of drupal but

00:02:01,759 --> 00:02:07,040
you can see from the url that they're

00:02:03,920 --> 00:02:09,759
running on a multi-site configuration

00:02:07,040 --> 00:02:11,280
okay so that's good a good starting

00:02:09,759 --> 00:02:14,560
point

00:02:11,280 --> 00:02:17,200
uh now what's down here this

00:02:14,560 --> 00:02:17,840
is the um these are the other branches

00:02:17,200 --> 00:02:21,440
that i have

00:02:17,840 --> 00:02:22,400
active and on platform sh if you're not

00:02:21,440 --> 00:02:24,640
familiar with it

00:02:22,400 --> 00:02:26,879
every git branch that you create on your

00:02:24,640 --> 00:02:30,319
repository can be tested

00:02:26,879 --> 00:02:32,959
as a complete application uh

00:02:30,319 --> 00:02:34,160
separate from the production which is

00:02:32,959 --> 00:02:36,000
the master branch

00:02:34,160 --> 00:02:37,760
so for example if i were the person

00:02:36,000 --> 00:02:38,800
working on the e-commerce feature for

00:02:37,760 --> 00:02:41,519
site one

00:02:38,800 --> 00:02:42,239
down here i could come and i could see

00:02:41,519 --> 00:02:45,599
again

00:02:42,239 --> 00:02:50,800
the first site which is uh

00:02:45,599 --> 00:02:53,840
doesn't have its tls provisioned

00:02:50,800 --> 00:02:57,519
but there it is and i could go to

00:02:53,840 --> 00:03:01,040
the second site uh same with tls

00:02:57,519 --> 00:03:04,560
and there's

00:03:01,040 --> 00:03:07,040
the umami so this is uh

00:03:04,560 --> 00:03:08,480
really nice because uh one of the hard

00:03:07,040 --> 00:03:12,080
things to set up when you're

00:03:08,480 --> 00:03:15,360
doing a multi-site uh project

00:03:12,080 --> 00:03:19,200
is testing the individual sites uh

00:03:15,360 --> 00:03:22,000
in isolation with real working urls that

00:03:19,200 --> 00:03:23,760
mapped each site and platform sh does

00:03:22,000 --> 00:03:26,720
that natively now in the back end

00:03:23,760 --> 00:03:28,560
here we've got the php we've got the

00:03:26,720 --> 00:03:29,599
mariadb database and we're using the

00:03:28,560 --> 00:03:31,519
redis cache

00:03:29,599 --> 00:03:33,760
we could also add other services very

00:03:31,519 --> 00:03:37,840
easily here including

00:03:33,760 --> 00:03:39,599
solar or memcache or varnish

00:03:37,840 --> 00:03:42,480
those are very common ones in the drupal

00:03:39,599 --> 00:03:45,280
scene but elasticsearch or kafka

00:03:42,480 --> 00:03:46,400
or mongodb would also be possible in any

00:03:45,280 --> 00:03:48,799
case that's

00:03:46,400 --> 00:03:49,680
uh all really great and that's what

00:03:48,799 --> 00:03:52,560
platform sh

00:03:49,680 --> 00:03:54,159
does natively but the problem that we

00:03:52,560 --> 00:03:56,720
were facing is that we didn't have a

00:03:54,159 --> 00:03:57,519
good way to enable developers to do this

00:03:56,720 --> 00:04:01,040
development

00:03:57,519 --> 00:04:04,560
locally with all of the um

00:04:01,040 --> 00:04:07,599
with with all of the uh benefits of

00:04:04,560 --> 00:04:10,000
uh these branches and the services

00:04:07,599 --> 00:04:11,120
running um and people were having a hard

00:04:10,000 --> 00:04:14,400
time getting that set up

00:04:11,120 --> 00:04:18,720
and this is where lando comes in so

00:04:14,400 --> 00:04:21,759
lando is a tool that was built by tandem

00:04:18,720 --> 00:04:22,720
which is a tool that you run locally and

00:04:21,759 --> 00:04:26,479
then it connects

00:04:22,720 --> 00:04:30,320
with platform sh and it

00:04:26,479 --> 00:04:32,479
will actually grab uh the

00:04:30,320 --> 00:04:34,240
containers from platform sh the docker

00:04:32,479 --> 00:04:36,560
containers from platform sh that are

00:04:34,240 --> 00:04:39,520
used to run the various services

00:04:36,560 --> 00:04:40,000
it will connect to platform sage account

00:04:39,520 --> 00:04:42,479
uh

00:04:40,000 --> 00:04:43,919
for you uh with your account and it will

00:04:42,479 --> 00:04:45,840
look at your sites

00:04:43,919 --> 00:04:47,360
and let you pull down any of the sites

00:04:45,840 --> 00:04:49,680
that you have and

00:04:47,360 --> 00:04:50,960
get them configured locally without

00:04:49,680 --> 00:04:52,560
doing anything so i'm going to

00:04:50,960 --> 00:04:54,320
run through this as a video what that

00:04:52,560 --> 00:04:55,600
looks like and i'll be pushing pause and

00:04:54,320 --> 00:04:58,880
talking over it

00:04:55,600 --> 00:05:02,160
so at the beginning uh

00:04:58,880 --> 00:05:05,600
you just say uh lando init sort plus

00:05:02,160 --> 00:05:06,639
source platform sh um and then it asks

00:05:05,600 --> 00:05:10,080
you to get

00:05:06,639 --> 00:05:12,240
an api token from platform sh and that

00:05:10,080 --> 00:05:14,800
looks like this so i go to my account

00:05:12,240 --> 00:05:16,479
i create an api token i'll call it

00:05:14,800 --> 00:05:18,479
drupal multi-site

00:05:16,479 --> 00:05:20,240
i'm going to copy that token i'm just

00:05:18,479 --> 00:05:23,120
going to paste it into my

00:05:20,240 --> 00:05:24,320
terminal here you don't see that because

00:05:23,120 --> 00:05:27,440
it's hidden

00:05:24,320 --> 00:05:28,080
and then lando uh is authenticated and

00:05:27,440 --> 00:05:31,280
it knows

00:05:28,080 --> 00:05:31,600
all of the sites that i have to pull

00:05:31,280 --> 00:05:35,039
from

00:05:31,600 --> 00:05:36,960
so i choose the drupal 8 multi-site and

00:05:35,039 --> 00:05:38,560
it's going to do a whole bunch of stuff

00:05:36,960 --> 00:05:40,240
now the first time you do this it takes

00:05:38,560 --> 00:05:42,160
a little bit longer because it has to

00:05:40,240 --> 00:05:43,280
download some docker containers and do a

00:05:42,160 --> 00:05:45,840
little bit more

00:05:43,280 --> 00:05:46,400
but this time it didn't have to do any

00:05:45,840 --> 00:05:50,320
of that

00:05:46,400 --> 00:05:53,440
so it's done pretty fast and it says

00:05:50,320 --> 00:05:54,800
now we're cooking with fire your app has

00:05:53,440 --> 00:05:58,000
been initialized

00:05:54,800 --> 00:06:01,199
so um you can see that

00:05:58,000 --> 00:06:04,080
i got the drupal 8 multi-site uh app

00:06:01,199 --> 00:06:04,960
down there and i can continue so the

00:06:04,080 --> 00:06:08,400
next command

00:06:04,960 --> 00:06:08,400
is lando start

00:06:08,800 --> 00:06:12,880
i didn't show you how to install lando

00:06:10,400 --> 00:06:17,039
but the um it's basically

00:06:12,880 --> 00:06:20,160
uh for mac i had to download the

00:06:17,039 --> 00:06:22,479
what's a dmg file and install it but

00:06:20,160 --> 00:06:24,560
there's an installer for windows

00:06:22,479 --> 00:06:26,080
and a way to do it in linux as well so

00:06:24,560 --> 00:06:27,280
it's pretty easy you just follow the

00:06:26,080 --> 00:06:29,600
instructions on lambda

00:06:27,280 --> 00:06:30,400
okay that's the installation now that

00:06:29,600 --> 00:06:33,440
i've got the

00:06:30,400 --> 00:06:35,520
uh the app running and the um

00:06:33,440 --> 00:06:36,720
the connection to platform initialized i

00:06:35,520 --> 00:06:40,240
do lando start

00:06:36,720 --> 00:06:42,880
on this particular app the drupal 8

00:06:40,240 --> 00:06:42,880
multi-site

00:06:44,160 --> 00:06:47,440
and it does a whole bunch of stuff it's

00:06:46,000 --> 00:06:51,120
starting containers

00:06:47,440 --> 00:06:54,479
it's setting up a proxy so it can handle

00:06:51,120 --> 00:06:57,520
you know various urls it's getting

00:06:54,479 --> 00:07:00,560
all of the environment

00:06:57,520 --> 00:07:01,039
libraries in place and then it goes and

00:07:00,560 --> 00:07:05,280
does

00:07:01,039 --> 00:07:08,639
a composer install on the code base

00:07:05,280 --> 00:07:10,720
and that's because platform sh

00:07:08,639 --> 00:07:13,120
doesn't require you to use composer but

00:07:10,720 --> 00:07:15,120
it enables you to build

00:07:13,120 --> 00:07:16,639
your applications using composer in a

00:07:15,120 --> 00:07:18,560
very nice way

00:07:16,639 --> 00:07:20,479
and the template that i used for this

00:07:18,560 --> 00:07:22,639
drupal 8 multi-site which you can

00:07:20,479 --> 00:07:23,840
install on platform to say to yourself

00:07:22,639 --> 00:07:26,960
and test

00:07:23,840 --> 00:07:28,319
is composer based so

00:07:26,960 --> 00:07:30,080
one of the nice things that platform

00:07:28,319 --> 00:07:32,319
does for you is always build your

00:07:30,080 --> 00:07:34,160
code from any package manager that

00:07:32,319 --> 00:07:37,520
you're using composer

00:07:34,160 --> 00:07:39,840
maven gradle pip

00:07:37,520 --> 00:07:41,120
npm yarn you can use any of those to

00:07:39,840 --> 00:07:44,400
build your applications

00:07:41,120 --> 00:07:45,919
this is no exception so uh

00:07:44,400 --> 00:07:47,520
the installation of this drupal 8

00:07:45,919 --> 00:07:50,160
multi-site locally

00:07:47,520 --> 00:07:51,599
recreates that and builds your code with

00:07:50,160 --> 00:07:56,000
composer there

00:07:51,599 --> 00:07:59,199
so there we go it says it's

00:07:56,000 --> 00:08:01,039
starting and starting the apps

00:07:59,199 --> 00:08:03,039
opening the platform sage containers

00:08:01,039 --> 00:08:06,319
that it pulled from our

00:08:03,039 --> 00:08:06,319
docker repository

00:08:06,639 --> 00:08:12,879
and there we go so it's

00:08:09,759 --> 00:08:15,599
telling me now that i have a drupal 8

00:08:12,879 --> 00:08:17,599
multi-site running locally which is

00:08:15,599 --> 00:08:20,000
great which is exactly what i

00:08:17,599 --> 00:08:20,000
wanted

00:08:22,560 --> 00:08:28,800
and i'm going to grab that url for the

00:08:25,680 --> 00:08:28,800
first site and take a look

00:08:39,360 --> 00:08:42,800
so that's not to be unexpected because

00:08:41,839 --> 00:08:44,480
so far

00:08:42,800 --> 00:08:46,320
uh so that was the uninstalled drupal

00:08:44,480 --> 00:08:48,640
site of course um

00:08:46,320 --> 00:08:51,600
we'll see that it does the same with the

00:08:48,640 --> 00:08:54,720
the second one i'll take the https

00:08:51,600 --> 00:08:56,800
url there and we'll see that here we

00:08:54,720 --> 00:08:59,519
also get the um

00:08:56,800 --> 00:09:02,720
yeah the the tls certificate warning i

00:08:59,519 --> 00:09:02,720
just accept that and move on

00:09:02,880 --> 00:09:06,720
and also that site is uninstalled but

00:09:05,040 --> 00:09:08,959
that's not that's not what i had in the

00:09:06,720 --> 00:09:10,800
cloud right so now the next step

00:09:08,959 --> 00:09:13,519
which is always a pain for local

00:09:10,800 --> 00:09:14,800
developers is to get the database and

00:09:13,519 --> 00:09:17,040
uploaded files

00:09:14,800 --> 00:09:18,000
for both of those sites into the right

00:09:17,040 --> 00:09:21,200
place now

00:09:18,000 --> 00:09:23,040
uh this could

00:09:21,200 --> 00:09:24,560
involve depending on how things are set

00:09:23,040 --> 00:09:26,959
up lots of

00:09:24,560 --> 00:09:29,839
x my sequel exporting my sequel

00:09:26,959 --> 00:09:30,560
importing scp or ftping files across the

00:09:29,839 --> 00:09:32,480
wire

00:09:30,560 --> 00:09:34,160
but with lando all i have to do is land

00:09:32,480 --> 00:09:37,360
a poll

00:09:34,160 --> 00:09:40,399
and it's going to ask me uh which

00:09:37,360 --> 00:09:41,360
site first uh and second those are the

00:09:40,399 --> 00:09:44,880
names of the sites

00:09:41,360 --> 00:09:46,720
do i want to import from and which files

00:09:44,880 --> 00:09:49,200
i want i just want the files and web

00:09:46,720 --> 00:09:52,399
files don't need any of the

00:09:49,200 --> 00:09:56,880
drush files or anything like that and

00:09:52,399 --> 00:09:56,880
it's authenticating me

00:09:57,279 --> 00:10:01,279
and now it's importing the data and

00:09:59,200 --> 00:10:03,839
watch closely it's going to go fast

00:10:01,279 --> 00:10:05,680
it's imported the first database it's

00:10:03,839 --> 00:10:08,880
imported the second database

00:10:05,680 --> 00:10:10,959
there are all the files and we're done

00:10:08,880 --> 00:10:13,200
that's it that's all i had to do to

00:10:10,959 --> 00:10:16,839
synchronize so i'm just going to refresh

00:10:13,200 --> 00:10:19,839
this page without the core install php

00:10:16,839 --> 00:10:19,839
and

00:10:20,000 --> 00:10:23,680
this is local i've just imported all of

00:10:22,399 --> 00:10:27,200
that data

00:10:23,680 --> 00:10:29,760
and there's my umami site do the same

00:10:27,200 --> 00:10:29,760
thing here

00:10:30,480 --> 00:10:38,079
and there's my site so that's uh

00:10:33,600 --> 00:10:41,200
all i had to do to get both um

00:10:38,079 --> 00:10:44,240
of my multi-sites installed

00:10:41,200 --> 00:10:47,760
uh locally now from there

00:10:44,240 --> 00:10:49,760
it's really nice so um i'm just gonna go

00:10:47,760 --> 00:10:52,800
in here into

00:10:49,760 --> 00:10:56,000
live coding so i've got

00:10:52,800 --> 00:10:58,000
in this uh directory i've got both of my

00:10:56,000 --> 00:11:01,680
useful tools uh handy i've got the

00:10:58,000 --> 00:11:04,079
platform tool

00:11:01,680 --> 00:11:05,920
and it recognizes right off all of these

00:11:04,079 --> 00:11:07,360
branches that i have and i can switch

00:11:05,920 --> 00:11:10,160
between them

00:11:07,360 --> 00:11:10,959
and and i can run commands like if i

00:11:10,160 --> 00:11:14,240
wanted to

00:11:10,959 --> 00:11:16,160
uh you know do a drush command on the

00:11:14,240 --> 00:11:17,360
server side like in the cloud i can do

00:11:16,160 --> 00:11:20,880
platform

00:11:17,360 --> 00:11:23,920
rush uh what is it status yeah

00:11:20,880 --> 00:11:24,480
let's try that and i can see the status

00:11:23,920 --> 00:11:28,399
of

00:11:24,480 --> 00:11:31,839
the uh site in the cloud

00:11:28,399 --> 00:11:33,680
or i've got the lando tool as well

00:11:31,839 --> 00:11:35,120
and that's got all of these commands

00:11:33,680 --> 00:11:38,320
that i can do here

00:11:35,120 --> 00:11:40,480
um so and these would run on the

00:11:38,320 --> 00:11:43,519
containers and the copies of the sites

00:11:40,480 --> 00:11:46,079
that i have running locally so

00:11:43,519 --> 00:11:48,000
what didn't i have to do in this

00:11:46,079 --> 00:11:50,560
scenario i didn't have to

00:11:48,000 --> 00:11:51,760
do anything with docker except make sure

00:11:50,560 --> 00:11:54,800
that i have docker

00:11:51,760 --> 00:11:56,639
installed on my laptop okay i didn't

00:11:54,800 --> 00:11:59,360
have to do anything with kubernetes

00:11:56,639 --> 00:12:00,000
okay kubernetes doesn't play a role here

00:11:59,360 --> 00:12:01,920
so

00:12:00,000 --> 00:12:03,360
um i didn't have to do any data

00:12:01,920 --> 00:12:05,440
synchronization

00:12:03,360 --> 00:12:07,120
uh i didn't have to install a special

00:12:05,440 --> 00:12:10,560
version of php

00:12:07,120 --> 00:12:12,079
to be running the same version of php

00:12:10,560 --> 00:12:13,200
that i'm running in the cloud even if

00:12:12,079 --> 00:12:14,079
it's different than what i have in my

00:12:13,200 --> 00:12:16,720
laptop

00:12:14,079 --> 00:12:18,560
i don't have to do any of that it's just

00:12:16,720 --> 00:12:21,120
really really really simple

00:12:18,560 --> 00:12:21,600
um in case you're familiar with platform

00:12:21,120 --> 00:12:24,720
sh

00:12:21,600 --> 00:12:29,760
lando follows along with

00:12:24,720 --> 00:12:31,760
all of the native files that you

00:12:29,760 --> 00:12:34,000
create in platform sage for example

00:12:31,760 --> 00:12:36,880
platform sh

00:12:34,000 --> 00:12:38,720
has a route cmo file that specify all of

00:12:36,880 --> 00:12:41,519
the incoming urls

00:12:38,720 --> 00:12:42,639
lando mirrors that it actually parses

00:12:41,519 --> 00:12:47,040
these files

00:12:42,639 --> 00:12:49,600
same with services so with the

00:12:47,040 --> 00:12:51,519
services you get to specify which

00:12:49,600 --> 00:12:52,959
backend services are running for your

00:12:51,519 --> 00:12:56,079
site

00:12:52,959 --> 00:12:59,920
i showed you mariadb and redis

00:12:56,079 --> 00:13:03,200
this example has mariadb and postgresql

00:12:59,920 --> 00:13:05,519
lando will launch all of those

00:13:03,200 --> 00:13:06,399
including if you want elasticsearch

00:13:05,519 --> 00:13:10,000
headless chrome

00:13:06,399 --> 00:13:10,880
influx db kafka memcache postgres

00:13:10,000 --> 00:13:13,200
rabbitmq

00:13:10,880 --> 00:13:14,079
redis solar or varnish which is a very

00:13:13,200 --> 00:13:15,440
nice list

00:13:14,079 --> 00:13:17,200
you don't have to build any of those

00:13:15,440 --> 00:13:18,639
docker containers you just add them to

00:13:17,200 --> 00:13:21,760
the yaml file and

00:13:18,639 --> 00:13:24,880
they go so this was a very short demo

00:13:21,760 --> 00:13:28,000
there's no time for questions basically

00:13:24,880 --> 00:13:29,839
but if you come to the platform sh

00:13:28,000 --> 00:13:32,320
booth the virtual booth here at

00:13:29,839 --> 00:13:35,440
drupalcon not only do we have

00:13:32,320 --> 00:13:38,240
a a 40 euro

00:13:35,440 --> 00:13:38,720
voucher for platform sh a credit voucher

00:13:38,240 --> 00:13:41,839
for you

00:13:38,720 --> 00:13:44,240
to get for someone to get um today

00:13:41,839 --> 00:13:45,199
but i will go to the booth right after

00:13:44,240 --> 00:13:47,199
the session

00:13:45,199 --> 00:13:49,279
and if you have questions about the

00:13:47,199 --> 00:13:52,000
lando integration

00:13:49,279 --> 00:13:52,480
then that's the absolute best place and

00:13:52,000 --> 00:13:55,839
time

00:13:52,480 --> 00:13:57,839
to ask them i think 15 minutes

00:13:55,839 --> 00:14:00,399
is a very short session but i'm really

00:13:57,839 --> 00:14:02,639
grateful that you all

00:14:00,399 --> 00:14:05,279
joined and it looks like in fact there

00:14:02,639 --> 00:14:07,040
were a number of people in the room so

00:14:05,279 --> 00:14:09,120
greetings to you all i wish i could see

00:14:07,040 --> 00:14:09,839
you maybe i know some of you i miss you

00:14:09,120 --> 00:14:12,680
all

00:14:09,839 --> 00:14:15,680
be safe be healthy and that's the

00:14:12,680 --> 00:14:15,680

YouTube URL: https://www.youtube.com/watch?v=ynUYCj147Xw


