Title: DrupalCon Prague 2013: DRUPAL CHEF: BORK BORK BORK!
Publication date: 2013-09-26
Playlist: DrupalCon Prague - September 2013
Description: 
	Opscode Chef is an open source systems integration framework, meant to reduce "one off" server building, allowing scalable architecture to be easily replicated, but also to allowing you to keep development, staging and production boxes in sync.. You write (and/or seek out) basic recipes to describe how you want each part of your infrastructure to be built. We'll discuss using Chef in a Drupal context.

Starting from scratch with simple server concepts like a fully managed LAMP stack, we'll add in Drupal installation, Drush, and so on.

We'll then bring in options like Jenkins, Behat, logging, redundancy, and more... showing how all of these tools help to build stable environments that you know work and work well.

Humor, especially of a muppet variety, will be key to making this presentation bearable. Wakka Wakka!
Captions: 
	00:00:00,000 --> 00:00:07,440
box which part the next session will be

00:00:03,689 --> 00:00:10,349
about the two topics I like most

00:00:07,440 --> 00:00:16,500
personally it's drupal and automation

00:00:10,349 --> 00:00:18,960
with chef so without any delay cloudy

00:00:16,500 --> 00:00:26,369
with a chance of chickens I give

00:00:18,960 --> 00:00:31,140
yourself oh thank you thank you all

00:00:26,369 --> 00:00:39,960
right let's get started here we had a

00:00:31,140 --> 00:00:43,770
little technical difficulty we will that

00:00:39,960 --> 00:00:51,510
going Microsoft PowerPoint don't don't

00:00:43,770 --> 00:00:58,530
count on it edu good i see you gabar

00:00:51,510 --> 00:01:03,620
steer horn chairs here in this new

00:00:58,530 --> 00:01:03,620
disney disney boom is he

00:01:07,690 --> 00:01:26,500
let's give me the beans no sugar knew he

00:01:19,570 --> 00:01:26,500
ensured super good he is here he is

00:01:34,590 --> 00:01:39,660
alright so what do we call that well

00:01:36,880 --> 00:01:50,260
clearly that was the meatball service

00:01:39,660 --> 00:01:54,600
and it had high availability all right

00:01:50,260 --> 00:01:54,600
so welcome to Drupal chef bork bork bork

00:01:55,320 --> 00:02:03,930
so Who am I well I'm Seth Cohen

00:02:00,160 --> 00:02:06,880
everywhere on drupal.org Twitter etc I

00:02:03,930 --> 00:02:10,510
am an alpha geek that's my business card

00:02:06,880 --> 00:02:13,900
say for a day job I am the technical

00:02:10,510 --> 00:02:15,880
lead at bio raft and I've been doing

00:02:13,900 --> 00:02:19,480
Drupal for about nine years since four

00:02:15,880 --> 00:02:21,670
point six days I did tech added a book

00:02:19,480 --> 00:02:24,459
pro Drupal 7 for Windows developers

00:02:21,670 --> 00:02:27,940
which i'm very pleased is the only book

00:02:24,459 --> 00:02:30,190
that actually analyzed drupal 7 in terms

00:02:27,940 --> 00:02:31,870
of the technical behind-the-scenes how a

00:02:30,190 --> 00:02:33,459
page is actually built there's a chapter

00:02:31,870 --> 00:02:36,280
in there that if you work with drupal 7

00:02:33,459 --> 00:02:38,380
and you really want to know what exactly

00:02:36,280 --> 00:02:40,390
happens or to generate that page it

00:02:38,380 --> 00:02:42,250
actually is documented all the way

00:02:40,390 --> 00:02:45,550
through so that you actually understand

00:02:42,250 --> 00:02:46,720
what happens to generate that page and

00:02:45,550 --> 00:02:48,250
that's the piece of the book i'm most

00:02:46,720 --> 00:02:49,690
proud of is we went through with a

00:02:48,250 --> 00:02:53,260
fine-tooth comb and really made sure it

00:02:49,690 --> 00:02:54,970
was accurate I'm a former politician I

00:02:53,260 --> 00:02:56,860
actually took two years off from Drupal

00:02:54,970 --> 00:02:59,620
and got elected to the New Hampshire

00:02:56,860 --> 00:03:02,850
state house and got open source open

00:02:59,620 --> 00:03:06,100
data passed into law so I'm one of those

00:03:02,850 --> 00:03:07,390
activists tech geeks and I'm actually

00:03:06,100 --> 00:03:09,480
really proud of that I think that's

00:03:07,390 --> 00:03:12,150
going to help change the world and

00:03:09,480 --> 00:03:18,010
Drupal is definitely part of that and

00:03:12,150 --> 00:03:22,060
finally I'm am up any man or a Maya

00:03:18,010 --> 00:03:26,739
manly Muppet I'm still not sure which so

00:03:22,060 --> 00:03:29,170
what is bio raft well I just described

00:03:26,739 --> 00:03:31,739
it as preventing the nexon the

00:03:29,170 --> 00:03:31,739
apocalypse

00:03:31,930 --> 00:03:36,080
my marketing people aren't that happy

00:03:34,490 --> 00:03:40,190
with it but they were okay with this

00:03:36,080 --> 00:03:42,320
slide so it is built entirely using

00:03:40,190 --> 00:03:46,100
Drupal the software as a service model

00:03:42,320 --> 00:03:47,930
so we provide everything it we provide

00:03:46,100 --> 00:03:51,520
lab safety compliance and training

00:03:47,930 --> 00:03:54,040
software we do things like track hazards

00:03:51,520 --> 00:03:58,550
compliance management training delivery

00:03:54,040 --> 00:04:00,590
basically if you're in one of the

00:03:58,550 --> 00:04:02,570
institutions at quite a number of

00:04:00,590 --> 00:04:04,610
universities and some pharmaceutical

00:04:02,570 --> 00:04:06,920
companies that use our services if you

00:04:04,610 --> 00:04:08,930
add all enter into a lab we track who

00:04:06,920 --> 00:04:09,920
you are what kind of lab you're in and

00:04:08,930 --> 00:04:12,470
what kind of training you've had

00:04:09,920 --> 00:04:16,299
etcetera make sure that the labs are

00:04:12,470 --> 00:04:19,610
safe so we're talking about data and

00:04:16,299 --> 00:04:22,760
important real-world consequences if

00:04:19,610 --> 00:04:26,030
that machine goes down if that data gets

00:04:22,760 --> 00:04:27,470
lost etc this is not a hobby site by any

00:04:26,030 --> 00:04:30,020
means this has got real world

00:04:27,470 --> 00:04:31,910
consequences which is kind of why I joke

00:04:30,020 --> 00:04:33,560
about the neck Dombey apocalypse because

00:04:31,910 --> 00:04:35,180
we've all seen those movies and what is

00:04:33,560 --> 00:04:36,980
it that usually causes those things

00:04:35,180 --> 00:04:39,500
that's some guy who goes ahead reach us

00:04:36,980 --> 00:04:41,990
into a rat cage gets a bit and says I

00:04:39,500 --> 00:04:43,580
don't be okay I'll go home and next

00:04:41,990 --> 00:04:45,590
thing you know you know half the world's

00:04:43,580 --> 00:04:47,480
gone and zombies are everywhere so as

00:04:45,590 --> 00:04:51,320
long as there has not been a zombie

00:04:47,480 --> 00:04:52,910
apocalypse I'm doing my job so what are

00:04:51,320 --> 00:04:56,570
we covering today we are going to cover

00:04:52,910 --> 00:04:58,820
chef what is it why use it we're going

00:04:56,570 --> 00:05:01,370
to cover the basic terms in what I call

00:04:58,820 --> 00:05:04,550
Drupal ish so basically you currently

00:05:01,370 --> 00:05:07,070
speak Drupal chef uses a different

00:05:04,550 --> 00:05:11,060
language my goal is for you to walk out

00:05:07,070 --> 00:05:13,669
of here understanding what chef does in

00:05:11,060 --> 00:05:15,950
terms of how you understand Drupal we're

00:05:13,669 --> 00:05:18,110
going to look at a very simple example a

00:05:15,950 --> 00:05:19,490
lamp stack there are certainly a lot

00:05:18,110 --> 00:05:21,560
more complicated things that can be done

00:05:19,490 --> 00:05:23,390
but in the interest of time we're going

00:05:21,560 --> 00:05:27,350
to keep it fairly simple and then

00:05:23,390 --> 00:05:29,540
finally some basic issues and tips and

00:05:27,350 --> 00:05:32,090
so what we see there the most

00:05:29,540 --> 00:05:34,880
interesting Swedish man in the world who

00:05:32,090 --> 00:05:39,230
says I don't always deploy lots of

00:05:34,880 --> 00:05:43,190
service but then I do I use a chef so

00:05:39,230 --> 00:05:46,220
why chef well it's right there time

00:05:43,190 --> 00:05:47,510
and money chef is a way to build stable

00:05:46,220 --> 00:05:51,230
servers for development and production

00:05:47,510 --> 00:05:52,520
would save you time and money and well

00:05:51,230 --> 00:05:56,450
what do we mean by that well without

00:05:52,520 --> 00:05:58,220
chef right now how do you build and

00:05:56,450 --> 00:06:02,120
maintain your existing servers who does

00:05:58,220 --> 00:06:04,850
it do you use package management do you

00:06:02,120 --> 00:06:08,390
use scripts you build everything from

00:06:04,850 --> 00:06:12,050
source code combinations who manages

00:06:08,390 --> 00:06:17,210
those scripts when what happens if

00:06:12,050 --> 00:06:20,240
there's an update security OS level

00:06:17,210 --> 00:06:22,460
changes oh well we were using Debian six

00:06:20,240 --> 00:06:25,160
and now Debian sevens out so we're going

00:06:22,460 --> 00:06:28,220
to have to upgrade everything or bone

00:06:25,160 --> 00:06:29,690
Joe released Isetta patches that yeah

00:06:28,220 --> 00:06:31,220
they broke something we have to roll

00:06:29,690 --> 00:06:34,310
things back there's all kinds of things

00:06:31,220 --> 00:06:36,530
that come up do you use virtual machines

00:06:34,310 --> 00:06:39,140
to use physical machines do you push

00:06:36,530 --> 00:06:41,360
stuff out to Amazon you push something

00:06:39,140 --> 00:06:43,310
out to Amazon and it works great and

00:06:41,360 --> 00:06:45,050
then one day the server disappears and

00:06:43,310 --> 00:06:47,090
of course amazon says well not our

00:06:45,050 --> 00:06:50,390
problem we don't guarantee a hundred

00:06:47,090 --> 00:06:52,250
percent availability it's 99.99 and you

00:06:50,390 --> 00:06:56,330
just happen to be the one in 10,000 that

00:06:52,250 --> 00:06:57,590
disappeared today so these are important

00:06:56,330 --> 00:07:00,770
questions if you're dealing with any

00:06:57,590 --> 00:07:03,310
kind of reliability personnel changes

00:07:00,770 --> 00:07:05,960
that's the last thing the bus factor

00:07:03,310 --> 00:07:08,120
you've got a great person maybe you're

00:07:05,960 --> 00:07:14,320
that person who's maintaining servers

00:07:08,120 --> 00:07:17,150
and if you got hit by a bus tomorrow

00:07:14,320 --> 00:07:18,590
what would happen to the service what if

00:07:17,150 --> 00:07:20,690
you are not available for week what if

00:07:18,590 --> 00:07:22,310
you want to go on vacation wouldn't it

00:07:20,690 --> 00:07:24,140
be nice to know that your servers are

00:07:22,310 --> 00:07:26,120
going to stay up and you're not sitting

00:07:24,140 --> 00:07:27,560
there sitting with a pager do we all

00:07:26,120 --> 00:07:29,740
have pagers anymore does anybody have it

00:07:27,560 --> 00:07:32,690
is it all phones now at this point

00:07:29,740 --> 00:07:34,550
basically it would be nice to know you

00:07:32,690 --> 00:07:36,200
have reliability well that's what chef

00:07:34,550 --> 00:07:39,140
is about that's what we're focusing on

00:07:36,200 --> 00:07:42,350
so this is not another what is devs off

00:07:39,140 --> 00:07:44,750
DevOps talk there's a whole track this

00:07:42,350 --> 00:07:47,660
is one answer this is not the only

00:07:44,750 --> 00:07:49,550
answer there's lots of other pieces to

00:07:47,660 --> 00:07:51,560
this puzzle but my goal is you walk out

00:07:49,550 --> 00:07:53,360
of here basically going I'm going to go

00:07:51,560 --> 00:07:54,710
implement chef because it is a piece of

00:07:53,360 --> 00:07:58,010
the puzzle that i'm going to use

00:07:54,710 --> 00:08:00,530
and I hope it fits for you so what is

00:07:58,010 --> 00:08:03,170
chef it's from a company called opscode

00:08:00,530 --> 00:08:05,330
and it's about turning infrastructure

00:08:03,170 --> 00:08:07,880
into code because we all know that once

00:08:05,330 --> 00:08:10,280
you turn it into code you can control it

00:08:07,880 --> 00:08:14,000
you conversion control it you can back

00:08:10,280 --> 00:08:15,830
it up you can track your changes so that

00:08:14,000 --> 00:08:17,450
when somebody changes something and it

00:08:15,830 --> 00:08:19,940
breaks you can figure out exactly who

00:08:17,450 --> 00:08:21,530
and when that change happened most

00:08:19,940 --> 00:08:23,570
people don't have their servers under

00:08:21,530 --> 00:08:25,730
version control and so they go yeah I

00:08:23,570 --> 00:08:27,710
think we did something last week but it

00:08:25,730 --> 00:08:30,740
wasn't me it was I think it was I think

00:08:27,710 --> 00:08:32,240
it was the other guy this solves that

00:08:30,740 --> 00:08:33,980
because what we're going to do is we're

00:08:32,240 --> 00:08:36,320
going to take everything that is your

00:08:33,980 --> 00:08:38,210
infrastructure turn it into code and

00:08:36,320 --> 00:08:41,930
gain all the advantages that we already

00:08:38,210 --> 00:08:44,060
know code control is good for so Opscode

00:08:41,930 --> 00:08:45,800
describes it as configuration templates

00:08:44,060 --> 00:08:47,600
with business logic to describe

00:08:45,800 --> 00:08:50,330
infrastructure and establish

00:08:47,600 --> 00:08:52,970
relationships between boxes which is a

00:08:50,330 --> 00:08:54,440
fancy way of saying that it's not a

00:08:52,970 --> 00:08:57,410
simple script there's a lot of

00:08:54,440 --> 00:08:58,610
complexity to this not only to describe

00:08:57,410 --> 00:09:01,820
it but it actually allows some

00:08:58,610 --> 00:09:04,520
interaction so start slow build-up

00:09:01,820 --> 00:09:06,890
that's one of the things chef has a lot

00:09:04,520 --> 00:09:09,470
of pieces chef has a steep learning

00:09:06,890 --> 00:09:14,180
curve you don't need to do it all at

00:09:09,470 --> 00:09:16,550
once if you add complexity slowly chef

00:09:14,180 --> 00:09:18,530
lets your servers work together so you

00:09:16,550 --> 00:09:20,240
will start rolling things out and as you

00:09:18,530 --> 00:09:23,120
add new pieces you say i'm going to add

00:09:20,240 --> 00:09:25,520
logging and you can add logging and your

00:09:23,120 --> 00:09:27,470
existing servers can basically if you've

00:09:25,520 --> 00:09:29,120
written your scripts right start to get

00:09:27,470 --> 00:09:31,910
logging as soon as that new server comes

00:09:29,120 --> 00:09:33,530
up 15 minutes later they might recognize

00:09:31,910 --> 00:09:35,150
hey there's a logging server i need to

00:09:33,530 --> 00:09:37,100
go and i need to start sending my logs

00:09:35,150 --> 00:09:39,470
to them you don't have to start with

00:09:37,100 --> 00:09:41,300
that you can add the building blocks to

00:09:39,470 --> 00:09:45,800
it so don't feel like you have to solve

00:09:41,300 --> 00:09:50,390
everything with chef to start with so we

00:09:45,800 --> 00:09:53,000
know Drupal can we learn chef I think so

00:09:50,390 --> 00:09:54,860
and that's the goal of this talk so

00:09:53,000 --> 00:09:57,110
we're not covering because there's a lot

00:09:54,860 --> 00:09:59,060
of things we could talk about we're not

00:09:57,110 --> 00:10:00,830
going to cover chef vs puppet versus

00:09:59,060 --> 00:10:02,360
other tools this is a chef talk I've

00:10:00,830 --> 00:10:03,770
been to chef talks or somebody says well

00:10:02,360 --> 00:10:06,530
what about puppet well puppets another

00:10:03,770 --> 00:10:07,970
answer I have decided to use chef for a

00:10:06,530 --> 00:10:09,379
variety of reasons and that's one

00:10:07,970 --> 00:10:11,839
focus on if somebody wants to play with

00:10:09,379 --> 00:10:13,009
puppet please feel free I will tell you

00:10:11,839 --> 00:10:15,970
right now I think you're going to come

00:10:13,009 --> 00:10:18,620
back to chef after you play with it

00:10:15,970 --> 00:10:20,899
vagrant Baker it's a great tool for

00:10:18,620 --> 00:10:22,519
spending of virtual machines I highly

00:10:20,899 --> 00:10:23,810
recommend it again it's beyond the scope

00:10:22,519 --> 00:10:26,689
of the talk we could do a whole hour

00:10:23,810 --> 00:10:29,360
just on vagrant Burke shelf Burke shelf

00:10:26,689 --> 00:10:32,329
it sits on top of chef it's a way to

00:10:29,360 --> 00:10:34,550
speed up development once you understand

00:10:32,329 --> 00:10:36,980
the basics you appreciate what Burke

00:10:34,550 --> 00:10:38,959
shelf does there's some great videos on

00:10:36,980 --> 00:10:41,899
it but again I'm trying to teach the

00:10:38,959 --> 00:10:43,129
basics so we're not but definitely and

00:10:41,899 --> 00:10:44,089
I've got it mentioned at the end this is

00:10:43,129 --> 00:10:46,370
something you want to look at because

00:10:44,089 --> 00:10:47,660
what they did was they said well this is

00:10:46,370 --> 00:10:49,040
great this is the way it normally works

00:10:47,660 --> 00:10:51,170
is their way to do it faster and better

00:10:49,040 --> 00:10:53,269
and Burke shelf was the result and there

00:10:51,170 --> 00:10:55,220
are chef developers out there who thank

00:10:53,269 --> 00:10:57,350
God the Burke shelf exists because it

00:10:55,220 --> 00:10:58,850
speeds up so instead of waiting ten

00:10:57,350 --> 00:11:01,220
minutes you might wake 30 seconds to

00:10:58,850 --> 00:11:03,500
test your changes we're not going to

00:11:01,220 --> 00:11:05,420
cover chef solo which is a way to do

00:11:03,500 --> 00:11:07,029
some of this stuff just locally on your

00:11:05,420 --> 00:11:09,410
own machine because my goal again is

00:11:07,029 --> 00:11:11,810
show you the basics I want you to walk

00:11:09,410 --> 00:11:14,240
out of here understanding the core

00:11:11,810 --> 00:11:16,730
concept of Chef and chef solo sort of

00:11:14,240 --> 00:11:21,620
bypasses that we're not going to cover

00:11:16,730 --> 00:11:24,829
spice weasel that's too futuristic you

00:11:21,620 --> 00:11:26,360
know come back in a thousand years we're

00:11:24,829 --> 00:11:27,769
not going to cover food critic and a lot

00:11:26,360 --> 00:11:31,009
of other nifty tools there's a bunch of

00:11:27,769 --> 00:11:32,809
Chef add-on I i definitely recommend

00:11:31,009 --> 00:11:33,740
looking at all of that stuff but again

00:11:32,809 --> 00:11:37,370
we're going to keep it really simple

00:11:33,740 --> 00:11:39,230
today my goal is you walk out of here

00:11:37,370 --> 00:11:41,209
and say I want to know more about chef

00:11:39,230 --> 00:11:43,339
I'm not satisfied with what I learned I

00:11:41,209 --> 00:11:50,329
want to learn more and there are

00:11:43,339 --> 00:11:52,550
resources so cooking for geeks learning

00:11:50,329 --> 00:11:54,430
chef begins by understanding the

00:11:52,550 --> 00:11:57,170
language if you don't speak the lingo

00:11:54,430 --> 00:12:00,529
it's all Greek I mean I'm sorry it's all

00:11:57,170 --> 00:12:03,949
mock Swedish so we all speak drupal ish

00:12:00,529 --> 00:12:05,569
we're going to start with Drupal so

00:12:03,949 --> 00:12:06,769
here's the chef's terms we're going to

00:12:05,569 --> 00:12:08,899
learn you can see there's a little road

00:12:06,769 --> 00:12:10,759
map there and we're going to come back

00:12:08,899 --> 00:12:12,470
to this list and hopefully by the time

00:12:10,759 --> 00:12:14,360
we have gone through these slides you

00:12:12,470 --> 00:12:18,170
will go ok I understand what they mean

00:12:14,360 --> 00:12:21,340
by this as opposed to what we mean so

00:12:18,170 --> 00:12:23,680
how is chef like drupal what I have here

00:12:21,340 --> 00:12:26,140
that shows the latest fork from Drupal

00:12:23,680 --> 00:12:28,930
Paul heard a backdrop and cetera this is

00:12:26,140 --> 00:12:34,030
this is the rupal which is the Swedish

00:12:28,930 --> 00:12:37,930
Chef Fork of Drupal know my goal here

00:12:34,030 --> 00:12:39,340
was to basically show that we can look

00:12:37,930 --> 00:12:41,590
at something and even if you don't speak

00:12:39,340 --> 00:12:43,630
the language you can understand it in

00:12:41,590 --> 00:12:45,430
the same terms you're used to

00:12:43,630 --> 00:12:48,940
understanding because that actually is

00:12:45,430 --> 00:12:52,930
found a Firefox add-on then rewrites the

00:12:48,940 --> 00:12:57,280
site into mock Swedish and so that's

00:12:52,930 --> 00:13:01,240
actually what that is so how can we

00:12:57,280 --> 00:13:02,860
understand chef concepts well let's

00:13:01,240 --> 00:13:07,870
compare it to what we understand for

00:13:02,860 --> 00:13:11,710
Drupal concepts so chef uses Ruby so

00:13:07,870 --> 00:13:13,420
what how many people here got started

00:13:11,710 --> 00:13:18,070
with Drupal and weren't necessarily

00:13:13,420 --> 00:13:20,560
wizards in PHP it's a few you can learn

00:13:18,070 --> 00:13:24,910
to you chef without knowing Ruby it

00:13:20,560 --> 00:13:27,400
helps but if you 5 10 minutes you will

00:13:24,910 --> 00:13:29,740
have enough Ruby knowledge to get

00:13:27,400 --> 00:13:31,870
started you do not need to know Ruby in

00:13:29,740 --> 00:13:33,790
order to use chef actually the most

00:13:31,870 --> 00:13:35,440
useful thing is one of the same things

00:13:33,790 --> 00:13:37,510
that it's useful to know for Drupal

00:13:35,440 --> 00:13:39,010
which is JSON formatting and that's

00:13:37,510 --> 00:13:42,070
becoming more and more important with

00:13:39,010 --> 00:13:43,900
things like drupal 8 because as yamo all

00:13:42,070 --> 00:13:45,910
of these things are very structured text

00:13:43,900 --> 00:13:48,490
documents and if you make a mistake in

00:13:45,910 --> 00:13:52,630
the configuration it doesn't work chef

00:13:48,490 --> 00:13:55,800
uses those same things so we have the

00:13:52,630 --> 00:13:58,060
core word we all know the word the node

00:13:55,800 --> 00:14:01,120
everybody knows what it is it's an item

00:13:58,060 --> 00:14:03,400
of content in Drupal right well a node

00:14:01,120 --> 00:14:05,200
is not a node by any other name because

00:14:03,400 --> 00:14:10,740
in chef node means something completely

00:14:05,200 --> 00:14:14,440
different a node is a complete website

00:14:10,740 --> 00:14:17,050
it's a complete server a node is a

00:14:14,440 --> 00:14:20,950
virtual machine with whatever it's

00:14:17,050 --> 00:14:22,210
running and all of the various pieces so

00:14:20,950 --> 00:14:24,100
that's the first thing is we're used to

00:14:22,210 --> 00:14:25,900
thinking of a node as they discrete item

00:14:24,100 --> 00:14:30,820
well it is a discrete item for chef it's

00:14:25,900 --> 00:14:32,950
a discrete server instance when they

00:14:30,820 --> 00:14:34,520
talk about a workstation they mean your

00:14:32,950 --> 00:14:36,230
laptop they mean whatever

00:14:34,520 --> 00:14:40,070
as you do your work in it's your local

00:14:36,230 --> 00:14:42,830
development environment chef server is

00:14:40,070 --> 00:14:46,070
the central control think of it as your

00:14:42,830 --> 00:14:49,220
own private drupal org what goes up to

00:14:46,070 --> 00:14:51,860
the chef server is code you consider to

00:14:49,220 --> 00:14:53,330
be either ready for production or it's

00:14:51,860 --> 00:14:56,470
your development environment if you're

00:14:53,330 --> 00:14:59,690
using some versioning and all of your

00:14:56,470 --> 00:15:02,630
nodes out there talk back to this

00:14:59,690 --> 00:15:06,230
machine and basically say hey do you

00:15:02,630 --> 00:15:09,140
have any updates for me and that updater

00:15:06,230 --> 00:15:11,060
is the chef client that runs on each of

00:15:09,140 --> 00:15:12,710
them so we're all used to the updater we

00:15:11,060 --> 00:15:14,150
have had in Drupal we know that you can

00:15:12,710 --> 00:15:15,800
go and run the updater and I'll tell you

00:15:14,150 --> 00:15:17,720
hey there's a new version out there on

00:15:15,800 --> 00:15:20,420
drupal.org oh there's a security update

00:15:17,720 --> 00:15:22,550
or etc it's exactly the same concept

00:15:20,420 --> 00:15:25,730
each of your nodes talks back to your

00:15:22,550 --> 00:15:27,950
chef server and says hey I'm server X I

00:15:25,730 --> 00:15:31,070
need to know is there anything waiting

00:15:27,950 --> 00:15:32,810
for me and if there is it gets the

00:15:31,070 --> 00:15:35,990
instructions and it basically downloads

00:15:32,810 --> 00:15:37,430
and does all the updates so repository

00:15:35,990 --> 00:15:40,270
that's again we're familiar with that

00:15:37,430 --> 00:15:44,720
it's code control now in the case of

00:15:40,270 --> 00:15:47,300
chef for the most part it's get there's

00:15:44,720 --> 00:15:51,170
a lot of development on github there is

00:15:47,300 --> 00:15:54,110
quite a community out there now this is

00:15:51,170 --> 00:15:55,580
my favorite this is knife so we have the

00:15:54,110 --> 00:15:57,620
equivalent of knife when it comes to

00:15:55,580 --> 00:15:59,480
Drupal it's called rush if you're not

00:15:57,620 --> 00:16:01,520
using dress you should be drush is

00:15:59,480 --> 00:16:03,620
awesome drush is basically the command

00:16:01,520 --> 00:16:06,140
line tool that does everything that

00:16:03,620 --> 00:16:08,750
you'd need to do in Drupal and knife is

00:16:06,140 --> 00:16:12,860
exactly the same thing for chef's knife

00:16:08,750 --> 00:16:14,840
is the way you can do ninety-five

00:16:12,860 --> 00:16:16,100
percent or maybe ninety nine percent of

00:16:14,840 --> 00:16:17,240
the stuff you're ever going to do a chef

00:16:16,100 --> 00:16:18,770
you're going to do it from a command

00:16:17,240 --> 00:16:21,020
line you're going to do a knife command

00:16:18,770 --> 00:16:23,150
and you're going to say I need to upload

00:16:21,020 --> 00:16:25,160
some new information I need to check on

00:16:23,150 --> 00:16:32,390
the status of a server life does all of

00:16:25,160 --> 00:16:34,670
that so the metaphor in chef is they use

00:16:32,390 --> 00:16:37,010
this cooking metaphor knife well

00:16:34,670 --> 00:16:39,770
cookbook well what's a cookbook well in

00:16:37,010 --> 00:16:43,360
Drupal terms it's a feature so in Drupal

00:16:39,770 --> 00:16:46,310
we have created a packaging system for

00:16:43,360 --> 00:16:48,310
not just modules but configuration and

00:16:46,310 --> 00:16:50,260
all the pieces so that if you go get a

00:16:48,310 --> 00:16:52,120
sure you can add it to your website and

00:16:50,260 --> 00:16:55,420
you know that that complete package

00:16:52,120 --> 00:16:56,890
comes down and works sets up all the

00:16:55,420 --> 00:16:58,930
pieces that are needed well that's what

00:16:56,890 --> 00:17:01,150
a cookbook is and there's some overlap

00:16:58,930 --> 00:17:03,070
because installation profiles and

00:17:01,150 --> 00:17:05,380
distributions and features are all not

00:17:03,070 --> 00:17:12,160
quite the same cookbooks cover all three

00:17:05,380 --> 00:17:14,740
of those a recipe is like a module so

00:17:12,160 --> 00:17:17,890
usual syntax that chef uses is cookbook

00:17:14,740 --> 00:17:21,370
colon colon recipe so bacon colon colon

00:17:17,890 --> 00:17:23,829
crispy would refer to a file in the

00:17:21,370 --> 00:17:27,370
repository that you've got under

00:17:23,829 --> 00:17:31,360
cookbooks / bacon / recipes / crispy dot

00:17:27,370 --> 00:17:34,660
RB RB being a ruby file but if you think

00:17:31,360 --> 00:17:36,910
of a recipe like a module you'll be all

00:17:34,660 --> 00:17:38,170
set that's really what it is so what do

00:17:36,910 --> 00:17:39,640
we say right now there's a module for

00:17:38,170 --> 00:17:42,160
that well the answer is there's a recipe

00:17:39,640 --> 00:17:43,990
for that you can go looking and you will

00:17:42,160 --> 00:17:46,000
find there's tons of recipes out there

00:17:43,990 --> 00:17:48,070
for just about every server task you

00:17:46,000 --> 00:17:51,310
want and it may not be perfect but just

00:17:48,070 --> 00:17:53,200
like with modules you can customize them

00:17:51,310 --> 00:17:55,300
as you need to and you can write your

00:17:53,200 --> 00:18:00,210
own to do all the things that you need

00:17:55,300 --> 00:18:03,160
to do so a resource is an action

00:18:00,210 --> 00:18:06,220
anything you need to do on the server I

00:18:03,160 --> 00:18:08,650
need to add a file I need to add a user

00:18:06,220 --> 00:18:11,380
I need to change the permission I need

00:18:08,650 --> 00:18:13,110
to do whatever it is you need to do any

00:18:11,380 --> 00:18:15,850
of those things is termed a resource

00:18:13,110 --> 00:18:19,830
basically resource collections our

00:18:15,850 --> 00:18:22,240
recipe recipe collections our cookbook

00:18:19,830 --> 00:18:23,740
now if they take ingredient that might

00:18:22,240 --> 00:18:27,640
have fit the model but I think they just

00:18:23,740 --> 00:18:30,790
said in a resource its resource so a

00:18:27,640 --> 00:18:34,060
data bag is configuration storage the

00:18:30,790 --> 00:18:36,310
closest we have in Drupal might be

00:18:34,060 --> 00:18:39,040
variables the idea is is these are

00:18:36,310 --> 00:18:42,190
things that are stored potentially for

00:18:39,040 --> 00:18:46,810
use by multiple machines it has fields

00:18:42,190 --> 00:18:49,240
you can set mostly done in JSON so it's

00:18:46,810 --> 00:18:51,100
a little bit configuration you can

00:18:49,240 --> 00:18:53,110
encrypt them so for instance you might

00:18:51,100 --> 00:18:56,440
store your user list so you might have a

00:18:53,110 --> 00:18:58,060
list of people who are the users that

00:18:56,440 --> 00:18:59,350
you would be allowed on a particular

00:18:58,060 --> 00:19:01,539
machine

00:18:59,350 --> 00:19:04,360
and you would have a list of these users

00:19:01,539 --> 00:19:05,559
and potentially ssh-keys you might have

00:19:04,360 --> 00:19:07,390
passwords you might have all of this

00:19:05,559 --> 00:19:09,070
stuff it's stored in one place and every

00:19:07,390 --> 00:19:12,600
one of those machines would have access

00:19:09,070 --> 00:19:16,840
to this depending on how you set it up

00:19:12,600 --> 00:19:19,840
so templates are how configurations get

00:19:16,840 --> 00:19:23,200
filled out and we have the same thing we

00:19:19,840 --> 00:19:25,090
call it tokens the idea drupal tokens is

00:19:23,200 --> 00:19:26,679
is that we go ahead and say here's the

00:19:25,090 --> 00:19:30,370
token variables and drop them into a

00:19:26,679 --> 00:19:31,809
form and you get the page well in this

00:19:30,370 --> 00:19:32,860
case we're going to take tokens and

00:19:31,809 --> 00:19:36,010
we're going to use it to fill in the

00:19:32,860 --> 00:19:37,929
blanks on server config so you might

00:19:36,010 --> 00:19:39,789
have three different web servers and the

00:19:37,929 --> 00:19:41,620
configs are almost identical except for

00:19:39,789 --> 00:19:44,530
a couple of small changes and you would

00:19:41,620 --> 00:19:46,659
just use basic templates that way you'd

00:19:44,530 --> 00:19:50,380
have one version and just fill in those

00:19:46,659 --> 00:19:54,210
changes on a server by server basis so

00:19:50,380 --> 00:19:56,770
config files are like at that info file

00:19:54,210 --> 00:19:59,049
that looks a lot like the standard

00:19:56,770 --> 00:20:03,179
module dot info file and if you look at

00:19:59,049 --> 00:20:06,789
it we have dependencies and we have

00:20:03,179 --> 00:20:08,380
versioning we have some some basic stuff

00:20:06,789 --> 00:20:10,270
that goes ahead and describes what the

00:20:08,380 --> 00:20:15,280
thing is and who is responsible for it

00:20:10,270 --> 00:20:18,870
and that's basically what it does this

00:20:15,280 --> 00:20:20,890
in this case is a Drupal recipe and

00:20:18,870 --> 00:20:23,559
we're going to come back and look at

00:20:20,890 --> 00:20:24,669
this a little later actually well we'll

00:20:23,559 --> 00:20:27,490
mention it later but you can see right

00:20:24,669 --> 00:20:30,460
there we're on that line it says depends

00:20:27,490 --> 00:20:32,650
and it basically loops through and says

00:20:30,460 --> 00:20:36,340
this has got dependencies on PHP and

00:20:32,650 --> 00:20:38,110
apache to and mysql and openssl so chef

00:20:36,340 --> 00:20:40,150
will know that in order to run Drupal

00:20:38,110 --> 00:20:43,870
you need to have these resources

00:20:40,150 --> 00:20:46,330
installed first so it's smart it knows

00:20:43,870 --> 00:20:48,100
that you can't build Drupal unless you

00:20:46,330 --> 00:20:50,169
have all those pieces now you might say

00:20:48,100 --> 00:20:53,020
well I don't use MySQL we're building

00:20:50,169 --> 00:20:55,299
Drupal sitting on top of MongoDB well

00:20:53,020 --> 00:20:57,640
great so you make a recipe that has a

00:20:55,299 --> 00:21:00,880
MongoDB dependency instead and there's

00:20:57,640 --> 00:21:03,419
your customization so libraries are raw

00:21:00,880 --> 00:21:08,440
code you will occasionally find that a

00:21:03,419 --> 00:21:09,790
cookbook has some raw Ruby functions in

00:21:08,440 --> 00:21:11,260
there occasionally something else the

00:21:09,790 --> 00:21:12,950
idea being sometimes you just need to

00:21:11,260 --> 00:21:16,070
get that level of access you need

00:21:12,950 --> 00:21:17,690
be able to run something directly in you

00:21:16,070 --> 00:21:23,240
know basic language as opposed to

00:21:17,690 --> 00:21:27,560
through chefs things searching well

00:21:23,240 --> 00:21:29,660
searching is solar everybody's here used

00:21:27,560 --> 00:21:31,550
Apache Solr I mean basically Drupal

00:21:29,660 --> 00:21:34,570
decided that that was the way to go so

00:21:31,550 --> 00:21:36,830
again nothing you're not familiar with

00:21:34,570 --> 00:21:41,390
it's nice when you use some of the same

00:21:36,830 --> 00:21:43,970
tools so roles roles are server

00:21:41,390 --> 00:21:45,680
identities so for instance we say these

00:21:43,970 --> 00:21:47,030
servers over here our web servers and

00:21:45,680 --> 00:21:49,250
these servers over here our database

00:21:47,030 --> 00:21:51,560
servers and that's a logging server and

00:21:49,250 --> 00:21:54,230
you can then identify these things as

00:21:51,560 --> 00:21:56,840
groups so you can say hey web servers go

00:21:54,230 --> 00:21:58,550
find out who the logging server is and

00:21:56,840 --> 00:22:01,010
send your logs over there and you never

00:21:58,550 --> 00:22:03,170
need to specify IP addresses or names or

00:22:01,010 --> 00:22:04,910
anything else and chef will essentially

00:22:03,170 --> 00:22:07,870
take care of all of that for you and

00:22:04,910 --> 00:22:09,950
will make the connections as needed

00:22:07,870 --> 00:22:11,960
again this allows you to build things

00:22:09,950 --> 00:22:14,810
slowly and also have a lot of redundancy

00:22:11,960 --> 00:22:17,360
because you can say go send stuff to the

00:22:14,810 --> 00:22:19,100
logging servers and maybe you have two

00:22:17,360 --> 00:22:21,650
or three of them and then one goes down

00:22:19,100 --> 00:22:24,110
the others of air and 15 minutes after

00:22:21,650 --> 00:22:26,240
that machine goes down the other servers

00:22:24,110 --> 00:22:27,860
get updated and they go oh well there's

00:22:26,240 --> 00:22:29,930
only two machines now I'll remove that

00:22:27,860 --> 00:22:31,370
other one and therefore they just keep

00:22:29,930 --> 00:22:32,810
running and they don't sit there and try

00:22:31,370 --> 00:22:34,550
to send logs to some non-existent

00:22:32,810 --> 00:22:37,910
machine because that machine was taken

00:22:34,550 --> 00:22:39,350
down for maintenance so this way these

00:22:37,910 --> 00:22:41,260
servers are never going to give you up

00:22:39,350 --> 00:22:43,580
they're never going to let you down

00:22:41,260 --> 00:22:46,430
they're never going to run around and

00:22:43,580 --> 00:22:49,960
desert you oh I'm sorry it seems this

00:22:46,430 --> 00:22:49,960
presentation has been rickrolled

00:23:00,109 --> 00:23:08,549
well let's remain us lol laugh out loud

00:23:03,599 --> 00:23:18,619
no lose our Lego not even bringing my

00:23:08,549 --> 00:23:21,599
own hecklers there we go alright so

00:23:18,619 --> 00:23:23,609
attributes are properties so now we're

00:23:21,599 --> 00:23:24,979
getting to some of the JSON format and

00:23:23,609 --> 00:23:27,179
stuff this should look pretty familiar

00:23:24,979 --> 00:23:29,429
and I'm not going to go over all the

00:23:27,179 --> 00:23:31,019
details here but the basic concept is

00:23:29,429 --> 00:23:32,989
you have a run list that says what

00:23:31,019 --> 00:23:35,549
recipes to run so in this case that

00:23:32,989 --> 00:23:37,200
configuration for machine says you're

00:23:35,549 --> 00:23:39,179
going to run Drupal remember we talked

00:23:37,200 --> 00:23:40,679
the Drupal has dependency so it knows

00:23:39,179 --> 00:23:41,969
that if it's going to run Drupal it

00:23:40,679 --> 00:23:46,349
needs to have these other pieces in

00:23:41,969 --> 00:23:48,570
place it has you can see there a Drupal

00:23:46,349 --> 00:23:50,789
DB password setting which is a random

00:23:48,570 --> 00:23:53,070
string one of the nice things about Chef

00:23:50,789 --> 00:23:55,349
is for the most part the recipes are

00:23:53,070 --> 00:23:57,929
written so that if you don't specify a

00:23:55,349 --> 00:24:00,419
setting it will generate a random one

00:23:57,929 --> 00:24:03,869
for you so if you tell it to build a

00:24:00,419 --> 00:24:06,479
chef instance of say Drupal and you

00:24:03,869 --> 00:24:09,539
haven't pre told it what the password

00:24:06,479 --> 00:24:10,919
supposed to be for the database it will

00:24:09,539 --> 00:24:12,419
make one up and it will store it in a

00:24:10,919 --> 00:24:13,799
config file and you don't have to go

00:24:12,419 --> 00:24:15,299
figure it out you just have to open the

00:24:13,799 --> 00:24:17,369
config file up because it's right there

00:24:15,299 --> 00:24:20,639
now in the case of the next thing down

00:24:17,369 --> 00:24:22,619
the MySQL settings I actually specified

00:24:20,639 --> 00:24:24,299
those just to show that you can you can

00:24:22,619 --> 00:24:26,369
put them in so in this case when I built

00:24:24,299 --> 00:24:28,919
that config I actually said these are

00:24:26,369 --> 00:24:30,690
the root password and Debbie and

00:24:28,919 --> 00:24:32,820
passwords I want you to use for this

00:24:30,690 --> 00:24:35,369
particular config and because I put them

00:24:32,820 --> 00:24:37,440
in there when chef goes to set up mysql

00:24:35,369 --> 00:24:38,729
it says oh I know what that variable is

00:24:37,440 --> 00:24:41,460
I don't need to go create a random one

00:24:38,729 --> 00:24:42,919
I'll use the existing one and then

00:24:41,460 --> 00:24:45,809
there's a name and then there's

00:24:42,919 --> 00:24:48,539
environment chef does have environments

00:24:45,809 --> 00:24:50,820
I didn't really touch on that here but

00:24:48,539 --> 00:24:52,919
essentially you can do things like build

00:24:50,820 --> 00:24:54,960
the same server in different

00:24:52,919 --> 00:24:57,929
environments you can say build this

00:24:54,960 --> 00:25:00,690
machine this way if it's my production

00:24:57,929 --> 00:25:02,279
server but build it this way if it's set

00:25:00,690 --> 00:25:03,899
as the staging environment or the

00:25:02,279 --> 00:25:06,359
development environment and that way you

00:25:03,899 --> 00:25:08,580
have one set of recipes that can

00:25:06,359 --> 00:25:10,289
potentially behave differently depending

00:25:08,580 --> 00:25:11,570
on how you're using them so that way

00:25:10,289 --> 00:25:13,639
maybe your development environment

00:25:11,570 --> 00:25:15,769
ignore certain errors but

00:25:13,639 --> 00:25:17,539
it just doesn't have the production

00:25:15,769 --> 00:25:19,759
pieces it's looking for so that way you

00:25:17,539 --> 00:25:21,379
don't get all kinds of warning messages

00:25:19,759 --> 00:25:24,019
and you go oh yeah just ignore that I

00:25:21,379 --> 00:25:26,149
need to fix my script you can just make

00:25:24,019 --> 00:25:27,589
your script work the first time that it

00:25:26,149 --> 00:25:33,679
pays attention to what the environment

00:25:27,589 --> 00:25:36,549
is so node work station chef server chef

00:25:33,679 --> 00:25:38,929
client repository knife cookbook recipe

00:25:36,549 --> 00:25:40,459
we talked about configs and attributes

00:25:38,929 --> 00:25:43,450
policies are basically all of those

00:25:40,459 --> 00:25:46,249
things with just it's all your settings

00:25:43,450 --> 00:25:48,349
resources data bag templates libraries

00:25:46,249 --> 00:25:50,749
and roles so if you look at that thing

00:25:48,349 --> 00:25:52,099
now you now understand the basics and

00:25:50,749 --> 00:25:53,570
you can see they're really not that much

00:25:52,099 --> 00:25:55,609
different I mean there's a little bit of

00:25:53,570 --> 00:25:58,339
difference but there is certain

00:25:55,609 --> 00:26:00,499
similarities um it is a very structured

00:25:58,339 --> 00:26:02,089
system for building servers as opposed

00:26:00,499 --> 00:26:06,049
to drupal which is a structured system

00:26:02,089 --> 00:26:08,809
for building websites so let's take a

00:26:06,049 --> 00:26:10,789
practical example you are tasked with

00:26:08,809 --> 00:26:12,440
setting up chef to build a new staging

00:26:10,789 --> 00:26:13,570
server for your team how do you start

00:26:12,440 --> 00:26:15,619
we're going to keep it really simple

00:26:13,570 --> 00:26:17,959
we're going to say the requirements for

00:26:15,619 --> 00:26:20,329
the new server are just a lamp stack

00:26:17,959 --> 00:26:21,799
that's it that's the only thing we care

00:26:20,329 --> 00:26:23,119
about we don't care about a firewall we

00:26:21,799 --> 00:26:24,709
don't care about log we're not setting

00:26:23,119 --> 00:26:26,299
any of that up with just somebody says

00:26:24,709 --> 00:26:28,669
hey I need you to spin up a new lamp

00:26:26,299 --> 00:26:30,049
stack for me how many people have had

00:26:28,669 --> 00:26:34,609
problems with just getting lamp stack

00:26:30,049 --> 00:26:36,709
setup yeah alright so bare metal and

00:26:34,609 --> 00:26:39,409
this is one of our goals of Chef is that

00:26:36,709 --> 00:26:42,799
essentially you can through having your

00:26:39,409 --> 00:26:44,869
configuration encode your data backed up

00:26:42,799 --> 00:26:46,309
so whether that's you know your mysql

00:26:44,869 --> 00:26:49,669
dump or however you're storing your data

00:26:46,309 --> 00:26:52,999
some kind of backup and having your your

00:26:49,669 --> 00:26:55,579
code like drupal all in repositories you

00:26:52,999 --> 00:26:58,969
could essentially bring up a brand-new

00:26:55,579 --> 00:27:03,829
machine from bare metal and have it be

00:26:58,969 --> 00:27:05,269
exactly the same every time so how will

00:27:03,829 --> 00:27:08,149
be provision well could be a physical

00:27:05,269 --> 00:27:12,049
box could be a virtual box maybe amazon

00:27:08,149 --> 00:27:16,070
web server you've got a variety of OS

00:27:12,049 --> 00:27:17,809
choices you pick one in this case let's

00:27:16,070 --> 00:27:22,029
say we're going to build it on ubuntu

00:27:17,809 --> 00:27:26,360
and we're going to say that it's a

00:27:22,029 --> 00:27:28,970
virtual box it doesn't really matter so

00:27:26,360 --> 00:27:31,220
next step is to get chef server now you

00:27:28,970 --> 00:27:34,430
can set up chef server on your own it's

00:27:31,220 --> 00:27:38,180
open sourced Opscode provides a free

00:27:34,430 --> 00:27:40,970
trial of their hosted solution called

00:27:38,180 --> 00:27:43,250
enterprise chef to get your feet wet

00:27:40,970 --> 00:27:45,680
that's a great way to get started I

00:27:43,250 --> 00:27:48,110
recommend it you don't need to set

00:27:45,680 --> 00:27:50,720
anything up you just go you say hey give

00:27:48,110 --> 00:27:53,560
me a free account they say sure give us

00:27:50,720 --> 00:27:55,610
your email and you're ready to go and

00:27:53,560 --> 00:27:58,030
then then we'll walk you through

00:27:55,610 --> 00:28:01,280
installing chef on your workstation and

00:27:58,030 --> 00:28:03,440
essentially that one line which is it

00:28:01,280 --> 00:28:08,060
just goes and gets a script and runs it

00:28:03,440 --> 00:28:11,240
that's the magic in some way shape or

00:28:08,060 --> 00:28:14,510
form that script or what that script

00:28:11,240 --> 00:28:17,120
does runs on every single machine that's

00:28:14,510 --> 00:28:20,780
part of what you're doing that script

00:28:17,120 --> 00:28:22,810
will install all of the chef's tools all

00:28:20,780 --> 00:28:27,080
of the chef's clients and servers

00:28:22,810 --> 00:28:30,620
everything you need to make your

00:28:27,080 --> 00:28:33,680
machines talk to each other so once you

00:28:30,620 --> 00:28:36,110
run that it basically installs all the

00:28:33,680 --> 00:28:37,520
pieces including Ruby the whole works it

00:28:36,110 --> 00:28:38,930
basically looks at your system it says

00:28:37,520 --> 00:28:41,360
what do I need to make this functional

00:28:38,930 --> 00:28:43,460
and it does it so they've got the magic

00:28:41,360 --> 00:28:45,650
down to one line if you're if you

00:28:43,460 --> 00:28:48,830
basically memorize that line you can sit

00:28:45,650 --> 00:28:50,420
down at any machine you need to and boom

00:28:48,830 --> 00:28:52,910
you've got a chef workstation which is

00:28:50,420 --> 00:28:56,050
great when your laptop decides to act up

00:28:52,910 --> 00:28:58,130
and you need to grab a friend's laptop

00:28:56,050 --> 00:29:00,200
so now you have to decide on which

00:28:58,130 --> 00:29:03,770
cookbooks you're going to install and so

00:29:00,200 --> 00:29:05,720
you can go to among other places the

00:29:03,770 --> 00:29:08,480
community site for Opscode where they

00:29:05,720 --> 00:29:09,680
have essentially their modules list if

00:29:08,480 --> 00:29:14,060
you think about it that way in a

00:29:09,680 --> 00:29:18,470
features list they have hundreds if not

00:29:14,060 --> 00:29:22,640
thousands of recipes cookbooks for all

00:29:18,470 --> 00:29:25,070
kinds of services and machines and

00:29:22,640 --> 00:29:27,440
programming languages etc so it's just

00:29:25,070 --> 00:29:29,480
like going to drupal.org you basically

00:29:27,440 --> 00:29:30,830
say oh I need this and I heard really

00:29:29,480 --> 00:29:35,540
good things about that I want to try

00:29:30,830 --> 00:29:38,510
that out so in this case we're going to

00:29:35,540 --> 00:29:39,080
say okay knife I know what cookbooks I

00:29:38,510 --> 00:29:42,150
will

00:29:39,080 --> 00:29:49,140
so I type the command a knife cookbook

00:29:42,150 --> 00:29:51,870
site install apache2 MySQL PHP a knife

00:29:49,140 --> 00:29:55,650
says oh okay so you're telling me go to

00:29:51,870 --> 00:29:57,990
the main repository site and go grab the

00:29:55,650 --> 00:30:00,450
apache two cookbooks a mysql cookbook in

00:29:57,990 --> 00:30:02,250
the PHP cookbook and by the way any

00:30:00,450 --> 00:30:03,780
dependencies that it has so there's a

00:30:02,250 --> 00:30:07,320
couple of small dependencies that some

00:30:03,780 --> 00:30:09,210
others want and it will turn for a

00:30:07,320 --> 00:30:13,110
little bit it will go download stuff and

00:30:09,210 --> 00:30:16,020
it you will end up with some git

00:30:13,110 --> 00:30:18,720
repository files for each of those and

00:30:16,020 --> 00:30:20,580
you can at that point commit them into

00:30:18,720 --> 00:30:22,800
your local code repository and you're

00:30:20,580 --> 00:30:27,650
all set but we need to send that to the

00:30:22,800 --> 00:30:31,590
chef server that's our own private

00:30:27,650 --> 00:30:33,300
server in this case it's hosted but they

00:30:31,590 --> 00:30:34,380
don't put anything into it you don't

00:30:33,300 --> 00:30:35,730
have to worry about oh they have a

00:30:34,380 --> 00:30:37,860
version of this or a version of that

00:30:35,730 --> 00:30:40,200
they give you the blank slate they just

00:30:37,860 --> 00:30:41,430
say it's empty you put into it what you

00:30:40,200 --> 00:30:42,870
want you don't have to worry about oh

00:30:41,430 --> 00:30:44,880
they have an obsolete version there's

00:30:42,870 --> 00:30:47,040
nothing in it the only way that things

00:30:44,880 --> 00:30:49,950
get in is because you put them in so we

00:30:47,040 --> 00:30:52,530
say knife cookbook upload all and it

00:30:49,950 --> 00:30:55,080
goes boom boom and it sends it all to

00:30:52,530 --> 00:31:00,900
the chef server and fro a lot just like

00:30:55,080 --> 00:31:03,690
in the matrix chef knows kung fu so now

00:31:00,900 --> 00:31:06,300
we tell chef to control our new server

00:31:03,690 --> 00:31:08,250
that's the virtual machine we said we

00:31:06,300 --> 00:31:11,280
were going to set up so the only thing

00:31:08,250 --> 00:31:13,650
that's on that machine is we basically

00:31:11,280 --> 00:31:15,540
format on our virtual machine we said

00:31:13,650 --> 00:31:17,370
install and boon to because that's what

00:31:15,540 --> 00:31:19,140
we're going to use so whatever you're

00:31:17,370 --> 00:31:22,950
used to using maybe you use windows

00:31:19,140 --> 00:31:24,720
whatever it is we basically just do a

00:31:22,950 --> 00:31:26,850
knife command from our workstation we

00:31:24,720 --> 00:31:30,330
say nice bootstrap the IP of the server

00:31:26,850 --> 00:31:31,800
and then we give it an SSH user and we

00:31:30,330 --> 00:31:33,750
tell it the studio so it's got some root

00:31:31,800 --> 00:31:35,280
access so it can install packages and we

00:31:33,750 --> 00:31:41,070
say okay here's what I want you to run

00:31:35,280 --> 00:31:44,310
go install MySQL apache2 and PHP that

00:31:41,070 --> 00:31:51,030
one command ssh is over to your new

00:31:44,310 --> 00:31:52,820
virtual box it says a chef on here we

00:31:51,030 --> 00:31:54,950
didn't put chef on it so it goes

00:31:52,820 --> 00:31:58,070
that nice script it goes and it grabs

00:31:54,950 --> 00:32:01,130
all the chef's stuff puts that on and

00:31:58,070 --> 00:32:03,590
then says oh I've been told to put mysql

00:32:01,130 --> 00:32:05,750
apache2 and PHP onto it it goes looks at

00:32:03,590 --> 00:32:07,580
those cookbooks and it says oh there's

00:32:05,750 --> 00:32:09,440
some dependencies there and it goes and

00:32:07,580 --> 00:32:11,630
it Greg it basically will bootstrap the

00:32:09,440 --> 00:32:13,159
entire thing and when it finishes and

00:32:11,630 --> 00:32:15,470
depending on the speed of your machines

00:32:13,159 --> 00:32:17,299
and the internet it might take 30

00:32:15,470 --> 00:32:19,130
seconds it might take 10 minutes you

00:32:17,299 --> 00:32:23,029
know depends on how complicated a recipe

00:32:19,130 --> 00:32:26,000
you do basically when it finishes you

00:32:23,029 --> 00:32:27,559
have a lamp server you're done you don't

00:32:26,000 --> 00:32:29,299
need to do anything else you might not

00:32:27,559 --> 00:32:31,279
want to tweak some configs etc because

00:32:29,299 --> 00:32:33,590
that was a very simple recipe we didn't

00:32:31,279 --> 00:32:36,230
customize or at all but basically with

00:32:33,590 --> 00:32:38,539
what did we do three commands go grab

00:32:36,230 --> 00:32:41,990
some stuff go push some stuff up to the

00:32:38,539 --> 00:32:43,789
server go bootstrap a thing now if we

00:32:41,990 --> 00:32:45,049
want to do a second machine you know

00:32:43,789 --> 00:32:46,580
what to do those first two steps they're

00:32:45,049 --> 00:32:49,070
done you just go and put another IP

00:32:46,580 --> 00:32:50,539
address in there and you're done there's

00:32:49,070 --> 00:32:52,399
another machine and it's identical to

00:32:50,539 --> 00:32:54,379
the first machine except maybe it has a

00:32:52,399 --> 00:32:56,240
different IP address you could customize

00:32:54,379 --> 00:32:58,940
it again but the goal here is

00:32:56,240 --> 00:33:02,509
replicability and so it's really simple

00:32:58,940 --> 00:33:04,220
to do it so all right we didn't put

00:33:02,509 --> 00:33:06,019
drupal on let's let's let's bring it

00:33:04,220 --> 00:33:08,419
back to drupal so let's use a drupal

00:33:06,019 --> 00:33:11,419
cookbook that we looked at earlier so it

00:33:08,419 --> 00:33:13,940
has the dependencies for mysql PHP and

00:33:11,419 --> 00:33:18,230
apache too so the only line we would had

00:33:13,940 --> 00:33:22,429
to have done is cookbook site install

00:33:18,230 --> 00:33:25,100
Drupal because that recipe knew that we

00:33:22,429 --> 00:33:27,590
needed all the other things so that has

00:33:25,100 --> 00:33:30,230
built into it the fact you need a lamp

00:33:27,590 --> 00:33:32,059
stack so we again don't you have to go

00:33:30,230 --> 00:33:35,000
provision anything somebody says hey go

00:33:32,059 --> 00:33:36,980
spin me up another Drupal server there's

00:33:35,000 --> 00:33:39,769
your command and then you run your

00:33:36,980 --> 00:33:43,039
bootstrap command only in this place

00:33:39,769 --> 00:33:45,500
you'd go recipe drupal and you wait for

00:33:43,039 --> 00:33:49,029
it to churn and you go okay yeah new

00:33:45,500 --> 00:33:51,289
machine here's the IP address go ahead

00:33:49,029 --> 00:33:54,110
starting up servers has never been

00:33:51,289 --> 00:33:55,909
easier especially when their virtual

00:33:54,110 --> 00:33:59,299
machines because you can basically go

00:33:55,909 --> 00:34:03,289
ahead and spin up as many as you need as

00:33:59,299 --> 00:34:06,659
quick as possible so let's talk a little

00:34:03,289 --> 00:34:08,309
bit about configuration pieces

00:34:06,659 --> 00:34:09,599
things to put in data bags we talked

00:34:08,309 --> 00:34:11,250
about this a little bit these are things

00:34:09,599 --> 00:34:13,200
you don't want to put in a recipe think

00:34:11,250 --> 00:34:14,940
of recipes as sort of public I mean you

00:34:13,200 --> 00:34:18,419
can still have private private recipes

00:34:14,940 --> 00:34:19,770
but if you get an Apache recipe you

00:34:18,419 --> 00:34:22,200
might say I need to set up certain

00:34:19,770 --> 00:34:24,809
Apache users or MySQL users or whatever

00:34:22,200 --> 00:34:27,089
the case may be so so things like ssl

00:34:24,809 --> 00:34:29,609
certificates passwords users these are

00:34:27,089 --> 00:34:31,889
things that are private data you put

00:34:29,609 --> 00:34:34,230
those into a data bag they get stored

00:34:31,889 --> 00:34:37,200
encrypted if you want them to be on your

00:34:34,230 --> 00:34:38,819
chef server and so you do have a little

00:34:37,200 --> 00:34:41,010
bit of an issue there because you still

00:34:38,819 --> 00:34:42,649
have to control who has access to your

00:34:41,010 --> 00:34:44,490
chef servers so there are still some

00:34:42,649 --> 00:34:47,609
security issues you don't necessarily

00:34:44,490 --> 00:34:49,919
want everybody who has access to your

00:34:47,609 --> 00:34:52,619
chef server for instance to be able to

00:34:49,919 --> 00:34:54,809
add a new user to the system so that's

00:34:52,619 --> 00:34:58,770
one caveat you want to make sure that

00:34:54,809 --> 00:35:01,859
you're paying attention to so using

00:34:58,770 --> 00:35:04,500
Ubuntu if you can I wish somebody told

00:35:01,859 --> 00:35:07,710
me the sooner I started using chef and

00:35:04,500 --> 00:35:09,869
I've been a debian fan for years I've

00:35:07,710 --> 00:35:11,970
used in boom to I like it but I was like

00:35:09,869 --> 00:35:14,099
oh well Debbie it's really solid you

00:35:11,970 --> 00:35:16,130
know they're long cycle and that you

00:35:14,099 --> 00:35:19,680
usually know I can trust the packages or

00:35:16,130 --> 00:35:21,420
absolutely solid and the problem is it's

00:35:19,680 --> 00:35:23,940
the lack of eyeballs you end up with a

00:35:21,420 --> 00:35:26,549
lot of scripts a lot of recipes that

00:35:23,940 --> 00:35:28,289
only work on things that people have

00:35:26,549 --> 00:35:30,839
tested it on well if you want maximum

00:35:28,289 --> 00:35:35,190
compatibility use them bone to use the

00:35:30,839 --> 00:35:38,420
long term the LTS images i highly

00:35:35,190 --> 00:35:41,309
recommend it i think in the long run

00:35:38,420 --> 00:35:42,839
just in terms of comfort to know that

00:35:41,309 --> 00:35:44,250
there's lots of other people out there

00:35:42,839 --> 00:35:46,680
using it you're going to be the happiest

00:35:44,250 --> 00:35:50,010
but to be clear chef will run on

00:35:46,680 --> 00:35:51,630
anything it will control windows boxes

00:35:50,010 --> 00:35:53,640
if you've got windows boxes you want to

00:35:51,630 --> 00:35:55,529
be able to reliably bring up the same

00:35:53,640 --> 00:36:00,059
windows box every single time building

00:35:55,529 --> 00:36:04,289
it from a static image freebsd every

00:36:00,059 --> 00:36:08,220
flavor of unix OS x if you're running

00:36:04,289 --> 00:36:11,549
for some reason max servers you

00:36:08,220 --> 00:36:13,289
obviously have got for some some reason

00:36:11,549 --> 00:36:15,210
a lot of money to spend but that's great

00:36:13,289 --> 00:36:17,130
you know i mean if that's what you want

00:36:15,210 --> 00:36:20,420
you know i'm not sure why would be using

00:36:17,130 --> 00:36:20,420
microsoft at that point to get a lot

00:36:21,080 --> 00:36:27,360
alright so this is a classic drupal ism

00:36:23,790 --> 00:36:32,520
don't hack core the same lesson applies

00:36:27,360 --> 00:36:35,610
if you're downloading a cookbook yes

00:36:32,520 --> 00:36:37,710
there are times you might change it but

00:36:35,610 --> 00:36:39,450
if you change it you're making it harder

00:36:37,710 --> 00:36:41,010
on yourself because when the cookbook

00:36:39,450 --> 00:36:44,220
gets updated you're going to have to

00:36:41,010 --> 00:36:46,860
figure out the changes build on top

00:36:44,220 --> 00:36:49,230
build custom things that sit on another

00:36:46,860 --> 00:36:50,640
layer so take the standard cookbook and

00:36:49,230 --> 00:36:53,130
then build your own custom little

00:36:50,640 --> 00:36:55,710
recipes that sit on top of that and run

00:36:53,130 --> 00:36:59,400
those recipes don't go hacking the

00:36:55,710 --> 00:37:01,140
standard cookbooks you will be glad you

00:36:59,400 --> 00:37:03,390
didn't do that for the same reason

00:37:01,140 --> 00:37:07,400
you're glad you don't have core because

00:37:03,390 --> 00:37:10,470
basically you're killing kittens and

00:37:07,400 --> 00:37:11,850
contribute your patches back it's really

00:37:10,470 --> 00:37:14,310
nice i have one I've got to get back

00:37:11,850 --> 00:37:18,390
where I discovered that for some reason

00:37:14,310 --> 00:37:20,910
I was using a user creation cookbook and

00:37:18,390 --> 00:37:22,410
it allowed me to set a password which is

00:37:20,910 --> 00:37:24,570
great so I could set up a default

00:37:22,410 --> 00:37:26,820
password for the user so I'd spin up a

00:37:24,570 --> 00:37:28,110
server and they could login because they

00:37:26,820 --> 00:37:29,250
knew what their default password was and

00:37:28,110 --> 00:37:31,890
everybody had a different default

00:37:29,250 --> 00:37:34,320
password the problem was is that Chef

00:37:31,890 --> 00:37:35,970
client runs regularly usually put it

00:37:34,320 --> 00:37:38,490
into a cron job and you just tell it to

00:37:35,970 --> 00:37:41,150
run every so often let's say every 15

00:37:38,490 --> 00:37:43,620
minutes so that way it keeps checking

00:37:41,150 --> 00:37:45,510
well unfortunately what would happen was

00:37:43,620 --> 00:37:46,680
every 15 minutes it would check and if

00:37:45,510 --> 00:37:47,940
they had logged in and changed their

00:37:46,680 --> 00:37:51,360
password it would go change their

00:37:47,940 --> 00:37:53,130
password back it would basically force

00:37:51,360 --> 00:37:54,480
their password back to the default and I

00:37:53,130 --> 00:37:56,220
said I don't want that behavior I want

00:37:54,480 --> 00:37:58,650
to set a default password and make it so

00:37:56,220 --> 00:38:01,020
that when they change it you leave it

00:37:58,650 --> 00:38:02,550
alone and I found a way to do it and I

00:38:01,020 --> 00:38:03,960
just haven't had a chance to submit that

00:38:02,550 --> 00:38:06,210
patch back but that sound like to do

00:38:03,960 --> 00:38:08,460
list is to to add that back in it's a

00:38:06,210 --> 00:38:13,110
great example where how many other

00:38:08,460 --> 00:38:17,940
people might find useful quite a lot so

00:38:13,110 --> 00:38:19,650
one cookbook to roll them all it's

00:38:17,940 --> 00:38:22,710
really tempting to build separate

00:38:19,650 --> 00:38:24,600
cookbooks for all your pieces we're all

00:38:22,710 --> 00:38:27,150
used to compartmentalizing and trying to

00:38:24,600 --> 00:38:30,900
make sure that you know you keep your

00:38:27,150 --> 00:38:32,460
project separate I did that and then I

00:38:30,900 --> 00:38:35,250
was kind of sorry I did

00:38:32,460 --> 00:38:37,130
cuz the waste servers tend to work as

00:38:35,250 --> 00:38:39,780
there's a lot of interdependence E and

00:38:37,130 --> 00:38:41,700
you end up with sort of this really

00:38:39,780 --> 00:38:43,440
nasty web of dependencies and what I

00:38:41,700 --> 00:38:46,290
found was easier was for instance

00:38:43,440 --> 00:38:48,720
firewalls I had a custom firewall

00:38:46,290 --> 00:38:50,730
cookbook and what I realized was is that

00:38:48,720 --> 00:38:53,220
I don't have one firewall I have a lot

00:38:50,730 --> 00:38:54,869
of firewalls I have a firewall setting

00:38:53,220 --> 00:38:56,760
depending on whether i'm running a

00:38:54,869 --> 00:38:59,609
particular service so really what I

00:38:56,760 --> 00:39:03,540
should have is I should have a in with

00:38:59,609 --> 00:39:07,080
what sets that service up the firewall

00:39:03,540 --> 00:39:09,270
instructions and that way I spread it

00:39:07,080 --> 00:39:11,280
apart so the only time those firewall

00:39:09,270 --> 00:39:14,430
instructions go into a box is if I'm

00:39:11,280 --> 00:39:18,810
putting the important pieces like the

00:39:14,430 --> 00:39:22,050
service that I'm firewalling off because

00:39:18,810 --> 00:39:25,080
of that your best bet is to start from

00:39:22,050 --> 00:39:27,960
I'm going to build a custom cookbook and

00:39:25,080 --> 00:39:30,240
put all your recipes into that and don't

00:39:27,960 --> 00:39:31,710
break it apart at least to begin with

00:39:30,240 --> 00:39:33,119
it's really nice to be able to say hey

00:39:31,710 --> 00:39:34,800
I'm going to contribute stuff back and

00:39:33,119 --> 00:39:36,960
I've got this one cookbook I want to do

00:39:34,800 --> 00:39:38,460
build yourself a cookbook that's got

00:39:36,960 --> 00:39:40,859
everything and then at some point go

00:39:38,460 --> 00:39:42,450
this is these three or four things are

00:39:40,859 --> 00:39:44,760
really worth sharing and put that out

00:39:42,450 --> 00:39:46,650
but don't don't split it up at first

00:39:44,760 --> 00:39:48,510
because I think you'll be sorry because

00:39:46,650 --> 00:39:50,730
it gets way more complicated it's not

00:39:48,510 --> 00:39:51,990
like building something that doesn't

00:39:50,730 --> 00:39:53,700
have dependencies when you start having

00:39:51,990 --> 00:39:55,320
five or six servers that have

00:39:53,700 --> 00:39:56,849
interdependencies and slight different

00:39:55,320 --> 00:39:58,410
changes it's really nice to know that

00:39:56,849 --> 00:39:59,280
there's one place to go look that you're

00:39:58,410 --> 00:40:02,550
not sitting there going on which

00:39:59,280 --> 00:40:03,690
cookbook did I put that in so that

00:40:02,550 --> 00:40:07,770
brings me to the next point which is

00:40:03,690 --> 00:40:10,650
record your changes and make sure your

00:40:07,770 --> 00:40:12,900
co-workers record their changes because

00:40:10,650 --> 00:40:15,330
there's nothing worse than having a

00:40:12,900 --> 00:40:17,130
co-worker he says oh yeah there was a

00:40:15,330 --> 00:40:21,839
problem with such and such and I went in

00:40:17,130 --> 00:40:23,520
and I tweaked a config file and you're

00:40:21,839 --> 00:40:28,710
waiting and they don't say anything you

00:40:23,520 --> 00:40:30,330
go what config file did you tweak oh I

00:40:28,710 --> 00:40:34,619
don't remember well you can figure it

00:40:30,330 --> 00:40:36,900
out it'll be okay well if you really are

00:40:34,619 --> 00:40:39,119
careful about documenting your changes

00:40:36,900 --> 00:40:41,700
you will put them back into your recipes

00:40:39,119 --> 00:40:43,589
because the goal of shaft is every

00:40:41,700 --> 00:40:43,970
change that happens should end up in a

00:40:43,589 --> 00:40:46,820
rest

00:40:43,970 --> 00:40:48,500
in fact your production machines you

00:40:46,820 --> 00:40:51,320
should never have to even log into

00:40:48,500 --> 00:40:53,109
ideally because every single change that

00:40:51,320 --> 00:40:55,670
happens should be under version control

00:40:53,109 --> 00:40:57,950
should be in a recipe should be

00:40:55,670 --> 00:41:00,349
something that you can document and say

00:40:57,950 --> 00:41:02,750
when it happened and when it was when it

00:41:00,349 --> 00:41:04,670
took effect and if you log into a

00:41:02,750 --> 00:41:06,710
particular box and you tweak a config

00:41:04,670 --> 00:41:08,240
setting it might be perfectly fine and

00:41:06,710 --> 00:41:12,260
then three weeks later you change

00:41:08,240 --> 00:41:17,119
something and chef client runs and oh

00:41:12,260 --> 00:41:18,800
wait that configuration changed and you

00:41:17,119 --> 00:41:20,510
may not even remember what tweak you

00:41:18,800 --> 00:41:24,950
made and now you're back to square one

00:41:20,510 --> 00:41:29,349
so document your changes chef works if

00:41:24,950 --> 00:41:33,080
you work it if you break the habit of

00:41:29,349 --> 00:41:38,720
one-off fixing your servers you will be

00:41:33,080 --> 00:41:48,260
much better off so questions there any

00:41:38,720 --> 00:41:50,480
questions get you want to use the mic hi

00:41:48,260 --> 00:41:53,660
my name's Sean I had a brief test of

00:41:50,480 --> 00:41:55,130
server and I was wondering how open

00:41:53,660 --> 00:41:58,250
source it is because when I tried to

00:41:55,130 --> 00:41:59,930
download it it wasn't so easy I didn't

00:41:58,250 --> 00:42:03,500
find a gift repository I know you can

00:41:59,930 --> 00:42:06,140
test and use the online enterprise

00:42:03,500 --> 00:42:08,330
version but I couldn't find a github

00:42:06,140 --> 00:42:11,599
repository I had to fill out a form and

00:42:08,330 --> 00:42:13,820
then I got a tarball to download I just

00:42:11,599 --> 00:42:15,680
made me wonder you know it's actually

00:42:13,820 --> 00:42:17,210
very open source they do have extensions

00:42:15,680 --> 00:42:19,070
that they have done for hosting and they

00:42:17,210 --> 00:42:21,349
freely admit that I mean that's their

00:42:19,070 --> 00:42:23,810
business model is if you are big enough

00:42:21,349 --> 00:42:25,099
that you need some of their extra

00:42:23,810 --> 00:42:26,660
services because you're running that

00:42:25,099 --> 00:42:29,210
many servers they want to sell you that

00:42:26,660 --> 00:42:31,760
service I believe that you can just

00:42:29,210 --> 00:42:33,170
download it from github if we had the

00:42:31,760 --> 00:42:36,099
web here I could show you but basically

00:42:33,170 --> 00:42:38,330
if you go to opscode they do offer

00:42:36,099 --> 00:42:41,599
download the chef server I'm running the

00:42:38,330 --> 00:42:45,050
open source server because I just

00:42:41,599 --> 00:42:47,000
decided one in my business case we

00:42:45,050 --> 00:42:48,980
actually have to keep certain sensitive

00:42:47,000 --> 00:42:51,109
data and so we just decided that having

00:42:48,980 --> 00:42:53,000
an internally run chef server made the

00:42:51,109 --> 00:42:54,859
most sense because we're having to

00:42:53,000 --> 00:42:56,839
maintain all the other information

00:42:54,859 --> 00:42:57,770
anyway in this way it's completely

00:42:56,839 --> 00:42:59,660
self-contained

00:42:57,770 --> 00:43:04,520
ever have to go make queries outside of

00:42:59,660 --> 00:43:05,840
the local organization so it is open it

00:43:04,520 --> 00:43:07,130
is completely open source there's a

00:43:05,840 --> 00:43:09,110
couple of pieces that are fairly

00:43:07,130 --> 00:43:10,910
advanced that no they're not in the open

00:43:09,110 --> 00:43:12,710
source one but what I mean I know the

00:43:10,910 --> 00:43:14,600
licenses open source by was honoring how

00:43:12,710 --> 00:43:15,890
accessible it really is and have you any

00:43:14,600 --> 00:43:19,040
experience in the community in

00:43:15,890 --> 00:43:21,410
submitting patches or yes in fact

00:43:19,040 --> 00:43:23,600
actually I've submitted quite a number

00:43:21,410 --> 00:43:25,910
of bug reports and all the ones that

00:43:23,600 --> 00:43:27,590
I've submitted including questions when

00:43:25,910 --> 00:43:30,500
I had an issue got answer right away

00:43:27,590 --> 00:43:33,140
they basically use they use github I

00:43:30,500 --> 00:43:34,580
mean it really doesn't i would say

00:43:33,140 --> 00:43:36,380
ninety-five percent of the stuff you're

00:43:34,580 --> 00:43:38,810
going to find is being hosted on github

00:43:36,380 --> 00:43:40,130
and I've had things where i went ahead

00:43:38,810 --> 00:43:41,810
and i said hand getting this error

00:43:40,130 --> 00:43:43,970
message and i had a developer come back

00:43:41,810 --> 00:43:45,500
and go oh yeah you're using two older

00:43:43,970 --> 00:43:47,030
version of Ruby and it turns out he was

00:43:45,500 --> 00:43:48,560
absolutely right I that machine I

00:43:47,030 --> 00:43:49,790
actually had two older version of Ruby I

00:43:48,560 --> 00:43:53,510
was getting an error because of that

00:43:49,790 --> 00:43:54,710
which is pretty good support because I

00:43:53,510 --> 00:43:56,060
mean he could have just shrugged and

00:43:54,710 --> 00:43:58,210
said I don't know i don't have that area

00:43:56,060 --> 00:44:00,740
he actually had the answer which was

00:43:58,210 --> 00:44:06,290
look on my local machine and he was

00:44:00,740 --> 00:44:08,810
right so in terms of availability of the

00:44:06,290 --> 00:44:12,710
community I think it's awesome i would

00:44:08,810 --> 00:44:16,910
say that you're going to find almost

00:44:12,710 --> 00:44:19,580
every major server piece that any of us

00:44:16,910 --> 00:44:21,950
here have to build there's probably if

00:44:19,580 --> 00:44:23,360
not a chef recipe already done at least

00:44:21,950 --> 00:44:26,270
something that will point you in the

00:44:23,360 --> 00:44:27,830
right direction i did have to build some

00:44:26,270 --> 00:44:30,920
custom recipes we're doing some stuff

00:44:27,830 --> 00:44:34,130
with Shibboleth for instance for being

00:44:30,920 --> 00:44:35,780
able to do custom user sign on things

00:44:34,130 --> 00:44:37,460
and it turns out that the Shiv all the

00:44:35,780 --> 00:44:44,500
stuff that existed didn't didn't work

00:44:37,460 --> 00:44:44,500
for me but I mean my custom script is

00:44:46,660 --> 00:44:51,740
two files three files I mean it really

00:44:49,370 --> 00:44:53,390
is not much it's and that's the thing is

00:44:51,740 --> 00:44:55,100
that the models are out there that even

00:44:53,390 --> 00:44:56,480
if there's nothing that's exactly what

00:44:55,100 --> 00:44:58,340
you need you can find something that

00:44:56,480 --> 00:45:01,340
gives you the pointers so you can build

00:44:58,340 --> 00:45:02,690
what you need to do it's obviously you

00:45:01,340 --> 00:45:04,220
need to understand how to build a server

00:45:02,690 --> 00:45:05,630
to begin with you need to know how to

00:45:04,220 --> 00:45:06,950
build whatever piece it is you're going

00:45:05,630 --> 00:45:08,730
to build any way to make your script

00:45:06,950 --> 00:45:10,680
work properly

00:45:08,730 --> 00:45:12,300
you know being able to say bring up an

00:45:10,680 --> 00:45:13,290
Apache two servers great but if you

00:45:12,300 --> 00:45:14,490
don't know how to configure apache

00:45:13,290 --> 00:45:16,080
you're not going to know where the

00:45:14,490 --> 00:45:18,330
tweaks are you need to make to set them

00:45:16,080 --> 00:45:19,500
up same thing with my SQL tuning you

00:45:18,330 --> 00:45:21,840
know it's not going to do that stuff for

00:45:19,500 --> 00:45:24,000
you so this is not going to replace your

00:45:21,840 --> 00:45:25,230
sis admins this is just going to make it

00:45:24,000 --> 00:45:28,770
so that they can spend time on the

00:45:25,230 --> 00:45:30,270
important things not oh yeah boss I need

00:45:28,770 --> 00:45:32,370
to bring up a lamp server i'll have that

00:45:30,270 --> 00:45:34,080
tomorrow because we just saw how easy it

00:45:32,370 --> 00:45:35,820
is you know now if somebody says that i

00:45:34,080 --> 00:45:39,140
need to bring up a lab server your

00:45:35,820 --> 00:45:39,140
answers okay in five minutes later

00:45:39,590 --> 00:45:46,740
what's what's the workflow for handling

00:45:43,230 --> 00:45:49,980
configuration changes so for example in

00:45:46,740 --> 00:45:53,400
PHP you might want to on one machine up

00:45:49,980 --> 00:45:55,080
the max file size upload file size you

00:45:53,400 --> 00:45:57,720
don't want it that to propagate to all

00:45:55,080 --> 00:46:00,270
the other all the other PHP running

00:45:57,720 --> 00:46:03,770
machines right so every single node has

00:46:00,270 --> 00:46:08,850
a config setting and it basically it's a

00:46:03,770 --> 00:46:11,160
llamo JSON style file there is a

00:46:08,850 --> 00:46:12,900
hierarchy of overrides so essentially

00:46:11,160 --> 00:46:15,510
you have the default settings then you

00:46:12,900 --> 00:46:18,480
might have settings that are set by PHP

00:46:15,510 --> 00:46:19,890
for instance then you might have

00:46:18,480 --> 00:46:22,410
settings that are based on things like

00:46:19,890 --> 00:46:25,290
roles so you say all of my web servers

00:46:22,410 --> 00:46:27,510
have this set but then ultimately you

00:46:25,290 --> 00:46:31,050
have sort of the the top level and you

00:46:27,510 --> 00:46:33,420
can on a particular machine to an

00:46:31,050 --> 00:46:34,860
override so it will be probably as

00:46:33,420 --> 00:46:37,680
simple as on that particular

00:46:34,860 --> 00:46:39,120
machine.config so let's say it it you

00:46:37,680 --> 00:46:40,560
know something where PHP needs to have

00:46:39,120 --> 00:46:42,300
twice as much memory because you got

00:46:40,560 --> 00:46:44,430
something and you know it just needs to

00:46:42,300 --> 00:46:46,770
have that so you'll go into that one

00:46:44,430 --> 00:46:49,440
machine you'll basically build out your

00:46:46,770 --> 00:46:54,230
JSON array you'll have something on the

00:46:49,440 --> 00:46:57,600
order of say PHP member sighs you know

00:46:54,230 --> 00:47:00,570
let's say three gig whatever whatever it

00:46:57,600 --> 00:47:03,350
is and that machine then very next time

00:47:00,570 --> 00:47:07,050
the chef client runs will actually go in

00:47:03,350 --> 00:47:10,380
modify the PHP settings so php.ini in

00:47:07,050 --> 00:47:12,660
most cases change it to three restart

00:47:10,380 --> 00:47:15,150
the services and will so 15 minutes

00:47:12,660 --> 00:47:17,640
later or when however you have whatever

00:47:15,150 --> 00:47:20,010
you've set that chron to it immediately

00:47:17,640 --> 00:47:21,490
will take effect you might then say oh

00:47:20,010 --> 00:47:25,750
yeah that's too much bring it

00:47:21,490 --> 00:47:27,280
22 you could tweak it as often as you

00:47:25,750 --> 00:47:28,600
wanted you could go ahead and say I'm

00:47:27,280 --> 00:47:29,800
going to set one machine this way one

00:47:28,600 --> 00:47:31,330
machine this way one machine this way

00:47:29,800 --> 00:47:33,070
run them for a while and then go look at

00:47:31,330 --> 00:47:37,030
your logs and then say now I want them

00:47:33,070 --> 00:47:38,920
all to be this delete delete all of

00:47:37,030 --> 00:47:41,320
those settings and go drop it into say

00:47:38,920 --> 00:47:43,480
maybe a PHP config and suddenly they all

00:47:41,320 --> 00:47:46,150
get that that's like then if there's a

00:47:43,480 --> 00:47:48,100
hierarchy yeah so then if you install

00:47:46,150 --> 00:47:50,860
the new machine with the HPA will take

00:47:48,100 --> 00:47:55,230
the default setting PHP thing and not

00:47:50,860 --> 00:47:59,650
the specific machine exactly okay thanks

00:47:55,230 --> 00:48:02,550
hi two things first of all them amazon

00:47:59,650 --> 00:48:06,100
web services do you know about opsworks

00:48:02,550 --> 00:48:09,460
yes okay they have a partnership at this

00:48:06,100 --> 00:48:11,410
point and they have actually as the way

00:48:09,460 --> 00:48:13,030
I understand it I don't work for ops

00:48:11,410 --> 00:48:15,550
work so I'm not privy to it but I do

00:48:13,030 --> 00:48:17,140
understand that it looks like the

00:48:15,550 --> 00:48:20,080
partnership they have is going to make

00:48:17,140 --> 00:48:21,850
it easier and easier because it it looks

00:48:20,080 --> 00:48:23,710
like basically amazon has decided that

00:48:21,850 --> 00:48:28,330
in the battle between the various

00:48:23,710 --> 00:48:30,040
competing platforms chef puppet etc

00:48:28,330 --> 00:48:31,570
they've they've decided that Chef is the

00:48:30,040 --> 00:48:34,000
way to go so it's going to get much

00:48:31,570 --> 00:48:37,600
easier to do chef things in it yet

00:48:34,000 --> 00:48:41,740
that's a good example I just was part of

00:48:37,600 --> 00:48:45,240
a webinar I just just watched it that

00:48:41,740 --> 00:48:47,859
went into a knife plug in to work with

00:48:45,240 --> 00:48:49,570
VMware for instance and that's the nice

00:48:47,859 --> 00:48:51,040
thing is there's tons of plugins that

00:48:49,570 --> 00:48:54,430
people are writing for all of these

00:48:51,040 --> 00:48:57,250
different you know virtual platforms etc

00:48:54,430 --> 00:48:59,710
that make we saw what we were doing

00:48:57,250 --> 00:49:01,119
there with a bootstrap for me to go

00:48:59,710 --> 00:49:03,310
ahead and not just bootstrap it but

00:49:01,119 --> 00:49:05,859
actually just say go create a new

00:49:03,310 --> 00:49:09,550
instance of a virtual machine on my

00:49:05,859 --> 00:49:11,440
vmware server would be what again one

00:49:09,550 --> 00:49:13,540
line it's that simple i wouldn't even

00:49:11,440 --> 00:49:16,630
have to log on to the server i could

00:49:13,540 --> 00:49:18,730
actually say go use this OS image go

00:49:16,630 --> 00:49:21,490
drop that into the Machine and then

00:49:18,730 --> 00:49:24,070
bootstrap it'll start from basically no

00:49:21,490 --> 00:49:26,710
machine at all and bring it up yeah

00:49:24,070 --> 00:49:29,080
that's most of my own experiences but

00:49:26,710 --> 00:49:32,230
the but but that's an Amazon you want to

00:49:29,080 --> 00:49:34,340
just bring up servers whenever the load

00:49:32,230 --> 00:49:35,780
is high and everything has to go

00:49:34,340 --> 00:49:38,240
totally automatically I just want to

00:49:35,780 --> 00:49:40,280
hear if you had experiences or could

00:49:38,240 --> 00:49:42,440
recommend it yeah i'm not using amazon i

00:49:40,280 --> 00:49:44,960
basically been using vmware but my

00:49:42,440 --> 00:49:49,240
experiences are pretty similar from from

00:49:44,960 --> 00:49:52,460
what I hear I mean I know aquia is using

00:49:49,240 --> 00:49:55,910
Amazon with good success they had they

00:49:52,460 --> 00:49:58,280
gave a talk at some Portland that I know

00:49:55,910 --> 00:50:00,200
is online that talks about how they do

00:49:58,280 --> 00:50:03,890
it they run quite a big test suite and

00:50:00,200 --> 00:50:05,300
it's all spun up using Amazon Web

00:50:03,890 --> 00:50:06,680
Services and I remember they said that

00:50:05,300 --> 00:50:10,130
they actually have a failure rate that

00:50:06,680 --> 00:50:11,780
if a machine doesn't come up in five to

00:50:10,130 --> 00:50:13,250
ten minutes they basically just assume

00:50:11,780 --> 00:50:15,080
it's never going to come up and just do

00:50:13,250 --> 00:50:17,420
it again I mean there actually is a

00:50:15,080 --> 00:50:20,060
measurable failure rate that things just

00:50:17,420 --> 00:50:21,380
don't work correctly so which is kat's

00:50:20,060 --> 00:50:22,880
why I was joking earlier because it's

00:50:21,380 --> 00:50:26,410
absolutely true everybody of her and

00:50:22,880 --> 00:50:29,300
says Amazon's great when it works

00:50:26,410 --> 00:50:31,850
something totally different but don't

00:50:29,300 --> 00:50:36,170
hack or don't hack contrib modules so

00:50:31,850 --> 00:50:39,500
contra the recipes I tend to find some

00:50:36,170 --> 00:50:42,680
things for instance PHP PHP cookbooks

00:50:39,500 --> 00:50:44,510
all assume that I'm running Apache so

00:50:42,680 --> 00:50:47,630
they have their dependencies do I have

00:50:44,510 --> 00:50:50,330
any way of writing say you don't want to

00:50:47,630 --> 00:50:52,490
use apache you want to use a jennex yes

00:50:50,330 --> 00:50:54,110
and no the problem is is that you're

00:50:52,490 --> 00:50:58,130
right the default cookbooks assume

00:50:54,110 --> 00:51:00,020
Apache because ninety percent 95 person

00:50:58,130 --> 00:51:03,320
whatever the number is of people who are

00:51:00,020 --> 00:51:05,120
running PHP or running Apache I would

00:51:03,320 --> 00:51:07,160
first go look at some of the things like

00:51:05,120 --> 00:51:09,890
engine X recipes and see if somebody's

00:51:07,160 --> 00:51:10,970
already got a PHP thing that really it's

00:51:09,890 --> 00:51:13,760
like you're running engine X for

00:51:10,970 --> 00:51:18,080
instance I will tell you that I actually

00:51:13,760 --> 00:51:21,290
had to build machines that ran PHP 52

00:51:18,080 --> 00:51:23,930
and so what I did was I actually copied

00:51:21,290 --> 00:51:28,190
some of the recipes I in this case said

00:51:23,930 --> 00:51:30,650
all right I cannot generate the image i

00:51:28,190 --> 00:51:32,840
need from any of the existing recipes

00:51:30,650 --> 00:51:37,460
but i can build stuff from source I took

00:51:32,840 --> 00:51:39,080
the PHP 53 source recipe because there

00:51:37,460 --> 00:51:41,930
was a recipe to say build PHP from

00:51:39,080 --> 00:51:43,580
source and install it even though I was

00:51:41,930 --> 00:51:45,290
working with you know debian ubuntu

00:51:43,580 --> 00:51:47,090
servers i mean normally you don't want

00:51:45,290 --> 00:51:49,760
to do that but in this case that was the

00:51:47,090 --> 00:51:54,530
easiest way to do it it would actually

00:51:49,760 --> 00:51:56,450
go download the tarball of 5 to build it

00:51:54,530 --> 00:51:58,490
from scratch all under the controller

00:51:56,450 --> 00:52:01,370
shaft which means every time I spun up a

00:51:58,490 --> 00:52:04,030
server it would go grab a tarball and

00:52:01,370 --> 00:52:05,870
this is a great example of a gotcha I

00:52:04,030 --> 00:52:07,460
started getting these things where I'd

00:52:05,870 --> 00:52:08,840
go to spin up a server and nothing would

00:52:07,460 --> 00:52:10,610
happen and I'd sit there and go what's

00:52:08,840 --> 00:52:12,500
going on what's the error and I check

00:52:10,610 --> 00:52:16,220
into the logs and it had gotten stuck

00:52:12,500 --> 00:52:20,180
and it turns out that the archive I was

00:52:16,220 --> 00:52:21,770
grabbing it from at PHP net was down and

00:52:20,180 --> 00:52:23,330
it wasn't answering and so therefore I

00:52:21,770 --> 00:52:26,780
couldn't go grab this tar ball and the

00:52:23,330 --> 00:52:28,460
script would die my solution for that

00:52:26,780 --> 00:52:30,110
was I grabbed a tarball and stored it

00:52:28,460 --> 00:52:31,910
locally i removed the external

00:52:30,110 --> 00:52:33,950
dependency because i always wanted the

00:52:31,910 --> 00:52:35,690
same star ball but it was really easy to

00:52:33,950 --> 00:52:38,840
just go and grab it from someplace else

00:52:35,690 --> 00:52:40,400
until it wasn't there so it's a good

00:52:38,840 --> 00:52:44,150
example if you really want to test your

00:52:40,400 --> 00:52:47,330
scripts just in general assume the rest

00:52:44,150 --> 00:52:49,340
of the internet is gone make sure your

00:52:47,330 --> 00:52:53,810
stuff still works now Drupal cons a good

00:52:49,340 --> 00:52:55,490
test for that right because the rest of

00:52:53,810 --> 00:53:00,680
the Internet is God is just your pecan

00:52:55,490 --> 00:53:02,960
right now my question is partially link

00:53:00,680 --> 00:53:05,180
to the story which you just told I am

00:53:02,960 --> 00:53:08,000
completely new to Jeff and I would like

00:53:05,180 --> 00:53:10,880
to know if something goes wrong how

00:53:08,000 --> 00:53:16,190
friendly Jeff when reporting that

00:53:10,880 --> 00:53:18,730
something when like in your sample when

00:53:16,190 --> 00:53:21,590
you try to execute in your example like

00:53:18,730 --> 00:53:24,380
recipient my SQL for example something

00:53:21,590 --> 00:53:27,080
went wrong and second question if I

00:53:24,380 --> 00:53:28,670
apply my custom change to my sequel

00:53:27,080 --> 00:53:31,310
initialization file for example

00:53:28,670 --> 00:53:35,480
something that went wrong in custom code

00:53:31,310 --> 00:53:38,540
so in both case chef has got amazing

00:53:35,480 --> 00:53:41,450
logging by default without changing it

00:53:38,540 --> 00:53:43,880
it when you run chef client you can

00:53:41,450 --> 00:53:45,710
actually see all of the interactions you

00:53:43,880 --> 00:53:48,110
get to basically peek behind the scenes

00:53:45,710 --> 00:53:51,860
between the communication that that

00:53:48,110 --> 00:53:54,770
server has that the node that the client

00:53:51,860 --> 00:53:58,040
has with the server so you can see it

00:53:54,770 --> 00:53:59,660
says hello I'm this particular machine

00:53:58,040 --> 00:54:01,370
and the service says hello machine

00:53:59,660 --> 00:54:03,410
unvalidated that yes you are

00:54:01,370 --> 00:54:06,200
the right server yes I have something

00:54:03,410 --> 00:54:09,110
for you you need this dis and this okay

00:54:06,200 --> 00:54:11,960
I don't have that cash can you send that

00:54:09,110 --> 00:54:14,630
to me yes and so you can watch as it

00:54:11,960 --> 00:54:16,520
streams the things and and your client

00:54:14,630 --> 00:54:17,930
basically caches stuff so it's holding

00:54:16,520 --> 00:54:20,300
on to it and the interesting thing is

00:54:17,930 --> 00:54:22,160
the next time it runs if it says I don't

00:54:20,300 --> 00:54:23,360
need that anymore it pushes its cash it

00:54:22,160 --> 00:54:26,450
doesn't just hanging on to everything

00:54:23,360 --> 00:54:29,090
they try to be really efficient but you

00:54:26,450 --> 00:54:31,400
can watch every single step then that

00:54:29,090 --> 00:54:34,280
that client does running through the

00:54:31,400 --> 00:54:35,960
various scripts including everything's

00:54:34,280 --> 00:54:38,480
good here I don't need to do anything

00:54:35,960 --> 00:54:40,220
move on to the next step move on to the

00:54:38,480 --> 00:54:42,050
next step so you can actually just look

00:54:40,220 --> 00:54:45,110
at that log it so in the case of for

00:54:42,050 --> 00:54:48,470
instance that I could basically say oh

00:54:45,110 --> 00:54:50,150
it's trying to go get this file oh why

00:54:48,470 --> 00:54:51,770
isn't it getting that file and then I go

00:54:50,150 --> 00:54:57,740
and I sit there in my local browser and

00:54:51,770 --> 00:54:59,600
I go and I get server down so very good

00:54:57,740 --> 00:55:01,910
debugging abilities because you really

00:54:59,600 --> 00:55:04,850
can track that stuff when it comes to

00:55:01,910 --> 00:55:08,720
custom code that's actually a really

00:55:04,850 --> 00:55:12,320
good point if you make a mistake in JSON

00:55:08,720 --> 00:55:13,910
formatting for instance I tend to sit

00:55:12,320 --> 00:55:15,410
there and edit config files on the fly

00:55:13,910 --> 00:55:17,060
like I'll sit there and just you know I

00:55:15,410 --> 00:55:18,350
sent my editor to nano so I'm just

00:55:17,060 --> 00:55:21,350
sitting there editing in a terminal

00:55:18,350 --> 00:55:25,580
window the problem with that is is if I

00:55:21,350 --> 00:55:29,540
miss a comma and as a result my JSON is

00:55:25,580 --> 00:55:32,120
invalid I lose the entire thing it goes

00:55:29,540 --> 00:55:33,890
to save it because it's actually doing a

00:55:32,120 --> 00:55:35,720
live edit it basically even though I'm

00:55:33,890 --> 00:55:37,790
on my workstation I'm saying go edit

00:55:35,720 --> 00:55:40,310
this config it actually goes to the

00:55:37,790 --> 00:55:43,040
server gets the config grabs it locally

00:55:40,310 --> 00:55:45,080
I'm editing a local file and when I hit

00:55:43,040 --> 00:55:47,830
save it's going to push it back because

00:55:45,080 --> 00:55:52,160
I'm actually changing a config file and

00:55:47,830 --> 00:55:53,450
if I break it it says no no no no you

00:55:52,160 --> 00:55:55,240
can't do that it's a broken file and

00:55:53,450 --> 00:55:59,180
then even going to push it and it just

00:55:55,240 --> 00:56:01,820
loses it so um I was doing a lot of nano

00:55:59,180 --> 00:56:05,390
stuff I started using other external

00:56:01,820 --> 00:56:06,680
editors like textmate too which is

00:56:05,390 --> 00:56:11,110
really good because you can do things

00:56:06,680 --> 00:56:13,280
like check stuff for JSON formatting so

00:56:11,110 --> 00:56:14,789
it's only as good as your other tools

00:56:13,280 --> 00:56:20,039
it's not the only tool

00:56:14,789 --> 00:56:22,829
your toolbox thank you hi thank you for

00:56:20,039 --> 00:56:25,619
the great presentation thank you and I

00:56:22,829 --> 00:56:30,269
wanted to ask about build and deployment

00:56:25,619 --> 00:56:33,809
and how could it be integrated to chef

00:56:30,269 --> 00:56:39,390
you have some recommendations well as I

00:56:33,809 --> 00:56:41,039
said start small and grow it ideally you

00:56:39,390 --> 00:56:42,029
should be able to build a setup where

00:56:41,039 --> 00:56:43,859
you have your development environment

00:56:42,029 --> 00:56:45,630
your staging environment your production

00:56:43,859 --> 00:56:48,419
environment and have them as close as

00:56:45,630 --> 00:56:51,689
possible within you know reasonable

00:56:48,419 --> 00:56:55,489
limitations and it's really not hard

00:56:51,689 --> 00:57:00,869
once you have one built to clone and

00:56:55,489 --> 00:57:03,119
extend so in terms of deployment my

00:57:00,869 --> 00:57:07,589
deployment strategy is basically I've

00:57:03,119 --> 00:57:09,539
got scripts that will go and do whatever

00:57:07,589 --> 00:57:11,489
is needed like for instance for a drupal

00:57:09,539 --> 00:57:13,890
install it goes and it does check out of

00:57:11,489 --> 00:57:17,099
my code and it goes and it grabs a

00:57:13,890 --> 00:57:18,419
database backup most of the time the

00:57:17,099 --> 00:57:20,969
most current but I actually have stuff

00:57:18,419 --> 00:57:22,739
so I can go grab a database backups for

00:57:20,969 --> 00:57:25,169
instance and it basically will reset

00:57:22,739 --> 00:57:28,919
everything so that way when the scripts

00:57:25,169 --> 00:57:31,079
run I can know that my my servers in the

00:57:28,919 --> 00:57:33,479
state I want it to be and if i needed to

00:57:31,079 --> 00:57:35,539
spin up another server for testing

00:57:33,479 --> 00:57:38,159
purposes ideally it's going to be

00:57:35,539 --> 00:57:41,159
exactly where i want it to be okay so

00:57:38,159 --> 00:57:43,289
you want to roll your own recipes back

00:57:41,159 --> 00:57:44,669
by own scripts well you are going to

00:57:43,289 --> 00:57:46,969
need to do that I mean obviously it

00:57:44,669 --> 00:57:50,999
depends on what you're what you're doing

00:57:46,969 --> 00:57:52,650
but again chef is not going to solve all

00:57:50,999 --> 00:57:55,169
of your problems it's just going to give

00:57:52,650 --> 00:57:58,140
you a structure to build better tools

00:57:55,169 --> 00:58:02,779
I've got rollout scripts for instance

00:57:58,140 --> 00:58:05,249
that use water that actually log on to

00:58:02,779 --> 00:58:06,929
servers and click through some buttons

00:58:05,249 --> 00:58:09,539
and my goal is to replace that stuff

00:58:06,929 --> 00:58:12,209
with drush and then my goal is true make

00:58:09,539 --> 00:58:14,309
drush be called by a chef script so the

00:58:12,209 --> 00:58:15,869
goal is get it out of being and it is or

00:58:14,309 --> 00:58:18,140
it is code right now it's a recorded

00:58:15,869 --> 00:58:20,909
script and it's actually a ruby script

00:58:18,140 --> 00:58:22,459
but it's doing it through a browser and

00:58:20,909 --> 00:58:25,859
as a result I've got a lot of

00:58:22,459 --> 00:58:27,569
inconsistencies because browsers you

00:58:25,859 --> 00:58:28,850
know what version of Firefox you're

00:58:27,569 --> 00:58:32,840
running today

00:58:28,850 --> 00:58:35,460
so the goal is make it less brittle

00:58:32,840 --> 00:58:37,290
bring it into in this case i want it i

00:58:35,460 --> 00:58:39,900
want to be doing more with drush because

00:58:37,290 --> 00:58:42,150
i want to make sure that rush is well

00:58:39,900 --> 00:58:44,100
aware of you know i can send it to

00:58:42,150 --> 00:58:46,830
commands like go get me yesterday's back

00:58:44,100 --> 00:58:48,690
up and put that onto a machine so i'm

00:58:46,830 --> 00:58:51,570
going to have some drush scripts but

00:58:48,690 --> 00:58:54,660
then chef well it might just be run

00:58:51,570 --> 00:58:56,370
distress command so it doesn't mean that

00:58:54,660 --> 00:59:01,430
Chef is necessarily doing anything fancy

00:58:56,370 --> 00:59:01,430
it's just running a custom script Thanks

00:59:02,570 --> 00:59:07,440
how concerned do I need to be with the

00:59:05,510 --> 00:59:09,870
operating system that I'm going to apply

00:59:07,440 --> 00:59:12,150
the changes to so if I've got say one

00:59:09,870 --> 00:59:15,780
serve everyone in debian and of a server

00:59:12,150 --> 00:59:19,260
running fedora you don't actually need

00:59:15,780 --> 00:59:21,300
to be that consistent you will find lots

00:59:19,260 --> 00:59:22,740
of recipes that work fine than anything

00:59:21,300 --> 00:59:24,840
you so for instance let's take the

00:59:22,740 --> 00:59:28,260
apache recipe you might have an Apache

00:59:24,840 --> 00:59:29,790
recipe that runs on fedora and debian

00:59:28,260 --> 00:59:32,820
now those are completely different

00:59:29,790 --> 00:59:34,710
packaging systems if you spin up two

00:59:32,820 --> 00:59:38,100
servers one of which is debian and 10

00:59:34,710 --> 00:59:41,190
witches is fedora nothing about them is

00:59:38,100 --> 00:59:43,860
the same but chef says I've been told to

00:59:41,190 --> 00:59:47,100
put Apache on and it knows how to use

00:59:43,860 --> 00:59:49,620
apt and it knows how to use young and it

00:59:47,100 --> 00:59:51,150
actually can because the recipe is smart

00:59:49,620 --> 00:59:53,820
enough to have pieces to deal with both

00:59:51,150 --> 00:59:55,980
of them will go and get what you've told

00:59:53,820 --> 00:59:58,680
it to so for instance if you tell it go

00:59:55,980 --> 01:00:00,270
get this version of apache and it's

00:59:58,680 --> 01:00:02,190
available for both of them let's just

01:00:00,270 --> 01:00:03,780
assume that it will go and it will

01:00:02,190 --> 01:00:05,250
install the software it's coming

01:00:03,780 --> 01:00:06,750
completely from different sources but

01:00:05,250 --> 01:00:08,340
you may not care about that you might

01:00:06,750 --> 01:00:10,320
actually need to have for support

01:00:08,340 --> 01:00:11,790
purposes let's say two completely

01:00:10,320 --> 01:00:14,340
different machines that are running the

01:00:11,790 --> 01:00:18,150
same version of apache it can build both

01:00:14,340 --> 01:00:20,040
of them with one recipe so in the actual

01:00:18,150 --> 01:00:21,480
recipe would you specify what the

01:00:20,040 --> 01:00:24,420
package name is so office leon

01:00:21,480 --> 01:00:26,970
photography httpd an ubuntu part you too

01:00:24,420 --> 01:00:28,920
yes in fact that's one of the things you

01:00:26,970 --> 01:00:31,560
can build into your recipes is platform

01:00:28,920 --> 01:00:34,290
dependent code you can say in the case

01:00:31,560 --> 01:00:37,320
of the node is this platform go do this

01:00:34,290 --> 01:00:39,330
in the case of its that platform go do

01:00:37,320 --> 01:00:40,349
that sometimes there are commands that

01:00:39,330 --> 01:00:41,839
are agnostic so

01:00:40,349 --> 01:00:45,630
since there's the package command

01:00:41,839 --> 01:00:47,910
package install apache2 that might be

01:00:45,630 --> 01:00:51,150
the only thing that chef needs to know

01:00:47,910 --> 01:00:54,989
to install apache2 for instance but it

01:00:51,150 --> 01:00:56,940
then knows the package command which is

01:00:54,989 --> 01:00:58,799
itself basically telling it how to do

01:00:56,940 --> 01:01:01,529
something it's a resource its go install

01:00:58,799 --> 01:01:04,349
something it then goes and it goes to

01:01:01,529 --> 01:01:05,759
the underlying code and it knows oh I've

01:01:04,349 --> 01:01:07,499
been told to install it but I'm on a

01:01:05,759 --> 01:01:09,720
young system or an app system or

01:01:07,499 --> 01:01:14,359
whatever and handles it appropriately

01:01:09,720 --> 01:01:17,460
okay thank you or let's say it's a

01:01:14,359 --> 01:01:21,989
windows box you might have a script that

01:01:17,460 --> 01:01:25,710
goes ahead and says go grab go grab a

01:01:21,989 --> 01:01:27,660
windows installer if that's in the

01:01:25,710 --> 01:01:30,029
recipe you could have a thing that

01:01:27,660 --> 01:01:32,579
installed Apache onto a windows box and

01:01:30,029 --> 01:01:34,140
it might be the same exact recipe that

01:01:32,579 --> 01:01:37,440
somebody had just built to make sure it

01:01:34,140 --> 01:01:38,940
worked on every platform all right it

01:01:37,440 --> 01:01:41,039
looks like a lot of questions so I want

01:01:38,940 --> 01:01:44,700
to give some thanks I want to thank bio

01:01:41,039 --> 01:01:47,190
raft a great company work for giving me

01:01:44,700 --> 01:01:49,829
the opportunity to be here today work

01:01:47,190 --> 01:01:53,009
for wonderful people including Nathan

01:01:49,829 --> 01:01:55,049
CEO and ban the CTO and I want to give a

01:01:53,009 --> 01:01:56,400
shout out to Michelle our whose project

01:01:55,049 --> 01:01:59,009
manager who helped me put this

01:01:56,400 --> 01:02:00,749
presentation together and everybody else

01:01:59,009 --> 01:02:04,999
did buy our raft it's a great team to

01:02:00,749 --> 01:02:07,380
work with Jim Henson rest in peace for

01:02:04,999 --> 01:02:10,469
doing the Swedish Chef all of the

01:02:07,380 --> 01:02:12,450
Opscode people drupal developers

01:02:10,469 --> 01:02:15,119
everywhere you know we all stand on the

01:02:12,450 --> 01:02:19,619
shoulders of giants some like trees

01:02:15,119 --> 01:02:22,289
really are giants for more information

01:02:19,619 --> 01:02:24,630
opscode calm that should be your first

01:02:22,289 --> 01:02:26,670
stop there's so much stuff there I mean

01:02:24,630 --> 01:02:28,680
you could spend hours and hours and they

01:02:26,670 --> 01:02:31,589
do have links to all kinds of video

01:02:28,680 --> 01:02:33,479
presentations they do a conference which

01:02:31,589 --> 01:02:36,450
is a lot like drupalcon so there's tons

01:02:33,479 --> 01:02:38,880
of videos that you can go watch tools i

01:02:36,450 --> 01:02:42,210
think you should check out to continue

01:02:38,880 --> 01:02:44,339
to build on vagrant absolutely awesome

01:02:42,210 --> 01:02:46,890
you should have vagrant running on your

01:02:44,339 --> 01:02:48,839
local machine so you can run virtual

01:02:46,890 --> 01:02:50,549
machines Burke shelf which as I

01:02:48,839 --> 01:02:54,090
mentioned is a great way to even speed

01:02:50,549 --> 01:02:57,390
up developing with Chef and finally be

01:02:54,090 --> 01:02:59,310
hat there's a bunch of B hat sessions

01:02:57,390 --> 01:03:01,160
there was one that happened just before

01:02:59,310 --> 01:03:04,020
hopefully a bunch of who were in there

01:03:01,160 --> 01:03:05,400
I'm a huge proponent of B hat I'd love

01:03:04,020 --> 01:03:09,090
to see the community really get behind

01:03:05,400 --> 01:03:11,490
it I did start groups about drupal.org /

01:03:09,090 --> 01:03:13,500
b hat and I'd love to see everybody

01:03:11,490 --> 01:03:15,720
participate in that I think that is

01:03:13,500 --> 01:03:17,790
going to revolutionize how we think

01:03:15,720 --> 01:03:19,320
about the reliability of Drupal which is

01:03:17,790 --> 01:03:21,480
the reason I use chef to begin with

01:03:19,320 --> 01:03:25,740
that's why I see it's related so thank

01:03:21,480 --> 01:03:29,280
you all and please go fill out the

01:03:25,740 --> 01:03:30,720
survey because I'd love to come back to

01:03:29,280 --> 01:03:34,760
another drupalcon and give another talk

01:03:30,720 --> 01:03:34,760
this was great thank you

01:04:00,300 --> 01:04:11,730
I have we got internet let's say the

01:04:06,360 --> 01:04:15,290
internet is up the internet is up one

01:04:11,730 --> 01:04:15,290

YouTube URL: https://www.youtube.com/watch?v=K94WAiISJds


