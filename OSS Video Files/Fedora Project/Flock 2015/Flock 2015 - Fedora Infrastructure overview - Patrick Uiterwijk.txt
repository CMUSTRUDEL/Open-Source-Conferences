Title: Flock 2015 - Fedora Infrastructure overview - Patrick Uiterwijk
Publication date: 2015-08-26
Playlist: Flock 2015
Description: 
	In this talk, I will give an overview of the current Fedora infrastructure, which spans datacenters in several geographical regions and tries to solve some interesting problems and how we manage this bunch of machines that build and distribute Fedora.
Captions: 
	00:00:08,929 --> 00:00:16,580
hi first of all a warning this talk was

00:00:14,099 --> 00:00:20,640
mostly intended for people who are

00:00:16,580 --> 00:00:22,859
planning on collaborating to for

00:00:20,640 --> 00:00:27,300
infrastructure and gives a very high

00:00:22,859 --> 00:00:30,060
overview of what how we run things so if

00:00:27,300 --> 00:00:31,800
you're not interested in that I would

00:00:30,060 --> 00:00:39,960
suggest you to go to one of the other

00:00:31,800 --> 00:00:48,360
interesting talks just a warning I'm

00:00:39,960 --> 00:00:53,340
just warning well if you have service

00:00:48,360 --> 00:00:57,120
and data center why not okay so first of

00:00:53,340 --> 00:01:00,180
all what do we do there's sometimes a

00:00:57,120 --> 00:01:04,500
lot of confusing and confusion about

00:01:00,180 --> 00:01:08,850
what we do and what we do not do what we

00:01:04,500 --> 00:01:14,369
do is we host a lot of services like the

00:01:08,850 --> 00:01:16,920
floor websites the wiki the mailing

00:01:14,369 --> 00:01:21,360
lists the tools you use to actually

00:01:16,920 --> 00:01:25,470
build and contribute to fedora like Koji

00:01:21,360 --> 00:01:29,689
the package maintainer ship stuff we

00:01:25,470 --> 00:01:33,360
also use a lot of services internally

00:01:29,689 --> 00:01:36,840
that message for example of which the

00:01:33,360 --> 00:01:42,000
author is sitting right there they're

00:01:36,840 --> 00:01:47,430
rough which we use for managing internal

00:01:42,000 --> 00:01:50,700
stuff and taking stuff up we use a flirt

00:01:47,430 --> 00:01:57,360
we run a floor infrastructure cloud for

00:01:50,700 --> 00:02:01,380
a lot of testing stuff and utter inter

00:01:57,360 --> 00:02:04,320
other stuff to help the community we run

00:02:01,380 --> 00:02:07,079
some cumin some web services which are

00:02:04,320 --> 00:02:10,340
not Fedora specific some of you might

00:02:07,079 --> 00:02:12,810
know them back here or Fedora hosted

00:02:10,340 --> 00:02:13,660
which we run for the rest of the flora

00:02:12,810 --> 00:02:16,960
community

00:02:13,660 --> 00:02:19,540
but most importantly we do not run your

00:02:16,960 --> 00:02:21,970
own home machines you will be surprised

00:02:19,540 --> 00:02:24,760
how often we get people in flora admin

00:02:21,970 --> 00:02:27,940
asking hey help you with food or a

00:02:24,760 --> 00:02:31,200
server we had i've just installed it we

00:02:27,940 --> 00:02:33,580
are not there to help you for that Oh

00:02:31,200 --> 00:02:50,710
actually a pegar author also just

00:02:33,580 --> 00:02:53,890
arrived oh yeah yeah but your juice yeah

00:02:50,710 --> 00:03:00,190
a lot of people he's French and you

00:02:53,890 --> 00:03:02,890
thought it up also if you have any

00:03:00,190 --> 00:03:06,040
questions during the talk just let me

00:03:02,890 --> 00:03:07,930
know because as i said i'll be at a

00:03:06,040 --> 00:03:13,050
pretty high level if you have more

00:03:07,930 --> 00:03:15,970
in-depth questions just let me know so

00:03:13,050 --> 00:03:18,820
the places we host stuff we have two

00:03:15,970 --> 00:03:22,600
data centers hosted by red hat in

00:03:18,820 --> 00:03:25,150
phoenix and in rally where most of the

00:03:22,600 --> 00:03:29,260
stuff is located rally is mostly a

00:03:25,150 --> 00:03:31,420
download and backup site for us so when

00:03:29,260 --> 00:03:37,090
you download fedora from the mus mirrors

00:03:31,420 --> 00:03:39,370
you might end up there pretty much over

00:03:37,090 --> 00:03:44,110
services further are hosted in phoenix

00:03:39,370 --> 00:03:48,959
and we have a bunch of donated machines

00:03:44,110 --> 00:03:52,720
as i said to you hosted by companies

00:03:48,959 --> 00:03:56,470
which just have provided us with one or

00:03:52,720 --> 00:03:59,560
two machines where we host part of the

00:03:56,470 --> 00:04:03,000
infrastructure used to get stuff close

00:03:59,560 --> 00:04:03,000
to you just

00:04:03,380 --> 00:04:10,730
just impulsive grab slides sorry come

00:04:06,770 --> 00:04:16,010
sweet taken the college this laptop try

00:04:10,730 --> 00:04:17,780
supposed to get the cyclopean you

00:04:16,010 --> 00:04:22,640
suggesting the end right there when

00:04:17,780 --> 00:04:30,200
you're fine yeah right I will have to

00:04:22,640 --> 00:04:33,080
walk here ok yeah no it's using cheese

00:04:30,200 --> 00:04:37,300
so I don't think so and apparently when

00:04:33,080 --> 00:04:37,300
I stand here it can't even see my place

00:04:38,350 --> 00:04:44,950
let's see if that works anyway

00:04:48,710 --> 00:04:51,940
so just

00:04:54,729 --> 00:05:03,639
this actually work it does work actually

00:04:58,479 --> 00:05:08,409
oh cool thank you yeah we figured that

00:05:03,639 --> 00:05:09,939
it would actually work so we have a lot

00:05:08,409 --> 00:05:18,400
of data centers all around the world

00:05:09,939 --> 00:05:21,219
where we host most of the sorry where we

00:05:18,400 --> 00:05:26,189
host most of the reverse proxies to

00:05:21,219 --> 00:05:28,569
which I will come in a bit we also have

00:05:26,189 --> 00:05:30,759
so most of these machines are just

00:05:28,569 --> 00:05:34,169
normal machines that are hosting our

00:05:30,759 --> 00:05:37,210
stuff we also have in Phoenix a

00:05:34,169 --> 00:05:40,360
infrastructure flower which is based on

00:05:37,210 --> 00:05:42,789
OpenStack we have actually two of them

00:05:40,360 --> 00:05:47,770
we set up one I don't know how many

00:05:42,789 --> 00:05:52,029
years ago in 23 years ago with OpenStack

00:05:47,770 --> 00:05:54,669
very long ago folsom whenever we ask for

00:05:52,029 --> 00:05:56,889
support we always get to talk like not

00:05:54,669 --> 00:06:01,959
don't use it everyone given everyone's

00:05:56,889 --> 00:06:06,219
giving up on it but we actually set up a

00:06:01,959 --> 00:06:09,279
new instance a few months ago with

00:06:06,219 --> 00:06:10,719
thread and OpenStack platform now so

00:06:09,279 --> 00:06:15,310
actually we're not running a supported

00:06:10,719 --> 00:06:21,189
release which might match which would

00:06:15,310 --> 00:06:24,819
actually help us this setup is used for

00:06:21,189 --> 00:06:27,629
as I said a lot of internal testing and

00:06:24,819 --> 00:06:33,659
development instances by developers

00:06:27,629 --> 00:06:33,659
we're also hosting instances for boba

00:06:33,710 --> 00:06:41,200
and we're hosting jenkins instances here

00:06:36,380 --> 00:06:44,270
and copper Antinous which is a very

00:06:41,200 --> 00:06:46,880
interesting combination to which I'll

00:06:44,270 --> 00:06:51,890
come in a bit because it has given us a

00:06:46,880 --> 00:06:55,850
lot of pain copper is very nice furtive

00:06:51,890 --> 00:07:00,920
up for the users for maintainer it's a

00:06:55,850 --> 00:07:04,400
bit annoying at times sorry yeah which

00:07:00,920 --> 00:07:16,580
is exactly caused by what caused us to

00:07:04,400 --> 00:07:18,330
pain right in the same exact source

00:07:16,580 --> 00:07:24,100
article

00:07:18,330 --> 00:07:25,810
right but most of the time it works it's

00:07:24,100 --> 00:07:28,450
not very building kernels or something

00:07:25,810 --> 00:07:30,820
like that it's not very repeatable and

00:07:28,450 --> 00:07:45,250
it has some bugs but most of time it

00:07:30,820 --> 00:07:50,280
works all the time sorry that's a very

00:07:45,250 --> 00:07:50,280
good one item maybe bhopal how about it

00:07:54,990 --> 00:08:17,350
sorry all about metrics I see more than

00:08:01,810 --> 00:08:23,970
forty percent to time yeah perhaps okay

00:08:17,350 --> 00:08:29,320
um so this is what we're hosting but

00:08:23,970 --> 00:08:33,909
this doesn't come automatically as I

00:08:29,320 --> 00:08:37,120
said oh this ms some parts let's try it

00:08:33,909 --> 00:08:43,770
let's try it anyway um our main data

00:08:37,120 --> 00:08:46,930
center is in Phoenix Arizona we have 22

00:08:43,770 --> 00:08:51,010
virtual hosts there we have the master

00:08:46,930 --> 00:08:54,070
mirrors for download dr. project or are

00:08:51,010 --> 00:08:59,170
located there actually no that's dl

00:08:54,070 --> 00:09:03,790
download is for tomatoes we also have to

00:08:59,170 --> 00:09:06,040
build hosts here for Koji and a lot of

00:09:03,790 --> 00:09:11,030
other related stuff used by the

00:09:06,040 --> 00:09:14,750
infrastructure team daughter

00:09:11,030 --> 00:09:18,620
side we have as main datacenters rally

00:09:14,750 --> 00:09:23,370
where we host the backups off-site and

00:09:18,620 --> 00:09:25,440
we have the other download mirrors there

00:09:23,370 --> 00:09:29,250
and that's where we had internet two

00:09:25,440 --> 00:09:33,180
mirrors with we actually shut down a few

00:09:29,250 --> 00:09:37,080
months ago because we weren't getting

00:09:33,180 --> 00:09:41,000
enough bandwidth sorry it's kind of

00:09:37,080 --> 00:09:47,310
backwards yeah but the link we had was

00:09:41,000 --> 00:09:50,040
not very high quality so we also have

00:09:47,310 --> 00:09:52,950
some remote data centers where we get

00:09:50,040 --> 00:09:55,350
donated machines from other companies we

00:09:52,950 --> 00:09:58,740
use them as hyper deserves as

00:09:55,350 --> 00:10:03,680
hypervisors on which we run proxies

00:09:58,740 --> 00:10:07,470
reverse proxies we host mitter lists and

00:10:03,680 --> 00:10:11,790
we are dns servers so that day they are

00:10:07,470 --> 00:10:14,070
local to when you want them because our

00:10:11,790 --> 00:10:17,370
DNS actually has a split horizon based

00:10:14,070 --> 00:10:20,820
on your approximate region where you're

00:10:17,370 --> 00:10:22,950
coming from so that when you're from

00:10:20,820 --> 00:10:29,250
Europe you're most likely to get a

00:10:22,950 --> 00:10:31,770
European proxy sent to you also at some

00:10:29,250 --> 00:10:35,880
service at some data centers where we

00:10:31,770 --> 00:10:38,370
actually got more servers OSU SL and

00:10:35,880 --> 00:10:41,220
dedicated solutions are two that come to

00:10:38,370 --> 00:10:44,550
mind we run other services like through

00:10:41,220 --> 00:10:47,160
our people through roasted and stuff and

00:10:44,550 --> 00:10:49,860
some that we cannot run in Phoenix to

00:10:47,160 --> 00:10:55,110
like torrent servers because reddit will

00:10:49,860 --> 00:10:58,460
not allow us to then they will not allow

00:10:55,110 --> 00:11:01,650
us to open those ports makes sense but

00:10:58,460 --> 00:11:04,770
so these are all listed in remote data

00:11:01,650 --> 00:11:08,900
centers are machines donated by other

00:11:04,770 --> 00:11:08,900
companies for which we are very thankful

00:11:10,190 --> 00:11:23,700
tracing Anita happens right yeah I beg

00:11:20,040 --> 00:11:31,710
your I think also that's all at else do

00:11:23,700 --> 00:11:33,090
it without saying um so in our deserves

00:11:31,710 --> 00:11:38,180
if you're running for example to

00:11:33,090 --> 00:11:38,180
websites our websites are actually not

00:11:39,500 --> 00:11:47,880
websites maintainer Robert Mayer if you

00:11:46,320 --> 00:11:50,550
have if you want to help build the

00:11:47,880 --> 00:11:52,980
websites ask him he can help you point

00:11:50,550 --> 00:11:54,780
in the right direction they're not

00:11:52,980 --> 00:11:58,640
dynamic they're actually built

00:11:54,780 --> 00:12:02,640
statically every 30 or something minutes

00:11:58,640 --> 00:12:05,010
how early I just heard and then synced

00:12:02,640 --> 00:12:07,620
out from the build server to other

00:12:05,010 --> 00:12:11,030
reverse proxies so that the proxies

00:12:07,620 --> 00:12:14,640
themselves can answer the main web sites

00:12:11,030 --> 00:12:16,590
so that they dope traffic that doesn't

00:12:14,640 --> 00:12:23,310
have to go all the way back to the main

00:12:16,590 --> 00:12:26,730
data center in Phoenix this also helps

00:12:23,310 --> 00:12:29,910
because as I said before you often get a

00:12:26,730 --> 00:12:32,870
mirror or a proxy that's close to your

00:12:29,910 --> 00:12:35,460
location which means that your actual

00:12:32,870 --> 00:12:39,870
when you request the website it will

00:12:35,460 --> 00:12:41,970
come from pretty near you instead of all

00:12:39,870 --> 00:12:45,870
the way across the Atlantic sometimes

00:12:41,970 --> 00:12:48,480
although we don't have any data centers

00:12:45,870 --> 00:12:53,970
in the Asian region if you know any

00:12:48,480 --> 00:12:56,850
please let us know so another service we

00:12:53,970 --> 00:13:02,130
run in all of our data centers is the

00:12:56,850 --> 00:13:05,000
middle link services that's used by a

00:13:02,130 --> 00:13:09,450
young to actually get your closet mirror

00:13:05,000 --> 00:13:12,420
so dad the made a link actually gets a

00:13:09,450 --> 00:13:15,540
list or determines your approximate

00:13:12,420 --> 00:13:17,510
position based on IP address finds the

00:13:15,540 --> 00:13:21,300
correct or finds the clothes

00:13:17,510 --> 00:13:24,209
up-to-date mirrors in his database and

00:13:21,300 --> 00:13:27,810
sends you the list of that including the

00:13:24,209 --> 00:13:34,110
correct Jackson's for the young data

00:13:27,810 --> 00:13:38,279
files the crawling it happened centrally

00:13:34,110 --> 00:13:43,589
in Phoenix too but then every hour or

00:13:38,279 --> 00:13:47,279
something we sink renew centralized for

00:13:43,589 --> 00:13:53,790
a database file which we sink out to all

00:13:47,279 --> 00:13:55,950
of the remote sites so that you can

00:13:53,790 --> 00:14:02,190
actually get that faster and is more

00:13:55,950 --> 00:14:04,320
distributed over the world okay so one

00:14:02,190 --> 00:14:07,410
of the most interesting parts of our

00:14:04,320 --> 00:14:11,550
setup is how we use or how we host or

00:14:07,410 --> 00:14:14,089
web applications and I've been thinking

00:14:11,550 --> 00:14:19,800
very hard of how to illustrate this

00:14:14,089 --> 00:14:22,860
let's try it so our web applications are

00:14:19,800 --> 00:14:26,100
actually hosted in Phoenix to in our

00:14:22,860 --> 00:14:27,899
main data center but they are being

00:14:26,100 --> 00:14:30,930
served to you through our reverse

00:14:27,899 --> 00:14:37,470
proxies which are in the semi data

00:14:30,930 --> 00:14:42,420
centers or Phoenix too so when you these

00:14:37,470 --> 00:14:44,010
colors are very hard to see it as soon

00:14:42,420 --> 00:14:48,510
as you request one of our web

00:14:44,010 --> 00:14:49,920
applications it will actually your

00:14:48,510 --> 00:14:52,800
computer will send a request to the

00:14:49,920 --> 00:14:56,820
proxy server which will then terminate

00:14:52,800 --> 00:14:59,490
TLS connection so that's where your TLS

00:14:56,820 --> 00:15:03,510
connection and and after that it all

00:14:59,490 --> 00:15:06,000
goes through a private VPN we run but

00:15:03,510 --> 00:15:09,450
internally the traffic laws of is HTTP

00:15:06,000 --> 00:15:13,200
so that the end product the back and

00:15:09,450 --> 00:15:18,200
service don't actually need to spend

00:15:13,200 --> 00:15:18,200
time on processing hcps requests

00:15:19,199 --> 00:15:27,910
also other proxies run a local load

00:15:23,739 --> 00:15:33,420
balancer demon so that every request

00:15:27,910 --> 00:15:33,420
yourself get sent to either one of the

00:15:33,449 --> 00:15:39,309
application servers for the application

00:15:35,589 --> 00:15:41,589
requested so we have two servers for for

00:15:39,309 --> 00:15:47,619
example negotiate is that how you

00:15:41,589 --> 00:15:49,149
pronounce it sorry okay you should you

00:15:47,619 --> 00:15:52,420
need to tell me how to pronounce it

00:15:49,149 --> 00:15:55,389
sometime but so we have two servers for

00:15:52,420 --> 00:15:59,739
new LGA we have two servers for package

00:15:55,389 --> 00:16:02,889
database there are all individual

00:15:59,739 --> 00:16:05,040
virtual machines an advantage of using

00:16:02,889 --> 00:16:07,360
data is that we can update one of them

00:16:05,040 --> 00:16:10,449
while the service itself stays up

00:16:07,360 --> 00:16:13,509
because the load balancers will all hit

00:16:10,449 --> 00:16:18,939
the other proxy that has not gone

00:16:13,509 --> 00:16:21,249
offline the only part that in hair that

00:16:18,939 --> 00:16:23,799
is trickiness our database instances

00:16:21,249 --> 00:16:28,269
because we have just a single database

00:16:23,799 --> 00:16:31,149
back-end so if there's a big schema

00:16:28,269 --> 00:16:33,519
update the service might still need to

00:16:31,149 --> 00:16:36,220
go down but otherwise packaged up they

00:16:33,519 --> 00:16:41,559
should be should be able to happen

00:16:36,220 --> 00:16:44,410
without any users noticing it out of the

00:16:41,559 --> 00:16:48,970
brats so all of the proxies are actually

00:16:44,410 --> 00:16:52,709
running a local furnish cash as well so

00:16:48,970 --> 00:16:57,040
dad static files for applications or

00:16:52,709 --> 00:16:59,259
wiki pages are actually cashed at the

00:16:57,040 --> 00:17:02,079
proxy so that they don't need to be

00:16:59,259 --> 00:17:05,309
shipped all around the world if they

00:17:02,079 --> 00:17:08,620
don't change that often we don't cash

00:17:05,309 --> 00:17:12,159
dynamic pages when you're logged in so

00:17:08,620 --> 00:17:14,829
for example back still bears and moon

00:17:12,159 --> 00:17:17,559
chae when you're locked in it's no

00:17:14,829 --> 00:17:19,839
longer being cached but if you're locked

00:17:17,559 --> 00:17:22,720
out since your page will look the same

00:17:19,839 --> 00:17:24,040
for everyone else it will get cached on

00:17:22,720 --> 00:17:27,010
the proxy

00:17:24,040 --> 00:17:32,800
you do not have caches on application

00:17:27,010 --> 00:17:34,510
servers only on the proxies so after it

00:17:32,800 --> 00:17:37,840
passes through farm and through the

00:17:34,510 --> 00:17:39,610
local cache it will pass through a cheap

00:17:37,840 --> 00:17:43,690
proxy which is the load balancing

00:17:39,610 --> 00:17:46,650
service we use after that we'll get sent

00:17:43,690 --> 00:17:51,130
back on to the back end in Phoenix to

00:17:46,650 --> 00:17:57,120
maybe all across the world from Europe

00:17:51,130 --> 00:17:57,120
to the US and back and then back to you

00:17:57,570 --> 00:18:02,880
so are there any

00:18:04,010 --> 00:18:13,350
where is the transit from the local

00:18:06,920 --> 00:18:16,799
cache or proxy to we're on that diagram

00:18:13,350 --> 00:18:19,650
sorry which part suppose that the proxy

00:18:16,799 --> 00:18:22,200
in Europe where is the we're in that

00:18:19,650 --> 00:18:26,260
diagram there

00:18:22,200 --> 00:18:30,760
right so your request comes in at the

00:18:26,260 --> 00:18:34,570
proxy Apache in Europe the proxy warrant

00:18:30,760 --> 00:18:38,950
varnish proxy around Asia proxy and this

00:18:34,570 --> 00:18:41,730
line is transatlantic area so the line

00:18:38,950 --> 00:18:45,940
from the a proxy to the backend server

00:18:41,730 --> 00:18:50,290
in this case the green line which might

00:18:45,940 --> 00:18:56,860
not be very disco so that is not sorry

00:18:50,290 --> 00:18:59,650
line is not the scale no well yeah it

00:18:56,860 --> 00:19:04,720
might even be I don't know a lot but

00:18:59,650 --> 00:19:08,320
yeah any other questions about our

00:19:04,720 --> 00:19:11,310
reverse proxy setup because this is what

00:19:08,320 --> 00:19:14,530
is quite difficult for a lot of people

00:19:11,310 --> 00:19:17,620
because it also makes developing the

00:19:14,530 --> 00:19:19,720
applications more difficult because they

00:19:17,620 --> 00:19:25,540
actually need to support load balance

00:19:19,720 --> 00:19:28,720
setups like you can store anything in a

00:19:25,540 --> 00:19:31,060
local disk without using some sort of

00:19:28,720 --> 00:19:34,270
synchronization for which we often use

00:19:31,060 --> 00:19:38,370
cluster if needed and otherwise we try

00:19:34,270 --> 00:19:38,370
to stay to put everything in a database

00:19:42,940 --> 00:19:45,940
cool

00:19:48,360 --> 00:19:53,350
this infrastructure is there a

00:19:51,040 --> 00:19:54,790
documentation that through it and says

00:19:53,350 --> 00:19:57,520
you have to do this equalness

00:19:54,790 --> 00:20:04,960
Aeronautics plans yes as we go and try

00:19:57,520 --> 00:20:06,670
and ask you know we have a so you mean

00:20:04,960 --> 00:20:08,370
why do you will need to do to get

00:20:06,670 --> 00:20:12,040
something in our infrastructure right

00:20:08,370 --> 00:20:16,210
don't forget it firstly coded so it will

00:20:12,040 --> 00:20:19,300
equal value right I don't think we have

00:20:16,210 --> 00:20:23,500
any documentation forgot but as long as

00:20:19,300 --> 00:20:28,330
you don't use the local file system you

00:20:23,500 --> 00:20:31,870
should be pretty much fun no file

00:20:28,330 --> 00:20:34,720
uploads inside the web which is right x

00:20:31,870 --> 00:20:37,750
and if you do need that which for

00:20:34,720 --> 00:20:41,710
example ask but a staffer protected or

00:20:37,750 --> 00:20:45,640
dust we have the two nodes share a

00:20:41,710 --> 00:20:48,330
cluster incident that sink rises the

00:20:45,640 --> 00:20:48,330
file systems

00:20:55,160 --> 00:20:57,160
Oh

00:21:03,149 --> 00:21:09,919
sorry I'm going to go lie right

00:21:16,340 --> 00:21:30,000
so we use so we use openshift online for

00:21:27,320 --> 00:21:32,190
just status that through a project or

00:21:30,000 --> 00:21:34,890
since that needs to be stored outside of

00:21:32,190 --> 00:21:39,510
our infrastructure I mean otherwise we

00:21:34,890 --> 00:21:41,429
can't tell you what's wrong but the rest

00:21:39,510 --> 00:21:44,510
is all inside of our infrastructure and

00:21:41,429 --> 00:21:44,510
hosted by us

00:21:50,710 --> 00:22:03,029
yeah any other questions here I thought

00:22:00,490 --> 00:22:03,029
you had something

00:22:06,290 --> 00:22:11,640
so one of our services that are used

00:22:09,900 --> 00:22:14,510
across the board for every other

00:22:11,640 --> 00:22:20,160
application is our identity service

00:22:14,510 --> 00:22:23,130
which is as a set is used by every one

00:22:20,160 --> 00:22:27,799
of our applications they Jews

00:22:23,130 --> 00:22:30,450
authentication densiflora account system

00:22:27,799 --> 00:22:32,370
the applications themselves use open

00:22:30,450 --> 00:22:34,500
ready to connect to the identity server

00:22:32,370 --> 00:22:37,020
if you want to hear more I would suggest

00:22:34,500 --> 00:22:41,250
you to visit Rupp crittenden stock

00:22:37,020 --> 00:22:42,929
tomorrow in this room because this time

00:22:41,250 --> 00:22:46,340
he is the one talking about her pretty

00:22:42,929 --> 00:22:49,110
and federated identity but basically

00:22:46,340 --> 00:22:52,169
it's a central server where everyone

00:22:49,110 --> 00:22:56,070
logs into you will probably have seen it

00:22:52,169 --> 00:22:57,690
it's the login screen food pretty much

00:22:56,070 --> 00:23:11,370
every web application we have at this

00:22:57,690 --> 00:23:18,510
point yes although for wiki and body dos

00:23:11,370 --> 00:23:20,400
are coming up are you can but you will

00:23:18,510 --> 00:23:25,799
need to do some things locally to get it

00:23:20,400 --> 00:23:27,360
to accept it insecure things which i

00:23:25,799 --> 00:23:33,840
would suggest you not to do so I will

00:23:27,360 --> 00:23:35,380
not tell you how to do it does anybody

00:23:33,840 --> 00:23:40,600
talk to the head

00:23:35,380 --> 00:23:42,730
Oh allowing open ID law against to their

00:23:40,600 --> 00:23:45,100
Moselle so we can stop having a separate

00:23:42,730 --> 00:23:49,180
accounts yes we have a ticket open on

00:23:45,100 --> 00:23:52,030
that and I don't even know what it will

00:23:49,180 --> 00:23:55,330
support us well it does bugzilla has a

00:23:52,030 --> 00:24:00,160
plug-in for it it had been unresponsive

00:23:55,330 --> 00:24:02,260
24 I think over a year and if I recall

00:24:00,160 --> 00:24:05,020
correctly one or two months ago we got

00:24:02,260 --> 00:24:12,010
an update saying we are now looking into

00:24:05,020 --> 00:24:14,470
adding it to the process so okay who

00:24:12,010 --> 00:24:17,680
knows who knows what's going to happen

00:24:14,470 --> 00:24:20,680
if you want to I can sent you the ticket

00:24:17,680 --> 00:24:23,530
number as buzzer I'm sorry I can search

00:24:20,680 --> 00:24:28,110
for lessons right yeah I think it's

00:24:23,530 --> 00:24:30,760
public we're trying to do list per page

00:24:28,110 --> 00:24:39,280
okay

00:24:30,760 --> 00:24:39,280
you're one of the maintainers oh I see

00:24:39,610 --> 00:24:45,050
yeah all I know is that they suddenly

00:24:42,890 --> 00:24:48,530
respondent we're now looking at it into

00:24:45,050 --> 00:24:51,080
it okay we'll see what goes on and what

00:24:48,530 --> 00:24:53,960
happens so unfortunately I don't have a

00:24:51,080 --> 00:24:57,250
clear answer to that yet please somebody

00:24:53,960 --> 00:24:57,250
asked yeah

00:25:03,900 --> 00:25:06,560
that's

00:25:10,529 --> 00:25:13,529
right

00:25:21,490 --> 00:25:28,730
yeah which is a feature that we are

00:25:26,059 --> 00:25:32,440
already well it's related to some other

00:25:28,730 --> 00:25:32,440
features were already working on

00:25:38,900 --> 00:25:41,260
this

00:25:45,760 --> 00:25:51,350
well maybe you should ask him outside of

00:25:48,770 --> 00:25:54,230
this talk because he's the fast

00:25:51,350 --> 00:25:57,260
maintainer and there's been a lot of

00:25:54,230 --> 00:26:00,340
talk about having free IPA as fast I

00:25:57,260 --> 00:26:03,380
think the current plan is that were

00:26:00,340 --> 00:26:05,960
since fast 3 is so far along we're going

00:26:03,380 --> 00:26:08,630
to move to fast three and after that

00:26:05,960 --> 00:26:10,760
look if we can migrate to free IPA

00:26:08,630 --> 00:26:14,870
because that's going to take a long time

00:26:10,760 --> 00:26:16,790
to actually move because it will not be

00:26:14,870 --> 00:26:19,480
compared with any of the interest we

00:26:16,790 --> 00:26:19,480
have at this moment

00:26:22,970 --> 00:26:29,090
the end user portal is what happened one

00:26:26,720 --> 00:26:31,850
of using the pieces of here right yeah

00:26:29,090 --> 00:26:35,720
and we are dug up pretty much ready now

00:26:31,850 --> 00:26:39,710
and we extend instability

00:26:35,720 --> 00:26:43,460
right but we still will have to modify

00:26:39,710 --> 00:26:46,700
every art work every other applications

00:26:43,460 --> 00:26:55,789
so what is the right time to have this

00:26:46,700 --> 00:26:58,400
conversation we need to write I think

00:26:55,789 --> 00:27:02,090
that we should just come together with

00:26:58,400 --> 00:27:05,600
your and our team and see what we can do

00:27:02,090 --> 00:27:07,990
here I mean we have multiple days here

00:27:05,600 --> 00:27:07,990
at flaw

00:27:11,360 --> 00:27:17,789
okay so one of our other services that

00:27:15,140 --> 00:27:25,830
probably a lot of people know about this

00:27:17,789 --> 00:27:28,980
copper we it two parts or actually three

00:27:25,830 --> 00:27:32,880
but I'm glossing over to third key gen

00:27:28,980 --> 00:27:34,980
part we have a front end which is the

00:27:32,880 --> 00:27:38,309
part that you actually see and where

00:27:34,980 --> 00:27:42,750
you're actually seeing the 15 but 50

00:27:38,309 --> 00:27:44,309
waiting builds that are crashed we have

00:27:42,750 --> 00:27:46,529
the back end that actually should pick

00:27:44,309 --> 00:27:51,690
them up and doesn't and which makes you

00:27:46,529 --> 00:27:53,669
see those 15 missing bills all of those

00:27:51,690 --> 00:27:55,799
boat so what the back end based because

00:27:53,669 --> 00:28:00,000
is it retrieves the current list of to

00:27:55,799 --> 00:28:01,620
build items it submit it it picks the

00:28:00,000 --> 00:28:04,169
first one of them it spins up an

00:28:01,620 --> 00:28:10,649
instance in OpenStack which tries to

00:28:04,169 --> 00:28:14,610
build it and should report back so most

00:28:10,649 --> 00:28:18,419
of the time this works but at sometimes

00:28:14,610 --> 00:28:21,149
we get issues where the copper builders

00:28:18,419 --> 00:28:24,840
are not getting cleaned up and that's

00:28:21,149 --> 00:28:32,870
what you see when you are seeing 50 or

00:28:24,840 --> 00:28:36,299
sometimes to 100 waiting books so

00:28:32,870 --> 00:28:39,330
and one of the reasons we spin up so

00:28:36,299 --> 00:28:42,330
many is every single build get a new

00:28:39,330 --> 00:28:46,950
virtual machine which has the advantage

00:28:42,330 --> 00:28:49,860
that it is very separate so one book

00:28:46,950 --> 00:28:52,080
does not influence in fact any of the

00:28:49,860 --> 00:28:54,179
other builds it does have the

00:28:52,080 --> 00:28:57,090
disadvantage that we spin up so many

00:28:54,179 --> 00:29:00,450
instances that we tend to head open to

00:28:57,090 --> 00:29:17,580
that bugs that a lot of people will not

00:29:00,450 --> 00:29:22,080
hit probably sorry that's true yeah sure

00:29:17,580 --> 00:29:27,029
I just have access but I don't know

00:29:22,080 --> 00:29:29,570
Sodor sob for resetting matter yay for

00:29:27,029 --> 00:29:33,600
dad you need to be an infant may

00:29:29,570 --> 00:29:35,639
OpenStack at me so we won't be able to

00:29:33,600 --> 00:29:38,549
do that unfortunately but the issue is

00:29:35,639 --> 00:29:40,769
also it's caused by copper not shutting

00:29:38,549 --> 00:29:42,950
down as builders completely so if you

00:29:40,769 --> 00:29:47,730
just talk to them and try to establish

00:29:42,950 --> 00:29:51,149
dare issues you would make me very happy

00:29:47,730 --> 00:29:58,320
because I spend approximately one or two

00:29:51,149 --> 00:30:01,880
hours a week on this so this is quite a

00:29:58,320 --> 00:30:05,309
lot of services how do we manage this

00:30:01,880 --> 00:30:07,320
because we're obviously not logging into

00:30:05,309 --> 00:30:13,370
every service to set up everything

00:30:07,320 --> 00:30:13,370
manually and that would not scale it off

00:30:13,549 --> 00:30:18,960
we just ansible for that the pub the

00:30:17,220 --> 00:30:22,110
repository for that is publicly

00:30:18,960 --> 00:30:25,799
available link is there but is also

00:30:22,110 --> 00:30:28,860
easily findable bridges entering in your

00:30:25,799 --> 00:30:32,600
favorite search engine Google you that

00:30:28,860 --> 00:30:32,600
fedora ansible

00:30:33,659 --> 00:30:37,720
ansible actually creates the entire

00:30:35,950 --> 00:30:40,210
virtual machines so the only part that

00:30:37,720 --> 00:30:43,210
we manually install our physical

00:30:40,210 --> 00:30:45,789
machines which is kick-started after

00:30:43,210 --> 00:30:49,539
that and spoke except installation of

00:30:45,789 --> 00:30:51,639
any virtual machines we define which

00:30:49,539 --> 00:31:00,580
makes it very easy to set up a new

00:30:51,639 --> 00:31:02,889
server RL seven most of them now some

00:31:00,580 --> 00:31:07,269
are still stuck at row 6 because they

00:31:02,889 --> 00:31:13,090
have very interesting edge cases like we

00:31:07,269 --> 00:31:16,330
have one and no that's not really the

00:31:13,090 --> 00:31:18,029
case but we have life we have some

00:31:16,330 --> 00:31:22,779
service where we would need to migrate

00:31:18,029 --> 00:31:24,549
VMs off updated and move them back where

00:31:22,779 --> 00:31:30,100
we only have one server in the data

00:31:24,549 --> 00:31:33,009
center another instance is we have one

00:31:30,100 --> 00:31:36,639
data center where server has a very

00:31:33,009 --> 00:31:39,070
weird button video driver so the rel

00:31:36,639 --> 00:31:40,989
seven grub doesn't really work I'm

00:31:39,070 --> 00:31:46,119
screenshot if you want to see that it's

00:31:40,989 --> 00:31:51,609
very funny have you ever seen the movie

00:31:46,119 --> 00:31:54,580
star wars basically over two years so

00:31:51,609 --> 00:31:56,320
the title screen which looks like that

00:31:54,580 --> 00:31:59,080
that's how it works that's how it looks

00:31:56,320 --> 00:32:06,700
there that's great yeah it's very

00:31:59,080 --> 00:32:09,879
readable so we also do a write regularly

00:32:06,700 --> 00:32:13,119
we run a master playbook which excludes

00:32:09,879 --> 00:32:16,389
all of our playbooks announce table with

00:32:13,119 --> 00:32:18,850
checked if so that every thing that is

00:32:16,389 --> 00:32:23,340
defined an ansible which is not turned

00:32:18,850 --> 00:32:26,049
in production will get reported because

00:32:23,340 --> 00:32:29,379
people do not always run all the play

00:32:26,049 --> 00:32:32,080
groups they modify which makes for very

00:32:29,379 --> 00:32:34,279
funny bugs when we actually do run them

00:32:32,080 --> 00:32:37,690
and their configuration

00:32:34,279 --> 00:32:43,759
not correct it happened more than once

00:32:37,690 --> 00:32:47,149
unfortunately so we obviously shouldn't

00:32:43,759 --> 00:32:51,799
try in to debugging production we know

00:32:47,149 --> 00:32:53,749
we should not so that's why we have a

00:32:51,799 --> 00:32:55,999
staging instance and a production

00:32:53,749 --> 00:32:59,749
instance this is also where it was

00:32:55,999 --> 00:33:01,820
coming for you if you have a service

00:32:59,749 --> 00:33:06,200
that you would like us to run we have a

00:33:01,820 --> 00:33:09,139
documentation request for resources that

00:33:06,200 --> 00:33:12,019
will actually define that you need to

00:33:09,139 --> 00:33:15,859
first put it into staging with the

00:33:12,019 --> 00:33:20,029
ansible playbooks and then offer guest

00:33:15,859 --> 00:33:21,739
proof we can put into production the

00:33:20,029 --> 00:33:24,200
staging and production instances are

00:33:21,739 --> 00:33:34,009
completely separate they're not able to

00:33:24,200 --> 00:33:37,070
talk to each other yes there's a diff

00:33:34,009 --> 00:33:39,950
the fast account the fastest team is set

00:33:37,070 --> 00:33:44,210
up entirely itself every surface we run

00:33:39,950 --> 00:33:48,080
a set of staging and production so do

00:33:44,210 --> 00:33:51,200
you remember fascist yes so sometimes we

00:33:48,080 --> 00:33:53,239
sink from production to staging because

00:33:51,200 --> 00:33:57,729
people and enter password in the

00:33:53,239 --> 00:33:57,729
production and yeah

00:34:02,770 --> 00:34:09,740
so the permission system is used is

00:34:06,170 --> 00:34:13,940
motive managed by Flores is a fedora

00:34:09,740 --> 00:34:16,840
account system group membership at the

00:34:13,940 --> 00:34:19,190
apprentice if you want to start

00:34:16,840 --> 00:34:21,200
contributing to throw infrastructure

00:34:19,190 --> 00:34:24,380
just let us know we'll add you to the

00:34:21,200 --> 00:34:27,290
screw this would let us H into a lot of

00:34:24,380 --> 00:34:30,820
our boxes and look around it will not

00:34:27,290 --> 00:34:32,840
let you do anything britax is related

00:34:30,820 --> 00:34:38,660
for that you will need to get into

00:34:32,840 --> 00:34:42,980
sysadmin and later if we if we think you

00:34:38,660 --> 00:34:46,280
are helping a lot in a specific area we

00:34:42,980 --> 00:34:48,800
might add you to other groups but please

00:34:46,280 --> 00:34:57,950
don't ask for them we will tell you when

00:34:48,800 --> 00:35:00,560
it's what you should join them so how to

00:34:57,950 --> 00:35:03,530
get started with help sorry that's the

00:35:00,560 --> 00:35:05,830
wrong one how you can get into content

00:35:03,530 --> 00:35:08,690
with us if there's anything wrong with

00:35:05,830 --> 00:35:13,270
services that we provide well either

00:35:08,690 --> 00:35:15,620
come by us on floor admin on freenode

00:35:13,270 --> 00:35:19,340
senator lip send an email to the mailing

00:35:15,620 --> 00:35:22,100
list or file a ticket if it's something

00:35:19,340 --> 00:35:25,420
that takes longer so we can actually

00:35:22,100 --> 00:35:25,420
track what's going on

00:35:33,029 --> 00:35:41,920
apps is more meant for people asking

00:35:37,690 --> 00:35:45,339
about the web applications and the

00:35:41,920 --> 00:35:49,150
people developing it come contact each

00:35:45,339 --> 00:35:53,440
other their admin is more like for you

00:35:49,150 --> 00:35:55,809
as an end user to ask for help not that

00:35:53,440 --> 00:36:01,329
kind of news yeah not that kind of end

00:35:55,809 --> 00:36:03,279
user user of our web applications the

00:36:01,329 --> 00:36:06,900
renner c is for the infrastructure

00:36:03,279 --> 00:36:11,920
people to come communicate in case and

00:36:06,900 --> 00:36:21,279
problems and other network or systems

00:36:11,920 --> 00:36:24,279
operations related things so how you can

00:36:21,279 --> 00:36:27,430
help us because we are always happy to

00:36:24,279 --> 00:36:30,369
take on any any extra apprentices that

00:36:27,430 --> 00:36:35,559
will be able to help us because we're

00:36:30,369 --> 00:36:39,390
just a team of just a few people we can

00:36:35,559 --> 00:36:39,390
hardly do it everything out ourselves

00:36:39,690 --> 00:36:44,890
this is a page where you can find

00:36:42,309 --> 00:36:46,950
information on getting started with

00:36:44,890 --> 00:36:50,769
contributing to Three Rivers

00:36:46,950 --> 00:36:53,079
infrastructure this is a page which

00:36:50,769 --> 00:36:55,569
might which is not actually only for

00:36:53,079 --> 00:36:59,319
infrastructure but if you're looking for

00:36:55,569 --> 00:37:02,500
things to do please take a look there it

00:36:59,319 --> 00:37:05,920
might not have everything it will often

00:37:02,500 --> 00:37:09,039
have some tasks to get you started just

00:37:05,920 --> 00:37:13,000
ask us in through our admin or ask any

00:37:09,039 --> 00:37:15,880
of us in flora or in flock a lot of them

00:37:13,000 --> 00:37:18,400
are currently in the door so just take a

00:37:15,880 --> 00:37:26,390
look at who's there and ask one of them

00:37:18,400 --> 00:37:31,640
for me so are there any questions

00:37:26,390 --> 00:37:33,289
but again we see four o'clock and

00:37:31,640 --> 00:37:40,970
schedule state of the low notes

00:37:33,289 --> 00:37:43,130
third-party repository I don't think

00:37:40,970 --> 00:37:45,589
you're how are we to take all your

00:37:43,130 --> 00:37:51,170
ansible labels and just go to replicate

00:37:45,589 --> 00:37:54,470
it somewhere you can if it's usable for

00:37:51,170 --> 00:37:56,510
others easily or well because the

00:37:54,470 --> 00:38:02,569
infrastructure of that repository is

00:37:56,510 --> 00:38:05,510
very bad if we can reuse whatever are

00:38:02,569 --> 00:38:08,059
already have right you can certainly

00:38:05,510 --> 00:38:12,049
reuse it but in their case they already

00:38:08,059 --> 00:38:14,510
have a set up with a lot of things which

00:38:12,049 --> 00:38:16,970
is which are specific to them if they

00:38:14,510 --> 00:38:21,289
want to click up our ansible playbook

00:38:16,970 --> 00:38:23,990
they're more than welcome to but they

00:38:21,289 --> 00:38:26,390
are with even less people to mention so

00:38:23,990 --> 00:38:30,079
I mean I mean how hard was do I just

00:38:26,390 --> 00:38:32,500
require some virtual services hit magic

00:38:30,079 --> 00:38:32,500
possums

00:38:33,170 --> 00:38:40,349
most of it yes a lot of the services

00:38:38,099 --> 00:38:43,410
just hit the button and you will get

00:38:40,349 --> 00:38:49,710
pretty much everything we have there's a

00:38:43,410 --> 00:38:52,200
primary focus right well you don't yes

00:38:49,710 --> 00:38:54,750
that's the only part that's a bit tricky

00:38:52,200 --> 00:38:57,210
we have a private bus tree with where

00:38:54,750 --> 00:39:02,190
the keys are stored because we don't

00:38:57,210 --> 00:39:05,010
want those to become public but ansible

00:39:02,190 --> 00:39:07,799
will tell you in itself like hey I need

00:39:05,010 --> 00:39:10,400
this file and I kind of find it and

00:39:07,799 --> 00:39:13,680
often the name is pretty

00:39:10,400 --> 00:39:16,500
self-explanatory so you should be able

00:39:13,680 --> 00:39:19,829
to find what it is that you need to put

00:39:16,500 --> 00:39:23,400
in there and if you can't figure it out

00:39:19,829 --> 00:39:26,640
as I said just ask one of us will be

00:39:23,400 --> 00:39:29,670
glad to help you because we're always

00:39:26,640 --> 00:39:35,180
glad to have other people use or ants go

00:39:29,670 --> 00:39:37,960
play books and everything else any other

00:39:35,180 --> 00:39:41,130
questions

00:39:37,960 --> 00:39:41,130

YouTube URL: https://www.youtube.com/watch?v=lF4xerp3L4o


