Title: OSBConf 2015 | Using AWS Virtual Tape Library as Storage for Bacula Bareos by Alberto GimenÃ©z
Publication date: 2015-10-05
Playlist: OSBConf 2015 | Open Source Backup Conference
Description: 
	How to set up the Amazon Web Services Virtual Tape Library Storage Gateway on-premises to cache and buffer Bacula backups to S3 and Glacier.

The VTL service behaves like a tape library connected via iSCSI, and we can set up a Bacula Storage Daemon to write our backups seamlessly to S3 backed virtual tapes.

(from the article at CAPSiDE Labs:)
http://capside.com/labs/using-aws-virtual-tape-library-vtl-storage-bacula-amazon-web-services-howto/
Captions: 
	00:00:08,540 --> 00:00:15,789
okay everybody our second talk for two

00:00:12,519 --> 00:00:17,920
you will be from about 2k minus X a

00:00:15,789 --> 00:00:21,300
minute give me death k minute yeah okay

00:00:17,920 --> 00:00:24,279
and he's talking about using abs virtual

00:00:21,300 --> 00:00:28,779
tape library storage for backline

00:00:24,279 --> 00:00:32,259
Barrios yeah thank you well hello

00:00:28,779 --> 00:00:34,870
everyone first of all and I'm sorry for

00:00:32,259 --> 00:00:37,719
my boys I've been sick for a couple of

00:00:34,870 --> 00:00:40,180
weeks that I'm now much better than

00:00:37,719 --> 00:00:43,469
couple of days ago I was like the son of

00:00:40,180 --> 00:00:47,829
Borat wife and Christopher Nolan's

00:00:43,469 --> 00:00:50,920
Batman so I'm much better now so i'm

00:00:47,829 --> 00:00:55,890
going to show you about using barrios

00:00:50,920 --> 00:00:59,829
with a amazon web services and storage

00:00:55,890 --> 00:01:02,860
service in the cloud okay i will show

00:00:59,829 --> 00:01:05,860
you how to configure that how to operate

00:01:02,860 --> 00:01:09,130
that and more or less how does this

00:01:05,860 --> 00:01:14,020
thing work okay um first thing a little

00:01:09,130 --> 00:01:18,399
bit of history why did we my company try

00:01:14,020 --> 00:01:22,090
to to do this setup and we have a

00:01:18,399 --> 00:01:28,929
customer that had a legacy bakula

00:01:22,090 --> 00:01:32,740
configuration very very old sorry not

00:01:28,929 --> 00:01:36,130
5.2 it's it was at 3.0 makula so it's

00:01:32,740 --> 00:01:38,380
very very old they have that in a

00:01:36,130 --> 00:01:40,240
physical data center in a machine

00:01:38,380 --> 00:01:45,399
attached in a physical machine attached

00:01:40,240 --> 00:01:50,319
to two MSL tip library with 24 slots one

00:01:45,399 --> 00:01:53,289
tip drive and one change robot the good

00:01:50,319 --> 00:01:55,810
thing was that the speed was pretty good

00:01:53,289 --> 00:01:59,709
you know a direct attached so scarce

00:01:55,810 --> 00:02:03,399
interface was we good but first thing

00:01:59,709 --> 00:02:06,789
was a 3.0 version that we previously

00:02:03,399 --> 00:02:10,300
upgrade from 2.4 so you can imagine

00:02:06,789 --> 00:02:15,819
maybe some of you didn't even born when

00:02:10,300 --> 00:02:18,340
this version was was released also it

00:02:15,819 --> 00:02:23,970
was installed in a very ancient RedHat

00:02:18,340 --> 00:02:26,660
operating system so ancient that was a

00:02:23,970 --> 00:02:32,210
4.0 it's like

00:02:26,660 --> 00:02:34,910
yeah you can understand me right m not

00:02:32,210 --> 00:02:38,030
only this prehistoric stuff was

00:02:34,910 --> 00:02:40,250
installed it was complicated to manage

00:02:38,030 --> 00:02:42,710
to install new software to even to

00:02:40,250 --> 00:02:46,180
update there were no more updates for

00:02:42,710 --> 00:02:49,490
the operating system so it was some risk

00:02:46,180 --> 00:02:54,560
we have another problems regarding the

00:02:49,490 --> 00:02:57,730
tapes themselves once a week this

00:02:54,560 --> 00:03:01,070
customer had a third party company that

00:02:57,730 --> 00:03:03,350
did the off-site vaulting of the tapes

00:03:01,070 --> 00:03:05,330
you know in case a plane crashes into

00:03:03,350 --> 00:03:10,430
the data center we want to have some

00:03:05,330 --> 00:03:12,200
small set of our data in a safe place so

00:03:10,430 --> 00:03:15,170
once a week a guy came to the data

00:03:12,200 --> 00:03:17,690
center physically got the tapes feed

00:03:15,170 --> 00:03:21,170
them in a in a safe case and then bring

00:03:17,690 --> 00:03:24,110
to a safe bunker and store them for the

00:03:21,170 --> 00:03:29,960
next week and then we restarted the life

00:03:24,110 --> 00:03:34,030
cycle again so we were facing some some

00:03:29,960 --> 00:03:36,740
problems the first of them was that

00:03:34,030 --> 00:03:39,200
backups just didn't finish in time I

00:03:36,740 --> 00:03:41,959
mean we started a full backup on

00:03:39,200 --> 00:03:44,030
Saturday and then the next Thursday that

00:03:41,959 --> 00:03:46,790
was the day that the guy went to dead

00:03:44,030 --> 00:03:52,670
center the backup did not finish in time

00:03:46,790 --> 00:03:54,020
so it was a quite huge data set so

00:03:52,670 --> 00:03:57,170
sometimes we have to call the guys and

00:03:54,020 --> 00:04:00,230
say hey this week there's no bolting of

00:03:57,170 --> 00:04:04,660
tapes because the the backup it's still

00:04:00,230 --> 00:04:08,980
running so you can take the details

00:04:04,660 --> 00:04:11,930
second problem was that sometimes um

00:04:08,980 --> 00:04:15,530
depending on the amount of changes of

00:04:11,930 --> 00:04:18,470
our customers database simply the backup

00:04:15,530 --> 00:04:23,570
did not fit in the safe I mean they got

00:04:18,470 --> 00:04:26,510
a safe a supposedly for three tapes then

00:04:23,570 --> 00:04:29,600
we sometimes had four or five tapes they

00:04:26,510 --> 00:04:31,570
try to press the tapes against the safe

00:04:29,600 --> 00:04:35,720
at some times it was not just possible

00:04:31,570 --> 00:04:39,470
so we had another problem the last one

00:04:35,720 --> 00:04:40,400
is that for the retention conditions the

00:04:39,470 --> 00:04:44,410
whole

00:04:40,400 --> 00:04:48,199
a pool tape didn't fit in the msl and

00:04:44,410 --> 00:04:51,350
the offside vaulting place so the

00:04:48,199 --> 00:04:54,020
customer sometimes had to go to the data

00:04:51,350 --> 00:04:57,199
center get a couple of tapes and then

00:04:54,020 --> 00:04:59,870
bring to their offices so they have so

00:04:57,199 --> 00:05:02,720
they had some off-site for months

00:04:59,870 --> 00:05:06,139
off-site backup the thing is that we had

00:05:02,720 --> 00:05:08,660
much more tips than would fit in the

00:05:06,139 --> 00:05:11,330
whole system so the customer had to

00:05:08,660 --> 00:05:17,180
enter the loop complicating things more

00:05:11,330 --> 00:05:21,080
and more and more okay last slide of

00:05:17,180 --> 00:05:23,750
history not true there's another one we

00:05:21,080 --> 00:05:26,000
just wanted a system administrators did

00:05:23,750 --> 00:05:28,940
we just wanted to upgrade the system it

00:05:26,000 --> 00:05:31,460
made no sense to have a legacy system

00:05:28,940 --> 00:05:34,400
with a prehistoric bakula with an

00:05:31,460 --> 00:05:37,550
antediluvian red hat made no sense so we

00:05:34,400 --> 00:05:42,800
wanted to upgrade to something with

00:05:37,550 --> 00:05:47,320
Damien the conditions were that we were

00:05:42,800 --> 00:05:50,479
not allowed to stop backing up stuff the

00:05:47,320 --> 00:05:53,690
under customer of course didn't want any

00:05:50,479 --> 00:05:56,380
risk because the data is very important

00:05:53,690 --> 00:06:01,310
for them it's very important it's a exam

00:05:56,380 --> 00:06:03,770
it's the core of their business so um we

00:06:01,310 --> 00:06:06,289
have the option of duplicating the

00:06:03,770 --> 00:06:08,479
infrastructure get another MSL get

00:06:06,289 --> 00:06:12,770
another physical server install the

00:06:08,479 --> 00:06:16,310
stuff in the data center then um just

00:06:12,770 --> 00:06:20,900
make it work again with a copy of of the

00:06:16,310 --> 00:06:23,449
current infrastructure the sad thing is

00:06:20,900 --> 00:06:27,139
that those things are not usually very

00:06:23,449 --> 00:06:29,750
cheap you know we had to buy another set

00:06:27,139 --> 00:06:32,289
of tapes another set another machine

00:06:29,750 --> 00:06:35,150
another robot and that's not a good

00:06:32,289 --> 00:06:39,139
thing about a cup site the company I

00:06:35,150 --> 00:06:42,110
work for is that we are very close to

00:06:39,139 --> 00:06:46,099
the cloud stuff and we are amazon

00:06:42,110 --> 00:06:47,960
partners lalalalala and we know that we

00:06:46,099 --> 00:06:51,469
know very well some some services and

00:06:47,960 --> 00:06:54,440
there was this service called a BTL

00:06:51,469 --> 00:06:59,240
virtual tape library that was just like

00:06:54,440 --> 00:07:02,000
robot many a changer in the club okay

00:06:59,240 --> 00:07:05,450
what's like hey why not why not try it

00:07:02,000 --> 00:07:08,450
one of the good things em all benefits

00:07:05,450 --> 00:07:11,210
of the cloud is that you can do

00:07:08,450 --> 00:07:14,600
proof-of-concept projects very easily

00:07:11,210 --> 00:07:17,210
and in a very team manner so you just

00:07:14,600 --> 00:07:19,700
deploy the service pay for the usage

00:07:17,210 --> 00:07:22,280
maybe one day two days one week and then

00:07:19,700 --> 00:07:25,370
if it doesn't work you throw it away

00:07:22,280 --> 00:07:29,770
okay you lost maybe a couple hundred

00:07:25,370 --> 00:07:32,750
dollars so it's not the same as just

00:07:29,770 --> 00:07:35,900
purchasing for maybe one year two years

00:07:32,750 --> 00:07:41,300
a whole set of machines a whole set of

00:07:35,900 --> 00:07:43,700
of tapes very much cheaper and easier so

00:07:41,300 --> 00:07:47,870
we started experimenting with with this

00:07:43,700 --> 00:07:51,410
material stuff we haven't used before so

00:07:47,870 --> 00:07:57,260
it was a very starting good starting

00:07:51,410 --> 00:08:00,650
point so what's this service and the vtl

00:07:57,260 --> 00:08:04,820
is a particular case of a more general

00:08:00,650 --> 00:08:07,760
service of AWS that it's called Storage

00:08:04,820 --> 00:08:10,250
Gateway service the studies we service

00:08:07,760 --> 00:08:14,570
is just a service to connect on-premises

00:08:10,250 --> 00:08:20,840
your data center with storage in the

00:08:14,570 --> 00:08:22,550
cloud okay um so you have your you have

00:08:20,840 --> 00:08:27,020
your your data centers somewhat

00:08:22,550 --> 00:08:29,419
connected with some kinds of storage in

00:08:27,020 --> 00:08:34,120
the cloud maybe for disaster recovery or

00:08:29,419 --> 00:08:36,890
for a tape archival or what happen okay

00:08:34,120 --> 00:08:39,410
we have two kinds of storage gateways

00:08:36,890 --> 00:08:41,089
the first one is the vtl but I'm going

00:08:39,410 --> 00:08:43,370
to talk about in this talk the second

00:08:41,089 --> 00:08:45,890
one is the volume gateway that is just

00:08:43,370 --> 00:08:47,900
like disks you have your disks in the

00:08:45,890 --> 00:08:50,000
cloud and then you access them and from

00:08:47,900 --> 00:08:52,490
your servers in your in your data center

00:08:50,000 --> 00:08:54,470
okay you can have the original data in

00:08:52,490 --> 00:08:56,750
your data center and then go uploading

00:08:54,470 --> 00:09:00,050
to the cloud or vice versa you can have

00:08:56,750 --> 00:09:02,420
your original data in in the cloud and

00:09:00,050 --> 00:09:06,320
then you have a kind of a cash in your

00:09:02,420 --> 00:09:07,600
in your data center okay so that's what

00:09:06,320 --> 00:09:11,050
the vtl

00:09:07,600 --> 00:09:14,740
that's it's just a cache of your of your

00:09:11,050 --> 00:09:22,329
backed up data and then the system goes

00:09:14,740 --> 00:09:26,319
uploading to to to the club okay and may

00:09:22,329 --> 00:09:28,089
I don't know if the guys in the the back

00:09:26,319 --> 00:09:34,180
of the room can see this this picture or

00:09:28,089 --> 00:09:38,620
less the straightaway vtl service has

00:09:34,180 --> 00:09:40,660
three main parts okay it has them an

00:09:38,620 --> 00:09:44,500
appliance it's just a victim machine

00:09:40,660 --> 00:09:46,959
that you install on your ESX or hyper-v

00:09:44,500 --> 00:09:51,310
server it's supported it supports both

00:09:46,959 --> 00:09:53,649
virtual brutalization options then you

00:09:51,310 --> 00:09:55,480
have the virtual tapes that are just

00:09:53,649 --> 00:09:58,170
like your regular shapes and then we

00:09:55,480 --> 00:10:03,790
have the tape shelf that it's like an

00:09:58,170 --> 00:10:07,300
offside by a backup place about them the

00:10:03,790 --> 00:10:09,970
vtl okay the first part that is the one

00:10:07,300 --> 00:10:15,009
that you actually install in your data

00:10:09,970 --> 00:10:17,009
center in your ESX how does it work it

00:10:15,009 --> 00:10:20,290
is a boot on machine and appliance that

00:10:17,009 --> 00:10:23,319
AWS gives you you can download it and

00:10:20,290 --> 00:10:26,829
you just have to deploy your you're on

00:10:23,319 --> 00:10:30,310
your ESX or hyper-v server it exposes

00:10:26,829 --> 00:10:33,490
the devices as is Cassie devices so you

00:10:30,310 --> 00:10:37,689
have one media changer and then 10 tape

00:10:33,490 --> 00:10:40,509
drives you can use one or two or the

00:10:37,689 --> 00:10:42,639
whole the whole set of the tip drags it

00:10:40,509 --> 00:10:44,980
depends on your bandwidth because if you

00:10:42,639 --> 00:10:47,500
okay i'm going to use all the tip drives

00:10:44,980 --> 00:10:50,860
yeah okay but then you you need some

00:10:47,500 --> 00:10:55,300
good bandwidth so all of them can upload

00:10:50,860 --> 00:11:00,189
the data tuned to the cloud it has a

00:10:55,300 --> 00:11:03,670
1600 slots so it's a good number for

00:11:00,189 --> 00:11:05,980
playing and then a 1600 extra

00:11:03,670 --> 00:11:09,160
import/export slots that are the ones

00:11:05,980 --> 00:11:12,459
that I don't know if you are used to too

00:11:09,160 --> 00:11:13,959
many changes with import x4 slot those

00:11:12,459 --> 00:11:17,139
are the ones that when you want to

00:11:13,959 --> 00:11:20,079
extract a tape just move to that import

00:11:17,139 --> 00:11:21,459
export slot and then the operator just

00:11:20,079 --> 00:11:23,439
picks the tape and

00:11:21,459 --> 00:11:25,660
doesn't have to open the robot or

00:11:23,439 --> 00:11:31,660
anything else it's like and I don't

00:11:25,660 --> 00:11:36,730
tomato and eject ejection device why is

00:11:31,660 --> 00:11:40,769
that important we'll see later the use

00:11:36,730 --> 00:11:43,360
of those import/export slots okay

00:11:40,769 --> 00:11:46,360
basically for archival and retrieval

00:11:43,360 --> 00:11:50,879
remember the butyl tape tape shelf like

00:11:46,360 --> 00:11:53,920
the offside archiving vault side and

00:11:50,879 --> 00:11:55,929
when we move a tape from one regular

00:11:53,920 --> 00:11:58,899
slot to an import/export slot

00:11:55,929 --> 00:12:04,689
automatically that butyl tape moves to

00:11:58,899 --> 00:12:11,319
that offside place of AWS we'll talk

00:12:04,689 --> 00:12:14,619
about it a little bit later so one of

00:12:11,319 --> 00:12:17,319
the most critical things about the vtl

00:12:14,619 --> 00:12:20,079
the stretch gateway is that it needs at

00:12:17,319 --> 00:12:25,449
least two disks this is very important

00:12:20,079 --> 00:12:29,170
why the vigil the virtual machine the

00:12:25,449 --> 00:12:31,449
appliance is just like a big fat buffer

00:12:29,170 --> 00:12:36,069
for your data to get uploaded to the

00:12:31,449 --> 00:12:40,509
cloud to a remote storage so if you if

00:12:36,069 --> 00:12:42,369
you write a lot on your on your tapes in

00:12:40,509 --> 00:12:45,730
the end you'll need some good bandwidth

00:12:42,369 --> 00:12:49,629
from internet too sorry from your data

00:12:45,730 --> 00:12:52,089
center to AWS so your applications

00:12:49,629 --> 00:12:54,429
barriers in this case we'll have to wait

00:12:52,089 --> 00:12:59,920
for the vtl to say hey give me more data

00:12:54,429 --> 00:13:03,160
I cannot upload fast enough so list to

00:12:59,920 --> 00:13:05,589
this one of them is a akash just akash

00:13:03,160 --> 00:13:08,920
when you want to read from your remote

00:13:05,589 --> 00:13:10,929
tapes it caches the data so you can read

00:13:08,920 --> 00:13:14,559
them again or when you are performing

00:13:10,929 --> 00:13:17,649
backups and the data is first written to

00:13:14,559 --> 00:13:20,980
the cash and then is moved to another

00:13:17,649 --> 00:13:24,429
dish that is the upload buffer that is

00:13:20,980 --> 00:13:27,459
the one that it's continuously uploading

00:13:24,429 --> 00:13:34,149
the information to to the to the actual

00:13:27,459 --> 00:13:35,050
remote virtual tapes okay m at first we

00:13:34,149 --> 00:13:39,459
are winning

00:13:35,050 --> 00:13:41,890
to to configure two discs 14 kasia

00:13:39,459 --> 00:13:45,839
storage and one for the upload buffer

00:13:41,890 --> 00:13:49,360
but we can add more more more disks

00:13:45,839 --> 00:13:52,810
afterwards so we're not forced to just

00:13:49,360 --> 00:13:56,890
use two huge disks you can use any one

00:13:52,810 --> 00:14:00,990
of them anyone any number of of them is

00:13:56,890 --> 00:14:08,860
there any questions so far but all this

00:14:00,990 --> 00:14:12,279
no okay um what else as I said um those

00:14:08,860 --> 00:14:14,620
are like big buffers so we have to size

00:14:12,279 --> 00:14:16,810
them properly it's critical for the

00:14:14,620 --> 00:14:21,550
throughput of our application in this

00:14:16,810 --> 00:14:24,040
case barrios to to size them so we can

00:14:21,550 --> 00:14:27,550
match our application write throughput

00:14:24,040 --> 00:14:29,860
with our internet bandwidth that usually

00:14:27,550 --> 00:14:32,470
is much smaller than the than the write

00:14:29,860 --> 00:14:37,779
throughput so at least they recommend

00:14:32,470 --> 00:14:39,790
using a 150 gigabyte upload buffer the

00:14:37,779 --> 00:14:44,320
cache buffer at the gaseous storage disk

00:14:39,790 --> 00:14:47,940
should be a 1.1 times the size of the of

00:14:44,320 --> 00:14:50,680
them upload buffer that's the minimum

00:14:47,940 --> 00:14:53,950
recommended of course if you want to do

00:14:50,680 --> 00:14:57,550
a proof of concept you will need to

00:14:53,950 --> 00:14:59,980
reserve 150 gigabyte just to test that

00:14:57,550 --> 00:15:04,089
okay but it's the minimum recommended

00:14:59,980 --> 00:15:07,060
for a for application anyway your your

00:15:04,089 --> 00:15:10,329
mileage may vary that means that maybe

00:15:07,060 --> 00:15:13,000
you have a lot of concurrent right in

00:15:10,329 --> 00:15:15,070
your barrios setup or maybe you're just

00:15:13,000 --> 00:15:19,329
backing up one client at a time and you

00:15:15,070 --> 00:15:27,040
don't need so much amount of of buffers

00:15:19,329 --> 00:15:30,730
so you can size that properly what

00:15:27,040 --> 00:15:34,690
happens if one thing I didn't remember

00:15:30,730 --> 00:15:37,690
to say and those discs can be a Derek

00:15:34,690 --> 00:15:40,959
attached to the to the servers DSX or

00:15:37,690 --> 00:15:44,079
you can use Row is Cassie device in case

00:15:40,959 --> 00:15:48,070
you have a storage area network you can

00:15:44,079 --> 00:15:48,700
connect directly from your vtl appliance

00:15:48,070 --> 00:15:53,140
to the

00:15:48,700 --> 00:15:55,210
remote disc so you have the choice they

00:15:53,140 --> 00:15:58,690
recommend to have direct attached discs

00:15:55,210 --> 00:16:02,140
so the thing would be connect the

00:15:58,690 --> 00:16:04,660
storage area network to the ESX have a

00:16:02,140 --> 00:16:10,210
data store that is backed by the Sun and

00:16:04,660 --> 00:16:14,410
then provide local local disks for the

00:16:10,210 --> 00:16:18,580
brutal machine okay I said that you can

00:16:14,410 --> 00:16:23,590
add more more disks afterwards so we can

00:16:18,580 --> 00:16:27,130
grow our our buffers but what happens if

00:16:23,590 --> 00:16:29,110
for example at this crashed or there are

00:16:27,130 --> 00:16:32,410
some communication problems with our is

00:16:29,110 --> 00:16:34,780
Cassie remote storage area network

00:16:32,410 --> 00:16:37,270
whatever we need to delete them the

00:16:34,780 --> 00:16:41,580
documentation says that we can only

00:16:37,270 --> 00:16:43,780
delete disks for the upload buffer okay

00:16:41,580 --> 00:16:48,190
the only thing is that you need to

00:16:43,780 --> 00:16:50,470
restart the video the appliance em they

00:16:48,190 --> 00:16:55,960
don't say that you can well they

00:16:50,470 --> 00:17:00,300
explicitly say that Oh gasps that should

00:16:55,960 --> 00:17:03,880
be catch okay they say explicitly that

00:17:00,300 --> 00:17:07,390
cash this deletion is not supported but

00:17:03,880 --> 00:17:10,060
we had this situation where we needed to

00:17:07,390 --> 00:17:12,280
actually delete that list and in fact it

00:17:10,060 --> 00:17:15,070
makes sense what happens is if the disc

00:17:12,280 --> 00:17:17,530
rashes or happens happens all the

00:17:15,070 --> 00:17:20,170
time so what happens with that we

00:17:17,530 --> 00:17:22,990
contacted AWS support and they confirm

00:17:20,170 --> 00:17:30,280
that even when the dogs said otherwise

00:17:22,990 --> 00:17:35,200
we can delete em cash storage the only

00:17:30,280 --> 00:17:38,140
problem a problem is that the cache must

00:17:35,200 --> 00:17:40,960
be reset what doesn't mean when you

00:17:38,140 --> 00:17:44,950
configure a upload buffers or cash

00:17:40,960 --> 00:17:47,860
storage disks in the interface of a of

00:17:44,950 --> 00:17:50,290
the vtl in the AWS console you can

00:17:47,860 --> 00:17:52,030
choose this this is for a blood buffer

00:17:50,290 --> 00:17:53,890
this one is for cash this one is for

00:17:52,030 --> 00:17:55,840
upload buffer and then everything gets

00:17:53,890 --> 00:17:58,270
summed up and you get the whole space

00:17:55,840 --> 00:18:01,360
for you the thing is that after deleting

00:17:58,270 --> 00:18:02,620
this one of those discs the cache must

00:18:01,360 --> 00:18:05,800
be reset

00:18:02,620 --> 00:18:09,280
means that the vtl forgets about all its

00:18:05,800 --> 00:18:12,309
cash discs and then you have to

00:18:09,280 --> 00:18:14,950
reconfigure again and restart you have

00:18:12,309 --> 00:18:17,620
to even restart the the machine in the

00:18:14,950 --> 00:18:24,240
in the ass ESX server not just the

00:18:17,620 --> 00:18:24,240
service so it's like a huge huge thing

00:18:24,990 --> 00:18:32,200
what happens when we reset the day cash

00:18:28,570 --> 00:18:33,850
we must be sure that it's clean so

00:18:32,200 --> 00:18:37,929
there's no problem on resetting the cash

00:18:33,850 --> 00:18:40,360
is just a catch it's already a data that

00:18:37,929 --> 00:18:42,670
is already in another place but the

00:18:40,360 --> 00:18:47,350
things that the cash must be clean okay

00:18:42,670 --> 00:18:51,040
we have to cloud watch matrix a does

00:18:47,350 --> 00:18:53,980
anyone knows what this cloud watch no

00:18:51,040 --> 00:18:58,960
cloud watch is the the internal sorry oh

00:18:53,980 --> 00:19:01,950
sorry I'm I hear voices my head dulwich

00:18:58,960 --> 00:19:05,559
is the internal monitoring services of

00:19:01,950 --> 00:19:09,010
AWS all internal matrix of all the

00:19:05,559 --> 00:19:10,630
services are saved for like 15 days or

00:19:09,010 --> 00:19:13,660
something like that and you have a lot

00:19:10,630 --> 00:19:17,170
of metrics for for for a cuppa all the

00:19:13,660 --> 00:19:18,640
services and the Storage Gateway has a

00:19:17,170 --> 00:19:22,480
bunch of them but the two most

00:19:18,640 --> 00:19:25,050
importance not only for making sure that

00:19:22,480 --> 00:19:27,700
the the cash is clean but for just

00:19:25,050 --> 00:19:31,360
checking how is your service working are

00:19:27,700 --> 00:19:34,390
the upload buffered use so if you get

00:19:31,360 --> 00:19:36,970
one hundred percent it's a good sign

00:19:34,390 --> 00:19:40,000
that you should add more capacity to

00:19:36,970 --> 00:19:44,950
your upload buffer and the cash percent

00:19:40,000 --> 00:19:47,410
dirty so if you plan to delete some cash

00:19:44,950 --> 00:19:50,380
disks you should wait a stop any

00:19:47,410 --> 00:19:53,290
activity on the vtl stop the storage

00:19:50,380 --> 00:19:57,490
demon or the whole director or whatever

00:19:53,290 --> 00:20:02,260
wait for those things to go 0 and then

00:19:57,490 --> 00:20:05,350
you can do whatever you when i am in the

00:20:02,260 --> 00:20:08,380
past i found some problems just a

00:20:05,350 --> 00:20:12,400
warning I haven't the chance to to

00:20:08,380 --> 00:20:15,150
actually try to to reproduce but I found

00:20:12,400 --> 00:20:15,150
that M

00:20:15,420 --> 00:20:21,630
maybe for this thing in the past when I

00:20:18,510 --> 00:20:25,610
was young and was like crazy and let's

00:20:21,630 --> 00:20:28,980
try things and my tapes got corrupted I

00:20:25,610 --> 00:20:32,040
think that it's because of the the cash

00:20:28,980 --> 00:20:35,340
was not was what's dirty so the thing is

00:20:32,040 --> 00:20:39,060
that the tips were there but when i try

00:20:35,340 --> 00:20:41,280
to mount in Mbakwe in that case it said

00:20:39,060 --> 00:20:44,460
it has a label but it's not about cooler

00:20:41,280 --> 00:20:52,320
label so beware if you want to try thing

00:20:44,460 --> 00:20:55,100
out okay so the second second component

00:20:52,320 --> 00:20:57,540
of the vivid wall 20 minutes already Wow

00:20:55,100 --> 00:21:01,950
second component is the virtual tapes

00:20:57,540 --> 00:21:04,950
they are just em like you're a good old

00:21:01,950 --> 00:21:08,970
physical tip drive tape cartridges and

00:21:04,950 --> 00:21:11,940
we can choose from 100 gigabyte to 2.5

00:21:08,970 --> 00:21:15,420
terabyte under think the key thing here

00:21:11,940 --> 00:21:20,910
is that though the data is backed in s 3

00:21:15,420 --> 00:21:26,460
s 3 is the main storage service from AWS

00:21:20,910 --> 00:21:29,280
from amazon it's like a huge unlimited

00:21:26,460 --> 00:21:33,540
storage it's quite cheap compared

00:21:29,280 --> 00:21:36,930
compared to tune to do some other

00:21:33,540 --> 00:21:41,130
options and it has a 11 nines of

00:21:36,930 --> 00:21:44,370
durability and I think that four nines

00:21:41,130 --> 00:21:46,890
of availability so for durability it's

00:21:44,370 --> 00:21:50,820
pretty cool s3 that's why they chose to

00:21:46,890 --> 00:21:53,130
to store things in industry and another

00:21:50,820 --> 00:21:55,980
good thing of s3 is that you pay only

00:21:53,130 --> 00:21:59,760
for what you use you can create a tape

00:21:55,980 --> 00:22:01,620
of a hundred gigabyte but if you don't

00:21:59,760 --> 00:22:05,250
write anything to a tip you won't pay

00:22:01,620 --> 00:22:08,670
anything okay you only will pay for the

00:22:05,250 --> 00:22:13,380
the good way and a service that it's

00:22:08,670 --> 00:22:19,560
like 125 dollars a month and then for

00:22:13,380 --> 00:22:23,370
the storage you are using em some boring

00:22:19,560 --> 00:22:26,550
numbers you can have up to 1,500 tapes

00:22:23,370 --> 00:22:28,890
in a single Storage Gateway you can have

00:22:26,550 --> 00:22:31,800
more than one of course and

00:22:28,890 --> 00:22:37,500
all the data stored in that gateway wait

00:22:31,800 --> 00:22:41,640
gateway can be more than 150 a terabyte

00:22:37,500 --> 00:22:44,360
so if you need more more more data just

00:22:41,640 --> 00:22:47,240
get another gateway connect another

00:22:44,360 --> 00:22:54,390
storage the mole and then you will have

00:22:47,240 --> 00:22:57,960
300 terabyte okay the the tapes how do

00:22:54,390 --> 00:23:00,570
you create destroy and archive tapes you

00:22:57,960 --> 00:23:05,130
can use the the web console or the API

00:23:00,570 --> 00:23:09,780
okay in AWS in general everything is

00:23:05,130 --> 00:23:12,210
managed via the API everything so you

00:23:09,780 --> 00:23:15,600
can make API calls to create a tape or

00:23:12,210 --> 00:23:18,120
destroy a tape or whatever in fact I

00:23:15,600 --> 00:23:20,370
don't know if you've ever used some AWS

00:23:18,120 --> 00:23:22,940
services but the console the application

00:23:20,370 --> 00:23:26,160
where you log in and move stuff around

00:23:22,940 --> 00:23:28,440
it's not anything special of AWS it's

00:23:26,160 --> 00:23:30,450
just a web application that makes API

00:23:28,440 --> 00:23:34,010
calls for you you could write that

00:23:30,450 --> 00:23:36,810
application by yourself so the the

00:23:34,010 --> 00:23:42,930
important thing here is that you can do

00:23:36,810 --> 00:23:45,630
everything using the dapi okay and the

00:23:42,930 --> 00:23:51,000
last one is the vertical type shelf it's

00:23:45,630 --> 00:23:53,910
just like an an an offside offside place

00:23:51,000 --> 00:23:57,240
it's not in a three it's stored in

00:23:53,910 --> 00:24:00,450
another storage service called a amazon

00:23:57,240 --> 00:24:01,890
glacier that for the name you can you

00:24:00,450 --> 00:24:04,800
can infer that glacier it's like

00:24:01,890 --> 00:24:09,300
something that does not move okay it's

00:24:04,800 --> 00:24:11,730
like for data that is not excessive you

00:24:09,300 --> 00:24:13,410
won't access it for a long time you

00:24:11,730 --> 00:24:16,560
won't delete it for a long time it's

00:24:13,410 --> 00:24:20,040
like a tape archival off-site vaulting

00:24:16,560 --> 00:24:23,340
place okay egg the good thing about

00:24:20,040 --> 00:24:27,150
glacier is that it is much cheaper than

00:24:23,340 --> 00:24:31,620
s3 it's like four times cheaper more

00:24:27,150 --> 00:24:37,050
more more cheap the bad thing as as any

00:24:31,620 --> 00:24:39,210
other I'm sorry my mic please okay like

00:24:37,050 --> 00:24:41,280
for example in an analogous physical

00:24:39,210 --> 00:24:42,269
world when you have to recover some tips

00:24:41,280 --> 00:24:44,759
for your off-site

00:24:42,269 --> 00:24:46,799
bolting site you have to call the guys

00:24:44,759 --> 00:24:50,339
and hey bring me some tapes and then I

00:24:46,799 --> 00:24:53,459
will put them to the to the robot a 24

00:24:50,339 --> 00:24:58,499
hours so when you restore a tape from

00:24:53,459 --> 00:25:02,459
the archival place you need to wait for

00:24:58,499 --> 00:25:05,099
24 hours um the virtual tape shelf as

00:25:02,459 --> 00:25:07,289
you can see in this just forget about

00:25:05,099 --> 00:25:09,809
this this should is like a second data

00:25:07,289 --> 00:25:12,629
center the thing is that for the same

00:25:09,809 --> 00:25:15,119
account and in the same region regional

00:25:12,629 --> 00:25:17,849
like Geographic places of AWS

00:25:15,119 --> 00:25:20,669
independent one from from each other you

00:25:17,849 --> 00:25:24,929
have here Frankfurt and there in Europe

00:25:20,669 --> 00:25:28,139
there's island so you shouldn't be

00:25:24,929 --> 00:25:30,899
worried by that the vital tips elf is it

00:25:28,139 --> 00:25:32,879
the same for all the storage headways so

00:25:30,899 --> 00:25:36,029
if you have more than one Storage

00:25:32,879 --> 00:25:39,950
Gateway provided provisioned you have to

00:25:36,029 --> 00:25:43,259
choose when you restore a tape to what &

00:25:39,950 --> 00:25:48,839
Storage Gateway it will be inserted in

00:25:43,259 --> 00:25:51,479
the in the robot ok so how do we use

00:25:48,839 --> 00:25:53,399
this this thing in the physical world we

00:25:51,479 --> 00:25:56,099
just call the guy and hey its track the

00:25:53,399 --> 00:25:59,579
tape and then put it in the safe and

00:25:56,099 --> 00:26:02,369
bring it somewhere else we can say hey

00:25:59,579 --> 00:26:05,729
mr. amazon take my virtual tape and take

00:26:02,369 --> 00:26:10,440
the USB n ok so how do we manage that

00:26:05,729 --> 00:26:14,399
those are the 1,600 import/export slots

00:26:10,440 --> 00:26:17,609
for when we move from barriers for

00:26:14,399 --> 00:26:20,039
example from a tape drive or a regular

00:26:17,609 --> 00:26:23,779
load to one of the import/export slots

00:26:20,039 --> 00:26:27,119
automatically the tape gets ejected and

00:26:23,779 --> 00:26:30,929
it gets saved or store or archived in

00:26:27,119 --> 00:26:33,239
the individual tape shelf they seem for

00:26:30,929 --> 00:26:35,339
the reverse thing when we recover via

00:26:33,239 --> 00:26:39,629
API or via console I want to recover

00:26:35,339 --> 00:26:42,929
this tape for this Storage Gateway AWS

00:26:39,629 --> 00:26:46,019
automatically makes it up here 24 hours

00:26:42,929 --> 00:26:48,450
later in one of the import/export slots

00:26:46,019 --> 00:26:50,879
so we can then move to a regular load or

00:26:48,450 --> 00:26:55,019
to a tape drive or whatever we want to

00:26:50,879 --> 00:26:56,130
do with them with the tape ok there's

00:26:55,019 --> 00:27:00,720
only one

00:26:56,130 --> 00:27:05,850
one catch that when we retrieve a tape

00:27:00,720 --> 00:27:11,460
from butyl tape shelf it's read-only ok

00:27:05,850 --> 00:27:14,100
this is a behavior because of how

00:27:11,460 --> 00:27:16,980
glacier works glacier is a read-only

00:27:14,100 --> 00:27:20,520
storage so you can modify daytime

00:27:16,980 --> 00:27:23,520
glacier and now you're your faces are

00:27:20,520 --> 00:27:26,520
like read-only tapes what the man

00:27:23,520 --> 00:27:30,360
what happens with my with my life cycle

00:27:26,520 --> 00:27:33,840
that I want to recover my tapes and then

00:27:30,360 --> 00:27:36,870
start again the cycle of a Penn Staters

00:27:33,840 --> 00:27:41,430
and such and I'm going to talk to you

00:27:36,870 --> 00:27:46,230
about the this thing this thing is in

00:27:41,430 --> 00:27:48,630
the cloud ok and if you want to move to

00:27:46,230 --> 00:27:53,610
the cloud or or or make a good use of

00:27:48,630 --> 00:27:57,180
the cloud services you have to make some

00:27:53,610 --> 00:28:01,140
mind shift ok one of the best practices

00:27:57,180 --> 00:28:05,010
of the cloud or moving to the cloud is

00:28:01,140 --> 00:28:10,050
embrace the constraint so when you see a

00:28:05,010 --> 00:28:12,900
limit and instead of fighting you can

00:28:10,050 --> 00:28:15,660
try to change your mindset and be more

00:28:12,900 --> 00:28:21,060
creative so we have this limitation ok

00:28:15,660 --> 00:28:23,730
if we want to go full vtl we have to

00:28:21,060 --> 00:28:26,280
embrace that limit ok not fight and

00:28:23,730 --> 00:28:30,480
again that and then I will ask you a

00:28:26,280 --> 00:28:35,460
question why do we love tapes wait that

00:28:30,480 --> 00:28:38,910
does that plastic case half so we love

00:28:35,460 --> 00:28:41,910
that tape and want to recover that and I

00:28:38,910 --> 00:28:45,540
don't want to lose those are tapes that

00:28:41,910 --> 00:28:48,540
over time they decay they'll have right

00:28:45,540 --> 00:28:50,960
errors so why do we want to recover that

00:28:48,540 --> 00:28:53,640
tape and then put that in the loop again

00:28:50,960 --> 00:28:59,430
we should love the data inside the tape

00:28:53,640 --> 00:29:06,060
not that plastic stuff ok so we have to

00:28:59,430 --> 00:29:08,850
change how do we think about tapes the

00:29:06,060 --> 00:29:09,779
left image is our garden the right image

00:29:08,850 --> 00:29:14,239
our crops

00:29:09,779 --> 00:29:18,539
so in the cloud world we talk about

00:29:14,239 --> 00:29:21,749
crops servers are not like pets we don't

00:29:18,539 --> 00:29:25,349
give names to servers tapes are not paid

00:29:21,749 --> 00:29:27,659
with on Hawk our tape so i love you so

00:29:25,349 --> 00:29:30,649
much now i love you the data it's inside

00:29:27,659 --> 00:29:34,139
we don't treat them like with with

00:29:30,649 --> 00:29:36,210
carefully we just say hey server does

00:29:34,139 --> 00:29:38,759
not work i'll shoot it in the head and

00:29:36,210 --> 00:29:42,269
spin up another one the same happens for

00:29:38,759 --> 00:29:45,089
tapes the tape ended its life cycle so I

00:29:42,269 --> 00:29:48,029
just delete the tape and then start with

00:29:45,089 --> 00:29:50,369
another one because in the in the first

00:29:48,029 --> 00:29:52,859
place that's what we did with physical

00:29:50,369 --> 00:29:55,469
tapes just delete everything in the tape

00:29:52,859 --> 00:30:04,529
and then started writing again on it

00:29:55,469 --> 00:30:07,950
okay but we lose the barrios manage life

00:30:04,529 --> 00:30:12,119
cycle that is a pretty nice thing okay

00:30:07,950 --> 00:30:15,899
it's like some balance between what one

00:30:12,119 --> 00:30:18,299
what we can do with that and now maybe

00:30:15,899 --> 00:30:22,320
you understand my question just today in

00:30:18,299 --> 00:30:24,719
the workshop about hey can we do can we

00:30:22,320 --> 00:30:28,109
write plugins based on time the based

00:30:24,719 --> 00:30:32,339
events maybe when there's an event that

00:30:28,109 --> 00:30:35,879
a tip is full or whatever we can launch

00:30:32,339 --> 00:30:39,269
a trigger to hey movie to the VTS and

00:30:35,879 --> 00:30:42,149
then after some time just delete the

00:30:39,269 --> 00:30:44,909
data and create a new tape that's why I

00:30:42,149 --> 00:30:51,210
just today I was asking about all that

00:30:44,909 --> 00:30:54,719
stuff that's not today it's not we have

00:30:51,210 --> 00:30:58,320
not solved this this thing currently we

00:30:54,719 --> 00:31:00,239
are manually making this disciple we are

00:30:58,320 --> 00:31:03,950
working on trying to write some scripts

00:31:00,239 --> 00:31:06,960
or or try to understand the plugin in

00:31:03,950 --> 00:31:11,940
infrastructure so check if we can

00:31:06,960 --> 00:31:19,129
automate that but that's the the the

00:31:11,940 --> 00:31:19,129
thing today okay any question no

00:31:20,190 --> 00:31:28,149
so now for for the set up how do we

00:31:23,619 --> 00:31:30,460
create this in the AWS console how do we

00:31:28,149 --> 00:31:33,100
create this service or how do we provide

00:31:30,460 --> 00:31:35,799
the service it's actually it's pretty

00:31:33,100 --> 00:31:37,960
easy we go to that to the service in the

00:31:35,799 --> 00:31:46,559
console maybe if I have some time I

00:31:37,960 --> 00:31:49,600
don't know if I'm on time okay thank you

00:31:46,559 --> 00:31:51,850
so we just go to the console I don't

00:31:49,600 --> 00:31:53,619
know if any of you is comfortable with

00:31:51,850 --> 00:31:55,659
the console or or ever seen the console

00:31:53,619 --> 00:31:57,690
let's go to the service and then click

00:31:55,659 --> 00:32:00,369
on a button that says the pliny new

00:31:57,690 --> 00:32:04,059
Storage Gateway when we choose the type

00:32:00,369 --> 00:32:07,359
in this case the vtl Storage Gateway and

00:32:04,059 --> 00:32:13,210
they give you the the vm template for

00:32:07,359 --> 00:32:17,799
your hypervisor ESX or hyper-v it's like

00:32:13,210 --> 00:32:21,190
a gigabyte ovf so you can then upload to

00:32:17,799 --> 00:32:24,009
your to your to your hypervisor and do

00:32:21,190 --> 00:32:26,590
the play appliance a side note you

00:32:24,009 --> 00:32:28,720
deploy your backup server it's another

00:32:26,590 --> 00:32:32,190
machine so this machine is just the

00:32:28,720 --> 00:32:34,899
appliance that exposes the is cassie

00:32:32,190 --> 00:32:37,149
devices and then you activate the edward

00:32:34,899 --> 00:32:39,460
it's just registering hey I have this

00:32:37,149 --> 00:32:41,739
machine on my premises this is will be

00:32:39,460 --> 00:32:46,869
the one that will be uploading data to

00:32:41,739 --> 00:32:51,190
s3 and glacier and and such ok once we

00:32:46,869 --> 00:32:53,710
have em this appliance working and we

00:32:51,190 --> 00:32:56,649
have to configure barrios how do we

00:32:53,710 --> 00:32:59,619
configure that it's just much more easy

00:32:56,649 --> 00:33:02,980
you just install the is cassie and share

00:32:59,619 --> 00:33:06,549
initiator tools in devyani the package

00:33:02,980 --> 00:33:09,070
is called open i discussing and then you

00:33:06,549 --> 00:33:12,580
discover the target and this would be

00:33:09,070 --> 00:33:16,440
your internal the internal IP of of your

00:33:12,580 --> 00:33:20,789
of your appliance it's a local network

00:33:16,440 --> 00:33:24,820
sorry and then you log in to each other

00:33:20,789 --> 00:33:28,960
this discovery will spit out a bunch of

00:33:24,820 --> 00:33:31,570
of devices the 11 devices the the mini a

00:33:28,960 --> 00:33:34,029
changer and the 10 tape drives and then

00:33:31,570 --> 00:33:36,940
you can log in you can connect

00:33:34,029 --> 00:33:39,789
add to all the targets you want if you

00:33:36,940 --> 00:33:41,499
just want to use one tape drive and just

00:33:39,789 --> 00:33:43,989
log into one tape drive you want the

00:33:41,499 --> 00:33:49,059
whole 10 you can do it for for every one

00:33:43,989 --> 00:33:52,229
of them recommendation in the end sorry

00:33:49,059 --> 00:33:54,969
this vtl thing is just uploading data

00:33:52,229 --> 00:33:58,359
through the internet so we have limited

00:33:54,969 --> 00:34:00,909
bandwidth if we have problems with our

00:33:58,359 --> 00:34:03,580
connection this vtl will stop responding

00:34:00,909 --> 00:34:05,859
and then our barriers server will stop

00:34:03,580 --> 00:34:10,260
responding so it's recommended to

00:34:05,859 --> 00:34:16,569
increase the default is cassie timeouts

00:34:10,260 --> 00:34:19,359
ok then after connecting to the two

00:34:16,569 --> 00:34:22,240
devices you can check that on your on

00:34:19,359 --> 00:34:26,500
your barrio server you can see the the

00:34:22,240 --> 00:34:33,129
new the new devices Hey look at me I'm a

00:34:26,500 --> 00:34:35,520
medium changer the fs sh 0 ok but here

00:34:33,129 --> 00:34:41,260
is where the problem the first problem

00:34:35,520 --> 00:34:44,950
strikes you and TX is is a program that

00:34:41,260 --> 00:34:47,980
is used to manage a major change is the

00:34:44,950 --> 00:34:50,589
guy that actually knows how to get the

00:34:47,980 --> 00:34:53,649
robot from one slot to another slot and

00:34:50,589 --> 00:34:57,039
this is being used by marios in the end

00:34:53,649 --> 00:34:59,799
well Barrios uses a describe me if I'm

00:34:57,039 --> 00:35:02,680
wrong uses a rapper script that in the

00:34:59,799 --> 00:35:07,390
end is calling this guy this guy is so

00:35:02,680 --> 00:35:10,359
nice that if you try to to manage this

00:35:07,390 --> 00:35:12,400
nice device filename say hey you know I

00:35:10,359 --> 00:35:15,960
know what you're talking about I'm just

00:35:12,400 --> 00:35:19,390
a prepared to work with Cassie generic

00:35:15,960 --> 00:35:22,900
devices then you go man MTX and it says

00:35:19,390 --> 00:35:29,069
control skazhi media not generic what

00:35:22,900 --> 00:35:33,640
the man why is this so broken ok so

00:35:29,069 --> 00:35:35,980
it's ok no problem you want generic

00:35:33,640 --> 00:35:40,210
devices i will give you generate devices

00:35:35,980 --> 00:35:43,960
in the previous slide this is the

00:35:40,210 --> 00:35:46,690
generic device that is the same device

00:35:43,960 --> 00:35:47,559
as the other one but the colonel just

00:35:46,690 --> 00:35:50,140
uses an

00:35:47,559 --> 00:35:54,579
driver to manage the the interface with

00:35:50,140 --> 00:35:57,489
with the device this no no problem so ok

00:35:54,579 --> 00:35:59,739
you want January and devices i will give

00:35:57,489 --> 00:36:03,430
you generic devices no problem def SD

00:35:59,739 --> 00:36:05,259
for em so we go to barrios and then

00:36:03,430 --> 00:36:08,279
configure they'll to change your device

00:36:05,259 --> 00:36:15,099
they have a cg b four and that's it

00:36:08,279 --> 00:36:18,400
really not so easy because i don't know

00:36:15,099 --> 00:36:21,279
if you remember that good old days of a

00:36:18,400 --> 00:36:23,859
main node and make dave that you had to

00:36:21,279 --> 00:36:29,229
install your linux system and then ok

00:36:23,859 --> 00:36:32,589
have a ide no se hard drive and make

00:36:29,229 --> 00:36:34,689
note a module number mineral number that

00:36:32,589 --> 00:36:36,699
was a nightmare nowadays the colonel is

00:36:34,689 --> 00:36:38,439
prepared to out to detect and auto

00:36:36,699 --> 00:36:43,449
configure all the devices that are

00:36:38,439 --> 00:36:46,439
connected to to our system and the boot

00:36:43,449 --> 00:36:54,160
scripts just detect them and assigns

00:36:46,439 --> 00:36:56,349
numbers or our names dynamically so put

00:36:54,160 --> 00:36:59,469
yourself in the in the body of the boot

00:36:56,349 --> 00:37:02,170
time scripts i connect to s gazi devices

00:36:59,469 --> 00:37:05,589
i get 11 devices all at the same time

00:37:02,170 --> 00:37:07,689
and i start over your one you are two or

00:37:05,589 --> 00:37:10,869
three so the thing is that in the end

00:37:07,689 --> 00:37:14,759
every time we reboot our server usually

00:37:10,869 --> 00:37:17,650
those numbers change so we can't have a

00:37:14,759 --> 00:37:24,609
fixed name in our configuration and

00:37:17,650 --> 00:37:26,469
that's not good for my kula okay so

00:37:24,609 --> 00:37:27,849
that's the thing you restart your your

00:37:26,469 --> 00:37:33,219
machine and then but cooler stops

00:37:27,849 --> 00:37:39,359
working why this is why okay okay so

00:37:33,219 --> 00:37:43,949
what can we do i know some some other

00:37:39,359 --> 00:37:49,150
magicians that know how to cast spells

00:37:43,949 --> 00:37:52,719
okay so they gave me a secret spell that

00:37:49,150 --> 00:37:56,289
works nobody knows why or how but it

00:37:52,719 --> 00:37:58,719
works well the thing is that this is a

00:37:56,289 --> 00:38:01,039
you dev rule you dev is the the

00:37:58,719 --> 00:38:03,469
subsystem that is in charge of

00:38:01,039 --> 00:38:05,449
choli giving names and numbers to all

00:38:03,469 --> 00:38:08,749
the devices that the Colonel's is

00:38:05,449 --> 00:38:14,329
connected to to our system with you

00:38:08,749 --> 00:38:18,829
liberals you can do stuff depending on

00:38:14,329 --> 00:38:21,589
the the features of that device or those

00:38:18,829 --> 00:38:25,749
devices sorry in this case we just say

00:38:21,589 --> 00:38:31,459
hey if this is a media changer a type of

00:38:25,749 --> 00:38:34,130
skazhi device do some secret stuff and

00:38:31,459 --> 00:38:37,069
then hey create a new link under def

00:38:34,130 --> 00:38:39,529
that will be called out to changer you

00:38:37,069 --> 00:38:42,589
can give it you can give any name you

00:38:39,529 --> 00:38:46,160
want it's not must not be out to changer

00:38:42,589 --> 00:38:48,559
but this is the thing that that you have

00:38:46,160 --> 00:38:52,640
to put in somewhere inside this

00:38:48,559 --> 00:38:54,650
directory the name is not meaning it's

00:38:52,640 --> 00:38:58,400
not meaningful so you can do anything

00:38:54,650 --> 00:39:02,900
you and you can name it any name as you

00:38:58,400 --> 00:39:05,239
want and then when you reboot you will

00:39:02,900 --> 00:39:08,599
have this magic they have autochanger

00:39:05,239 --> 00:39:11,409
that will be always call Delta changer

00:39:08,599 --> 00:39:17,119
and will always point to the correct

00:39:11,409 --> 00:39:19,039
actual device file okay okay we have the

00:39:17,119 --> 00:39:21,859
other changer configure with a fixed

00:39:19,039 --> 00:39:23,599
name okay but what happens with with

00:39:21,859 --> 00:39:26,269
tape drives the thing is that the

00:39:23,599 --> 00:39:30,309
default you have rules at least in

00:39:26,269 --> 00:39:33,919
debian is the system i've been trying em

00:39:30,309 --> 00:39:36,859
that there are actually rules for for a

00:39:33,919 --> 00:39:40,390
tape changer the thing is that those

00:39:36,859 --> 00:39:43,489
rules are horrible so they create a

00:39:40,390 --> 00:39:45,619
strange name in a strange directory and

00:39:43,489 --> 00:39:48,919
then it doesn't even point to the other

00:39:45,619 --> 00:39:51,919
changer device it's like it's not useful

00:39:48,919 --> 00:39:55,909
at all so that's why we have to write

00:39:51,919 --> 00:39:58,369
our own rule for Delta changer in this

00:39:55,909 --> 00:40:00,799
case the default Uddhav rules are okay

00:39:58,369 --> 00:40:02,839
so they work properly they set up the

00:40:00,799 --> 00:40:05,929
correct links as long as you are ok with

00:40:02,839 --> 00:40:09,619
this kind of device names to put in your

00:40:05,929 --> 00:40:13,789
configuration ok deftly a bypass IP

00:40:09,619 --> 00:40:14,890
whatever blood is Cassie ok yogi you

00:40:13,789 --> 00:40:19,150
always have the

00:40:14,890 --> 00:40:22,059
journal of using the generic pass the f

00:40:19,150 --> 00:40:25,720
SG one two three or whatever the thing

00:40:22,059 --> 00:40:28,180
is that you will not know if that is the

00:40:25,720 --> 00:40:31,089
first tip to tip dry for the second or

00:40:28,180 --> 00:40:33,519
the third so I think that of this of

00:40:31,089 --> 00:40:37,240
this a bunch of stuff the only thing

00:40:33,519 --> 00:40:40,240
you're used is this nst that rings a

00:40:37,240 --> 00:40:44,440
bell right so we have it exposes to both

00:40:40,240 --> 00:40:46,390
both versions the donor winning and the

00:40:44,440 --> 00:40:48,880
real winning so in this case it's a

00:40:46,390 --> 00:40:52,720
virtual tape so not good winning that's

00:40:48,880 --> 00:40:55,869
okay okay getting there we have the

00:40:52,720 --> 00:41:01,390
devices available so we can configure

00:40:55,869 --> 00:41:06,160
our barriers installation and now it's

00:41:01,390 --> 00:41:09,480
like you will have this more more more

00:41:06,160 --> 00:41:12,039
easier than I those last slides are just

00:41:09,480 --> 00:41:15,099
for filling some time because you will

00:41:12,039 --> 00:41:17,589
know how to configure is cassie devices

00:41:15,099 --> 00:41:20,859
so the thing is that in the storage

00:41:17,589 --> 00:41:24,579
demon we just define the tape drives you

00:41:20,859 --> 00:41:29,440
can define any number you want from 12

00:41:24,579 --> 00:41:30,940
to 10 just choose that the media type as

00:41:29,440 --> 00:41:33,700
you know it's an average tourist thing

00:41:30,940 --> 00:41:35,890
that we can put anything there i chose

00:41:33,700 --> 00:41:40,539
this name because when you create a

00:41:35,890 --> 00:41:44,920
stretch gateway in AWS it puts you what

00:41:40,539 --> 00:41:47,980
kind of hardware it's simulating so it's

00:41:44,920 --> 00:41:50,349
an IBM old tricks blah blah blah so I

00:41:47,980 --> 00:41:54,579
put the media type the same string and

00:41:50,349 --> 00:41:59,500
that's it ok ok we are part of another

00:41:54,579 --> 00:42:02,410
changer and Delta changer resource just

00:41:59,500 --> 00:42:04,509
change your device yeah we don't have to

00:42:02,410 --> 00:42:09,269
change it anymore and then we choose

00:42:04,509 --> 00:42:09,269
which state drives we want to use

00:42:12,089 --> 00:42:17,710
playing with the configuration you can

00:42:14,799 --> 00:42:19,779
for example reserve one or two drives

00:42:17,710 --> 00:42:27,400
for full backups that maybe take more

00:42:19,779 --> 00:42:28,400
time and need more writing at the same

00:42:27,400 --> 00:42:30,740
time

00:42:28,400 --> 00:42:32,750
sorry alright and then you can reserve

00:42:30,740 --> 00:42:34,460
another dry for incremental backups that

00:42:32,750 --> 00:42:37,370
are independent from the full backups

00:42:34,460 --> 00:42:41,330
and you don't have incremental jobs

00:42:37,370 --> 00:42:43,010
waiting for full backups to 2n so you

00:42:41,330 --> 00:42:45,140
can you can play with with with the

00:42:43,010 --> 00:42:49,400
configuration so this is the guy that in

00:42:45,140 --> 00:42:53,510
the end cause the MTX the the scuzzy

00:42:49,400 --> 00:43:00,070
changer that does not how to manage

00:42:53,510 --> 00:43:05,170
skazhi things needs generic devices okay

00:43:00,070 --> 00:43:08,720
and then the director just set up the

00:43:05,170 --> 00:43:11,120
storage please don't look at this okay

00:43:08,720 --> 00:43:15,050
this is just a proof of concept a

00:43:11,120 --> 00:43:17,870
virtual machine the vtl and then we

00:43:15,050 --> 00:43:20,420
match we link the our electron

00:43:17,870 --> 00:43:22,460
configuration with the actual storage

00:43:20,420 --> 00:43:26,750
configuration via the media type and the

00:43:22,460 --> 00:43:32,090
device as you as you may may know a by

00:43:26,750 --> 00:43:34,160
now then the last thing we have to do we

00:43:32,090 --> 00:43:37,220
have the pools we have the devices with

00:43:34,160 --> 00:43:38,900
we have everything set up just say but

00:43:37,220 --> 00:43:43,820
could hey for those jobs or for those

00:43:38,900 --> 00:43:49,370
clients use this this backing storage as

00:43:43,820 --> 00:43:53,870
you as you want to use that okay um any

00:43:49,370 --> 00:44:01,940
questions so far really I'm doing so bad

00:43:53,870 --> 00:44:04,280
that nobody has questions so one thing I

00:44:01,940 --> 00:44:08,780
liked a lot when when I try it barrios

00:44:04,280 --> 00:44:11,090
is that the wii console itself is able

00:44:08,780 --> 00:44:12,950
to manage the outer changer that does is

00:44:11,090 --> 00:44:15,260
not true at least regarding the

00:44:12,950 --> 00:44:17,660
documentation for the latest version of

00:44:15,260 --> 00:44:20,510
akula the thing is that in the in the

00:44:17,660 --> 00:44:23,240
console you have a in port export and

00:44:20,510 --> 00:44:26,120
move so you can move tapes from the

00:44:23,240 --> 00:44:28,220
import/export slots to regular slots and

00:44:26,120 --> 00:44:31,030
vice versa and then you can move around

00:44:28,220 --> 00:44:35,600
tapes in the auto changers loads as

00:44:31,030 --> 00:44:38,540
baccala knows how to how to manage the

00:44:35,600 --> 00:44:42,180
changer we come from inside bakhuda

00:44:38,540 --> 00:44:46,320
barrios and move them

00:44:42,180 --> 00:44:49,200
there's lots one thing that I tried is

00:44:46,320 --> 00:44:52,380
that even when you're inside the wii

00:44:49,200 --> 00:44:54,420
console and you move around tapes the

00:44:52,380 --> 00:44:59,460
catalogue information is not updated

00:44:54,420 --> 00:45:01,980
that maybe one batch requests and you

00:44:59,460 --> 00:45:03,900
have to update the slots manually okay

00:45:01,980 --> 00:45:05,610
the same happens when you create a tip

00:45:03,900 --> 00:45:10,230
what happens when you create a tape

00:45:05,610 --> 00:45:13,230
brand new tape and AWS puts it in one of

00:45:10,230 --> 00:45:15,480
the import/export slots and then you

00:45:13,230 --> 00:45:18,680
move the tape to a regular load and then

00:45:15,480 --> 00:45:24,360
you to the label barcodes la la la la

00:45:18,680 --> 00:45:27,510
okay and the cool thing is this status

00:45:24,360 --> 00:45:31,770
slot I'm not sure if this is documented

00:45:27,510 --> 00:45:34,230
in the in the inline help of of B

00:45:31,770 --> 00:45:37,050
console or or in the or in the

00:45:34,230 --> 00:45:39,060
documentation i'm not sure but if you

00:45:37,050 --> 00:45:41,160
say help status from inside the way

00:45:39,060 --> 00:45:45,360
console i don't think that this is lots

00:45:41,160 --> 00:45:49,290
a keyword is is is present this shows

00:45:45,360 --> 00:45:51,690
lags and MTX status so it shows you the

00:45:49,290 --> 00:45:54,870
tape drive no not the trip drive only

00:45:51,690 --> 00:45:59,310
the slot the slot and and then the tapes

00:45:54,870 --> 00:46:04,130
that are in this loads and the pool of

00:45:59,310 --> 00:46:11,610
the tapes so it's pretty cool very cool

00:46:04,130 --> 00:46:22,050
so am now in questions please make some

00:46:11,610 --> 00:46:23,820
questions yeah pricing very hard to

00:46:22,050 --> 00:46:25,890
understand it's not only the amount of

00:46:23,820 --> 00:46:28,410
storage being used but also they cover

00:46:25,890 --> 00:46:32,610
for the transfer and they have also

00:46:28,410 --> 00:46:35,250
different for how do you say well m AWS

00:46:32,610 --> 00:46:37,950
has this thing called a simple

00:46:35,250 --> 00:46:41,310
calculator the simple is just because

00:46:37,950 --> 00:46:44,520
they like to write down simple it's not

00:46:41,310 --> 00:46:49,710
simple at all we have the sales people

00:46:44,520 --> 00:46:52,260
when we have a when we propose to our

00:46:49,710 --> 00:46:55,020
customers hey move to the cloud busy

00:46:52,260 --> 00:46:55,980
okay how much will it cost they have

00:46:55,020 --> 00:46:59,070
never been able

00:46:55,980 --> 00:47:02,820
to in putting the same values to that

00:46:59,070 --> 00:47:05,340
calculator have the same price twice so

00:47:02,820 --> 00:47:07,859
it always changes it's not simple the

00:47:05,340 --> 00:47:12,680
thing is that you have the storage costs

00:47:07,859 --> 00:47:15,660
then em in general for late for AWS mm

00:47:12,680 --> 00:47:18,300
inbound traffic is for free so when you

00:47:15,660 --> 00:47:20,640
put stuff in AWS is for free what they

00:47:18,300 --> 00:47:24,930
charge you for is when you extract data

00:47:20,640 --> 00:47:27,660
or stuff from AWS um how do you

00:47:24,930 --> 00:47:31,050
calculate that you have an amount of

00:47:27,660 --> 00:47:35,280
data that you will recover from the BTS

00:47:31,050 --> 00:47:38,700
I'm sorry vtl x the days and that's the

00:47:35,280 --> 00:47:43,160
price then you have that price per API

00:47:38,700 --> 00:47:51,210
calls that it's ridiculous is like three

00:47:43,160 --> 00:47:54,450
three tenths of scent so 0.003 / 5000

00:47:51,210 --> 00:47:57,990
API calls that it's ridiculous so it's

00:47:54,450 --> 00:48:00,119
not something to to worry about yeah but

00:47:57,990 --> 00:48:03,420
the transfer is is like that input

00:48:00,119 --> 00:48:07,130
transfer so data that you push from your

00:48:03,420 --> 00:48:09,869
vtl appliance to AWS will be for free

00:48:07,130 --> 00:48:12,290
okay and the only thing they will charge

00:48:09,869 --> 00:48:17,250
you for is when you want to restore

00:48:12,290 --> 00:48:20,490
something and so the the glacier thing

00:48:17,250 --> 00:48:23,130
is in the end that's that's the complex

00:48:20,490 --> 00:48:26,480
want to calculate more elephant yeah

00:48:23,130 --> 00:48:30,869
it's like whoa yeah it's a nightmare um

00:48:26,480 --> 00:48:33,570
the thing is that when you it's the

00:48:30,869 --> 00:48:37,920
storage itself is much cheaper it's like

00:48:33,570 --> 00:48:41,790
four times e / M deleting stuff from

00:48:37,920 --> 00:48:46,740
glacier is for free if you delete stuff

00:48:41,790 --> 00:48:49,410
that is older than 90 days so if you

00:48:46,740 --> 00:48:54,000
delete that before the 90 days they

00:48:49,410 --> 00:48:56,760
charged you depending on how many days

00:48:54,000 --> 00:48:59,670
you had that in glacier it's like yeah

00:48:56,760 --> 00:49:03,150
it's online meds it's mine it's sick to

00:48:59,670 --> 00:49:06,020
understand and the traffic I'm not sure

00:49:03,150 --> 00:49:09,560
about how much do they charge but

00:49:06,020 --> 00:49:13,150
thinking about it maybe

00:49:09,560 --> 00:49:16,700
would be free because a glacier is like

00:49:13,150 --> 00:49:21,190
tied to s3 so moving things from s3 to

00:49:16,700 --> 00:49:24,680
s2 glacier it's not actually very

00:49:21,190 --> 00:49:28,010
expensive so in the end how much time

00:49:24,680 --> 00:49:30,380
does your customer run this now they

00:49:28,010 --> 00:49:34,340
replace the traditional tape library by

00:49:30,380 --> 00:49:36,440
this and so they did no longer need the

00:49:34,340 --> 00:49:39,080
service company to attach the tapes and

00:49:36,440 --> 00:49:42,380
all that stuff did it turn out in the

00:49:39,080 --> 00:49:44,450
end that is cheaper from the cost

00:49:42,380 --> 00:49:46,310
perspective I mean it's for sure more

00:49:44,450 --> 00:49:48,260
practical to yeah yeah this is also

00:49:46,310 --> 00:49:52,610
cheap in the end well it depends so how

00:49:48,260 --> 00:49:55,970
do you how do you call that I mean the

00:49:52,610 --> 00:49:59,300
our customer particularly and had the

00:49:55,970 --> 00:50:04,100
hardware it's very old how did paid for

00:49:59,300 --> 00:50:07,640
it a long time ago so they have a more

00:50:04,100 --> 00:50:10,100
amortized number well the thing is that

00:50:07,640 --> 00:50:11,660
they really let the current is no joke

00:50:10,100 --> 00:50:13,910
is for free for them because they're

00:50:11,660 --> 00:50:17,690
just paying power to the data center the

00:50:13,910 --> 00:50:19,580
rack space and that's it I'm not sure

00:50:17,690 --> 00:50:22,670
how much they are paying right now I

00:50:19,580 --> 00:50:26,330
think they are like four hundred dollars

00:50:22,670 --> 00:50:30,440
a month or less and they have quite a

00:50:26,330 --> 00:50:33,350
bunch of of the other but it's it's not

00:50:30,440 --> 00:50:35,600
easy because a with AWS in general you

00:50:33,350 --> 00:50:38,240
pay per month so I use that I pay for

00:50:35,600 --> 00:50:40,850
that if you have a physical traditional

00:50:38,240 --> 00:50:43,760
data center you pay like in advance a

00:50:40,850 --> 00:50:46,070
bunch of months or even years and then

00:50:43,760 --> 00:50:49,700
there's some point in time that you have

00:50:46,070 --> 00:50:53,390
paid for it so it's free for you two to

00:50:49,700 --> 00:50:55,520
maintain that it's not easy to show you

00:50:53,390 --> 00:50:57,800
have no initial cost for buying the

00:50:55,520 --> 00:50:59,210
other tape library hardware that's that

00:50:57,800 --> 00:51:02,090
stable thing and the good thing about

00:50:59,210 --> 00:51:04,760
proof-of-concept project that hey I want

00:51:02,090 --> 00:51:05,900
to try this thing out like I did hey I

00:51:04,760 --> 00:51:07,940
want to try this for this customer

00:51:05,900 --> 00:51:10,250
customer I think that it will will match

00:51:07,940 --> 00:51:13,310
then it's like a hundred and twenty-five

00:51:10,250 --> 00:51:15,320
dollars a month for the for the service

00:51:13,310 --> 00:51:18,440
itself and then start uploading stuff

00:51:15,320 --> 00:51:23,660
that in s3 is maybe twenty thirty

00:51:18,440 --> 00:51:26,329
dollars a month for a test so

00:51:23,660 --> 00:51:30,190
one last question is how do you handle

00:51:26,329 --> 00:51:33,200
encryption because nobody wants to saw

00:51:30,190 --> 00:51:35,510
you have you have tripped at a time in

00:51:33,200 --> 00:51:39,230
the cloud you have two options as the

00:51:35,510 --> 00:51:42,309
vtl is in on your premises traffic from

00:51:39,230 --> 00:51:45,530
back barriers to the vtl coming crypt or

00:51:42,309 --> 00:51:49,760
you can encrypt in the FV using the

00:51:45,530 --> 00:51:53,630
native encryption of course traffic from

00:51:49,760 --> 00:51:57,710
vtl to AWS goes encrypted ok all sir all

00:51:53,630 --> 00:52:01,490
AWS services go a VI HTTPS or encrypted

00:51:57,710 --> 00:52:04,220
and then in s3 you have the option of a

00:52:01,490 --> 00:52:06,109
encrypt addressed so when when they

00:52:04,220 --> 00:52:15,049
start your data in their physical disks

00:52:06,109 --> 00:52:17,030
they store that encrypted a well at

00:52:15,049 --> 00:52:19,250
their certified there's a certified

00:52:17,030 --> 00:52:20,960
maybe they have a lot more severe they

00:52:19,250 --> 00:52:24,680
are certified but the NSA doesn't care

00:52:20,960 --> 00:52:26,990
about that so yeah honestly I would not

00:52:24,680 --> 00:52:29,359
store my backup data without crippling

00:52:26,990 --> 00:52:31,640
it myself oh yeah yeah it is you cannot

00:52:29,359 --> 00:52:34,549
trust anything it's an option say they

00:52:31,640 --> 00:52:36,589
don't try to fool you and say no no I

00:52:34,549 --> 00:52:38,930
will encrypt that for you don't do

00:52:36,589 --> 00:52:41,059
anything no they say hey you can include

00:52:38,930 --> 00:52:43,460
that I don't care if you want my

00:52:41,059 --> 00:52:47,170
services that I in Crete for you I will

00:52:43,460 --> 00:52:50,510
do that and they are certified and I

00:52:47,170 --> 00:52:53,750
know this because we are punished with

00:52:50,510 --> 00:52:56,510
with AWS we are not part of evil us oh

00:52:53,750 --> 00:52:59,210
don't get me wrong here so I don't have

00:52:56,510 --> 00:53:01,490
anything with them I just know quite

00:52:59,210 --> 00:53:03,730
well how do they work and I can assure

00:53:01,490 --> 00:53:06,440
you that they have more certifications

00:53:03,730 --> 00:53:11,270
than any of your physical data centers

00:53:06,440 --> 00:53:13,309
can get I can assure you that so if

00:53:11,270 --> 00:53:16,279
you're if you're not comfortable that I

00:53:13,309 --> 00:53:19,640
understand that you are not maybe I

00:53:16,279 --> 00:53:22,010
wouldn't be you can always encrypt your

00:53:19,640 --> 00:53:28,789
data and then upload encrypted there's

00:53:22,010 --> 00:53:30,529
no problem doing that thus the PTL

00:53:28,789 --> 00:53:33,650
device also support the lto for

00:53:30,529 --> 00:53:37,070
encryption Carter encryption because an

00:53:33,650 --> 00:53:39,890
LTO 4dr and higher does say

00:53:37,070 --> 00:53:44,000
the board hardware encryption yet or are

00:53:39,890 --> 00:53:45,740
they thinking about it I don't know the

00:53:44,000 --> 00:53:48,140
road map but I think that this is a

00:53:45,740 --> 00:53:50,630
quite stable service I don't think they

00:53:48,140 --> 00:54:00,200
they plan to add more features ok no

00:53:50,630 --> 00:54:02,210
service any other question ok then thank

00:54:00,200 --> 00:54:08,680
you ok thank you thank you everyone

00:54:02,210 --> 00:54:08,680

YouTube URL: https://www.youtube.com/watch?v=-CGsGKKB3ws


