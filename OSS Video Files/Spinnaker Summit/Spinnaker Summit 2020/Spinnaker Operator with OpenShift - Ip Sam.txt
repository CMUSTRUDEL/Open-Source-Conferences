Title: Spinnaker Operator with OpenShift - Ip Sam
Publication date: 2021-01-28
Playlist: Spinnaker Summit 2020
Description: 
	An operator is a method of packaging, deploying and managing an OpenShift application. Operators can be found in the OperatorHub.io public registry. This registry is managed by Red Hat. Spinnaker Operator supports automated releases, multi-cloud deployments, easy application onboarding and CD dashboard. In this presentation, we will go over how the Spinnaker Operator works in OpenShift, and go over examples how to customize your Spinnaker Operator.
Captions: 
	00:00:00,530 --> 00:00:03,629
[Music]

00:00:05,680 --> 00:00:11,679
hello everybody

00:00:07,040 --> 00:00:15,599
welcome to spinach my name is ip sam

00:00:11,679 --> 00:00:18,000
i'm a redhead certified architect

00:00:15,599 --> 00:00:21,119
today we will talk about the spinnaker

00:00:18,000 --> 00:00:21,119
operator with open

00:00:22,160 --> 00:00:27,439
how does the spinnaker operate with

00:00:24,800 --> 00:00:27,439
openshift

00:00:28,000 --> 00:00:33,680
so let's first understand openshift

00:00:31,439 --> 00:00:36,079
openshift is a red hat enterprise

00:00:33,680 --> 00:00:37,680
kubernetes offering

00:00:36,079 --> 00:00:41,520
with openshift you could deploy

00:00:37,680 --> 00:00:44,879
application with security and compliance

00:00:41,520 --> 00:00:46,239
openshift provides the pbu monitoring

00:00:44,879 --> 00:00:50,079
using prometheus

00:00:46,239 --> 00:00:52,079
alert manager and gofundme dashboard

00:00:50,079 --> 00:00:54,480
openshift also provides a distribution

00:00:52,079 --> 00:00:54,480
locking

00:00:55,360 --> 00:00:59,600
openshift support operator out of the

00:00:57,280 --> 00:01:01,120
box

00:00:59,600 --> 00:01:03,840
the application will be scanned for

00:01:01,120 --> 00:01:07,760
security and vulnerability

00:01:03,840 --> 00:01:07,760
and available in the marketplace

00:01:10,840 --> 00:01:16,240
operator in openshift is a concept to

00:01:13,680 --> 00:01:17,439
translate human knowledge from a devops

00:01:16,240 --> 00:01:20,479
theme

00:01:17,439 --> 00:01:23,200
systemize it with automation

00:01:20,479 --> 00:01:23,840
and put it into our operator yeah we

00:01:23,200 --> 00:01:26,880
have different

00:01:23,840 --> 00:01:30,640
operator example for example um

00:01:26,880 --> 00:01:34,159
installing a spinnaker right the step

00:01:30,640 --> 00:01:36,159
are automated with our operator right

00:01:34,159 --> 00:01:37,360
you can also see you know installing you

00:01:36,159 --> 00:01:40,400
know argo cd

00:01:37,360 --> 00:01:42,640
or jenkins by another component

00:01:40,400 --> 00:01:45,840
would also have their own co-op uh

00:01:42,640 --> 00:01:45,840
related operators

00:01:46,640 --> 00:01:52,000
so spinnaker spinach is a

00:01:49,759 --> 00:01:54,799
open source multi-cloud continuous

00:01:52,000 --> 00:01:56,799
delivery platform and that allows

00:01:54,799 --> 00:01:58,880
software releases with high velocity and

00:01:56,799 --> 00:02:00,799
confidence

00:01:58,880 --> 00:02:01,920
vinica also helped the user to create

00:02:00,799 --> 00:02:04,320
department pipeline

00:02:01,920 --> 00:02:05,520
that one integration test unit test

00:02:04,320 --> 00:02:09,280
acceptance test

00:02:05,520 --> 00:02:10,879
system test and spin up and spin down

00:02:09,280 --> 00:02:12,640
surface group

00:02:10,879 --> 00:02:14,239
you could use spinnaker dashboard to

00:02:12,640 --> 00:02:18,080
monitor the deployment

00:02:14,239 --> 00:02:18,080
the roll out and roll back

00:02:19,840 --> 00:02:23,599
now we understand the spin

00:02:21,760 --> 00:02:27,920
concept

00:02:23,599 --> 00:02:30,480
we look at the spinnaker operator

00:02:27,920 --> 00:02:32,080
spinnaker operator allow the user to

00:02:30,480 --> 00:02:34,480
spin up spinnaker

00:02:32,080 --> 00:02:35,680
to manage the continuous deployment

00:02:34,480 --> 00:02:38,800
using

00:02:35,680 --> 00:02:41,440
openshift crds

00:02:38,800 --> 00:02:43,280
with the help of the spinniker operator

00:02:41,440 --> 00:02:45,920
the user have the convenience and

00:02:43,280 --> 00:02:49,120
confidence of simple and powerful

00:02:45,920 --> 00:02:51,760
approach to execution pipeline

00:02:49,120 --> 00:02:54,000
with high velocity velocity and managing

00:02:51,760 --> 00:02:54,000
risk

00:02:55,599 --> 00:03:03,200
spinnaker has the following features

00:02:59,760 --> 00:03:06,239
it support multi-cloud deployment and

00:03:03,200 --> 00:03:08,800
the release with pipeline

00:03:06,239 --> 00:03:09,840
pipeline as co right you can encapsulate

00:03:08,800 --> 00:03:12,480
the pipeline using

00:03:09,840 --> 00:03:14,480
goofy script or some other script and

00:03:12,480 --> 00:03:17,040
save it into git repository so in this

00:03:14,480 --> 00:03:20,400
case the pipeline is

00:03:17,040 --> 00:03:23,360
uh yeah it's a develop and capture

00:03:20,400 --> 00:03:25,280
in you know code save deployment

00:03:23,360 --> 00:03:28,159
strategy you could set up different

00:03:25,280 --> 00:03:29,519
uh deployment strategy using voting

00:03:28,159 --> 00:03:33,599
update

00:03:29,519 --> 00:03:36,239
blue green deployment and so on

00:03:33,599 --> 00:03:37,920
one click roll back if something you

00:03:36,239 --> 00:03:39,040
deploy to production it did not work you

00:03:37,920 --> 00:03:41,120
can click

00:03:39,040 --> 00:03:42,959
to go back to the virtual version minus

00:03:41,120 --> 00:03:46,239
one

00:03:42,959 --> 00:03:49,360
it support easy life cycle management

00:03:46,239 --> 00:03:53,760
easy application onboarding it

00:03:49,360 --> 00:03:58,080
enforce the compliance policy auditing

00:03:53,760 --> 00:03:58,080
and also it support the cd dashboard

00:03:59,760 --> 00:04:06,159
operator hub io operator

00:04:03,360 --> 00:04:08,080
pub io is launched by red hat in

00:04:06,159 --> 00:04:12,400
collaboration with awfs

00:04:08,080 --> 00:04:12,400
google glocal and microsoft

00:04:12,720 --> 00:04:18,560
the operator of io designed to be public

00:04:15,760 --> 00:04:21,919
is a public registry the registry for

00:04:18,560 --> 00:04:24,960
finding the kubernetes operator

00:04:21,919 --> 00:04:24,960
of and services

00:04:26,479 --> 00:04:33,919
installing uh in open shift

00:04:30,479 --> 00:04:35,440
so with the um operator lifecycle

00:04:33,919 --> 00:04:37,360
manager

00:04:35,440 --> 00:04:38,880
uh this is a tool for you to manage

00:04:37,360 --> 00:04:40,320
operator warning on your openshift

00:04:38,880 --> 00:04:43,199
cluster

00:04:40,320 --> 00:04:45,199
you could download this from github in

00:04:43,199 --> 00:04:48,720
the url

00:04:45,199 --> 00:04:48,720
for the installation shell script

00:04:49,600 --> 00:04:54,560
then with the operator

00:04:52,880 --> 00:04:56,720
you could install the operator in the

00:04:54,560 --> 00:04:58,160
operator namespace

00:04:56,720 --> 00:05:00,479
that would be available for all

00:04:58,160 --> 00:05:04,560
namespace in your cluster

00:05:00,479 --> 00:05:08,840
all you need is to call the ocqa-f

00:05:04,560 --> 00:05:11,840
and specify the spinnaker operator emo

00:05:08,840 --> 00:05:11,840
file

00:05:12,080 --> 00:05:18,240
you also have the custom resource

00:05:14,800 --> 00:05:18,240
definition the crd

00:05:18,720 --> 00:05:26,000
these are introduced by the operator

00:05:22,479 --> 00:05:28,720
when you do the oc crd hyphen n

00:05:26,000 --> 00:05:31,840
operators you will get you will see the

00:05:28,720 --> 00:05:31,840
corresponding crt

00:05:32,960 --> 00:05:41,360
so this is an example a crd definition

00:05:37,600 --> 00:05:44,639
and you can see that um we have the

00:05:41,360 --> 00:05:47,440
corresponding uh spinnaker feature flag

00:05:44,639 --> 00:05:47,840
we use the feature flag to identify uh

00:05:47,440 --> 00:05:50,400
what

00:05:47,840 --> 00:05:50,960
feature in spinnaker you want to include

00:05:50,400 --> 00:05:53,919
for the

00:05:50,960 --> 00:05:54,720
for the deployment for the installation

00:05:53,919 --> 00:05:58,080
um

00:05:54,720 --> 00:05:59,840
you have the spinniker access key

00:05:58,080 --> 00:06:02,340
usually you could use the spinniker

00:05:59,840 --> 00:06:03,440
admon as the access key

00:06:02,340 --> 00:06:07,120
[Music]

00:06:03,440 --> 00:06:08,639
and at then surface account we are using

00:06:07,120 --> 00:06:10,960
the spinnaker operator as a service

00:06:08,639 --> 00:06:10,960
account

00:06:14,479 --> 00:06:20,400
so to create a resource definition

00:06:17,600 --> 00:06:22,000
you download you download the

00:06:20,400 --> 00:06:25,199
microservices related to

00:06:22,000 --> 00:06:27,520
spinnaker using the crd

00:06:25,199 --> 00:06:30,880
that will bring in all spinnaker port to

00:06:27,520 --> 00:06:30,880
the operator namespace

00:06:31,199 --> 00:06:35,600
so what you need to do is to do our oc

00:06:33,039 --> 00:06:39,600
create f

00:06:35,600 --> 00:06:43,680
there's opsm spinnika yamo

00:06:39,600 --> 00:06:43,680
hyphen n the operator namespace

00:06:44,479 --> 00:06:49,280
after that you need to validate the crd

00:06:46,639 --> 00:06:52,240
is created

00:06:49,280 --> 00:06:54,880
you can call oc guess crd hyphen n

00:06:52,240 --> 00:06:54,880
operator

00:06:55,039 --> 00:06:59,440
and then you should see the spinning

00:06:56,560 --> 00:07:03,840
operator dot chart dot hem dot

00:06:59,440 --> 00:07:03,840
p s dot io

00:07:04,080 --> 00:07:10,240
the open shift part you could validate

00:07:07,120 --> 00:07:12,960
that the spinnaker part is created

00:07:10,240 --> 00:07:15,520
running the command oc get port n

00:07:12,960 --> 00:07:19,039
operator

00:07:15,520 --> 00:07:22,319
you should see there were spin

00:07:19,039 --> 00:07:26,720
hyphen install iphone with the

00:07:22,319 --> 00:07:28,800
uh with that part will be created

00:07:26,720 --> 00:07:31,840
and then the spinnaker operators part

00:07:28,800 --> 00:07:31,840
will also be created

00:07:35,039 --> 00:07:39,440
for the openshift deployment you log

00:07:37,520 --> 00:07:42,319
into the

00:07:39,440 --> 00:07:42,319
operator port

00:07:43,120 --> 00:07:47,360
you actually see it and then you specify

00:07:46,800 --> 00:07:52,000
the

00:07:47,360 --> 00:07:55,039
spin in stock port dash n operator

00:07:52,000 --> 00:07:57,120
and then you want to use the bin badge

00:07:55,039 --> 00:08:00,879
once you get into the port you can run

00:07:57,120 --> 00:08:02,879
the hell deploy a pie

00:08:00,879 --> 00:08:06,639
in this case you will see the list of

00:08:02,879 --> 00:08:06,639
deployment of the spinnaker services

00:08:07,840 --> 00:08:11,840
at the end you can do oc get port hyphen

00:08:10,800 --> 00:08:14,240
n

00:08:11,840 --> 00:08:18,000
operator to see the output two to see

00:08:14,240 --> 00:08:18,000
the corresponding parts in the operator

00:08:19,759 --> 00:08:24,000
um so then at that time you can open up

00:08:23,599 --> 00:08:26,080
the

00:08:24,000 --> 00:08:29,039
uh check the speed make sure that the

00:08:26,080 --> 00:08:33,440
spinnaker surface is running

00:08:29,039 --> 00:08:33,440
and launch the spindle console

00:08:36,000 --> 00:08:41,330
so we view the red hat marketplace

00:08:39,440 --> 00:08:43,200
the redneck marketplace

00:08:41,330 --> 00:08:46,560
[Music]

00:08:43,200 --> 00:08:51,040
contain the open enterprise vinegar

00:08:46,560 --> 00:08:51,040
which is available in the marketplace

00:08:51,120 --> 00:08:57,839
customer responsive support stream

00:08:54,320 --> 00:08:59,600
streamline building contract contracting

00:08:57,839 --> 00:09:02,080
simplify governance and

00:08:59,600 --> 00:09:02,720
single dashboard visibility across the

00:09:02,080 --> 00:09:06,880
cloud

00:09:02,720 --> 00:09:06,880
is the nature of the marketplace

00:09:07,040 --> 00:09:11,040
so automated deployment on red hat

00:09:09,920 --> 00:09:12,880
cluster

00:09:11,040 --> 00:09:16,800
providing a fast and integrated

00:09:12,880 --> 00:09:16,800
experience with the marketplace

00:09:19,360 --> 00:09:22,800
so if you go to the right hand

00:09:20,480 --> 00:09:24,000
marketplace you can search and you will

00:09:22,800 --> 00:09:27,279
see

00:09:24,000 --> 00:09:28,240
the open enterprise spinnaker and that

00:09:27,279 --> 00:09:32,480
contains a good

00:09:28,240 --> 00:09:34,880
description of what what the

00:09:32,480 --> 00:09:36,000
open open enterprise clinical operator

00:09:34,880 --> 00:09:38,320
does

00:09:36,000 --> 00:09:39,920
the features and the uh the required

00:09:38,320 --> 00:09:43,760
subscription

00:09:39,920 --> 00:09:46,880
uh the the versioning right

00:09:43,760 --> 00:09:51,839
and the um and the certificate we are

00:09:46,880 --> 00:09:51,839
related to this operator

00:09:52,560 --> 00:09:56,399
if you go to the openshift console you

00:09:55,600 --> 00:09:59,360
can click

00:09:56,399 --> 00:10:01,120
also click on the operator hub in the

00:09:59,360 --> 00:10:03,600
operator hub

00:10:01,120 --> 00:10:05,120
you can search for spinnaker and you

00:10:03,600 --> 00:10:06,320
will see different version of spinnaker

00:10:05,120 --> 00:10:08,560
available

00:10:06,320 --> 00:10:12,000
you have the community community version

00:10:08,560 --> 00:10:13,760
you have the marketplace version

00:10:12,000 --> 00:10:15,440
so in this example i'm going to show you

00:10:13,760 --> 00:10:18,000
the openshift

00:10:15,440 --> 00:10:21,279
using open enterprise spinnaker operator

00:10:18,000 --> 00:10:21,279
the first example here

00:10:22,240 --> 00:10:26,000
when you click on it you have the option

00:10:25,680 --> 00:10:30,640
to

00:10:26,000 --> 00:10:30,640
install the open enterprise spinnaker

00:10:30,839 --> 00:10:35,360
operator

00:10:32,079 --> 00:10:36,240
so for the basic installation you need

00:10:35,360 --> 00:10:39,440
to create

00:10:36,240 --> 00:10:39,440
operator subscription

00:10:39,600 --> 00:10:45,760
you could specify the installation mode

00:10:43,760 --> 00:10:47,279
you can do it for all name space or you

00:10:45,760 --> 00:10:51,360
can do it for a specific

00:10:47,279 --> 00:10:55,680
cluster and you also need

00:10:51,360 --> 00:10:57,519
to get the approval for the subscription

00:10:55,680 --> 00:10:58,880
in this case i specify to use the

00:10:57,519 --> 00:11:01,839
automatic approval

00:10:58,880 --> 00:11:01,839
for the subscription

00:11:05,920 --> 00:11:12,959
once you have installed the operator

00:11:09,120 --> 00:11:15,680
you will see enterprise spinnaker are

00:11:12,959 --> 00:11:17,680
available in the install operator

00:11:15,680 --> 00:11:20,560
so the next step is to click on that and

00:11:17,680 --> 00:11:22,240
look at the details

00:11:20,560 --> 00:11:24,560
when you click on that name you will

00:11:22,240 --> 00:11:27,440
come to this channel

00:11:24,560 --> 00:11:27,440
you will see that

00:11:27,760 --> 00:11:34,720
there's a specific uh uh subscription

00:11:31,279 --> 00:11:37,279
tie to this open enterprise spinnaker

00:11:34,720 --> 00:11:38,560
the channel is alpha is automatically

00:11:37,279 --> 00:11:40,560
approved

00:11:38,560 --> 00:11:43,839
and then at the same time you will be

00:11:40,560 --> 00:11:43,839
doing the installation

00:11:48,240 --> 00:11:51,440
when you go to the yaml file you could

00:11:50,399 --> 00:11:54,639
check the

00:11:51,440 --> 00:11:55,760
corresponding spindle version in this

00:11:54,639 --> 00:11:58,720
case is

00:11:55,760 --> 00:12:01,519
version 1.20.5 this is the current

00:11:58,720 --> 00:12:01,519
latest version

00:12:04,639 --> 00:12:09,600
and after the installation you'll see

00:12:06,880 --> 00:12:13,680
the corresponding resources available

00:12:09,600 --> 00:12:16,480
from the operator you can see

00:12:13,680 --> 00:12:16,480
the oes

00:12:16,959 --> 00:12:20,959
the corresponding deployment the surface

00:12:19,440 --> 00:12:25,120
decreases

00:12:20,959 --> 00:12:29,440
conference map because that part

00:12:25,120 --> 00:12:29,440
will be created for the spinnaker

00:12:33,440 --> 00:12:36,560
and then if you go on the left cycle to

00:12:35,360 --> 00:12:39,040
the pot

00:12:36,560 --> 00:12:41,760
inside workflow you can lock up the

00:12:39,040 --> 00:12:45,600
specific port details

00:12:41,760 --> 00:12:48,639
or the um for the spinnaker port

00:12:45,600 --> 00:12:50,880
so osc open enterprise spin

00:12:48,639 --> 00:12:54,079
is one part this is one part that was

00:12:50,880 --> 00:12:54,079
created for the spinnaker

00:12:57,680 --> 00:13:01,279
if you go to the terminal of the port

00:12:59,440 --> 00:13:04,079
you can do the

00:13:01,279 --> 00:13:05,920
l control r contract list the health

00:13:04,079 --> 00:13:06,399
controls will release the configuration

00:13:05,920 --> 00:13:10,560
of

00:13:06,399 --> 00:13:10,560
the of the spinnaker

00:13:13,440 --> 00:13:21,519
and then you could do the cube control

00:13:17,600 --> 00:13:25,600
get all the cube control get all will

00:13:21,519 --> 00:13:28,800
return all the uh kubernetes objects

00:13:25,600 --> 00:13:31,279
related created for the port and it

00:13:28,800 --> 00:13:34,399
would also show the ip addresses

00:13:31,279 --> 00:13:35,760
and the port number of the spinnaker

00:13:34,399 --> 00:13:38,399
console

00:13:35,760 --> 00:13:39,519
so from the output you can copy that

00:13:38,399 --> 00:13:41,920
console

00:13:39,519 --> 00:13:43,920
ip address and port number and open that

00:13:41,920 --> 00:13:47,360
in the browser

00:13:43,920 --> 00:13:49,120
the spinnaker console will come up

00:13:47,360 --> 00:13:51,360
if you click on the help button on the

00:13:49,120 --> 00:13:53,760
right hand side and check for version

00:13:51,360 --> 00:13:55,279
this version should be matching the

00:13:53,760 --> 00:13:57,920
version that you have for your

00:13:55,279 --> 00:13:57,920
installation

00:13:59,920 --> 00:14:04,240
to uninstall uh the spinnaker is also

00:14:02,720 --> 00:14:08,079
very straightforward

00:14:04,240 --> 00:14:11,120
you go back to the operator

00:14:08,079 --> 00:14:14,399
operator hubs and search for the

00:14:11,120 --> 00:14:17,839
open enterprise spinnaker operator

00:14:14,399 --> 00:14:17,839
and click on uninstall

00:14:20,079 --> 00:14:24,000
next step is to confirm the

00:14:21,839 --> 00:14:26,160
uninstallation

00:14:24,000 --> 00:14:29,360
after the uninstallation all the

00:14:26,160 --> 00:14:30,880
spinnaker resources will be removed

00:14:29,360 --> 00:14:33,279
when the operator is finished and

00:14:30,880 --> 00:14:33,279
install

00:14:34,959 --> 00:14:38,399
so in this presentation you see

00:14:37,600 --> 00:14:41,120
installing

00:14:38,399 --> 00:14:42,880
and uninstalling spinny car dashboard

00:14:41,120 --> 00:14:46,959
was very easy

00:14:42,880 --> 00:14:49,440
using openshift operator

00:14:46,959 --> 00:14:52,240
the openshift operator are available in

00:14:49,440 --> 00:14:53,839
the openshift 4

00:14:52,240 --> 00:14:55,839
if you are using an older version of

00:14:53,839 --> 00:14:57,199
openshift 3 you will need to go through

00:14:55,839 --> 00:15:00,560
the menu steps

00:14:57,199 --> 00:15:00,560
to install spinnaker

00:15:01,199 --> 00:15:06,959
the spinniker features is managed by the

00:15:04,079 --> 00:15:10,079
operator subscription

00:15:06,959 --> 00:15:11,279
so it depends on remember in the mmo

00:15:10,079 --> 00:15:14,720
file you have a list of

00:15:11,279 --> 00:15:17,519
spinnaker feature if you need to

00:15:14,720 --> 00:15:19,279
do more include more features you will

00:15:17,519 --> 00:15:21,519
need to modify your subscription to do

00:15:19,279 --> 00:15:24,480
that

00:15:21,519 --> 00:15:27,199
the spinning operator latest version as

00:15:24,480 --> 00:15:29,040
of today is version 1.20.5

00:15:27,199 --> 00:15:31,600
which is available in the openshift

00:15:29,040 --> 00:15:31,600
operator

00:15:32,320 --> 00:15:35,680
openshift manage operator deployment

00:15:35,120 --> 00:15:38,560
using the

00:15:35,680 --> 00:15:39,199
home you're using the openshift console

00:15:38,560 --> 00:15:42,560
which

00:15:39,199 --> 00:15:44,000
make it really easy to do um if you if

00:15:42,560 --> 00:15:45,440
you don't want to touch the command line

00:15:44,000 --> 00:15:48,480
you can install the

00:15:45,440 --> 00:15:50,959
entire uh spinnaker operator using the

00:15:48,480 --> 00:15:50,959
console

00:15:52,560 --> 00:15:56,639
that's it yeah thank you for attending

00:15:54,560 --> 00:15:59,040
this mini quest submit

00:15:56,639 --> 00:15:59,680
if you have questions please reach out

00:15:59,040 --> 00:16:03,600
to

00:15:59,680 --> 00:16:09,839
redhead consulting thank you very much

00:16:03,600 --> 00:16:09,839

YouTube URL: https://www.youtube.com/watch?v=7A3wdLv51NU


