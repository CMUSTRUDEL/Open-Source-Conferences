Title: The OpenBSD Hypervisor in the wild, a short story.
Publication date: 2019-10-27
Playlist: EuroBSDCon 2019, Norway
Description: 
	OpenBSD Amsterdam started in the summer of 2018 after a poll on Twitter as an idea to start testing with vmm(4)/vmd(8). Mostly to see how far we could take it and more importantly to give back to the project. Little did we know where it would take us.

During this talk I will outline how it all started, how it’s build, how we operate the platform and what speedbumps we encountered.

We are a big proponent of using as much out of base as possible and it has influenced our design choices a lot. These choices will be highlighted when discussing how the platform is build and how it’s operated.

More info:
https://2019.eurobsdcon.org/talk-speakers/#openbsdhypervisor
Captions: 
	00:00:02,570 --> 00:00:07,129
well we have the pleasure of having

00:00:05,720 --> 00:00:10,070
Misha Peters come and talk about the

00:00:07,129 --> 00:00:11,929
OpenBSD hypervisor in the wild they'll

00:00:10,070 --> 00:00:13,910
be they'll be time for a question and

00:00:11,929 --> 00:00:15,200
answer it's at the end so please hold

00:00:13,910 --> 00:00:17,090
your questions until then and we'll

00:00:15,200 --> 00:00:19,700
leave a few minutes at the end with that

00:00:17,090 --> 00:00:22,340
thank you it's a little bit weird that

00:00:19,700 --> 00:00:24,800
you're introducing me now being the guy

00:00:22,340 --> 00:00:27,079
that's written at all and some other

00:00:24,800 --> 00:00:29,960
people here so good morning welcome

00:00:27,079 --> 00:00:33,380
I like the intimate room that I'm in

00:00:29,960 --> 00:00:35,870
it's really nice so I'm going to talk

00:00:33,380 --> 00:00:38,330
about the the bsd hypervisor OpenBSD

00:00:35,870 --> 00:00:42,650
hypervisor that I'm using for open BSD

00:00:38,330 --> 00:00:44,060
Amsterdam first I have to apologize I'm

00:00:42,650 --> 00:00:46,370
presenting this from a Mac I was not

00:00:44,060 --> 00:00:47,630
planning to but I'm flying to the US and

00:00:46,370 --> 00:00:49,400
I don't like to take my personal

00:00:47,630 --> 00:00:51,620
notebook into the u.s. so that's why I'm

00:00:49,400 --> 00:00:55,760
using on my work notebook this is my

00:00:51,620 --> 00:00:59,090
personal notebook so that you know and a

00:00:55,760 --> 00:01:03,159
little bit about me I started way back

00:00:59,090 --> 00:01:05,869
when a Texas ro ice beam Netherlands

00:01:03,159 --> 00:01:09,950
when it was like this in the in the

00:01:05,869 --> 00:01:12,170
picture and since then I started working

00:01:09,950 --> 00:01:13,610
for four vendors so I worked for for

00:01:12,170 --> 00:01:16,550
companies like like blue code and

00:01:13,610 --> 00:01:19,780
foundry that people might know and also

00:01:16,550 --> 00:01:24,080
started around that time with FreeBSD

00:01:19,780 --> 00:01:26,540
later on at it OpenBSD to to the mix and

00:01:24,080 --> 00:01:28,430
when Mike started working on the on the

00:01:26,540 --> 00:01:30,979
hypervisor I thought oh this is great so

00:01:28,430 --> 00:01:33,799
let's let's do that so I'm gonna talk

00:01:30,979 --> 00:01:36,740
about how it'll start it to set up

00:01:33,799 --> 00:01:38,990
things that I've seen what users are

00:01:36,740 --> 00:01:42,380
experiencing so hopefully you get a good

00:01:38,990 --> 00:01:44,990
picture of what's going on and I've

00:01:42,380 --> 00:01:47,689
doing some awesome colocation since 99

00:01:44,990 --> 00:01:51,830
is a little bit out of hand hobby that

00:01:47,689 --> 00:01:57,890
that snowballs but what about you and so

00:01:51,830 --> 00:02:02,960
who's using open Beasley who's using vmm

00:01:57,890 --> 00:02:07,520
vmd who's on open BSD Amsterdam yeah all

00:02:02,960 --> 00:02:10,189
right cool that's pretty good awesome so

00:02:07,520 --> 00:02:15,319
how did it all begin

00:02:10,189 --> 00:02:16,930
I was always using forms of segmentation

00:02:15,319 --> 00:02:18,670
or vert

00:02:16,930 --> 00:02:21,640
I'm always looking for something that

00:02:18,670 --> 00:02:22,330
was running on the Beasley's properly or

00:02:21,640 --> 00:02:25,420
useful

00:02:22,330 --> 00:02:28,360
so I'm started with jail still using

00:02:25,420 --> 00:02:32,170
jails I really like jails

00:02:28,360 --> 00:02:33,910
then came be high for me at least I do

00:02:32,170 --> 00:02:36,250
like beehive I think it's a little bit

00:02:33,910 --> 00:02:38,770
too complex so I was very happy when

00:02:36,250 --> 00:02:41,260
Mike started working on on vmm VMD and I

00:02:38,770 --> 00:02:45,190
just moved everything since I'm not

00:02:41,260 --> 00:02:49,030
running any Linux VMs anyway so that

00:02:45,190 --> 00:02:51,940
helped the other thing is what I noticed

00:02:49,030 --> 00:02:53,770
on my colocation site was that a lot of

00:02:51,940 --> 00:02:56,500
people were moving to the cloud so a lot

00:02:53,770 --> 00:02:59,140
of people would just leave remove their

00:02:56,500 --> 00:03:01,390
hardware so I had some rec space left I

00:02:59,140 --> 00:03:05,410
had some hardware left I had spare IP

00:03:01,390 --> 00:03:07,240
space ipv4 space I must say and I also

00:03:05,410 --> 00:03:09,640
always wanted to have a domain with

00:03:07,240 --> 00:03:11,260
something B is d and I think Hessler has

00:03:09,640 --> 00:03:12,340
taking a lot of the cool ones and

00:03:11,260 --> 00:03:15,010
probably some others here in the room

00:03:12,340 --> 00:03:16,870
okay and then dot answer damn came along

00:03:15,010 --> 00:03:20,470
okay maybe I can do something with

00:03:16,870 --> 00:03:22,360
OpenBSD dot Amsterdam so that and also

00:03:20,470 --> 00:03:25,570
wanted to find a way to actually

00:03:22,360 --> 00:03:28,570
contribute back to the community I'm not

00:03:25,570 --> 00:03:31,600
a C coder or coder that much I'm a

00:03:28,570 --> 00:03:33,340
spaghetti scriptor so I can get things

00:03:31,600 --> 00:03:38,019
done but not in a very structured

00:03:33,340 --> 00:03:39,790
fashion and I also wanted to see and and

00:03:38,019 --> 00:03:42,459
help out a little bit how far we can

00:03:39,790 --> 00:03:45,430
actually take this thing and where

00:03:42,459 --> 00:03:47,890
things were we're breaking so that's how

00:03:45,430 --> 00:03:49,840
it all started so on the on the right

00:03:47,890 --> 00:03:55,030
hand side you see picture of some of the

00:03:49,840 --> 00:03:56,769
machines that were using and domain for

00:03:55,030 --> 00:04:01,239
shits and giggles so I registered it

00:03:56,769 --> 00:04:04,360
last year in June and that's when the

00:04:01,239 --> 00:04:05,769
whole our paper actually and March and

00:04:04,360 --> 00:04:09,010
that's when the whole thing started

00:04:05,769 --> 00:04:12,130
kicking off so where is it it is in

00:04:09,010 --> 00:04:14,560
Amsterdam it's actually in a data center

00:04:12,130 --> 00:04:16,810
in Amsterdam I don't live there but all

00:04:14,560 --> 00:04:20,019
the hardware is there it's in the actual

00:04:16,810 --> 00:04:22,000
data center which is kpn these days and

00:04:20,019 --> 00:04:23,860
it's all running primarily on Dell are

00:04:22,000 --> 00:04:27,669
six tens connected to a foundry switch

00:04:23,860 --> 00:04:29,990
connected to a foundry router I work for

00:04:27,669 --> 00:04:33,470
foundry so I have a love relation

00:04:29,990 --> 00:04:37,250
ship with foundry I I get the CLI I've

00:04:33,470 --> 00:04:39,200
tried juniper doesn't really stick and I

00:04:37,250 --> 00:04:42,650
buy these things on on eBay so it

00:04:39,200 --> 00:04:44,780
doesn't really cost a lot of money so it

00:04:42,650 --> 00:04:46,220
started on Twitter I started talking a

00:04:44,780 --> 00:04:49,310
little bit with people on Twitter saying

00:04:46,220 --> 00:04:52,910
hey what can we do would you would you

00:04:49,310 --> 00:04:55,460
host a VM and the first machine I

00:04:52,910 --> 00:04:57,290
brought online which was some of the

00:04:55,460 --> 00:04:59,420
spare hardware that I had it's a box

00:04:57,290 --> 00:05:02,570
with with a gig of of RAM there's still

00:04:59,420 --> 00:05:03,770
some VMs running there and this was

00:05:02,570 --> 00:05:06,650
actually one of the first let's say

00:05:03,770 --> 00:05:08,150
official tweets that I send out and I

00:05:06,650 --> 00:05:11,330
also wanted to know what people were

00:05:08,150 --> 00:05:12,740
willing to pay so I sent out a poll on

00:05:11,330 --> 00:05:16,250
Twitter and say hey what are you willing

00:05:12,740 --> 00:05:18,170
to pay for a VM that looks like this so

00:05:16,250 --> 00:05:20,810
a lot of people are around the

00:05:18,170 --> 00:05:24,830
five-year-old losing euros five-year-old

00:05:20,810 --> 00:05:29,480
mark okay that's that's fine so started

00:05:24,830 --> 00:05:32,630
building VMs based on that so they're 5

00:05:29,480 --> 00:05:36,470
euros a month and of the donation or of

00:05:32,630 --> 00:05:41,720
the the yearly fee I donate 5 euros to

00:05:36,470 --> 00:05:45,260
the OpenBSD Foundation tenure sorry then

00:05:41,720 --> 00:05:47,150
I was able to get rid of some VMs that I

00:05:45,260 --> 00:05:49,760
was running on this machine that I

00:05:47,150 --> 00:05:52,070
brought online and this was actually the

00:05:49,760 --> 00:05:56,590
the machine that kick-started the whole

00:05:52,070 --> 00:06:00,590
thing and this was able to take 50 VMs

00:05:56,590 --> 00:06:03,200
on it and out of that came the first

00:06:00,590 --> 00:06:05,750
donation to the OpenBSD Foundation which

00:06:03,200 --> 00:06:08,870
I thought was really cool and we I was

00:06:05,750 --> 00:06:12,770
able to donate 400 euros based on the

00:06:08,870 --> 00:06:16,070
first I think first month of running

00:06:12,770 --> 00:06:19,160
this so a little bit of the statistics

00:06:16,070 --> 00:06:23,210
so you know where we where we are the

00:06:19,160 --> 00:06:27,790
last donation was three no 70 euros 850

00:06:23,210 --> 00:06:34,160
last year 1700s year-to-date total of

00:06:27,790 --> 00:06:36,560
3,500 euros I'm running eight hosts I

00:06:34,160 --> 00:06:40,550
still count the first one even though

00:06:36,560 --> 00:06:42,680
it's it's doesn't really I want to move

00:06:40,550 --> 00:06:43,760
them there's only ten VMs currently

00:06:42,680 --> 00:06:47,080
running on there

00:06:43,760 --> 00:06:50,930
but I still count it and there's roughly

00:06:47,080 --> 00:06:52,730
280 VM so we had some renewals already

00:06:50,930 --> 00:06:55,010
and what I'm seeing is that the amount

00:06:52,730 --> 00:06:56,840
of renewals are the amount of people

00:06:55,010 --> 00:06:59,540
that don't renew actually get

00:06:56,840 --> 00:07:02,810
replenished by people that get it VM so

00:06:59,540 --> 00:07:05,060
it's pretty stable and I really want to

00:07:02,810 --> 00:07:07,430
break through the 300 no idea why but

00:07:05,060 --> 00:07:11,450
it's this mental thing that I want to

00:07:07,430 --> 00:07:13,370
get so what do you get you get an

00:07:11,450 --> 00:07:15,080
opinionated VM if you've been on on the

00:07:13,370 --> 00:07:17,780
website that's what you what you see you

00:07:15,080 --> 00:07:21,890
get an opinionated VM so initially that

00:07:17,780 --> 00:07:24,620
mint and I decide the install sets and I

00:07:21,890 --> 00:07:25,310
pre configure a couple of things and

00:07:24,620 --> 00:07:27,800
it's running

00:07:25,310 --> 00:07:30,140
OpenBSD VM on open BSD I'm not gonna

00:07:27,800 --> 00:07:34,460
give you a Linux VM or anything else

00:07:30,140 --> 00:07:36,800
it's an open BSD VM now with 6.6 coming

00:07:34,460 --> 00:07:38,810
and sis upgrades I'm gonna let go of the

00:07:36,800 --> 00:07:40,310
install sets I'm just gonna install

00:07:38,810 --> 00:07:42,950
everything so you don't have any issues

00:07:40,310 --> 00:07:45,260
there I heard Theo yelling at a couple

00:07:42,950 --> 00:07:46,970
of people on are not heard saws Theo

00:07:45,260 --> 00:07:48,940
yelling on the mailing list if you want

00:07:46,970 --> 00:07:51,980
to I also asked that question

00:07:48,940 --> 00:07:54,770
to exclude certain sets from the sis

00:07:51,980 --> 00:07:58,520
upgrades a process anyone don't do that

00:07:54,770 --> 00:08:03,380
okay but when you actually get so you

00:07:58,520 --> 00:08:05,270
get 512 Meg of RAM 50 gig disks ipv4

00:08:03,380 --> 00:08:07,370
signed by a DHCP even though it's a

00:08:05,270 --> 00:08:10,490
static IP address that's assigned to

00:08:07,370 --> 00:08:13,430
your VM and you get an ipv6

00:08:10,490 --> 00:08:15,230
subnet slash 56 that is statically

00:08:13,430 --> 00:08:18,250
assigned during the whole install

00:08:15,230 --> 00:08:21,260
process and what I've noticed during

00:08:18,250 --> 00:08:24,260
doing this I'm very used to just assign

00:08:21,260 --> 00:08:27,710
my router as the gateway and so I

00:08:24,260 --> 00:08:30,080
started adding v6 addresses on the gate

00:08:27,710 --> 00:08:34,310
Wayne and all of a sudden well I cannot

00:08:30,080 --> 00:08:36,979
hold more any v6 routes that's annoying

00:08:34,310 --> 00:08:39,890
so what I started doing was actually the

00:08:36,979 --> 00:08:42,590
host is the Gateway for all the VMS in

00:08:39,890 --> 00:08:46,640
regards to v6 so if he four still goes

00:08:42,590 --> 00:08:50,090
to the router itself because all the VMS

00:08:46,640 --> 00:08:52,100
are in a slash 24 I'm thinking about

00:08:50,090 --> 00:08:53,750
changing it because I'm hitting some

00:08:52,100 --> 00:08:56,000
snags with bridge and I had some

00:08:53,750 --> 00:08:57,440
interesting discussions already with

00:08:56,000 --> 00:08:59,720
some people but that's something

00:08:57,440 --> 00:09:02,470
I'm considering or at least

00:08:59,720 --> 00:09:05,750
investigating if there's a way around it

00:09:02,470 --> 00:09:08,180
but personally I do like layer 2 it's

00:09:05,750 --> 00:09:12,650
Blake in the room sorry

00:09:08,180 --> 00:09:15,110
I do like layer 2 it's easy anyway so

00:09:12,650 --> 00:09:18,320
what does that this setup look like I

00:09:15,110 --> 00:09:22,520
try to use as much in base as possible

00:09:18,320 --> 00:09:26,950
so it does influence some of the design

00:09:22,520 --> 00:09:29,540
decisions that we've done that I've done

00:09:26,950 --> 00:09:34,280
so this is pretty much the list so I'm

00:09:29,540 --> 00:09:35,540
using Perl how I deploys I've written it

00:09:34,280 --> 00:09:38,600
deploy script in Perl

00:09:35,540 --> 00:09:42,800
I'm using VM MV MV of course the HPD

00:09:38,600 --> 00:09:46,940
ought to install site scripts during the

00:09:42,800 --> 00:09:50,750
auto install process HTTP to serve the

00:09:46,940 --> 00:09:52,490
sets and then sensors D and I mentioned

00:09:50,750 --> 00:09:54,050
it specifically because I figured

00:09:52,490 --> 00:09:56,930
something annoying out which I'll

00:09:54,050 --> 00:10:01,940
mention later to keep track of the of

00:09:56,930 --> 00:10:04,880
the disks primarily and of course VI so

00:10:01,940 --> 00:10:08,690
what I'm doing with Perl is I started

00:10:04,880 --> 00:10:10,820
with a very nasty script because when I

00:10:08,690 --> 00:10:14,210
when I announce hey you can now get a VM

00:10:10,820 --> 00:10:15,530
I had this this half-baked form and I

00:10:14,210 --> 00:10:17,840
had some information in there and I

00:10:15,530 --> 00:10:19,640
threw it in a file and I went ok so how

00:10:17,840 --> 00:10:21,350
do I actually get all these files

00:10:19,640 --> 00:10:24,650
instead of doing this manually so I

00:10:21,350 --> 00:10:26,120
built a really nasty perl script and yes

00:10:24,650 --> 00:10:27,590
you can debate if you came right nice

00:10:26,120 --> 00:10:31,040
pearl that's fine

00:10:27,590 --> 00:10:34,250
but what the perl script does it will

00:10:31,040 --> 00:10:37,420
maintain and create VM kampf it will

00:10:34,250 --> 00:10:41,210
maintain and create the HPD comp

00:10:37,420 --> 00:10:44,000
it creates an installer comb for every

00:10:41,210 --> 00:10:48,530
single VM so every VM is a fresh install

00:10:44,000 --> 00:10:50,510
it's not a clone of an image I've also

00:10:48,530 --> 00:10:54,140
noticed some other quirks so it also

00:10:50,510 --> 00:10:56,150
maintains do as cons now and it's

00:10:54,140 --> 00:11:00,290
responsible for the user creation as

00:10:56,150 --> 00:11:03,050
well as the the VM creation so as soon

00:11:00,290 --> 00:11:06,940
as I all these things happen and have

00:11:03,050 --> 00:11:08,870
some some flows how that how that works

00:11:06,940 --> 00:11:11,000
so the VM of kampf

00:11:08,870 --> 00:11:14,420
if you're familiar with it and I

00:11:11,000 --> 00:11:17,480
sign a switch a bridge I always assign

00:11:14,420 --> 00:11:19,129
an owner to a VM so you can connect to

00:11:17,480 --> 00:11:22,399
the console yourself you can stop it you

00:11:19,129 --> 00:11:25,819
can start it and you get a disk and I

00:11:22,399 --> 00:11:28,759
also assign a static MAC address that

00:11:25,819 --> 00:11:31,759
Perl script creates because with that I

00:11:28,759 --> 00:11:37,430
then assign the v4 address let's say

00:11:31,759 --> 00:11:39,589
statically the ditch PDF Kampf similar

00:11:37,430 --> 00:11:42,500
so I have that saying static MAC address

00:11:39,589 --> 00:11:46,670
I assign an IP address and I also say

00:11:42,500 --> 00:11:51,319
that it's now also install so as soon as

00:11:46,670 --> 00:11:54,680
I start I boot up that that VM I must

00:11:51,319 --> 00:11:57,529
say that when it's a new VM I also have

00:11:54,680 --> 00:12:00,529
a boot line here so it boots from BSD

00:11:57,529 --> 00:12:05,480
dot R T so then the auto install knows

00:12:00,529 --> 00:12:07,490
that it has to kick in then I have an

00:12:05,480 --> 00:12:10,129
auto install script for every single VM

00:12:07,490 --> 00:12:12,439
that I built again based on the MAC

00:12:10,129 --> 00:12:15,529
address so if you provide me which are

00:12:12,439 --> 00:12:17,689
your hostname I put that in and the v6

00:12:15,529 --> 00:12:21,050
addresses are signed your username that

00:12:17,689 --> 00:12:24,100
you provided your SSH key I cut and

00:12:21,050 --> 00:12:26,540
paste in there and then these sets here

00:12:24,100 --> 00:12:30,769
that will probably go away and this will

00:12:26,540 --> 00:12:33,259
be plus at plus sites start moving

00:12:30,769 --> 00:12:37,309
forward and because of that I have to do

00:12:33,259 --> 00:12:40,250
continue anyway yes verification yes so

00:12:37,309 --> 00:12:46,730
that's then what the VM is being being

00:12:40,250 --> 00:12:49,339
built on then I'm using site tgc and to

00:12:46,730 --> 00:12:50,959
actually do some pre configuration that

00:12:49,339 --> 00:12:53,689
makes it easier for you makes it easier

00:12:50,959 --> 00:12:56,689
for me so it sets the install URL to CD

00:12:53,689 --> 00:13:00,920
I'm not open BSD dot org and it also

00:12:56,689 --> 00:13:03,529
changes the the clock is it a format or

00:13:00,920 --> 00:13:10,639
a method or how do you call that clock

00:13:03,529 --> 00:13:16,160
the the hardware okay the source of the

00:13:10,639 --> 00:13:17,529
time counter of the current okay and the

00:13:16,160 --> 00:13:20,930
reason why we're doing this is because

00:13:17,529 --> 00:13:26,119
the default is i-83

00:13:20,930 --> 00:13:27,259
something-something okay cool so I'm

00:13:26,119 --> 00:13:30,730
selling this because there are some

00:13:27,259 --> 00:13:33,680
synchronization let's say challenges

00:13:30,730 --> 00:13:37,970
within the VM in regards to to the clock

00:13:33,680 --> 00:13:40,189
and then I said ntpd and also I turn off

00:13:37,970 --> 00:13:44,029
the sound daemon because well you don't

00:13:40,189 --> 00:13:47,959
really need it so that's in the in the

00:13:44,029 --> 00:13:49,939
site file then I'm using HTTP D on on

00:13:47,959 --> 00:13:54,379
one of my hosts you actually serve all

00:13:49,939 --> 00:13:58,100
the all the sets and every single host

00:13:54,379 --> 00:14:00,619
has an HTTP D running for the install

00:13:58,100 --> 00:14:04,569
files so every single host has its own

00:14:00,619 --> 00:14:07,100
little little world in regards to that

00:14:04,569 --> 00:14:09,529
the reason why I wanted to mention

00:14:07,100 --> 00:14:13,369
sensors is that a lot of the examples

00:14:09,529 --> 00:14:15,829
that you see you actually get like if

00:14:13,369 --> 00:14:20,089
disk fails then run this command in the

00:14:15,829 --> 00:14:22,730
sensor D Kampf I figured out luckily

00:14:20,089 --> 00:14:26,480
only one disk failed that that doesn't

00:14:22,730 --> 00:14:29,329
work you actually need to call a script

00:14:26,480 --> 00:14:31,790
out of sensor D in order to actually get

00:14:29,329 --> 00:14:33,649
any action out of it so I either an

00:14:31,790 --> 00:14:38,829
email that's being sent or whatever the

00:14:33,649 --> 00:14:41,660
action might be so I luckily caught it

00:14:38,829 --> 00:14:43,639
quite quickly as I was able to replace

00:14:41,660 --> 00:14:45,740
the disc without any problems but then I

00:14:43,639 --> 00:14:47,660
started digging into the whole sensor D

00:14:45,740 --> 00:14:50,959
in the config and and how that works so

00:14:47,660 --> 00:14:54,459
I so this is now the way that I'm using

00:14:50,959 --> 00:14:59,209
it so the command is on top sensory

00:14:54,459 --> 00:15:00,980
dot-com it calls a script with a bunch

00:14:59,209 --> 00:15:02,749
of parameters that are also there and

00:15:00,980 --> 00:15:05,689
then it sends me an email saying hey

00:15:02,749 --> 00:15:08,389
disk is OK at boot and when the disk

00:15:05,689 --> 00:15:13,309
fails it sends me disk is not ok so I

00:15:08,389 --> 00:15:16,699
know to to replace it so how do I

00:15:13,309 --> 00:15:19,519
actually deploy it's not fully automated

00:15:16,699 --> 00:15:23,299
there's still some manual steps that are

00:15:19,519 --> 00:15:26,119
there and currently that that works for

00:15:23,299 --> 00:15:28,249
me so as I mentioned every host has its

00:15:26,119 --> 00:15:30,679
own little world that it exists in so I

00:15:28,249 --> 00:15:34,670
have a configuration for a specific host

00:15:30,679 --> 00:15:37,730
so I define the prefix of a MAC address

00:15:34,670 --> 00:15:40,940
make a dress that they use IP address

00:15:37,730 --> 00:15:45,320
ipv6 address where all the the file

00:15:40,940 --> 00:15:48,290
should go and what default setup is for

00:15:45,320 --> 00:15:50,810
a VM so how much memory disk if it's one

00:15:48,290 --> 00:15:52,760
disc two disks what the image format is

00:15:50,810 --> 00:15:55,490
what bridge they they need to use or

00:15:52,760 --> 00:15:58,010
uplink need to use and so on so based on

00:15:55,490 --> 00:15:59,810
this I just have a single script that I

00:15:58,010 --> 00:16:01,430
copy to all the hosts and then based on

00:15:59,810 --> 00:16:03,610
the configuration it knows what to do

00:16:01,430 --> 00:16:06,740
and what the what the defaults are I

00:16:03,610 --> 00:16:09,940
thought it was a good idea at the time

00:16:06,740 --> 00:16:13,400
so the flow in itself is I have a

00:16:09,940 --> 00:16:15,350
contact form on our website so you put

00:16:13,400 --> 00:16:18,830
all your information in there that sends

00:16:15,350 --> 00:16:21,860
me an email in in rightly formatted I

00:16:18,830 --> 00:16:25,550
put that in a text file so I'll okay

00:16:21,860 --> 00:16:28,010
which VM ID is still available if it's

00:16:25,550 --> 00:16:30,200
full I take a different host and I paste

00:16:28,010 --> 00:16:34,490
that in and then I run the the deploy

00:16:30,200 --> 00:16:37,130
script I restart DCPD I reload VMD to

00:16:34,490 --> 00:16:40,910
actually take the new configuration and

00:16:37,130 --> 00:16:49,010
then I start the VM and I hit because

00:16:40,910 --> 00:16:50,630
pixie is not working and I think Philip

00:16:49,010 --> 00:16:53,720
does a whole talk about how he Peck

00:16:50,630 --> 00:16:55,700
Erised this but as I said I like to use

00:16:53,720 --> 00:16:57,500
a lot of things in base and and for me

00:16:55,700 --> 00:16:59,660
just hitting a and waiting for it to

00:16:57,500 --> 00:17:01,580
finish it's fine I can probably wrap it

00:16:59,660 --> 00:17:04,579
around expect or or do something else

00:17:01,580 --> 00:17:07,339
but it's for me this works and I don't

00:17:04,579 --> 00:17:11,060
have to deploy like tens or 20 PM's a

00:17:07,339 --> 00:17:13,220
days it's one or two max roughly in

00:17:11,060 --> 00:17:16,070
average so this was what the contact

00:17:13,220 --> 00:17:19,930
form looks like you can select if you

00:17:16,070 --> 00:17:24,050
want to have 512 and mega memory one gig

00:17:19,930 --> 00:17:25,850
how much disk space you need what the

00:17:24,050 --> 00:17:32,210
what the image format is I default now

00:17:25,850 --> 00:17:34,040
to kick your key cow to so that I save a

00:17:32,210 --> 00:17:38,180
little bit on on disk space especially

00:17:34,040 --> 00:17:39,650
if I move it and I'm based on this I put

00:17:38,180 --> 00:17:42,500
everything in the in the in the text

00:17:39,650 --> 00:17:45,950
file which roughly looks like this so

00:17:42,500 --> 00:17:47,390
it's just quoted text that I just push

00:17:45,950 --> 00:17:50,810
into Perl

00:17:47,390 --> 00:17:56,870
or that pro parses so that it knows what

00:17:50,810 --> 00:18:00,050
to do when and then run deploy deploy de

00:17:56,870 --> 00:18:03,080
piel it creates the the install file it

00:18:00,050 --> 00:18:04,850
creates a user creates the at least

00:18:03,080 --> 00:18:07,130
that's what I'm seeing it also doesn't

00:18:04,850 --> 00:18:08,600
do as in the DGP but these are the

00:18:07,130 --> 00:18:11,630
things that are most interested about if

00:18:08,600 --> 00:18:14,030
the the user it could be that the user

00:18:11,630 --> 00:18:16,460
existed already so then I have to fix

00:18:14,030 --> 00:18:19,220
that or something filled with the with

00:18:16,460 --> 00:18:21,140
the image creation and if you select

00:18:19,220 --> 00:18:24,080
that you want more disk space it will

00:18:21,140 --> 00:18:27,680
create two disks here or two images here

00:18:24,080 --> 00:18:29,780
and once the whole install is done I run

00:18:27,680 --> 00:18:35,570
it again and that script also removes

00:18:29,780 --> 00:18:37,850
the install dot-com file then I do VM

00:18:35,570 --> 00:18:40,550
control reloads I restart DCPD

00:18:37,850 --> 00:18:45,830
and then I start the VM and as I

00:18:40,550 --> 00:18:50,300
mentioned I hate hey so what did we find

00:18:45,830 --> 00:18:53,960
during this whole process one of the

00:18:50,300 --> 00:18:56,180
things is that very early on the owner

00:18:53,960 --> 00:18:58,160
of a VM always had to be in group wheel

00:18:56,180 --> 00:18:59,470
now personally I don't find that a

00:18:58,160 --> 00:19:02,060
problem there's there's this

00:18:59,470 --> 00:19:04,310
unauthorized section in the upgrade

00:19:02,060 --> 00:19:06,680
manual that says if you don't have

00:19:04,310 --> 00:19:08,750
access to the console you can do this we

00:19:06,680 --> 00:19:10,640
don't recommend it and then yeah people

00:19:08,750 --> 00:19:12,590
can just do that that's not a problem

00:19:10,640 --> 00:19:14,270
and then people weren't yeah no you

00:19:12,590 --> 00:19:16,540
cannot do this you have to have console

00:19:14,270 --> 00:19:20,540
and yada yadi so I meant okay

00:19:16,540 --> 00:19:24,770
right what can we do is there a way that

00:19:20,540 --> 00:19:26,660
I can define another user group or

00:19:24,770 --> 00:19:28,700
another group where I can assign users

00:19:26,660 --> 00:19:32,030
so that they these users can look at

00:19:28,700 --> 00:19:33,800
their VM instead of adding everybody to

00:19:32,030 --> 00:19:37,520
wheel which I thought was not a good

00:19:33,800 --> 00:19:40,100
idea so right thought that was a good

00:19:37,520 --> 00:19:43,610
idea and he really quickly managed to to

00:19:40,100 --> 00:19:46,100
put that in so from then on I used vmd

00:19:43,610 --> 00:19:49,190
underscore VM the users to put all the

00:19:46,100 --> 00:19:52,730
users in so they can actually control

00:19:49,190 --> 00:19:54,290
their own VM instead of asking me and

00:19:52,730 --> 00:19:55,820
the other thing that is quite

00:19:54,290 --> 00:19:57,410
interesting if you starting doing

00:19:55,820 --> 00:20:00,659
anything with with virtual machines is

00:19:57,410 --> 00:20:03,059
you need a tap interface by default and

00:20:00,659 --> 00:20:04,529
four so if you run more than four you

00:20:03,059 --> 00:20:05,999
need to create your tap interface and

00:20:04,529 --> 00:20:08,429
this this was initially a head-scratcher

00:20:05,999 --> 00:20:10,529
why is it not working because it wasn't

00:20:08,429 --> 00:20:13,169
really clear that it was failing on on

00:20:10,529 --> 00:20:16,169
an interface so on every new host that I

00:20:13,169 --> 00:20:19,200
deploy I run this this for loop and it

00:20:16,169 --> 00:20:22,099
just creates up to 50 tap interfaces so

00:20:19,200 --> 00:20:27,330
I always have enough because an average

00:20:22,099 --> 00:20:29,580
a host runs around 40 VMs because that's

00:20:27,330 --> 00:20:31,710
another thing that we that I discovered

00:20:29,580 --> 00:20:35,489
quite quickly is that if you especially

00:20:31,710 --> 00:20:38,700
on older hardware if you add more VMS

00:20:35,489 --> 00:20:44,759
weird things happen on this interface

00:20:38,700 --> 00:20:47,039
Bridge memory so on the Dell are 6/10 we

00:20:44,759 --> 00:20:51,119
are using only up to 40 VMS and that

00:20:47,039 --> 00:20:55,559
works reasonably well another thing is

00:20:51,119 --> 00:20:57,299
people were supplying me with a SSH key

00:20:55,559 --> 00:20:59,039
but I didn't want to send them a

00:20:57,299 --> 00:21:03,419
password over email saying hey this is

00:20:59,039 --> 00:21:05,279
your root password I one way that I

00:21:03,419 --> 00:21:07,499
wanted to do this and from an automation

00:21:05,279 --> 00:21:11,070
perspective is I wanted to do with this

00:21:07,499 --> 00:21:13,789
during the the auto install so what I've

00:21:11,070 --> 00:21:17,519
been doing is actually I generate a

00:21:13,789 --> 00:21:20,009
random password with jot Thank You Roman

00:21:17,519 --> 00:21:22,190
for that and then I add it to the

00:21:20,009 --> 00:21:24,599
authorized keys at the end as a comment

00:21:22,190 --> 00:21:26,639
so that as soon as you log in with your

00:21:24,599 --> 00:21:28,919
SSH key you just look into that file and

00:21:26,639 --> 00:21:31,379
you have your root password and the

00:21:28,919 --> 00:21:32,940
password of your user and I thought it

00:21:31,379 --> 00:21:35,669
was clever I was very happy to see that

00:21:32,940 --> 00:21:40,710
right also thought it was clever so he

00:21:35,669 --> 00:21:45,570
borrowed that idea but there's probably

00:21:40,710 --> 00:21:47,460
and this also started before do as was

00:21:45,570 --> 00:21:51,210
there because now you could also

00:21:47,460 --> 00:21:54,119
potentially say well this user gets set

00:21:51,210 --> 00:21:56,099
up and to do as with a no pass and then

00:21:54,119 --> 00:21:57,659
you can do whatever you want so that

00:21:56,099 --> 00:22:02,909
would be another way that I would

00:21:57,659 --> 00:22:05,849
probably maybe do that today another

00:22:02,909 --> 00:22:09,359
thing was in the beginning was stopping

00:22:05,849 --> 00:22:11,519
VMs was a little bit of an issue if you

00:22:09,359 --> 00:22:13,789
stopped everything in one go it's not a

00:22:11,519 --> 00:22:16,159
good idea and so I was trying to

00:22:13,789 --> 00:22:20,869
actually immolate like like normal

00:22:16,159 --> 00:22:23,359
shutdown so what I've done is I parsed

00:22:20,869 --> 00:22:25,429
VM control through a for loop with arc

00:22:23,359 --> 00:22:28,279
looking at all the machines that were

00:22:25,429 --> 00:22:30,350
started and then would stop them and

00:22:28,279 --> 00:22:33,019
wait for 30 seconds to stop the other

00:22:30,350 --> 00:22:37,519
one and now you can just do that with VM

00:22:33,019 --> 00:22:39,950
control stop a W so it would stop all

00:22:37,519 --> 00:22:42,470
and it will wait for that VM to be

00:22:39,950 --> 00:22:44,690
stopped in most cases that works really

00:22:42,470 --> 00:22:46,340
really well

00:22:44,690 --> 00:22:49,009
another interesting challenge is

00:22:46,340 --> 00:22:50,359
actually starting VMs so I'm doing

00:22:49,009 --> 00:22:53,929
something similar but instead of using

00:22:50,359 --> 00:22:55,909
stop I'm using start when it was a clean

00:22:53,929 --> 00:23:00,279
shutdown of the host I use thirty

00:22:55,909 --> 00:23:03,080
seconds if it crashed I use 90 or more

00:23:00,279 --> 00:23:07,759
because what is really bad is if you

00:23:03,080 --> 00:23:10,220
have two worse more VMs that are going

00:23:07,759 --> 00:23:12,559
through an FS check that will slow

00:23:10,220 --> 00:23:15,759
things down dramatically and it's not

00:23:12,559 --> 00:23:20,210
pleasant for the VMS that have started

00:23:15,759 --> 00:23:23,509
so I do hopefully I can see if it was a

00:23:20,210 --> 00:23:27,499
clean shutdown or not but then when it

00:23:23,509 --> 00:23:30,499
wasn't not I used 90 seconds and another

00:23:27,499 --> 00:23:33,200
interesting one especially in the

00:23:30,499 --> 00:23:36,799
beginning I saw that a lot of VMs were

00:23:33,200 --> 00:23:38,320
were disappearing so they would have

00:23:36,799 --> 00:23:42,859
connectivity and then all of a sudden

00:23:38,320 --> 00:23:46,220
connectivity would go away or you could

00:23:42,859 --> 00:23:49,879
not reach it anymore and so I cloudy

00:23:46,220 --> 00:23:54,529
appointed me to our queue sysctl

00:23:49,879 --> 00:23:56,779
and that by default sits on 50 now in

00:23:54,529 --> 00:23:59,239
normal environments and just for your

00:23:56,779 --> 00:24:02,090
machine in a layer 2 network it's not

00:23:59,239 --> 00:24:06,859
usually a big of a problem but since I'm

00:24:02,090 --> 00:24:09,379
pushing a slash 24 onto a host with 40

00:24:06,859 --> 00:24:13,849
VMs that becomes a little bit of a

00:24:09,379 --> 00:24:15,769
problem so we saw a lot of drops and I

00:24:13,849 --> 00:24:18,649
started playing a little bit with the

00:24:15,769 --> 00:24:22,399
numbers I've started with 512 and I

00:24:18,649 --> 00:24:25,909
still had drops I did 756 still had

00:24:22,399 --> 00:24:28,040
drops so I increase it to 2024 and and

00:24:25,909 --> 00:24:30,530
it seemed that that is

00:24:28,040 --> 00:24:35,630
a lot of the connectivity issues that

00:24:30,530 --> 00:24:37,160
we've been noticing so what our users

00:24:35,630 --> 00:24:39,380
experiencing because this is a little

00:24:37,160 --> 00:24:41,960
bit on the on the side that I've been

00:24:39,380 --> 00:24:44,150
stumbling into things but on the user

00:24:41,960 --> 00:24:47,390
side there's of course also quirks and

00:24:44,150 --> 00:24:51,550
things that we had to get used to so in

00:24:47,390 --> 00:24:55,040
some cases and this all depends on how

00:24:51,550 --> 00:24:57,140
or how the VM boots and what stage it

00:24:55,040 --> 00:25:00,650
boots and what was happening on the host

00:24:57,140 --> 00:25:04,550
but sometimes the the VM gets a little

00:25:00,650 --> 00:25:07,130
bit skewed from the clock Hertz of the

00:25:04,550 --> 00:25:10,190
host and when that is a little bit off

00:25:07,130 --> 00:25:14,750
you get a lot of clock drift within the

00:25:10,190 --> 00:25:17,180
VM so one way and and the way that that

00:25:14,750 --> 00:25:20,180
that Paul is fixing this is he looks at

00:25:17,180 --> 00:25:22,580
the the clock drift of the VM and if

00:25:20,180 --> 00:25:25,070
it's too far it just reboots the Machine

00:25:22,580 --> 00:25:28,460
to see if it's a little bit closer now

00:25:25,070 --> 00:25:30,010
with 40 VMs or 50 and I thought that was

00:25:28,460 --> 00:25:33,280
not such a good idea

00:25:30,010 --> 00:25:36,740
so I fixed it like very rudimentary

00:25:33,280 --> 00:25:40,280
where I suggest people just to put our

00:25:36,740 --> 00:25:44,000
date in in cron in general this works

00:25:40,280 --> 00:25:47,180
well some VMs have to screw this a

00:25:44,000 --> 00:25:49,880
little bit lower and I have one user

00:25:47,180 --> 00:25:50,480
running Alpine and he's just yeah he's

00:25:49,880 --> 00:25:52,100
on his own

00:25:50,480 --> 00:25:57,500
you have to yes the sink is clogged

00:25:52,100 --> 00:25:59,390
every every second another thing is that

00:25:57,500 --> 00:26:02,660
I got a lot of questions about was

00:25:59,390 --> 00:26:05,360
there's a high interrupt the CPU within

00:26:02,660 --> 00:26:08,030
the VM and I have a page on the website

00:26:05,360 --> 00:26:12,620
with all the known let's say challenges

00:26:08,030 --> 00:26:14,780
issues and this is so I'm using some of

00:26:12,620 --> 00:26:17,300
the information that might gave me it's

00:26:14,780 --> 00:26:19,160
like an accounting error but I did get

00:26:17,300 --> 00:26:21,770
some question oh hey what's going on I

00:26:19,160 --> 00:26:23,330
don't have anything started it's

00:26:21,770 --> 00:26:25,850
something wrong with the host so I

00:26:23,330 --> 00:26:28,610
started compiling that list of things

00:26:25,850 --> 00:26:30,980
and there's also links in my

00:26:28,610 --> 00:26:33,590
presentation that point to explanations

00:26:30,980 --> 00:26:41,030
of my core rike about some of the things

00:26:33,590 --> 00:26:44,130
that we've seen so when I

00:26:41,030 --> 00:26:46,650
managed to figure out this RQ thing a

00:26:44,130 --> 00:26:49,560
lot of the connectivity problems went

00:26:46,650 --> 00:26:53,580
away and it was great and then all of a

00:26:49,560 --> 00:26:55,560
sudden on a Friday no idea why I started

00:26:53,580 --> 00:26:57,690
getting connectivity issues again and it

00:26:55,560 --> 00:27:00,750
wasn't just one host it was all of them

00:26:57,690 --> 00:27:02,760
including my own without not too many

00:27:00,750 --> 00:27:06,030
VMs running and I've been scratching my

00:27:02,760 --> 00:27:09,690
head since but one great way of fixing

00:27:06,030 --> 00:27:12,120
this is just either ping from Chrome so

00:27:09,690 --> 00:27:15,840
the tricky is the tricky part is that as

00:27:12,120 --> 00:27:19,050
soon as it's it's gone you have to start

00:27:15,840 --> 00:27:22,110
some connectivity from within the VM to

00:27:19,050 --> 00:27:24,330
the outside world so the way that you

00:27:22,110 --> 00:27:26,550
can do that is either do it in cron

00:27:24,330 --> 00:27:30,120
every five minutes and but at the moment

00:27:26,550 --> 00:27:32,190
it's it's pretty bad that that doesn't

00:27:30,120 --> 00:27:34,770
even help anymore so what I've started

00:27:32,190 --> 00:27:38,250
doing was just starting Tmax with ping -

00:27:34,770 --> 00:27:41,220
I - my gateway and for now that seems to

00:27:38,250 --> 00:27:44,840
solve the problem a little bit but

00:27:41,220 --> 00:27:44,840
that's yeah that's a head-scratcher

00:27:45,920 --> 00:27:52,830
another thing that we've seen is a VM

00:27:50,250 --> 00:27:54,660
can become unresponsive so nothing to do

00:27:52,830 --> 00:27:57,710
with connectivity and but it would

00:27:54,660 --> 00:28:00,990
either consume a lot of CPU resources

00:27:57,710 --> 00:28:03,870
and the theme control stop would not

00:28:00,990 --> 00:28:07,380
work it would just be hanging in in in

00:28:03,870 --> 00:28:10,590
stopping mode so every once in a while

00:28:07,380 --> 00:28:13,170
if I see it I fix it for for for the

00:28:10,590 --> 00:28:15,540
user but sometimes I get an email from

00:28:13,170 --> 00:28:17,520
someone say hey I cannot reach my VM can

00:28:15,540 --> 00:28:20,490
you do something and ok so I need to

00:28:17,520 --> 00:28:22,860
figure out a way that that user

00:28:20,490 --> 00:28:25,370
they can run VM control stop but they

00:28:22,860 --> 00:28:29,910
should also be able to just kill that

00:28:25,370 --> 00:28:32,730
and I thought about doing something with

00:28:29,910 --> 00:28:36,390
kill and then you go okay yeah root and

00:28:32,730 --> 00:28:39,600
then do as so the way that I worked

00:28:36,390 --> 00:28:41,820
around it was with P kill because what

00:28:39,600 --> 00:28:44,750
you can do you can actually define the

00:28:41,820 --> 00:28:49,830
let's say the string or the process

00:28:44,750 --> 00:28:52,040
specifically that you can kill so that's

00:28:49,830 --> 00:28:53,830
why I said the Perl script now also

00:28:52,040 --> 00:28:57,610
manages do ask

00:28:53,830 --> 00:28:59,740
Kampf so this part is in induced

00:28:57,610 --> 00:29:02,110
configuration and this is then what you

00:28:59,740 --> 00:29:06,309
can use and run as a user so you can

00:29:02,110 --> 00:29:09,220
just kill your own VM if need be because

00:29:06,309 --> 00:29:12,309
I have all that information and I think

00:29:09,220 --> 00:29:14,350
some people have already used it so my

00:29:12,309 --> 00:29:17,200
wish list but I would like to see in the

00:29:14,350 --> 00:29:21,580
in the future is working PXE that will

00:29:17,200 --> 00:29:23,649
save me from hitting a less clock drift

00:29:21,580 --> 00:29:27,610
no clock drift there's there's things

00:29:23,649 --> 00:29:29,440
that are that are possible there another

00:29:27,610 --> 00:29:32,139
thing that I would like to do is move

00:29:29,440 --> 00:29:35,350
away from from bridge so either looking

00:29:32,139 --> 00:29:36,789
at switch or layer 3 and we had some

00:29:35,350 --> 00:29:39,880
interesting discussions already in the

00:29:36,789 --> 00:29:41,350
last couple of days around that one of

00:29:39,880 --> 00:29:43,419
the things that I would like to do is

00:29:41,350 --> 00:29:45,730
automate more so the whole flow of

00:29:43,419 --> 00:29:49,179
getting that email putting it into a

00:29:45,730 --> 00:29:52,149
file starting the VM I would like to do

00:29:49,179 --> 00:29:55,419
that more automated so I can get that VM

00:29:52,149 --> 00:29:59,830
deployed a lot quicker and I really want

00:29:55,419 --> 00:30:04,000
to hit that 300 just for my own fun I

00:29:59,830 --> 00:30:06,370
would say so I do want to thank a couple

00:30:04,000 --> 00:30:09,340
of people because I could not do this

00:30:06,370 --> 00:30:11,799
without especially Mike and Reich and

00:30:09,340 --> 00:30:15,669
Carlos and Stefan and Claudio and Jasper

00:30:11,799 --> 00:30:19,720
and Ori so these are the main committers

00:30:15,669 --> 00:30:21,070
and contributors to vm m vm d and we

00:30:19,720 --> 00:30:23,710
figured out yesterday that there's

00:30:21,070 --> 00:30:26,830
around 47 people that actually made

00:30:23,710 --> 00:30:28,779
commits to vm m vm d so that's that's

00:30:26,830 --> 00:30:33,789
quite impressive and I also want to

00:30:28,779 --> 00:30:37,769
thank Roman for the artwork for pushing

00:30:33,789 --> 00:30:40,059
for helping for getting the word out

00:30:37,769 --> 00:30:43,690
wearing the t-shirt together with rykon

00:30:40,059 --> 00:30:46,539
so and and and fred and of course you

00:30:43,690 --> 00:30:48,940
the users that are actually getting a vm

00:30:46,539 --> 00:30:53,070
on on the platform and see how far we

00:30:48,940 --> 00:30:56,549
can drive this thing so that is my talk

00:30:53,070 --> 00:30:56,549
thank you very much

00:31:00,890 --> 00:31:08,340
and this is without background image so

00:31:04,950 --> 00:31:11,370
it's a little bit easier to read any

00:31:08,340 --> 00:31:13,710
questions this one's dead

00:31:11,370 --> 00:31:14,940
oh no it's okay if there's any questions

00:31:13,710 --> 00:31:19,049
of microphones right up here and also

00:31:14,940 --> 00:31:21,590
have or suggestions or feedback or say

00:31:19,049 --> 00:31:26,460
hey this is stupid

00:31:21,590 --> 00:31:29,880
don't do this not too many though hello

00:31:26,460 --> 00:31:33,150
I thank you for the talk what this do

00:31:29,880 --> 00:31:36,419
you have you considered giving a prefix

00:31:33,150 --> 00:31:39,230
to a VM or I have seen in the config

00:31:36,419 --> 00:31:43,710
that you are basically giving a VN one

00:31:39,230 --> 00:31:49,620
ipv6 address no prefix a prefix and is

00:31:43,710 --> 00:31:52,410
it / 64 or 56 yeah but that's to the

00:31:49,620 --> 00:31:54,419
host the student not to the VM no that's

00:31:52,410 --> 00:31:57,960
to the VM oh okay okay

00:31:54,419 --> 00:32:02,120
yes generous and I do of course generate

00:31:57,960 --> 00:32:10,429
already it / 28 but the host has a 56

00:32:02,120 --> 00:32:10,429
okay sorry p.m. p.m. yes host has 40 56

00:32:10,640 --> 00:32:13,640
prefixes

00:32:16,280 --> 00:32:23,270
I did do have an a private network

00:32:19,820 --> 00:32:26,600
options or do you think about adding the

00:32:23,270 --> 00:32:29,660
possibility of building of a PC for our

00:32:26,600 --> 00:32:34,400
customer to have two VMs in a private

00:32:29,660 --> 00:32:38,390
network it's yeah I I thought about that

00:32:34,400 --> 00:32:42,170
I had of all the people that are running

00:32:38,390 --> 00:32:45,350
VM I had that question once I also had

00:32:42,170 --> 00:32:47,900
that question if there could be two VMs

00:32:45,350 --> 00:32:50,120
active standby active active so I've

00:32:47,900 --> 00:32:53,180
been thinking about either adding a

00:32:50,120 --> 00:32:58,270
second interface or adding a sacred

00:32:53,180 --> 00:33:01,280
network segment so I can run car or

00:32:58,270 --> 00:33:03,170
thinking about it but the nice thing is

00:33:01,280 --> 00:33:06,220
not a lot of people asked for it so I

00:33:03,170 --> 00:33:06,220
don't have to think about it too hard

00:33:08,710 --> 00:33:15,170
yes

00:33:10,580 --> 00:33:18,170
so any plans to whoops any plans to add

00:33:15,170 --> 00:33:19,970
any other locations like new data

00:33:18,170 --> 00:33:24,410
centers or anything I don't have to

00:33:19,970 --> 00:33:27,050
domain so no it's the nice thing is I

00:33:24,410 --> 00:33:28,610
think someone said hey this is a great

00:33:27,050 --> 00:33:30,140
idea I want to do this in London and

00:33:28,610 --> 00:33:32,840
then he worked on the numbers and he

00:33:30,140 --> 00:33:35,270
went oh I cannot really do this and

00:33:32,840 --> 00:33:37,880
benefit that I have is since I do

00:33:35,270 --> 00:33:42,620
hosting and colocation I have Rackspace

00:33:37,880 --> 00:33:45,440
I have IP space I have traffic so a lot

00:33:42,620 --> 00:33:48,230
of the costs are already carried by my

00:33:45,440 --> 00:33:52,370
own company otherwise this would not

00:33:48,230 --> 00:33:55,610
really be a variable business model with

00:33:52,370 --> 00:33:58,700
only five year old VMs you don't have to

00:33:55,610 --> 00:34:00,320
also do like the the the the 20 year old

00:33:58,700 --> 00:34:03,710
a month VMs then then it could

00:34:00,320 --> 00:34:05,390
potentially work but I think what I but

00:34:03,710 --> 00:34:08,149
I personally like about the product it's

00:34:05,390 --> 00:34:10,370
it's it's community from the community

00:34:08,149 --> 00:34:11,780
for the community so I I don't make any

00:34:10,370 --> 00:34:14,929
money of this I don't want to make any

00:34:11,780 --> 00:34:18,050
money it is it's it's self-sustaining to

00:34:14,929 --> 00:34:20,270
an extent I guess and because of all the

00:34:18,050 --> 00:34:22,850
money that that came out of a out of a

00:34:20,270 --> 00:34:25,790
host I bought the new server and then

00:34:22,850 --> 00:34:27,830
that machine bought for or paid for the

00:34:25,790 --> 00:34:29,770
the other machine so it's it's it's

00:34:27,830 --> 00:34:31,480
self-sustaining

00:34:29,770 --> 00:34:34,359
and I think in adding a new location

00:34:31,480 --> 00:34:37,389
regardless where that would be probably

00:34:34,359 --> 00:34:39,780
would not work economically okay

00:34:37,389 --> 00:34:47,770
thank you again for a great service

00:34:39,780 --> 00:34:53,819
you're welcome so these this is a bit

00:34:47,770 --> 00:34:57,520
like testbed for the technology right

00:34:53,819 --> 00:34:59,349
that's how it started there there's

00:34:57,520 --> 00:35:01,300
there's a disclaimer there that that

00:34:59,349 --> 00:35:07,480
it's it's an active development things

00:35:01,300 --> 00:35:09,339
break but people don't read so there's

00:35:07,480 --> 00:35:12,069
also DNS running in there and there's

00:35:09,339 --> 00:35:14,290
email environments running in there so

00:35:12,069 --> 00:35:16,569
there's I think there's even some people

00:35:14,290 --> 00:35:21,550
that are running production type

00:35:16,569 --> 00:35:24,790
services on this and I go okay it's

00:35:21,550 --> 00:35:27,809
great so no but yeah one to five scale

00:35:24,790 --> 00:35:34,329
for let's say if someone is more

00:35:27,809 --> 00:35:36,640
interested in okay AWS doesn't support

00:35:34,329 --> 00:35:39,069
officially open BSD and here is someone

00:35:36,640 --> 00:35:43,119
who gives a really nice environment for

00:35:39,069 --> 00:35:47,040
this then from one to five how would you

00:35:43,119 --> 00:35:51,369
rate the production readiness of this

00:35:47,040 --> 00:35:56,109
enterprise I would say try it and then

00:35:51,369 --> 00:35:58,839
if you like it pay it I I've run all my

00:35:56,109 --> 00:36:01,839
production environment in in vmm and VMD

00:35:58,839 --> 00:36:04,270
as well I I suffer from some of the

00:36:01,839 --> 00:36:07,450
quirks that the whole platform is

00:36:04,270 --> 00:36:10,599
suffering from but for me it works right

00:36:07,450 --> 00:36:12,369
because my own company is also a hobby

00:36:10,599 --> 00:36:16,450
project I don't have to make a lot of

00:36:12,369 --> 00:36:18,220
money out of it but if especially if you

00:36:16,450 --> 00:36:21,549
do something with payments I would not

00:36:18,220 --> 00:36:24,540
do that if it's a website or a forum or

00:36:21,549 --> 00:36:26,140
or internal communication platform

00:36:24,540 --> 00:36:28,180
probably yeah

00:36:26,140 --> 00:36:30,010
there's ways around you to work around

00:36:28,180 --> 00:36:31,559
connectivity issues that that's not

00:36:30,010 --> 00:36:35,200
really a problem

00:36:31,559 --> 00:36:37,059
do you collect some data about the let's

00:36:35,200 --> 00:36:39,490
say average up times of these VMs

00:36:37,059 --> 00:36:41,770
because you said they can become

00:36:39,490 --> 00:36:43,000
unresponsive or stuff like that so I

00:36:41,770 --> 00:36:46,390
don't know if the emcee

00:36:43,000 --> 00:36:48,580
tl shows they turn like this but maybe

00:36:46,390 --> 00:36:54,580
you could do some nice graphs or

00:36:48,580 --> 00:36:57,190
whatever so if I get a lead any

00:36:54,580 --> 00:36:59,190
telemetry out of the VMS uptime and

00:36:57,190 --> 00:37:04,870
things like that

00:36:59,190 --> 00:37:09,430
no I don't I do get some telemetry out

00:37:04,870 --> 00:37:13,030
of the hosts in regards to cpu load and

00:37:09,430 --> 00:37:15,220
and traffic but nothing on on individual

00:37:13,030 --> 00:37:17,290
VMs uptime that that's that's an

00:37:15,220 --> 00:37:20,890
interesting one yeah yeah

00:37:17,290 --> 00:37:25,180
so Martin what time let's get cracking

00:37:20,890 --> 00:37:28,270
on age and X thank you sure five minutes

00:37:25,180 --> 00:37:32,950
I have some questions for you about to

00:37:28,270 --> 00:37:35,830
sing okay no no not really I'm just want

00:37:32,950 --> 00:37:41,320
to make a statement here because like

00:37:35,830 --> 00:37:43,750
whenever does VMD vmm sing started when

00:37:41,320 --> 00:37:46,120
when mike shocked me the first lines of

00:37:43,750 --> 00:37:49,060
the message and back in a bar in berlin

00:37:46,120 --> 00:37:51,700
at some point i think i was thinking it

00:37:49,060 --> 00:37:55,390
would be so nice and excuse me for the

00:37:51,700 --> 00:37:59,190
word to have some cloud kind of singer

00:37:55,390 --> 00:38:02,470
that runs on an open yeasty hypervisor

00:37:59,190 --> 00:38:06,550
because all this cloud stuff is

00:38:02,470 --> 00:38:08,920
unavoidable these days and reported

00:38:06,550 --> 00:38:10,900
OpenBSD to most of these platforms and

00:38:08,920 --> 00:38:15,880
then you still run on a shitty linux or

00:38:10,900 --> 00:38:19,030
well maybe enough freebsd but it if i

00:38:15,880 --> 00:38:21,100
cannot trust the hypervisor when is it

00:38:19,030 --> 00:38:24,370
and then but not just doing this for

00:38:21,100 --> 00:38:27,520
testing really run a cloud like platform

00:38:24,370 --> 00:38:31,330
or opinionated VMs or something like

00:38:27,520 --> 00:38:34,090
this and then later you just showed up

00:38:31,330 --> 00:38:36,100
and did it and it helps us so much

00:38:34,090 --> 00:38:39,760
because of these things I mean these

00:38:36,100 --> 00:38:42,430
features we get many feature requests

00:38:39,760 --> 00:38:44,470
for things that are weird or pointless

00:38:42,430 --> 00:38:48,430
but from you it it really helps moving

00:38:44,470 --> 00:38:51,430
forward and so we need more projects

00:38:48,430 --> 00:38:54,670
like this really we need people who

00:38:51,430 --> 00:38:57,910
whatever do something similar and

00:38:54,670 --> 00:39:00,819
deploying vgp routers for mobility or

00:38:57,910 --> 00:39:04,569
whatever just doing something like this

00:39:00,819 --> 00:39:06,699
and and then actually you're the one who

00:39:04,569 --> 00:39:10,329
proved that you can't run the stuff in

00:39:06,699 --> 00:39:12,939
production to us developers as well as

00:39:10,329 --> 00:39:15,099
amazing so my my kudos for this year

00:39:12,939 --> 00:39:17,259
public thank you solutely so

00:39:15,099 --> 00:39:20,249
economically it's a great way to do this

00:39:17,259 --> 00:39:20,249
do this in other cities

00:39:21,509 --> 00:39:31,839
Thanks right hi do you use or would you

00:39:27,009 --> 00:39:37,329
use VMs open BSD VMs on other people's

00:39:31,839 --> 00:39:40,949
computers as a user would I use vmm on

00:39:37,329 --> 00:39:40,949
other people's computer what do you mean

00:39:41,939 --> 00:39:50,439
you have users that use them would you

00:39:45,400 --> 00:39:53,709
or do you personally use VMs which are

00:39:50,439 --> 00:39:54,430
hosted on computers controlled by other

00:39:53,709 --> 00:39:57,939
people

00:39:54,430 --> 00:40:00,640
I actually I don't I don't host I don't

00:39:57,939 --> 00:40:02,469
know any other environment where you can

00:40:00,640 --> 00:40:09,339
do that where you can actually have a VM

00:40:02,469 --> 00:40:11,140
on OpenBSD vm m somewhere else would you

00:40:09,339 --> 00:40:15,969
actively use it depends how much it is

00:40:11,140 --> 00:40:19,599
if it was free yeah sure okay I'm touch

00:40:15,969 --> 00:40:24,039
of course free okay and another question

00:40:19,599 --> 00:40:27,279
about virtualization open BSD was up

00:40:24,039 --> 00:40:29,469
until a few years ago completely against

00:40:27,279 --> 00:40:31,929
any kind ritualization

00:40:29,469 --> 00:40:33,719
and even then you know you need some

00:40:31,929 --> 00:40:37,869
kind of continuity

00:40:33,719 --> 00:40:41,829
contiune say ssin if you run it on your

00:40:37,869 --> 00:40:44,859
own hosts you own but now we see the the

00:40:41,829 --> 00:40:47,949
OpenBSD moving in another direction and

00:40:44,859 --> 00:40:50,500
you know hosting providing VMs can you

00:40:47,949 --> 00:40:53,350
explain a big change in the

00:40:50,500 --> 00:40:58,380
the politics that would not really be a

00:40:53,350 --> 00:41:01,600
question I can answer but Mike maybe

00:40:58,380 --> 00:41:05,370
started turning it off and on again the

00:41:01,600 --> 00:41:08,050
whole topic of how vmm DMD started is

00:41:05,370 --> 00:41:09,580
probably a topic that they talked that

00:41:08,050 --> 00:41:10,810
we should have later because we're

00:41:09,580 --> 00:41:12,850
almost out of time and it's going to

00:41:10,810 --> 00:41:14,140
take much longer than two minutes but

00:41:12,850 --> 00:41:15,340
I'm happy to have that conversation with

00:41:14,140 --> 00:41:16,390
you or indeed anybody that's in

00:41:15,340 --> 00:41:18,430
attendance and you'd like to know more

00:41:16,390 --> 00:41:20,680
about the platform how we built it what

00:41:18,430 --> 00:41:22,000
our goals were the history around it I'm

00:41:20,680 --> 00:41:24,340
absolutely happy to do that just find me

00:41:22,000 --> 00:41:27,250
later later today tomorrow I'll be

00:41:24,340 --> 00:41:29,140
around but it probably will take more

00:41:27,250 --> 00:41:30,190
time than what we have now so I'm happy

00:41:29,140 --> 00:41:31,450
to talk about it later

00:41:30,190 --> 00:41:37,630
and there's some good talks already

00:41:31,450 --> 00:41:40,140
online that you did yep one more this is

00:41:37,630 --> 00:41:42,310
not not really related to the OpenBSD

00:41:40,140 --> 00:41:45,190
vmm part of things but do you do

00:41:42,310 --> 00:41:48,180
anything with do you do anything were

00:41:45,190 --> 00:41:50,800
through with reverse DNS either v4 v6

00:41:48,180 --> 00:41:55,360
sorry so you can do you do anything with

00:41:50,800 --> 00:41:56,890
reverse DNS absolutely yes I need to

00:41:55,360 --> 00:41:59,890
because there's people running their

00:41:56,890 --> 00:42:06,010
mill environment on OPA museums to them

00:41:59,890 --> 00:42:09,340
so yes yeah not by default that can be

00:42:06,010 --> 00:42:11,950
something that I'm considering but

00:42:09,340 --> 00:42:14,320
currently it's just fire off an email or

00:42:11,950 --> 00:42:16,240
put it in the note field in the contact

00:42:14,320 --> 00:42:19,030
form say just put reverse DNS to this

00:42:16,240 --> 00:42:20,530
domain and I'll I'll fix it it's it's

00:42:19,030 --> 00:42:23,800
not a big deal but not a lot of people

00:42:20,530 --> 00:42:25,840
actually request it yeah yes exactly

00:42:23,800 --> 00:42:29,110
that's what's my reaction as well why

00:42:25,840 --> 00:42:31,810
not but yeah Oh actually I have someone

00:42:29,110 --> 00:42:33,220
that doesn't have a domain so they they

00:42:31,810 --> 00:42:35,560
said yeah I know I want to do something

00:42:33,220 --> 00:42:38,800
with mail but I don't have a domain okay

00:42:35,560 --> 00:42:41,880
I can give you a host on on up museums

00:42:38,800 --> 00:42:45,220
now oh great let's encrypt on so yeah

00:42:41,880 --> 00:42:47,170
that's also an option you colder you can

00:42:45,220 --> 00:42:50,380
also have a host name dot OpenBSD

00:42:47,170 --> 00:42:54,060
Amsterdam I would be happy to reverse

00:42:50,380 --> 00:42:56,480
that in to your VM as well not a problem

00:42:54,060 --> 00:43:05,420
thank you very much thank you

00:42:56,480 --> 00:43:05,420
[Applause]

00:43:10,589 --> 00:43:12,650

YouTube URL: https://www.youtube.com/watch?v=9TuWCR9X-wY


