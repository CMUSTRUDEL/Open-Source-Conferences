Title: Location Services and Direction Finding with Bluetooth - Martin Woolley, Bluetooth SIG
Publication date: 2019-10-29
Playlist: Open Source Summit & Embedded Linux Conference EU 2019 - Lyon
Description: 
	Location Services and Direction Finding with Bluetooth - Martin Woolley, Bluetooth SIG*

Bluetooth acquired a new capability in 2019. It’s now possible with suitable hardware, to calculate the direction a Bluetooth signal is being transmitted from, using one of two methods known as Angle of Arrival (AoA) or Angle of Departure (AoD). From this, it’s possible to accurately determine the location of the receiving device to within a matter of centimetres rather than metres. Proximity applications like Point of Interest (PoI) information systems and the classic “key finder” are all set to get very accurate and much easier to use. Positioning systems such as Real Time Locating Systems (RTLS) and Way Finding will offer a level of precision, never before possible with Bluetooth.

Learn about this new Bluetooth feature and how it works under the hood, from the physics of radio waves upwards through the layers of the Bluetooth protocol stack.
Captions: 
	00:00:00,030 --> 00:00:04,859
once again welcome to everyone and I'm

00:00:02,970 --> 00:00:06,240
stressing the welcome not just because

00:00:04,859 --> 00:00:07,649
I'm like that but because I know there

00:00:06,240 --> 00:00:09,030
are all sorts of very interesting talks

00:00:07,649 --> 00:00:09,929
you could be at but you're here so

00:00:09,030 --> 00:00:14,309
thanks a lot for coming

00:00:09,929 --> 00:00:17,190
and so I'm Martin things happening

00:00:14,309 --> 00:00:19,859
behind me that's a bit disconcerting I'm

00:00:17,190 --> 00:00:21,869
Martin I work for the Bluetooth special

00:00:19,859 --> 00:00:25,640
interest group and we are the standards

00:00:21,869 --> 00:00:27,660
organization behind Bluetooth technology

00:00:25,640 --> 00:00:29,250
importantly we don't make things a lot

00:00:27,660 --> 00:00:30,570
manufacturer vents or we don't make

00:00:29,250 --> 00:00:32,730
products we don't make commercial

00:00:30,570 --> 00:00:35,160
software apart from of a few tools

00:00:32,730 --> 00:00:39,000
people use to progress progress their

00:00:35,160 --> 00:00:41,940
products through our processes gonna

00:00:39,000 --> 00:00:43,829
talk about Bluetooth and location

00:00:41,940 --> 00:00:48,539
related stuff today but but largely

00:00:43,829 --> 00:00:50,340
because Bluetooth 5.1 core specification

00:00:48,539 --> 00:00:52,410
to give it its full name released

00:00:50,340 --> 00:00:55,770
earlier this year around January I think

00:00:52,410 --> 00:00:58,590
it was has a new thing in it relating to

00:00:55,770 --> 00:01:00,030
location which is quite interesting so

00:00:58,590 --> 00:01:02,640
I'm kind of largely looking to talk

00:01:00,030 --> 00:01:05,159
about that don't know that it's

00:01:02,640 --> 00:01:07,979
necessarily in Linux at this stage

00:01:05,159 --> 00:01:12,390
because it's quite new but history tells

00:01:07,979 --> 00:01:14,070
us that the bluesy guys tend to adopt

00:01:12,390 --> 00:01:15,780
new bluetooth features so I'm hoping

00:01:14,070 --> 00:01:18,030
that we'll see it but you know hopefully

00:01:15,780 --> 00:01:19,770
you'll find an interesting topic anyway

00:01:18,030 --> 00:01:21,830
and if not most of you at least got a

00:01:19,770 --> 00:01:24,630
sticker which is my primary

00:01:21,830 --> 00:01:27,560
responsibility is sticker distribution

00:01:24,630 --> 00:01:30,090
anyway let's make a start

00:01:27,560 --> 00:01:31,500
so Bluetooth has been used for location

00:01:30,090 --> 00:01:34,049
related stuff actually for quite a long

00:01:31,500 --> 00:01:35,340
time I'm not sure it's the first thing

00:01:34,049 --> 00:01:39,030
people think of when they think about

00:01:35,340 --> 00:01:42,810
Bluetooth it almost certainly isn't but

00:01:39,030 --> 00:01:45,270
we see the world of location related

00:01:42,810 --> 00:01:46,799
services as depicted by the slide

00:01:45,270 --> 00:01:48,899
possibly we got this from Industry

00:01:46,799 --> 00:01:51,060
Analysts I'm not quite sure two major

00:01:48,899 --> 00:01:53,220
sort of groupings of use case proximity

00:01:51,060 --> 00:01:55,189
solutions per the name all about being

00:01:53,220 --> 00:01:57,840
near to things and detecting that and

00:01:55,189 --> 00:01:59,790
positioning systems to do with tracking

00:01:57,840 --> 00:02:03,509
things or determining their location in

00:01:59,790 --> 00:02:04,950
real time two specific examples under

00:02:03,509 --> 00:02:06,689
each of those headings we've got item

00:02:04,950 --> 00:02:09,060
finding solutions you know where are my

00:02:06,689 --> 00:02:11,730
keys I've lost them oh no look at phone

00:02:09,060 --> 00:02:13,960
oh it's not far away I'll go and find my

00:02:11,730 --> 00:02:16,840
keys and point of interest in

00:02:13,960 --> 00:02:20,350
information solutions which tend to be

00:02:16,840 --> 00:02:22,030
related to either retail scenarios you

00:02:20,350 --> 00:02:23,770
walk past her into a big store and you

00:02:22,030 --> 00:02:25,510
get told about things relevant to the

00:02:23,770 --> 00:02:27,130
department that you're in or maybe

00:02:25,510 --> 00:02:29,440
you're in a museum or an art gallery you

00:02:27,130 --> 00:02:30,850
get an applications telling you about

00:02:29,440 --> 00:02:33,400
the exhibits in the room that you're in

00:02:30,850 --> 00:02:35,470
so on because you're close to something

00:02:33,400 --> 00:02:37,360
some kind of Bluetooth device is

00:02:35,470 --> 00:02:38,680
indicating where you are and then the

00:02:37,360 --> 00:02:42,220
positioning system is to do with

00:02:38,680 --> 00:02:44,260
tracking things in real time or indoor

00:02:42,220 --> 00:02:45,790
positioning or wayfinding or indoor

00:02:44,260 --> 00:02:47,800
navigation whatever term you prefer

00:02:45,790 --> 00:02:49,750
prefer which is plenty of about people

00:02:47,800 --> 00:02:52,180
knowing where they are on giving higher

00:02:49,750 --> 00:02:54,580
level kind of capabilities derived from

00:02:52,180 --> 00:02:57,010
that information such as navigation in

00:02:54,580 --> 00:02:58,720
big complicated buildings may be a bit

00:02:57,010 --> 00:03:00,070
like this one maybe more like airports

00:02:58,720 --> 00:03:01,720
and stuff like that so that's kind of

00:03:00,070 --> 00:03:08,280
how we break down the world of location

00:03:01,720 --> 00:03:08,280
and the fact is my laptop will behave

00:03:08,550 --> 00:03:16,600
please thank you the fact is we've had

00:03:14,010 --> 00:03:19,030
Bluetooth capabilities largely in the

00:03:16,600 --> 00:03:20,320
form of profiles that sort of fall under

00:03:19,030 --> 00:03:22,540
some of these headings for a long time

00:03:20,320 --> 00:03:24,340
so we've got the proximity profile in

00:03:22,540 --> 00:03:26,260
the finery profile they're kind of

00:03:24,340 --> 00:03:28,240
variations on the same thing the finery

00:03:26,260 --> 00:03:30,640
profile is is to do with finding lost

00:03:28,240 --> 00:03:33,940
objects that have tags connected to them

00:03:30,640 --> 00:03:36,100
things like keys normally is the example

00:03:33,940 --> 00:03:38,110
cited in the proximity profile is like

00:03:36,100 --> 00:03:39,430
that but it can do more than that kind

00:03:38,110 --> 00:03:41,830
of keeps you close to things you don't

00:03:39,430 --> 00:03:43,870
want to get far away from profiles if

00:03:41,830 --> 00:03:46,180
you're not clear are specifications that

00:03:43,870 --> 00:03:48,160
tell you how bluetooth should be used in

00:03:46,180 --> 00:03:49,480
a given context for a certain product

00:03:48,160 --> 00:03:52,450
type and we have the core specification

00:03:49,480 --> 00:03:53,770
which is this is how Bluetooth works how

00:03:52,450 --> 00:03:55,690
a Bluetooth stack works that's the

00:03:53,770 --> 00:03:57,400
difference between the core spec and

00:03:55,690 --> 00:03:59,320
profiles profiles are about particular

00:03:57,400 --> 00:04:00,910
applications we've got the indoor

00:03:59,320 --> 00:04:03,010
positioning profile which per the name

00:04:00,910 --> 00:04:06,130
is all about being able to figure out

00:04:03,010 --> 00:04:08,050
where someone is indoors but in the

00:04:06,130 --> 00:04:09,700
middle the big success story I guess is

00:04:08,050 --> 00:04:11,170
not something which was standardized by

00:04:09,700 --> 00:04:13,660
the Bluetooth special interest group or

00:04:11,170 --> 00:04:14,710
even invented necessarily by us and

00:04:13,660 --> 00:04:17,470
that's the beacon

00:04:14,710 --> 00:04:20,350
I mean raise your hand if you know what

00:04:17,470 --> 00:04:21,910
a Bluetooth beacon is that was rather

00:04:20,350 --> 00:04:24,010
than you know highlights the people

00:04:21,910 --> 00:04:25,480
who've never heard of beacons but most

00:04:24,010 --> 00:04:27,250
of you have so beacons actually really

00:04:25,480 --> 00:04:28,300
simple devices I think you know we can

00:04:27,250 --> 00:04:30,069
credit Apple with

00:04:28,300 --> 00:04:32,050
the first to sort of drive the beacon

00:04:30,069 --> 00:04:35,470
the beacon revolution sound like a

00:04:32,050 --> 00:04:37,150
marketing guy now it's a Bluetooth Low

00:04:35,470 --> 00:04:39,849
Energy has a capability called

00:04:37,150 --> 00:04:42,819
advertising it's kind of predominant

00:04:39,849 --> 00:04:44,680
purpose was to allow devices to be

00:04:42,819 --> 00:04:46,620
discovered really its connection was

00:04:44,680 --> 00:04:48,909
broadcasting of small amounts of data

00:04:46,620 --> 00:04:50,620
packets a structured you can't just put

00:04:48,909 --> 00:04:52,840
anything in there there's real rules to

00:04:50,620 --> 00:04:54,490
follow but typically a device will be

00:04:52,840 --> 00:04:57,159
advertising so that some of the device

00:04:54,490 --> 00:04:58,840
can find it and connect to it along came

00:04:57,159 --> 00:05:00,190
a Paul I think this is the story and

00:04:58,840 --> 00:05:02,500
decided that they could put some other

00:05:00,190 --> 00:05:04,419
stuff in those advertising packets not

00:05:02,500 --> 00:05:06,400
be concerned about things connecting in

00:05:04,419 --> 00:05:10,150
fact you don't have to allow connections

00:05:06,400 --> 00:05:11,770
to take place and thus arrived on the

00:05:10,150 --> 00:05:15,190
scene this thing called a beacon so I

00:05:11,770 --> 00:05:17,199
beacon his apples kind of message format

00:05:15,190 --> 00:05:19,150
if you like that sits inside Bluetooth

00:05:17,199 --> 00:05:21,759
advertising packets and on the whole it

00:05:19,150 --> 00:05:24,819
can basically contains a unique ID so

00:05:21,759 --> 00:05:28,330
with an application on your same mobile

00:05:24,819 --> 00:05:30,699
device you can be walking along and the

00:05:28,330 --> 00:05:33,250
phone starts to receive these kind of

00:05:30,699 --> 00:05:34,900
beaconing packets the application will

00:05:33,250 --> 00:05:36,669
have a look at the united unique ID

00:05:34,900 --> 00:05:39,779
match it against a database of these

00:05:36,669 --> 00:05:42,130
numbers and go ah we're in range of

00:05:39,779 --> 00:05:44,259
beacon number one two three four long

00:05:42,130 --> 00:05:46,659
number therefore the user must be in

00:05:44,259 --> 00:05:48,099
this place so that's how beacons work

00:05:46,659 --> 00:05:49,840
and you know by adjusting signal

00:05:48,099 --> 00:05:51,940
strength you can make that more or less

00:05:49,840 --> 00:05:54,069
accurate low signal strength you have to

00:05:51,940 --> 00:05:56,770
be pretty near to not beacon to receive

00:05:54,069 --> 00:05:57,969
its advertising packets stronger signal

00:05:56,770 --> 00:06:00,129
strength you're going to be further away

00:05:57,969 --> 00:06:01,090
and so the accuracies is lower but you

00:06:00,129 --> 00:06:04,449
know it depends what your requirements

00:06:01,090 --> 00:06:06,190
are so beacons arrived google followed

00:06:04,449 --> 00:06:07,900
with their own format called Eddystone

00:06:06,190 --> 00:06:09,789
and they're in all sorts of places now

00:06:07,900 --> 00:06:11,080
one of my local airports in london has

00:06:09,789 --> 00:06:13,090
something like two and a half thousand

00:06:11,080 --> 00:06:15,550
beacons deployed in it and some services

00:06:13,090 --> 00:06:18,940
for phones provided by the airport

00:06:15,550 --> 00:06:21,669
authority that run that airport so

00:06:18,940 --> 00:06:23,620
beacons have been quite a success really

00:06:21,669 --> 00:06:25,270
and perhaps the best known of the

00:06:23,620 --> 00:06:30,069
location services that bluetooth cars

00:06:25,270 --> 00:06:33,639
today however one of the limitations is

00:06:30,069 --> 00:06:35,620
that if I receive an advertising packet

00:06:33,639 --> 00:06:37,630
from a beacon of some sort let's say on

00:06:35,620 --> 00:06:39,460
my phone all I know is that it's

00:06:37,630 --> 00:06:41,350
somewhere in range it could be behind me

00:06:39,460 --> 00:06:44,430
it could be it's over there I don't know

00:06:41,350 --> 00:06:47,680
think about where this thing actually is

00:06:44,430 --> 00:06:49,420
likewise with the earlier sort of

00:06:47,680 --> 00:06:50,800
generations of things like key finders I

00:06:49,420 --> 00:06:52,330
don't know what direction these things

00:06:50,800 --> 00:06:56,290
are in I only know that I'm somewhere

00:06:52,330 --> 00:06:58,780
near to them and so the gray area on my

00:06:56,290 --> 00:07:00,010
slide kind of tells me you know that I'm

00:06:58,780 --> 00:07:01,900
somewhere in that's that kind of

00:07:00,010 --> 00:07:03,400
doughnut shape but I really don't know

00:07:01,900 --> 00:07:05,350
where on that circle I am because we've

00:07:03,400 --> 00:07:09,040
got no way of knowing the direction that

00:07:05,350 --> 00:07:10,660
that signal is coming from if I did then

00:07:09,040 --> 00:07:16,440
I'd have a much better idea of where I

00:07:10,660 --> 00:07:16,440
am per the thrilling slide what I made

00:07:16,980 --> 00:07:21,160
so things like you know item finding

00:07:19,540 --> 00:07:22,600
I've lost my keys become quite amusing

00:07:21,160 --> 00:07:24,580
and remind me of a game I used to play

00:07:22,600 --> 00:07:25,660
as a child I'm always wary of kind of

00:07:24,580 --> 00:07:27,760
volunteering this personal information

00:07:25,660 --> 00:07:31,350
to two complete strangers in case you're

00:07:27,760 --> 00:07:33,340
thinking what a weirdo what was he doing

00:07:31,350 --> 00:07:35,650
spending his time doing that sort of

00:07:33,340 --> 00:07:36,970
stuff as a child but we did used to play

00:07:35,650 --> 00:07:38,890
a game where a thing would be hidden

00:07:36,970 --> 00:07:40,600
you'd have to try and find it from

00:07:38,890 --> 00:07:43,390
friends or family would be saying warmer

00:07:40,600 --> 00:07:44,560
warmer as you got closer cold the cloak

00:07:43,390 --> 00:07:45,130
colder if you walked in the wrong

00:07:44,560 --> 00:07:46,810
direction

00:07:45,130 --> 00:07:49,590
tell me did anyone else play this game

00:07:46,810 --> 00:07:54,160
or was it just I'm amongst friends

00:07:49,590 --> 00:07:55,750
fellow weirdos perhaps and that's how

00:07:54,160 --> 00:07:57,370
things work with the kind of current

00:07:55,750 --> 00:07:58,630
generation of key finder things you know

00:07:57,370 --> 00:08:00,190
you really don't know what direction

00:07:58,630 --> 00:08:01,750
you're in but you'll have an application

00:08:00,190 --> 00:08:02,800
that will be using color coding or

00:08:01,750 --> 00:08:04,240
something to tell you you know you're

00:08:02,800 --> 00:08:06,040
walking in the wrong direction so you'll

00:08:04,240 --> 00:08:08,350
walk back and eventually you'll find the

00:08:06,040 --> 00:08:11,470
thing but if only we knew the direction

00:08:08,350 --> 00:08:12,970
the signal from the key finding tag was

00:08:11,470 --> 00:08:14,910
being transmitted from we'd walk

00:08:12,970 --> 00:08:19,500
straight towards it much better user

00:08:14,910 --> 00:08:22,030
experience and in fact with direction

00:08:19,500 --> 00:08:24,010
new things become possible as well so

00:08:22,030 --> 00:08:28,930
one of the use cases we're thinking

00:08:24,010 --> 00:08:30,490
about and anticipating kind of arriving

00:08:28,930 --> 00:08:32,260
on the scene in mobile applications is

00:08:30,490 --> 00:08:33,910
what we call directional discovery so

00:08:32,260 --> 00:08:36,099
you point your phone at specific things

00:08:33,910 --> 00:08:38,229
over there and you get information about

00:08:36,099 --> 00:08:40,360
those specific things because your phone

00:08:38,229 --> 00:08:41,830
plus the Bluetooth direction-finding

00:08:40,360 --> 00:08:43,930
capability I'm going to talk to you

00:08:41,830 --> 00:08:45,460
about knows what you're pointing out

00:08:43,930 --> 00:08:49,030
rather than I'm in a room full of

00:08:45,460 --> 00:08:53,680
paintings by Picasso or someone French

00:08:49,030 --> 00:08:55,060
even Renoir I'm you know I'm pointing at

00:08:53,680 --> 00:08:56,500
that specific painting so I

00:08:55,060 --> 00:08:58,930
information about that so new things

00:08:56,500 --> 00:09:01,120
become possible with direction-finding

00:08:58,930 --> 00:09:03,910
and that's precisely what the Bluetooth

00:09:01,120 --> 00:09:06,820
5.1 specification delivers a new

00:09:03,910 --> 00:09:10,480
capability that allows data from which

00:09:06,820 --> 00:09:11,800
very precise angles can be calculated so

00:09:10,480 --> 00:09:15,370
you can build all sorts of new products

00:09:11,800 --> 00:09:20,160
and applications so I'm not going to

00:09:15,370 --> 00:09:22,990
talk about that and start here so in

00:09:20,160 --> 00:09:25,839
terms of methods and kind of

00:09:22,990 --> 00:09:28,300
architectures there are two ways in

00:09:25,839 --> 00:09:31,029
which you can use this new Bluetooth

00:09:28,300 --> 00:09:32,529
technology to arrive at an angle which

00:09:31,029 --> 00:09:34,839
tells you where a signal is being

00:09:32,529 --> 00:09:38,430
transmitted from the first is called

00:09:34,839 --> 00:09:41,800
angle of arrival and in angle of arrival

00:09:38,430 --> 00:09:44,020
the receiving device has more than one

00:09:41,800 --> 00:09:47,200
antenna it has an array of antenna an

00:09:44,020 --> 00:09:49,810
antenna array even we could say it that

00:09:47,200 --> 00:09:52,210
way as the transmitter just has one so

00:09:49,810 --> 00:09:54,160
the transmitters transmitting a special

00:09:52,210 --> 00:09:55,360
signal called a direction finding signal

00:09:54,160 --> 00:09:58,210
tell you more about what that really is

00:09:55,360 --> 00:10:00,850
in a few slides time but this other

00:09:58,210 --> 00:10:04,000
device has an antenna array and through

00:10:00,850 --> 00:10:07,980
some magic can use that to figure out

00:10:04,000 --> 00:10:10,089
directions there is of course no magic

00:10:07,980 --> 00:10:12,040
nobody's crying that's good you're all

00:10:10,089 --> 00:10:14,920
engineers so I'll talk to you about the

00:10:12,040 --> 00:10:16,900
stuff that isn't magic as well so the

00:10:14,920 --> 00:10:18,880
other way of doing this if they're

00:10:16,900 --> 00:10:20,440
architecture is and a lot departure and

00:10:18,880 --> 00:10:22,360
it's the transmitting device that has

00:10:20,440 --> 00:10:24,880
the antenna array it's to receive a task

00:10:22,360 --> 00:10:26,800
to figure out the direction the signals

00:10:24,880 --> 00:10:29,440
coming from using data that's in this

00:10:26,800 --> 00:10:31,060
signal instant knowledge it has of the

00:10:29,440 --> 00:10:34,020
transmitting device those the two

00:10:31,060 --> 00:10:37,720
fundamental choices available to you

00:10:34,020 --> 00:10:39,820
this one we see being used ours there at

00:10:37,720 --> 00:10:42,450
the base of spindle positioning systems

00:10:39,820 --> 00:10:45,339
so those you could almost think of as

00:10:42,450 --> 00:10:48,010
you know beacons generation to almost

00:10:45,339 --> 00:10:50,050
indoor GPS with devices installed all

00:10:48,010 --> 00:10:51,339
around airports and big buildings you're

00:10:50,050 --> 00:10:53,709
walking along with your smart phone that

00:10:51,339 --> 00:10:57,220
only has one antenna in it but thanks to

00:10:53,709 --> 00:10:58,510
the angle of departure capability it can

00:10:57,220 --> 00:11:01,930
figure out where that signals coming

00:10:58,510 --> 00:11:04,080
from therefore bat's beacon is is over

00:11:01,930 --> 00:11:06,850
there and we can get much more precise

00:11:04,080 --> 00:11:08,290
locations calculated accordingly an

00:11:06,850 --> 00:11:09,500
antenna array is kind of outside the

00:11:08,290 --> 00:11:11,930
scope of this

00:11:09,500 --> 00:11:13,130
talk and and very much outside mine my

00:11:11,930 --> 00:11:15,740
knowledge as well but there come in

00:11:13,130 --> 00:11:17,089
various shapes and form as you can see

00:11:15,740 --> 00:11:19,220
and these are kind of implementation

00:11:17,089 --> 00:11:22,100
decisions that manufacturers who are

00:11:19,220 --> 00:11:25,209
into the hardware side of things will be

00:11:22,100 --> 00:11:25,209
left to figure out for themselves

00:11:25,959 --> 00:11:31,339
accuracy of course is a question about

00:11:29,200 --> 00:11:33,920
this kind of thing so if we go back to

00:11:31,339 --> 00:11:36,080
generation 1 beacons those things that

00:11:33,920 --> 00:11:38,950
just broadcast a kind of unique number

00:11:36,080 --> 00:11:41,060
ibeacon Eddystone whatever they are you

00:11:38,950 --> 00:11:42,830
know you read different reports about

00:11:41,060 --> 00:11:45,610
how accurate people believe their

00:11:42,830 --> 00:11:47,450
solutions to be but from my own personal

00:11:45,610 --> 00:11:50,270
experimentation I'd say you know you

00:11:47,450 --> 00:11:52,190
kind of pushing it you know to get

00:11:50,270 --> 00:11:53,990
better than a couple of meters accuracy

00:11:52,190 --> 00:11:55,640
and you know again you don't know

00:11:53,990 --> 00:11:58,010
anything about direction but you can use

00:11:55,640 --> 00:11:59,870
signal strength and a path loss

00:11:58,010 --> 00:12:02,570
calculation to estimate how far you are

00:11:59,870 --> 00:12:03,350
from something so still within that

00:12:02,570 --> 00:12:05,089
donut's

00:12:03,350 --> 00:12:07,160
region that I talked about you there's

00:12:05,089 --> 00:12:08,839
still quite a significant margin of

00:12:07,160 --> 00:12:10,310
error which might not matter it all

00:12:08,839 --> 00:12:11,930
depends on your requirements it's all

00:12:10,310 --> 00:12:14,690
about fit for purpose solutions of

00:12:11,930 --> 00:12:17,050
course with the new direction finding

00:12:14,690 --> 00:12:21,980
capability though you can get way better

00:12:17,050 --> 00:12:23,810
results and you know we have companies

00:12:21,980 --> 00:12:25,370
we know who are already using the

00:12:23,810 --> 00:12:27,079
techniques I'm in the process of

00:12:25,370 --> 00:12:30,050
describing to you and they will tell you

00:12:27,079 --> 00:12:31,959
they get 10 centimeter accuracy under

00:12:30,050 --> 00:12:34,760
the best conditions lots of variables

00:12:31,959 --> 00:12:37,160
inside buildings materials and walls and

00:12:34,760 --> 00:12:39,529
stuff all can have an impact on just how

00:12:37,160 --> 00:12:41,360
accurate you can be but that leads you

00:12:39,529 --> 00:12:43,160
into a whole kind of design methodology

00:12:41,360 --> 00:12:44,810
for your system as a whole as opposed to

00:12:43,160 --> 00:12:47,209
the stuff relating to the technology

00:12:44,810 --> 00:12:48,950
which is my field the potential though

00:12:47,209 --> 00:12:51,050
is there to get very very accurate and

00:12:48,950 --> 00:12:53,089
you know calling it indoor GPS actually

00:12:51,050 --> 00:12:55,510
seems quite a reasonable ideas way

00:12:53,089 --> 00:12:59,020
better than GPS in fact in terms of

00:12:55,510 --> 00:13:05,779
accuracy if I remember my GPS figures

00:12:59,020 --> 00:13:06,800
correctly so one thing to know em make

00:13:05,779 --> 00:13:08,180
sure you've got on screen and I've got

00:13:06,800 --> 00:13:10,970
screens certainly paranoid that you're

00:13:08,180 --> 00:13:12,140
not seeing what I'm seeing and one of

00:13:10,970 --> 00:13:15,790
the thing is one of the tricks is the

00:13:12,140 --> 00:13:20,810
trade if you like is this in some

00:13:15,790 --> 00:13:22,270
solutions you will deploy Direction

00:13:20,810 --> 00:13:23,770
finding beacons around your bill

00:13:22,270 --> 00:13:26,170
buildings they'll have a two-dimensional

00:13:23,770 --> 00:13:28,240
antenna array in them and one of things

00:13:26,170 --> 00:13:29,770
you'll do from things like smartphone

00:13:28,240 --> 00:13:32,410
applications or whatever other different

00:13:29,770 --> 00:13:34,810
devices you're trucking is calculate two

00:13:32,410 --> 00:13:36,550
angles from that one signal you can

00:13:34,810 --> 00:13:40,420
calculate a signal which is relative to

00:13:36,550 --> 00:13:42,820
a horizontal plane okay and an angle

00:13:40,420 --> 00:13:44,170
which is relative to a vertical plane

00:13:42,820 --> 00:13:46,510
because these things will be on the

00:13:44,170 --> 00:13:48,310
ceiling okay so I know it's over over

00:13:46,510 --> 00:13:50,260
there towards the AV guys but I also

00:13:48,310 --> 00:13:51,700
know it's it's up there so you end up

00:13:50,260 --> 00:13:53,490
with two lines and where they cross

00:13:51,700 --> 00:13:56,800
that's where we get the most accurate

00:13:53,490 --> 00:14:00,730
kind of calculations of angle where

00:13:56,800 --> 00:14:04,840
those two kind of signal directions

00:14:00,730 --> 00:14:05,950
cross in space so won't tell me how this

00:14:04,840 --> 00:14:07,480
stuff works because that's where of

00:14:05,950 --> 00:14:09,730
course it always gets interesting who

00:14:07,480 --> 00:14:11,980
studied physics at school or college or

00:14:09,730 --> 00:14:15,400
what have you got a few physicists in

00:14:11,980 --> 00:14:18,760
the audience that's quite worrying who's

00:14:15,400 --> 00:14:22,690
seen the TV show The Big Bang Theory the

00:14:18,760 --> 00:14:26,050
theory groan I don't know who

00:14:22,690 --> 00:14:27,370
differentiates cool me I'm sorry okay so

00:14:26,050 --> 00:14:28,480
you you all know enough physics here

00:14:27,370 --> 00:14:30,100
because we actually have to drop down

00:14:28,480 --> 00:14:32,470
into the world of physics to understand

00:14:30,100 --> 00:14:34,780
how this stuff works the fundamental

00:14:32,470 --> 00:14:36,700
basis of bluetooths Direction finding

00:14:34,780 --> 00:14:37,810
capability has been around since the

00:14:36,700 --> 00:14:39,880
middle of the last century

00:14:37,810 --> 00:14:42,820
radio communications has been around

00:14:39,880 --> 00:14:45,400
since the 1890s of course so we haven't

00:14:42,820 --> 00:14:47,170
invented this technique we're

00:14:45,400 --> 00:14:50,620
standardizing the way that it should be

00:14:47,170 --> 00:14:54,820
used with a bluetooth radio so here we

00:14:50,620 --> 00:14:56,290
go well waves could have shown particles

00:14:54,820 --> 00:14:58,900
of course but for our purposes we need

00:14:56,290 --> 00:14:59,650
to consider radio energy to be waves

00:14:58,900 --> 00:15:01,240
okay

00:14:59,650 --> 00:15:03,700
again you've all seen Big Bang Theory

00:15:01,240 --> 00:15:05,650
which is great so as you know waves kind

00:15:03,700 --> 00:15:07,300
of look like that they are repeating

00:15:05,650 --> 00:15:08,590
let's say they're all sine waves they

00:15:07,300 --> 00:15:10,240
kind of go up and then down and then

00:15:08,590 --> 00:15:13,090
that repeats that's called a wave cycle

00:15:10,240 --> 00:15:15,430
and there is a wave length wave length

00:15:13,090 --> 00:15:18,910
is not an abstract idea it is a physical

00:15:15,430 --> 00:15:22,030
length bluetooth the wave length is

00:15:18,910 --> 00:15:23,500
around twelve point five centimeters but

00:15:22,030 --> 00:15:25,240
it depends on the frequency the wave

00:15:23,500 --> 00:15:27,220
length will vary according to the exact

00:15:25,240 --> 00:15:29,820
frequency being used and Bluetooth use

00:15:27,220 --> 00:15:32,350
uses lots of different frequencies 74

00:15:29,820 --> 00:15:33,250
when two devices are connected with a

00:15:32,350 --> 00:15:34,690
Bluetooth low-energy

00:15:33,250 --> 00:15:36,100
link so what's different frequencies

00:15:34,690 --> 00:15:38,199
involved the wavelength will bear

00:15:36,100 --> 00:15:40,269
slightly according to the one in use at

00:15:38,199 --> 00:15:42,250
a particular time we hop around do lots

00:15:40,269 --> 00:15:43,750
of different frequencies through a

00:15:42,250 --> 00:15:46,240
process called adaptive frequency

00:15:43,750 --> 00:15:47,740
hopping another concept for you to know

00:15:46,240 --> 00:15:49,779
as we lead towards understanding how

00:15:47,740 --> 00:15:53,740
this works is phase this is a really

00:15:49,779 --> 00:15:56,259
important one so consider a wave passing

00:15:53,740 --> 00:15:58,720
across an antenna at any point in time

00:15:56,259 --> 00:16:00,279
we are partway through that wave cycle

00:15:58,720 --> 00:16:02,139
where maybe exactly at the start in

00:16:00,279 --> 00:16:04,800
which case we say the phase is zero

00:16:02,139 --> 00:16:06,940
its measured or expressed as an angle

00:16:04,800 --> 00:16:09,220
maybe we're halfway through it in which

00:16:06,940 --> 00:16:11,769
case we'll say we are pi radians two

00:16:09,220 --> 00:16:14,949
phases pi radians or it's 180 degrees

00:16:11,769 --> 00:16:17,259
depending on your preferred units of

00:16:14,949 --> 00:16:19,449
measuring angles so it's 360 degrees is

00:16:17,259 --> 00:16:21,279
a full cycle of your wave got its

00:16:19,449 --> 00:16:23,500
physics lesson didn't know this was

00:16:21,279 --> 00:16:23,800
going to happen did you the doors are

00:16:23,500 --> 00:16:29,889
locked

00:16:23,800 --> 00:16:31,899
we're good so for a given fixed

00:16:29,889 --> 00:16:34,690
frequency which therefore gives us a

00:16:31,899 --> 00:16:37,569
fixed wavelength the following becomes

00:16:34,690 --> 00:16:40,259
true if you imagine a transmitter in a

00:16:37,569 --> 00:16:43,149
fixed location and it's transmitting

00:16:40,259 --> 00:16:46,029
sometimes tempting to think of you know

00:16:43,149 --> 00:16:47,230
radio transmissions as kind of going you

00:16:46,029 --> 00:16:48,880
know we're kind of transmitting from

00:16:47,230 --> 00:16:50,980
here to here in actual fact it's more

00:16:48,880 --> 00:16:54,610
like dropping a stone in a pond the

00:16:50,980 --> 00:16:56,769
energy is is ripples resonating outwards

00:16:54,610 --> 00:16:58,720
from the point of entry of that stone in

00:16:56,769 --> 00:17:02,290
the pond same with radio communications

00:16:58,720 --> 00:17:06,069
if we place two antenna two receiving

00:17:02,290 --> 00:17:08,439
antennas at exactly the same distance or

00:17:06,069 --> 00:17:10,179
rather on the circumference of one of

00:17:08,439 --> 00:17:11,709
those ripples they are therefore exactly

00:17:10,179 --> 00:17:14,890
the same distance from the transmitter

00:17:11,709 --> 00:17:18,179
agree my ripples are circular okay

00:17:14,890 --> 00:17:23,770
that's basic geometry and maths

00:17:18,179 --> 00:17:26,049
consequently if I was to measure the

00:17:23,770 --> 00:17:27,819
phase of the wave as it passes over

00:17:26,049 --> 00:17:29,620
those two antennas at exactly the same

00:17:27,819 --> 00:17:31,659
time I'll get exactly the same value

00:17:29,620 --> 00:17:33,760
because it's the same wavelength because

00:17:31,659 --> 00:17:37,419
it's the same frequency therefore I

00:17:33,760 --> 00:17:40,679
absolutely must get the same phase value

00:17:37,419 --> 00:17:44,440
and this becomes useful because

00:17:40,679 --> 00:17:47,770
wavelengths we know around 12 12 and 1/2

00:17:44,440 --> 00:17:49,340
centimeters if I'm halfway through that

00:17:47,770 --> 00:17:53,120
wave cycle in other words my

00:17:49,340 --> 00:17:55,040
Faye's is pi radians 180 degrees that's

00:17:53,120 --> 00:17:56,840
six point two five centimeters from the

00:17:55,040 --> 00:17:59,060
beginning of the way suddenly we've got

00:17:56,840 --> 00:18:01,250
a way of deriving distance information

00:17:59,060 --> 00:18:02,630
from transmitter from this phase thing

00:18:01,250 --> 00:18:04,940
and again this stuff comes from the

00:18:02,630 --> 00:18:09,670
beginning of last century okay we didn't

00:18:04,940 --> 00:18:12,770
just make it up sorry come on laptop

00:18:09,670 --> 00:18:13,940
it's refusing to work so if you look at

00:18:12,770 --> 00:18:16,370
it on this side it kind of looks like

00:18:13,940 --> 00:18:20,360
this so oh I know why this because I did

00:18:16,370 --> 00:18:22,550
something wrong there what an ammeter so

00:18:20,360 --> 00:18:24,380
next stage in the explanation had I not

00:18:22,550 --> 00:18:26,570
done it wrong it is this if I move one

00:18:24,380 --> 00:18:29,840
of my receivers so it's a little bit

00:18:26,570 --> 00:18:33,530
nearer to the transmitter as long as I

00:18:29,840 --> 00:18:36,980
do that by a delta that is not an exact

00:18:33,530 --> 00:18:38,870
multiple over the wavelength then if I

00:18:36,980 --> 00:18:41,300
measure the phase at exactly the same

00:18:38,870 --> 00:18:44,480
time on the two at the two antenna I'll

00:18:41,300 --> 00:18:45,380
get a different value now I think agree

00:18:44,480 --> 00:18:47,540
makes sense

00:18:45,380 --> 00:18:49,790
lots of nodding please okay there will

00:18:47,540 --> 00:18:51,470
be a test and if we look at that

00:18:49,790 --> 00:18:54,620
sideways on it kind of looks like this

00:18:51,470 --> 00:18:56,390
okay so if one of my antenna is x from

00:18:54,620 --> 00:18:58,580
the transmitter we'll get a phase value

00:18:56,390 --> 00:19:00,950
of pi if another one is further away

00:18:58,580 --> 00:19:04,970
that's my distance Y on the slide there

00:19:00,950 --> 00:19:06,620
I'm gonna get 3 PI over 2 how to check

00:19:04,970 --> 00:19:11,450
that one three quarters of the way into

00:19:06,620 --> 00:19:14,840
the wave cycle you get the idea this

00:19:11,450 --> 00:19:17,720
information becomes useful for us and is

00:19:14,840 --> 00:19:21,110
the basis for calculating angles because

00:19:17,720 --> 00:19:23,870
if I have multiple receivers and with an

00:19:21,110 --> 00:19:27,320
antenna array that's what's going on in

00:19:23,870 --> 00:19:29,630
my system the calculation of angles

00:19:27,320 --> 00:19:31,790
becomes basic trigonometry I'm not gonna

00:19:29,630 --> 00:19:33,470
I mean you'll run screaming from the

00:19:31,790 --> 00:19:35,210
room if we go into the the formula on

00:19:33,470 --> 00:19:37,700
screen here that's copied and pasted

00:19:35,210 --> 00:19:39,710
from the Bluetooth core specification we

00:19:37,700 --> 00:19:41,690
all did trigonometry at school I guess

00:19:39,710 --> 00:19:43,490
apart from you guys that did arts with

00:19:41,690 --> 00:19:46,280
me arts but then changed course in later

00:19:43,490 --> 00:19:47,720
life right so trigonometry is not

00:19:46,280 --> 00:19:50,240
difficult maths so that's the whole

00:19:47,720 --> 00:19:51,920
purpose of this slide under the hood

00:19:50,240 --> 00:19:54,560
there's some phase difference related

00:19:51,920 --> 00:19:57,920
calculations going on using some basic

00:19:54,560 --> 00:19:59,660
trigonometry we can now derive an angle

00:19:57,920 --> 00:20:02,919
and that's what we're looking for that

00:19:59,660 --> 00:20:08,239
was the Holy Grail now

00:20:02,919 --> 00:20:11,419
one further thing to tell you what is it

00:20:08,239 --> 00:20:14,629
that's measuring these phase values from

00:20:11,419 --> 00:20:16,460
radio waves flowing over antenna well

00:20:14,629 --> 00:20:17,960
the process is called IQ sampling which

00:20:16,460 --> 00:20:22,100
I'm guessing most of you have heard of

00:20:17,960 --> 00:20:25,129
who's heard of IQ sampling approximately

00:20:22,100 --> 00:20:26,479
52% of the room very good so IQ

00:20:25,129 --> 00:20:28,070
something I think is used in lots of

00:20:26,479 --> 00:20:30,289
applications it's probably used in audio

00:20:28,070 --> 00:20:33,409
isn't it something of certain sorts is

00:20:30,289 --> 00:20:37,340
it's just measuring amplitude and phase

00:20:33,409 --> 00:20:39,830
values from some form of signal at

00:20:37,340 --> 00:20:41,479
certain intervals so an IQ sampling is

00:20:39,830 --> 00:20:46,779
the process that the Bluetooth stat will

00:20:41,479 --> 00:20:50,419
use if it's asked to to start to measure

00:20:46,779 --> 00:20:52,700
phase and amplitude values from signals

00:20:50,419 --> 00:20:54,409
incident upon its antenna that's what's

00:20:52,700 --> 00:20:56,869
going on behind the scene now this stuff

00:20:54,409 --> 00:21:01,239
is I would acknowledge because I was

00:20:56,869 --> 00:21:04,999
perhaps where you are today a year ago a

00:21:01,239 --> 00:21:06,739
nightmare to visualize is it not it's

00:21:04,999 --> 00:21:11,059
hard enough to explain in words never

00:21:06,739 --> 00:21:12,259
mind pictures so me being me I decided I

00:21:11,059 --> 00:21:14,169
really need to see what was going on

00:21:12,259 --> 00:21:17,299
visualized this stuff so I wrote

00:21:14,169 --> 00:21:20,330
something to help me kind of understand

00:21:17,299 --> 00:21:22,070
what on earth was happening here and you

00:21:20,330 --> 00:21:25,489
can't see it because PowerPoint still

00:21:22,070 --> 00:21:28,759
has I wondered why and watch the it's

00:21:25,489 --> 00:21:31,099
not PowerPoint AV team I have a slight

00:21:28,759 --> 00:21:36,169
problem could you please make my web

00:21:31,099 --> 00:21:37,429
browser appear on screen is it ah that's

00:21:36,169 --> 00:21:40,309
because we have an extended monitor

00:21:37,429 --> 00:21:43,549
going on here computers are such a

00:21:40,309 --> 00:21:46,309
nightmare excuse me

00:21:43,549 --> 00:21:49,210
mouse control problems now or Windows

00:21:46,309 --> 00:21:49,210
doing annoying things

00:21:49,330 --> 00:21:52,470
do this

00:21:52,830 --> 00:21:55,530
so I'm going to talk to myself and

00:21:54,510 --> 00:21:58,260
you're gonna hear it all on the mic

00:21:55,530 --> 00:22:00,530
which should be music this is a real

00:21:58,260 --> 00:22:00,530
pain

00:22:02,530 --> 00:22:07,500
I don't if I changed a single like knots

00:22:07,559 --> 00:22:13,090
extended monitor whether I'm going to

00:22:09,340 --> 00:22:13,539
break the entire AV setup I'm gonna do

00:22:13,090 --> 00:22:17,730
it anyway

00:22:13,539 --> 00:22:17,730
and if you don't get to see my amazing

00:22:19,140 --> 00:22:29,500
visualization thing then that's just

00:22:22,270 --> 00:22:31,600
unfortunate really I'm like a Navy guy's

00:22:29,500 --> 00:22:34,830
nightmare now doing this live on stage

00:22:31,600 --> 00:22:38,580
that work I shouldn't have done this now

00:22:34,830 --> 00:22:38,580
let's try to them

00:22:42,820 --> 00:22:51,400
I know we should have tested this yeah I

00:22:47,380 --> 00:22:52,810
can't even see this now revert yeah I

00:22:51,400 --> 00:22:57,910
think you're gonna have to just imagine

00:22:52,810 --> 00:22:58,960
my incredible visualization which is a

00:22:57,910 --> 00:23:02,650
shame because it really is quite

00:22:58,960 --> 00:23:07,810
remarkable duplicates will that work who

00:23:02,650 --> 00:23:16,540
knows windows I'm doing Oh promising

00:23:07,810 --> 00:23:22,000
let's kill that let's go to here god I

00:23:16,540 --> 00:23:23,350
hate computers let's pretend none of

00:23:22,000 --> 00:23:27,760
that happened and that none of it was

00:23:23,350 --> 00:23:29,440
videos edit so what we got here then is

00:23:27,760 --> 00:23:32,260
it's just a web page actually in some

00:23:29,440 --> 00:23:34,000
JavaScript I kind of knocked up so we've

00:23:32,260 --> 00:23:36,430
got the white thing is meant to be an

00:23:34,000 --> 00:23:38,620
antenna we have a radio wave passing

00:23:36,430 --> 00:23:41,950
across it massively slowed down from the

00:23:38,620 --> 00:23:44,410
speed of light the red number and the

00:23:41,950 --> 00:23:47,200
blob is the radio phase varying from

00:23:44,410 --> 00:23:50,200
naught to 360 degrees okay as the radio

00:23:47,200 --> 00:23:53,560
wave passes over it if I add another

00:23:50,200 --> 00:23:55,720
antenna and another and because I've

00:23:53,560 --> 00:23:57,490
carefully placed my antenna at distances

00:23:55,720 --> 00:24:00,430
that are not exact multiples of the

00:23:57,490 --> 00:24:02,410
wavelength you can see that I'm getting

00:24:00,430 --> 00:24:04,600
different phase values at a given point

00:24:02,410 --> 00:24:08,320
in time can you will see that after all

00:24:04,600 --> 00:24:12,460
the trouble I went to please say yes now

00:24:08,320 --> 00:24:14,350
if I switch on IQ sampling this is

00:24:12,460 --> 00:24:17,500
what's going on if you watch the yellow

00:24:14,350 --> 00:24:21,010
number that's me sampling from this

00:24:17,500 --> 00:24:22,690
antenna then this antenna and this

00:24:21,010 --> 00:24:24,850
antenna I'm kind of moving through my

00:24:22,690 --> 00:24:27,370
antenna array according to a strict

00:24:24,850 --> 00:24:30,300
sequence and timing and I'm sampling

00:24:27,370 --> 00:24:32,520
values from each antenna

00:24:30,300 --> 00:24:34,590
how's the radio wave passes over it okay

00:24:32,520 --> 00:24:36,750
that's fundamentally what's going to be

00:24:34,590 --> 00:24:41,040
going on in the Bluetooth stack when you

00:24:36,750 --> 00:24:43,380
enable the direction finding stuff let's

00:24:41,040 --> 00:24:46,980
move back to powerpoints which I've

00:24:43,380 --> 00:24:49,650
decided isn't fact my friend there we go

00:24:46,980 --> 00:24:51,660
so you have a good mental image now so

00:24:49,650 --> 00:24:55,530
there's one other thing to know about so

00:24:51,660 --> 00:24:57,900
we're relying here on using phase

00:24:55,530 --> 00:25:01,410
measurements and their correspondence

00:24:57,900 --> 00:25:03,570
wave wave lengths to give us distances

00:25:01,410 --> 00:25:05,429
from which we can do some trigonometry

00:25:03,570 --> 00:25:06,980
which gives us an angle bust kind of the

00:25:05,429 --> 00:25:09,929
building blocks of how this system works

00:25:06,980 --> 00:25:10,679
but there is one other issue I mentioned

00:25:09,929 --> 00:25:12,600
that we use lots of different

00:25:10,679 --> 00:25:14,370
frequencies so when two different

00:25:12,600 --> 00:25:16,260
devices Bluetooth devices are connected

00:25:14,370 --> 00:25:19,350
they do something called adaptive

00:25:16,260 --> 00:25:21,750
frequency hopping there are 37 radio

00:25:19,350 --> 00:25:23,640
channels that they will hop through but

00:25:21,750 --> 00:25:26,600
a channel is a frequency range it's not

00:25:23,640 --> 00:25:29,490
a frequency is a range of frequencies

00:25:26,600 --> 00:25:31,350
radio is analog but we need to encode

00:25:29,490 --> 00:25:33,030
digital information in it this is where

00:25:31,350 --> 00:25:35,640
modulation schemes come in and the way

00:25:33,030 --> 00:25:37,290
it works with Bluetooth is this here's

00:25:35,640 --> 00:25:39,420
my channel with the lower frequency and

00:25:37,290 --> 00:25:40,950
upper frequency somewhere in the middle

00:25:39,420 --> 00:25:44,730
of those two things there's a kind of

00:25:40,950 --> 00:25:45,960
central baseline frequency so we defined

00:25:44,730 --> 00:25:49,410
something called a frequency deviation

00:25:45,960 --> 00:25:51,330
which is a number to represent a zero we

00:25:49,410 --> 00:25:54,170
subtract the frequency deviation from

00:25:51,330 --> 00:25:56,610
that central frequency so frequencies

00:25:54,170 --> 00:25:59,460
less than that central value represents

00:25:56,610 --> 00:26:01,470
0 to represent a 1 we add the frequency

00:25:59,460 --> 00:26:04,170
deviation whoops I keep doing this two

00:26:01,470 --> 00:26:06,150
ways okay so we do change the frequency

00:26:04,170 --> 00:26:08,340
within a channel to represent our ones

00:26:06,150 --> 00:26:11,760
and zeros from the digital world

00:26:08,340 --> 00:26:14,340
venez how it works which is great but

00:26:11,760 --> 00:26:16,590
for direction finally of course we need

00:26:14,340 --> 00:26:19,080
to know what the wavelength is it kinda

00:26:16,590 --> 00:26:20,670
needs to be static we can cope with the

00:26:19,080 --> 00:26:23,610
frequency deviation thing but it

00:26:20,670 --> 00:26:26,600
complicates things a little bit so I've

00:26:23,610 --> 00:26:30,840
used the phrase Direction finding signal

00:26:26,600 --> 00:26:33,720
these are signals which have appended to

00:26:30,840 --> 00:26:36,310
them some special data which essentially

00:26:33,720 --> 00:26:39,320
is a load of ones

00:26:36,310 --> 00:26:41,660
they're all ones therefore the frequency

00:26:39,320 --> 00:26:43,850
stays the same therefore the wavelength

00:26:41,660 --> 00:26:46,340
is a static quantity we can do our

00:26:43,850 --> 00:26:50,680
sampling on and derive and our direction

00:26:46,340 --> 00:26:53,270
calculations from that's what we do here

00:26:50,680 --> 00:26:55,700
it's that special thing is called the

00:26:53,270 --> 00:26:57,680
CTE the constant tone extension if it

00:26:55,700 --> 00:26:59,510
was audible it would be a constant tone

00:26:57,680 --> 00:27:02,210
I'm not going to do it don't worry mmm

00:26:59,510 --> 00:27:05,860
it's like that though okay Allan's

00:27:02,210 --> 00:27:08,360
Direction finding signals have a CTE

00:27:05,860 --> 00:27:11,270
appended to them and this is all defined

00:27:08,360 --> 00:27:13,280
in the Bluetooth 5.1 specification you

00:27:11,270 --> 00:27:15,020
can see those of you who here was

00:27:13,280 --> 00:27:16,430
familiar enough with Bluetooth to know

00:27:15,020 --> 00:27:18,440
what pockets look like and stuff like

00:27:16,430 --> 00:27:21,470
this some of you for sure yeah ok so

00:27:18,440 --> 00:27:26,750
just get stacked on the end after the

00:27:21,470 --> 00:27:28,520
CRC okay know what whitening we don't

00:27:26,750 --> 00:27:32,900
apply whitening to the CTE because that

00:27:28,520 --> 00:27:34,280
would kind of mess it up ok so let's

00:27:32,900 --> 00:27:35,930
talk about where this is in the blue T

00:27:34,280 --> 00:27:38,510
stand I've had all the physics the Big

00:27:35,930 --> 00:27:40,760
Bang Theory stuff let's go back to blue

00:27:38,510 --> 00:27:43,420
tooth now which we kind of had started

00:27:40,760 --> 00:27:46,130
to do so there are various

00:27:43,420 --> 00:27:49,010
configurations of Bluetooth stack that

00:27:46,130 --> 00:27:51,230
you can use so your smart phones have a

00:27:49,010 --> 00:27:53,180
stack that looks like this control a

00:27:51,230 --> 00:27:55,760
component at the bottom which sits on

00:27:53,180 --> 00:27:57,980
top of the radio itself other layers in

00:27:55,760 --> 00:27:59,360
the host components on top of that the

00:27:57,980 --> 00:28:02,330
one you're seeing now which is gap

00:27:59,360 --> 00:28:04,010
getting out is plus some other layers so

00:28:02,330 --> 00:28:05,720
what phone's used to talk to peripheral

00:28:04,010 --> 00:28:09,230
devices like activities Drucker's and

00:28:05,720 --> 00:28:10,640
smartwatches and so on I talked about

00:28:09,230 --> 00:28:12,650
blue cheese mesh this morning if you're

00:28:10,640 --> 00:28:15,260
in that talk you'll know that we have an

00:28:12,650 --> 00:28:16,400
entirely different host staff that sits

00:28:15,260 --> 00:28:18,590
on top of the Bluetooth Low Energy

00:28:16,400 --> 00:28:22,040
controller when you're doing mesh

00:28:18,590 --> 00:28:24,170
communication mesh and direction-finding

00:28:22,040 --> 00:28:26,420
are not related at all at this stage so

00:28:24,170 --> 00:28:31,270
the stuff we've delivered is only about

00:28:26,420 --> 00:28:31,270
the stack configuration on the left

00:28:32,620 --> 00:28:39,650
now terms of what we've delivered so far

00:28:36,380 --> 00:28:42,740
which is my my hint that there's

00:28:39,650 --> 00:28:46,220
actually a little bit more to come we've

00:28:42,740 --> 00:28:49,580
delivered core specification version 5.1

00:28:46,220 --> 00:28:52,340
it only defines what's going on in the

00:28:49,580 --> 00:28:55,670
controller it's all stuff to do with IQ

00:28:52,340 --> 00:28:57,590
sampling and the timing of IQ samples

00:28:55,670 --> 00:28:59,480
are talking about 1 or 2 micro second

00:28:57,590 --> 00:29:03,800
timing slots here very precise timing

00:28:59,480 --> 00:29:05,480
rules but we've also defined if you see

00:29:03,800 --> 00:29:06,890
sitting in the middle there between the

00:29:05,480 --> 00:29:08,240
host and the controller we have a layer

00:29:06,890 --> 00:29:10,280
actually an interface called the host

00:29:08,240 --> 00:29:12,650
controller interface which per the

00:29:10,280 --> 00:29:15,350
brilliantly selected name is how the

00:29:12,650 --> 00:29:17,179
host part talks to the controller part

00:29:15,350 --> 00:29:18,800
and sends it commands and receives

00:29:17,179 --> 00:29:20,840
things back from it called events so

00:29:18,800 --> 00:29:22,550
we've extended the host host controller

00:29:20,840 --> 00:29:24,740
interface so that the host can say to

00:29:22,550 --> 00:29:27,860
the controller I want you to start

00:29:24,740 --> 00:29:29,150
giving me direction finding signals in

00:29:27,860 --> 00:29:30,920
other words I want the constant tone

00:29:29,150 --> 00:29:33,200
extension please and here are some

00:29:30,920 --> 00:29:36,559
parameters to do with timing and stuff

00:29:33,200 --> 00:29:39,050
like that the host can tell the

00:29:36,559 --> 00:29:41,240
controller what it wants once it's done

00:29:39,050 --> 00:29:44,210
that the controller will start to

00:29:41,240 --> 00:29:45,740
perform IQ sampling depending on which

00:29:44,210 --> 00:29:47,300
end of the relationship between

00:29:45,740 --> 00:29:48,559
transmitter and receiver we are but

00:29:47,300 --> 00:29:51,530
essentially that's what we're going to

00:29:48,559 --> 00:29:55,490
do configure the controller and then

00:29:51,530 --> 00:29:59,900
enable sampling all the processing of

00:29:55,490 --> 00:30:02,960
samples so here's an example you can use

00:29:59,900 --> 00:30:04,670
this in either connection-oriented

00:30:02,960 --> 00:30:07,790
situations where two devices are

00:30:04,670 --> 00:30:09,800
connected or connectionless so where one

00:30:07,790 --> 00:30:11,750
device is advertising so that's a

00:30:09,800 --> 00:30:13,400
connectionless broadcasted data and

00:30:11,750 --> 00:30:15,020
other devices are scanning for

00:30:13,400 --> 00:30:16,580
information they're just there's no

00:30:15,020 --> 00:30:19,309
synchronization at the timing of these

00:30:16,580 --> 00:30:20,900
operations you can use bluetooth

00:30:19,309 --> 00:30:24,710
direction-finding in either of these two

00:30:20,900 --> 00:30:26,780
scenarios ok the way it works if is of

00:30:24,710 --> 00:30:29,210
course and in fact you're going to need

00:30:26,780 --> 00:30:33,410
to have a Bluetooth 5 stack to be able

00:30:29,210 --> 00:30:35,150
to use this in sorry let me start again

00:30:33,410 --> 00:30:36,740
you've got to have a Bluetooth 5.1

00:30:35,150 --> 00:30:38,300
anyway for Direction finding

00:30:36,740 --> 00:30:41,480
but we're leveraging something that

00:30:38,300 --> 00:30:43,440
became capable possible in blue t5 which

00:30:41,480 --> 00:30:45,930
is advertising that has kind of

00:30:43,440 --> 00:30:47,400
retiming if that doesn't sound like a

00:30:45,930 --> 00:30:49,920
contradiction in terms

00:30:47,400 --> 00:30:51,600
before bluetooth 500 all that Petaling

00:30:49,920 --> 00:30:53,940
just happened according to the frequency

00:30:51,600 --> 00:30:55,440
you told it to happen to and devices

00:30:53,940 --> 00:30:57,390
that wanted to receive appetizing

00:30:55,440 --> 00:30:59,790
packets just had to try their best to

00:30:57,390 --> 00:31:01,260
you know be listening when they were

00:30:59,790 --> 00:31:02,310
being transmitted and if they weren't

00:31:01,260 --> 00:31:03,780
listening when they were transmitted

00:31:02,310 --> 00:31:05,100
they wouldn't receive them so there was

00:31:03,780 --> 00:31:07,290
no way of synchronizing the two

00:31:05,100 --> 00:31:10,200
Bluetooth five actually lets you do

00:31:07,290 --> 00:31:11,880
something called periodic advertising

00:31:10,200 --> 00:31:14,220
where the timing is agreed always

00:31:11,880 --> 00:31:15,360
actually broadcast to other devices so

00:31:14,220 --> 00:31:17,130
I'm going to advertise

00:31:15,360 --> 00:31:19,080
every 200 milliseconds and all the other

00:31:17,130 --> 00:31:21,150
devices are okay right I'll start

00:31:19,080 --> 00:31:22,950
listing at the rights interval and

00:31:21,150 --> 00:31:24,450
because of the time specific nature of

00:31:22,950 --> 00:31:26,280
the direction-finding in it like you

00:31:24,450 --> 00:31:28,140
something's stuff that's going on for

00:31:26,280 --> 00:31:30,810
connections communication that's what

00:31:28,140 --> 00:31:32,100
you have to use what's shown on the

00:31:30,810 --> 00:31:35,610
slide here though is a sequence diagram

00:31:32,100 --> 00:31:36,900
of the connection or in oriented

00:31:35,610 --> 00:31:38,520
situation not going to go through the

00:31:36,900 --> 00:31:40,080
detail here but essentially there is

00:31:38,520 --> 00:31:43,470
some new host controller interface

00:31:40,080 --> 00:31:45,510
commands that lets the the two hosts

00:31:43,470 --> 00:31:47,670
talk to their controllers and switch on

00:31:45,510 --> 00:31:49,640
like you something maybe give some

00:31:47,670 --> 00:31:53,760
parameters and then across the link

00:31:49,640 --> 00:31:56,610
there's a PD you called LLC te req so

00:31:53,760 --> 00:31:59,400
that's ll is the link layer CTE of

00:31:56,610 --> 00:32:01,260
course you already know is constant own

00:31:59,400 --> 00:32:03,540
extension well-done classic fantastic

00:32:01,260 --> 00:32:04,710
and obviously request is me sending

00:32:03,540 --> 00:32:07,440
something down the link saying please

00:32:04,710 --> 00:32:09,240
reply with something containing constant

00:32:07,440 --> 00:32:12,540
tone extension so something's taking

00:32:09,240 --> 00:32:14,520
place excuse me and I'm gonna get to

00:32:12,540 --> 00:32:15,540
response to them what you actually get

00:32:14,520 --> 00:32:17,460
back across the host controller

00:32:15,540 --> 00:32:19,530
interface are not individual samples

00:32:17,460 --> 00:32:23,280
because we're talking about micro second

00:32:19,530 --> 00:32:25,530
timing slots now but I'm actually going

00:32:23,280 --> 00:32:30,090
to get an array of IQ samples of

00:32:25,530 --> 00:32:32,570
amplitude and phase measurements after

00:32:30,090 --> 00:32:32,570
which

00:32:32,720 --> 00:32:37,430
at this stage because we still have some

00:32:34,850 --> 00:32:40,880
profile specifications to release it's

00:32:37,430 --> 00:32:42,560
over to you so a lot of responsibilities

00:32:40,880 --> 00:32:44,990
still in the host and application layers

00:32:42,560 --> 00:32:47,810
did you slide what to do with that raw

00:32:44,990 --> 00:32:49,220
material the very basics are quite

00:32:47,810 --> 00:32:51,020
straightforward there's that

00:32:49,220 --> 00:32:53,450
trigonometry formula in the spec so

00:32:51,020 --> 00:32:56,090
you're gonna kind of use that I think

00:32:53,450 --> 00:32:58,340
we're never gonna go too far in defining

00:32:56,090 --> 00:33:00,170
exactly how you do the calculations to

00:32:58,340 --> 00:33:02,900
derive direction-finding from different

00:33:00,170 --> 00:33:05,480
designs of antenna array we see that as

00:33:02,900 --> 00:33:08,330
a place where competitors can kind of

00:33:05,480 --> 00:33:12,620
get the edge over each other okay but

00:33:08,330 --> 00:33:15,530
that's where we are right now so that

00:33:12,620 --> 00:33:16,850
almost ends their talk let me tell you

00:33:15,530 --> 00:33:19,370
where you can go next if you want to

00:33:16,850 --> 00:33:20,780
know more in terms of actual stuff our

00:33:19,370 --> 00:33:22,280
market is still really really new I

00:33:20,780 --> 00:33:24,830
haven't really been watching to see what

00:33:22,280 --> 00:33:26,540
devices are out there there are but I

00:33:24,830 --> 00:33:28,010
will say there is at least one developer

00:33:26,540 --> 00:33:30,140
board that comes with an antenna array

00:33:28,010 --> 00:33:33,070
that lets you start to develop Bluetooth

00:33:30,140 --> 00:33:35,240
5.1 direction-finding stuff there may be

00:33:33,070 --> 00:33:37,400
another one at lunch so may there's

00:33:35,240 --> 00:33:38,690
maybe several out there now that will

00:33:37,400 --> 00:33:40,700
accelerate that's what normally happens

00:33:38,690 --> 00:33:42,500
in months after the release of spec

00:33:40,700 --> 00:33:44,420
there's nothing because people are

00:33:42,500 --> 00:33:45,860
implementing or still planning and then

00:33:44,420 --> 00:33:49,490
you start to see stuff arrive and then

00:33:45,860 --> 00:33:51,860
they accelerate so what can you do you

00:33:49,490 --> 00:33:53,270
could read the course back it's only

00:33:51,860 --> 00:33:55,820
3,000 pages

00:33:53,270 --> 00:33:59,120
oh go on you don't need to read all of

00:33:55,820 --> 00:34:01,820
it of course but we do have some other

00:33:59,120 --> 00:34:04,130
stuff which we try to position as

00:34:01,820 --> 00:34:06,110
educational resources for developers and

00:34:04,130 --> 00:34:08,000
other technical roles which will help

00:34:06,110 --> 00:34:10,120
bridge you into the spec respect can be

00:34:08,000 --> 00:34:13,780
challenges sometimes it's certainly big

00:34:10,120 --> 00:34:26,600
so if you go to bluetooth comm

00:34:13,780 --> 00:34:28,640
www.bluepmedia.com give you hands-on

00:34:26,600 --> 00:34:30,740
experience as well we don't have a study

00:34:28,640 --> 00:34:33,410
guide for direction-finding yet that

00:34:30,740 --> 00:34:35,740
will doubtless come as developer bought

00:34:33,410 --> 00:34:35,740
in the market

00:34:35,890 --> 00:34:40,000
the technical overview on the left is

00:34:37,660 --> 00:34:41,470
probably the place to start good summary

00:34:40,000 --> 00:34:45,070
of what it's all about

00:34:41,470 --> 00:34:46,690
and there's some other stuff some of it

00:34:45,070 --> 00:34:49,020
from third parties as well the one on

00:34:46,690 --> 00:34:51,970
the right spire silicon laps who are a

00:34:49,020 --> 00:34:56,650
member of the blue team special interest

00:34:51,970 --> 00:34:58,300
group and maker of Bluetooth stuff and

00:34:56,650 --> 00:35:00,070
that my friends is all I have to say to

00:34:58,300 --> 00:35:01,810
you on the subject of Bluetooth and

00:35:00,070 --> 00:35:03,700
location services and direction-finding

00:35:01,810 --> 00:35:05,320
thank you for listening and I hope that

00:35:03,700 --> 00:35:07,560
was all right to enjoy the sticker if

00:35:05,320 --> 00:35:07,560
not

00:35:07,790 --> 00:35:12,890

YouTube URL: https://www.youtube.com/watch?v=9Yw5rxtrLsQ


