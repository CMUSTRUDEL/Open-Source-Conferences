Title: MountainWest RubyConf 2014 - CRUD! The Consequences of Not Understanding How ActiveRecord ...
Publication date: 2020-01-24
Playlist: MWRC 2014
Description: 
	By Eileen Uchitelle

The magic of ActiveRecord database interactions is easy to rely on and allows us assume it knows best. Without a solid understanding of how ActiveRecord translates into MySQL, however, significant issues can arise. This is particularly true with large data sets and complex model relationships. My talk explores an example for each CRUD function and shows how these queries can result in MySQL timeouts, memory issues or stack level too deep errors. The examples will examine the consequences of chaining large datasets, uses for Arel, and how to avoid encountering major problems and most importantly, how these queries can be rewritten to run more efficiently.

Help us caption & translate this video!

http://amara.org/v/FG2L/
Captions: 
	00:00:24,860 --> 00:00:29,580
hello everyone today we're going to talk

00:00:27,540 --> 00:00:32,730
about a large datasets we have the

00:00:29,580 --> 00:00:34,620
dresser hi my lady shelf I was

00:00:32,730 --> 00:00:39,559
officiated violence anywhere online

00:00:34,620 --> 00:00:41,550
handle any codes and napkins my blog com

00:00:39,559 --> 00:00:43,440
native numbering in the past is on a

00:00:41,550 --> 00:00:45,480
perfect river so we got married and

00:00:43,440 --> 00:00:46,739
change my last name you know it's hard

00:00:45,480 --> 00:00:49,350
for an ounce or just thinking that as

00:00:46,739 --> 00:00:52,649
you should help without that LT it

00:00:49,350 --> 00:00:55,350
should i'm a senior developer at fish me

00:00:52,649 --> 00:00:57,420
we provide simple solutions that help

00:00:55,350 --> 00:00:59,220
our customers educate their home ports

00:00:57,420 --> 00:01:01,530
about fishing ascending stimulated

00:00:59,220 --> 00:01:03,480
spiritual text everyone hears you know

00:01:01,530 --> 00:01:05,809
efficient is but if you don't shoot me

00:01:03,480 --> 00:01:05,809
now

00:01:16,079 --> 00:01:21,280
over 17 million emails time officially

00:01:19,060 --> 00:01:23,950
asked us two thousand nine with that

00:01:21,280 --> 00:01:27,579
signals were surprised Fishman has a lot

00:01:23,950 --> 00:01:29,560
of data I developed many out issues in

00:01:27,579 --> 00:01:32,020
the past but had never won days that

00:01:29,560 --> 00:01:34,600
this large where is that right final

00:01:32,020 --> 00:01:38,469
attempt out hundred hours could blow all

00:01:34,600 --> 00:01:40,179
10,000 after Brevard with the library

00:01:38,469 --> 00:01:42,459
reps the protecting distances from

00:01:40,179 --> 00:01:45,850
having to memorize 12 it's like we

00:01:42,459 --> 00:01:48,009
magically pull a father in heaven but I

00:01:45,850 --> 00:01:51,009
anything roaring SQL output is not a

00:01:48,009 --> 00:01:53,170
baby to school ignorance only leads us

00:01:51,009 --> 00:01:54,849
to blame acrobatic for our problems and

00:01:53,170 --> 00:01:57,069
knocking accountable for the clothes

00:01:54,849 --> 00:01:59,950
that we right there were many times

00:01:57,069 --> 00:02:02,920
where I poked out of everything best and

00:01:59,950 --> 00:02:04,780
I didn't break lawful queries I wasn't

00:02:02,920 --> 00:02:07,899
paying enough attention to how I code

00:02:04,780 --> 00:02:10,110
India or interact with each other and I

00:02:07,899 --> 00:02:13,480
was setting myself up for disappointment

00:02:10,110 --> 00:02:16,390
and when mysql crash for my marriage was

00:02:13,480 --> 00:02:20,769
low I have a drink how can after

00:02:16,390 --> 00:02:24,970
prevalence right hahahaha hood clear

00:02:20,769 --> 00:02:27,100
coat and I have no issues but deep down

00:02:24,970 --> 00:02:29,980
I mean this was an active reference of

00:02:27,100 --> 00:02:33,430
all who is my first humanist natural

00:02:29,980 --> 00:02:35,200
properties extended to be on equal we

00:02:33,430 --> 00:02:37,600
need to understand how after record

00:02:35,200 --> 00:02:40,299
would translate into my school so he can

00:02:37,600 --> 00:02:43,720
tell he'll be lots of case he can all be

00:02:40,299 --> 00:02:46,310
friends with Africa after ton of

00:02:43,720 --> 00:02:48,550
research I figured out there better

00:02:46,310 --> 00:02:52,040
cheers to avoid high school time out

00:02:48,550 --> 00:02:54,170
memory leaks and slow queries I'm going

00:02:52,040 --> 00:02:57,040
to tell you about my mistake so you can

00:02:54,170 --> 00:02:59,360
avoid personal problems of a progression

00:02:57,040 --> 00:03:03,200
for each of the fundamental protections

00:02:59,360 --> 00:03:05,390
create read update and delete I'm going

00:03:03,200 --> 00:03:08,720
to decorative automatic counters after

00:03:05,390 --> 00:03:10,519
record every solution economic heart

00:03:08,720 --> 00:03:13,069
functions are relevant to any persistent

00:03:10,519 --> 00:03:15,560
jamesburg I can be found in many African

00:03:13,069 --> 00:03:18,950
application creatively represented by

00:03:15,560 --> 00:03:22,459
three in the URL or a certain high

00:03:18,950 --> 00:03:25,700
school briefly demonstrate in the grass

00:03:22,459 --> 00:03:27,590
would fine by me to pluck where and many

00:03:25,700 --> 00:03:30,980
others as well as the left in high

00:03:27,590 --> 00:03:33,410
school updates coming up the attributes

00:03:30,980 --> 00:03:36,349
update all and rails and press update in

00:03:33,410 --> 00:03:39,970
high school the last leads would need to

00:03:36,349 --> 00:03:42,019
destroy Tony all trail rels and delete

00:03:39,970 --> 00:03:44,900
masculine swimming about to leave much

00:03:42,019 --> 00:03:46,819
of them once understood is not typical

00:03:44,900 --> 00:03:49,280
to find car functions in all facets of

00:03:46,819 --> 00:03:52,310
our application from database to user

00:03:49,280 --> 00:03:53,900
interface to HTTP requests ventures hi

00:03:52,310 --> 00:03:57,280
examples represent provider from the

00:03:53,900 --> 00:03:57,280
database would have to recognize

00:04:00,230 --> 00:04:04,970
for example let's imagine how and

00:04:02,540 --> 00:04:06,920
applications an address book using a

00:04:04,970 --> 00:04:09,860
vertical column associations of

00:04:06,920 --> 00:04:11,420
knowledge and insight here in the earth

00:04:09,860 --> 00:04:14,750
each which of those models and their

00:04:11,420 --> 00:04:18,079
associations and if we look at them as

00:04:14,750 --> 00:04:20,709
clover can see each user has been a

00:04:18,079 --> 00:04:23,540
contest that has many categories

00:04:20,709 --> 00:04:27,199
contacts the log the user and how many

00:04:23,540 --> 00:04:28,669
categories the cavitations cataracts

00:04:27,199 --> 00:04:31,160
belong to your user and how many

00:04:28,669 --> 00:04:33,979
contacts with categorizations contacts

00:04:31,160 --> 00:04:35,870
the petals are many many Association

00:04:33,979 --> 00:04:39,620
they are connected through a third

00:04:35,870 --> 00:04:41,330
pattern decisions conversations belong

00:04:39,620 --> 00:04:43,550
to a contact and belongs to a category

00:04:41,330 --> 00:04:45,979
of the joint table with out of

00:04:43,550 --> 00:04:49,220
categorization contest do not know about

00:04:45,979 --> 00:04:52,550
categories and experts on let's start

00:04:49,220 --> 00:04:54,050
with free imagine how to see is the

00:04:52,550 --> 00:04:57,080
spreadsheet they want to use to create

00:04:54,050 --> 00:05:00,050
our contacts this version has 10,000

00:04:57,080 --> 00:05:02,630
rows maybe just run from each throw the

00:05:00,050 --> 00:05:06,169
CSD and create individual costs happy a

00:05:02,630 --> 00:05:08,389
parameter this will create the following

00:05:06,169 --> 00:05:10,130
SQL trillion interesting for each

00:05:08,389 --> 00:05:12,680
individual contact that needs to be

00:05:10,130 --> 00:05:14,539
added to the database is interesting and

00:05:12,680 --> 00:05:17,240
we reckon about Hans would you take

00:05:14,539 --> 00:05:20,840
quite a lot what are they waiting in

00:05:17,240 --> 00:05:23,360
certain one of our everyday pause after

00:05:20,840 --> 00:05:25,910
a lot of research I found who is great

00:05:23,360 --> 00:05:27,560
she's my school staff Newser just keep

00:05:25,910 --> 00:05:30,320
this method the speed of operation for

00:05:27,560 --> 00:05:32,750
10,000 persons quite a bit and it will

00:05:30,320 --> 00:05:36,280
be scared with this new getting our

00:05:32,750 --> 00:05:36,280
hands dirty in August remember

00:05:37,449 --> 00:05:42,560
it's not often this happens around there

00:05:40,400 --> 00:05:46,330
unfortunately there's no complimented

00:05:42,560 --> 00:05:48,620
inactive records we have to abandon this

00:05:46,330 --> 00:05:51,740
using the same spreadsheet of 10,000

00:05:48,620 --> 00:05:55,159
contacts will create our records using

00:05:51,740 --> 00:05:57,500
mysql fetch insert first will be Pedro

00:05:55,159 --> 00:06:02,240
the CSP and create an array of all the

00:05:57,500 --> 00:06:05,090
contacts that educators in SF das guys

00:06:02,240 --> 00:06:07,219
even work he's my school can't handle

00:06:05,090 --> 00:06:09,800
all three thousand records it works well

00:06:07,219 --> 00:06:13,639
enough going on high school decides for

00:06:09,800 --> 00:06:15,319
mastery sizes were not terrible after a

00:06:13,639 --> 00:06:17,030
lot of trial of error I thought you

00:06:15,319 --> 00:06:21,490
thousands rely the setting for my

00:06:17,030 --> 00:06:21,490
slippers but you have to experiment to

00:06:22,449 --> 00:06:26,569
let the certain all the contacts the

00:06:24,919 --> 00:06:28,969
contact Dalek survey ship divided

00:06:26,569 --> 00:06:31,370
bachelors shift removes the specified

00:06:28,969 --> 00:06:33,590
number of contacts we move from in the

00:06:31,370 --> 00:06:37,370
array which brutha it does this until

00:06:33,590 --> 00:06:39,740
the contact dollars raised empty an SQL

00:06:37,370 --> 00:06:42,169
statement is then with the opportunities

00:06:39,740 --> 00:06:44,449
and values the insert we need to join

00:06:42,169 --> 00:06:47,180
the shin to contacts to be the valley

00:06:44,449 --> 00:06:49,460
exist balancer is made possible the

00:06:47,180 --> 00:06:51,279
inserts attacks but eating all the

00:06:49,460 --> 00:06:54,050
values for each record you won't create

00:06:51,279 --> 00:06:55,789
this can be quite at least a lot of

00:06:54,050 --> 00:06:59,199
Palms there we need is the culmination

00:06:55,789 --> 00:07:00,979
amend the values must line up perfectly

00:06:59,199 --> 00:07:04,279
finally we connect to the database

00:07:00,979 --> 00:07:05,990
execute conspiracy I letting them that

00:07:04,279 --> 00:07:10,729
this example as soon as you satisfies

00:07:05,990 --> 00:07:12,469
the input against SQL injection vastly

00:07:10,729 --> 00:07:14,550
increase the college high school period

00:07:12,469 --> 00:07:16,740
it also lost so here's the other

00:07:14,550 --> 00:07:19,440
except it's chaining all the values

00:07:16,740 --> 00:07:22,410
group is that thing when you insert

00:07:19,440 --> 00:07:25,770
statement for each clock let's check out

00:07:22,410 --> 00:07:28,410
his feet on these two queries when using

00:07:25,770 --> 00:07:31,260
a benchmark on Ruby standard effort the

00:07:28,410 --> 00:07:33,810
album represents user CPUs must system

00:07:31,260 --> 00:07:37,080
cpu talks the songs of using assistive

00:07:33,810 --> 00:07:39,330
CPU time and the illustrator who is a

00:07:37,080 --> 00:07:42,480
Detroiter bogus be too high a physical

00:07:39,330 --> 00:07:45,600
system the example recreate each market

00:07:42,480 --> 00:07:47,430
activity took 45 foot back steps as a

00:07:45,600 --> 00:07:50,190
long time to eat for 10,000 rector

00:07:47,430 --> 00:07:51,930
street is moving to the database my

00:07:50,190 --> 00:07:58,710
schoolbag desert took less than other

00:07:51,930 --> 00:08:00,960
seconds of as a huge difference Thank

00:07:58,710 --> 00:08:02,940
You Martin times may vary based on

00:08:00,960 --> 00:08:04,470
garbage collection allocated memory of

00:08:02,940 --> 00:08:06,750
the version of Irving and browser you're

00:08:04,470 --> 00:08:09,120
using it doesn't change the fact that my

00:08:06,750 --> 00:08:10,770
schoolbag desert is drastically faster

00:08:09,120 --> 00:08:13,050
and safe creating and saving each

00:08:10,770 --> 00:08:15,690
individual vector but because we're not

00:08:13,050 --> 00:08:18,090
saying each prayer no call that's when

00:08:15,690 --> 00:08:21,870
we are through these giving the model

00:08:18,090 --> 00:08:24,660
they going straight to the games Bela's

00:08:21,870 --> 00:08:27,060
recent data let's say we wanted to

00:08:24,660 --> 00:08:28,910
output the person in each contact their

00:08:27,060 --> 00:08:31,890
mobile ways to achieve the same result

00:08:28,910 --> 00:08:34,260
you can learn each on contacts out first

00:08:31,890 --> 00:08:37,050
me then we have a lot of vertically to

00:08:34,260 --> 00:08:39,120
be quite costly our memory the single

00:08:37,050 --> 00:08:42,420
SQL so you can find all the records are

00:08:39,120 --> 00:08:45,750
collectibles binding to the great wave

00:08:42,420 --> 00:08:49,290
signal time and they're fine each will

00:08:45,750 --> 00:08:50,940
collect our data without regardless we

00:08:49,290 --> 00:08:53,100
want to make sure we are always using

00:08:50,940 --> 00:08:56,370
our server resources effectively and

00:08:53,100 --> 00:08:57,960
efficiently I nice houses do that by the

00:08:56,370 --> 00:09:01,290
right living selects

00:08:57,960 --> 00:09:03,510
we r memory lastly since we were on the

00:09:01,290 --> 00:09:04,920
outgoing the person game you can get me

00:09:03,510 --> 00:09:07,500
too close together instead of Africa

00:09:04,920 --> 00:09:09,180
this is learning much faster is in

00:09:07,500 --> 00:09:11,940
medical create the right of strings

00:09:09,180 --> 00:09:13,560
instead of returning objects we will

00:09:11,940 --> 00:09:17,730
only have the person named after you

00:09:13,560 --> 00:09:21,090
though and not for us to direct so which

00:09:17,730 --> 00:09:24,150
one is queries into classes each

00:09:21,090 --> 00:09:25,740
benchmarks are once a fine age is not

00:09:24,150 --> 00:09:27,870
much faster but again with collecting

00:09:25,740 --> 00:09:30,750
records were for concern with memory in

00:09:27,870 --> 00:09:34,670
time 10,000 records will forever never

00:09:30,750 --> 00:09:37,320
know 100,000 hours when I'm not wanted

00:09:34,670 --> 00:09:40,170
with flow you can see a lot of time see

00:09:37,320 --> 00:09:41,610
it's a law passionate each for finding

00:09:40,170 --> 00:09:50,940
since we only have need the records

00:09:41,610 --> 00:09:52,380
first mate ok so maybe you're not what

00:09:50,940 --> 00:09:56,100
were these networks look like we have

00:09:52,380 --> 00:09:58,350
every thousand records here we see you

00:09:56,100 --> 00:10:00,750
in the dataset in procedure 10,000

00:09:58,350 --> 00:10:03,090
100,000 records the land I'm careers

00:10:00,750 --> 00:10:05,850
taste increases quite law then the

00:10:03,090 --> 00:10:08,190
savings are more obvious on the y-axis

00:10:05,850 --> 00:10:10,080
we have a number of sessions and the

00:10:08,190 --> 00:10:13,020
x-axis represents the number of product

00:10:10,080 --> 00:10:15,699
for 100,000 records each in UTC almost

00:10:13,020 --> 00:10:18,910
11 seconds I need approval

00:10:15,699 --> 00:10:23,169
free plug-in reddy's plastics at some

00:10:18,910 --> 00:10:25,679
point alongside another nation method

00:10:23,169 --> 00:10:28,329
that after every provides is far- hello

00:10:25,679 --> 00:10:33,850
this method allows us to craft custom

00:10:28,329 --> 00:10:35,529
SQL queries at times when writing our

00:10:33,850 --> 00:10:37,119
careers dis radiating faster and more

00:10:35,529 --> 00:10:38,589
efficient because after government

00:10:37,119 --> 00:10:42,129
doesn't always know the best way to get

00:10:38,589 --> 00:10:43,809
the theater looking for we can variates

00:10:42,129 --> 00:10:50,249
or aquifers that the reason performance

00:10:43,809 --> 00:10:50,249
with highlights come up now stability

00:10:50,489 --> 00:10:54,850
let's say you want to change all of our

00:10:52,749 --> 00:10:57,160
categorizations from a workers category

00:10:54,850 --> 00:10:58,600
to the network a degree in this period

00:10:57,160 --> 00:11:00,309
you're collecting all the records would

00:10:58,600 --> 00:11:02,769
love to using category ID attribute on

00:11:00,309 --> 00:11:04,689
each of our musical technologies we are

00:11:02,769 --> 00:11:08,589
instantiated updating each individual

00:11:04,689 --> 00:11:10,269
record for all NFL the bottom SQL be

00:11:08,589 --> 00:11:12,999
reduced immunity for all compiled

00:11:10,269 --> 00:11:15,819
records obtained ionization sick however

00:11:12,999 --> 00:11:17,410
82 14 categorizations ideas want they

00:11:15,819 --> 00:11:19,689
would do this for counter decision

00:11:17,410 --> 00:11:25,359
ladies two and three for all the way to

00:11:19,689 --> 00:11:27,129
10,000 a better way of the ala

00:11:25,359 --> 00:11:31,749
categories from enormous calibers and

00:11:27,129 --> 00:11:33,879
network at her movie use multi all this

00:11:31,749 --> 00:11:35,709
method creates a single SQL up tasting

00:11:33,879 --> 00:11:38,529
update conversations that

00:11:35,709 --> 00:11:40,720
categorizations coverage not represent

00:11:38,529 --> 00:11:44,079
non station and I'll alternative once

00:11:40,720 --> 00:11:45,759
without running say manja project again

00:11:44,079 --> 00:11:50,319
because we aren't sending individual

00:11:45,759 --> 00:11:52,560
objects bill called axle you fire the

00:11:50,319 --> 00:11:55,830
first query regarding usual

00:11:52,560 --> 00:12:02,820
a sport instead that's not too long ago

00:11:55,830 --> 00:12:05,010
behemoth how do you go she also fast for

00:12:02,820 --> 00:12:07,170
10,000 workers fairly register just

00:12:05,010 --> 00:12:10,830
taking any time to call that's

00:12:07,170 --> 00:12:12,630
incredible savings of senior now for

00:12:10,830 --> 00:12:14,430
them this is my favorite of the four

00:12:12,630 --> 00:12:17,790
five functions because the interesting

00:12:14,430 --> 00:12:19,620
problems I'd like to talk about a week

00:12:17,790 --> 00:12:21,779
we firstly to discuss the differences

00:12:19,620 --> 00:12:24,060
between the we all destroyer cost

00:12:21,779 --> 00:12:28,589
anything and serena has many association

00:12:24,060 --> 00:12:30,720
affect their up he is rigidly leading a

00:12:28,589 --> 00:12:33,630
mom with three straight and the

00:12:30,720 --> 00:12:35,910
dependency is that destroyed delete all

00:12:33,630 --> 00:12:38,850
board assured the contact with all

00:12:35,910 --> 00:12:41,040
associated categorization kabiru too

00:12:38,850 --> 00:12:43,950
strong on that will remove contest

00:12:41,040 --> 00:12:48,060
individually and park all that's when it

00:12:43,950 --> 00:12:49,740
ends you specified from the SQL is to

00:12:48,060 --> 00:12:52,320
the Associated categorization is

00:12:49,740 --> 00:12:54,930
selected removed and inherent how to

00:12:52,320 --> 00:12:56,640
work contact is that deleted will do

00:12:54,930 --> 00:12:58,200
this individually for all Terra Bella

00:12:56,640 --> 00:13:02,730
contacts and all associated

00:12:58,200 --> 00:13:05,250
categorization in the database if we

00:13:02,730 --> 00:13:07,530
have step onto the heat on that only

00:13:05,250 --> 00:13:10,550
those contacts of your bid regardlessly

00:13:07,530 --> 00:13:14,040
depends he is set to be awfully strike

00:13:10,550 --> 00:13:15,520
the phone sqlstate can be produced no

00:13:14,040 --> 00:13:18,640
categorizations we

00:13:15,520 --> 00:13:20,950
we need to meet all our hot tubs the we

00:13:18,640 --> 00:13:22,480
all will not destroy in your context and

00:13:20,950 --> 00:13:26,700
will not bar called as a realm of

00:13:22,480 --> 00:13:30,010
Harrenhal all attacks are moved it was

00:13:26,700 --> 00:13:32,050
if no offense we said to straddle and

00:13:30,010 --> 00:13:35,410
two people both in related patterns

00:13:32,050 --> 00:13:38,280
Asians and only remove the context the

00:13:35,410 --> 00:13:40,780
difference is however those problems

00:13:38,280 --> 00:13:42,700
delete all three moves and olive oils

00:13:40,780 --> 00:13:44,710
with the exact same SQL statement is

00:13:42,700 --> 00:13:48,220
demonstrated earlier ignores the

00:13:44,710 --> 00:13:50,620
categorization as it did before destroy

00:13:48,220 --> 00:13:53,920
about a dependency removes each contact

00:13:50,620 --> 00:13:56,800
provision but not have relations this is

00:13:53,920 --> 00:13:58,570
because no dependency specified it's

00:13:56,800 --> 00:14:00,190
important to keep these details of mind

00:13:58,570 --> 00:14:03,190
the setting up our models are still

00:14:00,190 --> 00:14:05,290
asleep easy entities can have some

00:14:03,190 --> 00:14:07,750
interesting side effects you know we all

00:14:05,290 --> 00:14:11,530
works trail or run asphyxiated records

00:14:07,750 --> 00:14:13,810
to a parent home what if we want to run

00:14:11,530 --> 00:14:15,910
free like having it up on texture all

00:14:13,810 --> 00:14:24,790
regardless of the dependencies someone

00:14:15,910 --> 00:14:26,200
has a problem when I'm this multi critic

00:14:24,790 --> 00:14:28,090
contacts that are released two

00:14:26,200 --> 00:14:30,940
categories category does not own

00:14:28,090 --> 00:14:32,320
economies the only bank catherine was

00:14:30,940 --> 00:14:34,870
about how fast is through

00:14:32,320 --> 00:14:36,190
categorizations so this code is only

00:14:34,870 --> 00:14:40,630
going to delete those related

00:14:36,190 --> 00:14:42,490
categorization not the contacts so let's

00:14:40,630 --> 00:14:44,260
change that from where we want to be

00:14:42,490 --> 00:14:46,930
sure we are always writing clear concise

00:14:44,260 --> 00:14:48,700
code no one has their model associations

00:14:46,930 --> 00:14:50,800
memorized and a lot of developers would

00:14:48,700 --> 00:14:53,230
think the contacts deleted not the

00:14:50,800 --> 00:14:57,250
conversations instead that's right

00:14:53,230 --> 00:15:00,910
category a conversation trial when

00:14:57,250 --> 00:15:02,470
unfortunately that's why you use we're

00:15:00,910 --> 00:15:03,850
not we're not believe how to boost

00:15:02,470 --> 00:15:07,190
memory

00:15:03,850 --> 00:15:09,200
balance case i want to just delete the

00:15:07,190 --> 00:15:12,519
categorizations so doesn't stand up

00:15:09,200 --> 00:15:14,540
having a conversation too long

00:15:12,519 --> 00:15:16,700
relationship between category and

00:15:14,540 --> 00:15:19,250
peregrination is called election proxy

00:15:16,700 --> 00:15:21,079
corral socks describe an election party

00:15:19,250 --> 00:15:23,149
as the middleman between the object

00:15:21,079 --> 00:15:26,420
levels association in our budget

00:15:23,149 --> 00:15:29,300
category any associated object the

00:15:26,420 --> 00:15:31,490
characterizations let's look at how

00:15:29,300 --> 00:15:33,320
let's look at how the dependency

00:15:31,490 --> 00:15:35,000
settings on a house many association

00:15:33,320 --> 00:15:38,510
affected leading members through a

00:15:35,000 --> 00:15:40,579
question if we're I'm have a great

00:15:38,510 --> 00:15:43,070
saturday shins to be hall and havin no

00:15:40,579 --> 00:15:45,440
dependency step instead of removing the

00:15:43,070 --> 00:15:48,320
categorizations the category in those

00:15:45,440 --> 00:15:49,670
records will be set to health this is

00:15:48,320 --> 00:15:52,130
named as the default setting on a

00:15:49,670 --> 00:15:53,720
collection Hawk seems to know the

00:15:52,130 --> 00:15:56,120
records are being left in the database

00:15:53,720 --> 00:15:58,100
instead of being removed because he is

00:15:56,120 --> 00:15:59,839
an update statement on setting a

00:15:58,100 --> 00:16:06,050
categorization scattered you to know

00:15:59,839 --> 00:16:10,100
instead of what if we set the dependency

00:16:06,050 --> 00:16:11,959
option to destroy instead well not these

00:16:10,100 --> 00:16:13,910
each rather be instantiated in to lead

00:16:11,959 --> 00:16:17,089
an individual if this is what we want

00:16:13,910 --> 00:16:19,070
you to just use destroy generally using

00:16:17,089 --> 00:16:20,540
the average product we want the referee

00:16:19,070 --> 00:16:24,560
to leave their homes these are trying to

00:16:20,540 --> 00:16:26,209
save time than them we won't know what

00:16:24,560 --> 00:16:28,030
to wait for individual objects of your

00:16:26,209 --> 00:16:32,830
room it's a peaceful purposes

00:16:28,030 --> 00:16:35,800
all first place okay so 14 said the

00:16:32,830 --> 00:16:40,480
dependency on to legal she passed my

00:16:35,800 --> 00:16:44,980
vision great that's right a hundred

00:16:40,480 --> 00:16:48,190
thirty seconds but that wasn't fast at

00:16:44,980 --> 00:16:50,410
all something's not right let's take a

00:16:48,190 --> 00:16:53,800
look what's going on underneath service

00:16:50,410 --> 00:16:56,140
I expected the SQL statement tubidy

00:16:53,800 --> 00:16:59,080
delete from categorizations 4 counters

00:16:56,140 --> 00:17:01,030
agents category these more instead I got

00:16:59,080 --> 00:17:03,220
delete from delete from conversations

00:17:01,030 --> 00:17:05,620
for categorization on category in front

00:17:03,220 --> 00:17:08,770
and categorization second version 4 x 6

00:17:05,620 --> 00:17:10,690
all the way to 10,000 this is because

00:17:08,770 --> 00:17:12,580
when deleting a collection proxy until

00:17:10,690 --> 00:17:14,440
the all dependency needs to return an

00:17:12,580 --> 00:17:16,900
array of all the records if you dig

00:17:14,440 --> 00:17:19,300
remove because it needs to collect all

00:17:16,900 --> 00:17:22,450
the objects bridge from them is I making

00:17:19,300 --> 00:17:25,030
it very very slow this is definitely not

00:17:22,450 --> 00:17:28,650
what I expected really ball and it is it

00:17:25,030 --> 00:17:31,690
really fast so how do i fix this problem

00:17:28,650 --> 00:17:33,580
this is easy in theory as always i am

00:17:31,690 --> 00:17:36,550
the leading that this their associations

00:17:33,580 --> 00:17:38,610
to be whiskey and Pompey we already know

00:17:36,550 --> 00:17:40,660
it is removed so we collect the

00:17:38,610 --> 00:17:42,550
categorization through the cattle

00:17:40,660 --> 00:17:45,990
raiding and delete them directly instead

00:17:42,550 --> 00:17:49,630
of her association the coast clear and

00:17:45,990 --> 00:17:52,840
concise that's part that regardless be

00:17:49,630 --> 00:17:54,970
the ten thousand records it also

00:17:52,840 --> 00:17:56,290
produces the super simple SQL statement

00:17:54,970 --> 00:17:58,270
we are expecting in the earlier career

00:17:56,290 --> 00:18:01,090
so the from categorizations for

00:17:58,270 --> 00:18:05,260
categorizations category these warm now

00:18:01,090 --> 00:18:08,830
that's what we offer you so why don't we

00:18:05,260 --> 00:18:10,720
learn in these examples after forever is

00:18:08,830 --> 00:18:14,170
a great tool we shouldn't let some

00:18:10,720 --> 00:18:15,970
magical properties may be sleep our

00:18:14,170 --> 00:18:17,130
assumptions about active record can have

00:18:15,970 --> 00:18:19,110
a major concert

00:18:17,130 --> 00:18:21,510
we aren't any close attention to our

00:18:19,110 --> 00:18:25,530
careers are we translated to sequel this

00:18:21,510 --> 00:18:27,030
is especially true with our today s s we

00:18:25,530 --> 00:18:28,650
can overcome most problems with our

00:18:27,030 --> 00:18:31,200
queries actually you are asking after

00:18:28,650 --> 00:18:34,740
primitive and we are aware of the

00:18:31,200 --> 00:18:36,330
consequences of our quote there's a

00:18:34,740 --> 00:18:39,210
really great result there n healthy for

00:18:36,330 --> 00:18:41,550
libraries in the ravaged me relevant

00:18:39,210 --> 00:18:44,030
identify places where reminders flow SQL

00:18:41,550 --> 00:18:46,410
queries they're consuming our memory

00:18:44,030 --> 00:18:47,880
mini pro rata are at best your

00:18:46,410 --> 00:18:50,520
application that workhorse previous

00:18:47,880 --> 00:18:52,650
times from the database in the bullet

00:18:50,520 --> 00:18:54,510
jump identifies animals point threes and

00:18:52,650 --> 00:18:59,750
notifies you if you add you you're

00:18:54,510 --> 00:18:59,750

YouTube URL: https://www.youtube.com/watch?v=lOpVcqiAIiI


