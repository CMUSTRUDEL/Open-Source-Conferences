Title: Shawn Chang - Introduction to GNU Linux hardening - openSUSE Conference 2013
Publication date: 2013-07-22
Playlist: openSUSE Conference 2013
Description: 
	Security issues are becoming more importantly than ever before. When you want to deploy your own application, hardening is a inevitable problem that you have to consider about. GNU/Linux itself providing a lot of hardening techniques, including conventional hardening techniques such as non-executable stack/Relocation read-only/ASLR/PIE in GCC/glibc level, and confinement technologies, such as SELinux, Apparmor.
Captions: 
	00:00:00,000 --> 00:00:09,540
it's a start yeah so did on Nicki guys

00:00:04,490 --> 00:00:12,630
my name is Shawn charm and well I like

00:00:09,540 --> 00:00:16,650
to to be here it's very nice here in

00:00:12,630 --> 00:00:18,500
Greek innocuous and I like to give you

00:00:16,650 --> 00:00:21,029
guys a free speech about the

00:00:18,500 --> 00:00:27,210
introduction to get on the next

00:00:21,029 --> 00:00:30,960
hardening and cess barge in de and Who

00:00:27,210 --> 00:00:35,940
am I yeah Chinese do yeah and I used to

00:00:30,960 --> 00:00:38,850
be a monkey coder it was get involved

00:00:35,940 --> 00:00:42,660
with some networking devices development

00:00:38,850 --> 00:00:45,629
then I decided to be a scary guys right

00:00:42,660 --> 00:00:51,030
now I'm working for Souza in beijing

00:00:45,629 --> 00:00:54,750
office and let's start yet before I dive

00:00:51,030 --> 00:00:57,719
into the details about how to do the

00:00:54,750 --> 00:01:00,780
Harding stuff in token on linux and we

00:00:57,719 --> 00:01:04,339
just need to draw some the you know the

00:01:00,780 --> 00:01:09,000
prerequisite pictures here it's like on

00:01:04,339 --> 00:01:12,170
in traditional memory layout a listing

00:01:09,000 --> 00:01:17,820
the Intel CPU is like this and there's a

00:01:12,170 --> 00:01:22,619
steak and heip and the when you are

00:01:17,820 --> 00:01:25,049
functions just invoke a color i mean the

00:01:22,619 --> 00:01:27,630
the when you call a function then you

00:01:25,049 --> 00:01:30,930
will push and you push those data onto

00:01:27,630 --> 00:01:35,369
the stack the stack is closed down work

00:01:30,930 --> 00:01:39,210
and yeah maybe you don't need to really

00:01:35,369 --> 00:01:43,310
figure out this bill right here is an

00:01:39,210 --> 00:01:46,950
example about this is a very simple

00:01:43,310 --> 00:01:49,799
venerable program i guess in the input

00:01:46,950 --> 00:01:53,610
part in this program doesn't have a mean

00:01:49,799 --> 00:01:58,979
punk chicks and then the if the tucker

00:01:53,610 --> 00:02:01,619
scan attacker can craft malicious inputs

00:01:58,979 --> 00:02:04,950
and to overwrite the the return address

00:02:01,619 --> 00:02:08,399
then the attacker can control the whole

00:02:04,950 --> 00:02:13,390
on the flow of the execution of the

00:02:08,399 --> 00:02:18,040
program and yeah that but this one

00:02:13,390 --> 00:02:22,360
this memory layout is very on old school

00:02:18,040 --> 00:02:24,870
maybe 1990s in two thousand but for now

00:02:22,360 --> 00:02:28,360
is going to be some change because of

00:02:24,870 --> 00:02:30,970
good on linux just like GCC and GFC

00:02:28,360 --> 00:02:34,650
providing some medication to acknowledge

00:02:30,970 --> 00:02:38,709
to prevent such a texts like this and

00:02:34,650 --> 00:02:42,040
yeah because i only have 50 minutes so i

00:02:38,709 --> 00:02:46,090
just can't dive into the every detail of

00:02:42,040 --> 00:02:51,940
this stuff so i just listed the further

00:02:46,090 --> 00:02:58,050
reading here and the first one was it is

00:02:51,940 --> 00:03:00,640
released in the Frog paper in 1996 and

00:02:58,050 --> 00:03:02,560
there one it's very old school on if you

00:03:00,640 --> 00:03:06,070
really want to just figure out what's

00:03:02,560 --> 00:03:07,989
the stake page though overflow is I just

00:03:06,070 --> 00:03:10,630
such as you guys just looking at it

00:03:07,989 --> 00:03:15,040
there's two other resources and there's

00:03:10,630 --> 00:03:17,530
a working you guys probably if you want

00:03:15,040 --> 00:03:19,750
to have you found just play the work in

00:03:17,530 --> 00:03:26,140
there's a really awesome hecker there's

00:03:19,750 --> 00:03:29,860
like blah yay whatever and here for now

00:03:26,140 --> 00:03:33,730
the first aspect of the heartening I

00:03:29,860 --> 00:03:40,180
want to talk about the GCC and she lives

00:03:33,730 --> 00:03:44,530
chillip sea level and and for now the so

00:03:40,180 --> 00:03:48,910
there's a at least two to a very common

00:03:44,530 --> 00:03:51,010
medication technologies which provided

00:03:48,910 --> 00:03:53,500
by the GCC here is the first one in the

00:03:51,010 --> 00:03:59,500
state cannery and second one is p IE

00:03:53,500 --> 00:04:02,790
stuff and it's gone and it's very easy

00:03:59,500 --> 00:04:08,470
when you want to compile the program

00:04:02,790 --> 00:04:14,560
just add their Jesus options that there

00:04:08,470 --> 00:04:17,919
be a it's like this function and if you

00:04:14,560 --> 00:04:20,709
don't have the state canneries just lay

00:04:17,919 --> 00:04:23,890
out just like that but if you are just

00:04:20,709 --> 00:04:25,639
add the cheesy connection and not GCC

00:04:23,890 --> 00:04:28,490
options and the

00:04:25,639 --> 00:04:34,939
the layout is a little bit of different

00:04:28,490 --> 00:04:39,830
they will the GCC will on put four bytes

00:04:34,939 --> 00:04:43,270
or eight bytes canneries and after the

00:04:39,830 --> 00:04:47,479
frame and pointer and if there's a

00:04:43,270 --> 00:04:51,319
vulnerability in a program an attacker

00:04:47,479 --> 00:04:56,180
if the attacker want huge just control

00:04:51,319 --> 00:04:59,409
the return address and if it overwrites

00:04:56,180 --> 00:05:03,110
the cannery and the camry will warn and

00:04:59,409 --> 00:05:06,259
yeah that's that's pretty on is stuff

00:05:03,110 --> 00:05:08,330
and actually for the most developers you

00:05:06,259 --> 00:05:11,090
don't need to just figure out was that

00:05:08,330 --> 00:05:14,930
can raise but I just suggest if you

00:05:11,090 --> 00:05:18,770
compile your program and please it is

00:05:14,930 --> 00:05:23,719
and there's a to the first one it will

00:05:18,770 --> 00:05:26,479
not check every functions but the second

00:05:23,719 --> 00:05:32,539
one it will check every functions but it

00:05:26,479 --> 00:05:37,639
will cost the performance and yeah

00:05:32,539 --> 00:05:42,409
there's also on a hardening stuff which

00:05:37,639 --> 00:05:46,520
provide by the GCC and this was like the

00:05:42,409 --> 00:05:52,370
p IE it will randomize the whole code

00:05:46,520 --> 00:05:57,710
segments for the panel ruiz but in on 32

00:05:52,370 --> 00:06:01,969
bits a platform I because p IE has to

00:05:57,710 --> 00:06:08,000
use the at least one cpu register there

00:06:01,969 --> 00:06:11,240
so on as we both know that in intel cpu

00:06:08,000 --> 00:06:16,789
we don't have much cpu registers there

00:06:11,240 --> 00:06:20,500
so if the in the 32 bit system if we

00:06:16,789 --> 00:06:25,099
just turn on the p IE stuff it will cost

00:06:20,500 --> 00:06:28,490
ya a little bit much of the provenance

00:06:25,099 --> 00:06:33,110
but for the 64 bits okay no linux i

00:06:28,490 --> 00:06:36,769
think they won't be a problem and but if

00:06:33,110 --> 00:06:39,120
you really want to what one the pio

00:06:36,769 --> 00:06:45,979
works you need to just

00:06:39,120 --> 00:06:45,979
around the is lr it's a dress

00:06:48,260 --> 00:06:56,970
randomization of the whole data and heap

00:06:52,100 --> 00:06:59,820
that the layouts another memory there is

00:06:56,970 --> 00:07:03,210
a very simple program that you can see

00:06:59,820 --> 00:07:08,340
just return the return address and the

00:07:03,210 --> 00:07:13,289
IP is yep you will store the address

00:07:08,340 --> 00:07:17,389
which the next instruction will be

00:07:13,289 --> 00:07:22,979
executed and you can see if you turn the

00:07:17,389 --> 00:07:30,360
SAR the colonel on the randomization of

00:07:22,979 --> 00:07:33,510
the address and they will just yeah also

00:07:30,360 --> 00:07:37,380
randomized not just for the steak and

00:07:33,510 --> 00:07:44,310
the hip part they're also the that I

00:07:37,380 --> 00:07:49,919
mean the code segment yet and there's

00:07:44,310 --> 00:07:53,190
other medications in GCC probably you

00:07:49,919 --> 00:07:56,250
guys could just think about it and the

00:07:53,190 --> 00:07:59,940
first one is a 45 source is present some

00:07:56,250 --> 00:08:03,539
string formats but abilities and that

00:07:59,940 --> 00:08:10,680
then the second one is it won't be

00:08:03,539 --> 00:08:15,889
allowed to the executable code down the

00:08:10,680 --> 00:08:19,979
stack that but and thur along is a

00:08:15,889 --> 00:08:24,840
relocation relocation are read only for

00:08:19,979 --> 00:08:28,260
the LF for net a penury yes it's pretty

00:08:24,840 --> 00:08:30,479
pretty easy just add these options in

00:08:28,260 --> 00:08:35,729
your program if you don't care about the

00:08:30,479 --> 00:08:41,659
performance hit so yes this medication

00:08:35,729 --> 00:08:45,390
is can be ensure to a hundred percent to

00:08:41,659 --> 00:08:48,000
prevent this tag those are lists of your

00:08:45,390 --> 00:08:51,480
many papers and materials here then it

00:08:48,000 --> 00:08:55,220
will teach you if you find the

00:08:51,480 --> 00:08:59,250
venerable on stuff in your program and

00:08:55,220 --> 00:09:04,410
but how to bypass these medications and

00:08:59,250 --> 00:09:07,139
the Jesus a level and yeah the network

00:09:04,410 --> 00:09:14,670
is the second part I won't talk about

00:09:07,139 --> 00:09:16,980
yes firstly is the TTC p Ripper is kind

00:09:14,670 --> 00:09:21,269
of a host-based networking access

00:09:16,980 --> 00:09:25,550
control list for terrorism it's pretty

00:09:21,269 --> 00:09:29,250
easy to use and for some Enterprise

00:09:25,550 --> 00:09:33,660
commune in X users they will think about

00:09:29,250 --> 00:09:37,790
to use the TCP raipur to filter this

00:09:33,660 --> 00:09:43,380
program which use the TCP rappers like

00:09:37,790 --> 00:09:46,920
SSH or our ftp server and the second one

00:09:43,380 --> 00:09:51,779
is a year the ipt banette filter and the

00:09:46,920 --> 00:09:56,880
net filter is a providing the five hooks

00:09:51,779 --> 00:10:00,630
on the colonel and which is working on

00:09:56,880 --> 00:10:04,139
the IP networking level and at the user

00:10:00,630 --> 00:10:09,089
space you can just have some very easy

00:10:04,139 --> 00:10:16,069
on policies by use the IP table tools

00:10:09,089 --> 00:10:19,620
and yeah and actually some enterprise

00:10:16,069 --> 00:10:24,690
can own a lecturer also will concern

00:10:19,620 --> 00:10:29,100
about the intrusion detection systems if

00:10:24,690 --> 00:10:36,779
they really want it because and and for

00:10:29,100 --> 00:10:42,060
later 7 classifier fox example if your

00:10:36,779 --> 00:10:46,769
manager don't want you to access the

00:10:42,060 --> 00:10:50,550
youtube and if we only have the iptables

00:10:46,769 --> 00:10:55,589
we do anything we do just just block the

00:10:50,550 --> 00:10:59,279
the port 80 but maybe there's a

00:10:55,589 --> 00:11:04,800
requirement for specific the enterprise

00:10:59,279 --> 00:11:05,400
user is a manager yeah allo deploy ease

00:11:04,800 --> 00:11:11,280
to

00:11:05,400 --> 00:11:15,900
access the web yet the the website but

00:11:11,280 --> 00:11:20,070
it doesn't allow you to watch the movies

00:11:15,900 --> 00:11:22,920
or videos on the YouTube and l7 the

00:11:20,070 --> 00:11:26,670
later seven classify would do this enter

00:11:22,920 --> 00:11:31,350
the to open source project their bio

00:11:26,670 --> 00:11:33,960
seven and open ATP il-7 was was not in

00:11:31,350 --> 00:11:36,480
tune for a couple of years maybe four

00:11:33,960 --> 00:11:39,930
years it stopped the TV is there are

00:11:36,480 --> 00:11:43,500
still some antennas out there and the

00:11:39,930 --> 00:11:45,800
next one is a confinement yeah a

00:11:43,500 --> 00:11:51,110
particular of confinement yes I know

00:11:45,800 --> 00:11:54,420
before the mr. Snowden just has already

00:11:51,110 --> 00:11:57,690
fully disclosure about what they say did

00:11:54,420 --> 00:12:01,560
to us in China no one care about a

00:11:57,690 --> 00:12:03,660
confinement and they won't care about to

00:12:01,560 --> 00:12:06,390
use these confinements you got energy to

00:12:03,660 --> 00:12:09,810
prevent the zero-day attack but for now

00:12:06,390 --> 00:12:13,140
this the whole things a little bit of

00:12:09,810 --> 00:12:15,300
change in China more people are caring

00:12:13,140 --> 00:12:20,730
about confinement what's it about

00:12:15,300 --> 00:12:24,810
confinement is dirty for implementation

00:12:20,730 --> 00:12:27,090
for confirm confinement is the AC linux

00:12:24,810 --> 00:12:30,360
and armor and snake and as your security

00:12:27,090 --> 00:12:32,490
and it's internet is probably most

00:12:30,360 --> 00:12:37,350
powerful one but it's really hard to use

00:12:32,490 --> 00:12:43,200
then personally I I like the a Palmer so

00:12:37,350 --> 00:12:45,990
I least a very simple example here for a

00:12:43,200 --> 00:12:48,840
Palmer is a bummer is a wild least based

00:12:45,990 --> 00:12:54,410
policies and for example there's a

00:12:48,840 --> 00:12:58,680
banner ease name of a out there and I I

00:12:54,410 --> 00:13:02,930
only allowed the banner ease could have

00:12:58,680 --> 00:13:06,960
the read permission and to read the the

00:13:02,930 --> 00:13:09,900
hollow and file hello and the write

00:13:06,960 --> 00:13:13,800
permission to access the fire world and

00:13:09,900 --> 00:13:18,590
I only allow it to use the TCP so if

00:13:13,800 --> 00:13:24,530
you're if this eight outs want to

00:13:18,590 --> 00:13:27,230
stay at all will would be to use the UDP

00:13:24,530 --> 00:13:34,130
stuff yeah they won't they won't work

00:13:27,230 --> 00:13:37,370
yet but the confinement garage is still

00:13:34,130 --> 00:13:41,800
can't ensure the 100 percenter to

00:13:37,370 --> 00:13:44,930
prevent these 02 attacks because

00:13:41,800 --> 00:13:48,200
according to some reports the even is

00:13:44,930 --> 00:13:50,750
only nuts there's a song for you have

00:13:48,200 --> 00:13:56,540
already just you know them out

00:13:50,750 --> 00:14:00,650
about in 2009 I think and yet it's about

00:13:56,540 --> 00:14:02,690
so my collusion conclusion years long

00:14:00,650 --> 00:14:05,810
action on my conclusion is some great

00:14:02,690 --> 00:14:07,790
philosophers of the security feels like

00:14:05,810 --> 00:14:10,040
bruises king or and Rosa interested in

00:14:07,790 --> 00:14:12,860
the guys at least they think they're the

00:14:10,040 --> 00:14:17,180
security is not installing software or

00:14:12,860 --> 00:14:19,010
fire or something or the Prada and it's

00:14:17,180 --> 00:14:24,410
very funny things in China it's very

00:14:19,010 --> 00:14:28,850
common things is a meaning enterprise

00:14:24,410 --> 00:14:32,630
just by the fire war or the IDS devices

00:14:28,850 --> 00:14:35,900
and but without any updates the rules

00:14:32,630 --> 00:14:39,830
the four or five or six years it's very

00:14:35,900 --> 00:14:42,470
common in China so security is should be

00:14:39,830 --> 00:14:46,640
the process not just the product or

00:14:42,470 --> 00:14:50,870
service for the longship and pay the

00:14:46,640 --> 00:14:52,580
definition no and so my conclusions the

00:14:50,870 --> 00:14:57,290
hardening should be the part of your

00:14:52,580 --> 00:15:01,520
security service and yeah I just want to

00:14:57,290 --> 00:15:04,580
talk about a little bit more about why

00:15:01,520 --> 00:15:09,650
these hackers want to exploit I think it

00:15:04,580 --> 00:15:12,320
is a yeah for the lot of old-school

00:15:09,650 --> 00:15:15,560
Hecker's they believe the the hacker

00:15:12,320 --> 00:15:18,260
should be doing things for fun and for

00:15:15,560 --> 00:15:20,480
profit yes you have at a job that you

00:15:18,260 --> 00:15:22,970
can do anything about it but maybe a

00:15:20,480 --> 00:15:29,480
hacker need a nice job to pursue their

00:15:22,970 --> 00:15:32,540
dreams so yeah so it's like oh yeah the

00:15:29,480 --> 00:15:37,370
probably the two reasons for why those

00:15:32,540 --> 00:15:43,750
hackers are so it'll to find a variable

00:15:37,370 --> 00:15:48,050
stuff in your program and yep and I just

00:15:43,750 --> 00:15:52,940
recommend you guys maybe take a few of

00:15:48,050 --> 00:15:56,390
hours to take a look this book and these

00:15:52,940 --> 00:15:58,520
are documentary films and there's a of

00:15:56,390 --> 00:16:02,080
course a frog little pistol security

00:15:58,520 --> 00:16:06,890
design around the world I think okay

00:16:02,080 --> 00:16:11,270
yeah and Souza is to hiring and talk to

00:16:06,890 --> 00:16:13,190
our colleagues and you have to believe

00:16:11,270 --> 00:16:19,040
the social security team is still hiring

00:16:13,190 --> 00:16:22,900
if you have interest you talk to us yeah

00:16:19,040 --> 00:16:26,810
I just already upload some of the

00:16:22,900 --> 00:16:29,270
example stuff my github if you have even

00:16:26,810 --> 00:16:31,760
interesting just download the end check

00:16:29,270 --> 00:16:34,370
out it would be much fun on there

00:16:31,760 --> 00:16:45,800
earlier and from your life if you want I

00:16:34,370 --> 00:16:50,240
mean questions okay um by the way you

00:16:45,800 --> 00:16:55,310
know in dayton Nikki there are a few of

00:16:50,240 --> 00:16:57,500
really great security guys here you

00:16:55,310 --> 00:17:00,580
could check out the lattice the issues

00:16:57,500 --> 00:17:05,480
of the frock eight we see there's a

00:17:00,580 --> 00:17:09,020
introduction to the Greeks underground

00:17:05,480 --> 00:17:15,430
scenes as a you know a lot of awesome

00:17:09,020 --> 00:17:15,430
guys here this is finding ya thang

00:17:26,860 --> 00:17:28,920

YouTube URL: https://www.youtube.com/watch?v=cHssQ9-Enoc


