Title: Can we build a simple, cross-distribution installation frame
Publication date: 2011-02-06
Playlist: FOSDEM 2011
Description: 
	First, this talk will entail the philosophy behind the shellscript-based Arch Linux installation framework (AIF), as well as some implementation information and lessons learned. Second, I want to initiate a discussion on how multiple distributions could work together maintaining an installation framework following a "keep it simple" philosophy, and how feasible it would be to do so. In my experience, quite some necessities, issues and features are distribution-independent. Specific distributions could be supported with plugins or feature branches.
Captions: 
	                              good morning thank you for coming I                               meters I'm listen genere for our clinics                               so I work on the installation scripts                               for arch is Tom I want to address three                               things first of all philosophy because                               art things is a distribution that tries                               to keep it simple so it doesn't try to                               abstract a lot of things for the users                               and and it doesn't try to provide from                                thanks for everything it expects users                                the world work on an elite to keep it                                compared to gentle or slack where                                they're all with similar distributions                                which I hope to address how many of you                                are developers for distributions oh nice                                and how many of you are involved in the                                installation tools to perform the actual                                installation of the system to the user                                system okay can you also tell me what's                                this solutions you are working on on the                                real sorry Andre wonder you got cash                                magical sorry Cashin magica portuguese                                the shrooms okay cool powerful forms are                                okay and lose                                but we should be done ok                                alright so I was hoping the gentle guys                                would also be here Oh should make more                                noise                                because the distributions are here now                                are more like user friendliness and we                                are more hardcore I mistake                                so why do we even provide installation                                tools because we are you expect a lot                                from our users so why would we do all                                the work you go you don't write that                                will tell you why maybe you should so                                which lessons did you learn with our                                tools and then hopefully have yen's we                                can discuss how you to collaborate share                                work                                and if you have any questions during the                                dog just fire away so the stuff I                                marking out it's called AI up it's the                                insulation strips for arch but it's it's                                like that just a bunch of stress so that                                means you can run it on any distribution                                we're in enough for march on our life in                                here but you can run from anything else                                the idea was to keep it simple and very                                hackable for our users it's a framework                                because it provides libraries so that's                                some shell files that is no not at all                                functions and with those functions                                before Bacchus logic like formatting                                their hard disks creating file systems                                installing the packages so it's                                basically fronting for tools like mkfs                                and the package manager by the term                                advanced functions by using those                                libraries you can define procedures as                                we call them and a procedure is just                                like blueprints that says you need to                                first with these steps call this                                function represent the user menu so the                                whole new brand to go to form the                                the installation we currently support to                                these procedures by default that's an                                interactive procedure i will show finish                                up later on if you will understand it's                                just like a menu the user can use we                                also have an automatic procedure it's                                for pixie blue thing about to install                                and stuff like that but the old                                philosophies and everything should be                                accessible I cable / idle users can                                override a procedures that can make new                                ones they can even active libraries on                                what kind of stuff something that                                separates our tools from for example the                                DVD installer is that we hope the DVD                                installer what they do when you create                                your file systems every time you select                                yes I want this it will actually perform                                the actual stuff upgrading the file                                system I'm gonna have to be first create                                the model that is it's actually like a                                bunch of trees so for example if you                                have two harvests you start with one                                hard disk you make partition so                                partitions those are noise in the tree                                then on top of those partition you can                                do like encryption for the encryption                                you can put out vm so you have your                                physical volume your volume groups your                                logical volumes and on top of that the                                actual file systems so first we present                                user we talkin I use to define this                                model which is like an abstract version                                of the trees so it like                                 not only when the user says okay I'm                                 satisfied with this computer then it                                 says okay I'm done and we'll start                                 processing everything in order it will                                 be the partitioning and then it will                                 check dependencies like do I first need                                 to create the encryption than lvm and                                 then finally the actual file systems and                                 from one of them it can also do that in                                 Reverse so if I mean if anything would                                 fail in the process it can you mount                                 this sort of logical volumes of the                                 volume group physical volume the                                 encryption so it goes back now you can                                 start over again if you want to change                                 anything it also has a support for                                 testing I will show a speech all of that                                 you can obviously test the functions                                 themselves and dug by my god but of                                 course it has nothing to do with actual                                 building and at run time so we can you                                 can trade it spreads I basically whether                                 to a limit will install the system and                                 when its installed it will boot that's a                                 good bunch of checks like is this                                 package correctly installed does not                                 working work is this file available do I                                 have this file system with these                                 settings so this is basically to make my                                 work a bit easier so every time I do                                 change in my installation framework I                                 don't need to check everything manually                                 I can just run the scripts and they will                                 check everything if it's more or less                                 all right so this is how the interactive                                 procedures look like I just want to go                                 over the stocks with you so you have an                                 idea of how it works and what is                                 distribution specific and what isn't                                 so for example the first step select a                                 source basically what you do here is you                                 define which repository you want to use                                 which mirrors some subsidies can have                                 sorry repositories on the cities                                 themselves so you can hard code for                                 example that it should also look over                                 there the second step focusing is                                 actually optional but it allows you to                                 change your monetary talk I'm also to                                 define your time zone stuff like that                                 prepare our trash that's basically the                                 stuff I just explained you first define                                 the complete model of how you want                                 everything to be you press ok and it                                                                                                      selection is basically calling the                                 package manager and asking which                                 packages are available and using just                                 selects which he wants in the next step                                 it will actually install it all of those                                 configure system stuff is pretty                                 interesting because it tries to reuse                                 what it looks are ready for example Evan                                 knows that you have a specific                                 encryption set of it without me on top                                 of that it will know for example                                 bootloader configuration for grub what                                 about Colonel arguments it should                                 provide for for your early user space it                                 can also populate your a fast stop when                                 you set your hostname it knows then it                                 can also populate your EDC hosts and                                 stuff like that so that's that some                                 cleverness more or less and then you can                                 also manually edit the text files the                                 final stuff no the lost while the seven                                 stuff is installation on the bootloader                                 and then currently that's only grow but                                 we plan to support system index let's                                 work on the way and maybe more later on                                 and when that is done you can just                                 actually install remove the system and                                 it should work so why did I even create                                 this and that's does the whole                                 philosophy I think first of all like I                                 said I wanted to be hackable for users                                 so it's bit more than two thousand lines                                 of Bosch codes which is a lot but still                                 look that much I think it's still fairly                                 accessible and bosh is the language that                                 many hackers understands but the next                                 question is an interesting one if your                                 distribution like arts or gentle oh yeah                                 question                                   alaris installation text-based                                 installation I honest I think you should                                 do that                                                 is innovation in with you                                 also never named Rudolph and setting                                 hostname told us okay I'll look into its                                 second thing is you say baby bash if you                                 of course distribution of Ashley's not                                 being SH in that student so be aware                                 that their business age is not bad it's                                 not it's not very much and it fun                                 official idea I know the real work and                                 I'm sure yes bosch is a dependency the                                                                                                      well okay we have to drop                                               a lease installation framework and I try                                 to address the distribution so my scope                                 that broke that I try to address systems                                 that do not have bash                                 okay to answer the question why do I do                                 this because for jan                                                   we say we expect you to over                                         have to call the commands themselves                                 when they run the system they have to                                 edit text files why would we hold their                                 hands so we say during the installation                                 and I have some reasons for that because                                 I think the knowledge that you need to                                 install the system on your own your                                 system it's different than what you need                                 to maintain the system to run it there                                 is of course quite big enough in the day                                 you will also be doing stuff during                                 inside that you will probably never do                                 again when you run the system so today                                 gentle example again you guys have a                                 very nice manual that describes every                                 stuff you need to do during the                                 installation but I find it much easier                                 because I will never do an installation                                 so frequently I find it much easier to                                 just have a program that helps we go to                                 it so when i install a system for my                                 uncle or my aunt or something like that                                 I just want the menu so I can watch TV                                 and at the same time I click some                                 buttons on the system gets installed                                 so I also include casual users who may                                 just want to try out distribution to see                                 if they like it or not and for them it's                                 also easier if I can just have something                                 like this so I wants to go over the                                 dependencies home okay                                 there's always a speedo them as always                                 press photos that you just went mad well                                 yeah I still think it's easier this way                                 for the user install sorry don't install                                 none of the user hoons have a lot of a                                 choice right then you would end up with                                 windows so sorry user to axial York but                                 students fall in love                                 well no because we also provide a lot of                                 possibilities like specific file system                                 setups specific packages you want to                                 install an answer them at all spells                                 button and then you can think more                                 because you say I want to solve for my                                 ya know he might want but I won't be the                                 guy fixing his computer run no I'm gonna                                 do that Bobo game is like a futuristic                                 but actually like I said we do have                                 automatic installations so if you want                                 to make an installation without worrying                                 about any setting you can just enter one                                 command and it will install it                                 automatically okay so dependencies with                                 the exception of the batch which is a                                 lot of little exist addictions                                 apparently everything in the first list                                 should be pretty available standard                                 utilities like buildings and gene                                 collecting scrap of Senate one exception                                 is a few i SH that is also something I                                 roads it's basically one shall file with                                 a lot of functions in it you can call to                                 make interacting with user easier from                                 your scripts so I will show an example                                 that in the next slide basically you can                                 just call some functions to ask you                                 those questions and stuff and you have                                 the possibility of doing that and really                                 command line modes or in the dialogue                                 mode so that's nine courses interface                                 because regions on arch obviously depend                                 on Batman                                 but you don't need to if you want to                                 support this on your distribution you                                 can just write a library with your                                  managing you have a lot of                                 optional dependencies depending on                                 whether you want support for recursion                                 lvm ex gfs and so on a lot of file                                 systems are supported and of course if                                 you want to such a network using dhcp                                 you can have that or such your time                                 using I think be dialogue is for ncurses                                 urban system is depending on which who                                 do you want to support and martin down                                 is just if you want to generate some                                 documentation so we really try to keep                                 the dependencies same as in most                                 clinical solutions should have this                                 right                                 so this is an example of the lip uish                                 library just I was talking about this is                                 just how you ask a user question you can                                 just look at a return code to see if you                                 can proceed or not you can ask you for a                                 number like you can specify lower and                                 upper limits both of you the library                                 will populate the variable fertility                                 answer in it you can make a user check                                 specific things in a checklist so you                                 have a basically an array with options                                 and to populate an array of announcers                                 for you and you can also use this                                 function if you have a menu you want the                                 user to select a more specific option                                 so this is the interface and the                                 interactive procedure for the file                                 system model I was talking about so here                                 you see your your actual this and as you                                 can see it's kind of a tweety because                                 the children of these are partitions and                                 then the time thing what you define on                                 the right side for example here you the                                 file encryption it will add and actually                                 for the encryption of here data mapper                                 Griffin's community crypt that's a                                 layout of the kind of thing so when you                                 have defined the encryption in this                                 device won't really exist yet but the                                 install knows ok I should create this                                 entry in the tree so that the user can                                 then his next things and when you                                 have to find everything you're all VMS                                 ends up and your file systems then you                                 can say okay i'm done and it will start                                 doing everything which looks like this                                 yes you talk about a tree                                 okay it would look like no why didn't                                 you create it will be complicated to                                 show it actually as a tree so this is                                 the liquid ice age library who follows                                 dialogue for me which is a knife vs.                                 program and it only supports showing                                 things that has lists like this so                                 logically speaking it's a tree but we                                 just represented as a lazy student                                 prepac the variables which i could give                                 this yeah I can do that I decided not to                                 because as you can see it's pretty                                 cramped already I had to make a lot of                                 sacrifices in the layouts to at least be                                 able to present its useful information                                 so we'll just go over everything like                                 this first it creates everything and it                                 runs everything this is screenshots a                                 pretty old special actually on the test                                 suite so it moves the system you can                                 check whether you have no theological                                 volume with the name Fred fool the size                                 needs to be a hundred megabytes for                                 example in this day is it failed you can                                 check why the map points exists with                                 specific file systems you can check by                                 the file exists whether follow does not                                 exist whether packages are installed                                 networking is working and so on ok what                                 did I learn from this bash is kind of                                 limited we unloaded I guess the biggest                                 problem was with the file system model                                 this is also why I spent so much                                 attention on this because it's a nice                                 feature but it's it's difficult to                                 implement it for two reasons first of                                 all you need to date the structure to                                 well to represent the tree thank you and                                 you also need to be able to query that                                 we for example if you want to make if                                 the install needs to make a file system                                 they need to know what are all the                                 dependencies of this one is there an                                 underlying encryption or another line                                 the end needs to trace back to the route                                 to be able to know in which order it                                 needs to do everything and that kind of                                 stuff is hard to do in dash I i wrote my                                 implementation of a tree by using a text                                 call and specifically out but my ideas                                 later on maybe to do to outsource this                                 new program I don't know like a young                                 library or next time a library or                                 something that I can you know the                                 command lines to do the hard work for me                                 if I can get rid of if I can get rid of                                 this hard work the code of the cleaner                                 and nicer grip is also pretty hard to                                 get right because i don't know why they                                 seem to make it complicated for me you                                 need to call all commands and it's not                                 easy to get installed properly is it oh                                 it's prep one we are considering maybe                                 switching to grab two we are actually                                 working on insisting support right now                                 because we are at this point we know                                 grub is outdated it's not maintained                                 properly anymore it's hard to install it                                 doesn't have specific features like GPT                                 support which is                                 the partitioning table which will                                 probably begin with modern hardware so                                 we are looking into our options but                                 actually this aesthetics work we're                                 doing right now is looking quite good                                 because it seems to look easy to install                                 it's very nice actually                                 they time something is surprisingly hard                                 we use a HW clock to I know if anyone                                 can recommend me a better tool than this                                 but it's basically tool that's based on                                 your system time well with system i mean                                 linux your your dates at the current                                 moment it can synchronize it or you're                                 clocking your heart where and it can do                                 the opposites but it's kind of tricky to                                 do with all the complications like time                                 zones and stuff so if you would be                                 thinking i'm going to write my own                                 installer for my own linux distribution                                 then these would be reasons why you may                                 be shouldn't do it and maybe you should                                 cooperate with me for example some                                 challenges for us for the future like I                                 said this Eid partitioning table                                 extended firmware interface a large book                                 Silas I still need to research a bit                                 into it more but as far as I understand                                 is basically because of the new hardware                                 and they provide four kilobytes books on                                 disks and the Alliance and stuff like                                 that so that's something we should be                                 working on you want to support butter FS                                 still working on it                                 and substrate is also not support yet                                 but once these three things are working                                 then I will be really satisfied with the                                 product because right now I think it                                 works quite well with the exception of                                 these things we need to work on this                                 okay so you can have an ID right now of                                 the current tool and of course my idea                                 is to cooperate with other distributions                                 and as you can see in this lists there                                 are a lot of things that are                                 distribution independent for example                                 user interface codes which is like I                                 said use a vast library file system code                                 for that we rely on mkfs and print setup                                 and lvm tools and stuff like that boot                                 loaders just grab horses things some                                 four months for auto installation the                                 format is currently is not definitely                                 feels so I don't really care much about                                 how the format looks like but it's                                 obvious that should be performance I                                 share it amongst other distributions                                 blueprinting that's just a fancy name I                                 use for defining which stops need to be                                 done and which steps depend on which                                 other ones for example you can only do                                 the package constellations that often we                                 have actually selected packages and with                                 the package selection that could mean                                 both interactively like with the menu                                 but it can also mean it's hard coded                                 somewhere in config file time date                                 setting like i said i use HW block for                                 that it should be available I mean                                 system idle and then obviously like                                 every shell script out there you want to                                 have error handling error reporting and                                 ever-loving stuff like that so what is                                 distribution dependence actually not                                 that much selection of a source which is                                 basically selecting the middle and                                 selecting the repository maybe media on                                 both of your cd-rom that's pretty much                                 it selection of packages basically you                                 query your package manager for that and                                 the installation of the packages also                                 some configuration that depends on                                 distribution there are some you know                                 Universal things like a festive or for                                 the grub configuration but other things                                 are distribution defendants                                 so that's pretty much it so surprisingly                                 not a lot I'm happy with that so and                                 this is why I want to get in touch with                                 you guys especially in the gentle guys                                 because I think in terms of philosophy                                 really really most if we would cooperate                                 how could we do it I'm thinking of two                                 possibilities like I said we have the                                 concept of libraries so those are just                                 shelf files we right now have a tankman                                 library to support our package manager                                 and that is most of the distribution                                 specific stuff so if you could provide                                 shall file that provides some functions                                 that vary your your packages based on                                 your package manager and stuff like that                                 we are mostly there the other                                 alternative is you just for the projects                                 we create your own branch which our                                 distribution specific stuff maybe you                                 can even contribute some generic stuff I                                 don't know if you have more ideas please                                 let me know but i think the plug-in                                 architecture would be quite useful and                                 that's it if you want to have more                                 information about this you can subscribe                                 to our middle east which is our Ellen                                 you just type it in google and you will                                 find a dress that's my personal mail and                                 project is hosted on on two meters                                 it'sit's you think it's those two                                 addresses are actually the same                                 repository juice mirror to two locations                                 so if you want to have a look at the                                 source code you just go to a meter of                                 these sides and you can from the project                                 and have it since you were talking about                                 an automated config files or something                                 installation example that I have an                                 example of all deaths they are online if                                 I don't have not working on my pc                                 configured years not wireless at least I                                 what is it plain text files into my it's                                 plain nuts power actually if you go to                                 for example the github address you can                                 go to that address and there's a                                 directory called examples of something                                 like that and there you can see I think                                 two or three files one of them is a very                                 standard one then there is a more                                 advanced one with lvm and encryption                                 stuff now because it was think                                 continue with right at this horizontal                                 using kicked off class which is also                                 plain text which has some                                 particularities maybe for right head but                                 then I think in most cases is pretty                                 common yeah I lieutenants and it seemed                                 reasonable enough I could do it I guess                                 using the kickstart for months it's an                                 option I still need to look into it                                 further yes I get the impression that we                                 to fish because you don't want too many                                 dependencies that's not the primary                                 reason it's one of the reasons the other                                 reason is I want something very simple                                 actually bash it can get complicated                                 that you can probably know during you                                 can know that the things that which you                                 build into vegetable to the terribly                                 hooded horse and a description yes yeah                                 doesn't my name problem if you want i                                 wanna introduce an xml library or some                                 other                                 before actually yeah that's what I'm                                 looking in for that maybe you should                                 look at a different language you the                                 loop news program would be okay yeah why                                 don't you go for uniform well personally                                 I'm on the profile I have looked into by                                 them because I think whiten is also an                                 interesting candidate for it but um                                 actually I could have just written by                                 the new in gone with violence that I                                 think that when you dress are no better                                 be a no-brainer if I don't you                                 yeah well I chose bash wouldn't it make                                 your life right but the time I'm more                                 keen but like you see Python or                                 something I mean I personally would like                                 well something written a shack it                                 doesn't really have much appeal to utter                                 yeah yeah there are all different things                                 you need to consider for example our                                 cilix users they are well there are                                 probably a lot of fighting fans in there                                 and a lot of pro fans but what are you                                 most people I know who understand shell                                 scripting vests are so that's one what I                                 want to address but I've done unlike an                                 official pool or anything like that so                                 badly from all the distributions all the                                 different distributions because yeah                                 they were saying like ya know that                                 distribution come by default with Bosh                                 everything comes by default word bro I'm                                 fightin for example and i ramble shaking                                 hands with everything goes by the pool                                 with your action a library if also liked                                 the movie pendants again yeah so if you                                 introduce wall dependencies take multipe                                 energy away to save ya a fallacy is ok i                                 want to avoid dependencies very much of                                 course but secretly but i don't want to                                 have too much too many dependencies                                 introducing one or two is not a big                                 problem right                                 you won't defend the Chico but yeah                                 restrictions like the three lawyer girl                                 yeah conveyance then I limit myself to                                 only the people who would I throw a                                 little light pearl is that not about to                                 do it I've been officially the more                                 people who have said pearls and there                                 are people who intercept you know                                 written back straight I don't know I                                 have to admit actually one of the                                 reasons i did this is just because i                                 wanted to improve myself at bosch so but                                 still I think I work for a software                                 company metal people were the dash you                                 look a lot of touching my rather instead                                 of an icon that it's written in Pinta                                 and the story I don't know if you have                                 tried reddit instead of Kings called us                                 and I calm down yeah I have courage ones                                 here you know it's what kind of freedom                                 and as a debugger inside the installer                                 and so when I am concerned about the                                 installation I was able to the installer                                 during installation to fix it in order                                 to go be able to install and you say it                                 was fighting it was yes                                 it's fine so you modify the files while                                 the installer is running another time                                 with a fight on the burger which is                                 inside I come back which is during the                                 profile picture I was very impressed                                 that i was about to do this during yeah                                 that sounds like a really cool feature i                                 will provide                                 yeah also if you encounter a book which                                 is very unlikely of cash then in this                                 case you need to restore the                                 installation product yeah it's I should                                 look into an ad more questions okay well                                 so if anyone oh yes yeah you mr. Jaffe                                 electric pinkish you like dim ah yeah                                 night ladies ok                                 only minutes we also do playa                                 admire so very very to insult get up oh                                 my no linux installation I hide remember                                 cause an allergic reaction                                 problems from this installation                                 targets you don't procreate                                 yeah so what you could do in that case                                 for example so what he's asking is                                 basically like an interactive installer                                 with minus the file system stuff and                                 just point to point to an existing                                 fastest of structure you can do that the                                 only thing you need to do is you need to                                 create a new class valve you say okay                                 this inherits the interactive one you                                 just look up the function with the menu                                 you remove this stuff maybe you had your                                 own function that asks the user where is                                 it mounted or something like that yeah                                 yeah so all right so you just override                                 the function and ask the user which                                 there actually isn't something like that                                 and it should work okay yes so i think i                                 misunderstood what the top was about                                 because what i am particularly                                 interested in is using pacman on other                                 distributions would you be a good person                                 to talk to about backs I side with the                                 context of this talk or is there                                 somebody better Darren is definitely a                                 lot of people who know much more about                                 black men than I do I know some stuff                                 about back                                 a lot maybe I can help you out which I                                 doubt it's actually I can give you some                                 company you can want you to speak okay                                 yeah all right yes i'm also interested                                 in the philosophy of unified installer                                 the base level and perhaps simply                                 stepping in that question but asking                                 more in terms of the policy that's why                                 thought it was interesting it's go for                                 another installer rather than RPM or d                                 package oh I mean are specific back yes                                 yes why decided on that because we                                 thought other formats are too                                 complicated we might form of this as                                 simple as we could make it without being                                 a pain in the ass for users so we try to                                 provide some minimal features that                                 should work for most people but if you                                 want something advanced we just do not                                 want to provide it because we want to                                 provide a simple code base that's                                 actually the philosophy in the entire                                 distribution we we do not support a lot                                 of fancy options like use flags on                                 gentoo or or or something like that kind                                 of stuff we just say we don't suppose if                                 it doesn't fit in our philosophies all                                 our tools can be simple they do have the                                 tendencies                                 it's not that okay well thank you for                                 listening I hope it was enjoyable
YouTube URL: https://www.youtube.com/watch?v=83xBdlbGHdI


