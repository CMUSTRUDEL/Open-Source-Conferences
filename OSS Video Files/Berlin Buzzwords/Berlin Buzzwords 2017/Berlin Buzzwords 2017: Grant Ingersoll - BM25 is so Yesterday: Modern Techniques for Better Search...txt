Title: Berlin Buzzwords 2017: Grant Ingersoll - BM25 is so Yesterday: Modern Techniques for Better Search..
Publication date: 2017-06-15
Playlist: Berlin Buzzwords 2017
Description: 
	Grant Ingersoll talking about "BM25 is so Yesterday: Modern Techniques for Better Search Relevance".

Modern relevance in search engines has come a long way since the early days of information retrieval, when the likes of TF-IDF and BM25 scoring models first came on the scene. And while those core models are still good for a first pass retrieval, more and more search engines are employing machine learning, natural language processing and sophisticated re-ranking techniques to fine tune relevance. 

This talk will provide a review of current best practices in relevance tuning, including what to measure and how to measure it. We’ll then give details on how to use techniques like learning to rank and query intent classification to improve results, with examples in Apache Solr. We’ll finish with a sneak peak into using deep learning and word2vec in a search context.

Read more:
https://2017.berlinbuzzwords.de/17/session/bm25-so-yesterday-modern-techniques-better-search-relevance

About Grant Ingersoll:
https://2017.berlinbuzzwords.de/users/grant-ingersoll

Website: https://berlinbuzzwords.de/
Twitter: https://twitter.com/berlinbuzzwords
LinkedIn: https://www.linkedin.com/showcase/berlin-buzzwords/ 
Reddit: https://www.reddit.com/r/berlinbuzzwords/
Captions: 
	00:00:09,639 --> 00:00:15,650
hello and welcome back uh here at Casa

00:00:13,100 --> 00:00:18,939
house our next speakers grunting is Oh

00:00:15,650 --> 00:00:24,680
co-founder and CTO of lucid works and

00:00:18,939 --> 00:00:28,880
his works title is BM 2825 is so

00:00:24,680 --> 00:00:33,190
yesterday are better ways to do search

00:00:28,880 --> 00:00:35,570
ah you go microphone yer data deals

00:00:33,190 --> 00:00:38,989
alright first talk after lunch does

00:00:35,570 --> 00:00:40,820
everybody awake all right how many of

00:00:38,989 --> 00:00:43,000
you are actually search developers and

00:00:40,820 --> 00:00:45,470
you spend a lot of time on relevance

00:00:43,000 --> 00:00:48,320
alright so let's get started and let me

00:00:45,470 --> 00:00:52,210
see if this fits with what your life

00:00:48,320 --> 00:00:56,269
looks like user comes in on your site

00:00:52,210 --> 00:00:58,940
type in iPad case and they do a search

00:00:56,269 --> 00:01:01,460
and you being the good engineer that you

00:00:58,940 --> 00:01:04,190
are whether using solar or elastic or

00:01:01,460 --> 00:01:06,409
any other search engine out there you

00:01:04,190 --> 00:01:09,320
probably do some things query parsing

00:01:06,409 --> 00:01:12,380
etc and you might generate a query that

00:01:09,320 --> 00:01:14,359
looks something like that lots of

00:01:12,380 --> 00:01:16,100
variations on this thing I could make it

00:01:14,359 --> 00:01:17,509
harder I can make it easier all of those

00:01:16,100 --> 00:01:19,369
kinds of things but since you underneath

00:01:17,509 --> 00:01:22,009
the hood you're doing something like

00:01:19,369 --> 00:01:24,200
that and then your engine goes off and

00:01:22,009 --> 00:01:25,729
if you were in earlier talks you can

00:01:24,200 --> 00:01:27,200
kind of learn about what's happening

00:01:25,729 --> 00:01:30,649
underneath the hood and loosening your

00:01:27,200 --> 00:01:33,289
engine goes off and it comes back with

00:01:30,649 --> 00:01:36,439
these two results now I'm actually not a

00:01:33,289 --> 00:01:38,780
German football fan but I looked up a

00:01:36,439 --> 00:01:40,429
few the very first one Darmstadt I

00:01:38,780 --> 00:01:42,499
looked up the stats for this year's

00:01:40,429 --> 00:01:45,679
season there in last place

00:01:42,499 --> 00:01:48,590
whereas Munich is in first place but you

00:01:45,679 --> 00:01:51,069
can see in the search engine Darmstadt

00:01:48,590 --> 00:01:55,039
come up count comes up as number one and

00:01:51,069 --> 00:01:58,280
munich comes up as number 15 and of

00:01:55,039 --> 00:02:01,069
course we've got some fans of Darmstadt

00:01:58,280 --> 00:02:04,670
over here but the reality is your

00:02:01,069 --> 00:02:07,700
marketing team your boss your customers

00:02:04,670 --> 00:02:10,550
they really don't like Darmstadt right

00:02:07,700 --> 00:02:13,220
they want munich to be at the top in

00:02:10,550 --> 00:02:14,989
fact when your marketing team comes and

00:02:13,220 --> 00:02:16,030
talks to you they say munich outsells

00:02:14,989 --> 00:02:18,400
darn

00:02:16,030 --> 00:02:21,610
stat like a hundred to one could you

00:02:18,400 --> 00:02:23,620
please make Munich be at the top of the

00:02:21,610 --> 00:02:27,730
list just like they're at the top of the

00:02:23,620 --> 00:02:29,740
standings no offense and so as a good

00:02:27,730 --> 00:02:32,920
engineer you start to dig in what would

00:02:29,740 --> 00:02:36,130
you do you start to dig in where do you

00:02:32,920 --> 00:02:37,930
start well you go read the manual we've

00:02:36,130 --> 00:02:39,610
seen solar all these engines they have

00:02:37,930 --> 00:02:40,720
pretty good manuals out there the beauty

00:02:39,610 --> 00:02:43,870
of open source is you could actually

00:02:40,720 --> 00:02:45,760
even look in the open source maybe you

00:02:43,870 --> 00:02:47,530
start to dig in and you realize oh well

00:02:45,760 --> 00:02:50,320
what I'm going to do is when that

00:02:47,530 --> 00:02:53,260
document comes in for Munich I'm going

00:02:50,320 --> 00:02:55,930
to hard-code a hundred as a boost on

00:02:53,260 --> 00:02:57,610
that document and that's going to make

00:02:55,930 --> 00:03:00,280
Munich come up at the top or maybe a

00:02:57,610 --> 00:03:02,530
query time I'm going to be even smarter

00:03:00,280 --> 00:03:04,000
and I'm going to take my main query and

00:03:02,530 --> 00:03:06,610
I'm going to order together with

00:03:04,000 --> 00:03:09,790
something else and now all of a sudden

00:03:06,610 --> 00:03:12,790
whenever somebody searches for football

00:03:09,790 --> 00:03:14,590
are sorry yeah football I keep wanting

00:03:12,790 --> 00:03:16,930
to say soccer no offense

00:03:14,590 --> 00:03:19,660
when somebody searches for a particular

00:03:16,930 --> 00:03:22,870
team etc we can make sure that Munich

00:03:19,660 --> 00:03:25,410
comes up at the top maybe that doesn't

00:03:22,870 --> 00:03:27,880
work right people have tried that

00:03:25,410 --> 00:03:30,600
sometimes it works most of the time it

00:03:27,880 --> 00:03:32,739
works sometimes it doesn't so then I

00:03:30,600 --> 00:03:36,010
heard about this thing a new scene

00:03:32,739 --> 00:03:38,440
called explains or debug query if you're

00:03:36,010 --> 00:03:40,299
a solar user or whatever other engine

00:03:38,440 --> 00:03:42,519
you're using has similar functionality

00:03:40,299 --> 00:03:44,859
and you get something that looks like

00:03:42,519 --> 00:03:46,989
that it's an eye chart don't worry I

00:03:44,859 --> 00:03:49,570
don't expect you to read it but it tells

00:03:46,989 --> 00:03:53,620
you all of the gory details about why

00:03:49,570 --> 00:03:55,870
that document scored the way it does in

00:03:53,620 --> 00:03:57,730
fact I've used this a lot of times in my

00:03:55,870 --> 00:04:02,500
career is to figure out what the heck is

00:03:57,730 --> 00:04:04,690
going wrong with search still maybe you

00:04:02,500 --> 00:04:06,850
don't figure it out and you go get

00:04:04,690 --> 00:04:08,680
Doug's book or you go get my book or you

00:04:06,850 --> 00:04:10,660
go get Trey and Tim's book and you say

00:04:08,680 --> 00:04:12,430
I'm going to really learn this stuff I'm

00:04:10,660 --> 00:04:14,920
going to dig in I'm going to figure out

00:04:12,430 --> 00:04:17,019
all the theoretical stuff I'm going to

00:04:14,920 --> 00:04:19,180
learn what tf-idf and document length

00:04:17,019 --> 00:04:22,169
normalization and all of these kinds of

00:04:19,180 --> 00:04:26,349
things are maybe I'm going to figure out

00:04:22,169 --> 00:04:28,999
what the heck that thing is that's B m25

00:04:26,349 --> 00:04:31,309
hence the talk title

00:04:28,999 --> 00:04:33,319
and this stuff is all really good you

00:04:31,309 --> 00:04:35,989
should definitely learn this as a search

00:04:33,319 --> 00:04:37,519
engineer not here to try to dissuade you

00:04:35,989 --> 00:04:39,349
out of that but what I really want to

00:04:37,519 --> 00:04:41,479
talk about with this talk is how do we

00:04:39,349 --> 00:04:43,549
put this kind of stuff in the

00:04:41,479 --> 00:04:47,269
perspective of what you're seeing out of

00:04:43,549 --> 00:04:49,249
more modern search approaches so first

00:04:47,269 --> 00:04:51,110
off after you've done all that low-level

00:04:49,249 --> 00:04:53,839
stuff you might have this brilliant idea

00:04:51,110 --> 00:04:56,419
that says well how do I really know

00:04:53,839 --> 00:04:58,069
whether this stuff is working so you

00:04:56,419 --> 00:05:00,709
read these books and you start to say oh

00:04:58,069 --> 00:05:02,149
well we need to measure things right so

00:05:00,709 --> 00:05:04,549
maybe the first thing you do is you just

00:05:02,149 --> 00:05:05,989
start asking your colleagues hey what do

00:05:04,549 --> 00:05:08,119
you think of this result for this query

00:05:05,989 --> 00:05:09,739
this is our most popular query what do

00:05:08,119 --> 00:05:12,559
you think of these results and you could

00:05:09,739 --> 00:05:15,110
go and do that with additional users you

00:05:12,559 --> 00:05:18,259
can maybe set up some focus groups with

00:05:15,110 --> 00:05:20,059
your customers if you've ever heard of

00:05:18,259 --> 00:05:22,610
something like Trek you can actually go

00:05:20,059 --> 00:05:25,610
download like a whole data set from the

00:05:22,610 --> 00:05:28,039
academics that will help you judge how

00:05:25,610 --> 00:05:30,110
your search results are doing maybe just

00:05:28,039 --> 00:05:32,929
maybe if you have enough people on your

00:05:30,110 --> 00:05:35,179
team you might have a company gold

00:05:32,929 --> 00:05:37,789
standard for your content so you can

00:05:35,179 --> 00:05:39,709
actually measure your own relevance you

00:05:37,789 --> 00:05:42,949
tend to only see that at companies that

00:05:39,709 --> 00:05:45,889
are really big and have like 100 or 200

00:05:42,949 --> 00:05:47,929
person teams who do nothing but work on

00:05:45,889 --> 00:05:50,149
relevance in fact those companies

00:05:47,929 --> 00:05:51,949
usually are monetizing their search

00:05:50,149 --> 00:05:54,529
results which is why they spend so much

00:05:51,949 --> 00:05:56,029
time on this and you might dig in and if

00:05:54,529 --> 00:05:58,339
you were at the earlier learning to rank

00:05:56,029 --> 00:05:59,479
talk you can see details around some of

00:05:58,339 --> 00:06:03,889
these metrics you might care about

00:05:59,479 --> 00:06:08,569
precision recall NDC g-m are are all of

00:06:03,889 --> 00:06:10,699
those fun terms and then just like how

00:06:08,569 --> 00:06:12,860
your shampoo recommends that you lather

00:06:10,699 --> 00:06:14,719
rinse repeat you're going to keep doing

00:06:12,860 --> 00:06:16,309
this and this is basically job security

00:06:14,719 --> 00:06:18,799
for you because you're the relevant

00:06:16,309 --> 00:06:20,539
person at your company and you're really

00:06:18,799 --> 00:06:23,149
smart and so you're going to keep doing

00:06:20,539 --> 00:06:25,489
this and doing this and doing this and

00:06:23,149 --> 00:06:28,729
doing this and in fact I've been doing

00:06:25,489 --> 00:06:31,699
this for too long to remember the

00:06:28,729 --> 00:06:34,189
reality is it's a lot of work right it's

00:06:31,699 --> 00:06:36,499
a lot of hard work and if maybe there's

00:06:34,189 --> 00:06:39,349
some better ways and so as a developer

00:06:36,499 --> 00:06:42,280
you have a brilliant idea and you ask

00:06:39,349 --> 00:06:46,220
yourself what would Google do

00:06:42,280 --> 00:06:49,100
and what Google would do is say let's

00:06:46,220 --> 00:06:50,810
make you do all the work and then I'm

00:06:49,100 --> 00:06:52,430
just going to harvest the information

00:06:50,810 --> 00:06:54,320
from all of the users that are

00:06:52,430 --> 00:06:56,270
interacting with it I'm going to build

00:06:54,320 --> 00:06:58,550
out this fancy machine learning and AI

00:06:56,270 --> 00:07:02,030
and all of those kinds of stuff and so

00:06:58,550 --> 00:07:03,680
that's kind of where we end up and so

00:07:02,030 --> 00:07:05,390
now to kind of put this stuff in

00:07:03,680 --> 00:07:07,900
perspective in terms of thinking about

00:07:05,390 --> 00:07:12,350
the bigger picture around relevance is

00:07:07,900 --> 00:07:14,930
if you take is kind of a stack here this

00:07:12,350 --> 00:07:19,669
core information theory here that's

00:07:14,930 --> 00:07:21,680
leucine solar elasticsearch you name it

00:07:19,669 --> 00:07:24,950
that's kind of that core cosine

00:07:21,680 --> 00:07:27,020
similarity tf-idf be m25 things the

00:07:24,950 --> 00:07:29,810
reality is is that's good for getting

00:07:27,020 --> 00:07:32,270
you somewhere between 50 and 70 percent

00:07:29,810 --> 00:07:34,820
of the way when it comes to relevance

00:07:32,270 --> 00:07:37,250
depending on who you talk to I once sat

00:07:34,820 --> 00:07:39,440
next to the CTO of Yandex at a workshop

00:07:37,250 --> 00:07:42,770
and he told me in his opinion at the

00:07:39,440 --> 00:07:44,810
time Corby m25 only got you about 50% of

00:07:42,770 --> 00:07:47,900
the way in terms of relevance at the

00:07:44,810 --> 00:07:50,210
stage like a large-scale web search

00:07:47,900 --> 00:07:53,360
engine and then you know over the years

00:07:50,210 --> 00:07:56,479
all of these engines have built tools to

00:07:53,360 --> 00:07:59,419
help you better navigate this content so

00:07:56,479 --> 00:08:02,770
things like facets did you mean all of

00:07:59,419 --> 00:08:05,229
that kind of stuff highlighting and then

00:08:02,770 --> 00:08:07,940
obviously you have some business

00:08:05,229 --> 00:08:10,310
specific things that you're doing so you

00:08:07,940 --> 00:08:12,919
know you start adding in rules you start

00:08:10,310 --> 00:08:15,410
hard coding things like Munich gets a

00:08:12,919 --> 00:08:18,410
hundred and Darmstadt gets negative 50

00:08:15,410 --> 00:08:20,360
all of those kinds of things but the

00:08:18,410 --> 00:08:21,500
reality is these days to kind of get to

00:08:20,360 --> 00:08:24,020
that next level

00:08:21,500 --> 00:08:26,960
most people are starting to adopt this

00:08:24,020 --> 00:08:28,729
approach of learning from your users and

00:08:26,960 --> 00:08:30,800
learning from the content at a much

00:08:28,729 --> 00:08:33,320
deeper level applying machine learning

00:08:30,800 --> 00:08:36,380
across the stage here doing things like

00:08:33,320 --> 00:08:38,510
personalization crowdsourcing user

00:08:36,380 --> 00:08:41,510
feedback etc to help you better

00:08:38,510 --> 00:08:44,960
understand what's going on with the

00:08:41,510 --> 00:08:47,930
content I mean my best New York accent

00:08:44,960 --> 00:08:49,850
that last bit of getting perfect results

00:08:47,930 --> 00:08:51,830
well forget about it as they say in New

00:08:49,850 --> 00:08:53,839
York because you're never going to get

00:08:51,830 --> 00:08:55,400
there so when your boss is yelling at

00:08:53,839 --> 00:08:57,260
you about why not everything

00:08:55,400 --> 00:08:58,970
perfect you can just tell them well I've

00:08:57,260 --> 00:09:00,620
done everything else grant said in the

00:08:58,970 --> 00:09:03,650
stack but there's always going to be

00:09:00,620 --> 00:09:06,830
some queries we just can't make be the

00:09:03,650 --> 00:09:08,690
best they can be so what is this stuff

00:09:06,830 --> 00:09:10,630
start to look like when I think about

00:09:08,690 --> 00:09:12,800
the bigger problem I tend to think about

00:09:10,630 --> 00:09:15,080
relevance going across three different

00:09:12,800 --> 00:09:16,940
dimensions the first one is the content

00:09:15,080 --> 00:09:19,010
side of the things this is the stuff

00:09:16,940 --> 00:09:21,020
you're all used to as search developers

00:09:19,010 --> 00:09:23,240
working on right and it's still really

00:09:21,020 --> 00:09:24,830
important it's still good for you to

00:09:23,240 --> 00:09:26,150
make sure you understand what fields

00:09:24,830 --> 00:09:28,100
you're searching on make sure you

00:09:26,150 --> 00:09:29,960
understand how we've seen and solar are

00:09:28,100 --> 00:09:32,240
doing their things make sure you've got

00:09:29,960 --> 00:09:34,700
your faceting and business rules and all

00:09:32,240 --> 00:09:36,440
of that kind of stuff but these days I

00:09:34,700 --> 00:09:39,230
spend most of my time that's kind of a

00:09:36,440 --> 00:09:40,700
given if you will with solar spend most

00:09:39,230 --> 00:09:43,279
of these times on things like

00:09:40,700 --> 00:09:45,380
collaboration and context and how do we

00:09:43,279 --> 00:09:47,779
leverage what information we know about

00:09:45,380 --> 00:09:50,930
what other users like you have done as

00:09:47,779 --> 00:09:53,750
well as who you are where you are what's

00:09:50,930 --> 00:09:57,500
the context of your situation in this

00:09:53,750 --> 00:10:00,170
particular case so what does this look

00:09:57,500 --> 00:10:02,750
like as we dig into the real world well

00:10:00,170 --> 00:10:04,580
so first off on the indexing side you

00:10:02,750 --> 00:10:06,700
often see more and more things like

00:10:04,580 --> 00:10:10,430
machine learning taking a look at

00:10:06,700 --> 00:10:12,230
building up a conceptual model of all of

00:10:10,430 --> 00:10:14,540
your data so for instance if you've

00:10:12,230 --> 00:10:17,120
heard the word word to vac or if you do

00:10:14,540 --> 00:10:19,279
named entity recognition if you're doing

00:10:17,120 --> 00:10:21,050
topic detection all of those kinds of

00:10:19,279 --> 00:10:23,060
things start to factor in you've built

00:10:21,050 --> 00:10:25,400
these offline models that you're

00:10:23,060 --> 00:10:27,680
injecting in at indexing time such as

00:10:25,400 --> 00:10:29,420
contents coming through you're taking

00:10:27,680 --> 00:10:30,890
that up you're enriching it all of those

00:10:29,420 --> 00:10:32,270
kinds of things you've been doing that

00:10:30,890 --> 00:10:34,130
for a number of years

00:10:32,270 --> 00:10:36,200
the cool thing these days is there's a

00:10:34,130 --> 00:10:39,950
lot of new technology out there that

00:10:36,200 --> 00:10:42,709
makes this stuff even better you might

00:10:39,950 --> 00:10:44,660
have your domain rule still and then you

00:10:42,709 --> 00:10:46,640
output all of that content the solar

00:10:44,660 --> 00:10:49,520
what you're starting to see now more and

00:10:46,640 --> 00:10:52,520
more is take a tool like spark bring in

00:10:49,520 --> 00:10:54,380
the data is kind of this continuous

00:10:52,520 --> 00:10:56,660
model now where you're constantly

00:10:54,380 --> 00:10:58,580
improving these models I kind of think

00:10:56,660 --> 00:11:00,709
about it as your search engine is your

00:10:58,580 --> 00:11:03,350
real-time best known state of your data

00:11:00,709 --> 00:11:06,260
and then offline you're constantly

00:11:03,350 --> 00:11:08,930
trying to improve that state of the data

00:11:06,260 --> 00:11:11,510
right such that then for

00:11:08,930 --> 00:11:13,310
anyways we put all of those models back

00:11:11,510 --> 00:11:16,160
into solar and you'll see some of this

00:11:13,310 --> 00:11:18,440
here as a demo later and then just

00:11:16,160 --> 00:11:20,630
continue on lather rinse repeat takes on

00:11:18,440 --> 00:11:22,550
a new meaning here because instead of

00:11:20,630 --> 00:11:24,680
you spending your time hard-coding your

00:11:22,550 --> 00:11:27,320
rules you're spending your time figuring

00:11:24,680 --> 00:11:29,020
out how to make better models that scale

00:11:27,320 --> 00:11:32,380
better that are more representative more

00:11:29,020 --> 00:11:35,420
generalizable all of that kind of stuff

00:11:32,380 --> 00:11:37,310
what's the query side look like well we

00:11:35,420 --> 00:11:39,440
got our happy user over here or

00:11:37,310 --> 00:11:41,720
hopefully a happy user one of the first

00:11:39,440 --> 00:11:43,610
things you start to see coming into play

00:11:41,720 --> 00:11:45,290
above and beyond what people typically

00:11:43,610 --> 00:11:46,790
do when they have solar is one of the

00:11:45,290 --> 00:11:50,330
first questions you want to ask yourself

00:11:46,790 --> 00:11:53,899
is what does this user actually mean by

00:11:50,330 --> 00:11:57,260
this query and do you even need to

00:11:53,899 --> 00:11:59,630
search right we assume as search

00:11:57,260 --> 00:12:01,130
developers that because people put in a

00:11:59,630 --> 00:12:03,200
query to your search engine that you

00:12:01,130 --> 00:12:04,820
damn well better hit the search engine

00:12:03,200 --> 00:12:06,950
because that's why I'm doing this all

00:12:04,820 --> 00:12:09,170
for but the reality is is you don't

00:12:06,950 --> 00:12:11,450
necessarily need to do that if a user

00:12:09,170 --> 00:12:13,550
comes onto your site and says how do I

00:12:11,450 --> 00:12:16,520
open a new account they don't want to

00:12:13,550 --> 00:12:18,620
see 10 blue links they want to take you

00:12:16,520 --> 00:12:21,170
you they want you to take them right to

00:12:18,620 --> 00:12:23,450
the account opening page or they say how

00:12:21,170 --> 00:12:25,880
do I make a return again don't show them

00:12:23,450 --> 00:12:28,700
10 blue links that have the word return

00:12:25,880 --> 00:12:31,520
in them take them to the page that says

00:12:28,700 --> 00:12:32,870
here's how you make a return right so

00:12:31,520 --> 00:12:36,650
you don't always have to be in this

00:12:32,870 --> 00:12:38,300
mindset of search so you want to think

00:12:36,650 --> 00:12:40,010
then about a couple of different things

00:12:38,300 --> 00:12:42,260
with query intent I tend to break it

00:12:40,010 --> 00:12:45,080
down into a couple pieces the strategic

00:12:42,260 --> 00:12:46,880
side of it is what is the overall intent

00:12:45,080 --> 00:12:49,220
is this user looking for a product are

00:12:46,880 --> 00:12:51,110
they looking for help are they you know

00:12:49,220 --> 00:12:54,740
teenagers being stupid and giving you

00:12:51,110 --> 00:12:57,110
spam etc etc the tactical part of that

00:12:54,740 --> 00:12:59,750
then is what are the key parts of that

00:12:57,110 --> 00:13:02,600
query that I can then leverage to make

00:12:59,750 --> 00:13:04,520
for a smarter query somebody comes in

00:13:02,600 --> 00:13:07,040
and searches for iPad well that's a

00:13:04,520 --> 00:13:11,270
brand it's also a tablet it's a product

00:13:07,040 --> 00:13:14,000
they might say 32 gigabyte iPad with a

00:13:11,270 --> 00:13:15,829
brown leather case in which case you

00:13:14,000 --> 00:13:18,440
have a brand and then you have a bunch

00:13:15,829 --> 00:13:21,200
of attributes or they might spell things

00:13:18,440 --> 00:13:22,760
wrong etc so you have all these tactical

00:13:21,200 --> 00:13:25,970
bits that you want to

00:13:22,760 --> 00:13:28,210
if I as part of that intent and then you

00:13:25,970 --> 00:13:30,950
could feed that into semantic engines

00:13:28,210 --> 00:13:33,830
next thing I often do is think about how

00:13:30,950 --> 00:13:37,520
does this query relate to all the other

00:13:33,830 --> 00:13:39,710
queries that I've seen before especially

00:13:37,520 --> 00:13:43,340
if you're in a consumer facing search

00:13:39,710 --> 00:13:45,350
site you often have a power-law

00:13:43,340 --> 00:13:48,470
distribution for your queries you know

00:13:45,350 --> 00:13:50,270
80% of your queries represent our 20% of

00:13:48,470 --> 00:13:52,580
your queries represent 80% of the volume

00:13:50,270 --> 00:13:54,710
that kind of stuff and so you might

00:13:52,580 --> 00:13:56,360
start to look at how am I going to

00:13:54,710 --> 00:13:58,070
leverage what I know about what are

00:13:56,360 --> 00:14:02,270
called my head queries my most popular

00:13:58,070 --> 00:14:04,490
queries to help answer what do I what I

00:14:02,270 --> 00:14:06,710
know about my tail queries my less

00:14:04,490 --> 00:14:08,410
frequent queries right and there's often

00:14:06,710 --> 00:14:10,760
actually a lot of really interesting

00:14:08,410 --> 00:14:12,530
relationships there in fact I was just

00:14:10,760 --> 00:14:15,530
working with a pretty largest of the top

00:14:12,530 --> 00:14:18,230
10 ecommerce site the other day

00:14:15,530 --> 00:14:20,080
something like 50% of their tail queries

00:14:18,230 --> 00:14:24,440
are one of two things they're either

00:14:20,080 --> 00:14:28,580
spelling misspelling or their attributes

00:14:24,440 --> 00:14:30,770
on a head query 50% of their tail so

00:14:28,580 --> 00:14:32,960
that's that really long lock tail and

00:14:30,770 --> 00:14:34,640
the reality is is most people are really

00:14:32,960 --> 00:14:37,070
good at tuning their head queries

00:14:34,640 --> 00:14:40,100
especially at really large scale so if

00:14:37,070 --> 00:14:42,710
you can help them improve 50% of their

00:14:40,100 --> 00:14:45,470
tail they're going to thank you quite a

00:14:42,710 --> 00:14:47,750
bit because they're laughing all the way

00:14:45,470 --> 00:14:49,940
to the bank as they say the other

00:14:47,750 --> 00:14:53,030
interesting thing about this is all of

00:14:49,940 --> 00:14:54,320
this data this clickstream data this is

00:14:53,030 --> 00:14:56,870
the same day that makes for better

00:14:54,320 --> 00:14:59,030
search it's the same data that makes for

00:14:56,870 --> 00:15:01,550
recommendations it's the same data that

00:14:59,030 --> 00:15:04,040
makes for personalization and it's the

00:15:01,550 --> 00:15:06,140
same data that makes for analytics and

00:15:04,040 --> 00:15:08,360
yet all too often I see companies who

00:15:06,140 --> 00:15:10,640
have those things all spread out in a

00:15:08,360 --> 00:15:12,470
lot of different places so for instance

00:15:10,640 --> 00:15:14,710
they put up the site users start

00:15:12,470 --> 00:15:17,480
clicking that goes off into Omniture

00:15:14,710 --> 00:15:20,450
Omniture over to the data science team

00:15:17,480 --> 00:15:23,210
data science team goes and builds some

00:15:20,450 --> 00:15:25,280
fancy model the engineers get that fancy

00:15:23,210 --> 00:15:27,950
model and say wow that's great we get a

00:15:25,280 --> 00:15:29,330
lot of uplift off of this model but gee

00:15:27,950 --> 00:15:31,100
that's too bad it's going to take us

00:15:29,330 --> 00:15:32,990
four months to actually get it into

00:15:31,100 --> 00:15:35,940
production because it's built an r and

00:15:32,990 --> 00:15:38,000
it's slow as can be right

00:15:35,940 --> 00:15:40,620
we want to solve those kinds of problems

00:15:38,000 --> 00:15:43,710
other things you might start to factor

00:15:40,620 --> 00:15:47,790
in is what user factors you have in the

00:15:43,710 --> 00:15:49,890
query are these young old male female

00:15:47,790 --> 00:15:52,170
green brown blue whatever it is that you

00:15:49,890 --> 00:15:54,990
use as factors for understanding your

00:15:52,170 --> 00:15:56,790
users then you want to start to bring

00:15:54,990 --> 00:15:58,890
those in things like their history their

00:15:56,790 --> 00:16:03,000
profile does this user prefer luxury

00:15:58,890 --> 00:16:05,460
brands or do they prefer value brands

00:16:03,000 --> 00:16:08,130
how do you use those things to bring

00:16:05,460 --> 00:16:09,900
into your search world as well as things

00:16:08,130 --> 00:16:12,060
like security if this is behind the

00:16:09,900 --> 00:16:15,720
firewall who can access what data all of

00:16:12,060 --> 00:16:16,380
that kind of stuff on and on we could go

00:16:15,720 --> 00:16:18,330
from there

00:16:16,380 --> 00:16:21,090
we could apply our domain-specific rules

00:16:18,330 --> 00:16:22,830
we hit solar I'll show you what kind of

00:16:21,090 --> 00:16:24,600
this query looks like here in a minute

00:16:22,830 --> 00:16:27,000
and then this is where it gets really

00:16:24,600 --> 00:16:28,710
interesting these days I think a lot of

00:16:27,000 --> 00:16:30,510
people who have been in the lucina's

00:16:28,710 --> 00:16:34,260
Solar land they tend to think about oh

00:16:30,510 --> 00:16:37,680
well I hit solar I do one query and then

00:16:34,260 --> 00:16:41,160
I get back my results maybe you've heard

00:16:37,680 --> 00:16:44,100
about the rear anchor or the rescore as

00:16:41,160 --> 00:16:47,220
it's called and leucine and so maybe you

00:16:44,100 --> 00:16:49,380
might think about how do I do some of

00:16:47,220 --> 00:16:51,840
that kind of stuff the reality is if you

00:16:49,380 --> 00:16:54,210
look at the top tier of search engines

00:16:51,840 --> 00:16:56,670
these days they actually are doing a

00:16:54,210 --> 00:16:58,920
whole cascading set of rear anchors such

00:16:56,670 --> 00:17:01,260
that something like a leucine based

00:16:58,920 --> 00:17:04,230
engine is you can kind of think about it

00:17:01,260 --> 00:17:06,390
that's my coarse-grained search results

00:17:04,230 --> 00:17:09,209
it's the one that more or less matches

00:17:06,390 --> 00:17:11,189
and then you apply a series of rear

00:17:09,209 --> 00:17:13,949
anchors on top of that I know some

00:17:11,189 --> 00:17:17,160
companies who have a single model just

00:17:13,949 --> 00:17:19,740
for scoring number one versus number two

00:17:17,160 --> 00:17:21,689
in the search results think about that

00:17:19,740 --> 00:17:23,490
right a lot of companies - like if you

00:17:21,689 --> 00:17:25,100
heard the Bloomberg talk earlier they

00:17:23,490 --> 00:17:28,050
talked about how you know you might have

00:17:25,100 --> 00:17:31,080
solar and then you might apply machine

00:17:28,050 --> 00:17:34,140
learning model that does the top 100 the

00:17:31,080 --> 00:17:36,210
top five under the top 1000 you can kind

00:17:34,140 --> 00:17:38,700
of just continue on down from that and

00:17:36,210 --> 00:17:40,710
reality is it kind of depends on how

00:17:38,700 --> 00:17:42,390
much do you care about these things

00:17:40,710 --> 00:17:43,980
right as to how much you're going to

00:17:42,390 --> 00:17:45,960
invest in that again if you're making

00:17:43,980 --> 00:17:47,940
all of your money off of search you

00:17:45,960 --> 00:17:49,260
probably should care about it and you

00:17:47,940 --> 00:17:51,060
might want on

00:17:49,260 --> 00:17:54,330
number one versus number two or at least

00:17:51,060 --> 00:17:55,890
a top ten versus top 20 type models the

00:17:54,330 --> 00:17:57,660
other things you can do here is for

00:17:55,890 --> 00:17:59,280
instance if you take your query intent

00:17:57,660 --> 00:18:02,190
one of the things the query intent might

00:17:59,280 --> 00:18:04,590
do is say this search belongs to this

00:18:02,190 --> 00:18:08,070
particular category you might have a

00:18:04,590 --> 00:18:10,020
category per model in fact I was at a

00:18:08,070 --> 00:18:11,940
academic conference last year that

00:18:10,020 --> 00:18:14,850
Amazon presented that and they have

00:18:11,940 --> 00:18:18,210
something like 130 or 140 I forget the

00:18:14,850 --> 00:18:20,790
exact number different models depending

00:18:18,210 --> 00:18:23,670
on what category you know so jewelry

00:18:20,790 --> 00:18:25,680
might have its own model and you know

00:18:23,670 --> 00:18:27,690
snowblowers might have its own model

00:18:25,680 --> 00:18:30,060
right kind of again depends on where you

00:18:27,690 --> 00:18:32,430
make your money as to how much time you

00:18:30,060 --> 00:18:34,740
would invest in there you might also do

00:18:32,430 --> 00:18:36,840
things like put in bias Corrections

00:18:34,740 --> 00:18:41,490
there if you're not up on the latest in

00:18:36,840 --> 00:18:43,950
search all things equal most people will

00:18:41,490 --> 00:18:46,230
pick the number one item regardless of

00:18:43,950 --> 00:18:48,510
what's there versus number two so you

00:18:46,230 --> 00:18:51,240
might have some functionality in your

00:18:48,510 --> 00:18:53,790
system that allows you to perturb those

00:18:51,240 --> 00:18:55,920
results make number one solar and all

00:18:53,790 --> 00:18:57,780
this stuff tells you it's number one you

00:18:55,920 --> 00:19:00,960
might just make it number two and test

00:18:57,780 --> 00:19:02,730
to see how that works right because it

00:19:00,960 --> 00:19:04,710
could just simply be that because of

00:19:02,730 --> 00:19:07,230
that first click or that first result

00:19:04,710 --> 00:19:09,510
bias something that actually deserves to

00:19:07,230 --> 00:19:12,060
be higher up is not getting enough

00:19:09,510 --> 00:19:16,140
signals or clickstream or any of those

00:19:12,060 --> 00:19:19,740
kinds of things in order to surface up

00:19:16,140 --> 00:19:22,530
to the top so and then of course you can

00:19:19,740 --> 00:19:25,890
apply your results transformations all

00:19:22,530 --> 00:19:28,020
of that kind of stuff a little bit on

00:19:25,890 --> 00:19:30,450
the learning to rank side there was a

00:19:28,020 --> 00:19:31,800
talk earlier by the bloomberg folks go

00:19:30,450 --> 00:19:34,230
listen to that one if you want all the

00:19:31,800 --> 00:19:37,650
gory details the cool thing is solar has

00:19:34,230 --> 00:19:39,630
got this built in these days and it's

00:19:37,650 --> 00:19:41,190
quite easy to use and in fact it also

00:19:39,630 --> 00:19:43,830
has some really nice tools around

00:19:41,190 --> 00:19:46,110
helping you with feature selection and

00:19:43,830 --> 00:19:47,880
those kinds of things the one caveat

00:19:46,110 --> 00:19:50,820
right now is you have to do your model

00:19:47,880 --> 00:19:53,280
training offline but you can use kind of

00:19:50,820 --> 00:19:56,040
standard training libraries like Lib

00:19:53,280 --> 00:19:57,660
linear Lib s V M lambda Mart all these

00:19:56,040 --> 00:20:00,780
ones that if you read the academic

00:19:57,660 --> 00:20:03,000
literature are commonly cited as the

00:20:00,780 --> 00:20:04,140
best performing system so

00:20:03,000 --> 00:20:05,700
I'm not going to go into too much

00:20:04,140 --> 00:20:09,420
details I'll show you a little bit of

00:20:05,700 --> 00:20:11,670
this in action in the demo oops forgot

00:20:09,420 --> 00:20:13,980
my animations here sorry about that

00:20:11,670 --> 00:20:16,890
if we look at the user side of all of

00:20:13,980 --> 00:20:19,590
this we got to capture what users are

00:20:16,890 --> 00:20:21,060
doing yet again this is you if we go

00:20:19,590 --> 00:20:23,430
back to that hey this stuff is really

00:20:21,060 --> 00:20:25,410
expensive or it's really convoluted by

00:20:23,430 --> 00:20:27,060
the time it all fits one of the things

00:20:25,410 --> 00:20:29,460
we just do at loser works is put all

00:20:27,060 --> 00:20:31,830
that data right back in solar it's very

00:20:29,460 --> 00:20:33,720
good at tracking events or signals as we

00:20:31,830 --> 00:20:36,090
call it so I've kind of given away the

00:20:33,720 --> 00:20:37,980
punchline here but these days what we do

00:20:36,090 --> 00:20:40,260
is we put in solar then we load it up

00:20:37,980 --> 00:20:42,510
via a spark we build our clickstream

00:20:40,260 --> 00:20:45,450
models we do things like our head tale

00:20:42,510 --> 00:20:47,700
analysis here we build out recommenders

00:20:45,450 --> 00:20:48,000
and personalization and all that kind of

00:20:47,700 --> 00:20:51,090
stuff

00:20:48,000 --> 00:20:55,380
and again the documents just end up back

00:20:51,090 --> 00:20:58,140
in solar as models and then forwards

00:20:55,380 --> 00:21:01,940
back into that query Edition that we

00:20:58,140 --> 00:21:04,260
talked about that's all well and good

00:21:01,940 --> 00:21:08,400
what does that query often look like

00:21:04,260 --> 00:21:10,560
this is kind of pseudo leucine solar

00:21:08,400 --> 00:21:12,000
syntax your mileage may vary there's

00:21:10,560 --> 00:21:14,130
lots of other things you could do with

00:21:12,000 --> 00:21:16,410
it I tend to think this is kind of how I

00:21:14,130 --> 00:21:20,040
can sexually think about what all this

00:21:16,410 --> 00:21:22,590
stuff looks like as more or less a query

00:21:20,040 --> 00:21:25,350
to the engine right it's not

00:21:22,590 --> 00:21:27,060
mathematically precise but I kind of

00:21:25,350 --> 00:21:29,160
think about it is those first two the

00:21:27,060 --> 00:21:31,290
exact original and the sloppy phrase

00:21:29,160 --> 00:21:34,440
that's kind of like my really high

00:21:31,290 --> 00:21:37,640
precision content-based matches that's

00:21:34,440 --> 00:21:41,460
what's going to get me a highly accurate

00:21:37,640 --> 00:21:43,260
set of results right and of course all

00:21:41,460 --> 00:21:45,300
of those weights that I have on there

00:21:43,260 --> 00:21:47,370
those can be learned or you can guess at

00:21:45,300 --> 00:21:49,350
them try them out and then I'll do

00:21:47,370 --> 00:21:51,540
things like ands and ORS just to make

00:21:49,350 --> 00:21:53,850
sure that I'm getting everything the or

00:21:51,540 --> 00:21:55,260
really becomes your recall query to make

00:21:53,850 --> 00:21:57,960
sure that you at least retrieve

00:21:55,260 --> 00:22:00,450
something that resembles what your user

00:21:57,960 --> 00:22:02,670
asked for many of you are probably

00:22:00,450 --> 00:22:05,610
already doing this with things like the

00:22:02,670 --> 00:22:08,730
EDA smacks or whatever other Lucien's

00:22:05,610 --> 00:22:11,280
disjunction whatever it's named

00:22:08,730 --> 00:22:13,679
query underneath the hood but probably

00:22:11,280 --> 00:22:15,390
these other things are new to you so in

00:22:13,679 --> 00:22:16,230
fact you can think about it how do we

00:22:15,390 --> 00:22:18,630
bring

00:22:16,230 --> 00:22:21,540
in expansions our clique our head-tail

00:22:18,630 --> 00:22:23,640
relationships all of those as queries

00:22:21,540 --> 00:22:26,130
you can bring in your personalization

00:22:23,640 --> 00:22:28,080
biases you can bring in learning to rank

00:22:26,130 --> 00:22:31,740
all of these things start to seamlessly

00:22:28,080 --> 00:22:34,080
work together and outcomes your search

00:22:31,740 --> 00:22:36,660
results naturally you can apply your

00:22:34,080 --> 00:22:39,840
filters your hard filters across all of

00:22:36,660 --> 00:22:41,790
that as well with your filter queries a

00:22:39,840 --> 00:22:44,010
couple of interesting things here you

00:22:41,790 --> 00:22:46,470
know like I said one of it is you have a

00:22:44,010 --> 00:22:48,450
lot of knobs and dials so if in your

00:22:46,470 --> 00:22:50,340
particular application you don't have a

00:22:48,450 --> 00:22:52,830
lot of confidence in the quality of your

00:22:50,340 --> 00:22:56,010
click data for instance then maybe you

00:22:52,830 --> 00:22:57,840
know that why why there is lower than if

00:22:56,010 --> 00:23:00,780
you have a lot of confidence in that

00:22:57,840 --> 00:23:02,549
data depending on how you do your

00:23:00,780 --> 00:23:04,860
learning to rank some of these things

00:23:02,549 --> 00:23:06,630
you maybe would push down into your

00:23:04,860 --> 00:23:08,460
learning to rank model if you wanted

00:23:06,630 --> 00:23:10,440
there's some trade-offs there in terms

00:23:08,460 --> 00:23:12,870
of your essentially hard coding into a

00:23:10,440 --> 00:23:14,669
model that you then have to reload

00:23:12,870 --> 00:23:16,049
anytime you want to change it whereas if

00:23:14,669 --> 00:23:17,730
you do it at query time you have a

00:23:16,049 --> 00:23:20,580
little bit more flexibility and trying

00:23:17,730 --> 00:23:22,650
things out there and then you know

00:23:20,580 --> 00:23:25,530
things like your personalization biases

00:23:22,650 --> 00:23:27,030
of course you need to be aware of what

00:23:25,530 --> 00:23:29,610
you're doing what choices you're making

00:23:27,030 --> 00:23:32,780
when you personalize you want to make

00:23:29,610 --> 00:23:36,030
sure that you're not doing bad or

00:23:32,780 --> 00:23:40,980
encoding your own personal biases into

00:23:36,030 --> 00:23:43,799
those kinds of things so this is just a

00:23:40,980 --> 00:23:45,600
quick solar syntax example I'll leave it

00:23:43,799 --> 00:23:47,700
up there you can look at it later but

00:23:45,600 --> 00:23:50,669
essentially at the top that's your main

00:23:47,700 --> 00:23:52,530
query things like filters are your query

00:23:50,669 --> 00:23:55,679
intents like in this particular query

00:23:52,530 --> 00:23:56,370
i'm classifying it as computers and

00:23:55,679 --> 00:23:58,650
tablets

00:23:56,370 --> 00:23:59,880
i've got a learning to rank model in

00:23:58,650 --> 00:24:03,630
there i don't know why i have all the

00:23:59,880 --> 00:24:05,790
stuff URL encoded but it is and then

00:24:03,630 --> 00:24:10,220
things like my boost and all that stuff

00:24:05,790 --> 00:24:12,720
is at the bottom there that's all great

00:24:10,220 --> 00:24:14,940
right but at the end of the day don't

00:24:12,720 --> 00:24:17,100
take my word for all this one of the key

00:24:14,940 --> 00:24:21,750
things to modern relevance is you adopt

00:24:17,100 --> 00:24:23,460
an experimentation mindset right what

00:24:21,750 --> 00:24:26,549
you want to do is within your company

00:24:23,460 --> 00:24:29,190
drive down the cost of running an

00:24:26,549 --> 00:24:30,029
experiment most people don't know this

00:24:29,190 --> 00:24:31,559
but most of the

00:24:30,029 --> 00:24:33,479
search engines the big search engines

00:24:31,559 --> 00:24:36,929
they run hundreds if not thousands of

00:24:33,479 --> 00:24:39,149
experiments a year right at any given

00:24:36,929 --> 00:24:41,219
time it may be the only 10% of your

00:24:39,149 --> 00:24:43,349
users ever see what that engine

00:24:41,219 --> 00:24:48,320
considers to be the best version of the

00:24:43,349 --> 00:24:50,399
engine everything else is an experiment

00:24:48,320 --> 00:24:52,979
some experiments are going to be really

00:24:50,399 --> 00:24:55,679
good your marketing team will be really

00:24:52,979 --> 00:24:58,590
happy with you most experiments are

00:24:55,679 --> 00:25:00,239
going to be flat at best and some of

00:24:58,590 --> 00:25:02,190
them are going to be really bad losers

00:25:00,239 --> 00:25:04,619
so make sure you kill them when

00:25:02,190 --> 00:25:07,409
appropriate as fast as possible if you

00:25:04,619 --> 00:25:08,460
want to learn more about that ronnie

00:25:07,409 --> 00:25:10,769
koha vini

00:25:08,460 --> 00:25:13,049
I always butcher his name as a really

00:25:10,769 --> 00:25:15,779
good talk on how Microsoft runs their

00:25:13,049 --> 00:25:17,639
experiment management framework and then

00:25:15,779 --> 00:25:20,429
you know at the end of the day we still

00:25:17,639 --> 00:25:23,609
have that 800-pound hammer if you will

00:25:20,429 --> 00:25:25,859
of rules of saying I want Munich to be

00:25:23,609 --> 00:25:27,539
boosted this high up in the results you

00:25:25,859 --> 00:25:30,839
can use things like the query elevation

00:25:27,539 --> 00:25:33,179
component or other rule-based systems I

00:25:30,839 --> 00:25:35,489
just try to encourage everyone when

00:25:33,179 --> 00:25:37,769
they're thinking about rules is to make

00:25:35,489 --> 00:25:40,019
sure they put the rules in the context

00:25:37,769 --> 00:25:43,469
of an experiment and they make sure that

00:25:40,019 --> 00:25:45,119
their rules have a lifespan I can't tell

00:25:43,469 --> 00:25:47,580
you the number of places I've gone in

00:25:45,119 --> 00:25:51,719
where a customer will have 10,000 plus

00:25:47,580 --> 00:25:55,139
rules and you say oh that rule right

00:25:51,719 --> 00:25:59,450
there what's that do and you'll get this

00:25:55,139 --> 00:26:02,580
blank stare back at you Joe wrote that

00:25:59,450 --> 00:26:04,379
like I've never met a Joe I've been

00:26:02,580 --> 00:26:07,399
working with you for six months now

00:26:04,379 --> 00:26:10,589
where's Joe Oh Joe quit five years ago

00:26:07,399 --> 00:26:13,349
like why is it still there well Joe

00:26:10,589 --> 00:26:15,330
wrote it you said it works and on you go

00:26:13,349 --> 00:26:17,070
next thing you know you've got 10,000

00:26:15,330 --> 00:26:18,809
rules you might as well not even have a

00:26:17,070 --> 00:26:22,139
search engine just have the rules return

00:26:18,809 --> 00:26:24,570
the documents right so just make sure

00:26:22,139 --> 00:26:26,369
you put rules in the context of the

00:26:24,570 --> 00:26:29,129
bigger picture that you're trying to do

00:26:26,369 --> 00:26:30,960
and think about how do they how do you

00:26:29,129 --> 00:26:33,059
actually measure them for effectiveness

00:26:30,960 --> 00:26:38,849
and how do you make sure you continue to

00:26:33,059 --> 00:26:40,289
measure for effectiveness all right cool

00:26:38,849 --> 00:26:43,139
what does this stuff actually look like

00:26:40,289 --> 00:26:43,950
I'll show you a demo of it a couple of

00:26:43,139 --> 00:26:45,360
things there are

00:26:43,950 --> 00:26:47,549
texture I'm not going to spend a lot of

00:26:45,360 --> 00:26:49,049
time on it but spark and solar are the

00:26:47,549 --> 00:26:51,809
key pieces here and then we've got some

00:26:49,049 --> 00:26:54,840
machine learning bits we're going to

00:26:51,809 --> 00:26:56,730
focus in on and in fact the couple of

00:26:54,840 --> 00:26:58,799
key things going on here on the solar

00:26:56,730 --> 00:27:00,779
side we've got all this extensive text

00:26:58,799 --> 00:27:02,700
ranking stuff I don't want you to throw

00:27:00,779 --> 00:27:04,230
any of that out that's still good stuff

00:27:02,700 --> 00:27:06,720
and you've worked hard to learn that

00:27:04,230 --> 00:27:10,230
kind of stuff things like your different

00:27:06,720 --> 00:27:13,169
similarity models BM 25 cosine whatever

00:27:10,230 --> 00:27:14,880
it is you want to use underneath the

00:27:13,169 --> 00:27:17,220
hood things like function queries boost

00:27:14,880 --> 00:27:19,320
the block the re-ranking capabilities

00:27:17,220 --> 00:27:22,110
learning to rank all that kind of stuff

00:27:19,320 --> 00:27:24,809
on the spark side primarily there's a

00:27:22,110 --> 00:27:27,809
lot of machine learning stuff you could

00:27:24,809 --> 00:27:30,539
also use mehat you could use any engine

00:27:27,809 --> 00:27:32,340
out there you want but essentially we

00:27:30,539 --> 00:27:34,470
need something that allows us to take

00:27:32,340 --> 00:27:37,320
all of these this raw data all of these

00:27:34,470 --> 00:27:41,490
signals these cliques etc and turn that

00:27:37,320 --> 00:27:44,970
into a better search result so what I'm

00:27:41,490 --> 00:27:49,799
going to do then is demo this ecommerce

00:27:44,970 --> 00:27:51,179
data set one in a 1.3 million items the

00:27:49,799 --> 00:27:54,210
more interesting thing is out of this

00:27:51,179 --> 00:27:56,190
data set you've got one month of query

00:27:54,210 --> 00:27:58,049
logs that's really the gold that stuff

00:27:56,190 --> 00:28:01,559
that you used to throw away that's what

00:27:58,049 --> 00:28:05,639
you're keeping now I've done the offline

00:28:01,559 --> 00:28:07,710
training of the models offline if you

00:28:05,639 --> 00:28:08,429
want to see how all of that gory details

00:28:07,710 --> 00:28:11,519
works

00:28:08,429 --> 00:28:13,649
go watch the Bloomberg talk etc but I

00:28:11,519 --> 00:28:16,590
essentially just build it did I took the

00:28:13,649 --> 00:28:18,779
signals I rolled up on the user ID and

00:28:16,590 --> 00:28:21,240
the query are not the user ID on the

00:28:18,779 --> 00:28:23,669
query and output the counts of the query

00:28:21,240 --> 00:28:27,870
document pairs and I use that as a rough

00:28:23,669 --> 00:28:29,490
estimate of relevance in terms of

00:28:27,870 --> 00:28:31,950
feeding that into the learning the rank

00:28:29,490 --> 00:28:35,370
module and then I'm using fusion which

00:28:31,950 --> 00:28:38,909
like I said the key parts here SPARC 2.1

00:28:35,370 --> 00:28:45,870
and solar 6 and then I built a UI out on

00:28:38,909 --> 00:28:49,889
top of it as well so all things willing

00:28:45,870 --> 00:28:52,250
live demo on my local laptop let me

00:28:49,889 --> 00:28:52,250
login

00:28:52,659 --> 00:28:57,460
a couple of different things I'll

00:28:54,519 --> 00:28:59,169
highlight here first off everything you

00:28:57,460 --> 00:29:02,320
see here is going to be done by

00:28:59,169 --> 00:29:04,359
searching against solar I've calculated

00:29:02,320 --> 00:29:06,639
a bunch of stuff offline and spark and

00:29:04,359 --> 00:29:09,399
installed that back into the end of the

00:29:06,639 --> 00:29:11,320
engine first thing to note I talked

00:29:09,399 --> 00:29:14,889
about a/b testing you saw how that

00:29:11,320 --> 00:29:17,590
changed from tablets to TVs one of the

00:29:14,889 --> 00:29:19,299
things that we just build in is the

00:29:17,590 --> 00:29:21,940
ability to do those experiments by

00:29:19,299 --> 00:29:23,590
essentially injecting parameters into

00:29:21,940 --> 00:29:25,960
the solar query to say I want to search

00:29:23,590 --> 00:29:28,269
this way or I want to search that way

00:29:25,960 --> 00:29:29,950
this particular one I've set up a very

00:29:28,269 --> 00:29:32,639
simple experiment that's just going to

00:29:29,950 --> 00:29:35,409
say TVs versus tablets and as the user

00:29:32,639 --> 00:29:38,950
interacts with those with that landing

00:29:35,409 --> 00:29:40,929
page it will then auto level if TVs are

00:29:38,950 --> 00:29:43,570
performing better than tablets those

00:29:40,929 --> 00:29:47,229
will be shown more shown more if tablets

00:29:43,570 --> 00:29:49,659
are getting more of the users then we'll

00:29:47,229 --> 00:29:52,659
move that up and in fact though it has

00:29:49,659 --> 00:29:55,239
ways of if TVs happen to be having a bad

00:29:52,659 --> 00:29:57,820
day one day it will still show TVs

00:29:55,239 --> 00:30:00,279
enough such that over time it figures

00:29:57,820 --> 00:30:02,649
out who's best the other thing that's

00:30:00,279 --> 00:30:04,539
interesting here is just using all of

00:30:02,649 --> 00:30:06,700
that signal data on the product catalog

00:30:04,539 --> 00:30:09,369
just doing a search against solar

00:30:06,700 --> 00:30:10,809
getting back recommendations done some

00:30:09,369 --> 00:30:13,119
more advanced things underneath the hood

00:30:10,809 --> 00:30:15,309
using some of the more modern recommend

00:30:13,119 --> 00:30:17,409
a recommender engine capabilities like

00:30:15,309 --> 00:30:19,509
alternating least squares and all that

00:30:17,409 --> 00:30:21,489
kind of stuff but essentially I've got

00:30:19,509 --> 00:30:24,489
user based recommendations that's part

00:30:21,489 --> 00:30:26,919
of understanding that user and now the

00:30:24,489 --> 00:30:28,929
moment of truth if I come in here and I

00:30:26,919 --> 00:30:31,419
do a search for iPad

00:30:28,929 --> 00:30:34,419
what I've got here is a way of getting

00:30:31,419 --> 00:30:36,639
started is some very basic results this

00:30:34,419 --> 00:30:38,710
is me doing a little bit of solar tuning

00:30:36,639 --> 00:30:41,019
I think you would agree with me a search

00:30:38,710 --> 00:30:43,539
experts there all right if you actually

00:30:41,019 --> 00:30:45,249
look at the data you can see why those

00:30:43,539 --> 00:30:46,629
first ones match they've got the word

00:30:45,249 --> 00:30:50,289
iPad in there I'm essentially doing

00:30:46,629 --> 00:30:52,419
keyword matching here the reality is and

00:30:50,289 --> 00:30:54,849
I've also I'm looking at a title

00:30:52,419 --> 00:30:58,599
description and there's like this sales

00:30:54,849 --> 00:31:01,330
rank data in there and in fact those top

00:30:58,599 --> 00:31:04,920
three accessories for ipad are all

00:31:01,330 --> 00:31:07,050
highly purchased items

00:31:04,920 --> 00:31:08,700
so perhaps I'm boosting a little bit too

00:31:07,050 --> 00:31:10,740
much on that sales rank and I could

00:31:08,700 --> 00:31:13,320
spend some time on it but you know the

00:31:10,740 --> 00:31:14,460
lats a fourth one there is the iPad but

00:31:13,320 --> 00:31:18,750
the reality is I think you would agree

00:31:14,460 --> 00:31:19,920
with me these results are just ok I'm

00:31:18,750 --> 00:31:22,170
going to show you fusion just because

00:31:19,920 --> 00:31:24,030
it's mainly easy way for me to edit all

00:31:22,170 --> 00:31:26,460
of this stuff let me make sure I'm

00:31:24,030 --> 00:31:27,630
logged in here but essentially what and

00:31:26,460 --> 00:31:29,190
I'll show you the underpinnings they

00:31:27,630 --> 00:31:31,590
just output parameters I'm just

00:31:29,190 --> 00:31:33,690
outputting parameters of solar I've got

00:31:31,590 --> 00:31:35,610
a particular pipeline set up here that's

00:31:33,690 --> 00:31:37,650
just doing solar queries I'll show you

00:31:35,610 --> 00:31:40,470
that in a second but let's get to the

00:31:37,650 --> 00:31:44,100
punchline first I'm going to switch to

00:31:40,470 --> 00:31:46,200
one that uses signals and then beyond

00:31:44,100 --> 00:31:48,360
that I'll show you one with learning to

00:31:46,200 --> 00:31:50,670
rank so now what I did is same query

00:31:48,360 --> 00:31:52,680
doing the same search against solar but

00:31:50,670 --> 00:31:54,600
now I've overlaid that single

00:31:52,680 --> 00:31:56,340
information on there I think you would

00:31:54,600 --> 00:31:58,680
agree with me these results are a lot

00:31:56,340 --> 00:32:01,140
better but you can still see that things

00:31:58,680 --> 00:32:03,480
like those accessories still show up

00:32:01,140 --> 00:32:04,980
here because people in fact when they

00:32:03,480 --> 00:32:06,510
search for iPad are buying these

00:32:04,980 --> 00:32:09,450
accessories if you look in the raw data

00:32:06,510 --> 00:32:11,400
it's in there but you know your

00:32:09,450 --> 00:32:13,890
expectation here would be that we're

00:32:11,400 --> 00:32:16,470
finding the iPad so that's all well and

00:32:13,890 --> 00:32:19,710
good a couple of other things to note

00:32:16,470 --> 00:32:22,260
built out I've shown you one recommender

00:32:19,710 --> 00:32:24,720
user for item recommenders the query

00:32:22,260 --> 00:32:26,730
there is the user ID the second one this

00:32:24,720 --> 00:32:29,490
related searches the query for that

00:32:26,730 --> 00:32:32,220
recommender is the query so I'm doing

00:32:29,490 --> 00:32:35,520
query for query recommendations if I

00:32:32,220 --> 00:32:37,920
click through on a particular item got

00:32:35,520 --> 00:32:40,530
now item for item recommendations yet

00:32:37,920 --> 00:32:44,400
another collection in solar this time

00:32:40,530 --> 00:32:45,390
key buy items and getting back results

00:32:44,400 --> 00:32:47,220
for those things

00:32:45,390 --> 00:32:49,290
the cool thing like I said here is all

00:32:47,220 --> 00:32:51,420
that same data that signal data that

00:32:49,290 --> 00:32:54,870
clickstream data can be used to measure

00:32:51,420 --> 00:32:56,670
or implement all of these things and you

00:32:54,870 --> 00:32:58,190
have a much simpler deployment and all

00:32:56,670 --> 00:33:00,360
of that kind of stuff

00:32:58,190 --> 00:33:02,880
digging in a little deeper let's

00:33:00,360 --> 00:33:06,810
actually look at what this stuff looks

00:33:02,880 --> 00:33:09,450
underneath the hood load up my query

00:33:06,810 --> 00:33:10,770
view here I've got that default may be a

00:33:09,450 --> 00:33:12,780
little bit hard to read there in the

00:33:10,770 --> 00:33:15,390
back let me make that a little bit

00:33:12,780 --> 00:33:18,809
bigger for those of you who are solar

00:33:15,390 --> 00:33:21,019
Lucene devs this is just bait

00:33:18,809 --> 00:33:23,940
sickly a little bit of an interface over

00:33:21,019 --> 00:33:25,649
the top of the EDA Smacks query you can

00:33:23,940 --> 00:33:27,960
see like this is where I spent some time

00:33:25,649 --> 00:33:30,539
early on like oh I think names are

00:33:27,960 --> 00:33:32,789
boosted by 10 and descriptions by 5 and

00:33:30,539 --> 00:33:34,409
all of that kind of stuff right and on

00:33:32,789 --> 00:33:37,230
down the chain we could go and we get

00:33:34,409 --> 00:33:41,370
those results we saw first if I load up

00:33:37,230 --> 00:33:44,039
that other pipeline the one with the

00:33:41,370 --> 00:33:46,559
signals on a little bit different look

00:33:44,039 --> 00:33:49,590
to this one the very first thing we do

00:33:46,559 --> 00:33:52,110
here is actually go query another

00:33:49,590 --> 00:33:53,970
collection called the signals

00:33:52,110 --> 00:33:55,919
aggregation collection I built that

00:33:53,970 --> 00:33:59,249
offline it essentially has a time

00:33:55,919 --> 00:34:00,840
decayed based model off of what users

00:33:59,249 --> 00:34:02,970
are doing with this data such that

00:34:00,840 --> 00:34:06,119
things that are popular today aren't

00:34:02,970 --> 00:34:08,730
necessarily popular tomorrow right I do

00:34:06,119 --> 00:34:11,940
that query then I make decisions about

00:34:08,730 --> 00:34:16,020
how much do I care about how much do

00:34:11,940 --> 00:34:17,849
users care about the documents that's

00:34:16,020 --> 00:34:19,349
what these roll-ups and boosts are and

00:34:17,849 --> 00:34:21,480
then I'm applying rules I'm not going to

00:34:19,349 --> 00:34:23,490
show you the rules engine here today in

00:34:21,480 --> 00:34:25,679
the interest of time but I hook in the

00:34:23,490 --> 00:34:28,980
rule stuff so that's kind of that next

00:34:25,679 --> 00:34:31,619
level first level with solar next level

00:34:28,980 --> 00:34:33,919
is I'm using clickstream things the last

00:34:31,619 --> 00:34:37,290
level here I can show you today is

00:34:33,919 --> 00:34:40,919
essentially one with the full shebang if

00:34:37,290 --> 00:34:43,740
you will the first stage I've got in my

00:34:40,919 --> 00:34:47,010
process of a request coming in is I'm

00:34:43,740 --> 00:34:48,869
actually I've trained offline infusion

00:34:47,010 --> 00:34:50,609
and spark off of that same data I've

00:34:48,869 --> 00:34:54,510
trained a classifier that tries to

00:34:50,609 --> 00:34:57,569
predict what category does this query

00:34:54,510 --> 00:35:00,329
belong to and I'm just loading that up

00:34:57,569 --> 00:35:04,040
as a model in fact I'm loading it right

00:35:00,329 --> 00:35:06,720
out of solar as a model and then the

00:35:04,040 --> 00:35:09,630
query comes in it looks in the cue field

00:35:06,720 --> 00:35:12,060
and then it's going to output into the

00:35:09,630 --> 00:35:16,200
request pipeline a field called

00:35:12,060 --> 00:35:17,670
predicted query category okay the next

00:35:16,200 --> 00:35:19,829
thing I'm going to do here then and you

00:35:17,670 --> 00:35:23,010
could do a lot of things now I've chosen

00:35:19,829 --> 00:35:24,480
to do one very simple thing namely I

00:35:23,010 --> 00:35:27,119
have a little bit of a condition that

00:35:24,480 --> 00:35:29,569
here that says basically if this query

00:35:27,119 --> 00:35:32,380
category is anything other than other

00:35:29,569 --> 00:35:36,310
then apply a filter

00:35:32,380 --> 00:35:38,410
to this content okay you could do boosts

00:35:36,310 --> 00:35:40,330
off of that you could change your

00:35:38,410 --> 00:35:43,600
learning to rank model you could do lots

00:35:40,330 --> 00:35:45,640
of different things here and then you

00:35:43,600 --> 00:35:47,680
know I've done things like I turn on

00:35:45,640 --> 00:35:50,050
learning the rank and then all the rest

00:35:47,680 --> 00:35:53,620
of this is the same let me come back

00:35:50,050 --> 00:35:57,340
here and I'll just show you what this

00:35:53,620 --> 00:36:01,420
looks like right here instead of going

00:35:57,340 --> 00:36:03,340
back to the main UI you can see so for

00:36:01,420 --> 00:36:08,410
instance let me turn off the filter

00:36:03,340 --> 00:36:11,860
query you can see there's AG Apple iPad

00:36:08,410 --> 00:36:14,020
yada yada those are promoted up if I and

00:36:11,860 --> 00:36:16,450
there is 1800 it's a little hard to read

00:36:14,020 --> 00:36:20,020
back there there's 1800 results returned

00:36:16,450 --> 00:36:22,570
there if I turn on that filter it now

00:36:20,020 --> 00:36:24,760
filters down is essentially categorizing

00:36:22,570 --> 00:36:26,650
iPad as a computer or tablet I'm

00:36:24,760 --> 00:36:29,430
applying that as a filter query against

00:36:26,650 --> 00:36:33,250
the category name and now I've only got

00:36:29,430 --> 00:36:34,990
896 results you can see also I have some

00:36:33,250 --> 00:36:38,170
interesting results here at the top

00:36:34,990 --> 00:36:41,290
those are in fact built off the learning

00:36:38,170 --> 00:36:43,480
to rank model if I turn those off I can

00:36:41,290 --> 00:36:46,390
get those results the learning to rank

00:36:43,480 --> 00:36:48,940
model I just did a very simple set of

00:36:46,390 --> 00:36:51,610
features there things like the price and

00:36:48,940 --> 00:36:53,380
a few other pieces off of there I didn't

00:36:51,610 --> 00:36:55,270
spend a lot of time on making sure the

00:36:53,380 --> 00:36:57,520
learning to rank model is the absolute

00:36:55,270 --> 00:36:58,930
best learning to rank model I just spent

00:36:57,520 --> 00:37:01,960
time on making sure all the plumbing

00:36:58,930 --> 00:37:04,420
works if you want to you have to spend a

00:37:01,960 --> 00:37:09,130
lot more time on the features and all of

00:37:04,420 --> 00:37:12,160
that kind of stuff so that's the demo if

00:37:09,130 --> 00:37:13,750
you want ah there's some resources I

00:37:12,160 --> 00:37:22,530
think we've got a couple of minutes left

00:37:13,750 --> 00:37:22,530
for questions thank you

00:37:25,400 --> 00:37:29,250
other questions in the audience there's

00:37:28,500 --> 00:37:39,150
one in the middle

00:37:29,250 --> 00:37:41,430
give me a second hi there so on your

00:37:39,150 --> 00:37:43,680
perfect queries like you mentioned all

00:37:41,430 --> 00:37:46,740
the different boosts the X the Y the set

00:37:43,680 --> 00:37:49,079
and so on and said hey all of them can

00:37:46,740 --> 00:37:51,780
be learned and now I was wondering

00:37:49,079 --> 00:37:54,359
what's coming up to learn the very first

00:37:51,780 --> 00:37:57,450
the X that you give basically to the

00:37:54,359 --> 00:37:59,609
p.m. 25 model to this course can we

00:37:57,450 --> 00:38:03,119
learn them already as well in the

00:37:59,609 --> 00:38:05,640
context of LTR yeah exactly that's kind

00:38:03,119 --> 00:38:07,440
of what the ltr' stuff does you know you

00:38:05,640 --> 00:38:09,630
can essentially if you look at the ltr'

00:38:07,440 --> 00:38:11,670
stuff it's great question you could

00:38:09,630 --> 00:38:20,099
factor in a lot more of these things as

00:38:11,670 --> 00:38:21,690
part of the LTR model right yeah so in

00:38:20,099 --> 00:38:23,730
fact the question was are they available

00:38:21,690 --> 00:38:27,119
to the offline learning if you look at

00:38:23,730 --> 00:38:28,829
the the example that solar ships with

00:38:27,119 --> 00:38:30,960
there's this little Python program in

00:38:28,829 --> 00:38:33,630
there and it basically as its training

00:38:30,960 --> 00:38:36,000
its taking in the set of relevant

00:38:33,630 --> 00:38:37,619
results that you gave it and then it's

00:38:36,000 --> 00:38:40,319
hitting the features in getting the

00:38:37,619 --> 00:38:42,180
content back from solar to get that

00:38:40,319 --> 00:38:44,069
offline to get the information for

00:38:42,180 --> 00:38:46,380
training so it's essentially saying oh

00:38:44,069 --> 00:38:48,270
I've got this relevant information match

00:38:46,380 --> 00:38:51,119
it up with the documents that are in

00:38:48,270 --> 00:38:53,130
solar already and then learn a model off

00:38:51,119 --> 00:38:55,710
of those features so yeah you definitely

00:38:53,130 --> 00:38:59,010
could represent some of those things as

00:38:55,710 --> 00:39:02,220
part of as part of the offline learning

00:38:59,010 --> 00:39:04,020
to rank stuff right the caveat with you

00:39:02,220 --> 00:39:05,670
know we use learning rank for a lot of

00:39:04,020 --> 00:39:07,710
these things there's also these other

00:39:05,670 --> 00:39:09,329
places where you want machine learning

00:39:07,710 --> 00:39:11,040
like your query intent and all of that

00:39:09,329 --> 00:39:13,710
kind of stuff that maybe or maybe not

00:39:11,040 --> 00:39:16,349
belong in the inner loop or the near

00:39:13,710 --> 00:39:18,780
inner loop of a learning to rank model

00:39:16,349 --> 00:39:20,760
so depending on what kind of flexibility

00:39:18,780 --> 00:39:22,589
you want you may decide to do some of

00:39:20,760 --> 00:39:25,170
this classification stuff up front or

00:39:22,589 --> 00:39:29,160
some of it in the learning to rank area

00:39:25,170 --> 00:39:31,339
yeah Oh a dog is going to ask me a tough

00:39:29,160 --> 00:39:31,339
question

00:39:32,810 --> 00:39:38,810
I was curious in your experience if you

00:39:37,010 --> 00:39:40,580
viewers used learning to rank directly

00:39:38,810 --> 00:39:42,950
as a recommendation solution and how it

00:39:40,580 --> 00:39:45,170
compares versus like ALS or other

00:39:42,950 --> 00:39:46,250
traditional offline methods that's a

00:39:45,170 --> 00:39:49,310
great question I actually haven't

00:39:46,250 --> 00:39:51,050
compared those two you certainly could I

00:39:49,310 --> 00:39:54,560
mean essentially a search engine the

00:39:51,050 --> 00:39:56,210
math is roughly maybe not the same as

00:39:54,560 --> 00:39:58,100
like an ALS or some of these latent

00:39:56,210 --> 00:40:00,320
models that are doing like latent

00:39:58,100 --> 00:40:03,050
factorization that kind of stuff but you

00:40:00,320 --> 00:40:04,700
probably could get reasonably close in

00:40:03,050 --> 00:40:07,280
terms of performance and you don't have

00:40:04,700 --> 00:40:08,840
this offline step if you don't want to

00:40:07,280 --> 00:40:11,090
which you know may or may not kind of

00:40:08,840 --> 00:40:13,280
again there's always this threshold in

00:40:11,090 --> 00:40:14,870
my mind of like how much time do I want

00:40:13,280 --> 00:40:17,480
to invest in and that threshold is

00:40:14,870 --> 00:40:19,490
almost always based off of how much

00:40:17,480 --> 00:40:20,870
money do you make off of your search

00:40:19,490 --> 00:40:23,990
engine and how many people do you have

00:40:20,870 --> 00:40:26,300
on your team right so just doing a pure

00:40:23,990 --> 00:40:29,960
soul or peer whatever leucine you can

00:40:26,300 --> 00:40:31,550
certainly get a good model taking it to

00:40:29,960 --> 00:40:35,690
that next level I didn't really show it

00:40:31,550 --> 00:40:40,570
here but you know for instance all of

00:40:35,690 --> 00:40:46,280
those models like right here this is

00:40:40,570 --> 00:40:48,830
your output from my learning my offline

00:40:46,280 --> 00:40:53,540
ALS model is just item ID and other item

00:40:48,830 --> 00:40:54,800
ID right the related searches is I don't

00:40:53,540 --> 00:40:57,590
know why I'm looking up there when I can

00:40:54,800 --> 00:40:59,990
look here the related searches same kind

00:40:57,590 --> 00:41:02,830
of thing here you know people who search

00:40:59,990 --> 00:41:05,660
for Bower and Wilkins also search for

00:41:02,830 --> 00:41:07,280
workaholics those kinds of things the

00:41:05,660 --> 00:41:10,190
cool thing here right is all your data

00:41:07,280 --> 00:41:11,960
is just right back in solar right and so

00:41:10,190 --> 00:41:13,970
you can take and you don't have to have

00:41:11,960 --> 00:41:18,650
this big long trip you know between

00:41:13,970 --> 00:41:20,840
armature and all those other pieces all

00:41:18,650 --> 00:41:21,330
right oh let's think gaunt again thank

00:41:20,840 --> 00:41:26,739
you

00:41:21,330 --> 00:41:26,739

YouTube URL: https://www.youtube.com/watch?v=CRZfc9lj7Po


