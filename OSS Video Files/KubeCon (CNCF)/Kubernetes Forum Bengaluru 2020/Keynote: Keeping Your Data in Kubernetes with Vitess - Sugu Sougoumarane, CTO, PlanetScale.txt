Title: Keynote: Keeping Your Data in Kubernetes with Vitess - Sugu Sougoumarane, CTO, PlanetScale
Publication date: 2020-02-27
Playlist: Kubernetes Forum Bengaluru 2020
Description: 
	Don't miss KubeCon + CloudNativeCon 2020 events in Amsterdam March 30 - April 2, Shanghai July 28-30 and Boston November 17-20! The conference features presentations from developers and end users of Kubernetes, Prometheus, Envoy, and all of the other CNCF-hosted projects - Learn more at https://kubecon.io

Keynote: Keeping Your Data in Kubernetes with Vitess - Sugu Sougoumarane, CTO, PlanetScale 

An increasing number of applications and workloads are being migrated to and are being built for Kubernetes. It has been sufficiently established that Kubernetes is the platform of the future. However, drilling down will reveal that the most successful of these workloads are stateless, and that the database/storage layers have mostly remained outside. This begs the question: What will it take to run everything in Kubernetes? What are the risks and benefits? In this respect, Vitess has a unique background. Due to the fact that it was built to run on Borg, it was ready for Kubernetes from day one. The best part of this is that many leading-edge adopters ran with Vitess very early on; this resulted in a diverse group of Vitess deployments on Kubernetes, from tiny Vitess installations all the way to JDâ€™s colossal clusters. Organizations that have adopted this approach are reaping many unique benefits such as no vendor lock-in, unified management of infrastructure, and self-service based automations. We will cover all these use cases and go over the details of how these organizations benefited by going all in with Kubernetes. 

https://sched.co/YW4L
Captions: 
	                              good morning it's almost afternoon cool                               so since didn't start about where he                               went to school and stuff I thought I                               should one-up him you know I'm also from                               Palani and and I also tamil Marathi and                               Hindi and French actually my name is                               Melton French that's why it is it's kind                               of weird it's actually just super modern                               No                                cool so talking about kubernetes                                kubernetes is winning the platform water                                every day is more and more workloads                                moving to kubernetes but guess which                                workload is lagging behind a big time                                data bases people are not moving data                                bases as fast as they are moving other                                workloads and why is that so that's what                                I'm going to talk about and why we test                                is relevant to this topic so with us is                                now a graduated project of CN CF we                                graduated last November and to graduate                                actually you go through a pretty                                extensive scrutiny they actually make                                sure that the project project has good                                adoption that enough people are using it                                and they are not looking for like                                peripheral uses they want to see                                production workloads mission critical                                workloads they want to see maintaining a                                diversity and they want to see like                                prolonged maintenance maintainer                                contribution then they drill into the                                project make sure it's healthy and stuff                                so having gone through all that the                                basic certification is that with us is                                actually a very healthy project and                                deserves to be called certified one so                                what is with us we test first of all is                                a cloud native database so we'll                                definitely talk more about what that                                means it is massively scalable so for                                massively scalable I'm going to give you                                a quiz so JD comm is                                one of the largest retailers in China                                they have worked they have about seven                                sixty seven billion dollars in revenue                                and they are fully on kubernetes they                                are using the tests last November on                                their singles day sale that's kind of                                like the diwali of china so i want to                                take you to kind of try to take a guess                                at what kind of QPS which has served for                                them on that day and i will share that                                number later so to start to talk about                                how massively we test can scale it's                                highly available so five nines of                                availability is a pretty comfortable for                                with us and last but not the least it's                                based on my sequel which means that if                                you are running on my sequel it's quite                                easy to move to the test so if you go to                                google and search about like what is                                cloud native you'll find like a lot of                                definitions the problem is many of them                                most of them are like kind of abstract                                and to me there's a much simpler way to                                look at it if it runs on kubernetes it                                is cloud native so Vitas says it is                                cloud native which means that runs very                                well on kubernetes and here we have this                                is another thing everybody is showing                                tweets so I should also show tweets so                                Kelsey says don't move stateful                                workloads - kubernetes                                you are going to regret it so on one                                side with that says you should move                                stateful workloads to kubernetes and                                kelsey is saying something else                                what gives who is right so we both are                                let's talk about why Kelsey is right so                                what he is saying is you cannot just                                take my sequel and put it in kubernetes                                and expect it to work if you do that                                you're going to have a bad experience                                lose data that kind of experience so why                                is that so                                reason is because kubernetes was                                designed mainly keeping stateless                                workloads in mind so stateful workloads                                are kind of an afterthought and because                                of that you cannot just take databases                                and run them easily in kubernetes so in                                such an environment how did we test                                managed to overcome these obstacles and                                still call itself cloud native there was                                actually a lot of debate when we test                                went to CN CF and say that we are cloud                                native we had to actually show a lot of                                data points to prove ourselves to be                                 cloud native so there's one historical                                 reason which is where we test came from                                 so we originally built with tests at                                 YouTube we were on bare metal and                                 eventually after Google borders we had                                 to move that work load into Google's                                 Borg the Google's Borg is Google's                                 private cloud it is actually the                                 predecessor for kubernetes and guess                                 what Google's Borg is also not friendly                                 to stateful workloads                                 and it's not a coincidence that                                 kubernetes is the way it is given that                                 it came from world so how did we manage                                 to run with us in Google's work when                                 it's not friendly to stateful workloads                                 we ran it as if it was a stateless                                 application and I'll talk about how we                                 did that so the fact that we ran in                                 Google's work when kubernetes came out                                 we were ready for it in fact we                                 announced that we TAS is ready for                                 kubernetes before kubernetes                                             but the best of all this is we kept it                                 open source and you can't imagine how                                 that hard that is to keep something                                 open-source while running inside Google                                 the number of proprietary api's in                                 Google enormous but we built an                                 abstraction layer for each and every one                                 of those things so that allowed us to                                 keep with us an open source project so                                 the technical reason as to how we made                                 with this cloud native                                 we built automation automation means                                 that if you bring up a replica it needs                                 know how to initialize itself it has to                                 go seek out what is the latest backup                                 restore from it and do all the necessary                                 household work to get itself ready and                                 then after that somebody has to know                                 that that replica exists so some some                                 weight of finding out that it exists and                                 start sending traffic with that and then                                 the orchestration layer where if a                                 master goes down how do you do the                                 reparent Inge and all that work and                                 continue to keep the site up to serve                                 your right traffic and then finally                                 managing durability making sure that no                                 data is lost so stateless and durable                                 they don't seem to go together but                                 that's basically what we did with us how                                 did we do it so we ran actually every                                 with a spot ran on emptied or emptied er                                 means ephemeral storage ephemeral                                 storage means that if kubernetes takes                                 your part down it wipes your data so how                                 do you run a database where every time a                                 part goes down all your data is wiped so                                 what we did was we ran enough number of                                 replicas and enable this feature in my                                 cycle called semi sync replication which                                 ensures that before a commit is                                 acknowledged at least one other replica                                 has the data so if a master goes down we                                 know that data is somewhere all we have                                 to do is figure out which replicas that                                 is promote that as the master and                                 continue serving and then build this                                 failover mechanism when something goes                                 down actually do all this failover                                 without losing downtime and sometimes                                 that's this is actually some of the                                 things when you run in the cloud there                                 are situations that you don't usually                                 encounter on well stable bare metal                                 situations sometimes there's network                                 partitions you can't reach the old                                 master but you still need to serve right                                 traffic what did we do in that time say                                 okay replicas you are now the master                                 forget about that one and when that                                 happens there's two masters that try to                                 report themselves as being master                                 so we had to write logic to actually                                 detect who the correct master is and                                 actually ignore the imposter so these                                 are all the things you have to do to                                 make something that is stateful run in a                                 stateless environment so at the end of                                 the day you want to know why is it why                                 is it important to move a storage to                                 kubernetes and the other one is how is                                 it going to work for me can it work for                                 me right the best way to do it is to                                 look at some case studies so slack has                                 been experiencing hyper growth and not                                 only that they've been facing changing                                 business needs and they needed a                                 solution that actually solved both                                 problems so they started evaluating with                                 tests and do you think that it they                                 thought it was going to work so they                                 started adopting it migrating some                                 workload and you know what for them they                                 was kind of guarding excited no I think                                 this is going to work for us so in                                      this was the quote that came out of                                 slack about the test then they move more                                 workloads and it kept scaling they got                                 them really really excited now you can                                 see the change in the tone so this is                                 actually testimony to how trusted with                                 us is and how much they love it                                 in fact even last week they published a                                 blog post and they said that with us is                                 one of the revolutionary technologies                                 that helped slack move forward in                                 business so JD calm so I talked about JD                                 dot-com in the beginning now let's see                                 I'm going to reveal the number they have                                 about                                                           translates roughly into about                                        parts and they're QPS on singles day was                                                                                                    that's massive scale but then on the                                 other hand there is nozzle which is                                 actually just a startup so why would a                                 start-up use something like with this                                 know they used with test because they                                 wanted to run all in kubernetes                                 and that actually is a good decision and                                 I'm just going to tell you why so as                                 your gives them a good deal give them a                                 good meal they said well good pricing                                 lot of credits so they ran actually                                 their software on aks but then after a                                 while Google Cloud countered that this                                 happens all the time what did they do                                 they just pack their bags and move to                                 Google Cloud in one hour there's                                 actually a talk by direct Perkins you                                 can find it online and that is what you                                 get if you move if you run everything in                                 kubernetes no vendor lock-in anytime you                                 want you can just pack up and go and                                 there's no vendor that can hold you                                 hostage with their custom features so in                                 other words conclude my message is if                                 you are moving to kubernetes don't leave                                 your data behind keep everything with                                 you and the benefits are huge                                 so we test has a very healthy community                                 we are like vibrant excited set of                                 people you can see here people from                                 India people from Venezuela Canada all                                 over the world and we are growing so                                 you're most welcome to come and join us                                 if you go to Vitas dot IO you can                                 actually on top left on top right there                                 is a button you can click to join or                                 slack channel can join there and then                                 message me and it's been great talking                                 to you I'll see you out there thank you                                 [Applause]
YouTube URL: https://www.youtube.com/watch?v=mDUVYP3x_nc


