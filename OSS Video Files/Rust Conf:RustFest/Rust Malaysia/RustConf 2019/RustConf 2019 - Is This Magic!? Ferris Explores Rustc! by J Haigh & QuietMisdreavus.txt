Title: RustConf 2019 - Is This Magic!? Ferris Explores Rustc! by J Haigh & QuietMisdreavus
Publication date: 2019-09-19
Playlist: RustConf 2019
Description: 
	RustConf 2019 - Is This Magic!? Ferris Explores Rustc! by J Haigh & QuietMisdreavus

Join our protagonist Ferris as they explore the wild unknown of the Rust compiler. With a little help from the locals, they manage to make a map of the various compiler crates, and gain an understanding of where each fits in the compiler. They also get to see where the locals congregate, and plan out their own expeditions. Eager for some extra hands, the locals start to teach Ferris the ropes of compiler development, from finding a good first issue, to setting up their own build, to testing their code. They even get some tips about working through the Pull Request workflow, to make sure their first contribution goes smoothly. Will Ferris discover the magic inside Rustc? Tune in to find out!
Captions: 
	                              [Music]                               hello welcome to the talk we're going to                               explain how to do your first                               contribution to rust see the roughs                               compiler to sum the rust compilers just                               the thing that yells at them when they                               run cargo build some people get curious                               about what happens under the hood and                               the compiler holds all the answers                                getting a better understanding of the                                compiler by reading the code and                                starting to contribute to rusty turns                                the angry red compiler errors into a                                hopeful friend trying to guide you along                                on an adventure will give you an                                introduction to the compiler and the                                teams tell you about what you need to                                set up your dev environment find a good                                first issue work through an example                                issue and explain the pull requests                                workflow we're going to present this                                talk as a whimsical kind of story                                with occasional breaks for more in-depth                                technical information but first we'd                                like to introduce ourselves hello my                                name is Jay Hague and I'm debug Steven                                on Twitter I'm currently a Haskell                                developer at sim space I'm organizing                                Colorado gold rust this year it's on                                September                                                        interested in attending and I've                                contributed to a handful of rust                                projects including Russ stock inside of                                rusty I did my first contribution to                                rusty at the recurse Center last winter                                the recurse Center is a self-directed                                community driven coding retreat in New                                York City hi my name is gray but you                                might know me better as quite                                mischievous on Twitter and github and                                the like I'm the lead of the Russ talk                                team so I help out a lot with                                maintaining the Russ talk tool that runs                                inside cargo dock and docks our rest                                documentation hosting site later this                                year also be tending attending the                                Ricker Center to spend even more time                                working on those things but without                                further ado let's jump right into our                                story I'm sure many of you know our                                lovable mascot Faris the crab they're a                                curious sort helped along by the                                friendly rust community today it looks                                like Ferris is hanging out on the beach                                playing                                oh it looks like Ferris has found                                themselves a little hole to burrow into                                what if you found their Ferris                                I've always been brought spigots fan I                                just love the language and I've gone                                pretty good at writing Ross code I want                                to know more about how the Russ                                programming language works so today as                                you can see I'm digging into the sand to                                see if maybe I can find answers to my                                questions there oh dear oh dear that                                isn't any ordinary hole                                it's a worm hole where do you think it                                will lead this doesn't seem to have any                                visible bottom it seems to just be                                tumbling downward and downward who knows                                where we might land we could land in a                                magical other world or right back where                                we started                                who knows oh my look what's happened to                                you Ferris looks like I've landed on a                                desert island but this isn't the same                                island I was playing on earlier                                who's that approaching ahoy there                                welcome to the rust sea home of rust see                                the rust compiler                                who might you be I'm Faris the rough see                                sounds like a fun place I was trying to                                learn more about how rust works and                                contribute back to the community can you                                show me around sure I could show you the                                lay of the land I have a map right here                                here on the rust see there are many                                islands that you can visit from parser                                island and the Far West you can continue                                on to resolve Island High Island check                                island middle news low islands and                                finally link island in the Far West each                                island has a special industry that                                contributes to its local culture but                                that's just the main island chain to                                kind of take a step back from the story                                a little bit this corresponds to the                                flow of the compiler you know like                                 there's several steps that it goes                                 through there's the parser the name                                 resolver there's the type checker and                                 the borrowed checker there's sort of                                 intermediate representations high middle                                 and low and then at the end it links it                                 into the final binary so like there's                                 this like basic process that you go                                 through this is also why that if you've                                 worried if you're working on your code                                 and it seems like you've gotten through                                 all of your compiler errors and then                                 you're hit with a bunch more that's                                 because you've reached the next phase                                 you reach the next island so to speak                                 but let's jump right back into the story                                 there are many islands on the rust sea                                 and they're all so many peoples there's                                 the industrious compiled Ariens keepers                                 of the vast machines of the main islands                                 the resourceful language painstaking                                 designers of those machines the studious                                 dachshund authors of great tomes of                                 knowledge the gregarious communitarians                                 always looking out for newcomers to the                                 islands the craftsy tool crafters                                 creators of machines used by both the                                 Islanders and people all over the world                                 and many more I want to be more than                                 just the Rus language mascot I want to                                 be a pirate too in our quest to make the                                 rusty even better how can I become a                                 contributor to the compiler and get                                 started well the easiest thing you can                                 do is start with an issue to work on                                 that'll get you all the experience you                                 need                                 if you want to just read about the                                 current issues facing the islands                                 there's no better place than the bouncy                                 board we try to keep it categorized so                                 you can look around for what pleases you                                 some labels are valuable prizes like                                 either cheesy or E - mental err those                                 are prime targets for newcomers to                                 snatch up so be quick I'm more of a                                 social type I prefer to talk to people                                 where they are okay let me take you to                                 the watering hole all the finest sailors                                 plan their expeditions they're welcome                                 in                                 it looks like the specials today are the                                 discord drought and the zoo lip singer                                 wow there's so many people here I wonder                                 if anyone here needs I help with                                 anything hmm excuse me you there yeah do                                 you know if there's any trouble out on                                 the rust see a strange noise when you                                 aren't sailing you say I wonder what                                 that could be gosh well I think I know                                 some sailors who could help you out                                 let's get started                                 so taking step back from the story a                                 little bit this is how you get started                                 on the issue in in contributions you can                                 find an issue that someone else has                                 posted to work on or you can kind of                                 jump in with the teens and get invested                                 in the lingo and stuff so the compiler                                 repo and many of the official like all                                 of the official kind of rust project                                 repositories keep and the debt issues                                 page and there's even a team of people                                 specifically that keep up with the the                                 issues and pull requests on the compiler                                 repo and there are a bunch of labels                                 that we use but the couple that I called                                 out eat a cheesy need detriment or mean                                 that either you don't need a lot of                                 experience with the compiler to work on                                 it like it doesn't either a lot of                                 in-depth knowledge or that someone has                                 laid out the steps to resolve it                                 respectively and so like I said if you                                 find both of these on an issue it's not                                 likely to be there for very long                                 and if you're feeling more social a                                 bunch of the teams have chat rooms or                                 places where they hang out and so you                                 can go in local                                 learn the lingo find out things to work                                 on before they're even posted and if as                                 they're being worked as they're being                                 designed let's hop right back in if you                                 want to go on an expedition you'll need                                 to provision yourself the cannon                                 unfortunately we can just clone you a                                 new one you'll also need some tools to                                 get started your own clanging Bell a                                 curled sword I see you've got one                                 already a talisman we call the vexatious                                 get that should work nicely and of                                 course your own life Python I'll so                                 remember that you can tweak and                                 configure your cannon to your liking                                 there's a configuration file that comes                                 with it                                 so you can read through it all and see                                 what tweaks you can make and again this                                 ties back to rest is built on github                                 there's a nice repo and that you can                                 work for your own and clone yourself to                                 get the code on your machine there are a                                 handful of dependencies to be able to                                 build it                                 like I said curl get a C++ compiler I                                 mentioned clang but Jesus I and M SVC                                 work to Python and C mate and there's a                                 configuration file it's kept in the                                 repos config tamil dot example so and                                 that has all of the documentation for                                 each what each kind of knob and option                                 does and when you want to tweak it for                                 yourself copy it and as conflict Tamil                                 and week away and that'll play with your                                 compile process jumping back in now that                                 we're all set up let's get ready to fire                                 remember a pirate ship doesn't work the                                 same as those cargo ships you might be                                 used to we do things a little                                 differently around here we use a tool                                 called X x marks the spot you might know                                 but it should almost work the same as                                 what you're used to                                 there is a check a build a dock a test                                 same as usual just keep in mind we fire                                 our cannons and stages here keeps                                 everything shipshape sometimes you'll be                                 in stage one sometimes stage two it                                 depends on what kind of expedition                                 you're on so as I mentioned building the                                 rescue pile you don't use cargo directly                                 it has its own little build tool it                                 manages building putting the compiler                                 together because the rust compiler is                                 itself built written in rust it needs to                                 kind of build itself a couple times to                                 make sure everything is valid and you                                 get a useable compiler at the end so                                 instead we use x pi which is just this                                 Python script that's included in the                                 repo and it weirds a little bit like                                 cargo                                 you've got check build test and dock it                                 has its own set of documentation but it                                 works Li the same and like I said                                 there's also stages because it kind of                                 builds itself so it depending on what                                 you're working on you can kind of skip                                 the last build and work on stage one or                                 sometimes you need to work on stage two                                 so you know just kind of if you're if                                 you wonder what you're working if you                                 wonder which one you need talk to                                 someone on the compiler team they'll fly                                 point you in the right direction fire                                 there are so many issues you can                                 encounter when you're out sailing the                                 rough sea when you've found your own                                 issue and your dev environment is all                                 set up you're almost ready to start                                 writing code at that point you've                                 probably read through the issue make                                 sure you know the problem you're trying                                 to solve and ask questions if there's                                 anything you're unclear on asking                                 questions either on the issue or in the                                 team channel or the most likely spots to                                 get answers if you're working with                                 somewhere I've been talking with the                                 team you may ask question somewhere else                                 or work with a mentor directly just us                                 the team with their preferences let's                                 walk through an example and see about                                 exploring the code and adding our own                                 contribution to it                                 so panic bit filed an issue that they                                 wanted to see re-exported crates and                                 creatives inline and Russ dock this code                                 would display foo as if it were a module                                 in the docs this code would inline the                                 re-exported items as if you were a                                 module in Whiting takes the items from                                 one location and duplicates their                                 documentation in another location                                 Rostock code lives in the compiler repo                                 in source slash with Rostock we can find                                 the existing code for how crates and                                 exported items are currently handled and                                 then change it how we want it to be from                                 a high level we know Russ stock walks                                 through the generated abstract syntax                                 tree and then Queens up the ast to                                 remove duplications this is where the                                 implementation for how the docks should                                 be generated waves let's look at the                                 section of code for crates and create                                 items this section of code currently                                 Queen's up the extern crate and returns                                 a single extern create item our                                 implementation for showing the exported                                 crate in items needs to go inside the                                 clean trade function for an extern crate                                 we know that we may return multiple                                 items since there are many items that                                 can be exported from a crate we want to                                 add the items names to a please inline                                 list if we have the dock inline                                 attribute above the item we want to                                 iterate through our items and if the                                 item is in the poison line list we want                                 to try to inline that item luckily we                                 saw there is a try inline function there                                 are certain situations where an item                                 can't be inlined either it's local or                                 we're not going to generate it for a                                 page etc so we need to take that into                                 account when solving this problem the                                 logic ends up looking something like                                 this if there's a pub on the extern                                 create statement start looking through                                 the attributes if there's a dark                                 attribute above a statement we'll look                                 through the parenthesized list then if                                 there's an inline in that parenthesized                                 wist will try to inline that item in the                                 if pwease inline block if we found the                                 dock inline attribute will try to inline                                 that item we'll need to have an empty                                 hash set for try inline                                 Oh technical difficulties                                 I didn't see what it was we need an                                 empty hash set for try in line we also                                 need a def which the compiler uses to                                 identify items and crates it compiles                                 this one corresponds to the root of the                                 crate we're importing try in line                                 returns an option if it returns the                                 crates items use that instead of the                                 extern crate item which we would                                 otherwise return later on the function                                 signature also changes a little bit here                                 instead of returning a single item the                                 crate we might return the crate and the                                 items exported from the crate so we did                                 a few changes to allow us to return a                                 vector of items back where this function                                 is called re replaced our previous use                                 of math with flat map and we changed the                                 imple queen-to-be to allow us to return                                 a vector of items instead of a singular                                 item we also use the Beck macro to wrap                                 the extern create item array we                                 originally returned when we weren't in                                 mining but we aren't done yet we also                                 need to add some new crates to test the                                 code we just wrote and write some Docs                                 to make sure that users can verify this                                 works and so that they know how to use                                 it for their rest code we add a sample                                 case to the test suite the Russ doc                                 tests are a little special compared to                                 the rest of the compiler so we're not                                 going to get into the details of how                                 these tests work we do have a companion                                 blog post on both of our blogs full of                                 links to where you can read more about                                 those if you're interested                                 so now that we figured out the issue                                 solves it and made our docks in line the                                 extern crates we need to let the                                 Islanders know so that they can tell                                 everyone else about the new feature I'll                                 make sure everything stays shipshape how                                 do we notify the Islanders                                 I'll show you we sometimes call these                                 broadcasts to pull so we'll need to                                 write a letter called the pull request                                 or a PR so we can ask them to pull about                                 our expedition oh I know about those                                 from my other adventures great this                                 should be a breeze then so when you were                                 creating a pull request we want to talk                                 about the issues we were looking for and                                 solving and how we solved it so you may                                 want to link to the particular issue                                 that you're fixing if there is one here                                 our issue was about inlining extern                                 crates on the sea near parser island                                 when we looked into it we found the                                 extern crates and they're exported                                 functions were not yet being shown as                                 modules in our generative rust                                 documentation so to add this feature we                                 implement a crane for extra and create                                 items and to make sure it stays first we                                 put in a check to make sure that our                                 documentation generated the way we would                                 expect that should keep the dachshund                                 happy yeah so now that we have the pr                                 written up let's send it off they might                                 write back to ask for more details or to                                 go back and tweak the fix but if they                                 like it they'll run it through a machine                                 called bourse to pull it out to all of                                 the islands it's also possible they turn                                 it down oh no problem not every PR will                                 land but it's still a contribution of                                 your time and knowledge and walking away                                 from every contribution teaches you                                 something new it's awesome to get code                                 in but you're always going to walk away                                 with some sort of contribution now that                                 you have you for a sex petition under                                 your belt what do you think of life on                                 the rest see it looks like it's a                                 pirate's life for me yeah                                 [Applause]                                 thanks for coming again if you want to                                 read even more about how to contribute                                 like Jay said we have a companion blog                                 post on both of our blogs that goes into                                 more detail about the workflow there's                                 also a great guide that the compiler                                 team has put together about all the ins                                 and outs of the compiler how to build at                                 how testing works and way more that's                                 the third link there I've also put the                                 link to the compiler repo itself as well                                 as the discord where mini where a lot of                                 the teams hang out and the zoo look                                 where a lot more of the teams hang out                                 so thanks again we hope you all enjoyed                                 [Applause]                                 [Music]
YouTube URL: https://www.youtube.com/watch?v=1TUYAlNzCTU


