Title: Christine Waigl   The Next Step Finding Model Parameters With Random Walks    PyCon 2017
Publication date: 2017-05-21
Playlist: PyCon 2017
Description: 
	"Speaker: Christine Waigl

The statistician John Tukey -- who designed the box plot and coined the term ""bit"" -- wrote:  ""An approximate answer to the right problem is worth a good deal more than an exact answer to an approximate problem"". Python has become one of the major languages for statistical data analysis, not least because of the expressiveness of the language itself and the availability of tools like Jupyter Notebooks, which enable iterative reasoning about a problem and its solutions. 

This talks takes one step beyond an introduction to statistics with Python and aims to familiarize the audience with two concepts: a class of problems (so-called inverse problems), and a powerful statistical tool (the random walk, or more formally Markov-Chain Monte Carlo (MCMC) sampling with the Metropolis algorithm). 

In inverse problems, model parameters are estimated from observational data. Both model and data are expected to be affected by error. The objective is not only to find parameters that best describe the observations, but also to figure out how good, or how possibly bad, a solution might be. Inverse problems are extremely common in many fields and crop up each time we attempt to reconstruct a reality from sensor, radar, scattering or imaging data. 

The Metropololis-Hastings algorithm offers a solution via random sampling of a Bayesian posterior distribution. Even though listed as one of the 20th century's top 10 algorithms by the journal _Computing in Science & Engineering_, the Metropolis algorithm is easy to understand and implement, and a fun and instructive way to explore even complicated multi-variate probability distributions. 

Slides can be found at: https://speakerdeck.com/pycon2017 and https://github.com/PyCon/2017-slides"
Captions: 
	00:00:00,000 --> 00:00:05,100
speaker is Chris from the University of

00:00:02,730 --> 00:00:07,259
Fairbanks where she's a PhD candidate

00:00:05,100 --> 00:00:13,550
and she's going to be talking about

00:00:07,259 --> 00:00:13,550
random walk thank you everybody

00:00:16,580 --> 00:00:24,330
has to say it's a great pleasure to be

00:00:19,109 --> 00:00:26,099
at PyCon every time again and thank you

00:00:24,330 --> 00:00:29,189
all of you for coming here on this last

00:00:26,099 --> 00:00:34,980
day I need to ask a question who of you

00:00:29,189 --> 00:00:36,719
was in the previous talk because my

00:00:34,980 --> 00:00:38,520
feeling is that anybody who was in the

00:00:36,719 --> 00:00:40,920
previous talk already knows what I'm

00:00:38,520 --> 00:00:43,350
going to talk about but maybe I've got

00:00:40,920 --> 00:00:45,800
something still that's like let me fill

00:00:43,350 --> 00:00:49,710
in some gaps so I'm going to talk about

00:00:45,800 --> 00:00:51,840
gave my talk to title the next step and

00:00:49,710 --> 00:00:53,910
I will in a moment talk about why and

00:00:51,840 --> 00:00:56,190
it's about finding model parameters with

00:00:53,910 --> 00:00:59,340
random walks and as I was just

00:00:56,190 --> 00:01:01,410
introduced I am a scientist and I use

00:00:59,340 --> 00:01:04,439
statistics the way I use web development

00:01:01,410 --> 00:01:07,140
and the way I use algorithms without

00:01:04,439 --> 00:01:09,689
ever having formally get a degree in it

00:01:07,140 --> 00:01:11,610
or had more than one class at a time and

00:01:09,689 --> 00:01:15,299
training I mostly used your spatial

00:01:11,610 --> 00:01:17,220
titles but I've been of course I need to

00:01:15,299 --> 00:01:22,049
use statistics because I work mostly

00:01:17,220 --> 00:01:22,380
with satellite data I extract stuff from

00:01:22,049 --> 00:01:24,720
it

00:01:22,380 --> 00:01:26,430
I do modeling on it and I use

00:01:24,720 --> 00:01:29,220
statistical methods and I use Python for

00:01:26,430 --> 00:01:32,159
it and there is something Python has

00:01:29,220 --> 00:01:33,750
become a really really important tool in

00:01:32,159 --> 00:01:35,790
the statistics toolbox and there are

00:01:33,750 --> 00:01:37,290
much much more impressive people than me

00:01:35,790 --> 00:01:39,450
who have been giving talks about this

00:01:37,290 --> 00:01:41,700
here and I have been seeing talks that

00:01:39,450 --> 00:01:43,770
are sort of on this on this on this

00:01:41,700 --> 00:01:45,869
arrow from beginner level to super

00:01:43,770 --> 00:01:48,420
advanced and have an excellent talks

00:01:45,869 --> 00:01:50,759
about intro to statistics they have been

00:01:48,420 --> 00:01:53,850
talks about like ad scale

00:01:50,759 --> 00:01:55,829
production-wise chewing through whatever

00:01:53,850 --> 00:01:59,700
kind of huge modeling problems and then

00:01:55,829 --> 00:02:01,680
there are these middle tones and I think

00:01:59,700 --> 00:02:03,930
the one before me was in the middle here

00:02:01,680 --> 00:02:06,210
and I think the one after me too but my

00:02:03,930 --> 00:02:08,610
talk is just taking one more step of the

00:02:06,210 --> 00:02:10,319
beginner level if you have some basic

00:02:08,610 --> 00:02:12,060
notion about statistics I want to say

00:02:10,319 --> 00:02:13,819
okay what can I do with it without being

00:02:12,060 --> 00:02:15,950
yet a huge

00:02:13,819 --> 00:02:19,000
I want to say you could look at some

00:02:15,950 --> 00:02:21,650
physical systems or other systems even

00:02:19,000 --> 00:02:23,990
well it's often science but I've seen

00:02:21,650 --> 00:02:25,610
the same in economics why you model a

00:02:23,990 --> 00:02:28,010
system and need a statistical way of

00:02:25,610 --> 00:02:31,760
doing it and statistics often makes you

00:02:28,010 --> 00:02:34,340
helps you by letting you sample your

00:02:31,760 --> 00:02:36,860
problem space instead of having to solve

00:02:34,340 --> 00:02:40,160
something mathematically analytically so

00:02:36,860 --> 00:02:42,260
as a great decision and 2k said an

00:02:40,160 --> 00:02:44,360
approximate answer to the right problem

00:02:42,260 --> 00:02:46,880
it's worth a good deal more than an

00:02:44,360 --> 00:02:48,260
exact answer to is it an approximate

00:02:46,880 --> 00:02:50,600
problem but sometimes you could say the

00:02:48,260 --> 00:02:51,980
wrong problem like a toy problem this

00:02:50,600 --> 00:02:56,000
said I'm going to talk about a toy

00:02:51,980 --> 00:02:58,010
problem today so there are problems that

00:02:56,000 --> 00:03:00,500
you get like in the 20th or 21st century

00:02:58,010 --> 00:03:02,959
physics textbook and they look like this

00:03:00,500 --> 00:03:05,030
if I drop a stone into a well and I have

00:03:02,959 --> 00:03:07,459
the weld steps how long does it take for

00:03:05,030 --> 00:03:09,140
me to hear the sound back that's what

00:03:07,459 --> 00:03:11,989
you all did in high school or college

00:03:09,140 --> 00:03:14,480
physics probably the seniors so here's a

00:03:11,989 --> 00:03:16,850
well drop my stone in obviously the

00:03:14,480 --> 00:03:18,590
total time is the time it takes us for

00:03:16,850 --> 00:03:20,329
the stone to go down and then plus the

00:03:18,590 --> 00:03:22,820
time for the sound to come back up right

00:03:20,329 --> 00:03:26,120
but this is not the kind of problem we

00:03:22,820 --> 00:03:27,980
solve in science at all and

00:03:26,120 --> 00:03:35,570
interestingly enough if you go to a much

00:03:27,980 --> 00:03:37,280
older textbook oops oh okay sorry if you

00:03:35,570 --> 00:03:40,010
go too much all the textbook Newton's

00:03:37,280 --> 00:03:42,140
nuisance universal arithmetic you find

00:03:40,010 --> 00:03:44,299
this same problem in this textbook

00:03:42,140 --> 00:03:47,209
however in a much more practical form

00:03:44,299 --> 00:03:49,579
the form he has it is a stone falling

00:03:47,209 --> 00:03:52,190
down into well from the sound of the

00:03:49,579 --> 00:03:55,850
stone striking the bottom to determine

00:03:52,190 --> 00:03:57,709
the depths of the well that's actually

00:03:55,850 --> 00:04:01,400
how most physical and real science

00:03:57,709 --> 00:04:05,180
problems look like you have parameters

00:04:01,400 --> 00:04:07,609
in your model parameters you have that

00:04:05,180 --> 00:04:09,680
would be the depth of my well you have a

00:04:07,609 --> 00:04:12,470
mathematical model which is the falling

00:04:09,680 --> 00:04:14,600
body that has a certain laws Newton's

00:04:12,470 --> 00:04:16,549
laws and the sound that comes back which

00:04:14,600 --> 00:04:18,650
we assumed to be a constant velocity and

00:04:16,549 --> 00:04:20,000
then you have observable data use the

00:04:18,650 --> 00:04:22,820
other with your clock and you measure

00:04:20,000 --> 00:04:25,220
how much time it is the textbook problem

00:04:22,820 --> 00:04:26,690
says I know my world ups here's my

00:04:25,220 --> 00:04:28,100
formula plug it in

00:04:26,690 --> 00:04:30,460
and tell me how long the time tells

00:04:28,100 --> 00:04:33,530
that's what we call the forward waddle

00:04:30,460 --> 00:04:35,360
but the but the much more common case is

00:04:33,530 --> 00:04:37,430
that we want to do the exact opposite we

00:04:35,360 --> 00:04:40,340
have observable data we have a

00:04:37,430 --> 00:04:42,350
mathematical model still the same and we

00:04:40,340 --> 00:04:47,360
want to know what the well depth was so

00:04:42,350 --> 00:04:49,190
that is the inverse model so these

00:04:47,360 --> 00:04:51,710
inverse model problems are extremely

00:04:49,190 --> 00:04:55,100
common medical imaging you throw

00:04:51,710 --> 00:04:57,130
something any kind of race x-rays you or

00:04:55,100 --> 00:04:59,720
you throw something at your at your

00:04:57,130 --> 00:05:01,420
imaging object and you look what comes

00:04:59,720 --> 00:05:04,100
back and want to reconstruct the image

00:05:01,420 --> 00:05:08,090
seismology astronomy everybody uses a

00:05:04,100 --> 00:05:10,040
SONA exploration all the of the

00:05:08,090 --> 00:05:12,890
engineers who are looking for what's

00:05:10,040 --> 00:05:14,810
under the surface watershed modeling I

00:05:12,890 --> 00:05:16,340
know ecologists use it and economists

00:05:14,810 --> 00:05:18,140
use it and if you think about it even

00:05:16,340 --> 00:05:19,790
linear regression is pretty much the

00:05:18,140 --> 00:05:24,490
same problem you have a bunch of data

00:05:19,790 --> 00:05:28,730
and you want to fit a slope and an

00:05:24,490 --> 00:05:30,860
intercept of a linear model now i had my

00:05:28,730 --> 00:05:33,590
precise out of order let me go back to

00:05:30,860 --> 00:05:36,130
where i was here so just to go back to

00:05:33,590 --> 00:05:38,720
my well problem so my signal time down

00:05:36,130 --> 00:05:40,520
just to write it a lot and i explore

00:05:38,720 --> 00:05:42,680
everything of course in python python

00:05:40,520 --> 00:05:44,210
actually here is not this talk is not

00:05:42,680 --> 00:05:46,070
going to teach you how to use an

00:05:44,210 --> 00:05:48,350
advanced library this talk is just an

00:05:46,070 --> 00:05:50,780
exploration of a scientific topic which

00:05:48,350 --> 00:05:53,450
i often always just do in python so

00:05:50,780 --> 00:05:55,790
python comes in incidentally the full

00:05:53,450 --> 00:05:58,070
time plus sound full-time downs of the

00:05:55,790 --> 00:06:01,490
sound time up and the full time just to

00:05:58,070 --> 00:06:03,169
remind you is basically the square root

00:06:01,490 --> 00:06:05,630
of the depths divided by the

00:06:03,169 --> 00:06:09,830
acceleration of the gravity and then you

00:06:05,630 --> 00:06:12,290
can just make a plot and you will find

00:06:09,830 --> 00:06:15,020
that the signal rival time is in blue

00:06:12,290 --> 00:06:16,220
the fall time is a little bit less so

00:06:15,020 --> 00:06:20,210
for the depth of the well you get a

00:06:16,220 --> 00:06:23,030
curve like this so sorry about that my

00:06:20,210 --> 00:06:25,070
out of order thing here so now we need

00:06:23,030 --> 00:06:27,320
to put in place the basic vocabulary of

00:06:25,070 --> 00:06:29,000
inverse modeling and the basic

00:06:27,320 --> 00:06:30,740
vocabulary of the inverse modeling we've

00:06:29,000 --> 00:06:33,530
already talked about the model

00:06:30,740 --> 00:06:35,390
parameters they are typically M of them

00:06:33,530 --> 00:06:37,850
M dimensional there might be all sorts

00:06:35,390 --> 00:06:40,310
and my problem is just one the depth of

00:06:37,850 --> 00:06:41,960
the well I could say maybe I

00:06:40,310 --> 00:06:44,270
don't you not know the speed of sound

00:06:41,960 --> 00:06:46,280
either so I might find a way of also

00:06:44,270 --> 00:06:47,480
putting that into my model but he will

00:06:46,280 --> 00:06:50,150
check take it easy

00:06:47,480 --> 00:06:52,640
one we have a forward model which is a

00:06:50,150 --> 00:06:55,370
function of my model parameter that is

00:06:52,640 --> 00:06:57,380
basically the time is a function of the

00:06:55,370 --> 00:07:00,380
depth of my well and we have observable

00:06:57,380 --> 00:07:04,130
data and now we have n points of data in

00:07:00,380 --> 00:07:08,210
general and so if I've got a seismograph

00:07:04,130 --> 00:07:10,430
I might have here M different kinds of

00:07:08,210 --> 00:07:12,020
velocities different layers and the

00:07:10,430 --> 00:07:14,390
layer depth you may have a very large

00:07:12,020 --> 00:07:18,530
number of MS and I may have a very large

00:07:14,390 --> 00:07:21,080
number of observations and places where

00:07:18,530 --> 00:07:23,600
I observe it but even in my well example

00:07:21,080 --> 00:07:25,490
I'm not necessarily limited to one

00:07:23,600 --> 00:07:27,380
single observation I could take several

00:07:25,490 --> 00:07:30,230
stones right I could block in one stone

00:07:27,380 --> 00:07:31,790
measure second stone measure and I'm not

00:07:30,230 --> 00:07:35,480
going to get the exact same results

00:07:31,790 --> 00:07:37,100
because I've got errors so error terms

00:07:35,480 --> 00:07:39,110
are important so how do I get my error

00:07:37,100 --> 00:07:41,810
term I take my forward model and I

00:07:39,110 --> 00:07:44,000
subtract my observed data so the things

00:07:41,810 --> 00:07:45,500
that are bold-faced here are vectors and

00:07:44,000 --> 00:07:48,020
if you're not so familiar with them I

00:07:45,500 --> 00:07:49,940
really don't do anything advanced with

00:07:48,020 --> 00:07:52,880
them here luckily this is not a linear

00:07:49,940 --> 00:07:54,560
algebra course but I do put in my little

00:07:52,880 --> 00:07:59,330
transpose because it's supposed to be a

00:07:54,560 --> 00:08:01,970
column vector so the G here in many many

00:07:59,330 --> 00:08:04,010
cases we will try to linearize it and

00:08:01,970 --> 00:08:06,320
have G as a big matrix that takes my

00:08:04,010 --> 00:08:08,540
model parameters and transforms it over

00:08:06,320 --> 00:08:10,460
into my data parameters and the error

00:08:08,540 --> 00:08:13,280
term is kind of very important to look

00:08:10,460 --> 00:08:16,190
at closely that is sort of my forward

00:08:13,280 --> 00:08:17,570
model - my observed data and we have to

00:08:16,190 --> 00:08:19,610
think about that there can be different

00:08:17,570 --> 00:08:21,710
kinds of errors there can be errors just

00:08:19,610 --> 00:08:24,260
from statistical fluctuations of my

00:08:21,710 --> 00:08:27,140
observations or from the imprecision of

00:08:24,260 --> 00:08:29,690
my of my measuring instrument or my

00:08:27,140 --> 00:08:31,640
finger hitting the measuring instrument

00:08:29,690 --> 00:08:34,820
when I'm there with my stopwatch but

00:08:31,640 --> 00:08:36,890
there might also be model errors all the

00:08:34,820 --> 00:08:38,780
first word data errors but model errors

00:08:36,890 --> 00:08:40,970
come from the fact that maybe the model

00:08:38,780 --> 00:08:42,200
is not completely correct and the model

00:08:40,970 --> 00:08:44,630
is not completely correct in this case

00:08:42,200 --> 00:08:47,840
either because we neglected air

00:08:44,630 --> 00:08:51,350
resistance so here I am so I actually

00:08:47,840 --> 00:08:53,390
have a link on the front to some ipython

00:08:51,350 --> 00:08:54,170
notebooks which are not on good of where

00:08:53,390 --> 00:08:55,760
they should be

00:08:54,170 --> 00:08:57,920
because when I try to upload them a good

00:08:55,760 --> 00:08:59,450
a merge conflict and I thought I should

00:08:57,920 --> 00:09:00,980
not resolve a merge conflict when I'm

00:08:59,450 --> 00:09:03,079
nervous here because I'm going to talk

00:09:00,980 --> 00:09:05,329
so I'm sorry you will get them as soon

00:09:03,079 --> 00:09:07,339
as I calm down and resolve my stupid

00:09:05,329 --> 00:09:08,959
words conflict and then you can see how

00:09:07,339 --> 00:09:11,570
to do that with air resistance if you're

00:09:08,959 --> 00:09:13,730
interested not in this here you see for

00:09:11,570 --> 00:09:15,079
the same depths of a well it takes a

00:09:13,730 --> 00:09:17,630
little longer if I have air resistance

00:09:15,079 --> 00:09:19,220
in there and this curve just takes some

00:09:17,630 --> 00:09:21,050
reasonable assumptions that might work

00:09:19,220 --> 00:09:25,579
for a rock that I might hold in my hand

00:09:21,050 --> 00:09:27,410
okay this is modeling error so we have a

00:09:25,579 --> 00:09:29,750
new paradigm we would like to find the

00:09:27,410 --> 00:09:32,360
model parameters that minimize the error

00:09:29,750 --> 00:09:34,160
using statistics now I don't have to use

00:09:32,360 --> 00:09:36,410
statistics this is an easy thing I could

00:09:34,160 --> 00:09:38,360
use I could complete the square and

00:09:36,410 --> 00:09:41,420
actually solve this with pencil and

00:09:38,360 --> 00:09:42,829
paper I could do that with my that's

00:09:41,420 --> 00:09:44,630
actually right what you're supposed to

00:09:42,829 --> 00:09:46,699
do in Newton's earth and take textbook

00:09:44,630 --> 00:09:49,660
right is supposed to find the depth of

00:09:46,699 --> 00:09:52,220
the well but we can also just do it

00:09:49,660 --> 00:09:53,990
but statistics and I want to just walk

00:09:52,220 --> 00:09:56,510
you through it and we will have to jump

00:09:53,990 --> 00:09:58,100
over a few ravines in that because I'm

00:09:56,510 --> 00:09:59,839
going to have to jump over about half of

00:09:58,100 --> 00:10:01,820
semesters worth of an inverse modeling

00:09:59,839 --> 00:10:03,380
class if you find this interesting take

00:10:01,820 --> 00:10:06,470
one by all means it's really really

00:10:03,380 --> 00:10:07,640
interesting so you have to think about

00:10:06,470 --> 00:10:11,810
that you live in a multi-dimensional

00:10:07,640 --> 00:10:14,720
space we said we have M model dimensions

00:10:11,810 --> 00:10:17,089
and n data dimensions so we have M times

00:10:14,720 --> 00:10:19,370
n we have like a huge space it has all

00:10:17,089 --> 00:10:21,019
compatible combinations of data that you

00:10:19,370 --> 00:10:24,350
might have and models that you might

00:10:21,019 --> 00:10:26,870
have and then we can look at a

00:10:24,350 --> 00:10:30,470
conditional probability we can say what

00:10:26,870 --> 00:10:32,779
would be the probability to have false

00:10:30,470 --> 00:10:34,880
like you would have certain model

00:10:32,779 --> 00:10:36,380
parameters that these are the true model

00:10:34,880 --> 00:10:38,180
parameters the two depths of my well

00:10:36,380 --> 00:10:40,730
given the data that I've been measuring

00:10:38,180 --> 00:10:43,730
one data point or n data points whatever

00:10:40,730 --> 00:10:45,500
and based here around which is a really

00:10:43,730 --> 00:10:47,839
simple to prove theorem it's one of the

00:10:45,500 --> 00:10:49,940
simplest theorems ever so if don't get

00:10:47,839 --> 00:10:52,370
scared of Bayes theorem but you have

00:10:49,940 --> 00:10:54,740
seen it I'm sure is that you can get

00:10:52,370 --> 00:10:57,790
this by taking the conditional

00:10:54,740 --> 00:11:01,430
probability to take the likelihood that

00:10:57,790 --> 00:11:05,329
your model that you get these data if

00:11:01,430 --> 00:11:08,190
you have this model two times a prior

00:11:05,329 --> 00:11:11,100
basically which is the likelihood

00:11:08,190 --> 00:11:12,569
so the probability of the model and you

00:11:11,100 --> 00:11:15,259
divide by the probability of the data

00:11:12,569 --> 00:11:18,779
which was coming from the other side and

00:11:15,259 --> 00:11:21,300
what does this to help us so just look

00:11:18,779 --> 00:11:24,439
at the general shape of this thing we

00:11:21,300 --> 00:11:27,899
have a constant and this is going to be

00:11:24,439 --> 00:11:29,850
very useful times the likelihood times

00:11:27,899 --> 00:11:32,730
the prior and the prior in the Bayesian

00:11:29,850 --> 00:11:34,829
idea represents our knowledge of the

00:11:32,730 --> 00:11:37,860
system so I can make assumptions about

00:11:34,829 --> 00:11:40,920
the prior I can say okay

00:11:37,860 --> 00:11:41,660
I'm here my well oh I don't know how

00:11:40,920 --> 00:11:44,100
deep it is

00:11:41,660 --> 00:11:46,410
but I know it's where it looks like more

00:11:44,100 --> 00:11:48,420
than three meters and probably less than

00:11:46,410 --> 00:11:51,180
100 meters and in between I don't know

00:11:48,420 --> 00:11:53,040
so why don't I choose this much higher a

00:11:51,180 --> 00:11:55,529
uniform distribution between three

00:11:53,040 --> 00:11:59,579
meters and 100 meters and whenever I try

00:11:55,529 --> 00:12:02,699
to sample I just pick one of those but

00:11:59,579 --> 00:12:04,680
what do we do about our likelihood so

00:12:02,699 --> 00:12:09,480
the likelihood we have to go back to our

00:12:04,680 --> 00:12:12,360
error term here error term so clearly a

00:12:09,480 --> 00:12:16,139
model is more likely it fit approximate

00:12:12,360 --> 00:12:19,860
the data better so why don't we take the

00:12:16,139 --> 00:12:21,779
error and square it and that take that

00:12:19,860 --> 00:12:23,699
as a measure to as a measure for what we

00:12:21,779 --> 00:12:26,850
call the misfit how badly does it fit

00:12:23,699 --> 00:12:29,490
the badness of it it's a misfit now it's

00:12:26,850 --> 00:12:31,860
almost what we're doing what we're doing

00:12:29,490 --> 00:12:34,410
don't get scared here so this is our

00:12:31,860 --> 00:12:37,589
error here and this is the error again

00:12:34,410 --> 00:12:40,769
so we decide to these are two vectors so

00:12:37,589 --> 00:12:42,660
we need to do a vector you know a scalar

00:12:40,769 --> 00:12:44,310
product but we have a term in the middle

00:12:42,660 --> 00:12:46,980
and then term in the middle is a

00:12:44,310 --> 00:12:51,750
covariance so a covariance is basically

00:12:46,980 --> 00:12:53,819
a weight on how much it encodes what we

00:12:51,750 --> 00:12:55,470
already know about the uncertainties

00:12:53,819 --> 00:12:58,589
that we have for example in my well

00:12:55,470 --> 00:13:00,389
example if I throw 10 stones I can

00:12:58,589 --> 00:13:02,550
calculate the variance of the data that

00:13:00,389 --> 00:13:05,160
I get given that the well has he changed

00:13:02,550 --> 00:13:07,620
steps while I saw the scones I presume

00:13:05,160 --> 00:13:09,480
that the true answers just want right so

00:13:07,620 --> 00:13:11,279
I can take this variance and plug it

00:13:09,480 --> 00:13:14,189
into my covariance matrix just on the

00:13:11,279 --> 00:13:16,079
diagonal and that covariance matrix

00:13:14,189 --> 00:13:18,750
there represents the uncertainty that we

00:13:16,079 --> 00:13:20,519
have about the data and we can actually

00:13:18,750 --> 00:13:21,900
do the same about the uncertainty of the

00:13:20,519 --> 00:13:23,730
model and this

00:13:21,900 --> 00:13:25,440
just model error and being really

00:13:23,730 --> 00:13:26,880
hand-wavy about it because what we

00:13:25,440 --> 00:13:28,830
really would like to plug in there is

00:13:26,880 --> 00:13:31,590
the difference between the model we pick

00:13:28,830 --> 00:13:33,780
and the real model but we don't know

00:13:31,590 --> 00:13:36,150
that we Apollo so best we can do is our

00:13:33,780 --> 00:13:39,030
prior right which we update during the

00:13:36,150 --> 00:13:41,280
time okay so this is our misfit

00:13:39,030 --> 00:13:44,130
if this is big we make a lot of mistakes

00:13:41,280 --> 00:13:47,280
so if there's a small weird close so

00:13:44,130 --> 00:13:49,860
what kind of shape can we wear we have

00:13:47,280 --> 00:13:53,130
some statistical tools to encode this

00:13:49,860 --> 00:13:54,840
idea and I'm jumping over some theories

00:13:53,130 --> 00:13:57,540
that are beyond me and some theorems

00:13:54,840 --> 00:13:59,490
that you can easily follow through but

00:13:57,540 --> 00:14:03,320
we can just say we just modeled this as

00:13:59,490 --> 00:14:06,810
a Gaussian form that is like it is um

00:14:03,320 --> 00:14:08,610
basically square e to the minus square

00:14:06,810 --> 00:14:10,650
in the error and it's proportional to

00:14:08,610 --> 00:14:13,020
this now this is really not very much

00:14:10,650 --> 00:14:14,190
that we know about a function especially

00:14:13,020 --> 00:14:16,830
if this is supposed to be a probability

00:14:14,190 --> 00:14:20,610
function that we that we want to sample

00:14:16,830 --> 00:14:22,050
from meaning we want to pull out one set

00:14:20,610 --> 00:14:24,960
of possible models according to our

00:14:22,050 --> 00:14:27,630
prior calculate this and then say well

00:14:24,960 --> 00:14:30,840
explore our model space say how likely

00:14:27,630 --> 00:14:32,580
is does this is the solution and there

00:14:30,840 --> 00:14:37,500
is our big tool that now we come to our

00:14:32,580 --> 00:14:40,410
random walks so we can we only need the

00:14:37,500 --> 00:14:44,510
ability to evaluate this function here

00:14:40,410 --> 00:14:47,760
this likelihood function if we want to

00:14:44,510 --> 00:14:49,380
if we want to sample the space because

00:14:47,760 --> 00:14:53,820
we have this very powerful tool and that

00:14:49,380 --> 00:14:55,290
is this Monte Carlo well Markov chain

00:14:53,820 --> 00:14:58,290
Monte Carlo method and I am talking

00:14:55,290 --> 00:15:00,120
about the metropolis algorithm so what

00:14:58,290 --> 00:15:02,520
is this thing we can walk through the

00:15:00,120 --> 00:15:04,410
model space and use this algorithm to

00:15:02,520 --> 00:15:07,640
sample from this complicated unknown

00:15:04,410 --> 00:15:09,930
probability distribution function and

00:15:07,640 --> 00:15:13,200
how do we do this we generate a sample

00:15:09,930 --> 00:15:14,880
of model parameters by taking one step

00:15:13,200 --> 00:15:16,830
in the model space we start somewhere

00:15:14,880 --> 00:15:19,650
wherever we sample from our priors which

00:15:16,830 --> 00:15:23,090
we calculate our misfit we take one step

00:15:19,650 --> 00:15:26,610
and then we calculate the likelihood of

00:15:23,090 --> 00:15:30,120
the new over the likelihood of the old

00:15:26,610 --> 00:15:32,700
and you can see this is a ratio we can

00:15:30,120 --> 00:15:34,530
forget about all factors all constants

00:15:32,700 --> 00:15:35,630
that are in front of this thing so we

00:15:34,530 --> 00:15:38,720
can just go ahead

00:15:35,630 --> 00:15:39,950
calculate this ratio don't have to worry

00:15:38,720 --> 00:15:42,620
about anything other than our

00:15:39,950 --> 00:15:44,870
exponential to the minus our error and

00:15:42,620 --> 00:15:46,430
if it is the ratio is larger than one we

00:15:44,870 --> 00:15:48,740
accept the sample and if it's less than

00:15:46,430 --> 00:15:50,750
one so if the new likelihood is less

00:15:48,740 --> 00:15:52,880
than the old then we still accept it

00:15:50,750 --> 00:15:55,130
with a probability that is equal to this

00:15:52,880 --> 00:15:57,830
ratio that is the famous metropolis

00:15:55,130 --> 00:16:01,460
algorithm that was that I've implemented

00:15:57,830 --> 00:16:04,610
here so here's the here's the loop we

00:16:01,460 --> 00:16:08,530
want to have n samples and we say okay

00:16:04,610 --> 00:16:12,340
if this year is larger than a random

00:16:08,530 --> 00:16:16,040
uniform random value then we keep it

00:16:12,340 --> 00:16:18,800
it's very simple and I have to say so

00:16:16,040 --> 00:16:20,570
right we the brain thing about this the

00:16:18,800 --> 00:16:24,020
main theorem that they proved is that if

00:16:20,570 --> 00:16:25,730
we do this then our random walk the

00:16:24,020 --> 00:16:27,740
samples we pull out in our animal will

00:16:25,730 --> 00:16:30,830
reproduce the function that we need to

00:16:27,740 --> 00:16:33,110
reproduce and that is this that is the

00:16:30,830 --> 00:16:35,510
real special thing about it and given

00:16:33,110 --> 00:16:37,940
how easy it is to implement now if you

00:16:35,510 --> 00:16:40,190
take one of the many good Markov chain

00:16:37,940 --> 00:16:42,650
Monte Carlo libraries you get this for

00:16:40,190 --> 00:16:46,550
free but it's not very hard to actually

00:16:42,650 --> 00:16:49,550
work your way through it yourself so if

00:16:46,550 --> 00:16:52,520
you do this I take a step here uniformly

00:16:49,550 --> 00:16:55,820
just randomly with for whatever a heap

00:16:52,520 --> 00:16:57,470
my distribution function was is a normal

00:16:55,820 --> 00:16:59,930
distribution that I'm using here as an

00:16:57,470 --> 00:17:03,920
example that is centered around one and

00:16:59,930 --> 00:17:06,199
has a standard deviation of 0.5 so if I

00:17:03,920 --> 00:17:07,760
am able to sample from it which I can

00:17:06,199 --> 00:17:09,530
reply something I would not need the

00:17:07,760 --> 00:17:10,939
metropolis algorithm but we are thinking

00:17:09,530 --> 00:17:13,280
that we have functions that we can

00:17:10,939 --> 00:17:15,110
example from other which can we can only

00:17:13,280 --> 00:17:17,089
evaluate or sometimes we can only

00:17:15,110 --> 00:17:20,540
evaluate something that is proportional

00:17:17,089 --> 00:17:23,030
to it so if I do this with my metropolis

00:17:20,540 --> 00:17:26,089
function 500 times starting somewhere I

00:17:23,030 --> 00:17:28,130
get a mean of 1 point 1 and a standard

00:17:26,089 --> 00:17:29,570
deviation of 1 point 5 1 which is very

00:17:28,130 --> 00:17:31,400
close to which what I'm looking for

00:17:29,570 --> 00:17:35,390
without ever really sampling from that

00:17:31,400 --> 00:17:38,420
only evaluating this function so here's

00:17:35,390 --> 00:17:40,370
an example here's my random walk this is

00:17:38,420 --> 00:17:42,350
actually 1,000 steps up up up up and

00:17:40,370 --> 00:17:44,090
here's the histogram that I get from

00:17:42,350 --> 00:17:47,060
exactly this this is exactly what I had

00:17:44,090 --> 00:17:49,010
before so quick historical sidetrack

00:17:47,060 --> 00:17:51,770
it's called metropolis algorithm

00:17:49,010 --> 00:17:54,860
the authors of this table from 1953 are

00:17:51,770 --> 00:17:57,260
as you can maybe see in a sabbatical

00:17:54,860 --> 00:18:00,740
order metropolis Arianna Rosen Bruce

00:17:57,260 --> 00:18:02,300
Marshall rosenbloom Augusta Taylor and

00:18:00,740 --> 00:18:02,960
Edward Teller I was thinking who are

00:18:02,300 --> 00:18:05,780
these people

00:18:02,960 --> 00:18:07,460
Arianna Rosen booth whatever so it turns

00:18:05,780 --> 00:18:09,740
out this is actually a whole story to

00:18:07,460 --> 00:18:12,140
this algorithm that came out of Los

00:18:09,740 --> 00:18:15,320
Alamos it was and so ever teller was the

00:18:12,140 --> 00:18:18,260
boss of Marshall Rosenberg at the time

00:18:15,320 --> 00:18:19,910
and he says that they worked on it

00:18:18,260 --> 00:18:22,490
together but actually there is a

00:18:19,910 --> 00:18:25,250
wonderful transcript of oral history of

00:18:22,490 --> 00:18:28,730
Marshall Rosenberg who talks about how

00:18:25,250 --> 00:18:30,800
his wife Arianna at the time was one of

00:18:28,730 --> 00:18:32,240
the computing women and basically he and

00:18:30,800 --> 00:18:34,400
his wife implemented it and their other

00:18:32,240 --> 00:18:36,710
papers have just two authors him and his

00:18:34,400 --> 00:18:38,000
wife he doing the theoretical work and

00:18:36,710 --> 00:18:40,640
she doing the computing work and

00:18:38,000 --> 00:18:43,430
apparently mr. metropolis was the boss

00:18:40,640 --> 00:18:46,310
of the computing laboratory and he was

00:18:43,430 --> 00:18:49,310
just put on the paper and advert Ella's

00:18:46,310 --> 00:18:52,010
wife was also a colleague of Arianna

00:18:49,310 --> 00:18:53,720
Rosen Bruce and she apparently kind of

00:18:52,010 --> 00:18:55,460
wanted to go back into that but didn't

00:18:53,720 --> 00:18:58,720
actually do anything so it should be the

00:18:55,460 --> 00:19:01,160
Rosen blues algorithm my favorite and it

00:18:58,720 --> 00:19:02,780
it is actually go back go here and

00:19:01,160 --> 00:19:05,210
that's a really really fascinating

00:19:02,780 --> 00:19:07,790
interview okay kayvyun pitfalls we still

00:19:05,210 --> 00:19:10,940
have a really high dimensional space we

00:19:07,790 --> 00:19:12,380
need to occasionally take care if we

00:19:10,940 --> 00:19:14,570
start our algorithm or render mode

00:19:12,380 --> 00:19:17,300
really far away from where we are this

00:19:14,570 --> 00:19:19,760
happens here I started at 10 and I knew

00:19:17,300 --> 00:19:21,530
that I would be varying around 1 so

00:19:19,760 --> 00:19:23,810
puh-puh-puh buh-buh-buh it will have to

00:19:21,530 --> 00:19:25,970
get there so sometimes you have to look

00:19:23,810 --> 00:19:27,740
at your path and track and cut it off

00:19:25,970 --> 00:19:29,750
and take off the first so in so many

00:19:27,740 --> 00:19:31,910
percent can do it automatically

00:19:29,750 --> 00:19:33,950
automatically anything that's at the

00:19:31,910 --> 00:19:36,410
beginning and that's really far outside

00:19:33,950 --> 00:19:40,280
outside of the histogram that you will

00:19:36,410 --> 00:19:41,900
ultimately get throw it away okay so

00:19:40,280 --> 00:19:44,660
here's our general inverse modeling

00:19:41,900 --> 00:19:47,360
workflow you take your problem you write

00:19:44,660 --> 00:19:49,340
down a forward model that tells you your

00:19:47,360 --> 00:19:51,500
data as a function of the parameters

00:19:49,340 --> 00:19:53,630
that you do not know that's just

00:19:51,500 --> 00:19:56,240
mathematics then you write down your

00:19:53,630 --> 00:19:58,970
misfit function which is the thing that

00:19:56,240 --> 00:20:00,800
is quadratic in the errors and that has

00:19:58,970 --> 00:20:02,450
these covariances and you have to know

00:20:00,800 --> 00:20:02,780
your system at that point I have to put

00:20:02,450 --> 00:20:04,820
in

00:20:02,780 --> 00:20:07,760
thunking about how to quantify your

00:20:04,820 --> 00:20:09,980
variances and uncertainties and then you

00:20:07,760 --> 00:20:14,090
write down the Bayesian posterior this

00:20:09,980 --> 00:20:16,190
is e to the minus misfit function and

00:20:14,090 --> 00:20:17,780
then you find suitable priors for all

00:20:16,190 --> 00:20:19,460
your model parameters so that you can

00:20:17,780 --> 00:20:23,150
pull from them while you do your random

00:20:19,460 --> 00:20:25,370
walking and quantify all the modeling

00:20:23,150 --> 00:20:27,470
errors actually you do this at the time

00:20:25,370 --> 00:20:28,880
where you put the visit function

00:20:27,470 --> 00:20:30,800
together the function you have to plug

00:20:28,880 --> 00:20:32,900
it into the misfit function and then you

00:20:30,800 --> 00:20:34,760
can just start some very reasonable and

00:20:32,900 --> 00:20:37,490
start walking through your model space

00:20:34,760 --> 00:20:39,680
and trust the fact that there will be

00:20:37,490 --> 00:20:41,510
always a chance if you hang around in

00:20:39,680 --> 00:20:45,200
the local minimum that it will get out

00:20:41,510 --> 00:20:48,080
of it and that the NT of the random walk

00:20:45,200 --> 00:20:49,970
will manage to get rid of these problems

00:20:48,080 --> 00:20:52,790
it's it's in many ways a lot more

00:20:49,970 --> 00:20:55,100
lightweight than many of the extremely

00:20:52,790 --> 00:20:58,310
advanced and complicated methods that

00:20:55,100 --> 00:21:00,440
you have to deal with if you if you

00:20:58,310 --> 00:21:02,720
solve these problems with linear algebra

00:21:00,440 --> 00:21:04,850
where you have functions that get

00:21:02,720 --> 00:21:06,680
unstable you can actually walk around

00:21:04,850 --> 00:21:08,810
and stabilities now I'm extremely

00:21:06,680 --> 00:21:11,420
simplifying if you look at papers about

00:21:08,810 --> 00:21:13,370
this there too you run into pitfalls and

00:21:11,420 --> 00:21:16,610
numerical stability but it is such a

00:21:13,370 --> 00:21:18,320
nice method that is so widely applicable

00:21:16,610 --> 00:21:20,120
that I really if you have a problem like

00:21:18,320 --> 00:21:22,700
that I would invite you to look at it so

00:21:20,120 --> 00:21:25,070
to finish up what about our toy problems

00:21:22,700 --> 00:21:28,220
I just kind of plugged in a few names

00:21:25,070 --> 00:21:31,400
here with my well so I just thought okay

00:21:28,220 --> 00:21:33,800
let me just put sample some like if I

00:21:31,400 --> 00:21:36,560
saw several stones and let's pretend my

00:21:33,800 --> 00:21:38,330
mean that I get is 3.2 seconds and I

00:21:36,560 --> 00:21:40,580
thought that I could probably measure

00:21:38,330 --> 00:21:42,260
times with 0.2 seconds precision with a

00:21:40,580 --> 00:21:45,290
stopwatch something like that so I just

00:21:42,260 --> 00:21:47,240
generated some fake data and I know that

00:21:45,290 --> 00:21:49,550
the fake data corresponds to a true

00:21:47,240 --> 00:21:51,380
depth with with drag of 84 point at

00:21:49,550 --> 00:21:53,720
forty eight point nine meters in my

00:21:51,380 --> 00:21:56,090
model and if I just run the smooth

00:21:53,720 --> 00:21:59,030
through my metropolis algorithm I come

00:21:56,090 --> 00:22:01,820
down quite close a little deeper because

00:21:59,030 --> 00:22:03,890
I neglected my model error which is my

00:22:01,820 --> 00:22:05,300
air drag thank you very much and I hope

00:22:03,890 --> 00:22:06,640
to have shown you something that is

00:22:05,300 --> 00:22:16,009
useful

00:22:06,640 --> 00:22:16,009
[Applause]

00:22:22,070 --> 00:22:26,140
they all went into the previous one they

00:22:24,390 --> 00:22:30,570
already know what to say 9 you

00:22:26,140 --> 00:22:30,570
[Laughter]

00:22:38,150 --> 00:22:43,849

YouTube URL: https://www.youtube.com/watch?v=sHS2-av7AgQ


