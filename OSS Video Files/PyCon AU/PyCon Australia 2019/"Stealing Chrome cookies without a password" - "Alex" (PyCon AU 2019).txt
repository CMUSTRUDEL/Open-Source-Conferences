Title: "Stealing Chrome cookies without a password" - "Alex" (PyCon AU 2019)
Publication date: 2019-08-02
Playlist: PyCon Australia 2019
Description: 
	"Alex"

A new technique to steal someone's Chrome cookies once you've compromised their machine. Cooler because it doesn't need root ðŸ˜Ž. This talk is about how the technique was found, how it works, and what you can do with it.

https://2019.pycon-au.org/talks/stealing-chrome-cookies-without-a-password

PyCon AU, the national Python Language conference, is on again this August in Sydney, at the International Convention Centre, Sydney, August 2 - 6 2019.

Video licence: CC BY-NC-SA 4.0 - https://creativecommons.org/licenses/by-nc-sa/4.0/

Python, PyCon, PyConAU

Fri Aug  2 13:30:00 2019 at C3.6
Captions: 
	00:00:01,970 --> 00:00:06,660
hey YouTube and welcome back to my

00:00:03,899 --> 00:00:08,010
channel my name is Alex and you notice

00:00:06,660 --> 00:00:09,360
it's not just Alex it's Alex with the

00:00:08,010 --> 00:00:12,090
quotes you might be wondering what's

00:00:09,360 --> 00:00:13,530
what's with the quotes well a couple of

00:00:12,090 --> 00:00:16,020
years ago I wrote these blog posts and

00:00:13,530 --> 00:00:17,340
these blog posts got written about by

00:00:16,020 --> 00:00:19,500
Vice magazine which is like a news

00:00:17,340 --> 00:00:21,240
website and they they talked about it by

00:00:19,500 --> 00:00:23,490
saying ah according to a blog post by a

00:00:21,240 --> 00:00:25,650
hacker who goes by the name Alex the via

00:00:23,490 --> 00:00:28,380
quits and that's that's my real name

00:00:25,650 --> 00:00:30,240
and so I don't know when someone tells

00:00:28,380 --> 00:00:31,380
you you hacking in is your name in

00:00:30,240 --> 00:00:35,430
quotes then I guess it's you hack a name

00:00:31,380 --> 00:00:37,320
now so please you know welcome along to

00:00:35,430 --> 00:00:39,120
this I guess this is my life now I also

00:00:37,320 --> 00:00:40,559
help out with this other security

00:00:39,120 --> 00:00:41,850
conference called purple con which is a

00:00:40,559 --> 00:00:45,149
security conference that instead of

00:00:41,850 --> 00:00:48,570
looking like this looks like this and so

00:00:45,149 --> 00:00:50,309
the reason we yeah and so the reason we

00:00:48,570 --> 00:00:51,660
did that was because we were like well I

00:00:50,309 --> 00:00:52,920
thought that like hacker culture is all

00:00:51,660 --> 00:00:54,600
about like rebelling and doing your own

00:00:52,920 --> 00:00:56,730
thing and so it seems kind of weird if

00:00:54,600 --> 00:00:58,770
everyone's do the billing in the same

00:00:56,730 --> 00:01:01,620
very specific way which is like this

00:00:58,770 --> 00:01:03,960
which is it's like so now there's two

00:01:01,620 --> 00:01:05,070
ways now this way and this way and I'm

00:01:03,960 --> 00:01:06,210
not saying there's just two ways of

00:01:05,070 --> 00:01:07,590
course you can do if you like but we

00:01:06,210 --> 00:01:09,540
thought it would be fun to like make

00:01:07,590 --> 00:01:11,340
this other thing and I don't know I

00:01:09,540 --> 00:01:12,630
realize that you can just do this you

00:01:11,340 --> 00:01:13,920
can just make a conference and just do

00:01:12,630 --> 00:01:17,070
dumb stuff like that and all most of you

00:01:13,920 --> 00:01:18,930
so amazing professionally professionally

00:01:17,070 --> 00:01:20,850
for what I work at Alessi and have for a

00:01:18,930 --> 00:01:22,439
couple of years now I used to do like

00:01:20,850 --> 00:01:23,700
Incident Response and stuff so like

00:01:22,439 --> 00:01:25,770
detecting hackers and like catching

00:01:23,700 --> 00:01:29,100
hackers and making it harder to hack

00:01:25,770 --> 00:01:30,720
stuff and then I changed to change to

00:01:29,100 --> 00:01:32,880
the red team which is a new which is

00:01:30,720 --> 00:01:35,189
like a boot with the new team and so now

00:01:32,880 --> 00:01:36,270
basically my job is to do crimes and

00:01:35,189 --> 00:01:38,659
then right it's very very detailed

00:01:36,270 --> 00:01:40,860
confession letters about exactly how

00:01:38,659 --> 00:01:43,229
exactly how it happened and it's really

00:01:40,860 --> 00:01:45,149
fun and the reason I'm telling you this

00:01:43,229 --> 00:01:46,110
is because I did my first red team up

00:01:45,149 --> 00:01:47,909
like that you break them up into

00:01:46,110 --> 00:01:50,189
operations and I did my first operation

00:01:47,909 --> 00:01:51,720
about a year ago now and it was during

00:01:50,189 --> 00:01:53,460
that operation that I found the

00:01:51,720 --> 00:01:54,570
techniques of this talk is about and so

00:01:53,460 --> 00:01:56,340
what actually is that technique what

00:01:54,570 --> 00:01:59,070
actually we're talking about today

00:01:56,340 --> 00:02:00,540
it's a new way in the as in I don't

00:01:59,070 --> 00:02:04,079
think you could do this before by baÃ±os

00:02:00,540 --> 00:02:05,790
that's nice and it's a new way to if you

00:02:04,079 --> 00:02:07,200
have a shell so show me is like if you

00:02:05,790 --> 00:02:08,520
have remote code execution on someone's

00:02:07,200 --> 00:02:10,920
computer so if you haven't heard of that

00:02:08,520 --> 00:02:12,480
like imagine like you know SSH you can

00:02:10,920 --> 00:02:13,530
SSH into your computer what did you get

00:02:12,480 --> 00:02:15,569
SSH into someone else

00:02:13,530 --> 00:02:17,730
Peter Wow that'd be great and so if you

00:02:15,569 --> 00:02:19,530
already have one of those then unless

00:02:17,730 --> 00:02:21,959
you get the creme cookies of whoever's

00:02:19,530 --> 00:02:23,040
computer you're in and it looks you do

00:02:21,959 --> 00:02:24,060
this without having root access or

00:02:23,040 --> 00:02:26,010
without knowing their password or

00:02:24,060 --> 00:02:27,480
whatever and the reason this is no rule

00:02:26,010 --> 00:02:29,250
is because as far as I know this is the

00:02:27,480 --> 00:02:30,270
first and only way to do it without the

00:02:29,250 --> 00:02:31,860
password without the root access

00:02:30,270 --> 00:02:33,930
you could always do it with the password

00:02:31,860 --> 00:02:35,760
but this way it's easier to do and so

00:02:33,930 --> 00:02:37,080
why do I care about that why do I care

00:02:35,760 --> 00:02:38,640
about chrome cookies what I cookies and

00:02:37,080 --> 00:02:41,700
so on well let's say that you're a

00:02:38,640 --> 00:02:43,950
sneaky criminal like me and your goal is

00:02:41,700 --> 00:02:45,959
to basically look at the forbidden data

00:02:43,950 --> 00:02:46,950
like I don't know what exactly your goal

00:02:45,959 --> 00:02:48,780
is because everyone's a different kind

00:02:46,950 --> 00:02:50,880
of criminal but it probably is something

00:02:48,780 --> 00:02:51,810
like oh the person I'm trying to hack or

00:02:50,880 --> 00:02:53,160
the company I'm trying to hack they have

00:02:51,810 --> 00:02:54,780
some very secretive a forbidden dad I

00:02:53,160 --> 00:02:55,920
like emails or something and if I look

00:02:54,780 --> 00:02:57,330
at it then I've hacked them so that's

00:02:55,920 --> 00:02:59,610
probably assuming you go with something

00:02:57,330 --> 00:03:00,870
like that and so how do you steal this

00:02:59,610 --> 00:03:03,480
forbidden data how do you find out how

00:03:00,870 --> 00:03:05,880
do you look at it well usually I ask

00:03:03,480 --> 00:03:07,110
myself how does the legit personal ad

00:03:05,880 --> 00:03:11,400
the legit company look at that in

00:03:07,110 --> 00:03:12,630
forbidden data and well the way like one

00:03:11,400 --> 00:03:13,980
way to think about that is well what's

00:03:12,630 --> 00:03:15,030
the most commonly used software what's

00:03:13,980 --> 00:03:17,340
the most frequent way that they do

00:03:15,030 --> 00:03:18,840
things and well most employees probably

00:03:17,340 --> 00:03:20,400
make their web browser as they most

00:03:18,840 --> 00:03:22,410
frequent software because that's how

00:03:20,400 --> 00:03:23,910
everything lives in websites it's like

00:03:22,410 --> 00:03:25,230
oh look there it is hey hey hey Google

00:03:23,910 --> 00:03:27,900
crime hey what's going on you'll bring

00:03:25,230 --> 00:03:28,890
nice and updated today and so if you

00:03:27,900 --> 00:03:30,239
don't know Google Chrome by the way I

00:03:28,890 --> 00:03:31,410
should mention it's that thing that you

00:03:30,239 --> 00:03:33,120
Installer seems to get on your computer

00:03:31,410 --> 00:03:35,489
that takes like 15 gigabytes of RAM to

00:03:33,120 --> 00:03:39,060
run because you have so many tabs and

00:03:35,489 --> 00:03:40,470
all your tabs like it takes up so many

00:03:39,060 --> 00:03:41,910
tabs because I'm in desperate need of

00:03:40,470 --> 00:03:43,170
professional services to manage my

00:03:41,910 --> 00:03:44,670
crippling tab addiction so I can stop

00:03:43,170 --> 00:03:46,320
buying really expensive game of RAM to

00:03:44,670 --> 00:03:48,780
store all of my tabs that I had to not

00:03:46,320 --> 00:03:51,900
have so many tabs that's the one if you

00:03:48,780 --> 00:03:53,220
don't know it now you do welcome and so

00:03:51,900 --> 00:03:54,150
how's the chrome apps gonna help us so

00:03:53,220 --> 00:03:55,920
here's this company that we're trying to

00:03:54,150 --> 00:03:58,500
hack or this person or whatever in my

00:03:55,920 --> 00:04:00,480
case was a company and they have the

00:03:58,500 --> 00:04:02,549
forbidden data somewhere then they have

00:04:00,480 --> 00:04:03,510
all this stuff for getting this

00:04:02,549 --> 00:04:05,220
forbidden data the you know they have

00:04:03,510 --> 00:04:07,650
like database passwords and firewalls

00:04:05,220 --> 00:04:08,880
and SSH keys and AWS saw however they

00:04:07,650 --> 00:04:11,340
store this is this very complicated way

00:04:08,880 --> 00:04:12,540
of getting to this data then there's the

00:04:11,340 --> 00:04:14,100
person who wants to get their own data

00:04:12,540 --> 00:04:15,720
so like maybe it's alien emails or

00:04:14,100 --> 00:04:17,209
something and when they want to get this

00:04:15,720 --> 00:04:20,310
Whedon data they don't do this

00:04:17,209 --> 00:04:21,930
complicated very like they don't go to

00:04:20,310 --> 00:04:23,610
the they don't go through the SSH

00:04:21,930 --> 00:04:25,349
database firewall something something

00:04:23,610 --> 00:04:26,380
something they just talk to a Google

00:04:25,349 --> 00:04:28,090
Chrome

00:04:26,380 --> 00:04:30,640
they say hey Google frame can I have my

00:04:28,090 --> 00:04:32,200
data in Google frame is like hey and

00:04:30,640 --> 00:04:35,080
asks the website to just give them the

00:04:32,200 --> 00:04:36,700
data and I even which way like which

00:04:35,080 --> 00:04:37,780
violence doing this I would do it the

00:04:36,700 --> 00:04:39,880
top way around the bottom way that seems

00:04:37,780 --> 00:04:41,500
a lot easier so how do you actually do

00:04:39,880 --> 00:04:43,000
that because imagine if you logged into

00:04:41,500 --> 00:04:44,740
somebody else's Google Chrome imagine if

00:04:43,000 --> 00:04:46,390
you had this screen like you can log

00:04:44,740 --> 00:04:48,430
into someone else's browser you could

00:04:46,390 --> 00:04:50,830
just click things and you'd be already

00:04:48,430 --> 00:04:51,760
logged in as them and be able to see all

00:04:50,830 --> 00:04:53,140
that stuff you could do a lot of crimes

00:04:51,760 --> 00:04:54,970
with that isn't this a very enticing

00:04:53,140 --> 00:04:56,560
screenshot doesn't this really I come

00:04:54,970 --> 00:04:58,810
down sent me a picture of it still like

00:04:56,560 --> 00:05:00,130
obviously we want to go we want to log

00:04:58,810 --> 00:05:01,540
into someone else's browser and then go

00:05:00,130 --> 00:05:03,880
absolutely wild with whatever we find in

00:05:01,540 --> 00:05:05,260
there and maybe you're thinking but I

00:05:03,880 --> 00:05:07,210
already have a shell on the computer I

00:05:05,260 --> 00:05:08,500
can already execute code on the computer

00:05:07,210 --> 00:05:10,600
I can already do anything they can do

00:05:08,500 --> 00:05:11,860
why do I need to do this why during to

00:05:10,600 --> 00:05:13,540
log into my browser why don't you log

00:05:11,860 --> 00:05:15,190
into Chrome I can and then I can like

00:05:13,540 --> 00:05:16,210
move their mouse and click on things so

00:05:15,190 --> 00:05:19,450
surely you win if you already have a

00:05:16,210 --> 00:05:21,340
show yes except for these bad boys

00:05:19,450 --> 00:05:23,170
you're out to ruin your life as

00:05:21,340 --> 00:05:24,400
established criminal these are various

00:05:23,170 --> 00:05:25,810
ways of doing two-factor authentication

00:05:24,400 --> 00:05:28,030
and even if you have control of

00:05:25,810 --> 00:05:29,560
someone's computer when they have when

00:05:28,030 --> 00:05:30,940
someone text to your code or they have a

00:05:29,560 --> 00:05:32,830
ubq and have all those apps on their

00:05:30,940 --> 00:05:34,180
phone you don't have access to that so

00:05:32,830 --> 00:05:36,310
you end up in a sad situation like this

00:05:34,180 --> 00:05:37,780
where you have a shell you have no

00:05:36,310 --> 00:05:38,560
two-factor hooks so maybe you can I

00:05:37,780 --> 00:05:40,450
don't know maybe you can tell the

00:05:38,560 --> 00:05:42,220
computer to just talk out loud please

00:05:40,450 --> 00:05:44,560
give the codes I don't know maybe a

00:05:42,220 --> 00:05:46,000
desperate and so this is this is the

00:05:44,560 --> 00:05:48,100
situation in which this is useful well

00:05:46,000 --> 00:05:49,660
one of the situations in the you have a

00:05:48,100 --> 00:05:51,220
shell on someone's laptop or whatever

00:05:49,660 --> 00:05:54,520
the computer and you want to log into

00:05:51,220 --> 00:05:56,590
all their stuff and maybe but of course

00:05:54,520 --> 00:05:58,200
that show won't give you 35 doors codes

00:05:56,590 --> 00:06:00,400
and so you can't or a vlog into things

00:05:58,200 --> 00:06:01,480
but you know once you've once you've

00:06:00,400 --> 00:06:03,250
logged into a website once you've done

00:06:01,480 --> 00:06:04,750
you like SMS code to your phone or is he

00:06:03,250 --> 00:06:06,250
done your security key thing once to

00:06:04,750 --> 00:06:07,870
Daniel security key well then you don't

00:06:06,250 --> 00:06:09,970
have to do another two vector or Cody

00:06:07,870 --> 00:06:11,200
you're all a login so what if you could

00:06:09,970 --> 00:06:13,210
just already be logged in as them and

00:06:11,200 --> 00:06:14,470
skip the two-factor code thing so let me

00:06:13,210 --> 00:06:16,570
show you I cookies work this is how I

00:06:14,470 --> 00:06:18,160
think about anyway so when you want to

00:06:16,570 --> 00:06:20,290
log into a website you be like hey can I

00:06:18,160 --> 00:06:21,760
see my email and the websites like no

00:06:20,290 --> 00:06:23,830
and you're like okay fine fair enough

00:06:21,760 --> 00:06:24,880
special login he go here's my stuff

00:06:23,830 --> 00:06:26,290
here's my email address here's my

00:06:24,880 --> 00:06:27,580
password here's my to vector code and

00:06:26,290 --> 00:06:28,690
these things are all like there's a

00:06:27,580 --> 00:06:30,700
little difficult information to get

00:06:28,690 --> 00:06:31,960
there's a guitar generator my password

00:06:30,700 --> 00:06:33,670
is did you factor code changes every

00:06:31,960 --> 00:06:35,229
minute or whatever this is like hide

00:06:33,670 --> 00:06:37,000
information to get and then the website

00:06:35,229 --> 00:06:38,440
says cool you logged in but also next

00:06:37,000 --> 00:06:40,120
time you wanna log in don't worry about

00:06:38,440 --> 00:06:41,530
all that stuff that you just said

00:06:40,120 --> 00:06:43,210
knowing a password don't worry about

00:06:41,530 --> 00:06:44,860
doing UT factor login to I met any of

00:06:43,210 --> 00:06:46,180
that here's this cookie gives us like

00:06:44,860 --> 00:06:48,130
this is what a cookie is by the way a

00:06:46,180 --> 00:06:49,240
session cookie is like basically another

00:06:48,130 --> 00:06:51,010
kind of password that lives on your

00:06:49,240 --> 00:06:52,240
computer so next time you log in don't

00:06:51,010 --> 00:06:54,010
worry about that just use this thing and

00:06:52,240 --> 00:06:55,660
I'm suddenly very interested in this

00:06:54,010 --> 00:06:57,520
thing so here's how it works when you're

00:06:55,660 --> 00:06:58,600
logging into real when you one lucky the

00:06:57,520 --> 00:07:00,639
next time you say hey I want to log in

00:06:58,600 --> 00:07:02,169
here's this magic code thing it says oh

00:07:00,639 --> 00:07:03,729
yeah I remember you no worries here's a

00:07:02,169 --> 00:07:09,639
stuff time about logging in and you just

00:07:03,729 --> 00:07:10,900
get it for free and so okay so now that

00:07:09,639 --> 00:07:12,490
we're thinking like hackers obviously

00:07:10,900 --> 00:07:14,020
this is the good stuff and want to be

00:07:12,490 --> 00:07:15,850
all about this like visitor thing you

00:07:14,020 --> 00:07:16,690
wanna find passwords email addresses do

00:07:15,850 --> 00:07:18,580
you factor codes that sounds very

00:07:16,690 --> 00:07:19,810
difficult this looks very easy boy would

00:07:18,580 --> 00:07:22,539
I like to have this but for every single

00:07:19,810 --> 00:07:23,979
website so now we decided that we care

00:07:22,539 --> 00:07:26,650
about this thing how do you actually get

00:07:23,979 --> 00:07:28,539
this thing well if you're on somebody's

00:07:26,650 --> 00:07:29,919
computer already here it is if on OS X

00:07:28,539 --> 00:07:31,720
for example it lives in this file right

00:07:29,919 --> 00:07:32,770
here and so you could just since cute

00:07:31,720 --> 00:07:34,090
since we have code execution on my

00:07:32,770 --> 00:07:36,940
computer we can just read this file and

00:07:34,090 --> 00:07:38,380
the cookies are there but this this file

00:07:36,940 --> 00:07:40,210
in this file the cookies are encrypted

00:07:38,380 --> 00:07:41,500
so you can't just read them because

00:07:40,210 --> 00:07:42,850
they're cryptid and you would have to

00:07:41,500 --> 00:07:44,349
decrypt them somehow if you don't want

00:07:42,850 --> 00:07:47,560
to actually use them so it's not that

00:07:44,349 --> 00:07:49,060
easy and here is the old way of stealing

00:07:47,560 --> 00:07:51,910
cookies without if you explain easily

00:07:49,060 --> 00:07:53,860
access but here's what you do they used

00:07:51,910 --> 00:07:55,360
to be you get this magical file and then

00:07:53,860 --> 00:07:56,919
the decryption key to this file is

00:07:55,360 --> 00:07:58,630
stored in the users login keychain so

00:07:56,919 --> 00:08:00,340
you need to get their root password to

00:07:58,630 --> 00:08:01,389
log into the log in keychain and then

00:08:00,340 --> 00:08:02,500
get the decryption key out of there

00:08:01,389 --> 00:08:04,539
which is called the crime safe storage

00:08:02,500 --> 00:08:06,039
key then you use that key to decrypt the

00:08:04,539 --> 00:08:07,570
cookies and now you have the cookies and

00:08:06,039 --> 00:08:09,370
so this works and you can do it and

00:08:07,570 --> 00:08:10,510
everything but you need to access and

00:08:09,370 --> 00:08:11,979
also it's kind of complicated

00:08:10,510 --> 00:08:13,210
where as I'm saying you can just

00:08:11,979 --> 00:08:14,320
magically run this command that I made

00:08:13,210 --> 00:08:16,210
and it will just do it for you Wow

00:08:14,320 --> 00:08:17,410
doesn't that same communion let me

00:08:16,210 --> 00:08:19,660
explain how that works

00:08:17,410 --> 00:08:21,580
oh and also if you're wondering why the

00:08:19,660 --> 00:08:23,229
Google Chrome specifically like why are

00:08:21,580 --> 00:08:24,849
we talking about Google Chrome well the

00:08:23,229 --> 00:08:26,199
answer was because I Google Chrome was

00:08:24,849 --> 00:08:27,789
in the browser that I had to attack when

00:08:26,199 --> 00:08:29,139
I found this thing during a red team up

00:08:27,789 --> 00:08:30,639
and I want to show you the name of the

00:08:29,139 --> 00:08:31,539
codename was that red team well because

00:08:30,639 --> 00:08:33,039
we have to give them all code names

00:08:31,539 --> 00:08:34,209
because I thought it was good

00:08:33,039 --> 00:08:38,320
and so yeah I found there's an operation

00:08:34,209 --> 00:08:40,570
actual crimes I think this is very good

00:08:38,320 --> 00:08:43,839
because it's very funny to hear very

00:08:40,570 --> 00:08:45,190
important high-level CEOs say well as of

00:08:43,839 --> 00:08:46,420
operation actual crimes we have to

00:08:45,190 --> 00:08:47,470
change it like they have they're like

00:08:46,420 --> 00:08:49,980
they're not laughing at all but I think

00:08:47,470 --> 00:08:49,980
it's very funny

00:08:50,050 --> 00:08:54,139
so in this operation

00:08:52,639 --> 00:08:55,399
the fine was something like this we have

00:08:54,139 --> 00:08:56,959
step one is get a shell on someone's

00:08:55,399 --> 00:08:58,820
computer and then get real access to the

00:08:56,959 --> 00:09:00,649
computer and then use these two things

00:08:58,820 --> 00:09:02,300
to get a rather cookies and then login

00:09:00,649 --> 00:09:04,220
to all the stuff up what's trending

00:09:02,300 --> 00:09:06,410
graph business deals forbidden data and

00:09:04,220 --> 00:09:08,089
so on but you know things don't always

00:09:06,410 --> 00:09:10,430
work out and it's my first time doing

00:09:08,089 --> 00:09:11,360
this say for whatever reason we didn't

00:09:10,430 --> 00:09:13,040
have good access in this presence

00:09:11,360 --> 00:09:14,540
computer we didn't have the password but

00:09:13,040 --> 00:09:16,130
we still really wanted to log into this

00:09:14,540 --> 00:09:18,529
stuff I still really wanted to log into

00:09:16,130 --> 00:09:20,449
them it's everything and so what my

00:09:18,529 --> 00:09:22,339
teammates said well it must be possible

00:09:20,449 --> 00:09:24,110
to get someone's cookies without having

00:09:22,339 --> 00:09:25,339
grid access since the user can get there

00:09:24,110 --> 00:09:27,019
and cookies like if you're in your own

00:09:25,339 --> 00:09:28,699
computer you can click around and Google

00:09:27,019 --> 00:09:29,750
Chrome to the screen and it will show

00:09:28,699 --> 00:09:30,740
you all your cookies and you didn't have

00:09:29,750 --> 00:09:32,990
to type in your password to get that

00:09:30,740 --> 00:09:34,880
it's just there so there must be some

00:09:32,990 --> 00:09:36,199
way to do it and I was like hmm that's a

00:09:34,880 --> 00:09:37,670
really good point maybe there is some

00:09:36,199 --> 00:09:37,880
way to do it I hadn't really thought of

00:09:37,670 --> 00:09:39,949
that

00:09:37,880 --> 00:09:42,500
and so this prompted a lot of thinking

00:09:39,949 --> 00:09:44,930
and maybe wondering well does chrome

00:09:42,500 --> 00:09:46,639
have like an API or some way for me to

00:09:44,930 --> 00:09:48,440
just pass print give me the cookies

00:09:46,639 --> 00:09:49,970
so like surely it's not Daisy does

00:09:48,440 --> 00:09:51,170
chrome have some way to just for me to

00:09:49,970 --> 00:09:52,370
just be like hey can you give me the

00:09:51,170 --> 00:09:53,980
cookies please and we'll pray I'm just

00:09:52,370 --> 00:09:55,730
give them to me if that is that possible

00:09:53,980 --> 00:09:58,279
that's that was the first thing I

00:09:55,730 --> 00:09:59,540
thought of and this prompted a lot of

00:09:58,279 --> 00:10:01,370
furious googling as I tried to

00:09:59,540 --> 00:10:02,839
understand how google chrome works how

00:10:01,370 --> 00:10:04,010
it stores cookies what are cookies where

00:10:02,839 --> 00:10:07,010
to come and find them but I don't know

00:10:04,010 --> 00:10:08,600
anything about this because you know

00:10:07,010 --> 00:10:11,199
this is my first time doing this and I

00:10:08,600 --> 00:10:13,760
had a lot of questions what's safe

00:10:11,199 --> 00:10:15,910
anyway so after doing all that googling

00:10:13,760 --> 00:10:18,380
and other ones that went on the screen I

00:10:15,910 --> 00:10:20,600
this send some guidance a friend led me

00:10:18,380 --> 00:10:23,149
to see this nodejs library on github

00:10:20,600 --> 00:10:25,250
called puppeteer now why I won't just

00:10:23,149 --> 00:10:26,779
I'm trying to like hack Google Chrome

00:10:25,250 --> 00:10:28,430
trying to steal someone's cookies why am

00:10:26,779 --> 00:10:30,889
i reading about this in OJ's library

00:10:28,430 --> 00:10:32,839
well very critically this library

00:10:30,889 --> 00:10:34,760
mentions two things it mentions the dev

00:10:32,839 --> 00:10:36,380
tools protocol and it mentions headless

00:10:34,760 --> 00:10:37,910
and these few things are going to be our

00:10:36,380 --> 00:10:39,649
friends and allies in this adventure I

00:10:37,910 --> 00:10:41,810
didn't know that at the time so let's

00:10:39,649 --> 00:10:43,339
add to learn how google chrome that

00:10:41,810 --> 00:10:43,699
deals with cookies and so here's how it

00:10:43,339 --> 00:10:44,569
works

00:10:43,699 --> 00:10:46,790
let's first we're gonna talk about

00:10:44,569 --> 00:10:48,290
headless what does that mean there's

00:10:46,790 --> 00:10:50,329
this new this is murdered in chrome

00:10:48,290 --> 00:10:51,860
called headless chrome and so that means

00:10:50,329 --> 00:10:53,120
it's the same google chrome that you'll

00:10:51,860 --> 00:10:53,389
note that doesn't show anything on the

00:10:53,120 --> 00:10:55,430
screen

00:10:53,389 --> 00:10:57,319
it's all happening in the terminal it's

00:10:55,430 --> 00:10:59,000
all happening like in text form there's

00:10:57,319 --> 00:11:00,380
no windows pop up there's no drawing of

00:10:59,000 --> 00:11:02,630
anything you can just run chrome

00:11:00,380 --> 00:11:04,339
entirely in the terminal this is deeply

00:11:02,630 --> 00:11:06,410
I'm probably gonna go wrong someday but

00:11:04,339 --> 00:11:07,639
until now it's very useful for like if

00:11:06,410 --> 00:11:09,319
you're doing like automation and stuff

00:11:07,639 --> 00:11:12,620
this is like a really useful thing but

00:11:09,319 --> 00:11:13,850
like for me I want to be criminal if I

00:11:12,620 --> 00:11:15,050
can run Google Chrome on someone else's

00:11:13,850 --> 00:11:16,880
computer without it like pumping up a

00:11:15,050 --> 00:11:18,709
window that's very good yes please I'd

00:11:16,880 --> 00:11:20,420
like to do that however it's not that

00:11:18,709 --> 00:11:21,649
easy because when youth headless crew if

00:11:20,420 --> 00:11:23,449
you run headless crime in your computer

00:11:21,649 --> 00:11:25,130
it's not you it's not logged in as you

00:11:23,449 --> 00:11:26,540
so if you went to Gmail it wouldn't give

00:11:25,130 --> 00:11:27,949
you your email it would just give you

00:11:26,540 --> 00:11:29,329
like the gym a login screen because it

00:11:27,949 --> 00:11:31,699
doesn't know who you are for some reason

00:11:29,329 --> 00:11:35,120
and so fair enough but I wanted to know

00:11:31,699 --> 00:11:36,889
can you make headless chrome be you can

00:11:35,120 --> 00:11:38,690
you make it login have the real you if

00:11:36,889 --> 00:11:40,850
there's some way to make it become the

00:11:38,690 --> 00:11:43,459
normal user rather than this special not

00:11:40,850 --> 00:11:44,870
logged in headless chrome user and well

00:11:43,459 --> 00:11:46,430
dancer that question had to be like well

00:11:44,870 --> 00:11:48,500
how does chrome know who you logged in

00:11:46,430 --> 00:11:49,730
as like how does it decide who is using

00:11:48,500 --> 00:11:52,339
it or who is the youth of it owns this

00:11:49,730 --> 00:11:53,540
and have to learn from somewhere and I

00:11:52,339 --> 00:11:54,860
know who chrome has some way of know

00:11:53,540 --> 00:11:56,360
he's logged in because of chrome

00:11:54,860 --> 00:11:58,699
profiles I've ever used chrome profiles

00:11:56,360 --> 00:12:00,380
it's like it's like having multiple

00:11:58,699 --> 00:12:01,639
accounts on one Google Chrome so you can

00:12:00,380 --> 00:12:02,990
like switch between them so like your

00:12:01,639 --> 00:12:04,490
personal wine and your work wine or

00:12:02,990 --> 00:12:06,199
you'll want the crimes are your one

00:12:04,490 --> 00:12:07,579
felix ID for dirt or whatever so let's

00:12:06,199 --> 00:12:09,019
see change where you're logged into a by

00:12:07,579 --> 00:12:10,759
having like multiple windows and so i

00:12:09,019 --> 00:12:12,079
know chrome has this idea of like Who am

00:12:10,759 --> 00:12:13,639
I and I know it can change between them

00:12:12,079 --> 00:12:15,560
so maybe I could make headless crime do

00:12:13,639 --> 00:12:16,970
this I don't know and so I did a lot of

00:12:15,560 --> 00:12:18,589
did a lot more furious googling and

00:12:16,970 --> 00:12:20,720
reading reading the documentation about

00:12:18,589 --> 00:12:22,339
chrome and I found this user data

00:12:20,720 --> 00:12:23,480
directory thing and that looks very

00:12:22,339 --> 00:12:25,100
interesting to me because it stores

00:12:23,480 --> 00:12:26,360
history bookmarks and cookies and I'm

00:12:25,100 --> 00:12:28,699
suddenly very interested in these things

00:12:26,360 --> 00:12:30,079
and so then I found this github issue

00:12:28,699 --> 00:12:31,490
and puppeteer where some poor person is

00:12:30,079 --> 00:12:33,050
having trouble with this user data

00:12:31,490 --> 00:12:33,649
directory and headless Chrome and

00:12:33,050 --> 00:12:35,810
something's going wrong with

00:12:33,649 --> 00:12:37,040
authorization and I'm suddenly extremely

00:12:35,810 --> 00:12:38,839
interested in these things and so I

00:12:37,040 --> 00:12:40,399
really want to help this person with a

00:12:38,839 --> 00:12:40,970
problem or at least find out what that

00:12:40,399 --> 00:12:43,819
problem is

00:12:40,970 --> 00:12:45,380
I suddenly care about this is what so it

00:12:43,819 --> 00:12:47,269
led me to ask the question what if I a

00:12:45,380 --> 00:12:48,620
legitimate web developer want to run

00:12:47,269 --> 00:12:51,620
headless crime but I want to run it as

00:12:48,620 --> 00:12:53,720
me notice nobody and so this website

00:12:51,620 --> 00:12:55,459
very helpfully tells me oh sure no

00:12:53,720 --> 00:12:56,810
problem you can change which you that

00:12:55,459 --> 00:12:58,130
are you are by using this command lines

00:12:56,810 --> 00:13:01,399
like the chrome you can just choose any

00:12:58,130 --> 00:13:03,319
directory and it doesn't say that you

00:13:01,399 --> 00:13:04,459
can use it to log in as the real person

00:13:03,319 --> 00:13:05,959
doesn't say you can use it to log in as

00:13:04,459 --> 00:13:07,519
an existing user though but it does say

00:13:05,959 --> 00:13:09,050
you can change the directory and so I

00:13:07,519 --> 00:13:10,760
was like okay and I picked the other

00:13:09,050 --> 00:13:12,319
data directory to be the normal default

00:13:10,760 --> 00:13:13,000
place where crime will normally store

00:13:12,319 --> 00:13:15,160
your information

00:13:13,000 --> 00:13:17,200
it's this one idea and so this is like

00:13:15,160 --> 00:13:18,340
you know I think the reason existence of

00:13:17,200 --> 00:13:20,830
this the point of this user data

00:13:18,340 --> 00:13:21,970
directory flag is to like make a stand

00:13:20,830 --> 00:13:24,490
new user data directory because you want

00:13:21,970 --> 00:13:26,140
to make new users but I just told crime

00:13:24,490 --> 00:13:27,760
to read the existing user data directory

00:13:26,140 --> 00:13:29,590
to see if it what like I didn't know II

00:13:27,760 --> 00:13:30,790
feel like I don't know I don't know any

00:13:29,590 --> 00:13:33,010
more than this webpage telling me

00:13:30,790 --> 00:13:34,330
advanced I tried this and it works if

00:13:33,010 --> 00:13:35,770
you do this then it shows you your email

00:13:34,330 --> 00:13:38,350
inbox cuz it's locked interview so this

00:13:35,770 --> 00:13:40,090
is now like you can now use your own

00:13:38,350 --> 00:13:41,410
browsers login as you but from the

00:13:40,090 --> 00:13:42,850
command line and I was like hey this is

00:13:41,410 --> 00:13:44,800
pretty good and I can now like bradlee

00:13:42,850 --> 00:13:46,270
intent at this person kind of good but

00:13:44,800 --> 00:13:47,920
doesn't show you your cookies this dish

00:13:46,270 --> 00:13:49,720
with you just showed you the HTML of the

00:13:47,920 --> 00:13:51,520
page and I tried like going to the

00:13:49,720 --> 00:13:53,350
chrome cookies settings page with HTML

00:13:51,520 --> 00:13:55,120
or I tried like Chinese JavaScript to

00:13:53,350 --> 00:13:56,680
get cookies but noddle cookies invisible

00:13:55,120 --> 00:13:58,810
to JavaScript and other things worked so

00:13:56,680 --> 00:14:00,490
I was like ok I'm always there but I got

00:13:58,810 --> 00:14:02,530
it maybe maybe it's still possible if I

00:14:00,490 --> 00:14:03,730
find some other way if that brings us to

00:14:02,530 --> 00:14:04,420
this other thing that I found mention

00:14:03,730 --> 00:14:06,460
having puppeteer

00:14:04,420 --> 00:14:08,950
which is the chrome dev tools protocol

00:14:06,460 --> 00:14:10,930
Oh has anyone heard of this it's pretty

00:14:08,950 --> 00:14:12,670
nice so yeah that's okay some people

00:14:10,930 --> 00:14:15,610
okay for those of you that haven't get

00:14:12,670 --> 00:14:17,440
ready so you know this guy you know this

00:14:15,610 --> 00:14:20,100
good button the right click inspect

00:14:17,440 --> 00:14:22,720
element how you do hacking mode this is

00:14:20,100 --> 00:14:24,700
it or not this is what the chrome dev

00:14:22,720 --> 00:14:25,780
tools protocols about so this thing when

00:14:24,700 --> 00:14:27,040
you right click inspect element the

00:14:25,780 --> 00:14:28,210
little window that pops up that's called

00:14:27,040 --> 00:14:30,460
the chrome dev tools that's the official

00:14:28,210 --> 00:14:32,050
name for it and the dev tools protocol

00:14:30,460 --> 00:14:34,150
is how the chrome dev tools talks to the

00:14:32,050 --> 00:14:35,830
actual google chrome thing and so I

00:14:34,150 --> 00:14:38,950
found this page which is exactly the

00:14:35,830 --> 00:14:40,900
documentation for chrome dev tools for

00:14:38,950 --> 00:14:42,250
the dev tools protocol itself and I was

00:14:40,900 --> 00:14:44,050
like reading this and I'm like okay how

00:14:42,250 --> 00:14:45,339
is this how is this how chrome does how

00:14:44,050 --> 00:14:47,140
google chrome works like at what's

00:14:45,339 --> 00:14:48,130
what's the deal here and I was kind of

00:14:47,140 --> 00:14:49,360
describing I'm reading everything I

00:14:48,130 --> 00:14:51,100
could find and then eventually it says

00:14:49,360 --> 00:14:52,990
hey if you'd like to enable remote

00:14:51,100 --> 00:14:54,550
debugging you can run chrome with this

00:14:52,990 --> 00:14:56,470
remote debugging flag and this is my

00:14:54,550 --> 00:14:57,820
first time doing like Red Team

00:14:56,470 --> 00:14:59,230
operations I don't know a lot about

00:14:57,820 --> 00:15:00,940
hacking but I do you know the words

00:14:59,230 --> 00:15:03,010
remote and debugging are the good words

00:15:00,940 --> 00:15:05,560
they wanna find you wanna be hacking

00:15:03,010 --> 00:15:07,030
like if you like these if you find these

00:15:05,560 --> 00:15:09,640
good words and it leaves to hacking I do

00:15:07,030 --> 00:15:11,260
you know that much and so if you do this

00:15:09,640 --> 00:15:13,000
then you find out that Google Chrome if

00:15:11,260 --> 00:15:15,089
you run this magical command it says

00:15:13,000 --> 00:15:16,630
okay cool dev tools listening on

00:15:15,089 --> 00:15:19,240
WebSockets something something something

00:15:16,630 --> 00:15:20,680
so I've learned that like Google Chrome

00:15:19,240 --> 00:15:22,240
is now listening on some kind of

00:15:20,680 --> 00:15:24,190
debugging language but I don't know what

00:15:22,240 --> 00:15:24,860
is listening on this port a 92 to thing

00:15:24,190 --> 00:15:26,630
I don't know what

00:15:24,860 --> 00:15:28,580
do now I got to know what information to

00:15:26,630 --> 00:15:29,750
send to it so maybe I can just read the

00:15:28,580 --> 00:15:31,730
Ducks as I went back to this Google

00:15:29,750 --> 00:15:33,380
Chrome documentation page which is some

00:15:31,730 --> 00:15:34,850
page written by the people at Google he

00:15:33,380 --> 00:15:36,590
made chrome and so I was like well

00:15:34,850 --> 00:15:37,790
presumably on this page to the nice

00:15:36,590 --> 00:15:39,890
people at Google I'm gonna graciously

00:15:37,790 --> 00:15:41,210
graciously explained to me and outside

00:15:39,890 --> 00:15:42,740
it doesn't work at Google how to use

00:15:41,210 --> 00:15:45,620
their ancient powerful chrome dev tools

00:15:42,740 --> 00:15:48,530
protocol magic thing and they've updated

00:15:45,620 --> 00:15:50,240
it since I did this no I'm not saying

00:15:48,530 --> 00:15:52,340
because I did this about that it since I

00:15:50,240 --> 00:15:53,840
noticed this and they say hey if you

00:15:52,340 --> 00:15:55,280
want to remotely debug chrome you need

00:15:53,840 --> 00:15:56,330
to speak to chrome remote debugging

00:15:55,280 --> 00:15:58,070
protocol which is like this whole

00:15:56,330 --> 00:15:59,120
special thing and I'm ready to teach and

00:15:58,070 --> 00:16:01,190
ready for this page to teach me about

00:15:59,120 --> 00:16:02,870
how the protocol works and how I do it

00:16:01,190 --> 00:16:04,160
that it basically says we didn't release

00:16:02,870 --> 00:16:05,390
that kind of information to Punk's like

00:16:04,160 --> 00:16:07,850
you like we're not just gonna tell you

00:16:05,390 --> 00:16:09,260
how it works and so they say if you do

00:16:07,850 --> 00:16:11,090
want to learn how it works they casually

00:16:09,260 --> 00:16:14,330
tell you to sniff and reverse-engineer

00:16:11,090 --> 00:16:15,560
the WebSocket protocol sorry I like if

00:16:14,330 --> 00:16:17,090
you'd like to know how it works here are

00:16:15,560 --> 00:16:20,990
instructions for reverse engineering

00:16:17,090 --> 00:16:22,790
what it is enjoy good luck because the

00:16:20,990 --> 00:16:24,080
only thing in the world that speaks like

00:16:22,790 --> 00:16:25,490
the only client that speaks the chrome

00:16:24,080 --> 00:16:28,910
dev tools protocol is google chrome

00:16:25,490 --> 00:16:31,040
itself and the way that they tell you to

00:16:28,910 --> 00:16:32,720
do this is they say now the dev tools is

00:16:31,040 --> 00:16:34,280
up in full screen open dev tools to

00:16:32,720 --> 00:16:35,330
inspect it this might seem kind of weird

00:16:34,280 --> 00:16:37,490
and that's because they want you to do

00:16:35,330 --> 00:16:38,750
this they want you to have one set of

00:16:37,490 --> 00:16:40,250
chrome dev tools and then open another

00:16:38,750 --> 00:16:42,560
set of chrome dev tools to inspect that

00:16:40,250 --> 00:16:44,000
first set of dev tools and then look at

00:16:42,560 --> 00:16:45,230
the WebSocket traffic somehow and it has

00:16:44,000 --> 00:16:46,820
instructions to follow and I didn't work

00:16:45,230 --> 00:16:50,540
up there the interaction - they did work

00:16:46,820 --> 00:16:51,980
and like the the they told you to use

00:16:50,540 --> 00:16:54,530
the chrome dev tools to debug the chrome

00:16:51,980 --> 00:16:56,180
dev tools themselves and the ease with

00:16:54,530 --> 00:16:58,490
which they suggest this it's very

00:16:56,180 --> 00:16:59,990
stressful for me because I say very

00:16:58,490 --> 00:17:01,970
casually I feel like this is not casual

00:16:59,990 --> 00:17:03,200
so like to be clear I want to know how

00:17:01,970 --> 00:17:04,490
chrome dev tools work and I can you go

00:17:03,200 --> 00:17:07,050
to use chrome dev tools and I can know

00:17:04,490 --> 00:17:09,420
please don't do this and I like do it

00:17:07,050 --> 00:17:10,770
and so I really don't like this page

00:17:09,420 --> 00:17:12,600
really wants me to go into the chrome

00:17:10,770 --> 00:17:15,270
dev tools nightmare inception realm but

00:17:12,600 --> 00:17:17,370
I will don't do that I don't use that

00:17:15,270 --> 00:17:18,870
you know how to use curl that's a great

00:17:17,370 --> 00:17:20,550
program I like that one a lot

00:17:18,870 --> 00:17:22,470
so this crane thing sounds way too

00:17:20,550 --> 00:17:24,360
complicated so I'm just going to try and

00:17:22,470 --> 00:17:26,880
remotely debug Chrome with coal because

00:17:24,360 --> 00:17:28,410
I also saw this on the page which says

00:17:26,880 --> 00:17:29,730
little one things on this page but one

00:17:28,410 --> 00:17:31,590
very convenient thing that a casually

00:17:29,730 --> 00:17:33,330
mentions is hey you can go to that same

00:17:31,590 --> 00:17:35,400
WebSocket thing forward slash JSON and

00:17:33,330 --> 00:17:36,809
it doesn't say what's there what wasn't

00:17:35,400 --> 00:17:39,330
said some sort of JSON object something

00:17:36,809 --> 00:17:41,040
something okay can do that and so if you

00:17:39,330 --> 00:17:42,179
do that you get a bunch of stuff a bunch

00:17:41,040 --> 00:17:43,650
of JSON that I don't understand to this

00:17:42,179 --> 00:17:45,690
day but then at the bottom it says

00:17:43,650 --> 00:17:46,559
WebSocket debugger URL and remember I'm

00:17:45,690 --> 00:17:48,120
learning about hacking and I've learned

00:17:46,559 --> 00:17:49,140
that debugger is the good word that you

00:17:48,120 --> 00:17:50,940
want to follow because that's how you do

00:17:49,140 --> 00:17:52,620
hacking and so I'm like cool here's if

00:17:50,940 --> 00:17:54,570
debugger URL what is actually there and

00:17:52,620 --> 00:17:56,760
so it's WebSockets though which is this

00:17:54,570 --> 00:17:58,080
different protocol entirely so I've got

00:17:56,760 --> 00:18:00,090
that curl doesn't speak web suckers it's

00:17:58,080 --> 00:18:01,230
like HTTP I need to I don't know how to

00:18:00,090 --> 00:18:02,820
speak WebSockets I don't how to do that

00:18:01,230 --> 00:18:05,460
so I downloaded some random WebSocket

00:18:02,820 --> 00:18:07,530
client thing and went to this URL and

00:18:05,460 --> 00:18:09,059
when you go there WSC that's the

00:18:07,530 --> 00:18:10,440
WebSocket client and I went to that euro

00:18:09,059 --> 00:18:12,390
and it says cool connected and they give

00:18:10,440 --> 00:18:13,410
you a greater than sign and I

00:18:12,390 --> 00:18:15,000
don't know about you but that looks like

00:18:13,410 --> 00:18:16,620
a show that was like I can typed stuff

00:18:15,000 --> 00:18:19,200
in there and commands will be executed

00:18:16,620 --> 00:18:20,850
but it's not like a best show where you

00:18:19,200 --> 00:18:22,260
can't type like Ellis into it that's not

00:18:20,850 --> 00:18:24,179
that kind of thing of it's not it's not

00:18:22,260 --> 00:18:25,770
connected to bash it's connected to the

00:18:24,179 --> 00:18:26,940
remote debugging protocol which I still

00:18:25,770 --> 00:18:28,590
don't know how it works because I didn't

00:18:26,940 --> 00:18:30,540
use two layers of chrome dev tools to

00:18:28,590 --> 00:18:32,250
reverse engineer after protocol so I

00:18:30,540 --> 00:18:33,179
don't know like I think I can control

00:18:32,250 --> 00:18:35,340
crying with this thing but I don't know

00:18:33,179 --> 00:18:36,660
what language to speak to it I don't

00:18:35,340 --> 00:18:38,460
know what to say I'm like illiterate in

00:18:36,660 --> 00:18:38,970
this language so needed to learn how

00:18:38,460 --> 00:18:41,790
that works

00:18:38,970 --> 00:18:43,470
and listen I'm just gonna skip I'm just

00:18:41,790 --> 00:18:45,360
gonna save you the furious googling and

00:18:43,470 --> 00:18:47,309
reading extremely cursed Ruby from 2012

00:18:45,360 --> 00:18:48,960
thought let me find this command but I

00:18:47,309 --> 00:18:51,929
did find it I found the original Google

00:18:48,960 --> 00:18:53,340
Chrome like bug fixed ticket thing where

00:18:51,929 --> 00:18:55,110
they discuss whether to add this command

00:18:53,340 --> 00:18:57,560
and they decided to do it which is great

00:18:55,110 --> 00:19:00,650
and so if you

00:18:57,560 --> 00:19:02,780
and so if you send this command it gives

00:19:00,650 --> 00:19:04,970
you all the cookies I think one list and

00:19:02,780 --> 00:19:06,650
very quickly they're not encrypted so

00:19:04,970 --> 00:19:07,790
like we really did just ask Google

00:19:06,650 --> 00:19:09,280
Chrome hey can you please give me all

00:19:07,790 --> 00:19:11,480
the cookies and it was like yeah okay

00:19:09,280 --> 00:19:12,590
and so here they are and this is just

00:19:11,480 --> 00:19:14,120
one but it's a big long list of all the

00:19:12,590 --> 00:19:15,680
cookies in the whole browser and then

00:19:14,120 --> 00:19:17,810
encrypted it's just all there and I was

00:19:15,680 --> 00:19:23,570
like were really cuz this is like this

00:19:17,810 --> 00:19:24,860
is this is wow it's okay looks really

00:19:23,570 --> 00:19:27,050
useful and I tried it out and I said to

00:19:24,860 --> 00:19:28,430
my teammate and she was like really show

00:19:27,050 --> 00:19:29,600
me and I could screen shed and show you

00:19:28,430 --> 00:19:30,770
her and she was like oh you did do a

00:19:29,600 --> 00:19:32,270
conference talk about this this was like

00:19:30,770 --> 00:19:36,680
a big deal when I was like oh okay and

00:19:32,270 --> 00:19:37,940
so here I am and so that was a kind of

00:19:36,680 --> 00:19:38,930
that was a sort of a walk through of all

00:19:37,940 --> 00:19:40,130
the stuff I did it my whole thought

00:19:38,930 --> 00:19:42,950
process there and that was kind of a lot

00:19:40,130 --> 00:19:43,970
to absorb so here it is all at once so

00:19:42,950 --> 00:19:45,650
we can like so you can see the whole

00:19:43,970 --> 00:19:47,720
thing from start to finish on one screen

00:19:45,650 --> 00:19:48,950
so you got a run Google Chrome you got a

00:19:47,720 --> 00:19:50,780
run in headless mode you're going to

00:19:48,950 --> 00:19:52,130
tell to log in as the existing use of it

00:19:50,780 --> 00:19:53,780
by telling it the user data directory is

00:19:52,130 --> 00:19:55,160
the default one and you were to make it

00:19:53,780 --> 00:19:56,720
open some page I just need some a blank

00:19:55,160 --> 00:19:57,560
and then you got enable remote debugging

00:19:56,720 --> 00:19:59,210
which are the good ones

00:19:57,560 --> 00:20:01,880
then once the mote debug is happening

00:19:59,210 --> 00:20:03,200
you got to use we gonna speak WebSockets

00:20:01,880 --> 00:20:04,700
and you gonna send that very convenient

00:20:03,200 --> 00:20:06,740
get our cookies thing to the website at

00:20:04,700 --> 00:20:09,320
your own that you found by you think oh

00:20:06,740 --> 00:20:11,030
and then it just gives you the good

00:20:09,320 --> 00:20:14,570
content it just gives you the stuff it's

00:20:11,030 --> 00:20:16,310
just all there so that's very good for

00:20:14,570 --> 00:20:17,960
you I want to be hacker for me it want

00:20:16,310 --> 00:20:19,490
to be echo and then once you have these

00:20:17,960 --> 00:20:20,930
cookies the whole point of game is

00:20:19,490 --> 00:20:22,520
cookies is you then put them in your own

00:20:20,930 --> 00:20:23,600
more you can use anything but for

00:20:22,520 --> 00:20:24,980
example you put them in your own browser

00:20:23,600 --> 00:20:26,420
you could like copy paste these into

00:20:24,980 --> 00:20:28,190
your own google chrome and then when you

00:20:26,420 --> 00:20:29,840
open account stuff google.com in your

00:20:28,190 --> 00:20:31,400
google chrome you login into someone

00:20:29,840 --> 00:20:33,470
else's Google Account this is the good

00:20:31,400 --> 00:20:35,240
status is hacking I think this is what I

00:20:33,470 --> 00:20:37,910
thought I thought I was like hey nice

00:20:35,240 --> 00:20:38,990
that's very good so and also a different

00:20:37,910 --> 00:20:40,430
version you can use if you don't want to

00:20:38,990 --> 00:20:42,080
if you don't wanna speak the WebSocket

00:20:40,430 --> 00:20:43,700
protocol I keep it in my downward that

00:20:42,080 --> 00:20:45,020
thing someone else on github made like a

00:20:43,700 --> 00:20:46,490
JavaScript version of this because

00:20:45,020 --> 00:20:48,050
Google Chrome itself can take WebSockets

00:20:46,490 --> 00:20:49,790
cuz it's a browser there someone made a

00:20:48,050 --> 00:20:51,200
version where you put an HTML file on

00:20:49,790 --> 00:20:52,370
their computer instead you open that

00:20:51,200 --> 00:20:53,900
file and the JavaScript does all the

00:20:52,370 --> 00:20:56,240
cookie reading and then sends cookies to

00:20:53,900 --> 00:20:57,500
you over the into it this way is also

00:20:56,240 --> 00:20:58,940
good is a trade off you have to write a

00:20:57,500 --> 00:21:00,110
disk but you don't have a WebSocket

00:20:58,940 --> 00:21:02,540
binary it's your choice

00:21:00,110 --> 00:21:04,070
and so I like using this I think it's

00:21:02,540 --> 00:21:05,690
good because you have to read access

00:21:04,070 --> 00:21:07,640
you'd have to do any fiddly configuring

00:21:05,690 --> 00:21:09,800
like it's the same thing every time it

00:21:07,640 --> 00:21:10,179
was an old three operating systems and

00:21:09,800 --> 00:21:11,710
you

00:21:10,179 --> 00:21:13,389
right to the disk or doing that work

00:21:11,710 --> 00:21:14,200
communication which is like it's good is

00:21:13,389 --> 00:21:15,999
what I'm saying

00:21:14,200 --> 00:21:19,119
like I like it was like nice I go back

00:21:15,999 --> 00:21:20,529
and use this as I also made a Metasploit

00:21:19,119 --> 00:21:22,090
module for this if you don't know

00:21:20,529 --> 00:21:23,919
Metasploit it's like there's like

00:21:22,090 --> 00:21:25,899
open-source hacking software that has

00:21:23,919 --> 00:21:28,360
all that has a bunch of exploits backing

00:21:25,899 --> 00:21:29,830
things and I wanted to make this widely

00:21:28,360 --> 00:21:30,909
available so anyone could use it and so

00:21:29,830 --> 00:21:32,139
I don't know I just put it in Metasploit

00:21:30,909 --> 00:21:34,360
because I thought lots of people use it

00:21:32,139 --> 00:21:35,200
and so if you want to do this it is you

00:21:34,360 --> 00:21:38,230
don't have to think about it it just

00:21:35,200 --> 00:21:40,330
works for you so when when would you use

00:21:38,230 --> 00:21:41,980
this if you're a criminal when when

00:21:40,330 --> 00:21:44,320
would when would be an appropriate time

00:21:41,980 --> 00:21:46,299
to use this thing well when do you not

00:21:44,320 --> 00:21:48,789
use this basically like I don't know

00:21:46,299 --> 00:21:49,809
it's kind of free like if you doesn't

00:21:48,789 --> 00:21:50,710
really cost you anything to use and you

00:21:49,809 --> 00:21:52,179
get these cookies which you might be

00:21:50,710 --> 00:21:53,200
able to use like what I'm saying it's

00:21:52,179 --> 00:21:55,029
like whenever you see this like I

00:21:53,200 --> 00:21:56,379
smashed that button and then use it is

00:21:55,029 --> 00:21:59,559
you're gonna get the good content it's

00:21:56,379 --> 00:22:01,090
basically free this is also one thing I

00:21:59,559 --> 00:22:02,679
thought that interesting is this the

00:22:01,090 --> 00:22:03,879
ability to do this if 2 years old like

00:22:02,679 --> 00:22:07,330
this it's been in Google Chrome for like

00:22:03,879 --> 00:22:08,559
2 years maybe even worn out and as far

00:22:07,330 --> 00:22:09,940
as I know I was the first person to like

00:22:08,559 --> 00:22:11,019
write about it or like publish it or

00:22:09,940 --> 00:22:12,279
anything like that and I just kind of

00:22:11,019 --> 00:22:14,230
stumbled into it in the middle of like a

00:22:12,279 --> 00:22:15,249
red team operation one day and so I'm

00:22:14,230 --> 00:22:17,200
not really sure of what the implications

00:22:15,249 --> 00:22:18,460
of this are because like people try and

00:22:17,200 --> 00:22:19,629
hack people crying all the time because

00:22:18,460 --> 00:22:20,980
people use it all the time so it's like

00:22:19,629 --> 00:22:22,960
very valuable software that to try and

00:22:20,980 --> 00:22:24,220
hack in some way and to be clear this is

00:22:22,960 --> 00:22:26,470
not really how can Google crime crime is

00:22:24,220 --> 00:22:28,269
like sort of meant to do this and but

00:22:26,470 --> 00:22:29,320
like I was surprised that I was the

00:22:28,269 --> 00:22:31,869
first person to write about this because

00:22:29,320 --> 00:22:33,429
lots of people use it now and so I

00:22:31,869 --> 00:22:34,690
thought I think the real thing the real

00:22:33,429 --> 00:22:37,210
reason why nobody's written about this

00:22:34,690 --> 00:22:38,769
is because there's no like bug bounty

00:22:37,210 --> 00:22:40,059
money for finding this like Google one

00:22:38,769 --> 00:22:41,619
like no one will pay you for finding

00:22:40,059 --> 00:22:42,970
this cool exploit cuz it's not actually

00:22:41,619 --> 00:22:44,080
an exploit this is a feature of Google

00:22:42,970 --> 00:22:45,789
Chrome we're just learning which is

00:22:44,080 --> 00:22:47,409
reading the docs at this point and so

00:22:45,789 --> 00:22:48,700
maybe people weren't gonna get paid for

00:22:47,409 --> 00:22:51,129
it so they went they weren't interested

00:22:48,700 --> 00:22:52,389
in it I don't know or maybe maybe this

00:22:51,129 --> 00:22:53,799
was ignored because it's officially a

00:22:52,389 --> 00:22:54,879
feature of Google Chrome right like if

00:22:53,799 --> 00:22:56,440
you can execute code of someone you can

00:22:54,879 --> 00:22:57,519
do anything they can do like you could

00:22:56,440 --> 00:22:58,899
just do this by moving the presence

00:22:57,519 --> 00:23:02,769
mouse and clicking around there's no

00:22:58,899 --> 00:23:04,059
like a like a increase of like privilege

00:23:02,769 --> 00:23:05,529
I guess this is the same an appendage is

00:23:04,059 --> 00:23:06,580
you always have easier but I don't

00:23:05,529 --> 00:23:09,070
really know the answer if you know you

00:23:06,580 --> 00:23:10,090
please tell me what if you don't want to

00:23:09,070 --> 00:23:13,299
happen to you what if you want to

00:23:10,090 --> 00:23:16,360
prevent this in the worlds of neil

00:23:13,299 --> 00:23:19,070
degrasse tyson solution there seems to

00:23:16,360 --> 00:23:22,010
me is to create unhackable systems

00:23:19,070 --> 00:23:24,170
I think about this tweet a lot and so I

00:23:22,010 --> 00:23:25,910
wanted to share with you if you want

00:23:24,170 --> 00:23:27,620
this attack to be not used against you I

00:23:25,910 --> 00:23:28,760
can wholeheartedly recommend not letting

00:23:27,620 --> 00:23:32,540
someone else execute code on your

00:23:28,760 --> 00:23:34,070
computer and the industry-standard best

00:23:32,540 --> 00:23:35,810
practice for this is to rapidly acquire

00:23:34,070 --> 00:23:37,160
blessed amulets or mysterious crystals

00:23:35,810 --> 00:23:39,050
or like pay-as-you-go racketeering

00:23:37,160 --> 00:23:41,120
schemes to prevent the execution of this

00:23:39,050 --> 00:23:42,320
code on your computer I think at the

00:23:41,120 --> 00:23:44,150
point where someone's executing code on

00:23:42,320 --> 00:23:45,560
your computer it's too late there is

00:23:44,150 --> 00:23:47,030
also this whole channel ban cookies

00:23:45,560 --> 00:23:48,770
thing which would prevent this which is

00:23:47,030 --> 00:23:50,540
like using public key cryptography to

00:23:48,770 --> 00:23:52,010
like you sign the cookies and the server

00:23:50,540 --> 00:23:53,660
also like peleg say you are who you say

00:23:52,010 --> 00:23:55,790
you are so you can move to a new device

00:23:53,660 --> 00:23:56,900
this is really complicated and your

00:23:55,790 --> 00:23:57,950
computer has to implement it and the

00:23:56,900 --> 00:23:59,540
other computer have to implement it and

00:23:57,950 --> 00:24:00,440
they're also privacy concerns cuz now

00:23:59,540 --> 00:24:02,480
that tracking which device you're using

00:24:00,440 --> 00:24:04,010
so basically no one's no one uses if

00:24:02,480 --> 00:24:05,240
it's currently in Google Chrome but I

00:24:04,010 --> 00:24:06,290
read like a public discussion where

00:24:05,240 --> 00:24:10,460
they're gonna remove it cuz no one uses

00:24:06,290 --> 00:24:11,600
it so I in terms of detection like how

00:24:10,460 --> 00:24:12,800
can you detect it doesn't happen to you

00:24:11,600 --> 00:24:14,480
who can detect whether this has happened

00:24:12,800 --> 00:24:16,100
to you I in theory

00:24:14,480 --> 00:24:17,270
Google can Google or whatever website

00:24:16,100 --> 00:24:18,950
you're moving the cookies from they know

00:24:17,270 --> 00:24:20,630
that they gave the cookie to a certain

00:24:18,950 --> 00:24:22,190
like browser operating system IP address

00:24:20,630 --> 00:24:24,770
or some other device fingerprint pain

00:24:22,190 --> 00:24:26,810
and so they can attempt to detect when

00:24:24,770 --> 00:24:28,160
cookie gets moved so some sometimes some

00:24:26,810 --> 00:24:29,540
websites like Gmail or Twitter will

00:24:28,160 --> 00:24:30,770
sometimes know sometimes will log you

00:24:29,540 --> 00:24:32,510
out of your account if you move your

00:24:30,770 --> 00:24:34,220
cookie to a different machine or to a

00:24:32,510 --> 00:24:36,230
different something and this is

00:24:34,220 --> 00:24:37,220
controlled by the website and they

00:24:36,230 --> 00:24:39,050
decide whether to log you right if they

00:24:37,220 --> 00:24:41,210
think you're being dodgy and so I asked

00:24:39,050 --> 00:24:43,070
someone who works at Google how this

00:24:41,210 --> 00:24:44,870
would work like how this thing works and

00:24:43,070 --> 00:24:45,890
they said machine learning which is the

00:24:44,870 --> 00:24:47,060
kind of thing that you would say if you

00:24:45,890 --> 00:24:51,410
just wanted me to stop asking about this

00:24:47,060 --> 00:24:52,340
so I said but in this situation you have

00:24:51,410 --> 00:24:53,480
a shell in the other person's computer

00:24:52,340 --> 00:24:55,280
so you can proxy all your traffic

00:24:53,480 --> 00:24:56,300
through their computer so you would look

00:24:55,280 --> 00:24:57,680
like them from a networking point of

00:24:56,300 --> 00:25:00,260
view anyway so it's not all bad news

00:24:57,680 --> 00:25:02,060
you can public it around it either way I

00:25:00,260 --> 00:25:03,440
also told Google about this just in case

00:25:02,060 --> 00:25:04,520
I wasn't going to but then someone I

00:25:03,440 --> 00:25:06,050
work with was like no you should tell

00:25:04,520 --> 00:25:07,910
them in case they decide to change it I

00:25:06,050 --> 00:25:09,200
thought that like Google already know it

00:25:07,910 --> 00:25:10,400
like I read I oh no this from the

00:25:09,200 --> 00:25:11,570
official Google documentation they know

00:25:10,400 --> 00:25:12,950
I know that they know that it's possible

00:25:11,570 --> 00:25:14,630
to do this but I thought I told you

00:25:12,950 --> 00:25:16,190
different cakes anyway and so I told

00:25:14,630 --> 00:25:17,540
them and they were like yep that's fine

00:25:16,190 --> 00:25:19,550
this is it supposed to do that it's okay

00:25:17,540 --> 00:25:21,020
this is we made it do it like we made it

00:25:19,550 --> 00:25:23,030
this way that's all right and they're

00:25:21,020 --> 00:25:24,530
like it's kind of weird that you can you

00:25:23,030 --> 00:25:26,230
know make headless Chrome login as you

00:25:24,530 --> 00:25:28,510
but like

00:25:26,230 --> 00:25:31,110
it's fine that's what I got out of this

00:25:28,510 --> 00:25:34,800
I said okay good officially signed off

00:25:31,110 --> 00:25:36,790
and what did I learn from doing all this

00:25:34,800 --> 00:25:38,290
it's just sort of this is again this is

00:25:36,790 --> 00:25:40,600
like my first time doing like a proper

00:25:38,290 --> 00:25:42,160
red team operation thing and so I

00:25:40,600 --> 00:25:44,200
learned that sometimes hacking if it

00:25:42,160 --> 00:25:46,150
feels like just try hiding aggressively

00:25:44,200 --> 00:25:47,650
like just furiously reading the dogs old

00:25:46,150 --> 00:25:49,480
figure out how it works and just trying

00:25:47,650 --> 00:25:50,710
a lot to try and find something that no

00:25:49,480 --> 00:25:53,620
one else has found all that people are

00:25:50,710 --> 00:25:55,210
expecting and that was fun and I also

00:25:53,620 --> 00:25:56,710
learned that having having hacker friend

00:25:55,210 --> 00:25:57,670
or his or people who people who know

00:25:56,710 --> 00:25:59,290
about this kind of thing I know about

00:25:57,670 --> 00:26:00,880
similar things to like point you in the

00:25:59,290 --> 00:26:02,350
right direction like my teammate who

00:26:00,880 --> 00:26:04,030
said well it should be possible to read

00:26:02,350 --> 00:26:05,800
creme cookies because the user can read

00:26:04,030 --> 00:26:07,180
the rain cookies that saves a lot of

00:26:05,800 --> 00:26:09,460
that saves a lot of time and effort it's

00:26:07,180 --> 00:26:10,750
really helpful because since doing

00:26:09,460 --> 00:26:12,880
hacking is so undocumented there's no

00:26:10,750 --> 00:26:14,950
like steps to follow you there's no real

00:26:12,880 --> 00:26:16,300
guide to it and so the community like

00:26:14,950 --> 00:26:17,800
other people who know about this is the

00:26:16,300 --> 00:26:19,060
best thing we have and so it really

00:26:17,800 --> 00:26:21,130
helps being able to talk to these people

00:26:19,060 --> 00:26:23,200
while being in that community and also

00:26:21,130 --> 00:26:25,630
in the the trade-off between having

00:26:23,200 --> 00:26:26,830
features and having stuff that's just

00:26:25,630 --> 00:26:28,690
called a tax service but like stuff you

00:26:26,830 --> 00:26:30,730
can hack it's very real that's why this

00:26:28,690 --> 00:26:31,630
technique exists like the people at

00:26:30,730 --> 00:26:33,550
Google they didn't make the chrome

00:26:31,630 --> 00:26:34,960
remote debugging protocol for kids like

00:26:33,550 --> 00:26:36,160
me to try and hack Google Chrome they

00:26:34,960 --> 00:26:37,540
made it for some other reason they made

00:26:36,160 --> 00:26:38,980
it for people to do like browser

00:26:37,540 --> 00:26:40,270
automation and stuff so you can like run

00:26:38,980 --> 00:26:41,800
your test and actually remote-control

00:26:40,270 --> 00:26:43,720
chrome to like automatically test your

00:26:41,800 --> 00:26:44,710
website and that's very convenient for

00:26:43,720 --> 00:26:46,150
the people who want to do automatic

00:26:44,710 --> 00:26:47,680
testing but it's also very convenient

00:26:46,150 --> 00:26:49,990
for people like me who want to like

00:26:47,680 --> 00:26:51,520
break into things so it's a trade-off

00:26:49,990 --> 00:26:53,320
and if you have a lot of features then

00:26:51,520 --> 00:26:54,340
it can make it so there's more stuff to

00:26:53,320 --> 00:26:57,040
hack but also you could have lots of

00:26:54,340 --> 00:26:58,480
features so you have to decide how you

00:26:57,040 --> 00:26:59,650
decide what how much risk you I take

00:26:58,480 --> 00:27:02,410
that's what I learned

00:26:59,650 --> 00:27:03,880
oh and also we also might be wondering

00:27:02,410 --> 00:27:05,500
like hey we're PyCon so like what is it

00:27:03,880 --> 00:27:06,550
like you might be wondering what does

00:27:05,500 --> 00:27:07,570
this have to do with Python the

00:27:06,550 --> 00:27:08,590
programming language that were here for

00:27:07,570 --> 00:27:13,180
like what does this talk have to do a

00:27:08,590 --> 00:27:22,690
Python thank you very much

00:27:13,180 --> 00:27:26,120
[Applause]

00:27:22,690 --> 00:27:28,610
thank you very much for speaking with us

00:27:26,120 --> 00:27:31,550
I'm not going to try and jump this I

00:27:28,610 --> 00:27:33,320
will let Chris do it thank you very much

00:27:31,550 --> 00:27:35,120
for speaking we've got a 10-minute break

00:27:33,320 --> 00:27:39,070
now so if you want to grab a drink oh

00:27:35,120 --> 00:27:39,070

YouTube URL: https://www.youtube.com/watch?v=BWAetsJqey0


