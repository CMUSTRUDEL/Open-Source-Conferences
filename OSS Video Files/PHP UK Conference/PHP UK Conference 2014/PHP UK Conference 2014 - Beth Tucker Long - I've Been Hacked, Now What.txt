Title: PHP UK Conference 2014 - Beth Tucker Long - I've Been Hacked, Now What
Publication date: 2014-03-21
Playlist: PHP UK Conference 2014
Description: 
	Put on your trench coat and grab your magnifying glass as we walk through investigating a real-life hacked WordPress website. You'll experience first-hand what tools can help you find the vulnerability and the point of entrance. Learn what the hacker might have left behind, how to seal up the most common problem areas, and how to set up notifications to help you spot a hack more quickly in the future. Even though we will be going through a WordPress website, most of the tools discussed are applicable to any website.
Captions: 
	00:00:05,120 --> 00:00:12,570
so welcome to I've been hacked now what

00:00:09,870 --> 00:00:14,639
so he mentioned a little bit about me so

00:00:12,570 --> 00:00:16,710
I am the editor-in-chief of PHP

00:00:14,639 --> 00:00:18,000
architect magazine if you're interested

00:00:16,710 --> 00:00:19,680
I have a few copies up here

00:00:18,000 --> 00:00:20,970
unfortunately these are my last copies

00:00:19,680 --> 00:00:22,320
so they're my personal copies so please

00:00:20,970 --> 00:00:24,750
don't take them but please come up and

00:00:22,320 --> 00:00:27,060
take a look at them I can get you a

00:00:24,750 --> 00:00:28,320
discount code if you would like also if

00:00:27,060 --> 00:00:29,970
you've ever thought about writing for a

00:00:28,320 --> 00:00:31,800
technical journal we would love to help

00:00:29,970 --> 00:00:33,540
you get published we have technical

00:00:31,800 --> 00:00:35,070
editors and copy editors that will help

00:00:33,540 --> 00:00:37,680
your article sound good so don't worry

00:00:35,070 --> 00:00:40,230
if you're not a professional writer will

00:00:37,680 --> 00:00:41,130
help you with that so please come and

00:00:40,230 --> 00:00:42,809
talk to me if you've ever been

00:00:41,130 --> 00:00:44,730
interested in being published we pay you

00:00:42,809 --> 00:00:46,980
to write so it's even you can make some

00:00:44,730 --> 00:00:50,010
money doing it not much but a little bit

00:00:46,980 --> 00:00:52,890
so come and talk to me about that as

00:00:50,010 --> 00:00:54,749
well as been mentioned I'm a user group

00:00:52,890 --> 00:00:56,550
leader if you are not a member of a user

00:00:54,749 --> 00:00:58,289
group here's my user group pitch you

00:00:56,550 --> 00:01:00,480
should find a user group and join they

00:00:58,289 --> 00:01:02,819
are amazing if there's not a user group

00:01:00,480 --> 00:01:04,350
near you you should start one and there

00:01:02,819 --> 00:01:06,090
are a lot of us who would love to help

00:01:04,350 --> 00:01:07,350
you do that there's a lot of support out

00:01:06,090 --> 00:01:09,840
there for people who want to start a

00:01:07,350 --> 00:01:12,510
user group so let us know we'd love to

00:01:09,840 --> 00:01:14,070
help you get that started if you are not

00:01:12,510 --> 00:01:15,690
interested in starting one and there's

00:01:14,070 --> 00:01:18,750
not one near you but you want to be part

00:01:15,690 --> 00:01:22,050
of one check out nomad PHP it's n om ad

00:01:18,750 --> 00:01:23,640
PHP it's an online user group so all you

00:01:22,050 --> 00:01:25,860
need is an internet connection and you

00:01:23,640 --> 00:01:30,980
have a user group near you so check that

00:01:25,860 --> 00:01:33,750
out as well so taking a look at websites

00:01:30,980 --> 00:01:36,840
here's a website that I was called in to

00:01:33,750 --> 00:01:38,460
take a look at it seems fine right they

00:01:36,840 --> 00:01:41,790
have their pictures they've got their

00:01:38,460 --> 00:01:43,410
content everything's fine however this

00:01:41,790 --> 00:01:46,200
is what google was getting when they

00:01:43,410 --> 00:01:48,150
went to the site yeah this is not the

00:01:46,200 --> 00:01:51,600
content they wanted to be advertising on

00:01:48,150 --> 00:01:53,010
Google so they're like what happens

00:01:51,600 --> 00:01:56,160
because they go to the website it looks

00:01:53,010 --> 00:01:58,470
fine well what's happening is there's a

00:01:56,160 --> 00:02:01,110
little bit of code being injected it's

00:01:58,470 --> 00:02:03,990
only being injected if it's a robots

00:02:01,110 --> 00:02:05,640
file coming through or if it's a spider

00:02:03,990 --> 00:02:07,890
coming through it's not if it's being

00:02:05,640 --> 00:02:10,140
displayed to a browser it's only being

00:02:07,890 --> 00:02:12,690
inserted at that point so as a human

00:02:10,140 --> 00:02:14,970
coming to look at it you never see it so

00:02:12,690 --> 00:02:16,349
what they were getting is google was

00:02:14,970 --> 00:02:18,209
getting this and everyone else was

00:02:16,349 --> 00:02:21,390
getting the regular content so i called

00:02:18,209 --> 00:02:22,739
me in and they said what's going on they

00:02:21,390 --> 00:02:23,550
also went through the database it's not

00:02:22,739 --> 00:02:25,410
in the database

00:02:23,550 --> 00:02:27,210
it's not in the admin panel they can't

00:02:25,410 --> 00:02:31,110
see it they can't find it so where

00:02:27,210 --> 00:02:33,960
exactly is it coming from well first

00:02:31,110 --> 00:02:35,370
step before you go looking for it stop

00:02:33,960 --> 00:02:37,020
for a moment and change all the

00:02:35,370 --> 00:02:38,550
passwords it doesn't matter where it's

00:02:37,020 --> 00:02:41,150
coming from at this point let's change

00:02:38,550 --> 00:02:43,230
the passwords to stop any future damage

00:02:41,150 --> 00:02:44,790
so you want to make sure not only do you

00:02:43,230 --> 00:02:46,560
change the passwords for all the users

00:02:44,790 --> 00:02:48,930
who have access to the server and to the

00:02:46,560 --> 00:02:51,090
admin panels but change any SSH keys at

00:02:48,930 --> 00:02:52,920
this point you want to make sure there

00:02:51,090 --> 00:02:54,570
aren't any SSH keys in there that you

00:02:52,920 --> 00:02:58,140
don't think should be there so check for

00:02:54,570 --> 00:02:59,550
any strange SSH keys in there if you're

00:02:58,140 --> 00:03:01,200
on a Linux server a lot of the commands

00:02:59,550 --> 00:03:03,900
I'm using our for Linux but there are

00:03:01,200 --> 00:03:06,030
also comparable commands for Windows

00:03:03,900 --> 00:03:07,320
servers but check the bash history see

00:03:06,030 --> 00:03:10,170
who's been getting in what they've been

00:03:07,320 --> 00:03:12,510
doing check the user logins history and

00:03:10,170 --> 00:03:14,250
contact the hosting company if you are

00:03:12,510 --> 00:03:15,720
not the hosting company please contact

00:03:14,250 --> 00:03:17,520
the hosting company and let them know

00:03:15,720 --> 00:03:19,440
chances are if they're on a shared

00:03:17,520 --> 00:03:21,180
hosting company it's not their fault

00:03:19,440 --> 00:03:23,130
they got hacked at somebody else on the

00:03:21,180 --> 00:03:24,810
shared hosting and if that doesn't get

00:03:23,130 --> 00:03:28,200
cleaned up then your site will never be

00:03:24,810 --> 00:03:30,900
clean there's a couple of commands you

00:03:28,200 --> 00:03:34,350
can use at this point you can use last

00:03:30,900 --> 00:03:36,570
to discover who's been logging in there

00:03:34,350 --> 00:03:38,870
is also history which will give you a

00:03:36,570 --> 00:03:41,489
history of the recently used commands

00:03:38,870 --> 00:03:43,500
even ones that were used outside of your

00:03:41,489 --> 00:03:44,790
session a lot of if you just scroll back

00:03:43,500 --> 00:03:47,190
in the history you're just getting your

00:03:44,790 --> 00:03:48,630
commands but if you use history you can

00:03:47,190 --> 00:03:51,390
get commands outside of your session as

00:03:48,630 --> 00:03:54,030
well however a lot of times the hack

00:03:51,390 --> 00:03:57,510
occurs months and months before anything

00:03:54,030 --> 00:03:59,100
noticeable happens on the site so recent

00:03:57,510 --> 00:04:02,400
history may not give you the information

00:03:59,100 --> 00:04:03,959
that you need ok so now let's start

00:04:02,400 --> 00:04:05,610
taking a look we've sort of locked

00:04:03,959 --> 00:04:07,170
things down as much as we can let's take

00:04:05,610 --> 00:04:09,180
a look at where this information is

00:04:07,170 --> 00:04:10,530
coming from take a look at the server

00:04:09,180 --> 00:04:13,410
and see if you can find some

00:04:10,530 --> 00:04:15,030
strange-looking files a lot of times

00:04:13,410 --> 00:04:17,940
there's sort of innocuous names like

00:04:15,030 --> 00:04:19,260
functions or inc dot PHP however

00:04:17,940 --> 00:04:21,540
sometimes you get strange ones like

00:04:19,260 --> 00:04:23,400
cookies with a varying number of o's in

00:04:21,540 --> 00:04:26,310
it I'm not sure why they think that

00:04:23,400 --> 00:04:28,740
one's subtle it's not but that that's a

00:04:26,310 --> 00:04:31,080
very popular one check for any files

00:04:28,740 --> 00:04:34,410
using funk or functions or any sort of

00:04:31,080 --> 00:04:37,380
variation on that word as well a lot of

00:04:34,410 --> 00:04:39,030
times too you'll find

00:04:37,380 --> 00:04:41,190
your normal files but they will have

00:04:39,030 --> 00:04:42,900
something injected into them so take a

00:04:41,190 --> 00:04:45,510
look through even files that you know

00:04:42,900 --> 00:04:47,670
are yours and see if they have some

00:04:45,510 --> 00:04:50,720
strange code at the top a lot of times

00:04:47,670 --> 00:04:54,750
it's going to be obfuscated adconion

00:04:50,720 --> 00:04:57,150
eval and GV inflate and the base64

00:04:54,750 --> 00:04:59,370
decode over and over and over and over

00:04:57,150 --> 00:05:01,740
again and if you try to go through and

00:04:59,370 --> 00:05:04,050
clean it up it they've obviously skated

00:05:01,740 --> 00:05:05,910
so many times thousands of times that

00:05:04,050 --> 00:05:07,620
it's really a pain to try to get down

00:05:05,910 --> 00:05:09,060
and see what it actually is I have a

00:05:07,620 --> 00:05:12,210
screenshot later I'll show you what some

00:05:09,060 --> 00:05:13,980
of this code actually does but take a

00:05:12,210 --> 00:05:15,570
look at the files it's oftentimes at the

00:05:13,980 --> 00:05:17,760
top or the bottom of the file which can

00:05:15,570 --> 00:05:19,020
make it quickly to scan but you don't

00:05:17,760 --> 00:05:20,610
want to forget the middle of the file

00:05:19,020 --> 00:05:23,340
because sometimes they're sneakier and

00:05:20,610 --> 00:05:25,590
sometimes they're not oftentimes it's on

00:05:23,340 --> 00:05:26,700
one line and they try to do that so if

00:05:25,590 --> 00:05:29,670
you're scanning through the code click

00:05:26,700 --> 00:05:32,930
quickly you miss the one line so

00:05:29,670 --> 00:05:35,040
double-check and take a look through

00:05:32,930 --> 00:05:37,980
another one you may see something kind

00:05:35,040 --> 00:05:39,980
of like this so they've caught on to the

00:05:37,980 --> 00:05:42,270
fact that people often search for eval

00:05:39,980 --> 00:05:44,100
so they go through and they do a bunch

00:05:42,270 --> 00:05:46,290
of string replaces and stuff to trick

00:05:44,100 --> 00:05:47,970
you into thinking it's real code so

00:05:46,290 --> 00:05:50,610
again though there's sort of that block

00:05:47,970 --> 00:05:52,860
of what looks like gibberish but is

00:05:50,610 --> 00:05:58,230
obfuscating code so that can be a really

00:05:52,860 --> 00:05:59,580
big clue as well this is another one and

00:05:58,230 --> 00:06:01,020
these are all samples that I've taken

00:05:59,580 --> 00:06:03,030
out of files that I've cleaned up so

00:06:01,020 --> 00:06:05,580
these are either partial but they're

00:06:03,030 --> 00:06:07,380
these are actual hacks that you'll find

00:06:05,580 --> 00:06:10,140
so this is another one you might see

00:06:07,380 --> 00:06:12,210
again if you're searching for you know

00:06:10,140 --> 00:06:13,920
the base64 decode or the eval you're not

00:06:12,210 --> 00:06:16,790
going to find this one this one uses URL

00:06:13,920 --> 00:06:19,320
decode which is often times a common

00:06:16,790 --> 00:06:24,000
command in files especially for using a

00:06:19,320 --> 00:06:26,310
larger framework or application this is

00:06:24,000 --> 00:06:29,640
the most common one I found is just the

00:06:26,310 --> 00:06:34,080
simple eval and then miles and miles and

00:06:29,640 --> 00:06:38,220
miles of text this is another fun one I

00:06:34,080 --> 00:06:40,500
enjoyed so this one before the office

00:06:38,220 --> 00:06:42,450
gated code they put a big warning this

00:06:40,500 --> 00:06:44,850
file is protected by copyright law to

00:06:42,450 --> 00:06:48,900
reverse engineer or decode this file is

00:06:44,850 --> 00:06:50,790
strictly prohibited yeah good luck when

00:06:48,900 --> 00:06:51,330
forcing that one right now so if you see

00:06:50,790 --> 00:06:52,979
that

00:06:51,330 --> 00:06:54,680
that's probably a clue that maybe you

00:06:52,979 --> 00:06:57,659
should check out what that code is doing

00:06:54,680 --> 00:06:59,189
take a look at that but they do that

00:06:57,659 --> 00:07:00,990
because a lot of users will be like oh

00:06:59,189 --> 00:07:06,960
you can't touch that and it's like I

00:07:00,990 --> 00:07:08,580
really should so files that are commonly

00:07:06,960 --> 00:07:10,229
injected you're going to want to take a

00:07:08,580 --> 00:07:12,659
look first at the htaccess file

00:07:10,229 --> 00:07:15,030
especially when it's something like a

00:07:12,659 --> 00:07:17,430
Google injection where only google is

00:07:15,030 --> 00:07:19,259
seeing it check the htaccess files

00:07:17,430 --> 00:07:21,270
that's very commonly where it's put in

00:07:19,259 --> 00:07:23,759
if you're using something that uses

00:07:21,270 --> 00:07:25,889
themes or plugins or modules or

00:07:23,759 --> 00:07:28,259
templates of some kind some sort of any

00:07:25,889 --> 00:07:30,270
external libraries check in there see if

00:07:28,259 --> 00:07:32,250
they're coming in through there check

00:07:30,270 --> 00:07:34,069
any upload directories especially upload

00:07:32,250 --> 00:07:36,300
directories that might be world writable

00:07:34,069 --> 00:07:37,770
especially WordPress I'm going to

00:07:36,300 --> 00:07:41,039
mention WordPress several times because

00:07:37,770 --> 00:07:42,779
I've cleaned that up so many times so

00:07:41,039 --> 00:07:44,909
double-check the WordPress uploads file

00:07:42,779 --> 00:07:47,789
there should never be any PHP files in

00:07:44,909 --> 00:07:50,400
the uploads directory of WordPress for

00:07:47,789 --> 00:07:52,139
most use cases so double check if there

00:07:50,400 --> 00:07:54,779
is any executable code in the uploads

00:07:52,139 --> 00:07:56,550
directory double-check your config files

00:07:54,779 --> 00:07:58,409
sometimes they'll hide it in the config

00:07:56,550 --> 00:08:00,389
files because config files oftentimes

00:07:58,409 --> 00:08:01,860
are very long and most people don't take

00:08:00,389 --> 00:08:05,069
the time to read through what everything

00:08:01,860 --> 00:08:08,190
in the config file means so you know a

00:08:05,069 --> 00:08:10,259
less tech-savvy developer or a less

00:08:08,190 --> 00:08:12,779
tech-savvy user going through a huge

00:08:10,259 --> 00:08:13,889
config file oftentimes will miss the

00:08:12,779 --> 00:08:17,819
things that they've injected so

00:08:13,889 --> 00:08:19,379
double-check your config files so if

00:08:17,819 --> 00:08:21,629
they've injected something into your HT

00:08:19,379 --> 00:08:23,969
Access file it could look like this so

00:08:21,629 --> 00:08:26,250
this is utilizing mod rewrite and what

00:08:23,969 --> 00:08:29,279
it's doing is it's deciding whether or

00:08:26,250 --> 00:08:31,139
not you're a search engine or if you're

00:08:29,279 --> 00:08:33,479
a person viewing through a browser and

00:08:31,139 --> 00:08:35,729
based on that it wraps you to either the

00:08:33,479 --> 00:08:39,060
normal file or to this file that they've

00:08:35,729 --> 00:08:41,099
called common PHP and common dot PHP is

00:08:39,060 --> 00:08:43,229
going to do that Google injection to get

00:08:41,099 --> 00:08:45,029
all of their keywords into your Google

00:08:43,229 --> 00:08:49,260
search results so this is something that

00:08:45,029 --> 00:08:50,640
you might find in an HT Access file so

00:08:49,260 --> 00:08:52,380
we've kind of taken a look through but

00:08:50,640 --> 00:08:55,470
manually looking through things can be

00:08:52,380 --> 00:08:57,449
very very time-intensive and if you have

00:08:55,470 --> 00:08:59,010
a site with thousands of files it might

00:08:57,449 --> 00:09:01,949
be overwhelming to try to look through

00:08:59,010 --> 00:09:03,930
all of them by hand so we can do some

00:09:01,949 --> 00:09:04,270
searching to try to find out what's been

00:09:03,930 --> 00:09:06,670
chained

00:09:04,270 --> 00:09:09,100
changed now the trick with finding out

00:09:06,670 --> 00:09:11,710
with what's been changed is that it's

00:09:09,100 --> 00:09:13,990
oftentimes pretty easy to mask what's

00:09:11,710 --> 00:09:16,000
been changed when they come in but not

00:09:13,990 --> 00:09:17,890
completely so most often people will

00:09:16,000 --> 00:09:20,680
come in and they'll do an LS and you can

00:09:17,890 --> 00:09:22,450
add the dash LA to get some more

00:09:20,680 --> 00:09:26,950
information so you can see here I have a

00:09:22,450 --> 00:09:28,390
file edited March 19 2012 now if I go

00:09:26,950 --> 00:09:30,220
through and make a change to that so

00:09:28,390 --> 00:09:34,510
I've touched it so now it's going to say

00:09:30,220 --> 00:09:36,460
March 28 2013 or whatever the date is so

00:09:34,510 --> 00:09:38,170
you go through and you should now be

00:09:36,460 --> 00:09:40,090
able to search for that date and see all

00:09:38,170 --> 00:09:41,980
the new files that have changed however

00:09:40,090 --> 00:09:45,310
if I go through and touch that and I add

00:09:41,980 --> 00:09:47,110
the minus T I can now specify a date

00:09:45,310 --> 00:09:49,270
that I want listed for when that file

00:09:47,110 --> 00:09:51,580
was changed and now you can see my file

00:09:49,270 --> 00:09:53,380
hasn't been changed since October 2011

00:09:51,580 --> 00:09:56,020
so clearly that's not a file you need to

00:09:53,380 --> 00:09:59,800
worry about looking at right so not so

00:09:56,020 --> 00:10:01,510
much so what you want to do is there's a

00:09:59,800 --> 00:10:04,150
couple different ways you can check for

00:10:01,510 --> 00:10:06,190
a more secure date than just using LS

00:10:04,150 --> 00:10:07,980
just using list so there's a program

00:10:06,190 --> 00:10:09,940
called stat it's not always available

00:10:07,980 --> 00:10:11,530
especially if you're on shared hosting

00:10:09,940 --> 00:10:14,140
some shared hosting allows you to access

00:10:11,530 --> 00:10:15,340
to it some will not but if you are

00:10:14,140 --> 00:10:17,050
running your own server you should have

00:10:15,340 --> 00:10:18,490
access to it so that will give you

00:10:17,050 --> 00:10:20,530
information it will give you the three

00:10:18,490 --> 00:10:23,290
dates that the server stores the access

00:10:20,530 --> 00:10:24,580
modify and change so the sea time or the

00:10:23,290 --> 00:10:27,250
change is what you really want to pay

00:10:24,580 --> 00:10:30,550
attention to their if you don't have

00:10:27,250 --> 00:10:33,610
access to stat you can use l s- CL and

00:10:30,550 --> 00:10:35,500
get the change the change information

00:10:33,610 --> 00:10:41,320
and that's going to give us the change

00:10:35,500 --> 00:10:43,240
date which you can also do once you have

00:10:41,320 --> 00:10:45,640
identified sort of a date range or a

00:10:43,240 --> 00:10:47,380
specific date when these malicious files

00:10:45,640 --> 00:10:49,870
were introduced or when you're good

00:10:47,380 --> 00:10:51,760
files were changed you can now go

00:10:49,870 --> 00:10:53,560
through and search the server for other

00:10:51,760 --> 00:10:55,780
files that were modified or changed in

00:10:53,560 --> 00:10:57,880
that same general time a lot of times

00:10:55,780 --> 00:10:59,530
they log in they'll upload all of the

00:10:57,880 --> 00:11:01,000
files and then they don't access your

00:10:59,530 --> 00:11:02,320
server again for a couple of months

00:11:01,000 --> 00:11:03,910
hoping that you don't notice the new

00:11:02,320 --> 00:11:05,470
information that's been introduced and

00:11:03,910 --> 00:11:07,090
that you'll continue using it so that

00:11:05,470 --> 00:11:09,550
all of your backups are now infected as

00:11:07,090 --> 00:11:11,470
well so having that date range

00:11:09,550 --> 00:11:13,180
identified can be helpful but don't

00:11:11,470 --> 00:11:14,800
think that if you get rid of everything

00:11:13,180 --> 00:11:16,240
on that date that you're now safe

00:11:14,800 --> 00:11:17,740
because a lot of times they'll upload

00:11:16,240 --> 00:11:19,300
multiple times hope

00:11:17,740 --> 00:11:23,080
that you'll clean off one date and not

00:11:19,300 --> 00:11:24,880
another so you can use a find you can

00:11:23,080 --> 00:11:28,600
search within a specific directory or

00:11:24,880 --> 00:11:31,150
not and you can add a flag with dash C

00:11:28,600 --> 00:11:33,580
time and dash C time will search the

00:11:31,150 --> 00:11:37,140
change time as opposed to the access or

00:11:33,580 --> 00:11:37,140
modify time which you're able to change

00:11:37,830 --> 00:11:43,960
so let's take a look at what this bad

00:11:40,990 --> 00:11:45,670
code actually does so sometimes it just

00:11:43,960 --> 00:11:47,530
introduces that Google Code like we

00:11:45,670 --> 00:11:49,150
talked about or whichever search engine

00:11:47,530 --> 00:11:51,610
you using so the search engine injection

00:11:49,150 --> 00:11:53,290
code sometimes that's all it does other

00:11:51,610 --> 00:11:56,710
times it does things that are a lot more

00:11:53,290 --> 00:11:58,990
fun and a friend of mine went through

00:11:56,710 --> 00:12:01,210
some of that obfuscating code and it

00:11:58,990 --> 00:12:02,860
took a long time to get through all the

00:12:01,210 --> 00:12:05,040
layers of encryption but we got through

00:12:02,860 --> 00:12:07,540
and this is what we found and I

00:12:05,040 --> 00:12:10,240
apologize it's a little bit blurry but

00:12:07,540 --> 00:12:12,010
what this is is this is a GUI admin

00:12:10,240 --> 00:12:14,800
panel that they have installed on the

00:12:12,010 --> 00:12:17,200
server it gives them access to ftp files

00:12:14,800 --> 00:12:19,870
up it gives them access to create users

00:12:17,200 --> 00:12:21,430
it gives them access to use the server i

00:12:19,870 --> 00:12:23,650
don't know if you can tell but over on

00:12:21,430 --> 00:12:26,530
the side there there is a menu item

00:12:23,650 --> 00:12:28,780
called brute force it allows them to run

00:12:26,530 --> 00:12:30,670
brute force attacks via your server to

00:12:28,780 --> 00:12:33,070
other servers or if you're on shared

00:12:30,670 --> 00:12:35,320
hosting oftentimes they'll have an item

00:12:33,070 --> 00:12:37,090
where they can now use your area of the

00:12:35,320 --> 00:12:40,270
server to try to spread out and attack

00:12:37,090 --> 00:12:43,300
other areas of the server it will

00:12:40,270 --> 00:12:45,460
automatically try to restore keys when

00:12:43,300 --> 00:12:46,930
you delete them SSH keys there's a lot

00:12:45,460 --> 00:12:49,750
of different things that will try to do

00:12:46,930 --> 00:12:52,960
it introduces a lot of back doors for

00:12:49,750 --> 00:12:54,370
them to get in so it's really important

00:12:52,960 --> 00:12:56,770
to make sure you've cleaned everything

00:12:54,370 --> 00:13:00,340
out because that one line of code

00:12:56,770 --> 00:13:03,760
produces this admin panel so if that one

00:13:00,340 --> 00:13:05,200
line of code is in 27 files they have 27

00:13:03,760 --> 00:13:07,000
admin panels that they're hoping you'll

00:13:05,200 --> 00:13:12,010
miss one because they only need you to

00:13:07,000 --> 00:13:13,870
miss one and they're back in so once we

00:13:12,010 --> 00:13:17,170
sort of identified which files were

00:13:13,870 --> 00:13:20,050
changed and we found the bad files now

00:13:17,170 --> 00:13:22,630
we might have access to which user

00:13:20,050 --> 00:13:24,100
modified those files so if you find out

00:13:22,630 --> 00:13:25,480
which users been compromised or if you

00:13:24,100 --> 00:13:27,670
find out that they've created a user

00:13:25,480 --> 00:13:30,700
that you weren't expecting we can now go

00:13:27,670 --> 00:13:31,610
through and take the file and grep the

00:13:30,700 --> 00:13:35,420
logs and

00:13:31,610 --> 00:13:37,579
find out who modified those files so

00:13:35,420 --> 00:13:39,500
let's say we take our cookies file that

00:13:37,579 --> 00:13:41,839
we know is bad we're going to look

00:13:39,500 --> 00:13:43,820
through the access logs and we're going

00:13:41,839 --> 00:13:45,860
to find out which IP address they came

00:13:43,820 --> 00:13:48,350
in at which obviously is not going to be

00:13:45,860 --> 00:13:49,839
their IP address but we now have an IP

00:13:48,350 --> 00:13:51,829
address to check in the logs because

00:13:49,839 --> 00:13:53,600
everything they did that day is probably

00:13:51,829 --> 00:13:54,860
coming in on that same IP address so at

00:13:53,600 --> 00:13:56,690
least you have some place to start

00:13:54,860 --> 00:13:57,829
looking don't think that you found the

00:13:56,690 --> 00:13:59,920
hacker if you get that IP address

00:13:57,829 --> 00:14:03,290
because I guarantee you it's not theirs

00:13:59,920 --> 00:14:04,670
so then once you have that once we have

00:14:03,290 --> 00:14:06,560
that IP address we can grab the logs

00:14:04,670 --> 00:14:08,209
again for that IP address and see if

00:14:06,560 --> 00:14:10,940
they came in multiple times under that

00:14:08,209 --> 00:14:13,940
IP address or we can see if we need to

00:14:10,940 --> 00:14:18,470
flag that IP address to prevent access

00:14:13,940 --> 00:14:20,300
again you can grep for the keywords that

00:14:18,470 --> 00:14:24,350
we found in the code like eval the

00:14:20,300 --> 00:14:25,779
base64 decode and things like that often

00:14:24,350 --> 00:14:28,519
times depending on what you're running

00:14:25,779 --> 00:14:31,550
that might be a very very common phrase

00:14:28,519 --> 00:14:33,769
that's being used correctly or it might

00:14:31,550 --> 00:14:35,839
be out of the ordinary it's much easier

00:14:33,769 --> 00:14:37,339
to find these if it's not something that

00:14:35,839 --> 00:14:38,839
you're already using because otherwise

00:14:37,339 --> 00:14:41,930
you get thousands of results back and

00:14:38,839 --> 00:14:44,420
most of them are good what you can do

00:14:41,930 --> 00:14:46,339
then if it's if you have a lot of eval

00:14:44,420 --> 00:14:49,070
and base64 decode statements that are

00:14:46,339 --> 00:14:51,680
validly in your code what you can do is

00:14:49,070 --> 00:14:54,140
take a bit of the encrypted string or

00:14:51,680 --> 00:14:56,720
the encoded string and then grep for

00:14:54,140 --> 00:14:59,839
that because that's not going to match

00:14:56,720 --> 00:15:02,149
what your code does with the encoded or

00:14:59,839 --> 00:15:04,279
what your encoded code looks like so you

00:15:02,149 --> 00:15:07,160
can use a bit of the encoded encoded

00:15:04,279 --> 00:15:10,880
code to grep instead of the command

00:15:07,160 --> 00:15:13,250
itself if you're specifically using

00:15:10,880 --> 00:15:14,839
WordPress again I apologize for harping

00:15:13,250 --> 00:15:17,870
on WordPress but I've cleaned it up so

00:15:14,839 --> 00:15:19,880
many times there is some automated

00:15:17,870 --> 00:15:22,130
scanning help specifically for WordPress

00:15:19,880 --> 00:15:25,250
so there's an exploit scanner in

00:15:22,130 --> 00:15:27,170
WordPress there's also WP scan and I

00:15:25,250 --> 00:15:28,850
have the links here and I do have my

00:15:27,170 --> 00:15:31,640
slides posted i'll give you the link as

00:15:28,850 --> 00:15:34,640
well so if you'd like to get the URLs

00:15:31,640 --> 00:15:36,500
later so these can help you scan

00:15:34,640 --> 00:15:38,209
wordpress find out if you have any holes

00:15:36,500 --> 00:15:42,890
find out if you're missing anything and

00:15:38,209 --> 00:15:44,839
so on so once we've sort of identified

00:15:42,890 --> 00:15:45,350
what was changed we want to make sure

00:15:44,839 --> 00:15:47,990
that we

00:15:45,350 --> 00:15:50,120
get everything cleaned up if you know

00:15:47,990 --> 00:15:52,250
you have a clean back up you can restore

00:15:50,120 --> 00:15:53,660
from that clean back up if your backup

00:15:52,250 --> 00:15:56,780
is stored on the server that was hacked

00:15:53,660 --> 00:15:59,750
you do not have a clean back up if yours

00:15:56,780 --> 00:16:03,080
if your backup comes from the server and

00:15:59,750 --> 00:16:05,270
you aren't absolutely positive that you

00:16:03,080 --> 00:16:07,430
know when the exploit happened or when

00:16:05,270 --> 00:16:10,640
the intrusion happened then you don't

00:16:07,430 --> 00:16:13,400
have a clean back up the best way to

00:16:10,640 --> 00:16:16,370
know you have a clean back up is to have

00:16:13,400 --> 00:16:19,220
a backup on a separate server and

00:16:16,370 --> 00:16:21,140
nothing comes down from the production

00:16:19,220 --> 00:16:23,870
server it only goes up from the backup

00:16:21,140 --> 00:16:25,610
server so that nothing that happens on

00:16:23,870 --> 00:16:27,800
the live server gets brought back into

00:16:25,610 --> 00:16:30,980
the backup that's the only way to sort

00:16:27,800 --> 00:16:32,180
of make sure it's clean if you don't

00:16:30,980 --> 00:16:33,500
have a clean back up you're going to

00:16:32,180 --> 00:16:35,420
have to manually clean up all the

00:16:33,500 --> 00:16:37,100
changed files in the case of something

00:16:35,420 --> 00:16:39,590
like wordpress or other software

00:16:37,100 --> 00:16:41,930
applications you can do a fresh install

00:16:39,590 --> 00:16:43,430
with the latest version and then migrate

00:16:41,930 --> 00:16:46,310
your data in there after you're sure

00:16:43,430 --> 00:16:48,050
it's cleaned and once you have

00:16:46,310 --> 00:16:49,790
everything cleaned up make sure you

00:16:48,050 --> 00:16:54,560
install all current security patches

00:16:49,790 --> 00:16:57,230
make sure everything is up to date so

00:16:54,560 --> 00:16:59,870
when cleaning up WordPress overwrite any

00:16:57,230 --> 00:17:01,130
of the core files those core files you

00:16:59,870 --> 00:17:03,170
should get new copies even if you think

00:17:01,130 --> 00:17:05,150
you have a clean backup it's safest to

00:17:03,170 --> 00:17:08,090
overwrite those with a clean copy just

00:17:05,150 --> 00:17:10,070
in case with a new one if you have any

00:17:08,090 --> 00:17:12,140
themes you're not using uninstall them

00:17:10,070 --> 00:17:14,300
and that goes for everything not just

00:17:12,140 --> 00:17:16,700
WordPress if you have themes plugins

00:17:14,300 --> 00:17:19,670
modules libraries that you are not using

00:17:16,700 --> 00:17:21,470
get rid of them lock it down so that

00:17:19,670 --> 00:17:24,050
only what you're using is what you have

00:17:21,470 --> 00:17:25,460
because the more third-party stuff you

00:17:24,050 --> 00:17:27,020
have in there the more vulnerabilities

00:17:25,460 --> 00:17:30,380
you could be introducing so if you're

00:17:27,020 --> 00:17:31,700
not using something get rid of it with

00:17:30,380 --> 00:17:33,620
WordPress you want to make sure you

00:17:31,700 --> 00:17:35,240
delete the plugins directory and install

00:17:33,620 --> 00:17:38,690
everything from scratch kind of

00:17:35,240 --> 00:17:40,100
obnoxious but it's too hard to go

00:17:38,690 --> 00:17:42,050
through all of the plugins directories

00:17:40,100 --> 00:17:45,230
and make sure everything is clean it's

00:17:42,050 --> 00:17:47,180
best just to get new copies WordPress

00:17:45,230 --> 00:17:48,830
has specific hardening instructions and

00:17:47,180 --> 00:17:50,900
WordPress is not the only application

00:17:48,830 --> 00:17:52,340
that has hardening instructions so check

00:17:50,900 --> 00:17:54,440
the software manual for whatever you're

00:17:52,340 --> 00:17:56,740
using and see if they have specific

00:17:54,440 --> 00:17:59,030
instructions for how to lock things down

00:17:56,740 --> 00:17:59,960
again check your uploads directory

00:17:59,030 --> 00:18:01,520
again because we want to make sure

00:17:59,960 --> 00:18:04,280
nothing's been introduced in the time

00:18:01,520 --> 00:18:06,050
that we were cleaning things and if you

00:18:04,280 --> 00:18:08,480
can make sure you're removing any

00:18:06,050 --> 00:18:10,700
install directories and if you can lock

00:18:08,480 --> 00:18:12,290
down the uploads directory that would be

00:18:10,700 --> 00:18:14,030
great if you have a few users who need

00:18:12,290 --> 00:18:15,530
to upload things to the upload directory

00:18:14,030 --> 00:18:17,840
lock it down to their specific IP

00:18:15,530 --> 00:18:21,230
addresses it's best if you don't have to

00:18:17,840 --> 00:18:22,820
leave it world readable once you're sure

00:18:21,230 --> 00:18:25,880
everything is clean go through and

00:18:22,820 --> 00:18:27,800
change all the passwords again as I said

00:18:25,880 --> 00:18:29,090
we don't know that things stayed clean

00:18:27,800 --> 00:18:31,010
while we were going through the cleaning

00:18:29,090 --> 00:18:33,410
process so change all the passwords

00:18:31,010 --> 00:18:35,540
again you want to make sure that you are

00:18:33,410 --> 00:18:38,000
not using passwords that are words leet

00:18:35,540 --> 00:18:39,950
speak is easy to crack the first letters

00:18:38,000 --> 00:18:41,510
of Bible verses apparently is a common

00:18:39,950 --> 00:18:44,360
password don't use that they have those

00:18:41,510 --> 00:18:46,910
all catalogued as well and also popular

00:18:44,360 --> 00:18:49,460
songs also kind of like the lyrics from

00:18:46,910 --> 00:18:51,050
popular songs are also categorized it's

00:18:49,460 --> 00:18:52,970
best if you can use a password that's at

00:18:51,050 --> 00:18:54,620
least 15 characters long I know that's

00:18:52,970 --> 00:18:58,010
really hard to convince your users of

00:18:54,620 --> 00:19:01,460
but if you can that would be nice and

00:18:58,010 --> 00:19:03,830
then regenerate and reissue any SSH key

00:19:01,460 --> 00:19:05,660
pairs because again we don't know that

00:19:03,830 --> 00:19:09,050
those work not compromised during this

00:19:05,660 --> 00:19:10,700
cleaning process once you're sure

00:19:09,050 --> 00:19:12,200
everything is clean it's nice to set up

00:19:10,700 --> 00:19:14,060
some monitoring so you can keep an eye

00:19:12,200 --> 00:19:16,010
out for this happening again if you've

00:19:14,060 --> 00:19:18,140
been hacked once chances are they're

00:19:16,010 --> 00:19:19,970
going to try again so we want to make

00:19:18,140 --> 00:19:21,920
sure especially if you're on shared

00:19:19,970 --> 00:19:24,410
hosting because you may have cleaned and

00:19:21,920 --> 00:19:26,060
locked down your stuff but that everyone

00:19:24,410 --> 00:19:28,130
on the shared hosting probably has or

00:19:26,060 --> 00:19:30,950
you may not have access to lock down the

00:19:28,130 --> 00:19:32,720
shared hostings problem so having some

00:19:30,950 --> 00:19:33,740
monitoring can really help watch for

00:19:32,720 --> 00:19:36,080
these things to happen in the future

00:19:33,740 --> 00:19:37,820
there are a lot of automated tools out

00:19:36,080 --> 00:19:40,250
there you can use and one of them is

00:19:37,820 --> 00:19:42,620
Vega they will automatically crawl and

00:19:40,250 --> 00:19:45,950
scan for vulnerabilities which is very

00:19:42,620 --> 00:19:48,320
fun there are WordPress plugins which

00:19:45,950 --> 00:19:50,240
can help you with scanning you can also

00:19:48,320 --> 00:19:52,280
do something simple like set up a cron

00:19:50,240 --> 00:19:54,650
job for some of the keywords that you

00:19:52,280 --> 00:19:57,740
found while you were cleaning things up

00:19:54,650 --> 00:19:59,570
and just set up an you know something to

00:19:57,740 --> 00:20:04,640
email you if it notices any of these

00:19:59,570 --> 00:20:07,040
keywords popping up in the code okay so

00:20:04,640 --> 00:20:10,610
now take a moment and relax and now

00:20:07,040 --> 00:20:13,230
let's take a look at why this happened

00:20:10,610 --> 00:20:16,320
so some of the common entry points about

00:20:13,230 --> 00:20:18,390
why this happened our number one shared

00:20:16,320 --> 00:20:21,240
hosting if you are unsure hosting that's

00:20:18,390 --> 00:20:23,130
probably how they got in share hosting

00:20:21,240 --> 00:20:24,840
is notorious for not keeping software

00:20:23,130 --> 00:20:26,850
up-to-date and it doesn't necessarily

00:20:24,840 --> 00:20:29,040
have to be your software a very very

00:20:26,850 --> 00:20:32,250
common attack vector is actually PHP

00:20:29,040 --> 00:20:34,290
myadmin PHP myadmin does not get updated

00:20:32,250 --> 00:20:36,540
for years and years on shared hosting

00:20:34,290 --> 00:20:38,730
tons of security holes are left open and

00:20:36,540 --> 00:20:41,130
even if your site is not using a

00:20:38,730 --> 00:20:42,960
database and has no access to the

00:20:41,130 --> 00:20:44,580
database they can still get into your

00:20:42,960 --> 00:20:48,240
area of the server because the shared

00:20:44,580 --> 00:20:51,600
hosting allows PHP my admin access to

00:20:48,240 --> 00:20:53,520
your area of the server so double check

00:20:51,600 --> 00:20:55,560
with your shared hosting make sure

00:20:53,520 --> 00:20:56,970
you've told them let them know what you

00:20:55,560 --> 00:20:58,830
found out when you're cleaning things up

00:20:56,970 --> 00:21:02,340
let them know which hack you found and

00:20:58,830 --> 00:21:04,410
so on try to ask them hey when's the

00:21:02,340 --> 00:21:06,630
last time you updated all the software

00:21:04,410 --> 00:21:09,770
it's not a question they like answering

00:21:06,630 --> 00:21:12,950
but it's an important one to ask again

00:21:09,770 --> 00:21:15,120
get rid of anything you're not using any

00:21:12,950 --> 00:21:16,560
applications that are not locked down if

00:21:15,120 --> 00:21:19,470
you're not using the application get rid

00:21:16,560 --> 00:21:21,450
of it if you are make sure that you

00:21:19,470 --> 00:21:23,970
don't have world readable config files

00:21:21,450 --> 00:21:25,350
world readable install directories get

00:21:23,970 --> 00:21:27,600
rid of the install directories if you

00:21:25,350 --> 00:21:29,520
can if you can't make sure they can't

00:21:27,600 --> 00:21:33,990
run we want to make sure that people

00:21:29,520 --> 00:21:36,060
can't access these types of files never

00:21:33,990 --> 00:21:38,790
ever ever let anyone on your server do

00:21:36,060 --> 00:21:42,030
this so I can't tell you how many times

00:21:38,790 --> 00:21:43,320
I have seen this back up method it's not

00:21:42,030 --> 00:21:45,450
a good backup method what you've just

00:21:43,320 --> 00:21:47,070
done is you've taken your PHP file and

00:21:45,450 --> 00:21:49,170
turned it into a text file which now

00:21:47,070 --> 00:21:51,300
easily displays in any browser and shows

00:21:49,170 --> 00:21:52,890
all of the code and all of the passwords

00:21:51,300 --> 00:21:56,640
and whatever else you have in there I'm

00:21:52,890 --> 00:21:59,010
never ever do this implement some sort

00:21:56,640 --> 00:22:00,690
of backup strategy if you have to back

00:21:59,010 --> 00:22:02,760
up like this don't leave those files on

00:22:00,690 --> 00:22:05,910
the server pull them off someplace that

00:22:02,760 --> 00:22:08,820
is locked down very well or encourage

00:22:05,910 --> 00:22:11,430
your clients to implement some sort of

00:22:08,820 --> 00:22:14,040
backup regimen that backs up off the

00:22:11,430 --> 00:22:15,480
server or uses say like version control

00:22:14,040 --> 00:22:19,740
or something like that as a backup

00:22:15,480 --> 00:22:21,000
strategy as opposed to using this double

00:22:19,740 --> 00:22:23,610
check all the codes you have on the

00:22:21,000 --> 00:22:24,500
server any code that's custom code that

00:22:23,610 --> 00:22:26,750
you can easily look

00:22:24,500 --> 00:22:28,910
if you're wondering what to check for in

00:22:26,750 --> 00:22:30,830
your code the next talk after lunch is

00:22:28,910 --> 00:22:32,390
going to be Eli white so I was kind of

00:22:30,830 --> 00:22:34,400
glad that my talk got moved before him

00:22:32,390 --> 00:22:37,760
because otherwise the slide was said I

00:22:34,400 --> 00:22:39,530
hope you went to Eli's talk so you can

00:22:37,760 --> 00:22:40,880
go to Eli's talk web security and you

00:22:39,530 --> 00:22:42,890
he's going to talk about how to lock

00:22:40,880 --> 00:22:44,360
down your code what kinds of attacks to

00:22:42,890 --> 00:22:46,370
watch for in your code and things like

00:22:44,360 --> 00:22:50,450
that so that's at two o'clock in the

00:22:46,370 --> 00:22:51,740
code base and deploy track once you've

00:22:50,450 --> 00:22:53,630
checked through all your code have

00:22:51,740 --> 00:22:55,340
someone else check it if you have

00:22:53,630 --> 00:22:57,140
multiple developers on your team it's

00:22:55,340 --> 00:22:59,780
good to have someone else review your

00:22:57,140 --> 00:23:02,060
code when we work with our code we know

00:22:59,780 --> 00:23:03,650
it so well we oftentimes miss things and

00:23:02,060 --> 00:23:04,910
having a fresh set of eyes come in and

00:23:03,650 --> 00:23:06,680
look at the code or even someone who

00:23:04,910 --> 00:23:08,810
just looks at things differently can

00:23:06,680 --> 00:23:10,460
really be beneficial if you don't have

00:23:08,810 --> 00:23:12,230
someone internally who can do a code

00:23:10,460 --> 00:23:14,300
review or if you are all too entrenched

00:23:12,230 --> 00:23:15,890
in the same code it's really nice to

00:23:14,300 --> 00:23:18,590
have someone who doesn't work with the

00:23:15,890 --> 00:23:20,150
code look at it so if if everyone on

00:23:18,590 --> 00:23:21,950
your team is too entrenched in the code

00:23:20,150 --> 00:23:23,690
there are security firms out there who

00:23:21,950 --> 00:23:26,780
will do a security audit of your code

00:23:23,690 --> 00:23:29,240
for you it's not cheap but it's much

00:23:26,780 --> 00:23:33,260
cheaper than getting hacked so take a

00:23:29,240 --> 00:23:35,150
look at those kinds of things be aware

00:23:33,260 --> 00:23:38,090
of the security vulnerabilities that are

00:23:35,150 --> 00:23:40,070
out there one great resource is the

00:23:38,090 --> 00:23:41,540
OWASP top ten project every year they

00:23:40,070 --> 00:23:44,300
come out and with the top ten

00:23:41,540 --> 00:23:46,370
vulnerabilities of the year so take a

00:23:44,300 --> 00:23:48,200
look you can go back multiple years if

00:23:46,370 --> 00:23:50,180
you do go back multiple years you'll

00:23:48,200 --> 00:23:52,070
notice a pattern a lot of the lists are

00:23:50,180 --> 00:23:54,040
very similar and that's because no

00:23:52,070 --> 00:23:56,060
matter how many times we talk about it

00:23:54,040 --> 00:23:58,460
these things these problems are not

00:23:56,060 --> 00:24:00,350
getting patched or fixed so take a look

00:23:58,460 --> 00:24:01,760
be aware of the top ten security

00:24:00,350 --> 00:24:03,860
vulnerabilities they have a lot of great

00:24:01,760 --> 00:24:05,720
resources links to articles about how to

00:24:03,860 --> 00:24:10,220
fix these things so it can be really

00:24:05,720 --> 00:24:12,290
helpful yes CSI PHP not specifically a

00:24:10,220 --> 00:24:14,840
security website but talking about bad

00:24:12,290 --> 00:24:16,940
code so the whole point of the website

00:24:14,840 --> 00:24:19,040
is investigating terrible code that

00:24:16,940 --> 00:24:22,520
they've found but what comes out through

00:24:19,040 --> 00:24:24,590
that is some great information about why

00:24:22,520 --> 00:24:26,930
shouldn't you do it this way what's a

00:24:24,590 --> 00:24:29,210
better way to do it and cleaning up bad

00:24:26,930 --> 00:24:31,670
code generally makes it more secure as

00:24:29,210 --> 00:24:33,470
well so take a look CSI PHP is a very

00:24:31,670 --> 00:24:36,140
fun website to go through and see these

00:24:33,470 --> 00:24:37,370
horrific code and then never mention to

00:24:36,140 --> 00:24:38,240
someone else that your code looks just

00:24:37,370 --> 00:24:43,550
like that legal

00:24:38,240 --> 00:24:45,470
lightly fix it so PHP developer org is

00:24:43,550 --> 00:24:47,870
sort of a news aggregator for PHP news

00:24:45,470 --> 00:24:49,190
if you're not familiar with it and they

00:24:47,870 --> 00:24:51,410
tag their articles and they have a

00:24:49,190 --> 00:24:54,050
security tag so if you go to PHP

00:24:51,410 --> 00:24:55,850
developer org slash tag / security

00:24:54,050 --> 00:24:57,410
you'll get their security articles

00:24:55,850 --> 00:24:59,450
there's feeds you can sign up for to be

00:24:57,410 --> 00:25:01,460
automatically notified it's a great way

00:24:59,450 --> 00:25:04,070
to sort of keep up on what security news

00:25:01,460 --> 00:25:05,929
is coming out what new hacks people are

00:25:04,070 --> 00:25:09,890
discovering what new ways there are to

00:25:05,929 --> 00:25:12,230
lock things down I apologize this slide

00:25:09,890 --> 00:25:14,150
is very small but it's meant for when

00:25:12,230 --> 00:25:16,010
you download my slides later but there

00:25:14,150 --> 00:25:18,770
are a lot of articles here about how to

00:25:16,010 --> 00:25:22,070
harden specific things there's a

00:25:18,770 --> 00:25:23,540
spider's simulator I recommend if you

00:25:22,070 --> 00:25:26,000
have been a victim of one of those

00:25:23,540 --> 00:25:28,550
search engine injection attacks you can

00:25:26,000 --> 00:25:31,460
run this spider simulator set up a cron

00:25:28,550 --> 00:25:33,230
job to run it or check it watch for

00:25:31,460 --> 00:25:34,910
those keywords in the spidered results

00:25:33,230 --> 00:25:38,270
and keep an eye out for that happening

00:25:34,910 --> 00:25:39,950
again also if you've been a victim and

00:25:38,270 --> 00:25:41,420
Google knows you were hacked and they've

00:25:39,950 --> 00:25:43,130
now marked you as a malicious site

00:25:41,420 --> 00:25:45,350
you'll have to sign up for their

00:25:43,130 --> 00:25:48,490
webmaster tools and require request that

00:25:45,350 --> 00:25:51,170
your site to be recalled or reevaluated

00:25:48,490 --> 00:25:52,880
it takes a long time to be reevaluated

00:25:51,170 --> 00:25:55,130
so the sooner you can get that

00:25:52,880 --> 00:25:57,260
requesting the better but make sure that

00:25:55,130 --> 00:26:00,470
your site is absolutely cleaned up

00:25:57,260 --> 00:26:02,330
before you request that crawl sometimes

00:26:00,470 --> 00:26:03,860
they do it instantly sometimes it's

00:26:02,330 --> 00:26:06,050
three or four weeks before they get to

00:26:03,860 --> 00:26:08,210
it and you never know so if you request

00:26:06,050 --> 00:26:11,000
it when you're almost done cleaning and

00:26:08,210 --> 00:26:12,470
they scan it right away next time it

00:26:11,000 --> 00:26:14,840
will be four weeks before they check it

00:26:12,470 --> 00:26:16,610
so you want to make sure you don't miss

00:26:14,840 --> 00:26:18,679
that window of opportunity with getting

00:26:16,610 --> 00:26:22,070
recalled Andrey qualified as a non

00:26:18,679 --> 00:26:24,440
malicious site so there's also some

00:26:22,070 --> 00:26:27,260
exploit scanners as I said there's the

00:26:24,440 --> 00:26:28,400
WordPress key generator if you are using

00:26:27,260 --> 00:26:30,530
wordpress and you've been hacked

00:26:28,400 --> 00:26:33,980
regenerate the wordpress keys as well as

00:26:30,530 --> 00:26:37,250
your ssh keys and so on so a lot of good

00:26:33,980 --> 00:26:38,870
resources here at this point i'd like to

00:26:37,250 --> 00:26:42,350
pause for a second and ask if anyone has

00:26:38,870 --> 00:26:46,970
any questions mm-hmm Oh am I supposed to

00:26:42,350 --> 00:26:49,850
ask you to wait for the mic is a

00:26:46,970 --> 00:26:51,180
specific to Linux but have you ever had

00:26:49,850 --> 00:26:55,230
success with our

00:26:51,180 --> 00:26:59,130
a hunter in finding the things that were

00:26:55,230 --> 00:27:01,200
installed on your site did you say RK

00:26:59,130 --> 00:27:04,260
hunter yeah i'm actually not familiar

00:27:01,200 --> 00:27:08,490
with RK hunter yes I I have not used it

00:27:04,260 --> 00:27:10,650
okay thank you yeah um is anyone else

00:27:08,490 --> 00:27:17,730
familiar with RK hunter comment on that

00:27:10,650 --> 00:27:20,040
Oh rootkit okay sorry I would thought

00:27:17,730 --> 00:27:23,960
you were saying like arcane like like

00:27:20,040 --> 00:27:27,360
very old arcane hunter and I'm like no

00:27:23,960 --> 00:27:30,570
that's okay yeah i'm also very nervous

00:27:27,360 --> 00:27:33,690
up here so people i speak slowly with me

00:27:30,570 --> 00:27:36,270
um so oh yeah go ahead sorry it's more

00:27:33,690 --> 00:27:38,100
of a comment than a question but you

00:27:36,270 --> 00:27:40,620
mentioned PHP files in the upload folder

00:27:38,100 --> 00:27:41,880
yes they should probably one of the

00:27:40,620 --> 00:27:43,200
first things you should do if you think

00:27:41,880 --> 00:27:45,090
you've been hacked is going your HT

00:27:43,200 --> 00:27:47,400
access and make sure PHP isn't running

00:27:45,090 --> 00:27:49,110
in any upload photos so you don't

00:27:47,400 --> 00:27:51,420
actually execute PHP outside of the

00:27:49,110 --> 00:27:54,840
photos that it should be in right that's

00:27:51,420 --> 00:27:58,140
an excellent point so yeah make sure and

00:27:54,840 --> 00:27:59,910
not just PHP if you have something in

00:27:58,140 --> 00:28:02,340
the uploads directory you shouldn't be

00:27:59,910 --> 00:28:04,470
allowing anything to run in there so a

00:28:02,340 --> 00:28:05,850
PHP is obviously a very specific one if

00:28:04,470 --> 00:28:09,060
you're dealing with WordPress and so on

00:28:05,850 --> 00:28:12,450
but upload directories nothing should

00:28:09,060 --> 00:28:14,070
really run in there yeah just a another

00:28:12,450 --> 00:28:15,570
little tip that I found quite useful

00:28:14,070 --> 00:28:17,910
quite a lot when you're grappling

00:28:15,570 --> 00:28:19,290
through the log files for you know these

00:28:17,910 --> 00:28:21,180
evals and things if you don't find

00:28:19,290 --> 00:28:23,940
anything sometimes I've found that

00:28:21,180 --> 00:28:25,470
looking for the time stamp or looking at

00:28:23,940 --> 00:28:27,840
the log entries of the timestamp of the

00:28:25,470 --> 00:28:29,520
files created can sometimes lead to not

00:28:27,840 --> 00:28:31,050
always but sometimes definitely

00:28:29,520 --> 00:28:33,570
definitely and when you're groping for

00:28:31,050 --> 00:28:34,890
the time grep for the sea time because

00:28:33,570 --> 00:28:36,840
that's the one they can't change well

00:28:34,890 --> 00:28:39,450
they can't change without rebooting the

00:28:36,840 --> 00:28:46,400
server so they probably haven't changed

00:28:39,450 --> 00:28:46,400
it questions is any of the other room

00:28:46,899 --> 00:28:59,240
any more questions specific question

00:28:56,529 --> 00:29:01,100
with with the tax are you finding their

00:28:59,240 --> 00:29:03,620
automated attacks or people actually

00:29:01,100 --> 00:29:05,509
going in and attacking automated as hack

00:29:03,620 --> 00:29:07,309
says that we sin are they mostly

00:29:05,509 --> 00:29:10,639
automated attacks or they people coming

00:29:07,309 --> 00:29:11,840
in sure I would say from my personal

00:29:10,639 --> 00:29:13,909
experience I don't I don't have any

00:29:11,840 --> 00:29:15,379
specific specific statistics but from my

00:29:13,909 --> 00:29:16,580
personal experience what I've seen is

00:29:15,379 --> 00:29:18,499
probably about eighty percent of the

00:29:16,580 --> 00:29:20,389
time it's automated they're just using

00:29:18,499 --> 00:29:22,369
your server to spend send out spam

00:29:20,389 --> 00:29:24,860
messages they're using you as a mail

00:29:22,369 --> 00:29:27,679
relay or they're using you as a brute

00:29:24,860 --> 00:29:29,119
force vector for someone else but about

00:29:27,679 --> 00:29:31,789
twenty percent of the time we found

00:29:29,119 --> 00:29:33,320
those admin panels and seen access times

00:29:31,789 --> 00:29:35,480
for those admin panels and things like

00:29:33,320 --> 00:29:37,999
that so in those cases I think it was an

00:29:35,480 --> 00:29:41,090
actual person but generally I think it

00:29:37,999 --> 00:29:42,980
most of the time it's automated it's

00:29:41,090 --> 00:29:47,200
just too time intensive to attack little

00:29:42,980 --> 00:29:47,200
sites and then do it all by hand so

00:29:53,710 --> 00:30:01,000
hi I I've got various applications and

00:29:57,510 --> 00:30:03,730
it looks a lot of requests to a variety

00:30:01,000 --> 00:30:06,309
of URLs trying to get into PHP my admin

00:30:03,730 --> 00:30:07,860
mm-hmm and I was just wondering is if

00:30:06,309 --> 00:30:11,020
there's anything you can do to sort of

00:30:07,860 --> 00:30:12,669
block repeated failed attempts to load

00:30:11,020 --> 00:30:14,770
pages that are obviously hacking

00:30:12,669 --> 00:30:16,840
attempts mm-hmm and it depends how much

00:30:14,770 --> 00:30:18,820
access you have to your server full

00:30:16,840 --> 00:30:21,250
access yes yeah so if you're on shared

00:30:18,820 --> 00:30:23,500
hosting you could ask them nicely to do

00:30:21,250 --> 00:30:26,200
it but whether or not they will is you

00:30:23,500 --> 00:30:28,000
know is a question but if you have

00:30:26,200 --> 00:30:30,490
access to your own server you can block

00:30:28,000 --> 00:30:32,289
request to those types of pages or what

00:30:30,490 --> 00:30:34,630
you can do is if someone requests a

00:30:32,289 --> 00:30:36,669
certain type of page that you know you

00:30:34,630 --> 00:30:38,710
don't have you can collect a lot more

00:30:36,669 --> 00:30:41,049
information on them send out notices and

00:30:38,710 --> 00:30:43,000
things like that so there are ways you

00:30:41,049 --> 00:30:44,289
can do it through like HT access or

00:30:43,000 --> 00:30:48,370
through server rules and things like

00:30:44,289 --> 00:30:51,010
that that you can block those yeah you

00:30:48,370 --> 00:30:52,600
can also have it sort of grab the IP and

00:30:51,010 --> 00:30:54,700
if they're requesting a file they

00:30:52,600 --> 00:30:56,529
shouldn't be accessing automatically

00:30:54,700 --> 00:30:58,630
block that IP right away well I thought

00:30:56,529 --> 00:31:00,370
about that but then IP addresses get

00:30:58,630 --> 00:31:02,559
reused so you might end up looking real

00:31:00,370 --> 00:31:04,120
visitors yes yeah although a real

00:31:02,559 --> 00:31:06,640
visitor will contact you and say I can't

00:31:04,120 --> 00:31:08,919
get to your site so it depends it

00:31:06,640 --> 00:31:11,320
depends how much you're getting attacked

00:31:08,919 --> 00:31:13,690
sometimes it's nice to have it

00:31:11,320 --> 00:31:15,399
automatically block right away and then

00:31:13,690 --> 00:31:17,799
notify you so that you can go back in

00:31:15,399 --> 00:31:19,600
and say a day later will you know

00:31:17,799 --> 00:31:21,730
release that IP address and that way

00:31:19,600 --> 00:31:23,289
you're blocking the three thousand

00:31:21,730 --> 00:31:25,990
requests that are about to come in in

00:31:23,289 --> 00:31:28,149
the next hour but you know 24 hours

00:31:25,990 --> 00:31:29,799
later depending on the hacker they've

00:31:28,149 --> 00:31:31,510
probably moved on to a new block of IP

00:31:29,799 --> 00:31:32,830
addresses because they know that the

00:31:31,510 --> 00:31:35,649
ones they used yesterday are not going

00:31:32,830 --> 00:31:37,480
to work anymore and so sometimes even

00:31:35,649 --> 00:31:40,059
just blocking it for a day or a week or

00:31:37,480 --> 00:31:42,789
something allows for the reuse for real

00:31:40,059 --> 00:31:44,590
users but blocks at least that initial

00:31:42,789 --> 00:31:51,340
attack vector to protect your server

00:31:44,590 --> 00:31:55,110
from being overwhelmed Thanks mm-hmm did

00:31:51,340 --> 00:31:55,110
you have a question over here no okay

00:31:56,840 --> 00:32:02,270
I just going back onto the IP blockings

00:31:59,840 --> 00:32:05,539
quite popular service called cloudflare

00:32:02,270 --> 00:32:07,909
which a Conway cloudflare cloudflare yes

00:32:05,539 --> 00:32:11,510
glad fly welcome they do free tier and

00:32:07,909 --> 00:32:12,950
you know premium but one of the things

00:32:11,510 --> 00:32:15,020
that they do is they use the OWASP

00:32:12,950 --> 00:32:18,559
project which i believe maintains a list

00:32:15,020 --> 00:32:20,750
of known IP addresses worldwide okay and

00:32:18,559 --> 00:32:25,070
they use that as an upstream list into

00:32:20,750 --> 00:32:26,870
cloud flares system okay and you you set

00:32:25,070 --> 00:32:28,970
your name servers to cloudflare nor your

00:32:26,870 --> 00:32:30,529
traffic goes through CloudFlare first

00:32:28,970 --> 00:32:32,240
and then it's reverse proxy to your

00:32:30,529 --> 00:32:35,179
server okay and because they let

00:32:32,240 --> 00:32:37,220
maintain that active list of of IPs hmm

00:32:35,179 --> 00:32:38,690
I'm actually filters a lot of requests

00:32:37,220 --> 00:32:41,240
before they get to your server in the

00:32:38,690 --> 00:32:43,340
first place so I find that that helps if

00:32:41,240 --> 00:32:45,440
you've got a site has been heavily

00:32:43,340 --> 00:32:46,789
accessed by BOTS do you ever notice any

00:32:45,440 --> 00:32:49,100
performance decline because of that

00:32:46,789 --> 00:32:54,710
redirect um yes specifically when

00:32:49,100 --> 00:32:56,840
CloudFlare goes down yes okay I mean it

00:32:54,710 --> 00:32:59,210
did happen in the past em they do a lot

00:32:56,840 --> 00:33:00,470
of rebooting now across datacenters so

00:32:59,210 --> 00:33:02,149
you do get a bit of latency if your

00:33:00,470 --> 00:33:04,159
traffic goes that was the US and back

00:33:02,149 --> 00:33:07,789
again so and it does seem a lot more

00:33:04,159 --> 00:33:09,440
reliable recently okay um I think it is

00:33:07,789 --> 00:33:11,720
a personal this isn't whether you use it

00:33:09,440 --> 00:33:14,120
or not I think it depends to what your

00:33:11,720 --> 00:33:16,010
risk level is if you are being hacked a

00:33:14,120 --> 00:33:18,409
lot then the performance decline is

00:33:16,010 --> 00:33:19,940
probably worth it if you're if you've

00:33:18,409 --> 00:33:22,190
never been hacked and you probably won't

00:33:19,940 --> 00:33:24,200
be maybe the performance hit isn't going

00:33:22,190 --> 00:33:26,480
to be worth it but yeah that's

00:33:24,200 --> 00:33:30,409
interesting personally I use a iptables

00:33:26,480 --> 00:33:31,789
rate-limiting mm-hmm we just check the

00:33:30,409 --> 00:33:34,070
second room are there any questions in

00:33:31,789 --> 00:33:38,830
the second room oh there's a second room

00:33:34,070 --> 00:33:42,669
there's a whole set hello second room

00:33:38,830 --> 00:33:47,059
hello i was wondering if you ever see

00:33:42,669 --> 00:33:49,399
people running say wordpress on a very

00:33:47,059 --> 00:33:52,820
lockdown site so you edit your wordpress

00:33:49,399 --> 00:33:56,840
and then push static HTML to your kind

00:33:52,820 --> 00:33:59,059
of production server so does that make

00:33:56,840 --> 00:34:03,760
sense so you what people see is just

00:33:59,059 --> 00:34:06,230
static HTML with observer with no PHP or

00:34:03,760 --> 00:34:08,419
and then the WordPress is locked down in

00:34:06,230 --> 00:34:09,770
the background yeah I have not seen

00:34:08,419 --> 00:34:11,990
people do that specifically with

00:34:09,770 --> 00:34:14,149
WordPress but there are different

00:34:11,990 --> 00:34:15,349
generators out there where you can run a

00:34:14,149 --> 00:34:18,290
dynamic site in the background and

00:34:15,349 --> 00:34:20,359
they'll generate HTML for you I've seen

00:34:18,290 --> 00:34:23,419
a quite a few sites using like sculpin

00:34:20,359 --> 00:34:26,089
and things like that the problem with

00:34:23,419 --> 00:34:27,950
that is even if you're only sending the

00:34:26,089 --> 00:34:30,740
generated HTML to the server if your

00:34:27,950 --> 00:34:32,330
WordPress site gets hacked it it's going

00:34:30,740 --> 00:34:35,240
into the HTML and still going out

00:34:32,330 --> 00:34:37,609
especially if they're doing say the

00:34:35,240 --> 00:34:42,349
search engine injection that's going to

00:34:37,609 --> 00:34:44,450
come through in your static HTML so I

00:34:42,349 --> 00:34:46,639
don't it depends how much you can lock

00:34:44,450 --> 00:34:49,659
down WordPress if you can make it non

00:34:46,639 --> 00:34:55,070
web accessible that might be handy but I

00:34:49,659 --> 00:34:56,210
yeah hi so this is actually answer to a

00:34:55,070 --> 00:34:59,119
previous question when we're talking

00:34:56,210 --> 00:35:01,339
about rate limiting and that sort of

00:34:59,119 --> 00:35:03,650
stuff on Linux there's this really

00:35:01,339 --> 00:35:06,680
really good program called fail2ban and

00:35:03,650 --> 00:35:08,330
it can analyze log files and you can

00:35:06,680 --> 00:35:10,369
basically configure it to look for

00:35:08,330 --> 00:35:13,580
specific things so with a lot of these

00:35:10,369 --> 00:35:15,230
automated attacks when you see how many

00:35:13,580 --> 00:35:19,700
requests coming from a specific IP

00:35:15,230 --> 00:35:20,990
failed to battle then and that IP for 20

00:35:19,700 --> 00:35:22,670
minutes or so and that should be long

00:35:20,990 --> 00:35:24,859
enough for the automated bot to then

00:35:22,670 --> 00:35:27,020
move on and then it will unbanned the

00:35:24,859 --> 00:35:29,359
IPS again so it's a really good way to

00:35:27,020 --> 00:35:31,430
stop those kind of attacks good thanks

00:35:29,359 --> 00:35:32,690
for sharing um did that answer the

00:35:31,430 --> 00:35:34,849
question in the other room I just

00:35:32,690 --> 00:35:36,770
realized we should check first did that

00:35:34,849 --> 00:35:39,619
yep yes okay good we have another

00:35:36,770 --> 00:35:43,280
question okay wonderful another

00:35:39,619 --> 00:35:45,020
disembodied voice from the sky high have

00:35:43,280 --> 00:35:47,270
you ever had any personal experience

00:35:45,020 --> 00:35:48,369
working with mod of a Civ and mod

00:35:47,270 --> 00:35:51,009
security

00:35:48,369 --> 00:35:52,990
on the Apache level and what were you

00:35:51,009 --> 00:35:54,579
seeing any performance degradation and

00:35:52,990 --> 00:35:56,740
how far would you go with those kind of

00:35:54,579 --> 00:35:58,420
measures I'm so curious can you repeat

00:35:56,740 --> 00:36:00,789
the last part of the question it got a

00:35:58,420 --> 00:36:03,339
little quiet how far would you go with

00:36:00,789 --> 00:36:05,259
securing a site using mod evasive and

00:36:03,339 --> 00:36:06,789
modsecurity given the performance

00:36:05,259 --> 00:36:10,210
implications gotcha given the

00:36:06,789 --> 00:36:11,920
performance implications so with those

00:36:10,210 --> 00:36:14,650
kinds of things again you need to take a

00:36:11,920 --> 00:36:16,539
look at what are you users willing to

00:36:14,650 --> 00:36:18,730
put up with on the front end as far as

00:36:16,539 --> 00:36:21,069
performance hits some websites are more

00:36:18,730 --> 00:36:23,470
tolerant to perform it slow downs than

00:36:21,069 --> 00:36:26,079
others you need to take a look at your

00:36:23,470 --> 00:36:29,079
risk if your website is hacked do you

00:36:26,079 --> 00:36:30,880
have three people who might see

00:36:29,079 --> 00:36:32,859
something that they shouldn't for a

00:36:30,880 --> 00:36:34,630
little while or do you have a million

00:36:32,859 --> 00:36:36,519
people who are losing their financial

00:36:34,630 --> 00:36:38,859
data so you need to take a look at what

00:36:36,519 --> 00:36:41,049
your risk is and I think it needs to

00:36:38,859 --> 00:36:42,400
sort of be a case-by-case decision as to

00:36:41,049 --> 00:36:45,279
whether or not the performance hit is

00:36:42,400 --> 00:36:49,089
worth locking it down some some places

00:36:45,279 --> 00:36:51,940
are very tolerant of you know ok so my

00:36:49,089 --> 00:36:53,619
blog got hacked I have some good you

00:36:51,940 --> 00:36:55,630
know Google gets some bad information

00:36:53,619 --> 00:36:58,989
about me but three people read my blog a

00:36:55,630 --> 00:37:00,730
year so who cares whereas you know I

00:36:58,989 --> 00:37:03,369
would hope my bank is much less

00:37:00,730 --> 00:37:06,549
tolerance of you know hacks and things

00:37:03,369 --> 00:37:08,130
like that so I I think that if if you're

00:37:06,549 --> 00:37:10,390
dealing with secure information

00:37:08,130 --> 00:37:12,489
personally identifying information about

00:37:10,390 --> 00:37:14,200
your users financial information medical

00:37:12,489 --> 00:37:15,430
information those kinds of things then I

00:37:14,200 --> 00:37:17,109
think it's definitely worth the

00:37:15,430 --> 00:37:19,329
performance hit to lock things down as

00:37:17,109 --> 00:37:21,039
much as you can however not all

00:37:19,329 --> 00:37:22,960
industries are tolerant of that so you

00:37:21,039 --> 00:37:25,420
need to sort of evaluate the risk versus

00:37:22,960 --> 00:37:27,940
the benefits does that answer that

00:37:25,420 --> 00:37:29,890
question can you see have you had any

00:37:27,940 --> 00:37:32,140
experience working with mod evasive and

00:37:29,890 --> 00:37:34,239
modsecurity to lockdown machines to

00:37:32,140 --> 00:37:35,589
prevent these kind of attacks I've

00:37:34,239 --> 00:37:38,940
worked with mod security but not my

00:37:35,589 --> 00:37:41,739
divisive okay what was your experience

00:37:38,940 --> 00:37:44,710
did you find that it blocks the majority

00:37:41,739 --> 00:37:47,680
of attacks that you just described the

00:37:44,710 --> 00:37:51,190
vectors that you just listed so far so

00:37:47,680 --> 00:37:54,400
good yeah I found that generally sort of

00:37:51,190 --> 00:37:56,349
like the the injection hacks for search

00:37:54,400 --> 00:37:57,940
engines and the WordPress hacks and

00:37:56,349 --> 00:37:58,740
things like that it definitely cut down

00:37:57,940 --> 00:38:00,840
on that

00:37:58,740 --> 00:38:02,580
as I said so far so good I can't

00:38:00,840 --> 00:38:06,320
guarantee it's going to work forever but

00:38:02,580 --> 00:38:10,950
so far so good on using mod security but

00:38:06,320 --> 00:38:12,750
it's one of those things again it's only

00:38:10,950 --> 00:38:14,610
good enough until somebody figures out

00:38:12,750 --> 00:38:16,140
how to get around it so you can't claim

00:38:14,610 --> 00:38:19,200
to be secure but it definitely has

00:38:16,140 --> 00:38:21,450
helped so I think you can if you can

00:38:19,200 --> 00:38:31,470
convince the users to go with it give it

00:38:21,450 --> 00:38:33,660
a try more questions Oh again um it's

00:38:31,470 --> 00:38:35,700
just a wordpress specific one the word

00:38:33,660 --> 00:38:38,580
fence plugin have you come across that

00:38:35,700 --> 00:38:44,670
one I'm so the white word fence word

00:38:38,580 --> 00:38:48,000
fence word fence yeah Oh fence okay yeah

00:38:44,670 --> 00:38:51,600
it's a relatively new one but that uses

00:38:48,000 --> 00:38:54,330
I think it's the feejee network but it

00:38:51,600 --> 00:38:56,040
pulls all the WordPress installations

00:38:54,330 --> 00:38:59,070
that have the word fence plug-in

00:38:56,040 --> 00:39:02,430
installed and it uses them to help

00:38:59,070 --> 00:39:04,020
maintain lists of incoming IP addresses

00:39:02,430 --> 00:39:06,450
that are trying to take advantage of

00:39:04,020 --> 00:39:08,550
attack vectors and it helps communicate

00:39:06,450 --> 00:39:10,920
over across fidgets network so it's kind

00:39:08,550 --> 00:39:13,109
of like a cloud-based similar to glad

00:39:10,920 --> 00:39:17,190
Flair okay but you actually host it on

00:39:13,109 --> 00:39:18,690
your instance is free to use and you can

00:39:17,190 --> 00:39:21,180
configure there was a question earlier

00:39:18,690 --> 00:39:22,890
about automated for a for blocking after

00:39:21,180 --> 00:39:25,140
a certain number of requests you can set

00:39:22,890 --> 00:39:27,090
you know whether it's five requests and

00:39:25,140 --> 00:39:29,280
then you can choose to block them out

00:39:27,090 --> 00:39:32,550
for five minutes or personalities to

00:39:29,280 --> 00:39:34,680
block them out for two months and that

00:39:32,550 --> 00:39:36,240
really helps bring down a lot of traffic

00:39:34,680 --> 00:39:38,880
it's also a really good feature which is

00:39:36,240 --> 00:39:40,980
live traffic feed and you can either

00:39:38,880 --> 00:39:42,750
look at every incoming request or you

00:39:40,980 --> 00:39:45,300
can filter out bars and just look at

00:39:42,750 --> 00:39:46,740
humans or just look at BOTS okay and

00:39:45,300 --> 00:39:50,850
it's also got a feature for blocking

00:39:46,740 --> 00:39:54,359
fake google crawlers which is really um

00:39:50,850 --> 00:39:56,070
that's very helpful excellent um one

00:39:54,359 --> 00:39:58,950
quick question on that so then does it

00:39:56,070 --> 00:40:00,390
also look at ok so these sites on our

00:39:58,950 --> 00:40:02,040
network were hacked and these are the

00:40:00,390 --> 00:40:03,300
files that were injected do they take a

00:40:02,040 --> 00:40:05,520
look at that at all watching for those

00:40:03,300 --> 00:40:06,910
files it's it has got a file scanner

00:40:05,520 --> 00:40:09,039
which is optional

00:40:06,910 --> 00:40:12,160
the way their works is itself schedules

00:40:09,039 --> 00:40:14,650
but it the schedule is done by the cloud

00:40:12,160 --> 00:40:18,069
on the free tier or you can do a

00:40:14,650 --> 00:40:20,079
schedule manually if you pay for it but

00:40:18,069 --> 00:40:22,960
it does scan for common vulnerabilities

00:40:20,079 --> 00:40:25,390
and the databases is held at feedjit so

00:40:22,960 --> 00:40:27,910
as vulnerabilities are found it's but on

00:40:25,390 --> 00:40:29,980
to the database and then the next scan

00:40:27,910 --> 00:40:31,720
that's scheduled in it will search your

00:40:29,980 --> 00:40:34,180
files so it searches your themes you

00:40:31,720 --> 00:40:36,250
plug into the core files one excellent

00:40:34,180 --> 00:40:38,619
feature is that for all plugins it

00:40:36,250 --> 00:40:41,530
compares the source code on disk against

00:40:38,619 --> 00:40:43,930
the latest svn repository version or the

00:40:41,530 --> 00:40:45,339
version that you have on disk and if

00:40:43,930 --> 00:40:47,200
there's any change it will actually

00:40:45,339 --> 00:40:52,150
bring up send you an e-mail show you a

00:40:47,200 --> 00:40:54,010
diff oh nice and also for core files and

00:40:52,150 --> 00:40:56,170
it pings you for when you know WordPress

00:40:54,010 --> 00:40:57,400
version is released it compares the

00:40:56,170 --> 00:41:00,760
latest version against yours okay

00:40:57,400 --> 00:41:02,020
Saturday tells you so to be honest it's

00:41:00,760 --> 00:41:04,420
been the best security plugin i found

00:41:02,020 --> 00:41:06,819
for wordpress so far is it a free plugin

00:41:04,420 --> 00:41:08,920
is a free plugin it's another freemium

00:41:06,819 --> 00:41:11,970
booking so you've got more features if

00:41:08,920 --> 00:41:14,230
you pay a certain amount okay thank you

00:41:11,970 --> 00:41:15,640
this is why I love this discussion time

00:41:14,230 --> 00:41:25,150
because I find out Oh next time I'm

00:41:15,640 --> 00:41:27,220
going to use that that was jit questions

00:41:25,150 --> 00:41:30,089
in this room anymore any further and

00:41:27,220 --> 00:41:36,150
that last one was called cloud fence

00:41:30,089 --> 00:41:36,150
word for word fence okay sounds great

00:41:38,339 --> 00:41:45,819
okay wonderful okay I have a couple more

00:41:43,180 --> 00:41:46,930
slides so I'll just finish up my slides

00:41:45,819 --> 00:41:48,430
and then we can do more questions if

00:41:46,930 --> 00:41:50,230
you'd like I just want to make sure I

00:41:48,430 --> 00:41:53,260
get through all the slides I don't have

00:41:50,230 --> 00:41:55,809
that many left but um so my last plug

00:41:53,260 --> 00:42:00,549
for my magazine I'm incredibly biased

00:41:55,809 --> 00:42:02,500
but it's the best PHP magazine ever so

00:42:00,549 --> 00:42:04,240
stop by take a look at the copies this

00:42:02,500 --> 00:42:05,380
is a coupon code if you'd like to use it

00:42:04,240 --> 00:42:07,119
twenty five percent off a new

00:42:05,380 --> 00:42:09,460
subscription and i will say that that

00:42:07,119 --> 00:42:11,289
includes the print copy we are printing

00:42:09,460 --> 00:42:13,119
in journal style so it's a very very

00:42:11,289 --> 00:42:15,970
nice printed copy it's a little

00:42:13,119 --> 00:42:17,859
expensive here in the UK I apologize we

00:42:15,970 --> 00:42:20,500
ship it out of the US but we are

00:42:17,859 --> 00:42:22,839
investigating a shipping and printing

00:42:20,500 --> 00:42:24,760
facility in Europe and we're hoping to

00:42:22,839 --> 00:42:27,069
get that up and running as soon as we

00:42:24,760 --> 00:42:29,109
can no promises on one that will happen

00:42:27,069 --> 00:42:30,760
but we're working on that so then we

00:42:29,109 --> 00:42:33,420
could ship from here which will make it

00:42:30,760 --> 00:42:38,799
significantly cheaper for you guys but

00:42:33,420 --> 00:42:40,869
for now take a look at the issue here so

00:42:38,799 --> 00:42:42,910
you can find me on Twitter III besties

00:42:40,869 --> 00:42:44,799
if you come across a new security

00:42:42,910 --> 00:42:47,289
plug-in or tool I would love to hear

00:42:44,799 --> 00:42:49,150
about it I clean up hacked websites all

00:42:47,289 --> 00:42:51,970
the time and I'm always looking for new

00:42:49,150 --> 00:42:55,269
tools to use here's my slides link so

00:42:51,970 --> 00:42:56,680
tree line design com / slides and I did

00:42:55,269 --> 00:42:58,329
upload the slides right before the talks

00:42:56,680 --> 00:43:00,190
started so they are currently there if

00:42:58,329 --> 00:43:02,789
you'd like to download them and I will

00:43:00,190 --> 00:43:05,799
also add the slides link to joined in

00:43:02,789 --> 00:43:08,650
small plug for where I teach we have a

00:43:05,799 --> 00:43:10,569
security course so if you like Eli's

00:43:08,650 --> 00:43:13,869
talk we have a much more in-depth course

00:43:10,569 --> 00:43:15,789
on PHP security as well and please give

00:43:13,869 --> 00:43:17,559
me feedback on joined in here's my

00:43:15,789 --> 00:43:20,349
joined in link otherwise if you go to

00:43:17,559 --> 00:43:22,720
joined in PHP UK last time I checked

00:43:20,349 --> 00:43:25,809
this morning was at the top and you can

00:43:22,720 --> 00:43:27,309
find my talk in there as speakers we

00:43:25,809 --> 00:43:29,109
really really evaluate value the

00:43:27,309 --> 00:43:31,210
feedback we give these talks multiple

00:43:29,109 --> 00:43:32,650
times and any improvements you have

00:43:31,210 --> 00:43:34,299
suggestions for we would love to make

00:43:32,650 --> 00:43:35,799
them if you're not comfortable giving

00:43:34,299 --> 00:43:37,950
the feedback on joined in here's my

00:43:35,799 --> 00:43:40,750
email address beset Musketeers dot meet

00:43:37,950 --> 00:43:43,990
also if you come across a cool hack that

00:43:40,750 --> 00:43:45,789
you find I'd love to see it um I collect

00:43:43,990 --> 00:43:48,519
hacked files if you'd like to see any of

00:43:45,789 --> 00:43:50,560
the hacked files I have copies so drop

00:43:48,519 --> 00:43:52,750
me an email and I'll find a way to

00:43:50,560 --> 00:43:56,260
you sort of send them to you without

00:43:52,750 --> 00:43:59,110
sending them to you so yeah so feel free

00:43:56,260 --> 00:44:00,730
to pass the information alone all right

00:43:59,110 --> 00:44:03,690
thank you very much and I'll be around

00:44:00,730 --> 00:44:03,690

YouTube URL: https://www.youtube.com/watch?v=PIligSGxAA8


