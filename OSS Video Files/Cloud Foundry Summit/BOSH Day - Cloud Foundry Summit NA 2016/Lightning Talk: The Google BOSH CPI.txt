Title: Lightning Talk: The Google BOSH CPI
Publication date: 2016-05-30
Playlist: BOSH Day - Cloud Foundry Summit NA 2016
Description: 
	Eric Johnson, Technical Program Manager at Google, presents his Lightning Talk: "The Google BOSH CPI."
Captions: 
	00:00:00,060 --> 00:00:08,849
everybody so I am NOT Evan Brown does

00:00:05,250 --> 00:00:10,559
anybody know Evan Brown by chance couple

00:00:08,849 --> 00:00:11,730
people okay so I haven't is the one

00:00:10,559 --> 00:00:13,620
that's actually doing most of the work

00:00:11,730 --> 00:00:15,450
on this so he couldn't make it but I'm

00:00:13,620 --> 00:00:18,180
filling in for him so but I wanted to

00:00:15,450 --> 00:00:20,550
put his name up there and I guess a

00:00:18,180 --> 00:00:22,890
little bit about me I run a small team

00:00:20,550 --> 00:00:24,660
at Google cloud working on open source

00:00:22,890 --> 00:00:27,060
integrations and so recently we've

00:00:24,660 --> 00:00:29,460
gotten involved with pivotal and Cloud

00:00:27,060 --> 00:00:31,529
Foundry and Bosh so I'll talk a little

00:00:29,460 --> 00:00:36,270
bit about Bosh CPI work what we've done

00:00:31,529 --> 00:00:39,239
so far so a little history about the

00:00:36,270 --> 00:00:42,899
Bosh CPI how many people have heard of

00:00:39,239 --> 00:00:46,500
Ferdie well that was a mistake how many

00:00:42,899 --> 00:00:49,770
people have not heard of Ferdie yeah

00:00:46,500 --> 00:00:52,260
okay there's two or three maybe so

00:00:49,770 --> 00:00:53,910
Ferdie actually so I only went back

00:00:52,260 --> 00:00:55,860
about a year but actually the history of

00:00:53,910 --> 00:00:57,629
this goes back even further than that so

00:00:55,860 --> 00:00:59,910
the very first time that Ferdie fiddle

00:00:57,629 --> 00:01:01,680
fiddled around with creating a box CPI

00:00:59,910 --> 00:01:04,439
was back in Ruby

00:01:01,680 --> 00:01:06,869
last year he decided hey you know I want

00:01:04,439 --> 00:01:09,689
to learn how to play with go so he had a

00:01:06,869 --> 00:01:13,110
little small 20% project to develop the

00:01:09,689 --> 00:01:14,430
CPI for google written in go and then

00:01:13,110 --> 00:01:16,950
you can see it kind of sat there for a

00:01:14,430 --> 00:01:18,659
few months or more than that and then

00:01:16,950 --> 00:01:21,420
that's roughly when Google kind of

00:01:18,659 --> 00:01:23,280
started getting engaged and we had one

00:01:21,420 --> 00:01:24,799
of our solutions architects kind of

00:01:23,280 --> 00:01:26,700
starting to work with Ferdie just to

00:01:24,799 --> 00:01:28,439
brainstorm a few things that we might

00:01:26,700 --> 00:01:30,000
make some improvements on and then it

00:01:28,439 --> 00:01:31,770
wasn't until really about a month and a

00:01:30,000 --> 00:01:33,210
half two months ago where Evan and I

00:01:31,770 --> 00:01:35,670
really started to get involved we came

00:01:33,210 --> 00:01:38,240
down we got with pivotal talked a lot

00:01:35,670 --> 00:01:40,759
about what we could do with with the CPI

00:01:38,240 --> 00:01:43,020
so that's kind of where we're at today

00:01:40,759 --> 00:01:44,880
there's a link to it you can go check it

00:01:43,020 --> 00:01:46,680
out we've got instructions for how to go

00:01:44,880 --> 00:01:50,880
ahead and get it started up with Bosch

00:01:46,680 --> 00:01:52,470
in it and everything so I'll talk a

00:01:50,880 --> 00:01:55,560
little bit about the features that are

00:01:52,470 --> 00:01:58,140
in there we've got I don't see the

00:01:55,560 --> 00:01:59,520
slides down here so some of this stuff

00:01:58,140 --> 00:02:01,229
would be sound a little different

00:01:59,520 --> 00:02:03,210
because you maybe not are familiar with

00:02:01,229 --> 00:02:04,860
some of the compute engine features one

00:02:03,210 --> 00:02:07,140
of the things that we did was we we

00:02:04,860 --> 00:02:09,479
removed the Bosch registry and we

00:02:07,140 --> 00:02:13,550
replaced that with GCE metadata service

00:02:09,479 --> 00:02:16,200
so what's different about oh thanks

00:02:13,550 --> 00:02:19,560
on behalf of Evan

00:02:16,200 --> 00:02:21,120
so GCE has writable metadata so it's a

00:02:19,560 --> 00:02:23,580
good way to sort of pass information

00:02:21,120 --> 00:02:24,959
back around between the virtual machines

00:02:23,580 --> 00:02:27,060
that are in the environment and the

00:02:24,959 --> 00:02:29,040
director so that's one of the changes

00:02:27,060 --> 00:02:31,320
that we made and I think that that was

00:02:29,040 --> 00:02:32,760
you know suggested by either Ferdie or

00:02:31,320 --> 00:02:33,720
Dmitriy or somebody like that that that

00:02:32,760 --> 00:02:35,190
would be a good way to make this a

00:02:33,720 --> 00:02:38,390
little bit more scalable and resilient

00:02:35,190 --> 00:02:41,030
and leverage some of the infrastructure

00:02:38,390 --> 00:02:43,770
innovations that we've made with GCE

00:02:41,030 --> 00:02:46,200
manual networks has just recently gone

00:02:43,770 --> 00:02:47,760
in and being able to specify private IP

00:02:46,200 --> 00:02:49,230
so this was a new feature that would

00:02:47,760 --> 00:02:53,220
just rolled out not too long ago

00:02:49,230 --> 00:02:55,260
we've got subnets sub networks in GCE as

00:02:53,220 --> 00:02:57,450
well so all of those things have now

00:02:55,260 --> 00:03:01,110
made it back into the CPI and it's

00:02:57,450 --> 00:03:02,610
actually merged in work-in-progress so

00:03:01,110 --> 00:03:04,410
this is kind of one of the things that

00:03:02,610 --> 00:03:07,620
Evan has been spending a lot of time on

00:03:04,410 --> 00:03:08,910
recently is how do we use GCE S load

00:03:07,620 --> 00:03:12,060
balancer and make it kind of look like

00:03:08,910 --> 00:03:14,100
it behaves like I'm on other cloud

00:03:12,060 --> 00:03:16,230
providers so we've gone through and

00:03:14,100 --> 00:03:19,260
we've used our layer 7 load balancer

00:03:16,230 --> 00:03:21,299
which does URL routing but that stuff's

00:03:19,260 --> 00:03:23,220
not really exposed yet but it all gets

00:03:21,299 --> 00:03:24,930
plumbed back through into Bosh so that

00:03:23,220 --> 00:03:28,230
when instances come up they join these

00:03:24,930 --> 00:03:29,640
the load balancer automatically disk

00:03:28,230 --> 00:03:31,890
attached with improvements things like

00:03:29,640 --> 00:03:34,230
that that we're still working on to do I

00:03:31,890 --> 00:03:36,480
went through Bosh training and realized

00:03:34,230 --> 00:03:38,220
like boch SSH doesn't work so there's a

00:03:36,480 --> 00:03:39,690
lot of little probably pain points that

00:03:38,220 --> 00:03:41,790
we're still finding as we go through

00:03:39,690 --> 00:03:43,530
this every and I will actually be here

00:03:41,790 --> 00:03:45,870
next week working with pivotal to kind

00:03:43,530 --> 00:03:47,250
of identify some more of these potholes

00:03:45,870 --> 00:03:50,610
and come up with a punch list of things

00:03:47,250 --> 00:03:52,140
to work on blobstore and GCS probably

00:03:50,610 --> 00:03:55,170
just works out of the box we have an s3

00:03:52,140 --> 00:03:58,049
compatibility mode on GCS so that should

00:03:55,170 --> 00:04:00,269
be an easy one pivotal is building a

00:03:58,049 --> 00:04:02,489
prototype GCE stem cells right now so

00:04:00,269 --> 00:04:05,100
all of that's going really well

00:04:02,489 --> 00:04:07,860
we've got the Concours pipeline set up

00:04:05,100 --> 00:04:10,680
we build and release the CPI we also do

00:04:07,860 --> 00:04:13,320
a light stem cell we pull the heavy stem

00:04:10,680 --> 00:04:15,420
cell across from s3 that pivotal builds

00:04:13,320 --> 00:04:17,880
and we drop that into GCS so as you spin

00:04:15,420 --> 00:04:21,430
this stuff up on GCE you've already got

00:04:17,880 --> 00:04:23,840
that stuff inside of Google's Network

00:04:21,430 --> 00:04:26,390
we went through added a whole suite of

00:04:23,840 --> 00:04:28,220
live integration tests on that so takes

00:04:26,390 --> 00:04:29,540
about an hour to run cost you like $20

00:04:28,220 --> 00:04:31,730
or something so maybe you don't want to

00:04:29,540 --> 00:04:35,720
do that as a starting point and then

00:04:31,730 --> 00:04:37,160
we're also passing baths so I want to

00:04:35,720 --> 00:04:39,470
tell you a little bit about Google

00:04:37,160 --> 00:04:41,420
compute engine so I'll keep it kind of

00:04:39,470 --> 00:04:44,120
short there's a couple cute thing or

00:04:41,420 --> 00:04:45,230
cute nice things I'd say that I want to

00:04:44,120 --> 00:04:47,690
call to your attention so one of the

00:04:45,230 --> 00:04:49,460
things is we have discrete machine sizes

00:04:47,690 --> 00:04:52,730
but we also have customizable machine

00:04:49,460 --> 00:04:54,680
sizes so if what we have as static

00:04:52,730 --> 00:04:56,450
representations in terms of CPU and

00:04:54,680 --> 00:04:58,010
memory doesn't fit your needs you can

00:04:56,450 --> 00:05:01,490
actually customize that and create your

00:04:58,010 --> 00:05:03,290
own advanced networking so I was telling

00:05:01,490 --> 00:05:04,730
you a little bit about that the load

00:05:03,290 --> 00:05:06,290
balancer that you would spin up in front

00:05:04,730 --> 00:05:07,670
of your cloud foundry instance is the

00:05:06,290 --> 00:05:10,220
same load balancer that we use

00:05:07,670 --> 00:05:12,800
internally for Gmail YouTube Maps all of

00:05:10,220 --> 00:05:16,580
that stuff so because a lot of power

00:05:12,800 --> 00:05:18,080
there and in terms of our networking and

00:05:16,580 --> 00:05:20,150
then also talked about like how much

00:05:18,080 --> 00:05:22,670
cheaper it is it's a sustained use

00:05:20,150 --> 00:05:26,420
pricing so the longer these instances

00:05:22,670 --> 00:05:28,100
run the cheaper they get and lastly this

00:05:26,420 --> 00:05:30,920
is where you can find B if you have

00:05:28,100 --> 00:05:32,630
questions and then also like urge you to

00:05:30,920 --> 00:05:34,550
get started with a free trial and then

00:05:32,630 --> 00:05:37,220
there's also the link to the repo again

00:05:34,550 --> 00:05:38,840
so that's it I'm out of time next up is

00:05:37,220 --> 00:05:44,749
two sharp

00:05:38,840 --> 00:05:44,749

YouTube URL: https://www.youtube.com/watch?v=ceG-9FLZIK8


