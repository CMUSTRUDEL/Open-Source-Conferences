Title: Peter Berkenbosch - Solidus Internals, an adventure through less known features | SolidusConf 2019
Publication date: 2019-12-06
Playlist: SolidusConf 2019
Description: 
	Peter explores some of the less known features of Solidus.

"Solidus Internals, an adventure through less known features"
Exploring some of the less known features and configuration hooks in Solidus and how you can use these to extend and customise your storefront while still keeping Solidus as vanilla as possible.

Learn more about Solidus at solidus.io
Captions: 
	00:00:02,130 --> 00:00:05,160
[Music]

00:00:09,170 --> 00:00:13,690
[Music]

00:00:10,809 --> 00:00:16,660
oh the last one on Monday always fun

00:00:13,690 --> 00:00:19,419
probably won't take that long I'm known

00:00:16,660 --> 00:00:23,230
to do really short talks but I actually

00:00:19,419 --> 00:00:28,360
might have a little longer one today hi

00:00:23,230 --> 00:00:30,579
I'm Peter on Twitter github and all

00:00:28,360 --> 00:00:34,630
those socials it's either P Birkin bar

00:00:30,579 --> 00:00:37,120
 just my my full name always DMS are

00:00:34,630 --> 00:00:39,340
open so I'm from the Netherlands this is

00:00:37,120 --> 00:00:42,210
how the Netherlands looks when we've got

00:00:39,340 --> 00:00:45,219
julep season it's pretty pretty awesome

00:00:42,210 --> 00:00:46,690
and this is a picture taken the day that

00:00:45,219 --> 00:00:49,499
I left this is actually my little

00:00:46,690 --> 00:00:52,629
village of austell there in the north of

00:00:49,499 --> 00:00:54,969
the Netherlands and I'm really excited

00:00:52,629 --> 00:00:57,640
to be here in Salt Lake City and one of

00:00:54,969 --> 00:01:00,460
the targets that we are definitely gonna

00:00:57,640 --> 00:01:04,300
hit on Thursday at least that's the plan

00:01:00,460 --> 00:01:06,640
Cody Alex this I love a fly fish that's

00:01:04,300 --> 00:01:08,229
one of my my favorite favorite hobbies

00:01:06,640 --> 00:01:11,350
and apparently you can do that really

00:01:08,229 --> 00:01:19,290
well here so more on that on a different

00:01:11,350 --> 00:01:29,860
day so let's known features an adventure

00:01:19,290 --> 00:01:31,869
this might be boring I will try these

00:01:29,860 --> 00:01:34,990
are actually my kids we had dinner on

00:01:31,869 --> 00:01:37,060
Friday and the oldest one just did a

00:01:34,990 --> 00:01:38,740
random live long and prosper I'm like

00:01:37,060 --> 00:01:40,420
dude you can do that like I don't even

00:01:38,740 --> 00:01:42,549
know how that works and then the

00:01:40,420 --> 00:01:44,829
youngest one was like yeah sure no

00:01:42,549 --> 00:01:47,409
problem I can do that too so this was an

00:01:44,829 --> 00:01:48,820
awesome awesome day we had so much fun

00:01:47,409 --> 00:01:52,679
they're not laughing because they're

00:01:48,820 --> 00:01:55,799
they're doing the full Falken experience

00:01:52,679 --> 00:01:59,890
so the background on why this dog

00:01:55,799 --> 00:02:02,200
existed is I was working for a company

00:01:59,890 --> 00:02:05,079
called engine a lot of them are here I

00:02:02,200 --> 00:02:08,110
was working on a product kit system and

00:02:05,079 --> 00:02:12,310
I found out that there's a lot of stuff

00:02:08,110 --> 00:02:14,200
that you don't need to decorate decorate

00:02:12,310 --> 00:02:16,300
your models with there's a whole

00:02:14,200 --> 00:02:19,000
ecosystem that Alessandro actually

00:02:16,300 --> 00:02:21,099
mentioned in his dog just now that we

00:02:19,000 --> 00:02:24,370
can that we can utilize that's already

00:02:21,099 --> 00:02:31,790
there that's not being used that much

00:02:24,370 --> 00:02:33,590
so let's dive in using rails 2 5 in the

00:02:31,790 --> 00:02:37,640
latest release of solidus I know there's

00:02:33,590 --> 00:02:42,380
some changes in master that I didn't

00:02:37,640 --> 00:02:43,910
incorporate right now just say that so

00:02:42,380 --> 00:02:45,920
it's the preference system and it's

00:02:43,910 --> 00:02:48,650
really funny that it's come up a few

00:02:45,920 --> 00:02:51,320
times in the talks saying with Ernesto

00:02:48,650 --> 00:02:54,890
it's the app configuration file that has

00:02:51,320 --> 00:02:57,070
so many documentation or so many unused

00:02:54,890 --> 00:02:59,000
extension points that you can use

00:02:57,070 --> 00:03:02,090
apparently we change it a lot and it's a

00:02:59,000 --> 00:03:07,310
little bit complex but it's in that semi

00:03:02,090 --> 00:03:09,739
safe zone it's a really big file you use

00:03:07,310 --> 00:03:12,440
that in your initializer if you run your

00:03:09,739 --> 00:03:14,330
spree in install it will give you this

00:03:12,440 --> 00:03:16,430
pre initializer and that's the

00:03:14,330 --> 00:03:22,340
pre-conflict block that you use right

00:03:16,430 --> 00:03:25,520
there oh pretty familiar so one part

00:03:22,340 --> 00:03:27,110
that is defined there is the star

00:03:25,520 --> 00:03:30,650
configuration it's a different

00:03:27,110 --> 00:03:33,290
configuration file and you can set a lot

00:03:30,650 --> 00:03:37,340
of classes within the star configuration

00:03:33,290 --> 00:03:39,920
file I won't go into details in this

00:03:37,340 --> 00:03:42,220
particular instance just wanted to make

00:03:39,920 --> 00:03:45,560
sure that this one was presented to

00:03:42,220 --> 00:03:48,080
events enrollments in that one - it's in

00:03:45,560 --> 00:03:50,720
this version you can hook into that it's

00:03:48,080 --> 00:03:54,350
a has its own configuration class and

00:03:50,720 --> 00:03:58,880
it's pretty easy to to understand the

00:03:54,350 --> 00:04:01,549
thing that I also won't cover is the

00:03:58,880 --> 00:04:04,280
environmental config it's a really big

00:04:01,549 --> 00:04:07,100
block of code that registered the

00:04:04,280 --> 00:04:09,860
promotion's calculators promotion

00:04:07,100 --> 00:04:12,590
actions all of those all of those things

00:04:09,860 --> 00:04:17,290
oh yeah and it not make it boring out

00:04:12,590 --> 00:04:17,290
just jump in stuff like this now

00:04:19,459 --> 00:04:26,449
so the core of the presentation is about

00:04:22,030 --> 00:04:28,070
class extension points and it's funny

00:04:26,449 --> 00:04:32,360
that Elizondo mentioned that too and how

00:04:28,070 --> 00:04:35,870
to do that on extensions as well this is

00:04:32,360 --> 00:04:40,250
really really powerful so again the app

00:04:35,870 --> 00:04:43,150
configuration file every class name

00:04:40,250 --> 00:04:47,300
attribute in that file you can extend

00:04:43,150 --> 00:04:49,130
and there's a lot of them this is how

00:04:47,300 --> 00:04:51,560
its implemented it's also a really small

00:04:49,130 --> 00:04:55,400
small method there's some some

00:04:51,560 --> 00:04:58,849
metaprogramming there and there's like

00:04:55,400 --> 00:05:03,080
more than 23 extension points there's

00:04:58,849 --> 00:05:05,570
like actually 23 class name extensions

00:05:03,080 --> 00:05:08,320
and then we've got the different stock

00:05:05,570 --> 00:05:11,240
configuration the events configuration

00:05:08,320 --> 00:05:14,870
but I will go through the majority of

00:05:11,240 --> 00:05:16,160
the extension points in that file a few

00:05:14,870 --> 00:05:18,080
of them will have examples the first

00:05:16,160 --> 00:05:20,720
first few three and I will just go

00:05:18,080 --> 00:05:25,220
through a lot of the options that are

00:05:20,720 --> 00:05:28,820
there so the first one that is defined

00:05:25,220 --> 00:05:30,919
there is the the searcher class and the

00:05:28,820 --> 00:05:32,750
way that it's defined is that we have a

00:05:30,919 --> 00:05:36,320
key that we can set and then there's a

00:05:32,750 --> 00:05:38,300
default in this case the searcher class

00:05:36,320 --> 00:05:42,080
is this Precor search base it's defined

00:05:38,300 --> 00:05:45,860
in the core library on the lip file and

00:05:42,080 --> 00:05:47,960
if you search your search disorders

00:05:45,860 --> 00:05:51,199
repository for where searcher class is

00:05:47,960 --> 00:05:55,000
being used it's used in one of the

00:05:51,199 --> 00:05:55,000
controller helpers to build the search

00:05:55,060 --> 00:06:02,419
and that particular helper is in the

00:06:00,440 --> 00:06:04,280
home controller it will get that built

00:06:02,419 --> 00:06:07,550
the searcher retrieve the products and

00:06:04,280 --> 00:06:10,280
list it so with that knowledge is really

00:06:07,550 --> 00:06:13,070
easy to override off right there search

00:06:10,280 --> 00:06:16,039
logic the searcher file the base file

00:06:13,070 --> 00:06:18,440
the the search base has a get Bey scope

00:06:16,039 --> 00:06:22,280
protection protected file a protected

00:06:18,440 --> 00:06:26,150
method sorry that will get the products

00:06:22,280 --> 00:06:27,680
that you need and then retrieve it so if

00:06:26,150 --> 00:06:30,380
want to override this or get our own

00:06:27,680 --> 00:06:31,969
implementation we can just create a poro

00:06:30,380 --> 00:06:36,499
or custom class we

00:06:31,969 --> 00:06:38,569
then from base and we implement our own

00:06:36,499 --> 00:06:40,489
method in this case we only want to have

00:06:38,569 --> 00:06:44,179
the products that use rails in their

00:06:40,489 --> 00:06:45,799
name with a capital R this is PRS

00:06:44,179 --> 00:06:48,649
incoming on the documentation it's a

00:06:45,799 --> 00:06:51,559
lowercase R and you will won't get any

00:06:48,649 --> 00:06:54,319
products and then in your configuration

00:06:51,559 --> 00:06:56,659
you just require the file that you just

00:06:54,319 --> 00:07:00,939
created set the configuration to use

00:06:56,659 --> 00:07:03,739
your searcher class and from the default

00:07:00,939 --> 00:07:05,869
to the searcher class you have a new

00:07:03,739 --> 00:07:07,189
search are implemented so the way that

00:07:05,869 --> 00:07:09,319
this is really easy like this is a

00:07:07,189 --> 00:07:12,649
trivial example but if you have things

00:07:09,319 --> 00:07:14,599
like algo Lea or elasticsearch or any

00:07:12,649 --> 00:07:17,319
other search mythology that you want to

00:07:14,599 --> 00:07:20,239
use you don't need to decorate a lot of

00:07:17,319 --> 00:07:22,099
internal solidus stuff you can just

00:07:20,239 --> 00:07:24,769
create your own class tested in

00:07:22,099 --> 00:07:27,289
isolation and put that into your

00:07:24,769 --> 00:07:32,119
configuration and you'll have your your

00:07:27,289 --> 00:07:34,699
plug-and-play search the second one is

00:07:32,119 --> 00:07:36,800
called the variant price selector class

00:07:34,699 --> 00:07:40,849
it's a really really powerful one it's

00:07:36,800 --> 00:07:43,789
also a little bit hidden one because

00:07:40,849 --> 00:07:48,050
it's delegated to the pricing option

00:07:43,789 --> 00:07:51,679
class and that one is in turn they'll

00:07:48,050 --> 00:07:55,969
get it to the price for so getting a

00:07:51,679 --> 00:08:01,069
price from for a product this class is

00:07:55,969 --> 00:08:04,129
responsible for doing that yeah so this

00:08:01,069 --> 00:08:06,829
is the whole delegate options class so

00:08:04,129 --> 00:08:08,749
it's named pricing options class but

00:08:06,829 --> 00:08:10,999
it's actually the variant price selector

00:08:08,749 --> 00:08:13,599
so this one is a little I don't know how

00:08:10,999 --> 00:08:16,839
how we do that like a week or a flock or

00:08:13,599 --> 00:08:19,939
there's some some bunting going on here

00:08:16,839 --> 00:08:25,099
but yeah I want to make sure to to list

00:08:19,939 --> 00:08:26,779
this completely I can actually read this

00:08:25,099 --> 00:08:29,029
anymore don't remember where it was

00:08:26,779 --> 00:08:30,949
being used yes

00:08:29,029 --> 00:08:32,959
oh yeah this is in the the actual

00:08:30,949 --> 00:08:35,539
implementation where where you get the

00:08:32,959 --> 00:08:40,490
correct price for a certain certain

00:08:35,539 --> 00:08:42,589
variant so there's also a use case for

00:08:40,490 --> 00:08:43,849
example if you a wholesaler and you just

00:08:42,589 --> 00:08:44,720
want to list your product we don't list

00:08:43,849 --> 00:08:47,839
the prices only

00:08:44,720 --> 00:08:50,990
someone records registered and you could

00:08:47,839 --> 00:08:53,180
go overboard and decorate all your index

00:08:50,990 --> 00:08:54,560
files and just high price if someone is

00:08:53,180 --> 00:08:57,199
locked in but there's a really easy

00:08:54,560 --> 00:09:04,670
solution for that is that we create a

00:08:57,199 --> 00:09:08,209
new price selector and we return only

00:09:04,670 --> 00:09:10,160
the value only the super if there is a

00:09:08,209 --> 00:09:12,740
user logged in and they kept it set up

00:09:10,160 --> 00:09:15,920
we need a little bit more more

00:09:12,740 --> 00:09:20,720
decoration done so we need to make sure

00:09:15,920 --> 00:09:22,670
that we remove an additional value so we

00:09:20,720 --> 00:09:24,439
put in the current user but we need to

00:09:22,670 --> 00:09:26,329
make sure that we remove it from the

00:09:24,439 --> 00:09:27,740
search arguments this isn't one of the

00:09:26,329 --> 00:09:30,110
parts where there's maybe a little bit

00:09:27,740 --> 00:09:32,600
too much automation because the searcher

00:09:30,110 --> 00:09:34,759
parts are being pushed into the active

00:09:32,600 --> 00:09:40,180
record to actually get get this pre

00:09:34,759 --> 00:09:42,410
price and then next we create the

00:09:40,180 --> 00:09:45,680
decoration that we put the current user

00:09:42,410 --> 00:09:47,839
in there's a helper file set current

00:09:45,680 --> 00:09:49,790
pricing options we override that and we

00:09:47,839 --> 00:09:55,100
set this pre current user as an

00:09:49,790 --> 00:09:56,180
attribute and this last we need to make

00:09:55,100 --> 00:09:58,339
sure that we have that help are

00:09:56,180 --> 00:10:02,120
available and change the configuration

00:09:58,339 --> 00:10:06,309
to use our own price selector this is a

00:10:02,120 --> 00:10:08,569
little bit more contrived example so

00:10:06,309 --> 00:10:10,399
when you're not logged in this is what

00:10:08,569 --> 00:10:13,519
you'll see there wouldn't be any prices

00:10:10,399 --> 00:10:16,759
and if you are logged in the prices will

00:10:13,519 --> 00:10:18,949
show this example she doesn't complete

00:10:16,759 --> 00:10:21,079
there's also a certain point where you

00:10:18,949 --> 00:10:22,699
have to set the line item price for that

00:10:21,079 --> 00:10:23,689
specific thing I left that out but if

00:10:22,699 --> 00:10:25,519
you want to implement something like

00:10:23,689 --> 00:10:27,620
this we need you to take a look at the

00:10:25,519 --> 00:10:29,569
original implementation to get this

00:10:27,620 --> 00:10:36,680
implemented correctly in the cart as

00:10:29,569 --> 00:10:40,040
well so the next few slides we'll just

00:10:36,680 --> 00:10:43,970
have the specific configuration and I'll

00:10:40,040 --> 00:10:45,529
go over them a little bit faster this is

00:10:43,970 --> 00:10:48,709
a fairy in Church class this one is

00:10:45,529 --> 00:10:51,199
being used in the admin to fetch the

00:10:48,709 --> 00:10:55,550
right variants if you search in the

00:10:51,199 --> 00:10:58,420
admin this is also interesting if you

00:10:55,550 --> 00:11:00,160
want to decorate

00:10:58,420 --> 00:11:02,560
now decorate want to use a different

00:11:00,160 --> 00:11:04,630
search engine on your admin not as much

00:11:02,560 --> 00:11:09,940
on the front-end this is where you have

00:11:04,630 --> 00:11:13,810
to hook in the promotion choose your

00:11:09,940 --> 00:11:18,340
class similar story we'll use that in

00:11:13,810 --> 00:11:19,870
the in the update order actually

00:11:18,340 --> 00:11:23,500
surprised that the order updater didn't

00:11:19,870 --> 00:11:26,560
show up in the in that you let there be

00:11:23,500 --> 00:11:30,460
dragons because this was a interesting

00:11:26,560 --> 00:11:32,950
file has been improved a lot but there's

00:11:30,460 --> 00:11:35,650
a lot going on in that file but at the

00:11:32,950 --> 00:11:37,090
bottom here you see that there's a class

00:11:35,650 --> 00:11:40,270
that's responsible for picking the

00:11:37,090 --> 00:11:43,750
promotion in this case it will get the

00:11:40,270 --> 00:11:45,460
promotion that has the biggest return

00:11:43,750 --> 00:11:47,470
for the customer but you can override

00:11:45,460 --> 00:11:51,310
that by just implementing your own

00:11:47,470 --> 00:11:58,870
configuration and just to spice things

00:11:51,310 --> 00:12:02,580
up not be too boring I found this really

00:11:58,870 --> 00:12:09,160
hilarious just popped up the other day

00:12:02,580 --> 00:12:12,580
for Lieutenant Dan anyways another one

00:12:09,160 --> 00:12:16,390
that is is really really big one is the

00:12:12,580 --> 00:12:19,810
stock alligator so this is a class that

00:12:16,390 --> 00:12:21,570
is responsible to pick which stock item

00:12:19,810 --> 00:12:25,150
you want to use for this specific order

00:12:21,570 --> 00:12:28,510
and it's set the default is it's the one

00:12:25,150 --> 00:12:32,620
that is on hand and it's used in the

00:12:28,510 --> 00:12:35,230
simple coordinator and once you start

00:12:32,620 --> 00:12:38,800
searching for code in solidus about

00:12:35,230 --> 00:12:42,370
stock that is kind of a rabbit hole that

00:12:38,800 --> 00:12:45,670
I won't won't go into today could be a

00:12:42,370 --> 00:12:48,970
whole presentation of the coordinator

00:12:45,670 --> 00:12:54,250
and the estimator and all of those all

00:12:48,970 --> 00:12:57,880
of those things but you could go search

00:12:54,250 --> 00:13:00,670
for that and yeah it's another important

00:12:57,880 --> 00:13:04,810
thing I come back to that latest slides

00:13:00,670 --> 00:13:06,340
a lot of these are really well tested so

00:13:04,810 --> 00:13:09,580
if you're searching for documentation on

00:13:06,340 --> 00:13:11,180
how to implement one of your own take a

00:13:09,580 --> 00:13:13,550
look at the spec files

00:13:11,180 --> 00:13:17,839
it will define the right contract to

00:13:13,550 --> 00:13:19,760
implement it's really easy to do so yeah

00:13:17,839 --> 00:13:21,970
another another shipping one this one

00:13:19,760 --> 00:13:24,830
does the shipping rate sorting on the

00:13:21,970 --> 00:13:28,970
lowest amount that you want to pay for

00:13:24,830 --> 00:13:33,890
shipping and it's on the estimator one

00:13:28,970 --> 00:13:37,610
of those other stock classes we also

00:13:33,890 --> 00:13:39,740
have a shipping rate selector class that

00:13:37,610 --> 00:13:44,089
is also would I just do to you the same

00:13:39,740 --> 00:13:45,830
time actually no it's also in the

00:13:44,089 --> 00:13:48,230
estimator sorry and it's being used by

00:13:45,830 --> 00:13:53,240
the other by the other part yeah that's

00:13:48,230 --> 00:13:56,690
it various I will go through this a

00:13:53,240 --> 00:13:58,690
little bit faster shipping rate tax

00:13:56,690 --> 00:14:01,940
collector class so there's a lot of

00:13:58,690 --> 00:14:06,830
places where you can hook your own

00:14:01,940 --> 00:14:08,120
custom classes in all the mailers and

00:14:06,830 --> 00:14:10,430
this is also an interesting one because

00:14:08,120 --> 00:14:13,040
I think I don't know if it's into nine

00:14:10,430 --> 00:14:15,170
already but the event system is using

00:14:13,040 --> 00:14:18,800
it's being used to actually set the mail

00:14:15,170 --> 00:14:20,510
set the mailers out so you can overwrite

00:14:18,800 --> 00:14:22,310
your own mailer and decorate it the way

00:14:20,510 --> 00:14:24,860
you want just set this pre-order mailer

00:14:22,310 --> 00:14:28,310
or your promotion code batch mailer or

00:14:24,860 --> 00:14:33,290
your reimbursement mailer or your cart

00:14:28,310 --> 00:14:40,100
or cart and ship email class yeah I have

00:14:33,290 --> 00:14:48,170
so much water then also time zones don't

00:14:40,100 --> 00:14:50,750
help yeah this one's really funny um the

00:14:48,170 --> 00:14:53,060
order merger class so this is a glass

00:14:50,750 --> 00:14:55,070
that's responsible for let's say you

00:14:53,060 --> 00:14:56,720
have a guest checkout yeah as a guest

00:14:55,070 --> 00:14:58,730
you sure you loved in your own computer

00:14:56,720 --> 00:15:00,709
you made an order and then you log in

00:14:58,730 --> 00:15:03,260
you basically have two orders that needs

00:15:00,709 --> 00:15:05,589
to be merged you can have your own logic

00:15:03,260 --> 00:15:11,300
for that too

00:15:05,589 --> 00:15:14,120
there are 23 of these yeah a default

00:15:11,300 --> 00:15:16,339
payment builder we have a wallet system

00:15:14,120 --> 00:15:19,280
that's also something that we might need

00:15:16,339 --> 00:15:21,079
to document a little bit further this is

00:15:19,280 --> 00:15:25,180
responsible for setting up your default

00:15:21,079 --> 00:15:25,180
payment class if you want to check out

00:15:25,360 --> 00:15:29,890
Peyman canceler and this one is a little

00:15:28,340 --> 00:15:33,500
bit different because all the other

00:15:29,890 --> 00:15:36,170
classes or all the other configurations

00:15:33,500 --> 00:15:40,130
are use class names and this one is an

00:15:36,170 --> 00:15:43,040
instance so in the up configuration it's

00:15:40,130 --> 00:15:46,010
not really set up as a class hook but

00:15:43,040 --> 00:15:49,310
it's use second same you can use it on

00:15:46,010 --> 00:15:53,060
the same in the same way so to overwrite

00:15:49,310 --> 00:15:57,320
this in you can just set the set that

00:15:53,060 --> 00:15:58,760
file to something that has the same same

00:15:57,320 --> 00:16:05,839
contract yet like create the instance

00:15:58,760 --> 00:16:07,670
with a default value same thing with the

00:16:05,839 --> 00:16:11,810
previous one although this is aesthetic

00:16:07,670 --> 00:16:14,089
aesthetic one this is why where you set

00:16:11,810 --> 00:16:16,430
the payment source to a wallet let's say

00:16:14,089 --> 00:16:19,550
for example you have a subscription you

00:16:16,430 --> 00:16:22,730
store the stripe customer like the

00:16:19,550 --> 00:16:24,110
payment ID that could be handled in this

00:16:22,730 --> 00:16:26,660
in this part I don't know if this stripe

00:16:24,110 --> 00:16:31,460
extension actually uses this double

00:16:26,660 --> 00:16:34,010
check that this also an interesting one

00:16:31,460 --> 00:16:36,500
if you want to do Multi multi tenancy

00:16:34,010 --> 00:16:40,040
within within solidus have different

00:16:36,500 --> 00:16:42,440
stores by default it's searching by

00:16:40,040 --> 00:16:45,620
server name but you can implement your

00:16:42,440 --> 00:16:48,860
own class to have it by IP or by sub

00:16:45,620 --> 00:16:51,620
domain or whatever scheme you want to

00:16:48,860 --> 00:16:55,450
use and select the right store for the

00:16:51,620 --> 00:16:55,450
URL or even the request that comes in

00:16:56,290 --> 00:17:02,780
yeah apparently we have the URL

00:16:59,990 --> 00:17:07,220
parameter say man not my native language

00:17:02,780 --> 00:17:08,510
per inmate per the para thing there we

00:17:07,220 --> 00:17:13,010
use the default active support in

00:17:08,510 --> 00:17:14,870
flector but you could change the text

00:17:13,010 --> 00:17:16,790
new URL and something different if you

00:17:14,870 --> 00:17:21,069
want to use that probably won't be used

00:17:16,790 --> 00:17:24,040
that much and this is really new it is

00:17:21,069 --> 00:17:28,040
setting the different galleries for

00:17:24,040 --> 00:17:30,140
variants and for products actually

00:17:28,040 --> 00:17:31,960
haven't looked in detail there I think

00:17:30,140 --> 00:17:37,150
you pay that else Android or what's that

00:17:31,960 --> 00:17:37,150
mr. spaghetti code that yeah

00:17:38,400 --> 00:17:46,950
so we're working on getting paperclip

00:17:42,550 --> 00:17:50,770
out of solidus let me get that done

00:17:46,950 --> 00:17:52,960
you still need it paperclip gets active

00:17:50,770 --> 00:17:57,690
support or the active active storage

00:17:52,960 --> 00:17:59,980
wasn't really working yet so we made a

00:17:57,690 --> 00:18:01,480
class extension point for this as well

00:17:59,980 --> 00:18:03,760
so there's an image of Testament module

00:18:01,480 --> 00:18:06,910
that is basically the current of the

00:18:03,760 --> 00:18:08,500
previous paperclip configuration just

00:18:06,910 --> 00:18:10,600
you overwrite that you can use shrine or

00:18:08,500 --> 00:18:13,030
if active support is working for you

00:18:10,600 --> 00:18:18,250
active upload you can use that there too

00:18:13,030 --> 00:18:20,950
same for the tech summer and then one of

00:18:18,250 --> 00:18:23,320
the last one in that list is the order

00:18:20,950 --> 00:18:24,700
number generator and this is also a

00:18:23,320 --> 00:18:28,830
little different that it uses an

00:18:24,700 --> 00:18:28,830
instance instead of just the class name

00:18:31,380 --> 00:18:35,520
that's there and this is how it's how

00:18:34,300 --> 00:18:43,210
it's being used

00:18:35,520 --> 00:18:44,350
it's just generate the right code so for

00:18:43,210 --> 00:18:46,440
this one to you if you want to take a

00:18:44,350 --> 00:18:49,360
look at how to actually make it yourself

00:18:46,440 --> 00:18:51,760
open up this spec file and take a look

00:18:49,360 --> 00:18:54,430
at what is the interface what's being

00:18:51,760 --> 00:19:03,790
called and use that to find your

00:18:54,430 --> 00:19:05,460
documentation yeah I don't know if this

00:19:03,790 --> 00:19:09,910
one is real but it's pretty funny

00:19:05,460 --> 00:19:11,530
Tracey monkeys and then there's one

00:19:09,910 --> 00:19:15,070
other thing and that's basically what

00:19:11,530 --> 00:19:17,470
triggered me to try to make this this

00:19:15,070 --> 00:19:20,140
talk happen is there's there are some

00:19:17,470 --> 00:19:21,430
hooks on the order class that I've

00:19:20,140 --> 00:19:23,920
haven't seen before

00:19:21,430 --> 00:19:27,040
so with that product kit situation we

00:19:23,920 --> 00:19:29,530
needed to have a situation where you

00:19:27,040 --> 00:19:32,860
have different products together but

00:19:29,530 --> 00:19:36,310
they're together they are the same let's

00:19:32,860 --> 00:19:38,740
say we have two t-shirts in in my in my

00:19:36,310 --> 00:19:40,330
cart and I have a single t-shirt in my

00:19:38,740 --> 00:19:44,590
cart as well that should not be the same

00:19:40,330 --> 00:19:47,290
but the two times two t-shirts should be

00:19:44,590 --> 00:19:48,659
the same and it took me a while to

00:19:47,290 --> 00:19:50,999
figure out how to how to

00:19:48,659 --> 00:19:53,519
that they get going so there's two

00:19:50,999 --> 00:19:57,840
different hooks in in this pre-order

00:19:53,519 --> 00:20:00,479
file there's an update hook that you can

00:19:57,840 --> 00:20:04,379
pass it's just a class name and every

00:20:00,479 --> 00:20:06,779
time the order update is triggered your

00:20:04,379 --> 00:20:09,330
hook is being triggered to be careful

00:20:06,779 --> 00:20:11,759
there because that's orders are being

00:20:09,330 --> 00:20:13,169
updated a lot so it's the dangerous

00:20:11,759 --> 00:20:15,330
dangerous one so the one that we want to

00:20:13,169 --> 00:20:21,299
take a look at is the item comparison

00:20:15,330 --> 00:20:23,639
hook so it's being used also in the

00:20:21,299 --> 00:20:26,789
order in the moment there is a new light

00:20:23,639 --> 00:20:29,039
item to see who want to update the

00:20:26,789 --> 00:20:33,330
quantity or add a new light item to the

00:20:29,039 --> 00:20:35,609
cart this particular class of this

00:20:33,330 --> 00:20:38,519
particular method is being called so

00:20:35,609 --> 00:20:40,710
what it does it will just call all the

00:20:38,519 --> 00:20:43,679
comparison hooks and if they're true

00:20:40,710 --> 00:20:47,519
it's the same it's the same it's the

00:20:43,679 --> 00:20:51,029
same line item so for example if you

00:20:47,519 --> 00:20:53,220
have a customized a line item yeah I

00:20:51,029 --> 00:20:56,899
didn't copy paste the code that I get

00:20:53,220 --> 00:20:58,919
for you guys so no so I did some

00:20:56,899 --> 00:21:02,820
contrived samples it's actually from the

00:20:58,919 --> 00:21:06,359
documentation part you register your

00:21:02,820 --> 00:21:08,879
compares comparison hook and you

00:21:06,359 --> 00:21:11,279
implement it like that

00:21:08,879 --> 00:21:13,799
for example there's an options being

00:21:11,279 --> 00:21:15,960
passed let's say we have a product

00:21:13,799 --> 00:21:19,349
customization you upload an image for a

00:21:15,960 --> 00:21:21,389
t-shirt for example and if I order two

00:21:19,349 --> 00:21:23,549
t-shirts with the same customization

00:21:21,389 --> 00:21:26,340
that should be the same line item should

00:21:23,549 --> 00:21:28,440
not be to two different line items so

00:21:26,340 --> 00:21:31,070
this specific one will make sure that if

00:21:28,440 --> 00:21:34,320
my customization is the same I will have

00:21:31,070 --> 00:21:41,009
quantity two not two timeline items with

00:21:34,320 --> 00:21:44,549
181 for example and this is from from

00:21:41,009 --> 00:21:48,899
that extension you have the different

00:21:44,549 --> 00:21:57,029
products and they totally know if

00:21:48,899 --> 00:22:01,820
something is the same or it's not even

00:21:57,029 --> 00:22:01,820
like I said I'm known to go really fast

00:22:05,500 --> 00:22:12,200
any questions so I started the up

00:22:09,680 --> 00:22:14,350
configuration and then take a look at

00:22:12,200 --> 00:22:18,380
what what's being called its and then

00:22:14,350 --> 00:22:20,720
search for the class name and then spec

00:22:18,380 --> 00:22:24,290
files basically and then especially with

00:22:20,720 --> 00:22:26,480
this stock for example that goes really

00:22:24,290 --> 00:22:28,340
really deep and the pricing pricing

00:22:26,480 --> 00:22:30,560
items to you like that's also a part on

00:22:28,340 --> 00:22:34,460
those product kits that I had to dive in

00:22:30,560 --> 00:22:38,900
a lot see how to get a right price from

00:22:34,460 --> 00:22:43,210
a right country right currency with or

00:22:38,900 --> 00:22:45,710
without a specific get price available

00:22:43,210 --> 00:22:50,750
yeah it's basically knowing how to

00:22:45,710 --> 00:22:52,880
search and then trying to go deeper and

00:22:50,750 --> 00:22:54,530
deeper and start writing writing specs

00:22:52,880 --> 00:22:58,550
right could we expect in the writing

00:22:54,530 --> 00:23:01,360
specs then yeah so the question was I I

00:22:58,550 --> 00:23:04,670
think everybody here Dan correctly but

00:23:01,360 --> 00:23:07,910
we worked for a bigger project on spree

00:23:04,670 --> 00:23:09,410
that was doing a lot of different prices

00:23:07,910 --> 00:23:12,430
and they had a system called price books

00:23:09,410 --> 00:23:15,050
I think it's even in the in the contrib

00:23:12,430 --> 00:23:16,730
probably not active anymore but that

00:23:15,050 --> 00:23:21,590
went completely completely out of hand

00:23:16,730 --> 00:23:23,960
yeah so for the new dad both so if I

00:23:21,590 --> 00:23:25,250
want to do my functionality that I need

00:23:23,960 --> 00:23:27,550
to implement I start with a with a

00:23:25,250 --> 00:23:30,410
systems back or a feature just to get

00:23:27,550 --> 00:23:32,750
feeling for the system and then I dump

00:23:30,410 --> 00:23:34,910
dive deeper if I like they have to

00:23:32,750 --> 00:23:36,890
overwrite the class for example I go

00:23:34,910 --> 00:23:38,870
straight to unit testing that that

00:23:36,890 --> 00:23:41,660
interface that I know that when I put in

00:23:38,870 --> 00:23:43,670
this is what I get out and then that

00:23:41,660 --> 00:23:47,440
bubbles up to it's like outside in

00:23:43,670 --> 00:23:47,440
basically yeah

00:23:51,070 --> 00:23:57,230
great thanks

00:23:53,120 --> 00:24:10,519
[Applause]

00:23:57,230 --> 00:24:10,519

YouTube URL: https://www.youtube.com/watch?v=JW8Z2kv-okM


