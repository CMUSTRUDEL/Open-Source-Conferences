Title: Source of Truth: Auto-Populating Your G-Suite Users and Permissions in Cloud Foundry
Publication date: 2017-06-22
Playlist: Cloud Foundry Summit Silicon Valley 2017
Description: 
	Source of Truth: Auto-Populating Your G-Suite Users and Permissions in Cloud Foundry [I] - Colleen Briant, Google    

Managing your GSuite and Cloud Foundry users has never been so easy! With the development of a new integration from Google, GSuite users and their permissions are automatically propagated to your Cloud Foundry foundation. This talk will show you how to integrate your GSuite users and groups into your Cloud Foundry auth and permissions structure, including best practices for using LDAP groups and SSO.
Captions: 
	00:00:00,030 --> 00:00:06,750
hi guys I'm Colleen I'm from Google I've

00:00:04,080 --> 00:00:08,820
been with Google for exactly one year in

00:00:06,750 --> 00:00:12,660
one day actually yesterday was my

00:00:08,820 --> 00:00:14,820
anniversary thank you

00:00:12,660 --> 00:00:17,070
and I work on a team that specializes in

00:00:14,820 --> 00:00:19,500
open source integrations with Google

00:00:17,070 --> 00:00:22,650
cloud platform so you might have seen my

00:00:19,500 --> 00:00:25,320
work on the GCP service broker but today

00:00:22,650 --> 00:00:28,320
I'm here to talk to you about a new

00:00:25,320 --> 00:00:31,529
integration that we're exploring this is

00:00:28,320 --> 00:00:34,860
under development but still very much in

00:00:31,529 --> 00:00:38,010
flux still looking for a lot of feedback

00:00:34,860 --> 00:00:40,320
in terms of is this a product that's

00:00:38,010 --> 00:00:41,969
going to be useful and helpful to you

00:00:40,320 --> 00:00:44,399
what features what you need what

00:00:41,969 --> 00:00:47,340
direction would you want it to go so

00:00:44,399 --> 00:00:50,489
definitely looking for a lot of feedback

00:00:47,340 --> 00:00:52,829
at the end of this session but so we're

00:00:50,489 --> 00:00:55,699
going to talk about the work that's

00:00:52,829 --> 00:00:59,129
planned and and started right now

00:00:55,699 --> 00:01:01,260
integrating G suite or which you might

00:00:59,129 --> 00:01:05,479
also know as Google for work with Cloud

00:01:01,260 --> 00:01:08,510
Foundry authentication and permissions

00:01:05,479 --> 00:01:12,240
so I'm just gonna level set on some

00:01:08,510 --> 00:01:16,220
acronyms just to start with so you a as

00:01:12,240 --> 00:01:21,030
user accounts and authorization

00:01:16,220 --> 00:01:24,630
sonication authentication and this is a

00:01:21,030 --> 00:01:30,180
default that ships with Cloud Foundry

00:01:24,630 --> 00:01:32,040
for managing your user logins however in

00:01:30,180 --> 00:01:34,470
terms of most of the permissions that

00:01:32,040 --> 00:01:37,049
your user your Cloud Foundry developers

00:01:34,470 --> 00:01:38,759
are going to use day-to-day those are

00:01:37,049 --> 00:01:41,340
managed through the cloud controller

00:01:38,759 --> 00:01:45,200
api's which is commonly abbreviated as

00:01:41,340 --> 00:01:49,320
capi so these are two distinct systems

00:01:45,200 --> 00:01:53,490
you add a user through UA as well as

00:01:49,320 --> 00:01:55,950
through copy but then managing the

00:01:53,490 --> 00:01:58,770
different sets of permissions or

00:01:55,950 --> 00:02:01,049
different pieces of information you have

00:01:58,770 --> 00:02:05,729
to go from one system to the other

00:02:01,049 --> 00:02:08,759
so it's does pose some limitations and

00:02:05,729 --> 00:02:12,830
may can make some things a little more

00:02:08,759 --> 00:02:14,890
difficult to administer so

00:02:12,830 --> 00:02:18,440
having worked in an enterprise

00:02:14,890 --> 00:02:20,450
organization before we know that

00:02:18,440 --> 00:02:23,590
onboarding and just permissions

00:02:20,450 --> 00:02:27,650
day-to-day can be hard and complex so

00:02:23,590 --> 00:02:29,780
there's a situation that I thought some

00:02:27,650 --> 00:02:32,210
of you might be able to relate to so

00:02:29,780 --> 00:02:36,860
let's say Nancy's a new developer at

00:02:32,210 --> 00:02:40,010
your company so your HR person will add

00:02:36,860 --> 00:02:42,670
an entry for her in his tool which is

00:02:40,010 --> 00:02:46,130
usually synchronized to another system

00:02:42,670 --> 00:02:47,930
so that she can get her G suite account

00:02:46,130 --> 00:02:51,230
all set up so she hits an email address

00:02:47,930 --> 00:02:56,720
and logs for those actions will go into

00:02:51,230 --> 00:02:59,360
his tool and into G suite and then

00:02:56,720 --> 00:03:01,520
you're gonna have a sysadmin who's gonna

00:02:59,360 --> 00:03:04,070
use a different system probably to add

00:03:01,520 --> 00:03:06,800
Nancy to some LDAP groups because you

00:03:04,070 --> 00:03:08,690
might have other health and benefits

00:03:06,800 --> 00:03:12,590
systems that are connected that'll pull

00:03:08,690 --> 00:03:15,170
that information in so then logs for

00:03:12,590 --> 00:03:18,950
that action will just go into the LDAP

00:03:15,170 --> 00:03:20,930
server and you know during onboarding

00:03:18,950 --> 00:03:22,820
you get that document that says how's

00:03:20,930 --> 00:03:24,290
the checklist of everything that you

00:03:22,820 --> 00:03:27,680
should have permission to that you

00:03:24,290 --> 00:03:29,270
should set up your system with so during

00:03:27,680 --> 00:03:31,190
her onboarding Nancy is gonna find oh I

00:03:29,270 --> 00:03:34,430
need to have a Cloud Foundry account

00:03:31,190 --> 00:03:36,200
made for me and I need to have access to

00:03:34,430 --> 00:03:38,180
these orgs and spaces that my team's

00:03:36,200 --> 00:03:39,830
gonna work on so then Nancy will

00:03:38,180 --> 00:03:42,530
probably go to her p.m. and her PM will

00:03:39,830 --> 00:03:44,950
create her an account and maybe I add

00:03:42,530 --> 00:03:48,130
her to everything that Nancy requests

00:03:44,950 --> 00:03:51,290
but those documents are never complete

00:03:48,130 --> 00:03:53,810
so a few weeks later and Nancy's gonna

00:03:51,290 --> 00:03:55,220
find something that was left out and

00:03:53,810 --> 00:03:56,690
she's probably at this point just gonna

00:03:55,220 --> 00:03:59,000
go to her team lead and her team lead

00:03:56,690 --> 00:04:02,780
will be able to give her access directly

00:03:59,000 --> 00:04:05,470
through Kathy to whatever spaces or orgs

00:04:02,780 --> 00:04:05,470
she was missing

00:04:05,510 --> 00:04:09,830
and again these logs are continuing to

00:04:07,970 --> 00:04:14,480
be kind of scattered across the

00:04:09,830 --> 00:04:18,230
disparate systems so the logs that went

00:04:14,480 --> 00:04:21,109
into Kathy are only there and then the

00:04:18,230 --> 00:04:25,720
logs from the team leaves actions might

00:04:21,109 --> 00:04:29,440
need to go into both systems

00:04:25,720 --> 00:04:32,710
and then say a year later in Nancy

00:04:29,440 --> 00:04:36,190
switches projects so she doesn't want to

00:04:32,710 --> 00:04:38,710
get the spam from her old team Google

00:04:36,190 --> 00:04:42,010
Groups anymore so her old PM removes her

00:04:38,710 --> 00:04:43,930
and her new PM goes through the and team

00:04:42,010 --> 00:04:45,430
Lee go through the same set of actions

00:04:43,930 --> 00:04:49,860
so they're kind of adding things in

00:04:45,430 --> 00:04:52,660
different places but it's very

00:04:49,860 --> 00:04:55,030
reasonable to think that somebody might

00:04:52,660 --> 00:04:57,430
forget to remove her access to her old

00:04:55,030 --> 00:05:00,970
orgs and spaces so you're kind of left

00:04:57,430 --> 00:05:04,330
with the logs are scattered across these

00:05:00,970 --> 00:05:07,540
different systems the actions are very

00:05:04,330 --> 00:05:09,910
disparate and so it can just be kind of

00:05:07,540 --> 00:05:11,860
hard to track what's going on and where

00:05:09,910 --> 00:05:14,050
and make sure that the permission

00:05:11,860 --> 00:05:15,730
structure is as it should be and gets

00:05:14,050 --> 00:05:22,410
propagated through all areas of the

00:05:15,730 --> 00:05:25,350
system so you tried to come up with a

00:05:22,410 --> 00:05:29,200
workflow that would be more consistent

00:05:25,350 --> 00:05:31,090
so it starts in the same place Steve

00:05:29,200 --> 00:05:35,560
still adds Nancy to the HR tool and that

00:05:31,090 --> 00:05:38,440
propagates did you tweet this diagram I

00:05:35,560 --> 00:05:40,900
know kind of looks complicated so I'm

00:05:38,440 --> 00:05:44,230
I'm gonna walk through it so we've added

00:05:40,900 --> 00:05:46,180
a couple things here there is something

00:05:44,230 --> 00:05:50,169
known as google cloud directory sync

00:05:46,180 --> 00:05:53,020
that's the box to the right of the LDAP

00:05:50,169 --> 00:05:56,080
box and so that's gonna pull from the

00:05:53,020 --> 00:05:59,200
LDAP server and propagate LDAP groups as

00:05:56,080 --> 00:06:01,919
Google Groups into G suite and then the

00:05:59,200 --> 00:06:06,280
application that I'm working on is

00:06:01,919 --> 00:06:08,020
simply labeled sink next to G suite and

00:06:06,280 --> 00:06:11,260
that's gonna do a very similar thing

00:06:08,020 --> 00:06:16,230
pull from G suite and propagate to both

00:06:11,260 --> 00:06:19,900
Kathy and UA a so this step to where

00:06:16,230 --> 00:06:22,560
Nancy sysadmin adds her to the LDAP

00:06:19,900 --> 00:06:25,630
server actually kind of takes care of

00:06:22,560 --> 00:06:27,070
some of the other steps so her PM no

00:06:25,630 --> 00:06:30,130
longer needs to create her an account

00:06:27,070 --> 00:06:31,720
and add her to orgs and spaces now the

00:06:30,130 --> 00:06:35,500
LDAP groups will take care of that

00:06:31,720 --> 00:06:39,289
themselves Excel gets synced into G

00:06:35,500 --> 00:06:41,330
suite and then synced into both system

00:06:39,289 --> 00:06:43,849
and then the logs for that will be

00:06:41,330 --> 00:06:46,279
consistent because they'll be both

00:06:43,849 --> 00:06:48,439
available in the sync applications as

00:06:46,279 --> 00:06:50,419
well as in each of the individual

00:06:48,439 --> 00:06:54,289
systems so if you're looking for a

00:06:50,419 --> 00:06:57,020
complete set of actions you can go

00:06:54,289 --> 00:07:02,539
straight to the sync system to look for

00:06:57,020 --> 00:07:05,029
everything together and then again when

00:07:02,539 --> 00:07:07,460
the permissions need to be updated you

00:07:05,029 --> 00:07:10,639
don't have to go into the individual

00:07:07,460 --> 00:07:12,770
systems at Nancy's p.m. can just add her

00:07:10,639 --> 00:07:15,349
to a new google group and that'll take

00:07:12,770 --> 00:07:17,659
that same set of actions to add her to

00:07:15,349 --> 00:07:20,270
the appropriate orgs and spaces or give

00:07:17,659 --> 00:07:25,939
her the appropriate permissions in copy

00:07:20,270 --> 00:07:28,369
or UAE or both and then you get the nice

00:07:25,939 --> 00:07:31,339
consistency of when Nancy switches teens

00:07:28,369 --> 00:07:32,899
her p.m. removes her from the Google

00:07:31,339 --> 00:07:35,569
Groups that correspondent to her old

00:07:32,899 --> 00:07:37,699
team and that'll propagate that set of

00:07:35,569 --> 00:07:39,259
permissions through so that you can be

00:07:37,699 --> 00:07:42,199
sure that only the people who are

00:07:39,259 --> 00:07:50,059
supposed to have access to those orcs

00:07:42,199 --> 00:07:52,339
and spaces are the ones that do so as I

00:07:50,059 --> 00:07:54,889
said because the solutions this is the

00:07:52,339 --> 00:07:57,139
sink that is under active development

00:07:54,889 --> 00:08:00,740
pulling from gee suite into UAA and

00:07:57,139 --> 00:08:04,279
Cappy and all in a second walk through

00:08:00,740 --> 00:08:07,729
that in a little bit more depth and then

00:08:04,279 --> 00:08:09,439
these I included just because they are

00:08:07,729 --> 00:08:13,029
so common but they are kind of optional

00:08:09,439 --> 00:08:16,399
add-ons so single sign-on

00:08:13,029 --> 00:08:20,659
by Open ID Connect is available right

00:08:16,399 --> 00:08:22,969
now with UA so that makes a lot of sense

00:08:20,659 --> 00:08:25,939
to add and then this go cloud directory

00:08:22,969 --> 00:08:30,769
sync kind of gives you the full workflow

00:08:25,939 --> 00:08:33,469
from LDAP to single sign-on and all

00:08:30,769 --> 00:08:36,939
these permissions it propagated

00:08:33,469 --> 00:08:36,939
throughout your system with consistency

00:08:38,199 --> 00:08:44,089
so the way that you would use this

00:08:40,459 --> 00:08:46,790
application is you just do a config

00:08:44,089 --> 00:08:50,089
before the application runs to create a

00:08:46,790 --> 00:08:54,560
mapping of your Google Groups to a set

00:08:50,089 --> 00:08:57,490
of roles orgs and spaces within Cloud

00:08:54,560 --> 00:08:59,899
Foundry so for example you could have a

00:08:57,490 --> 00:09:04,339
like finance dove's

00:08:59,899 --> 00:09:06,740
group that maps to you should have space

00:09:04,339 --> 00:09:13,779
developer in the finance org

00:09:06,740 --> 00:09:16,250
and a finance DEP space or something and

00:09:13,779 --> 00:09:19,399
then when the application first starts

00:09:16,250 --> 00:09:22,639
it's going to read that mapping and do a

00:09:19,399 --> 00:09:24,860
sync both to make sure that it's caught

00:09:22,639 --> 00:09:26,480
up on users and groups that exist within

00:09:24,860 --> 00:09:28,430
Google and to make sure that it's caught

00:09:26,480 --> 00:09:31,639
up on that config so it's gonna read

00:09:28,430 --> 00:09:34,160
everything from Google diff it with

00:09:31,639 --> 00:09:36,260
everything in Cloud Foundry and then

00:09:34,160 --> 00:09:38,420
apply the appropriate transformations

00:09:36,260 --> 00:09:41,240
and then just during the course of

00:09:38,420 --> 00:09:44,870
normal application running there's gonna

00:09:41,240 --> 00:09:47,689
be a listener so it'll listen for

00:09:44,870 --> 00:09:50,209
actions taken in G sweet things like

00:09:47,689 --> 00:09:53,420
adding members to groups disabling

00:09:50,209 --> 00:09:56,029
somebody's access and then transform

00:09:53,420 --> 00:10:03,410
those into individual actions to apply

00:09:56,029 --> 00:10:10,639
to Cloud Foundry so I just have a quick

00:10:03,410 --> 00:10:15,230
demo of the user import functionality so

00:10:10,639 --> 00:10:21,490
I have a G suite account set up and you

00:10:15,230 --> 00:10:25,790
can see I have two users there but in my

00:10:21,490 --> 00:10:30,279
Cloud Foundry users list there is only

00:10:25,790 --> 00:10:35,089
one entry and that's my admin user so

00:10:30,279 --> 00:10:37,490
I'm just gonna surround the program so

00:10:35,089 --> 00:10:41,500
you can see it's pulling users from

00:10:37,490 --> 00:10:44,540
Google and it found these two right here

00:10:41,500 --> 00:10:47,569
pulled in their information hold users

00:10:44,540 --> 00:10:49,760
from Cloud Foundry only found one which

00:10:47,569 --> 00:10:51,949
was the admin user so it knows that it's

00:10:49,760 --> 00:10:55,220
missing these two users I needs to add

00:10:51,949 --> 00:10:59,089
them to Cloud Foundry so if I come back

00:10:55,220 --> 00:11:02,449
out and get my users list again now I

00:10:59,089 --> 00:11:04,640
have that admin user but I also have my

00:11:02,449 --> 00:11:08,690
Coleen user

00:11:04,640 --> 00:11:16,540
and Dana somewhere in there I have three

00:11:08,690 --> 00:11:21,890
total results now so this is a pretty

00:11:16,540 --> 00:11:24,680
quick talk to be honest this is all that

00:11:21,890 --> 00:11:27,709
I have to present to you right now

00:11:24,680 --> 00:11:31,310
so I would love to take any questions

00:11:27,709 --> 00:11:35,990
now or I'll just stick around afterwards

00:11:31,310 --> 00:11:39,730
if this sounds interesting again this is

00:11:35,990 --> 00:11:43,070
very much up to the community to see

00:11:39,730 --> 00:11:54,440
what kind of features you would need so

00:11:43,070 --> 00:11:58,670
come talk to me does anybody want to ask

00:11:54,440 --> 00:12:02,200
any questions now okay I'm just gonna

00:11:58,670 --> 00:12:02,200

YouTube URL: https://www.youtube.com/watch?v=4JkiAYzH-G4


