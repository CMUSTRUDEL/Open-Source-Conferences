Title: AI at Scale at Coinbase (sponsored by Amazon Web Services) - Soups Ranjan (Coinbase)
Publication date: 2018-09-06
Playlist: Artificial Intelligence Conference 2018 - San Francisco, California
Description: 
	Cryptocurrencies such as Bitcoin, Ethereum and others are a transformative force that could one day create an open financial network for the world. Soups manages the data science and risk team at Coinbase, one of the largest cryptocurrency exchanges in the world.

Subscribe to O'Reilly on YouTube: http://goo.gl/n3QSYi

Follow O'Reilly on: 
Twitter: http://twitter.com/oreillymedia
Facebook: http://facebook.com/OReilly
Instagram: https://www.instagram.com/oreillymedia
LinkedIn: https://www.linkedin.com/company-beta/8459/
Captions: 
	00:00:00,149 --> 00:00:05,430
good morning everyone my name is Supes

00:00:02,550 --> 00:00:06,480
and I lead data science and risk at coin

00:00:05,430 --> 00:00:08,670
base which is one of the largest

00:00:06,480 --> 00:00:11,040
cryptocurrency exchanges in the world so

00:00:08,670 --> 00:00:13,469
today I'm going to be talking about what

00:00:11,040 --> 00:00:14,700
does it mean to build one of the largest

00:00:13,469 --> 00:00:17,490
crypto currency exchanges in the world

00:00:14,700 --> 00:00:21,330
and how do you solve some of the hardest

00:00:17,490 --> 00:00:23,580
problems using AI at scale so first coin

00:00:21,330 --> 00:00:26,939
base is building an open financial

00:00:23,580 --> 00:00:29,220
system for the world via allowing users

00:00:26,939 --> 00:00:33,290
all over the world the ability to use

00:00:29,220 --> 00:00:35,309
buy or earn cryptocurrencies now

00:00:33,290 --> 00:00:37,980
building this gateway to the

00:00:35,309 --> 00:00:41,670
cryptocurrency world from the fiat world

00:00:37,980 --> 00:00:44,129
of u.s. dollars or Euros requires

00:00:41,670 --> 00:00:48,450
getting several things right including

00:00:44,129 --> 00:00:50,010
fraud compliance and identity in this

00:00:48,450 --> 00:00:52,469
talk today I'll be talking about what

00:00:50,010 --> 00:00:55,020
does it mean to leverage AI and machine

00:00:52,469 --> 00:00:56,730
learning to solve some of the hard

00:00:55,020 --> 00:01:01,620
problems and on fraud compliance and

00:00:56,730 --> 00:01:02,820
energy just to give you a brief idea of

00:01:01,620 --> 00:01:05,489
the scale that we're dealing with over

00:01:02,820 --> 00:01:08,070
here so first of all our anti-fraud

00:01:05,489 --> 00:01:10,200
models are built using matrices which

00:01:08,070 --> 00:01:12,780
are as large as 10 million rows 100,000

00:01:10,200 --> 00:01:16,140
columns and all fraud models are powered

00:01:12,780 --> 00:01:17,280
by signals from the block chains and the

00:01:16,140 --> 00:01:18,960
block chains for the major

00:01:17,280 --> 00:01:21,270
cryptocurrencies we support including

00:01:18,960 --> 00:01:23,310
Bitcoin in aetherium are on the order of

00:01:21,270 --> 00:01:26,240
hundreds of gigabytes closely reaching a

00:01:23,310 --> 00:01:30,479
terabyte and growing at the rate of 150

00:01:26,240 --> 00:01:34,979
megabytes an hour now on the identity

00:01:30,479 --> 00:01:36,509
front we have to in order to comply with

00:01:34,979 --> 00:01:38,640
the law of the land in the various

00:01:36,509 --> 00:01:40,500
jurisdictions where we operating we have

00:01:38,640 --> 00:01:44,670
to obtain the identity document for our

00:01:40,500 --> 00:01:47,220
customers and we cannot necessarily run

00:01:44,670 --> 00:01:50,399
AI and machine learning algorithms while

00:01:47,220 --> 00:01:53,220
that data is stored in clear text so we

00:01:50,399 --> 00:01:55,770
encrypt all of that data in s3 buckets

00:01:53,220 --> 00:01:57,750
on Amazon and then those images are

00:01:55,770 --> 00:02:01,079
decrypted at the rate of 500 images per

00:01:57,750 --> 00:02:04,200
second and then we run our computer

00:02:01,079 --> 00:02:05,490
vision algorithms on that now first I'll

00:02:04,200 --> 00:02:07,500
give you a brief overview of all these

00:02:05,490 --> 00:02:10,050
various interesting problems first of

00:02:07,500 --> 00:02:12,060
all at coin base we have to solve one of

00:02:10,050 --> 00:02:14,350
the hardest payment fraud problems out

00:02:12,060 --> 00:02:16,540
there because of the nature of the goods

00:02:14,350 --> 00:02:20,470
we're selling digital currency which is

00:02:16,540 --> 00:02:22,210
instant and non reversible as in once it

00:02:20,470 --> 00:02:24,910
leaves the platform they cannot recover

00:02:22,210 --> 00:02:27,610
it back so this leads to very

00:02:24,910 --> 00:02:29,470
sophisticated adversaries and fraud at

00:02:27,610 --> 00:02:34,120
coinbase involves creating a synthetic

00:02:29,470 --> 00:02:36,610
identity a fraudster will steal alice's

00:02:34,120 --> 00:02:38,710
bank account bob's identity which is

00:02:36,610 --> 00:02:42,040
driver license or social security number

00:02:38,710 --> 00:02:43,270
and then calls mobile phone number and

00:02:42,040 --> 00:02:45,940
link it on coinbase

00:02:43,270 --> 00:02:47,770
now the scammer is going to purchase

00:02:45,940 --> 00:02:49,300
cryptocurrency out of alice's bank

00:02:47,770 --> 00:02:51,340
account and withdraw it out of the

00:02:49,300 --> 00:02:53,320
platform and then when alice takes a

00:02:51,340 --> 00:02:56,110
look at her bank statement she is going

00:02:53,320 --> 00:02:57,910
to file a dispute and under some

00:02:56,110 --> 00:03:00,040
circumstances coinbase has to return the

00:02:57,910 --> 00:03:01,540
funds back to alice and this camera in

00:03:00,040 --> 00:03:03,730
the meantime has run off with the funds

00:03:01,540 --> 00:03:07,540
and thereby coinbase is left holding the

00:03:03,730 --> 00:03:11,290
bag now we use machine learning as a

00:03:07,540 --> 00:03:13,330
lynchpin in our fight against fraud our

00:03:11,290 --> 00:03:15,040
machine learning system is essentially

00:03:13,330 --> 00:03:17,680
doing miss patches across the different

00:03:15,040 --> 00:03:19,750
identity sources you know it looks at

00:03:17,680 --> 00:03:22,990
identity behind your bank account or

00:03:19,750 --> 00:03:24,430
identity behind your driver license or

00:03:22,990 --> 00:03:26,410
the identity that is registered with

00:03:24,430 --> 00:03:28,030
Social Security or the identity behind

00:03:26,410 --> 00:03:31,690
your email address or phone number and

00:03:28,030 --> 00:03:33,250
it tries to make sure that if a scammer

00:03:31,690 --> 00:03:35,470
steals Alice's bank account this camera

00:03:33,250 --> 00:03:37,209
has to also seal Alice's social security

00:03:35,470 --> 00:03:39,130
number and also maybe Photoshop a driver

00:03:37,209 --> 00:03:40,600
license with her information and maybe

00:03:39,130 --> 00:03:43,930
even register a phone number in her name

00:03:40,600 --> 00:03:46,810
so up until you can actually make the

00:03:43,930 --> 00:03:48,400
return on investments so low that they

00:03:46,810 --> 00:03:49,630
actually just leave the platform so

00:03:48,400 --> 00:03:52,000
that's where machine learning comes into

00:03:49,630 --> 00:03:53,530
play secondly our machine learning

00:03:52,000 --> 00:03:56,170
system is constantly looking at signals

00:03:53,530 --> 00:03:57,640
which have velocity driven right like

00:03:56,170 --> 00:03:59,590
device fingerprint location

00:03:57,640 --> 00:04:02,110
you know blockchain related signals etc

00:03:59,590 --> 00:04:04,030
a case in point being that one time we

00:04:02,110 --> 00:04:07,209
saw scammers were using a particular

00:04:04,030 --> 00:04:09,010
screen resolution 1376 may 768 which is

00:04:07,209 --> 00:04:10,720
very uncommon however they were

00:04:09,010 --> 00:04:12,640
pretending to be coming from a

00:04:10,720 --> 00:04:14,739
particular device and using Windows

00:04:12,640 --> 00:04:16,630
remote desktop protocol which had a bug

00:04:14,739 --> 00:04:18,220
via which that screen resolution

00:04:16,630 --> 00:04:20,140
appeared to be off by a few pixels on

00:04:18,220 --> 00:04:21,850
each side so that is why our machine

00:04:20,140 --> 00:04:24,220
learning model latched on to it and

00:04:21,850 --> 00:04:25,690
started giving everyone a high risk

00:04:24,220 --> 00:04:27,390
score who was using that screen

00:04:25,690 --> 00:04:30,730
resolution

00:04:27,390 --> 00:04:32,920
now shifting gears a little bit in order

00:04:30,730 --> 00:04:34,570
for us to service our customers in all

00:04:32,920 --> 00:04:36,400
the jurisdictions we have to collect

00:04:34,570 --> 00:04:39,250
identity information from our customers

00:04:36,400 --> 00:04:42,210
however identity verification online is

00:04:39,250 --> 00:04:45,910
flawed because you cannot necessarily

00:04:42,210 --> 00:04:47,920
shine ultraviolet light on an ID when

00:04:45,910 --> 00:04:51,010
you're asking users to upload it using

00:04:47,920 --> 00:04:52,510
the mobile camera and thereby you cannot

00:04:51,010 --> 00:04:54,220
necessarily take a look at all the

00:04:52,510 --> 00:04:56,740
secret messages which are hidden in an

00:04:54,220 --> 00:04:57,730
ID which are only seen in under

00:04:56,740 --> 00:05:00,880
ultraviolet light

00:04:57,730 --> 00:05:02,710
likewise you cannot ask a user to move

00:05:00,880 --> 00:05:04,330
or rotate their ID such that you could

00:05:02,710 --> 00:05:05,140
see the holographic images which are

00:05:04,330 --> 00:05:08,200
also hidden there

00:05:05,140 --> 00:05:10,510
turns out our scammers are highly

00:05:08,200 --> 00:05:12,970
sophisticated so they have come up with

00:05:10,510 --> 00:05:13,960
very clever ways of photoshopping IDs

00:05:12,970 --> 00:05:16,000
don't be alarmed

00:05:13,960 --> 00:05:18,550
no PII there those are very clever photo

00:05:16,000 --> 00:05:21,190
shops what they've done is they've

00:05:18,550 --> 00:05:25,210
realized that since it is so hard to

00:05:21,190 --> 00:05:27,190
actually always Photoshop the the image

00:05:25,210 --> 00:05:29,440
because you have to also create a

00:05:27,190 --> 00:05:32,980
ghosted image on the ID so they have

00:05:29,440 --> 00:05:34,419
resorted to just altering the text so

00:05:32,980 --> 00:05:35,980
those are two different IDs with two

00:05:34,419 --> 00:05:38,080
different driver license numbers by the

00:05:35,980 --> 00:05:41,260
same individual so what we've done is

00:05:38,080 --> 00:05:43,630
using deep learning we are extracting

00:05:41,260 --> 00:05:45,820
the faces from the ID uploads and then

00:05:43,630 --> 00:05:47,380
we have built an ID or similarity

00:05:45,820 --> 00:05:51,730
algorithm which just looks at face

00:05:47,380 --> 00:05:53,260
similarity across multiple IDs now I'll

00:05:51,730 --> 00:05:55,870
talk about what does it mean to be

00:05:53,260 --> 00:05:59,169
solving these problems at scale so using

00:05:55,870 --> 00:06:02,590
Amazon Sage maker we have been able to

00:05:59,169 --> 00:06:04,810
speed up our anti-fraud model-building

00:06:02,590 --> 00:06:07,770
which in the past used to take about 20

00:06:04,810 --> 00:06:09,520
hours and now using GPU instances and

00:06:07,770 --> 00:06:11,260
paralyzing our machine learning model

00:06:09,520 --> 00:06:13,450
building very able to bring it down by

00:06:11,260 --> 00:06:15,430
10x so we can build a new model in 20

00:06:13,450 --> 00:06:17,770
minutes since fraud is highly dynamic

00:06:15,430 --> 00:06:20,380
and highly evolving fraudsters always

00:06:17,770 --> 00:06:22,510
adapting new techniques so this is a key

00:06:20,380 --> 00:06:24,370
advantage to us the ability to actually

00:06:22,510 --> 00:06:28,600
create a new model at much faster

00:06:24,370 --> 00:06:31,300
timescales similarly we can now decrypt

00:06:28,600 --> 00:06:33,820
images which are stored in Amazon using

00:06:31,300 --> 00:06:36,220
Amazon's key management service we can

00:06:33,820 --> 00:06:38,650
decrypt them and then we can actually

00:06:36,220 --> 00:06:39,580
perform our computer vision algorithms

00:06:38,650 --> 00:06:43,190
on them

00:06:39,580 --> 00:06:45,260
now at a company like coinbase we have a

00:06:43,190 --> 00:06:47,750
very hard problem as data scientists

00:06:45,260 --> 00:06:49,970
because turns out our dear scientists

00:06:47,750 --> 00:06:51,950
don't have access to data because

00:06:49,970 --> 00:06:53,300
coinbase is storing billions of dollars

00:06:51,950 --> 00:06:56,030
of cryptocurrencies on behalf of its

00:06:53,300 --> 00:06:58,250
customers and so we have very strict

00:06:56,030 --> 00:07:01,280
rules in place as to who can touch

00:06:58,250 --> 00:07:03,710
production data so that means that we've

00:07:01,280 --> 00:07:06,440
had to build a very novel system via

00:07:03,710 --> 00:07:08,960
which our data scientists and machine

00:07:06,440 --> 00:07:12,410
learning engineers can actually write

00:07:08,960 --> 00:07:15,110
code so what we've done is we've built a

00:07:12,410 --> 00:07:17,210
service via which any code that gets

00:07:15,110 --> 00:07:20,630
deployed be it a Jupiter hub notebook or

00:07:17,210 --> 00:07:22,280
be it a machine learning algorithm using

00:07:20,630 --> 00:07:25,190
a psychic

00:07:22,280 --> 00:07:27,140
it has to be code reviewed by one too

00:07:25,190 --> 00:07:28,820
many people and then it gets deployed

00:07:27,140 --> 00:07:31,730
into production as a docker container

00:07:28,820 --> 00:07:34,400
and then it gets registered into

00:07:31,730 --> 00:07:37,870
amazon's ECR which is container registry

00:07:34,400 --> 00:07:41,120
and then someone goes in and actually

00:07:37,870 --> 00:07:43,370
hits run and gets the model building

00:07:41,120 --> 00:07:46,700
started and then the model config is

00:07:43,370 --> 00:07:49,610
stored back to s3 and then at the same

00:07:46,700 --> 00:07:53,510
time what we've done is we also deploy

00:07:49,610 --> 00:07:55,850
another docker container into our own

00:07:53,510 --> 00:07:57,979
container registry and then using a

00:07:55,850 --> 00:08:03,650
flask app we are able to also score a

00:07:57,979 --> 00:08:04,460
user using the same code now when all of

00:08:03,650 --> 00:08:09,140
this is happening

00:08:04,460 --> 00:08:11,479
image data which is PII and and losing

00:08:09,140 --> 00:08:13,910
our PII data would lead to huge

00:08:11,479 --> 00:08:14,330
regulatory fines so therefore all image

00:08:13,910 --> 00:08:17,240
data

00:08:14,330 --> 00:08:20,510
it stays encrypted on disk in s3 buckets

00:08:17,240 --> 00:08:22,370
and they are only decrypted by these

00:08:20,510 --> 00:08:24,440
containers which have the right

00:08:22,370 --> 00:08:26,240
credentials to decrypt them and then you

00:08:24,440 --> 00:08:27,950
can run these algorithms and that is

00:08:26,240 --> 00:08:30,020
where the speed at which you can decrypt

00:08:27,950 --> 00:08:31,790
images becomes very important and we are

00:08:30,020 --> 00:08:35,390
able to hit like right now 500 images

00:08:31,790 --> 00:08:38,990
per second so this is our pipeline we

00:08:35,390 --> 00:08:40,940
call it Nostradamus and it orchestrates

00:08:38,990 --> 00:08:43,789
across Amazon's as three buckets

00:08:40,940 --> 00:08:45,620
Amazon's ECR and Amazon Sage maker as

00:08:43,789 --> 00:08:51,530
our environment for billing or machine

00:08:45,620 --> 00:08:53,240
learning models and to conclude building

00:08:51,530 --> 00:08:56,899
an open financial system

00:08:53,240 --> 00:08:58,880
requires using AI at scale and in this

00:08:56,899 --> 00:09:01,339
talk I hope I have given you a window

00:08:58,880 --> 00:09:03,200
into what does it take to solve some of

00:09:01,339 --> 00:09:05,540
this really hard and challenging

00:09:03,200 --> 00:09:07,910
problems around fraud and identity

00:09:05,540 --> 00:09:10,820
verification using AI at scale

00:09:07,910 --> 00:09:12,560
my name is Supes once again and you can

00:09:10,820 --> 00:09:14,360
follow me on twitter at Supes Ranjan and

00:09:12,560 --> 00:09:15,560
thank you so much for giving me the

00:09:14,360 --> 00:09:16,480
opportunity to come and present here

00:09:15,560 --> 00:09:20,669
today thank you

00:09:16,480 --> 00:09:20,669
[Applause]

00:09:25,300 --> 00:09:27,360

YouTube URL: https://www.youtube.com/watch?v=R6Oml9I6DpI


