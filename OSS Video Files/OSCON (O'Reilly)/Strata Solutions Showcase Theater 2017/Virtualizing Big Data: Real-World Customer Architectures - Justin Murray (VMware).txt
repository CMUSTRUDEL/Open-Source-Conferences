Title: Virtualizing Big Data: Real-World Customer Architectures - Justin Murray (VMware)
Publication date: 2017-10-17
Playlist: Strata Solutions Showcase Theater 2017
Description: 
	Subscribe to O'Reilly on YouTube: http://goo.gl/n3QSYi

Follow O'Reilly on: 
Twitter: http://twitter.com/oreillymedia
Facebook: http://facebook.com/OReilly
Instagram: https://www.instagram.com/oreillymedia
LinkedIn: https://www.linkedin.com/company-beta/8459/
Captions: 
	                              good afternoon everybody welcome this is                               a                                                                    big data                               I'm from VMware my name is Justin Murray                               I'm in technical marketing at VMware in                               Palo Alto so the other side of the                               country what I'd like to spend                                  minutes or                                                            the potential and what is the desire and                                how would you actually virtualize if you                                went about it so agenda very briefly                                would be why would you virtualize Hadoop                                or SPARC and we've been testing SPARC                                heavily in our labs in Palo Alto and we                                feel quite comfortable that you can                                virtualize not just spark but machine                                learning and actually deep learning all                                of these things can be virtualized if                                you think about it they're virtualized                                in the public cloud already those are                                full of virtual machines anyway so I'm                                going to give you two reference                                architectures that we see commonly among                                our customer base and I'm going to show                                you a couple of graphs of performance in                                particular performance of machine                                learning and spark algorithms running on                                virtual machines on VMware and then I'm                                going to give you some references and                                feel free to talk to me afterwards about                                the content so why virtualize Hadoop it                                seems like a sort of a crazy thing to do                                after all with Hadoop we're trying to                                squeeze the last few ounces of                                performance out of our machines but in                                fact virtually virtualizing Hadoop is                                very beneficial to it and you're going                                to see graphs that show virtualized it                                actually runs as well as and slightly                                better than native bare metal and how                                could that be well it has to do with                                VMware optimizing the architecture the                                Numa architecture of the Hadoop                                environment and I'll say more about that                                later                                that's a performance point but the main                                reasons people want to virtualize or                                nobody has just one version of sparker                                and hadoop at any one time now if you're                                like me you're getting an email once a                                month from a hadoop vendor telling you                                there's the latest version                                        available I'm using                                                    you have two versions or something like                                that or three versions in your                                enterprise putting these things into                                machines and separating them that way is                                the best way to get multi-tenancy of the                                environment so that's a big reason                                people choose to virtualize they also                                want to separate out their developers                                from their testing people from their                                production people and virtualizing is                                the inherent way to do that but a lot of                                people really don't want to dedicate a                                full set of hardware to just one that do                                cluster anymore you have these ten boxes                                here in your data center and if you                                dedicate them to one cluster that's it                                for their lifetime you don't get to use                                them for anything else virtualization is                                a way to get around that and a lot of                                customers come to us and say I'm an IT                                department I I serve the business users                                and what I want to do is provide Hadoop                                clusters as a service to my end-users I                                want to provide it on the fly                                Hadoop and spark clusters what you're                                gonna see are some results of spark                                running on top of cloud era but we're                                also running spark standalone and                                recently VMware announced a project with                                Amazon Web Services and you can actually                                use VMware on Amazon now as a public                                cloud as well so just delving into the                                the architecture for a second I won't                                talk about this very much detail this is                                a classic yarn architecture that you'll                                recognize you've got masters on the                                left-hand side side and workers in the                                middle here and there are many hundreds                                of workers in a big cluster there are                                five or six masters on the left-hand                                side what does it mean to virtualize                                this do I have to change my Hadoop                                architecture my spark actor architecture                                if I virtualize the answer is really                                it's fairly simple I take everything                                that used to be on its own physical                                 machine and place it into a virtual                                 machine the red boxes or virtual                                 machines here so each of the workers                                 which contain the data node and the node                                 manager goes into a virtual machine and                                 those virtual machines might be four of                                 them to a server or two of them to a                                 server we almost never recommend you do                                 one verse                                 machine to a server because that doesn't                                 get you the pneuma benefits that I                                 referred to earlier and I'll say more                                 about that we might want to treat these                                 virtual machines or special cases these                                 are masters they must be alive for a                                 long time so we might want to put them                                 on expensive servers and put the workers                                 on cheaper servers but there's                                 absolutely no problem at all                                 with having four copies of the worker                                 code running in separated virtual                                 machines on the same physical server and                                 we do that all the time and we actually                                 get the best performance out of four                                 virtual machines                                 per server so I can give you lots of                                 reference architecture documentation on                                 that later on so what's the benefit                                 really virtual machines give you the                                 ability to have heterogeneous versions                                 heterogeneous versions of the operating                                 system heterogeneous versions of of the                                 cloudera software or Hortonworks                                 software allow allow you to do fault                                 isolation so one cluster doesn't affect                                 another cluster you can do that by                                 separating them off into something we                                 call resource pools you have fault                                 resiliency you have actually very good                                 performance when you virtual eyes                                 performance can be up to ten percent                                 better on vmware than it would be on                                 bare metal that's an outrageous claim                                 but I'm going to show you the types of                                 testing we've done to prove that so a                                 couple of real-world architectures and                                 these are fairly technical architectures                                 now I don't want you to be fazed by them                                 I can give you some more paperwork                                 technical white papers on them but these                                 are architectures that we come across                                 very frequently so these are two virtual                                 machines now running on VMware                                 hypervisor here and these are the direct                                 attached storage devices that typically                                 you would be using if you are doing this                                 all on physical so the first lesson is                                 exactly the same hardware that you would                                 have used for a physical Hadoop cluster                                 can now support two copies not just one                                 copy of the worker node from the same                                 cluster or from different clusters now                                 ignore ignore the the complexity                                 involved here all I'm doing here is                                 saying                                 I'm taking these discs and dedicating                                 them to this virtual machine and taking                                 this set of discs and dedicating them                                 completely to the left most virtual                                 machine so effectively I've achieved in                                 virtualization what I would have done at                                 the physical level which is these discs                                 are used by one and only virtual machine                                 only one virtual machine and they have                                 no interference from its partner that's                                 living on the same server this is the                                 direct attached storage model of                                 deploying VMware on on our Hadoop on                                 VMware it's completely traditional it                                 doesn't differ very much at all from                                 your standard way of doing it and                                 actually we co-wrote a reference                                 architecture with cloud era that                                 describes this so this model is                                 completely supported by cloud era as                                 well as ourselves and we wrote that back                                 in CDH                                                              we've been doing this now for about five                                 years or so so that's one architecture                                 for virtualizing that's in quite common                                 use actually among our customers a                                 second one is separating out the compute                                 from the data you're hearing a lot about                                 s                                                                  you're hearing a lot about other                                 protocols restoring data the whole point                                 is you want to be able to flex your                                 compute power without having to touch                                 your data power or you want to be able                                 to increase your data your data                                 fundamentals without changing your                                 compute and this is an architecture for                                 doing exactly that and we invented this                                 and this is also supported by cloud era                                 I would call this the data compute                                 separation model here the virtual                                 machines are not doing any of the data                                 handling all of the data handling is                                 being doing is being done across the                                 network by a device that understands                                 HDFS now this could equally well be s                                  or NFS or some other protocol that's                                 capable of feeding data to these data                                 nodes these node managers so this is                                 this is a virtualized cluster just for                                 compute and the benefits you get from                                 this is you can have more                                 Virtual Machines on the fly that just                                 contained node managers and don't have                                 any data node process in them in other                                 words they are data free they're just                                 reading their data across this fast                                 network to get it in for processing and                                 sending it back to HDFS again so a                                 classic model here is an Isilon server                                 if you have a nice long server that                                 thing understands HDFS and HDFS                                 protocols are obeyed across this                                 interface here my point though is really                                 there are a choice of architectures for                                 you to deploy virtualization on it's not                                 just one architecture in the future this                                 will be as three as well and it could                                 even be s                                                             machines running on VMware cloud on AWS                                 which is effectively running VMware on                                 AWS hardware that's what that is                                 so if we add into that some shared                                 storage here on the bottom left then                                 shared storage is what a lot of the                                 values of VMware like being able to move                                 virtual machines from one host server to                                 another that sort of V motion or live                                 migration capability is entirely a                                 function of shared storage so if you're                                 if you're HT FS data is remote from your                                 virtual machines and these virtual                                 machines only know it through a                                 reference on the network then they're                                 capable of moving around on the system                                 just as they would have done in regular                                 VMware regular vSphere so this is a                                 tremendous architecture that was                                 actually adopted by one of our major                                 systems integrators and they do this as                                 a hosted service for some of our                                 customers and this too has a document                                 from cloud era describing it so nothing                                 I'm talking about is in any way risky                                 here this is a vetted architecture by                                 the cloud era folks who we work with on                                 this you can get these documents from me                                 by the way if you send me an email I'll                                 send these documents as well as other                                 performance documents to you and there                                 is a statement of support from cloud are                                 on their website so if anybody were to                                 say to you I can't run my Hadoop                                 Cloudera on vmware it's not allowed it                                 actually is supported there's a support                                 statement there so the interesting point                                 in my talk comes up in performance and I                                 want you to focus in on the contrast                                 between the yellow bars and the gray                                 bars the gray bars represent physical                                 systems so in this case it was actually                                                                                                        there were four virtual machines running                                 on each of those servers in the gray                                 case there was one copy running on the                                 native operating system and you can see                                 here that for spark random forests                                 pretty contemporary workload logistic                                 regression showed the same result so                                 this is a machine learning algorithm                                 here random forests for virtual machines                                 came in faster than the physical gray                                 gray bars by an order of about                                     faster the reason for it is because the                                 hypervisor is placing those virtual                                 machines down into the Numa architecture                                 in a better way than physical Linux                                 would do it's not crossing Numa                                 boundaries in the same way that                                 processes on physical Linux would do and                                 that's the reason we're seeing lower                                 completion times ie better performance                                 on the yellow bars than on the gray bars                                 gray bars represent physical yellow bars                                 represent for virtual machines on each                                 of these servers so that that result is                                 at least a year old we've done this                                 twice now in a series of rigorous                                 performance tests and you can see that                                 also in the case of logistic regression                                 another machine learning this was using                                 ML Lib from the SPARC libraries and here                                 for virtual machines per server is again                                 faster than native all due to Numa and                                 networking parameters in the vSphere                                 technology so here's my set of                                 references I don't expect you to take                                 these down you can have these slides if                                 you're interested in them one one                                 reference I would like you to remember                                 is VMware calm / big - data via                                 more calm /big - data all of these                                 references will be available there or                                 you can also send me an email my email                                 is Jay Murray at VMware comm JM you are                                 our a.y at VMware calm and I'll send                                 these things to you there's at least                                 four four years of performance work done                                 in these papers finally then my                                 conclusions are Hadoop and spark                                 workloads and machine learning and even                                 deep learning workloads work very well                                 on vSphere vSphere runs on in-house                                 servers but it also runs on AWS servers                                 on in Amazon data centers that last part                                 is called VMware cloud on AWS so you can                                 run the same workload on in-house                                 vSphere as you would on public cloud                                 vSphere various performance studies have                                 shown that you don't lose anything by                                 doing this in fact you stand a good                                 chance of gaining performance from doing                                 that we have best practice guidelines                                 for you there are reference                                 architectures from cloud era and from                                 ourselves and then you can follow some                                 design patterns that we've laid out like                                 separating compute from data so                                 simplified management better efficiency                                 good performance and above all the                                 agility that comes from not dedicating                                 all of your hardware to just one Hadoop                                 cluster these are the benefits you get                                 from virtualizing they do come and talk                                 to us in the booth over there we're next                                 door to cloud era we're more than happy                                 to talk to you we have some of the demos                                 that I performance work that I showed                                 you here and we can show you that to you                                 and thank you
YouTube URL: https://www.youtube.com/watch?v=8wKGFM9fkFg


