Title: R Geoffrey Avery   Dancer: Getting to Hello World
Publication date: 2013-08-20
Playlist: YAPC::NA 2012
Description: 
	
Captions: 
	00:00:00,439 --> 00:00:05,460
well it looks close enough time so we'll

00:00:02,909 --> 00:00:08,630
get started hello I'm Geoff Avery and

00:00:05,460 --> 00:00:11,580
I'm here to talk about dancer well not

00:00:08,630 --> 00:00:13,679
actually dancer if you want to actually

00:00:11,580 --> 00:00:15,299
know how to use dancer itself come back

00:00:13,679 --> 00:00:18,570
in three hours for the introduction to

00:00:15,299 --> 00:00:20,490
dancer talk this is how to get to the

00:00:18,570 --> 00:00:23,420
starting line so that you'll be ready to

00:00:20,490 --> 00:00:25,590
do something with that talk last year

00:00:23,420 --> 00:00:27,000
during conference season I went to

00:00:25,590 --> 00:00:29,580
several talks trying to figure out how

00:00:27,000 --> 00:00:31,340
to use dancer and they all said here's

00:00:29,580 --> 00:00:34,860
your hello world script let's get going

00:00:31,340 --> 00:00:37,969
but that didn't work for me so that's

00:00:34,860 --> 00:00:43,230
why we're here today the parts up front

00:00:37,969 --> 00:00:44,789
so this is here probably not for any of

00:00:43,230 --> 00:00:47,129
you but I did give this to a larger

00:00:44,789 --> 00:00:49,500
audience it's what is dancer yet another

00:00:47,129 --> 00:00:53,010
one of those web frameworks based on

00:00:49,500 --> 00:00:55,500
Sinatra out of Ruby and it uses the

00:00:53,010 --> 00:01:00,449
middle layers of psg I and plaque and

00:00:55,500 --> 00:01:02,520
all that other good stuff what is PS

00:01:00,449 --> 00:01:05,040
it's the super glue that holds it all

00:01:02,520 --> 00:01:12,650
together so that you don't actually run

00:01:05,040 --> 00:01:15,900
it like CGI 2 p.m. in the old school if

00:01:12,650 --> 00:01:18,150
you go to most places and you ask how do

00:01:15,900 --> 00:01:20,100
you use the answer they show you are

00:01:18,150 --> 00:01:23,040
getting a quick start which basically

00:01:20,100 --> 00:01:25,650
boils down to those lines there first

00:01:23,040 --> 00:01:29,930
thing says make sure you have a version

00:01:25,650 --> 00:01:32,909
of dancer go collect it from Sipan then

00:01:29,930 --> 00:01:37,590
run its script which will make you a

00:01:32,909 --> 00:01:40,890
hello world site then go down into that

00:01:37,590 --> 00:01:43,049
site and run plaque up right from the

00:01:40,890 --> 00:01:46,829
command line which will start that site

00:01:43,049 --> 00:01:50,310
on port 5000 by default and then to use

00:01:46,829 --> 00:01:53,250
it you would go to your domain port five

00:01:50,310 --> 00:01:55,439
thousand and it's there and that works

00:01:53,250 --> 00:01:59,909
for development but do you really want

00:01:55,439 --> 00:02:01,649
to tell a user to go to port 5000 so I

00:01:59,909 --> 00:02:05,670
needed to figure out how to get around

00:02:01,649 --> 00:02:09,509
all that stuff I didn't have modern

00:02:05,670 --> 00:02:12,780
pearl yet I didn't have dancer I didn't

00:02:09,509 --> 00:02:13,319
have something to run the extra web

00:02:12,780 --> 00:02:15,510
pneus

00:02:13,319 --> 00:02:17,849
and everyone told me last year go with

00:02:15,510 --> 00:02:19,739
engine X naught Apache so that's what I

00:02:17,849 --> 00:02:21,389
did and all these slides will be the

00:02:19,739 --> 00:02:24,420
engine x side of things if you're an

00:02:21,389 --> 00:02:25,769
Apache person it's close you'll probably

00:02:24,420 --> 00:02:30,569
be able to figure it out and make the

00:02:25,769 --> 00:02:33,569
leap and lastly I wanted to get

00:02:30,569 --> 00:02:36,260
repository these slides are going to

00:02:33,569 --> 00:02:39,780
talk about to users in specific there is

00:02:36,260 --> 00:02:42,000
me who's doing the development and mr.

00:02:39,780 --> 00:02:44,219
prod who runs the other versions as

00:02:42,000 --> 00:02:46,980
somewhere we need to get repository

00:02:44,219 --> 00:02:48,810
between the two of us so that me can

00:02:46,980 --> 00:02:49,919
share push it all up and then mr. pride

00:02:48,810 --> 00:02:51,840
can take it down and put it where it

00:02:49,919 --> 00:02:54,389
needs to be and I didn't want to use

00:02:51,840 --> 00:03:00,239
github I wanted to do it all myself on

00:02:54,389 --> 00:03:01,590
my server with full control so that's

00:03:00,239 --> 00:03:03,870
where we're going to go we're going to

00:03:01,590 --> 00:03:07,650
do all those parts we're starting from a

00:03:03,870 --> 00:03:10,019
fresh linode within bhuntu on it right

00:03:07,650 --> 00:03:12,919
out of the box has nothing else so we're

00:03:10,019 --> 00:03:15,659
going to install pearl and dancer and

00:03:12,919 --> 00:03:17,129
engine X and everything to get you all

00:03:15,659 --> 00:03:24,060
the way the starting line so in three

00:03:17,129 --> 00:03:26,759
hours his talk will make sense there are

00:03:24,060 --> 00:03:28,079
extra slides after the slides were going

00:03:26,759 --> 00:03:30,030
through we're going to the 20 minute

00:03:28,079 --> 00:03:33,000
version there's another 20 minutes of

00:03:30,030 --> 00:03:34,500
material on some other stuff kind of

00:03:33,000 --> 00:03:36,569
what we go on in the other talk but I

00:03:34,500 --> 00:03:39,180
gave this at a conference where it was

00:03:36,569 --> 00:03:41,609
not other pearl people so they needed

00:03:39,180 --> 00:03:46,290
that stuff from me so it is there in the

00:03:41,609 --> 00:03:48,299
bonus slides I'm going to make some

00:03:46,290 --> 00:03:50,120
assumptions you always make assumptions

00:03:48,299 --> 00:03:53,970
so let's just get them out of the way

00:03:50,120 --> 00:03:56,219
anytime you see stuff in a box it means

00:03:53,970 --> 00:03:58,530
that I'm telling you something if you

00:03:56,219 --> 00:04:00,479
see it in red with a background that

00:03:58,530 --> 00:04:03,689
means we're doing things in the name of

00:04:00,479 --> 00:04:05,549
root or if not in the name of root the

00:04:03,689 --> 00:04:09,629
name of some super special user who's

00:04:05,549 --> 00:04:12,810
not me or mr. prod you should do these

00:04:09,629 --> 00:04:13,979
things carefully do not become someone

00:04:12,810 --> 00:04:16,469
special unless you know what you're

00:04:13,979 --> 00:04:18,900
doing and don't stay him longer than you

00:04:16,469 --> 00:04:20,789
need to be next we'll have some things

00:04:18,900 --> 00:04:22,830
that show up in green those are done is

00:04:20,789 --> 00:04:24,779
me and finally some things that show up

00:04:22,830 --> 00:04:25,920
in blue those are done is mr. prod our

00:04:24,779 --> 00:04:27,840
production guy who

00:04:25,920 --> 00:04:35,720
just somebody else you can think of them

00:04:27,840 --> 00:04:38,940
as another developer if you want so I

00:04:35,720 --> 00:04:40,080
have to put my stuff somewhere and it's

00:04:38,940 --> 00:04:42,600
going to show up in all the examples

00:04:40,080 --> 00:04:44,760
along the way so I'm showing them all to

00:04:42,600 --> 00:04:46,560
you now so that if you see them in later

00:04:44,760 --> 00:04:48,030
slides you know what to get one cut and

00:04:46,560 --> 00:04:51,050
replace and put in something that makes

00:04:48,030 --> 00:04:54,000
sense on your server so I have a domain

00:04:51,050 --> 00:04:55,770
dying DNS lets you get one for free so I

00:04:54,000 --> 00:04:58,220
did that's why it's three layers deep

00:04:55,770 --> 00:05:02,280
not just too because i'm using layers i

00:04:58,220 --> 00:05:05,220
need a place to put my logs so the

00:05:02,280 --> 00:05:06,810
plaque up plaque versions of them are

00:05:05,220 --> 00:05:07,980
going to end up here the engine next

00:05:06,810 --> 00:05:09,930
versions are going to end up here and

00:05:07,980 --> 00:05:11,940
then under the sub domains will have

00:05:09,930 --> 00:05:15,480
another directory for each site we've

00:05:11,940 --> 00:05:17,670
got going and the actual sites will be

00:05:15,480 --> 00:05:19,830
told to engine X using this arrangement

00:05:17,670 --> 00:05:22,680
which is the same way Apache does it you

00:05:19,830 --> 00:05:24,930
put your configurations in available and

00:05:22,680 --> 00:05:26,760
you make a symlink from enabled so that

00:05:24,930 --> 00:05:28,350
if you want to disable it you break the

00:05:26,760 --> 00:05:29,610
symlink and you don't have to take your

00:05:28,350 --> 00:05:31,380
code out and then have to get it back

00:05:29,610 --> 00:05:39,360
later out of get or wherever you put it

00:05:31,380 --> 00:05:41,580
someplace safe assumptions for me I'm

00:05:39,360 --> 00:05:43,560
going to have to put my files somewhere

00:05:41,580 --> 00:05:44,790
so in my home directory there's a site

00:05:43,560 --> 00:05:47,760
called websites and we'll put it in

00:05:44,790 --> 00:05:50,400
there we're going to tack nita dev to

00:05:47,760 --> 00:05:52,050
the front of the URL make it now five

00:05:50,400 --> 00:05:56,160
layers deep because everybody likes big

00:05:52,050 --> 00:05:58,890
long URLs we're going to pick port 8000

00:05:56,160 --> 00:06:01,530
as the base for anything that is owned

00:05:58,890 --> 00:06:03,960
by us so one of our ports going to be 80

00:06:01,530 --> 00:06:06,690
21 and there's going to be a t20 to mr.

00:06:03,960 --> 00:06:08,520
prod we'll do it somewhere else and the

00:06:06,690 --> 00:06:12,420
username is me and the user ID is a

00:06:08,520 --> 00:06:14,130
thousand those parts aren't terribly

00:06:12,420 --> 00:06:15,480
important for the discussion but if you

00:06:14,130 --> 00:06:18,630
see them later now you know what to

00:06:15,480 --> 00:06:21,150
replace mr. prod has two sets he has a

00:06:18,630 --> 00:06:23,400
dev and a production version and they

00:06:21,150 --> 00:06:26,070
have their own port ranges so that we

00:06:23,400 --> 00:06:27,420
can keep everything the same but

00:06:26,070 --> 00:06:29,220
different the reason I went through such

00:06:27,420 --> 00:06:31,680
a complicated structure is on my real

00:06:29,220 --> 00:06:33,750
server I have 13 different domains and

00:06:31,680 --> 00:06:35,220
there's me and the other guy and I just

00:06:33,750 --> 00:06:37,970
need to keep them all lined up and

00:06:35,220 --> 00:06:37,970
working the same way

00:06:40,179 --> 00:06:44,529
for the individual projects we're going

00:06:42,589 --> 00:06:46,939
to talk about the first one on port 21

00:06:44,529 --> 00:06:49,369
this is the domain it's going to end up

00:06:46,939 --> 00:06:51,409
at and this is the directory where we're

00:06:49,369 --> 00:06:53,029
going to put our stuff inside my

00:06:51,409 --> 00:06:54,529
websites directory and that's what we'll

00:06:53,029 --> 00:06:57,379
check in to get the other guy will check

00:06:54,529 --> 00:06:59,209
out and the other two are very similar

00:06:57,379 --> 00:07:00,469
and on different ports because if they

00:06:59,209 --> 00:07:09,019
were on the same port we'd have a

00:07:00,469 --> 00:07:10,819
problem so now we get to do the

00:07:09,019 --> 00:07:13,039
beginning of our steps to actually take

00:07:10,819 --> 00:07:15,110
a blank on boom to box and do something

00:07:13,039 --> 00:07:17,299
with it it probably works the same for

00:07:15,110 --> 00:07:20,689
all the other flavors of unix but this

00:07:17,299 --> 00:07:23,869
one works for sure so before you get

00:07:20,689 --> 00:07:26,779
started let's apt-get update and upgrade

00:07:23,869 --> 00:07:30,139
make sure everything you have is all up

00:07:26,779 --> 00:07:32,749
to date i used the i did this back in

00:07:30,139 --> 00:07:34,249
March and April before the new long-term

00:07:32,749 --> 00:07:37,099
release came out so I was using the long

00:07:34,249 --> 00:07:43,309
term release from two years ago so this

00:07:37,099 --> 00:07:45,049
step could take a while now we're going

00:07:43,309 --> 00:07:47,239
to be installing pearl along the way

00:07:45,049 --> 00:07:49,399
pearl needs see it'd be nice of Sweden

00:07:47,239 --> 00:07:51,529
which see so we're going to grab GCC and

00:07:49,399 --> 00:07:53,329
because I was doing some other stuff on

00:07:51,529 --> 00:07:56,209
my machine I thought I might need ssl

00:07:53,329 --> 00:08:02,269
why always at it so I just chose to

00:07:56,209 --> 00:08:04,519
apt-get install these things if that

00:08:02,269 --> 00:08:05,899
combination isn't what you need go ahead

00:08:04,519 --> 00:08:08,029
and change it the point is this

00:08:05,899 --> 00:08:10,009
combination will work and get you to the

00:08:08,029 --> 00:08:11,809
starting line several of the

00:08:10,009 --> 00:08:15,139
combinations on later slides I asked for

00:08:11,809 --> 00:08:17,059
too many things memories cheap big hard

00:08:15,139 --> 00:08:19,299
drive is probably not a problem but if

00:08:17,059 --> 00:08:21,799
you want to trim it down go ahead

00:08:19,299 --> 00:08:24,079
whenever you do an apt get install and

00:08:21,799 --> 00:08:26,179
it wants to add install anything other

00:08:24,079 --> 00:08:28,879
than exactly what you asked for it will

00:08:26,179 --> 00:08:30,649
ask do you want me to do it and here are

00:08:28,879 --> 00:08:34,039
the other things I'm going to go get on

00:08:30,649 --> 00:08:36,829
your behalf so go ahead and say yes make

00:08:34,039 --> 00:08:38,659
it happen I've been told recently that

00:08:36,829 --> 00:08:41,509
if you try to install thing

00:08:38,659 --> 00:08:43,250
build-essential it will get you GCC and

00:08:41,509 --> 00:08:45,559
make and a bunch of those other

00:08:43,250 --> 00:08:46,939
essential things that real programmers

00:08:45,559 --> 00:08:51,129
are happy with so if you want to flip

00:08:46,939 --> 00:08:51,129
and add a few extra things go ahead

00:08:52,540 --> 00:08:58,550
engine X it doesn't need anything else

00:08:56,630 --> 00:09:00,770
so when you say install engine X it just

00:08:58,550 --> 00:09:07,550
happens in this little it look like when

00:09:00,770 --> 00:09:10,460
it puts it on for you root i'm going to

00:09:07,550 --> 00:09:12,680
set an alias and tell it where to point

00:09:10,460 --> 00:09:14,450
something so we're going to set the

00:09:12,680 --> 00:09:17,120
pearl brew route where we're going to

00:09:14,450 --> 00:09:18,320
install all our pearls if you forget

00:09:17,120 --> 00:09:21,800
this it's going to want to do it in your

00:09:18,320 --> 00:09:24,980
home directory and I'm going to give it

00:09:21,800 --> 00:09:27,020
an engine next restart so that you can

00:09:24,980 --> 00:09:29,110
just run that and it will kick the

00:09:27,020 --> 00:09:32,240
server and restart your front ends I

00:09:29,110 --> 00:09:33,620
give it to you both ways most times and

00:09:32,240 --> 00:09:35,270
when you find instructions how to do

00:09:33,620 --> 00:09:37,760
this it gives you the bash version I

00:09:35,270 --> 00:09:40,160
play for the other team so I put us up

00:09:37,760 --> 00:09:44,360
on top but they're both here translated

00:09:40,160 --> 00:09:47,390
whichever way you want to go next pearl

00:09:44,360 --> 00:09:49,340
brew which is the thing that allows you

00:09:47,390 --> 00:09:52,310
to install multiple versions of pearl on

00:09:49,340 --> 00:09:54,710
your system in the normal way of running

00:09:52,310 --> 00:09:56,150
it you run it as you the mortal user you

00:09:54,710 --> 00:09:58,430
install all your pearls in your home

00:09:56,150 --> 00:10:00,680
directory and you pick whichever one you

00:09:58,430 --> 00:10:02,660
want switch back and forth because me

00:10:00,680 --> 00:10:04,580
and mr. prod want to be consistent I'm

00:10:02,660 --> 00:10:07,850
doing this in the name of route we're

00:10:04,580 --> 00:10:09,800
going to install it in opt pearl which

00:10:07,850 --> 00:10:11,210
we told it on the last slide so that

00:10:09,800 --> 00:10:18,530
both of us can point to the same place

00:10:11,210 --> 00:10:20,540
and avoid any confusion next pearl brew

00:10:18,530 --> 00:10:23,120
in it which will get it up and running

00:10:20,540 --> 00:10:25,250
and make some places for it which you

00:10:23,120 --> 00:10:27,860
need to go to the place where it

00:10:25,250 --> 00:10:30,620
actually is I should take that back

00:10:27,860 --> 00:10:32,600
since we did it as root pearl brew with

00:10:30,620 --> 00:10:35,920
the system pearl is in your path and

00:10:32,600 --> 00:10:39,860
this would just work from anywhere then

00:10:35,920 --> 00:10:42,110
you can pearl brew available and this

00:10:39,860 --> 00:10:44,390
was the list as it existed in the spring

00:10:42,110 --> 00:10:46,370
of course we've gone to the next major

00:10:44,390 --> 00:10:51,020
release the 516 is out now and that's

00:10:46,370 --> 00:10:53,210
what you'd probably want so then you

00:10:51,020 --> 00:10:55,250
just say install and the one you want

00:10:53,210 --> 00:10:57,860
and it's going to put it in the

00:10:55,250 --> 00:11:00,190
directory you had chosen earlier and it

00:10:57,860 --> 00:11:03,230
says here this could take a while

00:11:00,190 --> 00:11:04,279
they're not kidding it took me about 20

00:11:03,230 --> 00:11:05,660
minutes

00:11:04,279 --> 00:11:07,910
snack they'll be there when you get back

00:11:05,660 --> 00:11:09,649
you can tail the log and see what's

00:11:07,910 --> 00:11:10,879
going on if you are impatient want to

00:11:09,649 --> 00:11:16,850
see what's happening during your 20

00:11:10,879 --> 00:11:18,620
minutes and then because I know

00:11:16,850 --> 00:11:20,779
eventually I'm going to want a different

00:11:18,620 --> 00:11:23,329
pearl and I don't want to go change in

00:11:20,779 --> 00:11:25,819
lines anywhere I'm going to make a

00:11:23,329 --> 00:11:28,639
symlink so that opt pearl brew current

00:11:25,819 --> 00:11:30,439
will always be the current pearl that we

00:11:28,639 --> 00:11:32,389
are using for all our development which

00:11:30,439 --> 00:11:34,040
is not the system pearl because remember

00:11:32,389 --> 00:11:35,720
all those apt-get things some of them

00:11:34,040 --> 00:11:40,509
use pearl and you change it out from

00:11:35,720 --> 00:11:40,509
underneath them well hilarity may ensue

00:11:42,910 --> 00:11:48,680
now we're up to actually doing something

00:11:45,529 --> 00:11:52,309
with pearl itself let's go ahead and get

00:11:48,680 --> 00:11:55,670
dancer and I'm getting dbi and sqlite

00:11:52,309 --> 00:11:56,779
now because we might need them later go

00:11:55,670 --> 00:12:01,100
ahead and get them all you're doing the

00:11:56,779 --> 00:12:09,170
gettin dancer plaque some extra plaque

00:12:01,100 --> 00:12:11,360
stuff template toolkit and star man as a

00:12:09,170 --> 00:12:13,519
user i'm going to set some aliases i

00:12:11,360 --> 00:12:15,800
think one of the slides mentions der so

00:12:13,519 --> 00:12:18,019
i put it here i always use that

00:12:15,800 --> 00:12:21,259
combination and we're going to add to

00:12:18,019 --> 00:12:23,899
our path right out front current bin so

00:12:21,259 --> 00:12:25,579
that the pearl that we've installed and

00:12:23,899 --> 00:12:27,079
said we're using is the one that our

00:12:25,579 --> 00:12:33,920
user will always use because it's at the

00:12:27,079 --> 00:12:36,230
front of the path so we need a sandbox

00:12:33,920 --> 00:12:40,250
we need some place to put our stuff so

00:12:36,230 --> 00:12:42,139
as me I'm going to go in and make a

00:12:40,250 --> 00:12:45,620
directory and go into it that's where

00:12:42,139 --> 00:12:48,199
we're going to make it we will then say

00:12:45,620 --> 00:12:50,480
dancer minus a and you give it to it as

00:12:48,199 --> 00:12:56,500
a module name it will be creating a

00:12:50,480 --> 00:12:56,500
module down in the lip that's tool it Oh

00:12:57,459 --> 00:13:00,970
somebody said something

00:13:03,560 --> 00:13:10,950
there we go in the lib section you can

00:13:08,970 --> 00:13:13,440
see it shows up as a module in the

00:13:10,950 --> 00:13:15,120
normal way with the p.m. and that's what

00:13:13,440 --> 00:13:16,740
coordinates everything this is the

00:13:15,120 --> 00:13:18,810
actual list you'll get if you run that

00:13:16,740 --> 00:13:20,459
command it will show it would be

00:13:18,810 --> 00:13:22,529
slightly longer because it also listed

00:13:20,459 --> 00:13:24,329
as creating the directories but I needed

00:13:22,529 --> 00:13:31,490
the screen space and I'm figure you're

00:13:24,329 --> 00:13:34,470
all smart enough to handle that now if

00:13:31,490 --> 00:13:36,870
you run this command from the command

00:13:34,470 --> 00:13:38,670
line we will start it up on the port

00:13:36,870 --> 00:13:40,740
we're choosing and I'm going to throw

00:13:38,670 --> 00:13:42,209
that flag in and switch it to 8021 to be

00:13:40,740 --> 00:13:46,769
consistent with where we want it to be

00:13:42,209 --> 00:13:57,019
you point to the app script apt up PL in

00:13:46,769 --> 00:13:57,019
your bin and when you do that you end up

00:13:57,980 --> 00:14:07,470
here at port 80 21 and that is the hello

00:14:02,940 --> 00:14:09,540
world site the dancer gives you which

00:14:07,470 --> 00:14:10,440
does stuff and if you click here it

00:14:09,540 --> 00:14:13,620
tells you some of your environment

00:14:10,440 --> 00:14:16,019
variables and then from there you can

00:14:13,620 --> 00:14:18,360
start with the other lesson and actually

00:14:16,019 --> 00:14:20,430
do something to it but this is still on

00:14:18,360 --> 00:14:25,470
port 80 21 which is not quite where we'd

00:14:20,430 --> 00:14:26,970
like to be so let's keep going we're

00:14:25,470 --> 00:14:32,959
going to tell engine X about our site

00:14:26,970 --> 00:14:36,209
and we're going to go in and unavailable

00:14:32,959 --> 00:14:38,880
give it a file the important bits in

00:14:36,209 --> 00:14:40,500
here or you can tell it some locations

00:14:38,880 --> 00:14:42,180
for static things that aren't going to

00:14:40,500 --> 00:14:44,610
change dancer doesn't need to know about

00:14:42,180 --> 00:14:46,860
them your images are your images just

00:14:44,610 --> 00:14:49,319
put them out front and then this bit on

00:14:46,860 --> 00:14:51,779
the end sets all the proxy parts that

00:14:49,319 --> 00:14:54,269
says when you call me by the domain you

00:14:51,779 --> 00:14:56,190
just told me I'm not actually going to

00:14:54,269 --> 00:14:57,720
do anything for you but I know dancer

00:14:56,190 --> 00:15:00,269
knows how so why didn't you go over to

00:14:57,720 --> 00:15:01,589
port 80 21 on localhost here and he'll

00:15:00,269 --> 00:15:04,319
take care of it and I'll just send it

00:15:01,589 --> 00:15:07,769
through that part took me forever to

00:15:04,319 --> 00:15:10,430
figure out it shouldn't be that hard but

00:15:07,769 --> 00:15:10,430
it was

00:15:12,870 --> 00:15:16,950
now we want engine X to actually serve

00:15:15,120 --> 00:15:19,830
up the site so of course we need to make

00:15:16,950 --> 00:15:21,180
a link from enabled from available to

00:15:19,830 --> 00:15:26,279
enabled so that it will know what it's

00:15:21,180 --> 00:15:29,970
doing and then you kick the server now

00:15:26,279 --> 00:15:31,950
in order to not start your thing up from

00:15:29,970 --> 00:15:33,810
the command line with plaque up and see

00:15:31,950 --> 00:15:36,600
your logs right there in front of you

00:15:33,810 --> 00:15:38,430
you'd like it to behave a little more

00:15:36,600 --> 00:15:40,320
like a patching engine X and go do its

00:15:38,430 --> 00:15:43,380
thing in the background so that's what

00:15:40,320 --> 00:15:46,770
star man does it sits between the plaque

00:15:43,380 --> 00:15:48,720
and the front and everybody's happy you

00:15:46,770 --> 00:15:51,320
can say which port to listen on although

00:15:48,720 --> 00:15:53,790
here is not dash p it's now dash listen

00:15:51,320 --> 00:15:57,089
you can give us some access law some

00:15:53,790 --> 00:15:59,070
logs the number of workers defaults 25

00:15:57,089 --> 00:16:00,750
if you're just doing it on your

00:15:59,070 --> 00:16:03,839
development machine and it's only you

00:16:00,750 --> 00:16:08,310
one's probably enough so I fin that out

00:16:03,839 --> 00:16:10,339
and this part I didn't know you could do

00:16:08,310 --> 00:16:13,740
this sort of thing before I started but

00:16:10,339 --> 00:16:15,779
you can put your process ID in a file so

00:16:13,740 --> 00:16:19,920
that later you can see it which is how

00:16:15,779 --> 00:16:21,810
the restart works because it knows where

00:16:19,920 --> 00:16:24,150
to go kill I can go find the process

00:16:21,810 --> 00:16:29,130
idea it needs to play with so this will

00:16:24,150 --> 00:16:30,270
take care of that and lastly the app PL

00:16:29,130 --> 00:16:37,500
which is actually going to do the

00:16:30,270 --> 00:16:40,290
running and if you do that then that was

00:16:37,500 --> 00:16:42,170
the one through on port 80 21 here it is

00:16:40,290 --> 00:16:44,550
through the long domain name and

00:16:42,170 --> 00:16:52,770
strangely it's almost exactly the same

00:16:44,550 --> 00:16:55,470
and should there too to stop the backend

00:16:52,770 --> 00:16:57,990
server you can kill it and you want to

00:16:55,470 --> 00:17:00,300
cat out the contents of that file that

00:16:57,990 --> 00:17:03,180
we just created that has the process ID

00:17:00,300 --> 00:17:05,790
of star man so that way you can kill it

00:17:03,180 --> 00:17:09,929
off I actually have written a script

00:17:05,790 --> 00:17:12,300
that takes is in input which domain i'm

00:17:09,929 --> 00:17:14,970
playing with am I on prod ever my

00:17:12,300 --> 00:17:17,640
version and what I want to do start stop

00:17:14,970 --> 00:17:19,439
the back end all those things and I can

00:17:17,640 --> 00:17:22,890
do more than one at a time with 13

00:17:19,439 --> 00:17:24,290
domains it's much better that way some

00:17:22,890 --> 00:17:27,770
more reading

00:17:24,290 --> 00:17:30,110
these are things i found along the way

00:17:27,770 --> 00:17:32,770
that might help you take that next step

00:17:30,110 --> 00:17:37,040
actually after you have the site so

00:17:32,770 --> 00:17:41,960
logging and in and doing Redis and other

00:17:37,040 --> 00:17:43,900
interesting things some thank yous for

00:17:41,960 --> 00:17:48,350
people who have helped me along the way

00:17:43,900 --> 00:17:49,880
and now I'd like to get into the first

00:17:48,350 --> 00:17:51,350
bonus topic because I still have a

00:17:49,880 --> 00:17:57,680
couple minutes and then we'll go to

00:17:51,350 --> 00:17:59,450
questions the way it configures stuff

00:17:57,680 --> 00:18:01,850
there are several places where you can

00:17:59,450 --> 00:18:04,250
do it there is a config that yamo

00:18:01,850 --> 00:18:06,860
there's also an environments directory

00:18:04,250 --> 00:18:08,420
that has production yamo and development

00:18:06,860 --> 00:18:10,430
dot y amal and you can tell it which one

00:18:08,420 --> 00:18:12,230
to use and then you can also do it

00:18:10,430 --> 00:18:14,660
straight up in app PL so there's four

00:18:12,230 --> 00:18:18,080
places you can do your stuff this is the

00:18:14,660 --> 00:18:20,530
way it comes by default and notice that

00:18:18,080 --> 00:18:23,060
we're using a simple template existe me

00:18:20,530 --> 00:18:25,130
you're probably going to jump over to

00:18:23,060 --> 00:18:28,100
template toolkit so they give you that

00:18:25,130 --> 00:18:33,500
stuff here and I decided I'm going to do

00:18:28,100 --> 00:18:36,380
that so I went and I change the file to

00:18:33,500 --> 00:18:39,530
be like this I left these two commented

00:18:36,380 --> 00:18:42,170
out seems templating toolkit in the old

00:18:39,530 --> 00:18:44,480
days did it with square braces and now

00:18:42,170 --> 00:18:46,280
it uses angle braces so if you're

00:18:44,480 --> 00:18:48,770
old-fashioned and want the old style

00:18:46,280 --> 00:18:50,210
you'd have to put those back in since

00:18:48,770 --> 00:18:52,010
i'm not an old-fashioned template

00:18:50,210 --> 00:18:54,110
toolkit guy i'm just going to new way

00:18:52,010 --> 00:18:55,490
with the angle so i didn't do that but

00:18:54,110 --> 00:19:03,040
there's something wrong with this file

00:18:55,490 --> 00:19:07,400
can anyone see what i did wrong what yes

00:19:03,040 --> 00:19:11,450
yamel is very picky spacing matters kind

00:19:07,400 --> 00:19:15,590
of like in Python so I did that and what

00:19:11,450 --> 00:19:20,030
happens when you do that is that this

00:19:15,590 --> 00:19:23,870
chunk of error message repeats over and

00:19:20,030 --> 00:19:29,680
over again inside your log because it

00:19:23,870 --> 00:19:34,730
can't start up and I messed it up on

00:19:29,680 --> 00:19:37,400
some but not all of my 13 sites in three

00:19:34,730 --> 00:19:38,210
different flavors and I didn't really

00:19:37,400 --> 00:19:40,190
think anything

00:19:38,210 --> 00:19:44,570
of it and then my machine stopped

00:19:40,190 --> 00:19:46,880
working that fills log files up that

00:19:44,570 --> 00:19:50,420
fills hard drives up that makes

00:19:46,880 --> 00:19:52,250
computers very cranky it's not something

00:19:50,420 --> 00:19:54,140
that's terribly obvious because it

00:19:52,250 --> 00:19:57,790
doesn't really complain to you very well

00:19:54,140 --> 00:20:03,680
but now when you see this you will know

00:19:57,790 --> 00:20:06,290
what you might have done wrong and this

00:20:03,680 --> 00:20:11,150
is the right way to do it there are some

00:20:06,290 --> 00:20:13,910
more spaces here to get things under the

00:20:11,150 --> 00:20:15,410
rights place I had done it the wrong way

00:20:13,910 --> 00:20:17,240
earlier and it thought that these two

00:20:15,410 --> 00:20:19,970
things here template and engines were

00:20:17,240 --> 00:20:28,660
actually subsets of this one which they

00:20:19,970 --> 00:20:32,420
are not and that takes us to the end

00:20:28,660 --> 00:20:38,900
what I wanted to get through so any

00:20:32,420 --> 00:20:40,790
questions yep yes the link will be on

00:20:38,900 --> 00:20:42,800
the conference websites description of

00:20:40,790 --> 00:20:44,960
the talk I have to get the move over to

00:20:42,800 --> 00:20:47,180
the production server which of course

00:20:44,960 --> 00:20:49,790
means i have to push them in as me and

00:20:47,180 --> 00:20:51,380
mr. prod will take him out actually i

00:20:49,790 --> 00:20:53,120
push them in as Jeff I used me on the

00:20:51,380 --> 00:21:04,130
other machine because it's more generic

00:20:53,120 --> 00:21:08,470
for the talks yeah I didn't know about

00:21:04,130 --> 00:21:12,590
server start over mud or ubique I did

00:21:08,470 --> 00:21:15,140
okay last year during conference season

00:21:12,590 --> 00:21:16,820
my went to several conferences several

00:21:15,140 --> 00:21:19,970
different people talking about dancer I

00:21:16,820 --> 00:21:21,680
went up and asked them and all this

00:21:19,970 --> 00:21:23,660
stuff seems to be the things that if

00:21:21,680 --> 00:21:27,500
you're really in the dancer or any other

00:21:23,660 --> 00:21:30,110
big project you forgot two years ago so

00:21:27,500 --> 00:21:36,280
I got it all put together and decided

00:21:30,110 --> 00:21:36,280
just stop someone else's pain yes

00:21:43,600 --> 00:21:50,210
yes yes I need to get back with the

00:21:48,020 --> 00:21:56,620
dancer documentation so i'll try to

00:21:50,210 --> 00:21:56,620
coordinate with you guys anything else

00:21:57,160 --> 00:22:04,090
well then thank you for coming and if

00:22:01,039 --> 00:22:04,090

YouTube URL: https://www.youtube.com/watch?v=rWkmlWOkobg


