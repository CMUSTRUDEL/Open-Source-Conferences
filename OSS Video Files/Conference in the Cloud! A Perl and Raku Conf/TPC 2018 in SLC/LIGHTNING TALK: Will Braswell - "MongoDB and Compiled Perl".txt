Title: LIGHTNING TALK: Will Braswell - "MongoDB and Compiled Perl"
Publication date: 2018-06-21
Playlist: TPC 2018 in SLC
Description: 
	
Captions: 
	00:00:00,650 --> 00:00:08,750
hello everyone my name is will the chill

00:00:05,009 --> 00:00:12,750
and I'm here to show you some compiled

00:00:08,750 --> 00:00:16,859
purl if this is the first time that

00:00:12,750 --> 00:00:20,609
you've ever seen me I'm the author of

00:00:16,859 --> 00:00:22,289
the art Perl compiler and the demo that

00:00:20,609 --> 00:00:24,630
I have for you today is a very quick

00:00:22,289 --> 00:00:28,019
demo of the latest work that I've done

00:00:24,630 --> 00:00:30,000
to implement database support in our

00:00:28,019 --> 00:00:33,440
Perl and specifically today we're going

00:00:30,000 --> 00:00:37,500
to talk about

00:00:33,440 --> 00:00:41,820
this is kind of small font is that

00:00:37,500 --> 00:00:43,649
visible no okay well you guys are gonna

00:00:41,820 --> 00:00:44,940
have to give me an extra 20 seconds here

00:00:43,649 --> 00:00:46,200
because I already change the font size

00:00:44,940 --> 00:00:50,309
once and now I'm gonna have to do it

00:00:46,200 --> 00:00:51,210
again and I can't even see what I'm

00:00:50,309 --> 00:00:56,850
doing here

00:00:51,210 --> 00:00:59,910
oh my goodness there it goes okay dance

00:00:56,850 --> 00:01:05,339
no I know how to juggle I swore I

00:00:59,910 --> 00:01:05,760
wouldn't sing okay it's good is that

00:01:05,339 --> 00:01:09,659
better

00:01:05,760 --> 00:01:12,450
I hope so okay good I'm on my demo

00:01:09,659 --> 00:01:14,369
server what do I have here one file

00:01:12,450 --> 00:01:19,799
what's in that file

00:01:14,369 --> 00:01:22,950
let's take a look oh yes I know that end

00:01:19,799 --> 00:01:26,490
anyway okay boiler plate at the top use

00:01:22,950 --> 00:01:28,320
our pearl this loads a ton of special

00:01:26,490 --> 00:01:31,850
stuff for the compiler you'll notice

00:01:28,320 --> 00:01:35,640
that there's a our Perl support MongoDB

00:01:31,850 --> 00:01:39,049
this does use like the existing

00:01:35,640 --> 00:01:42,000
support under the hood when you're in

00:01:39,049 --> 00:01:46,380
interpretive mode which is what I think

00:01:42,000 --> 00:01:50,130
everybody here knows as normal Perl so

00:01:46,380 --> 00:01:52,799
let's go ahead and just you can briefly

00:01:50,130 --> 00:01:56,040
look here's the code it loads up a

00:01:52,799 --> 00:01:57,689
database it gets the database it gets a

00:01:56,040 --> 00:02:01,170
collection it creates a beasts on

00:01:57,689 --> 00:02:05,640
document stream with some test data in

00:02:01,170 --> 00:02:09,149
there foo integer some numbers a b c d e

00:02:05,640 --> 00:02:12,990
f and then it simply does an insert on

00:02:09,149 --> 00:02:15,210
that and then it also so it's an insert

00:02:12,990 --> 00:02:16,560
and then below that is a find one so if

00:02:15,210 --> 00:02:18,870
you don't know how long ago works that's

00:02:16,560 --> 00:02:23,040
fine I'm also not a expert I'm

00:02:18,870 --> 00:02:26,130
just a compiler guy but there it is

00:02:23,040 --> 00:02:28,590
that's that's the Perl code okay let's

00:02:26,130 --> 00:02:30,600
go ahead and run this you'll notice the

00:02:28,590 --> 00:02:33,420
first time it runs it's going to do this

00:02:30,600 --> 00:02:37,890
bootstrapping process where it has to

00:02:33,420 --> 00:02:40,380
compile its own helper functions and

00:02:37,890 --> 00:02:42,360
then it runs and that's running at the

00:02:40,380 --> 00:02:44,850
normal speed of normal interpreted Perl

00:02:42,360 --> 00:02:47,190
and you can see there's our little data

00:02:44,850 --> 00:02:52,190
the ABCDEF then the demo data that I

00:02:47,190 --> 00:02:55,830
inserted into the database now

00:02:52,190 --> 00:03:00,090
let's compile it all we have to do is

00:02:55,830 --> 00:03:04,590
run the command our perl and it's going

00:03:00,090 --> 00:03:08,580
to compile thanks to inline Thank You

00:03:04,590 --> 00:03:10,650
engi and there's a gigantic G plus plus

00:03:08,580 --> 00:03:13,980
thanks to everyone who developed the ANU

00:03:10,650 --> 00:03:16,380
compiler collection it is now generating

00:03:13,980 --> 00:03:18,870
a binary file and it will run that file

00:03:16,380 --> 00:03:20,730
as soon as it's done there it goes it

00:03:18,870 --> 00:03:23,760
does not do the same indenting that

00:03:20,730 --> 00:03:26,760
dumper does it's all on one line but you

00:03:23,760 --> 00:03:29,220
can see it's the exact same data even

00:03:26,760 --> 00:03:32,580
the same serial number and ID and all of

00:03:29,220 --> 00:03:34,350
that did I fake that is that real I

00:03:32,580 --> 00:03:36,180
don't know well look at the files that

00:03:34,350 --> 00:03:39,030
are in there there's a CPP file and

00:03:36,180 --> 00:03:41,040
there is even a large binary executable

00:03:39,030 --> 00:03:42,720
file it's three Meg's because I'm

00:03:41,040 --> 00:03:44,190
pulling an all Perl dot H right now and

00:03:42,720 --> 00:03:47,310
that's actually not really necessary but

00:03:44,190 --> 00:03:49,650
I'm doing it anyway if we run a the

00:03:47,310 --> 00:03:52,380
command file on that we will see that it

00:03:49,650 --> 00:03:55,920
is in fact an elf 64-bit executable file

00:03:52,380 --> 00:03:57,840
this is a real executable file and I

00:03:55,920 --> 00:04:00,840
think you guys probably would like to

00:03:57,840 --> 00:04:06,060
also see what is that CPP file that was

00:04:00,840 --> 00:04:07,920
generated and how does it relate to the

00:04:06,060 --> 00:04:09,510
original well you saw the Perl just a

00:04:07,920 --> 00:04:14,400
moment ago and now you're seeing the

00:04:09,510 --> 00:04:18,180
automatically generated C++ so all I can

00:04:14,400 --> 00:04:21,150
say is we're far enough along where that

00:04:18,180 --> 00:04:24,870
I can compile it doesn't mean that

00:04:21,150 --> 00:04:27,870
we support all of pro/5 but we're

00:04:24,870 --> 00:04:30,690
we're good enough that we have a major

00:04:27,870 --> 00:04:35,280
Perl client I can't name who on the west

00:04:30,690 --> 00:04:38,940
coast who hired us to do this so the

00:04:35,280 --> 00:04:41,639
time has come the year is now if you

00:04:38,940 --> 00:04:44,360
need to compile your code please come

00:04:41,639 --> 00:04:44,360
see me thank you

00:04:44,590 --> 00:04:47,779

YouTube URL: https://www.youtube.com/watch?v=3z0Z2rOHPT4


