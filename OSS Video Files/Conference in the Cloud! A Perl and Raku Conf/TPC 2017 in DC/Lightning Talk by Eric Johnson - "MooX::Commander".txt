Title: Lightning Talk by Eric Johnson - "MooX::Commander"
Publication date: 2017-06-24
Playlist: TPC 2017 in DC
Description: 
	
Captions: 
	00:00:00,000 --> 00:00:09,510
hi i'm eric i'm kablamo on medicean I

00:00:06,470 --> 00:00:12,330
created a module called mu X command or

00:00:09,510 --> 00:00:14,549
and the goal here is to build command

00:00:12,330 --> 00:00:20,730
line apps with sub commands an option

00:00:14,549 --> 00:00:23,789
parsing like git or diesel so we're

00:00:20,730 --> 00:00:26,369
going to go through an example this is

00:00:23,789 --> 00:00:28,550
not a real command line app

00:00:26,369 --> 00:00:31,619
unfortunately this is an imaginary one

00:00:28,550 --> 00:00:34,290
but so you can see from the usage that

00:00:31,619 --> 00:00:37,260
there are a number of actions here

00:00:34,290 --> 00:00:39,090
commands and also some of the commands

00:00:37,260 --> 00:00:42,270
have sub commands

00:00:39,090 --> 00:00:44,399
there's a help command show you that you

00:00:42,270 --> 00:00:51,750
can get help with other commands and

00:00:44,399 --> 00:00:55,860
that works like this actually before I

00:00:51,750 --> 00:00:58,190
go further usage generating usage or

00:00:55,860 --> 00:01:01,260
help statements was something I

00:00:58,190 --> 00:01:03,030
struggled a lot with everyone has their

00:01:01,260 --> 00:01:03,899
own opinion on how it should work and

00:01:03,030 --> 00:01:09,570
what it should look like

00:01:03,899 --> 00:01:11,040
not every app works the same way I did a

00:01:09,570 --> 00:01:13,619
lot of research and looked at a lot of

00:01:11,040 --> 00:01:15,950
modules and even different languages and

00:01:13,619 --> 00:01:19,890
I just decided it was a hard problem and

00:01:15,950 --> 00:01:21,840
and ultimately that I didn't really care

00:01:19,890 --> 00:01:23,729
that much about it because it's not that

00:01:21,840 --> 00:01:26,400
hard to maintain these statements by

00:01:23,729 --> 00:01:28,740
hand so I didn't even try to solve it so

00:01:26,400 --> 00:01:33,090
this module doesn't generate help or

00:01:28,740 --> 00:01:35,729
usage but as an advantage you get some

00:01:33,090 --> 00:01:36,509
additional simplicity and flexibility if

00:01:35,729 --> 00:01:38,790
you're going to create an application

00:01:36,509 --> 00:01:42,180
like this you probably want to layout

00:01:38,790 --> 00:01:44,970
your project like like this separating

00:01:42,180 --> 00:01:49,740
your presentation logic from the rest of

00:01:44,970 --> 00:01:51,689
your logic is helpful but it immediately

00:01:49,740 --> 00:01:55,409
means that you need to set up routing or

00:01:51,689 --> 00:01:59,729
dispatch from from the script to your

00:01:55,409 --> 00:02:02,369
command classes so let's talk about how

00:01:59,729 --> 00:02:07,740
they work so the user wants to throw a

00:02:02,369 --> 00:02:10,289
pie at Batman in the script you're going

00:02:07,740 --> 00:02:12,400
to create a mu X commander class and

00:02:10,289 --> 00:02:15,670
call the dispatch method

00:02:12,400 --> 00:02:18,629
and passing art be so what this does

00:02:15,670 --> 00:02:23,680
when you call dispatch is it's going to

00:02:18,629 --> 00:02:28,060
look at the throw sub throw command

00:02:23,680 --> 00:02:31,780
class and call the go method you can see

00:02:28,060 --> 00:02:36,819
that the Arg V has been parsed and I'm

00:02:31,780 --> 00:02:39,579
pressing in passing in PI the PI type

00:02:36,819 --> 00:02:41,019
and the target we're going to do some

00:02:39,579 --> 00:02:43,930
validation here and then at the end

00:02:41,019 --> 00:02:48,819
we'll throw the PI is the target so as

00:02:43,930 --> 00:02:51,370
part of the validation you're probably

00:02:48,819 --> 00:02:53,590
going to want to call print the usage

00:02:51,370 --> 00:02:55,420
and exit and there's some logic there

00:02:53,590 --> 00:02:59,709
that's kind of useful I get sick of

00:02:55,420 --> 00:03:02,019
writing it so if you include this role

00:02:59,709 --> 00:03:04,650
you save like two lines of code which is

00:03:02,019 --> 00:03:08,459
not that exciting but you can also

00:03:04,650 --> 00:03:12,329
create this builder and pass this array

00:03:08,459 --> 00:03:16,269
to sit to configure get up.get ox long

00:03:12,329 --> 00:03:20,739
and now you've got an options attribute

00:03:16,269 --> 00:03:23,560
so you can curse loudly before throwing

00:03:20,739 --> 00:03:31,629
the pie at the target at your preferred

00:03:23,560 --> 00:03:33,669
speed in terms of sub commands you to

00:03:31,629 --> 00:03:35,139
set up dispatch to to like those

00:03:33,669 --> 00:03:37,690
commands and then there's sub commands

00:03:35,139 --> 00:03:42,069
right so to set up dispatch you just use

00:03:37,690 --> 00:03:44,799
this role you may will also want some

00:03:42,069 --> 00:03:50,310
usage in their sub command classes work

00:03:44,799 --> 00:03:52,720
the same way that command classes due to

00:03:50,310 --> 00:03:55,359
the help command that I was showing

00:03:52,720 --> 00:03:58,569
previously again all you need to do is

00:03:55,359 --> 00:04:01,629
include this role and a usage statement

00:03:58,569 --> 00:04:05,769
for the overall app and that's it so to

00:04:01,629 --> 00:04:08,199
recap you set up dispatch to the command

00:04:05,769 --> 00:04:09,699
classes if you want to parse options in

00:04:08,199 --> 00:04:13,900
your command classes you use the has

00:04:09,699 --> 00:04:15,280
options role if you want to have sub

00:04:13,900 --> 00:04:17,979
commands then you're going to need to

00:04:15,280 --> 00:04:21,099
use this role and to create a help

00:04:17,979 --> 00:04:22,430
command Thursday is a help command role

00:04:21,099 --> 00:04:23,240
and that's it

00:04:22,430 --> 00:04:27,019
Oh

00:04:23,240 --> 00:04:27,019

YouTube URL: https://www.youtube.com/watch?v=topB0jOxL6o


