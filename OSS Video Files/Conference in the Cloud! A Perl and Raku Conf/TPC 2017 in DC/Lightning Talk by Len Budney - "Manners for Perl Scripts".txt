Title: Lightning Talk by Len Budney - "Manners for Perl Scripts"
Publication date: 2017-06-23
Playlist: TPC 2017 in DC
Description: 
	
Captions: 
	00:00:00,000 --> 00:00:03,750
okay good after good afternoon everybody

00:00:01,709 --> 00:00:05,549
I'm Len bud nee from Grant Street group

00:00:03,750 --> 00:00:07,500
and I want to talk about manners for

00:00:05,549 --> 00:00:11,280
Perl scripts I mean what's up with Perl

00:00:07,500 --> 00:00:12,690
scripts these days anyway so suppose

00:00:11,280 --> 00:00:14,670
that you're told to run a command that

00:00:12,690 --> 00:00:17,550
you are unfamiliar with and you don't

00:00:14,670 --> 00:00:19,289
know what it does what do you do well a

00:00:17,550 --> 00:00:22,310
certain number of you will run it and

00:00:19,289 --> 00:00:22,310
see what happens

00:00:22,789 --> 00:00:28,980
admit it well you don't want to admit it

00:00:25,170 --> 00:00:31,560
but it's true a smaller number will read

00:00:28,980 --> 00:00:33,000
the manual or some of you young

00:00:31,560 --> 00:00:37,110
whippersnappers might google it I

00:00:33,000 --> 00:00:39,120
suppose many I think the majority of us

00:00:37,110 --> 00:00:41,489
would run the command with the help

00:00:39,120 --> 00:00:45,570
option expecting it to tell us something

00:00:41,489 --> 00:00:48,510
useful about itself occasionally however

00:00:45,570 --> 00:00:51,690
we are cruelly disappointed do not ask

00:00:48,510 --> 00:00:53,789
me how I know that system five kilo does

00:00:51,690 --> 00:01:00,300
exactly what it says on the tin and

00:00:53,789 --> 00:01:05,460
ignores all command line arguments don't

00:01:00,300 --> 00:01:07,880
be like sis five kill all so so what is

00:01:05,460 --> 00:01:10,229
etiquette for a nice young Perl script

00:01:07,880 --> 00:01:11,610
well I'm going to give you my

00:01:10,229 --> 00:01:15,299
controversial opinion but since it's

00:01:11,610 --> 00:01:17,220
right you should write it down first you

00:01:15,299 --> 00:01:19,770
should support command-line options from

00:01:17,220 --> 00:01:23,280
the beginning at bare minimum you should

00:01:19,770 --> 00:01:25,710
support help and dash H both so nobody

00:01:23,280 --> 00:01:29,420
gets an unpleasant surprise I highly

00:01:25,710 --> 00:01:31,799
recommend verbose and a couple others

00:01:29,420 --> 00:01:34,200
second I think you should not use

00:01:31,799 --> 00:01:36,270
positional parameters period but you all

00:01:34,200 --> 00:01:38,159
do why because when you first wrote the

00:01:36,270 --> 00:01:40,290
script it took zero parameters and then

00:01:38,159 --> 00:01:42,240
eventually it needed one parameter and I

00:01:40,290 --> 00:01:44,040
guess that's by default positional and

00:01:42,240 --> 00:01:46,380
it seemed like such a waste to use get

00:01:44,040 --> 00:01:48,720
up long for that so by the time you got

00:01:46,380 --> 00:01:50,250
around to five or six parameters it was

00:01:48,720 --> 00:01:53,610
just too big a pain to go back in a

00:01:50,250 --> 00:01:54,899
retrofitted but if you have non option

00:01:53,610 --> 00:01:58,140
parameters they should all be

00:01:54,899 --> 00:02:01,890
interpreted exactly the same think echo

00:01:58,140 --> 00:02:03,899
think cat think Profi it's friendly for

00:02:01,890 --> 00:02:07,079
other utilities and if you don't believe

00:02:03,899 --> 00:02:10,020
me go home and type Ln - SF and -

00:02:07,079 --> 00:02:12,180
filenames half of you will create a sim

00:02:10,020 --> 00:02:13,630
link to a file half of you will delete a

00:02:12,180 --> 00:02:18,250
file and replace it

00:02:13,630 --> 00:02:20,200
with an orphan symlink of course bin CP

00:02:18,250 --> 00:02:25,300
is grandfathered for everything else

00:02:20,200 --> 00:02:27,940
there's get up long 3rd yr in safe

00:02:25,300 --> 00:02:29,800
defaults none of us do that either

00:02:27,940 --> 00:02:31,660
because when we write a script we save

00:02:29,800 --> 00:02:33,430
ourselves typing by wiring in the

00:02:31,660 --> 00:02:34,120
default case and the default case is

00:02:33,430 --> 00:02:38,410
prod

00:02:34,120 --> 00:02:40,180
so the naked command generally does what

00:02:38,410 --> 00:02:42,820
we normally want which is in production

00:02:40,180 --> 00:02:45,580
it's pretty in a crime tab because we

00:02:42,820 --> 00:02:47,620
can use the naked command and you have

00:02:45,580 --> 00:02:49,960
to actually add an argument if you want

00:02:47,620 --> 00:02:52,570
it to do something harmless you should

00:02:49,960 --> 00:02:54,850
do the opposite at least one argument

00:02:52,570 --> 00:02:59,890
should be absolutely required before it

00:02:54,850 --> 00:03:02,620
does something dangerous which leads me

00:02:59,890 --> 00:03:03,790
to you should also this is this is more

00:03:02,620 --> 00:03:05,800
of a suggestion all the rest are

00:03:03,790 --> 00:03:07,780
Commandments this is more of a

00:03:05,800 --> 00:03:10,450
suggestion you should support RC files

00:03:07,780 --> 00:03:12,910
why well for one thing it brings back

00:03:10,450 --> 00:03:14,650
the benefits of wired in defaults

00:03:12,910 --> 00:03:16,900
because now you can put your defaults in

00:03:14,650 --> 00:03:19,120
an RC file you can put a naked command

00:03:16,900 --> 00:03:21,280
and a crontab all the users can pick

00:03:19,120 --> 00:03:23,620
their favorite defaults and if you have

00:03:21,280 --> 00:03:26,440
sensitive options like passwords you can

00:03:23,620 --> 00:03:31,270
wire them into a file that at least has

00:03:26,440 --> 00:03:34,090
restrictive permissions now the trouble

00:03:31,270 --> 00:03:35,950
is that this takes at least 100 lines of

00:03:34,090 --> 00:03:38,650
boilerplate code I did that experiment

00:03:35,950 --> 00:03:40,660
and if you want to be checking errors

00:03:38,650 --> 00:03:42,490
and stuff even more but suppose there

00:03:40,660 --> 00:03:45,280
was a way to do this with little or no

00:03:42,490 --> 00:03:48,310
effort on your part well I have great

00:03:45,280 --> 00:03:50,770
news how I start up will do all of this

00:03:48,310 --> 00:03:52,810
for you and more in particular it

00:03:50,770 --> 00:03:54,460
implements a bunch of default command

00:03:52,810 --> 00:03:57,190
line options particularly help and

00:03:54,460 --> 00:03:59,110
verbose it supports RC files in lots of

00:03:57,190 --> 00:04:01,410
formats without lifting a finger and it

00:03:59,110 --> 00:04:04,480
gives you some other creature comforts

00:04:01,410 --> 00:04:06,280
for example this is a complete script

00:04:04,480 --> 00:04:10,300
unto itself which has all the best

00:04:06,280 --> 00:04:13,420
manners and impeccable breeding it

00:04:10,300 --> 00:04:15,970
doesn't do very much but it will give

00:04:13,420 --> 00:04:18,190
you a helpful help message and it will

00:04:15,970 --> 00:04:19,570
also you can even put in our C file that

00:04:18,190 --> 00:04:22,450
tells it however boasts you want it to

00:04:19,570 --> 00:04:25,030
be it's easy to use use the same syntax

00:04:22,450 --> 00:04:26,330
as get up long together with little bits

00:04:25,030 --> 00:04:28,490
of help text

00:04:26,330 --> 00:04:30,289
Kleist startup does all the rest for you

00:04:28,490 --> 00:04:32,840
it will assemble that into a help

00:04:30,289 --> 00:04:35,500
message it will also give you some sugar

00:04:32,840 --> 00:04:38,599
like pretty printed dye and warns and

00:04:35,500 --> 00:04:40,970
that sort of thing I can't talk about RC

00:04:38,599 --> 00:04:43,340
files because the bell went thing but I

00:04:40,970 --> 00:04:45,440
urge you to do follow all of these

00:04:43,340 --> 00:04:47,599
pieces of advice but in particular to

00:04:45,440 --> 00:04:50,150
look up I start up and give it a try I'm

00:04:47,599 --> 00:04:51,949
also eager to accept patches but

00:04:50,150 --> 00:04:55,080
everyone should do it starting now

00:04:51,949 --> 00:04:59,390
because good manners are always in style

00:04:55,080 --> 00:04:59,390

YouTube URL: https://www.youtube.com/watch?v=ud3isNiB_C0


