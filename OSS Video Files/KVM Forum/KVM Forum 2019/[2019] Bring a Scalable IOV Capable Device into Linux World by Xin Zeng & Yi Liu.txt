Title: [2019] Bring a Scalable IOV Capable Device into Linux World by Xin Zeng & Yi Liu
Publication date: 2019-11-12
Playlist: KVM Forum 2019
Description: 
	Intel has introduced a new hardware-assisted IO virtualization technology, i.e. scalable IOV which provides much better flexibility and scalability in sharing of I/O devices like network interface cards, GPUs, and hardware accelerators across containers and VMs compared to the existing one - SR-IOV. In this presentation, the authors will take an overview of the scalable IOV technology from platform and device's perspective, introduce how to enable a typical scalable IOV device driver through vfio-mdev framework, how to compose the virtual device from scalable IOV capable device and bring up this virtual device, how the virtual device works and how the scalable IOV capable device works together with another PASID based technology SVA(Shared Virtual Address) in virtualization environment.

---

Xin Zeng
Intel
Software Engineer

Xin Zeng is a software engineer of Network Platform Group at Intel Data Center Group. He is now working on virtualization projects for Intel QuickAssist Technology product. Intel QuickAssist Technology can be used to handle compute-intensive security and compression operations that are typically handled by CPU cores to improve the performance of Networking, Storage, and Security Applications across the Data Center.
Xin Zeng has delievered a couple of talks on KVM forum 2017, LC3 conference 2018 and DPDK summit 2017.

Yi Liu
Intel
Software Engineer

Yi is a software engineer from Intel SSP, focusing on I/O virtualization technology. He works on Shared Virtual Memory, Scalable IOV and vIOMMU stuffs in recent years. He has been invited to give presentation at LPC 2017, LinuxCon Beijing 2018 and KVM Forum 2018. Before joining Intel, he has been working on firmware at HP for 3.5 years.

Note: There's no video recording available for this talk due to technical issues.
Captions: 
	00:00:00,390 --> 00:00:02,750
[Music]

00:00:07,580 --> 00:00:13,740
okay

00:00:08,760 --> 00:00:16,139
good morning everyone I'm sense for

00:00:13,740 --> 00:00:20,070
joining this session I'm ginger from

00:00:16,139 --> 00:00:24,230
Intel qtt and that's my colleague evil

00:00:20,070 --> 00:00:27,630
from Intel virtualization team so today

00:00:24,230 --> 00:00:31,050
today we would like to share with you

00:00:27,630 --> 00:00:39,989
how to enable entire scary capable

00:00:31,050 --> 00:00:43,290
device into Linux so this is our agenda

00:00:39,989 --> 00:00:45,930
today before we jump into the

00:00:43,290 --> 00:00:48,390
neighboring activities for the skimmer I

00:00:45,930 --> 00:00:51,059
will keep our device driver we would

00:00:48,390 --> 00:00:55,289
like to recap the entire scary

00:00:51,059 --> 00:00:57,870
technology and also I would like to

00:00:55,289 --> 00:01:02,250
introduce a software architecture in the

00:00:57,870 --> 00:01:04,619
Linux and and then the most important

00:01:02,250 --> 00:01:07,290
part how do we enable the scale very

00:01:04,619 --> 00:01:10,619
capable device sharing in Linux and my

00:01:07,290 --> 00:01:13,380
colleague I will ensure with you how do

00:01:10,619 --> 00:01:16,470
we bring the virtual sure which were

00:01:13,380 --> 00:01:22,650
just technology on top of scale very

00:01:16,470 --> 00:01:24,150
capable virtual device okay so let's

00:01:22,650 --> 00:01:26,360
look carefully in to escape our

00:01:24,150 --> 00:01:30,930
technology so in the escape our

00:01:26,360 --> 00:01:35,759
technology is public in 2018 by Intel

00:01:30,930 --> 00:01:41,030
and it introduced passive granule DMA

00:01:35,759 --> 00:01:44,520
isolation capability and also the final

00:01:41,030 --> 00:01:47,490
assignable Hardware resource so in a

00:01:44,520 --> 00:01:50,790
software side let's give our technology

00:01:47,490 --> 00:01:53,970
leverage current media TV device for him

00:01:50,790 --> 00:01:56,939
work and to immediate immediate access

00:01:53,970 --> 00:01:59,310
to the hardware so move in frequent

00:01:56,939 --> 00:02:02,130
access to hardware forumla hardware

00:01:59,310 --> 00:02:04,860
tools to sort of tourist software so

00:02:02,130 --> 00:02:09,090
let's take a look the diagram in a right

00:02:04,860 --> 00:02:10,050
side the Israel SLV solution versus the

00:02:09,090 --> 00:02:12,460
scale resolution

00:02:10,050 --> 00:02:15,100
you know typical SI resolution

00:02:12,460 --> 00:02:16,840
as a virtual function is a PCI device so

00:02:15,100 --> 00:02:19,450
we can pass through this device to

00:02:16,840 --> 00:02:21,370
lakiya territory but English Garraway we

00:02:19,450 --> 00:02:23,860
introduce a software module virtual

00:02:21,370 --> 00:02:26,620
device composition module this module

00:02:23,860 --> 00:02:30,580
will compose a virtual device on top of

00:02:26,620 --> 00:02:34,320
the minimal assignable Hardware resource

00:02:30,580 --> 00:02:37,900
and composed this device to her guests

00:02:34,320 --> 00:02:41,830
we can see the third point is the

00:02:37,900 --> 00:02:42,460
highlight it's when the device is

00:02:41,830 --> 00:02:44,290
assigned

00:02:42,460 --> 00:02:47,980
where the virtual device is composed all

00:02:44,290 --> 00:02:49,780
all the hardware requests will will all

00:02:47,980 --> 00:02:54,130
upstream requests we attack with their

00:02:49,780 --> 00:02:55,870
passive so if we combine the software

00:02:54,130 --> 00:02:58,450
firm work and hardware technology

00:02:55,870 --> 00:03:01,480
together we can get a benefit from

00:02:58,450 --> 00:03:04,260
hardware that we can give the hardware

00:03:01,480 --> 00:03:08,050
enforced DMA isolation capability and

00:03:04,260 --> 00:03:12,150
also we can enjoy the flexibility and

00:03:08,050 --> 00:03:15,840
scalability from a software framework

00:03:12,150 --> 00:03:19,960
okay let's see what's new in hardware so

00:03:15,840 --> 00:03:23,170
the first one is in the platform side

00:03:19,960 --> 00:03:25,960
I'm new in hability when you introduce a

00:03:23,170 --> 00:03:30,040
new scale mode to support passage

00:03:25,960 --> 00:03:33,340
granule TMA isolation cavity near a

00:03:30,040 --> 00:03:35,800
device side we can see in the diagram

00:03:33,340 --> 00:03:38,260
you can see a typical virtual device is

00:03:35,800 --> 00:03:40,870
composed of virtual configured

00:03:38,260 --> 00:03:47,020
configuration space and virtual bar also

00:03:40,870 --> 00:03:49,000
virtual interrupt and ill in the inter

00:03:47,020 --> 00:03:51,370
interrupt side the interest Akira we

00:03:49,000 --> 00:03:54,850
also introduce a new concept ims

00:03:51,370 --> 00:03:57,850
interrupt message storage to overcome

00:03:54,850 --> 00:04:00,610
the the number limitation of the msi

00:03:57,850 --> 00:04:04,270
brains as we all know the MSX only

00:04:00,610 --> 00:04:07,240
support 2048 vectors but for EDI one

00:04:04,270 --> 00:04:14,320
physical function might have more than

00:04:07,240 --> 00:04:18,130
200 at 2048 Adi so you know to open our

00:04:14,320 --> 00:04:20,350
homeless issue for the entire sky very

00:04:18,130 --> 00:04:22,300
capable device it also need to present a

00:04:20,350 --> 00:04:26,490
hard worker breeding in the device and

00:04:22,300 --> 00:04:26,490
Pacific ability is also required

00:04:28,210 --> 00:04:33,740
let's see let's take a look the diagram

00:04:31,639 --> 00:04:38,810
to see what's the software architecture

00:04:33,740 --> 00:04:41,840
in Linux so as I mentioned just now in

00:04:38,810 --> 00:04:44,469
theory technology leverage current media

00:04:41,840 --> 00:04:47,750
TV device framework but we also need a

00:04:44,469 --> 00:04:51,830
enhancement lettera I am a new available

00:04:47,750 --> 00:04:56,360
media TV device and we in the device

00:04:51,830 --> 00:05:00,610
side we need device specific device

00:04:56,360 --> 00:05:03,860
composition module so we call Madision

00:05:00,610 --> 00:05:07,430
and also for I'm Java we also need to

00:05:03,860 --> 00:05:10,490
enhance them to support a scale mode the

00:05:07,430 --> 00:05:12,379
Patea there is another point is III ask

00:05:10,490 --> 00:05:17,750
you the main we also need to introduce I

00:05:12,379 --> 00:05:21,469
am stemming into a queue in a human side

00:05:17,750 --> 00:05:24,650
as the way also leverage current

00:05:21,469 --> 00:05:28,039
meditative middle pastoral approach so

00:05:24,650 --> 00:05:30,620
for human is agnostic to entire scale we

00:05:28,039 --> 00:05:32,750
have virtual device pass rule in a key

00:05:30,620 --> 00:05:35,659
aside we also need to introduce virtual

00:05:32,750 --> 00:05:40,190
device driver folder for a new compose

00:05:35,659 --> 00:05:43,460
the virtual device so let's see how to

00:05:40,190 --> 00:05:46,060
design the virtual device composition

00:05:43,460 --> 00:05:48,740
module so firstly you need to determine

00:05:46,060 --> 00:05:50,870
the virtual device types for example

00:05:48,740 --> 00:05:54,949
waterless service your virtual device

00:05:50,870 --> 00:05:57,729
should provide how many ad is Lily the

00:05:54,949 --> 00:05:59,900
virtual device should be composed and

00:05:57,729 --> 00:06:03,729
also the second step you need to

00:05:59,900 --> 00:06:06,259
organize all a virtual device resources

00:06:03,729 --> 00:06:08,539
what you devise a typical virtual device

00:06:06,259 --> 00:06:09,919
should can be compose of virtual config

00:06:08,539 --> 00:06:12,830
space and virtual bar

00:06:09,919 --> 00:06:15,560
regions the what you can Victoria space

00:06:12,830 --> 00:06:19,490
should be emulated by level with ECM and

00:06:15,560 --> 00:06:21,319
for the virtual bar we split access to

00:06:19,490 --> 00:06:23,360
the virtual device into two parts wines

00:06:21,319 --> 00:06:26,539
the first pass and the our digital slow

00:06:23,360 --> 00:06:28,849
pass in Fast Pass side you know like

00:06:26,539 --> 00:06:32,990
some work submission interface so it

00:06:28,849 --> 00:06:36,800
also it's usually a some mmm register in

00:06:32,990 --> 00:06:37,790
the PF and in the throw pass is also

00:06:36,800 --> 00:06:41,630
some configure

00:06:37,790 --> 00:06:44,570
and controller gist for these foolish

00:06:41,630 --> 00:06:47,150
virtual device and also least fast

00:06:44,570 --> 00:06:51,830
parsons Rafa's can also be backed by

00:06:47,150 --> 00:06:54,680
some memory in interrupts as as I just

00:06:51,830 --> 00:06:57,140
said for each Adi they have early might

00:06:54,680 --> 00:06:59,240
like they could have some hardware

00:06:57,140 --> 00:07:01,430
interrupts which can be posed to the

00:06:59,240 --> 00:07:03,830
case a guest at the rectory

00:07:01,430 --> 00:07:07,760
for a preform support post interrupts

00:07:03,830 --> 00:07:10,910
kept reading and also we DCM can emulate

00:07:07,760 --> 00:07:15,740
a virtual interrupt injected to virtual

00:07:10,910 --> 00:07:18,170
machine so let's see what how do we

00:07:15,740 --> 00:07:20,330
design what we do a communication

00:07:18,170 --> 00:07:23,270
channel between what you device and

00:07:20,330 --> 00:07:25,250
release iam typically we have two

00:07:23,270 --> 00:07:28,280
approaches why the hardware page just

00:07:25,250 --> 00:07:31,520
like some conditional pfv of

00:07:28,280 --> 00:07:35,870
communication in you can see that very

00:07:31,520 --> 00:07:37,310
often in the SIV solution an inner we

00:07:35,870 --> 00:07:39,710
have another approach it's a

00:07:37,310 --> 00:07:43,400
software-based magmatism you can use

00:07:39,710 --> 00:07:45,520
some memory packed - - inner a travel

00:07:43,400 --> 00:07:48,470
MMO and presently store guest

00:07:45,520 --> 00:07:51,350
finally you need to use leverage MIDI

00:07:48,470 --> 00:07:56,840
device form work to compose and manager

00:07:51,350 --> 00:08:00,770
all a virtual device okay let's see how

00:07:56,840 --> 00:08:02,330
after we introduce the hard way how do

00:08:00,770 --> 00:08:05,030
we design the virtual device

00:08:02,330 --> 00:08:07,880
conversation module so let's see how do

00:08:05,030 --> 00:08:10,850
we how do we manager the virtual device

00:08:07,880 --> 00:08:15,260
with what you device composition module

00:08:10,850 --> 00:08:16,790
for a scare away capable device in

00:08:15,260 --> 00:08:19,310
general it leverage you'll immediately

00:08:16,790 --> 00:08:21,290
devise framework but for ask a very

00:08:19,310 --> 00:08:25,970
capable device we also need to take here

00:08:21,290 --> 00:08:29,300
some some hardware specific points so

00:08:25,970 --> 00:08:32,630
for a virtual device it life cycle can

00:08:29,300 --> 00:08:34,580
be divided a cup of stage the first one

00:08:32,630 --> 00:08:36,320
you need to create and then assign list

00:08:34,580 --> 00:08:39,800
device to a user base process or a

00:08:36,320 --> 00:08:42,290
virtual machine and you can get longtime

00:08:39,800 --> 00:08:44,360
access to the virtual device and another

00:08:42,290 --> 00:08:46,670
very important part is a reset how do we

00:08:44,360 --> 00:08:49,400
reset is what you device in a key store

00:08:46,670 --> 00:08:50,640
in the host and after that what you

00:08:49,400 --> 00:08:54,330
device

00:08:50,640 --> 00:08:56,430
is is result all we don't want useless

00:08:54,330 --> 00:08:58,860
anymore we can remove this about your

00:08:56,430 --> 00:09:01,320
device and also before we remove we need

00:08:58,860 --> 00:09:04,410
to release the device okay so all these

00:09:01,320 --> 00:09:08,040
operations will be reflector will be

00:09:04,410 --> 00:09:10,680
Lahti to lava DCM so let's see how how

00:09:08,040 --> 00:09:14,790
to release him handle the scale very

00:09:10,680 --> 00:09:17,880
specific operations so in folder create

00:09:14,790 --> 00:09:20,070
the user just need to create the virtual

00:09:17,880 --> 00:09:23,100
device through sis file system engine

00:09:20,070 --> 00:09:25,560
and list this operation will be Lahti to

00:09:23,100 --> 00:09:28,880
release him buddhism to to response list

00:09:25,560 --> 00:09:33,000
list operation buddhism need to invite

00:09:28,880 --> 00:09:36,000
invoke a method a Mamu device to

00:09:33,000 --> 00:09:38,430
indicate via file this is a meditative

00:09:36,000 --> 00:09:42,060
device aware this is Mme well

00:09:38,430 --> 00:09:44,280
immediately device and for a skill very

00:09:42,060 --> 00:09:48,000
capable device he also needs some IMS

00:09:44,280 --> 00:09:50,570
irq you need to request a interrupt

00:09:48,000 --> 00:09:53,310
vector from AIIMS acute domain and

00:09:50,570 --> 00:09:56,010
finally it'll also need to allocate all

00:09:53,310 --> 00:09:58,710
ad is to compose level to device and set

00:09:56,010 --> 00:10:01,370
up our resource composer this device and

00:09:58,710 --> 00:10:04,590
present to return this device to the

00:10:01,370 --> 00:10:07,110
middlee of co-driver a medieval Java

00:10:04,590 --> 00:10:12,030
will create an entry in a sis file

00:10:07,110 --> 00:10:14,040
system okay after the device is created

00:10:12,030 --> 00:10:15,750
we need to assign this device to a user

00:10:14,040 --> 00:10:19,040
service process and all a virtual

00:10:15,750 --> 00:10:20,340
machine so typically we have a cup of of

00:10:19,040 --> 00:10:23,970
afros

00:10:20,340 --> 00:10:26,490
open opto and memory map list list will

00:10:23,970 --> 00:10:28,530
lotty to with ism as well for a skipper

00:10:26,490 --> 00:10:30,930
of a cable what you device in open

00:10:28,530 --> 00:10:34,050
operation we should query default

00:10:30,930 --> 00:10:36,870
passage from aiming of auxiliary domain

00:10:34,050 --> 00:10:40,500
and we also need to program list pass it

00:10:36,870 --> 00:10:44,490
to hardware and follow octo you know we

00:10:40,500 --> 00:10:47,220
have a cup of operations comes with octo

00:10:44,490 --> 00:10:49,260
operation so to response list we we need

00:10:47,220 --> 00:10:52,740
to operate the hardware specific

00:10:49,260 --> 00:10:55,500
operation for example to respond to

00:10:52,740 --> 00:10:57,420
program the interrupt vector tool I am a

00:10:55,500 --> 00:11:00,150
stable and to handle a virtual device

00:10:57,420 --> 00:11:01,510
reset and for a memory member is it's

00:11:00,150 --> 00:11:05,529
just like some

00:11:01,510 --> 00:11:08,440
typical mdf operations which we need to

00:11:05,529 --> 00:11:10,570
follow map the fast pathway already

00:11:08,440 --> 00:11:15,550
designed for this what you device to a

00:11:10,570 --> 00:11:18,279
tool user for a long time access as I as

00:11:15,550 --> 00:11:20,260
I mentioned just now we were split into

00:11:18,279 --> 00:11:23,050
two paths which be accessed into two

00:11:20,260 --> 00:11:25,690
parts wines fast paths and the aromas

00:11:23,050 --> 00:11:28,420
for a fast pass lately or Bilotti to

00:11:25,690 --> 00:11:31,510
avoid a DI directory for first Rafa's

00:11:28,420 --> 00:11:36,699
the VD team should be employed or all

00:11:31,510 --> 00:11:40,180
this access and only another important

00:11:36,699 --> 00:11:42,029
part for the device is in interrupt so

00:11:40,180 --> 00:11:45,040
one is for once

00:11:42,029 --> 00:11:48,910
hardware interrupts we quickly which can

00:11:45,040 --> 00:11:50,410
be posed to guest directory for a

00:11:48,910 --> 00:11:53,680
preform support the post

00:11:50,410 --> 00:11:55,540
interoperability and for a virtual

00:11:53,680 --> 00:11:57,459
interrupt the reading should immolated

00:11:55,540 --> 00:12:01,420
interrupt and injected to the watch

00:11:57,459 --> 00:12:03,579
machine let's talk about the research

00:12:01,420 --> 00:12:06,010
how do we reset our virtual device you

00:12:03,579 --> 00:12:10,350
know we should come with our octo

00:12:06,010 --> 00:12:13,240
operations and to response Lee section

00:12:10,350 --> 00:12:15,970
we need to research them we need to make

00:12:13,240 --> 00:12:18,819
sure the hardware resource is crossed

00:12:15,970 --> 00:12:21,670
which means no further actions in

00:12:18,819 --> 00:12:24,130
hardware and we also need to be reset

00:12:21,670 --> 00:12:26,350
the hard way mmm richest and also some

00:12:24,130 --> 00:12:30,339
immolation resource for this virtual

00:12:26,350 --> 00:12:33,279
device and as noted way also we need to

00:12:30,339 --> 00:12:38,199
keep asset for this idea unchanged

00:12:33,279 --> 00:12:39,579
because the device is still active oh we

00:12:38,199 --> 00:12:41,889
should

00:12:39,579 --> 00:12:44,709
after the device is used we might

00:12:41,889 --> 00:12:49,360
release this device so usually list list

00:12:44,709 --> 00:12:51,670
list comes with the closest call with

00:12:49,360 --> 00:12:53,769
the tool response this action we need to

00:12:51,670 --> 00:12:56,589
invalid the passage in hardware store at

00:12:53,769 --> 00:12:58,720
all the upstream request release at

00:12:56,589 --> 00:13:01,120
least idea will not come with the

00:12:58,720 --> 00:13:04,170
passage now and we also need to reset

00:13:01,120 --> 00:13:07,149
the virtual device to ensure no further

00:13:04,170 --> 00:13:08,980
activities only Hardware we also need to

00:13:07,149 --> 00:13:13,910
clean up all a virtual device resource

00:13:08,980 --> 00:13:17,430
allocate after that device is open

00:13:13,910 --> 00:13:19,079
so fully remove if every device is no

00:13:17,430 --> 00:13:22,199
longer used we need to remove this

00:13:19,079 --> 00:13:25,170
device from sis file system and J so to

00:13:22,199 --> 00:13:27,569
response it is this operation the VDC M

00:13:25,170 --> 00:13:31,250
should remove the MM device from virtual

00:13:27,569 --> 00:13:33,569
device and also need to release the

00:13:31,250 --> 00:13:37,319
interrupted resource from racket domain

00:13:33,569 --> 00:13:41,129
and also reset release Lisa

00:13:37,319 --> 00:13:43,170
Adi and associate a resource and also we

00:13:41,129 --> 00:13:46,439
need to King up anneal status associate

00:13:43,170 --> 00:13:48,420
whistle is what you device okay so we're

00:13:46,439 --> 00:13:50,910
still missing something we still need

00:13:48,420 --> 00:13:53,550
discover us garrovick a pretty and

00:13:50,910 --> 00:13:56,850
present list to a medieval kochava so

00:13:53,550 --> 00:13:58,980
how does it happen so firstly the device

00:13:56,850 --> 00:14:01,500
should present in here skyrocket pretty

00:13:58,980 --> 00:14:05,519
and the device gerra with VDC I'm

00:14:01,500 --> 00:14:07,290
detective Gabriel Rodgers to list the

00:14:05,519 --> 00:14:09,990
parent operations tool immediate of

00:14:07,290 --> 00:14:13,139
co-driver and also we need to enable a

00:14:09,990 --> 00:14:15,959
new auxiliary the main solar Telemedia

00:14:13,139 --> 00:14:21,540
Java were registered sis first system

00:14:15,959 --> 00:14:24,089
engine in whole system so let's all for

00:14:21,540 --> 00:14:27,449
me to to assure with your how do we

00:14:24,089 --> 00:14:30,300
enable scare away capable device driver

00:14:27,449 --> 00:14:35,279
in Linux as we all know there are some

00:14:30,300 --> 00:14:38,370
efforts working on what vsv on top of a

00:14:35,279 --> 00:14:40,470
service routine so we also want all the

00:14:38,370 --> 00:14:44,579
same functionality for a scale railway

00:14:40,470 --> 00:14:46,620
so I II will take over the instruction

00:14:44,579 --> 00:14:49,920
and share with you how do we enable the

00:14:46,620 --> 00:14:52,310
vsv on top of alaska very technology so

00:14:49,920 --> 00:14:52,310
thanks

00:14:54,899 --> 00:15:01,439
yes thanks for since great sherry owners

00:14:58,380 --> 00:15:04,290
caliber capable device enabling so next

00:15:01,439 --> 00:15:08,040
i will talk about the SVA supportable

00:15:04,290 --> 00:15:11,970
sky robbery so first i all i'd like to

00:15:08,040 --> 00:15:13,889
have quickly we care about us to share

00:15:11,970 --> 00:15:17,430
the water addressing so it is the heart

00:15:13,889 --> 00:15:21,670
of our feature that allows Co and device

00:15:17,430 --> 00:15:25,300
to share an unified IO IO

00:15:21,670 --> 00:15:30,720
address space so that they can be

00:15:25,300 --> 00:15:34,570
certain share their Iowa buffer and has

00:15:30,720 --> 00:15:37,600
had the calamari and Asami

00:15:34,570 --> 00:15:38,140
the only difference is governor D

00:15:37,600 --> 00:15:41,080
difference

00:15:38,140 --> 00:15:44,020
so we naturally want to have the same as

00:15:41,080 --> 00:15:48,550
to be a sport and in our community we

00:15:44,020 --> 00:15:52,500
had already done some work further as I

00:15:48,550 --> 00:15:57,690
always support and first caliber we will

00:15:52,500 --> 00:16:02,050
use the generic software changes since

00:15:57,690 --> 00:16:05,940
Scott Valley and the SI and SVM as we a

00:16:02,050 --> 00:16:10,600
is both based on their past either

00:16:05,940 --> 00:16:14,590
capability so they do some difference

00:16:10,600 --> 00:16:20,100
force caliber IV device to support as we

00:16:14,590 --> 00:16:24,580
as we a compared with the single week so

00:16:20,100 --> 00:16:27,760
Nesta we will see the difference the

00:16:24,580 --> 00:16:30,930
difference is major in the hardware side

00:16:27,760 --> 00:16:34,600
so for a single route I will be twice

00:16:30,930 --> 00:16:38,400
the SPI transaction and in the nice way

00:16:34,600 --> 00:16:41,500
transaction and it's differ the visor

00:16:38,400 --> 00:16:45,450
with rested and without of health but

00:16:41,500 --> 00:16:50,200
for scannable we device since all other

00:16:45,450 --> 00:16:53,490
transactions are from an idea is with a

00:16:50,200 --> 00:16:56,590
cedar so this is a major difference and

00:16:53,490 --> 00:17:03,580
we needed we D cm to handle the

00:16:56,590 --> 00:17:05,949
difference okay so as we mentioned we

00:17:03,580 --> 00:17:09,010
did say needed to handle that past the

00:17:05,949 --> 00:17:12,190
difference to make as soon as we work

00:17:09,010 --> 00:17:14,050
with the caliber a we so the first one

00:17:12,190 --> 00:17:17,650
is where they come from

00:17:14,050 --> 00:17:19,990
for example as soon as we pass it comes

00:17:17,650 --> 00:17:21,940
from the auxiliary torment which is

00:17:19,990 --> 00:17:26,290
located when there

00:17:21,940 --> 00:17:29,140
the device is is attached to the zero

00:17:26,290 --> 00:17:32,560
rate on men and the secondary is a

00:17:29,140 --> 00:17:33,790
sweeper cedar which is used by SVA

00:17:32,560 --> 00:17:38,800
usages and

00:17:33,790 --> 00:17:41,890
it is set up from care software and this

00:17:38,800 --> 00:17:44,500
president is from there I'm a driver

00:17:41,890 --> 00:17:48,280
which may be allocated from a host

00:17:44,500 --> 00:17:54,130
driver if the passenger is manager in

00:17:48,280 --> 00:17:57,100
the system right okay so with the VTC

00:17:54,130 --> 00:18:00,700
to track the procedures and it also

00:17:57,100 --> 00:18:04,290
needed to do some switch further aid for

00:18:00,700 --> 00:18:09,070
the ad I purchased operation like if

00:18:04,290 --> 00:18:13,480
enable we SVA we need VDC am eager to

00:18:09,070 --> 00:18:17,410
switch in the SUV I pass it to make sure

00:18:13,480 --> 00:18:21,840
at the core the outgoing transaction is

00:18:17,410 --> 00:18:25,120
for SVA and if gets disabled as we as we

00:18:21,840 --> 00:18:27,300
need to switch out the as we pass it

00:18:25,120 --> 00:18:31,690
under switch in the now as we pass it

00:18:27,300 --> 00:18:34,780
and also a VDC also needed to pass the

00:18:31,690 --> 00:18:38,950
drain and the research when as to VA is

00:18:34,780 --> 00:18:43,420
as we pass either is afraid and also if

00:18:38,950 --> 00:18:45,700
there is passages which it also needed

00:18:43,420 --> 00:18:49,930
to do a special agenda research to

00:18:45,700 --> 00:18:55,420
ensure capacitor in the hardware is well

00:18:49,930 --> 00:19:00,550
programmed okay so with we the same

00:18:55,420 --> 00:19:04,120
manager to proceed and did the following

00:19:00,550 --> 00:19:07,450
thing is how to expose vehicle ability

00:19:04,120 --> 00:19:10,120
to Castro so we DCM needed to compose

00:19:07,450 --> 00:19:13,480
the virtual device with us we relate

00:19:10,120 --> 00:19:16,420
heater capabilities like the PCI Express

00:19:13,480 --> 00:19:20,500
specific ability 80s and the PRS

00:19:16,420 --> 00:19:23,170
capability and before the HVDC I'm also

00:19:20,500 --> 00:19:26,650
needed to ensure native software have

00:19:23,170 --> 00:19:32,560
already enabled their corresponding

00:19:26,650 --> 00:19:35,440
abilities and also since with ECM has

00:19:32,560 --> 00:19:38,770
used post the PRS capability - ha -

00:19:35,440 --> 00:19:42,510
gasps - so I also needed to help to

00:19:38,770 --> 00:19:45,830
handle their potential I'll page fold

00:19:42,510 --> 00:19:50,260
which we may do - there

00:19:45,830 --> 00:19:53,600
Paige nom nom retina page in Gaston

00:19:50,260 --> 00:19:55,670
for example we decided to register for

00:19:53,600 --> 00:19:58,700
the handler to a Hemi driver which is

00:19:55,670 --> 00:20:02,540
introduced in the current as we a

00:19:58,700 --> 00:20:05,840
passage and also it needed to notify

00:20:02,540 --> 00:20:08,240
users based client like um you and the

00:20:05,840 --> 00:20:15,130
further to know the injector to get a

00:20:08,240 --> 00:20:19,160
folder into Gaston okay with this work

00:20:15,130 --> 00:20:24,340
we can make scaleable we work with as a

00:20:19,160 --> 00:20:28,280
wheel well okay so here is a summary for

00:20:24,340 --> 00:20:31,000
today's session so what we wanted to

00:20:28,280 --> 00:20:34,790
highlight is interest caliber we are

00:20:31,000 --> 00:20:40,660
Infosys DMA isolation at a personality

00:20:34,790 --> 00:20:45,890
which is more flexible and scalable and

00:20:40,660 --> 00:20:49,490
if you want to develop VDC m4 for the

00:20:45,890 --> 00:20:52,100
Percy declared he DMA isolation can be

00:20:49,490 --> 00:20:56,030
care about the technologies like Intel

00:20:52,100 --> 00:20:58,460
scalable we you needed to make sure you

00:20:56,030 --> 00:21:02,390
are leveraging existing mediated the

00:20:58,460 --> 00:21:04,810
device framework for what we devised

00:21:02,390 --> 00:21:09,440
arrangement and also you need to

00:21:04,810 --> 00:21:12,230
determine your worth of device types and

00:21:09,440 --> 00:21:14,960
also you need to organize your water

00:21:12,230 --> 00:21:17,690
device resource into slow slow paths and

00:21:14,960 --> 00:21:19,930
the fast pace and also in unit to take

00:21:17,690 --> 00:21:25,040
about take care about the hardware

00:21:19,930 --> 00:21:27,620
interrupts like the IMS in scale in

00:21:25,040 --> 00:21:31,030
interest caliber we and also take care

00:21:27,620 --> 00:21:33,860
about the pursuit of programming like

00:21:31,030 --> 00:21:38,450
switch has to be a procedure and and I

00:21:33,860 --> 00:21:43,010
as we proceed and also to support we as

00:21:38,450 --> 00:21:46,340
we a and IO main page fault you need to

00:21:43,010 --> 00:21:51,070
let with ECM to emulate as we're

00:21:46,340 --> 00:21:51,070
capabilities and handle the pitfalls

00:21:51,640 --> 00:21:56,270
okay I think that's all photos are for

00:21:54,410 --> 00:21:59,230
the dead stirring may be any question

00:21:56,270 --> 00:21:59,230
here is welcome

00:22:00,050 --> 00:22:05,179
[Applause]

00:22:07,349 --> 00:22:12,450
yeah very nice Toby come here you are

00:22:10,409 --> 00:22:14,429
talking about it are scalable like how

00:22:12,450 --> 00:22:15,919
many what I do is good a supporter for

00:22:14,429 --> 00:22:19,559
this device

00:22:15,919 --> 00:22:24,299
so let's depends on hardware device you

00:22:19,559 --> 00:22:28,080
know design yes so it's just some design

00:22:24,299 --> 00:22:31,379
not in your human yet yeah you know how

00:22:28,080 --> 00:22:33,629
many virtual device you know the maximum

00:22:31,379 --> 00:22:38,039
unit should be person right for person

00:22:33,629 --> 00:22:41,159
it's 20 bits 20 piece why so in theory

00:22:38,039 --> 00:22:46,349
we can create a 1 billion what you

00:22:41,159 --> 00:22:51,479
device yeah how many registers there the

00:22:46,349 --> 00:22:57,119
size what register which kind of

00:22:51,479 --> 00:23:00,269
register with is him yeah so you know

00:22:57,119 --> 00:23:02,309
how many religious numbers should be

00:23:00,269 --> 00:23:04,469
you're not determined by the hardware at

00:23:02,309 --> 00:23:07,349
work as well the device vendor as well

00:23:04,469 --> 00:23:10,320
so view if you want to expose more

00:23:07,349 --> 00:23:12,719
register to to lay users based or to the

00:23:10,320 --> 00:23:25,039
virtual machine so you shoot you will

00:23:12,719 --> 00:23:32,669
have more and their MD we platform that

00:23:25,039 --> 00:23:34,979
sorry T VT g is VT g is software mate

00:23:32,669 --> 00:23:38,210
which are sing nation there is a typical

00:23:34,979 --> 00:23:42,149
m there and the first arrival we is

00:23:38,210 --> 00:23:45,210
hardware as this theta m their framework

00:23:42,149 --> 00:23:48,089
yeah so you know how to outside you as

00:23:45,210 --> 00:23:52,109
we just highlight in a hardware side the

00:23:48,089 --> 00:23:54,940
VT d enforce DMA oscillation completely

00:23:52,109 --> 00:24:08,690
at passage granularity lateral

00:23:54,940 --> 00:24:12,620
important difference okay thanks hi by

00:24:08,690 --> 00:24:14,720
the configuration of the idea is and the

00:24:12,620 --> 00:24:17,540
way the communication is happening it

00:24:14,720 --> 00:24:20,360
looks like there's no intercommunication

00:24:17,540 --> 00:24:23,300
between say for example some of the ADI

00:24:20,360 --> 00:24:25,760
is kind actually end up in the PF the

00:24:23,300 --> 00:24:27,650
the physical function right yeah being

00:24:25,760 --> 00:24:29,740
running inside the host and some might

00:24:27,650 --> 00:24:32,450
actually end up directly into the

00:24:29,740 --> 00:24:35,540
assigned to the virtual machine itself

00:24:32,450 --> 00:24:38,000
yeah so in today's SR iuv case right

00:24:35,540 --> 00:24:39,800
there could be certain scenarios in

00:24:38,000 --> 00:24:42,410
which basically the guests need to

00:24:39,800 --> 00:24:44,260
communicate with the host say suppose

00:24:42,410 --> 00:24:47,390
it's a network adopter right and

00:24:44,260 --> 00:24:49,250
inherently you need to make sure ensure

00:24:47,390 --> 00:24:50,930
that there is there is certain kind of

00:24:49,250 --> 00:24:54,440
configuration which should be verified

00:24:50,930 --> 00:24:57,380
and say yes or no by the host itself

00:24:54,440 --> 00:24:58,670
before they can be configured right so

00:24:57,380 --> 00:25:01,970
actually there is a need for a

00:24:58,670 --> 00:25:04,970
communication between the VF and the PF

00:25:01,970 --> 00:25:06,590
and these days you basically use the

00:25:04,970 --> 00:25:09,710
mailbox concept which is a hardware

00:25:06,590 --> 00:25:12,920
mailbox and any exchanges happen between

00:25:09,710 --> 00:25:15,350
the the guests and the PF using that

00:25:12,920 --> 00:25:17,030
mailbox right so with this the way the

00:25:15,350 --> 00:25:19,880
architecture of the ad is and the

00:25:17,030 --> 00:25:21,320
composable VF is there so these are

00:25:19,880 --> 00:25:24,230
directly being assigned to the either

00:25:21,320 --> 00:25:26,690
the guest or the host so that means we

00:25:24,230 --> 00:25:30,290
have actually taken off the entire

00:25:26,690 --> 00:25:33,590
configuration part related to the guest

00:25:30,290 --> 00:25:36,590
from the initial existing the Piaf's

00:25:33,590 --> 00:25:39,050
which we used to unbind them and then

00:25:36,590 --> 00:25:41,000
through the vfi of exposure to the the

00:25:39,050 --> 00:25:43,280
guest directly so now you can directly

00:25:41,000 --> 00:25:48,020
have the queues through assigned to the

00:25:43,280 --> 00:25:51,800
the VF now right so the that the lateral

00:25:48,020 --> 00:25:54,230
communication one and the communication

00:25:51,800 --> 00:25:57,530
between the guest and the host that is

00:25:54,230 --> 00:25:59,870
missing so so there's a follow-up

00:25:57,530 --> 00:26:03,260
question to this as well so that is a on

00:25:59,870 --> 00:26:05,480
the above layer so if you've got a SRO

00:26:03,260 --> 00:26:07,100
we then you can also have a kind of a

00:26:05,480 --> 00:26:07,910
configuration at the hardware level or

00:26:07,100 --> 00:26:08,480
not a configuration with the

00:26:07,910 --> 00:26:11,870
communication

00:26:08,480 --> 00:26:15,290
where to virtual functions can

00:26:11,870 --> 00:26:21,110
communicate as a kind of a peer-to-peer

00:26:15,290 --> 00:26:22,870
or you can have even through you can

00:26:21,110 --> 00:26:25,040
also have the PF - PF kind of

00:26:22,870 --> 00:26:27,520
communication so if you've got multiple

00:26:25,040 --> 00:26:29,870
physical functions and the way you can

00:26:27,520 --> 00:26:33,280
decompose the physical function to

00:26:29,870 --> 00:26:34,940
multiple ideas can you have

00:26:33,280 --> 00:26:36,650
intercommunication between a different

00:26:34,940 --> 00:26:38,990
idea is belonging to different PDFs as

00:26:36,650 --> 00:26:40,940
well so if that is the case that third

00:26:38,990 --> 00:26:43,160
final question is is there kind of a

00:26:40,940 --> 00:26:44,870
security issues you're you have to take

00:26:43,160 --> 00:26:46,549
care of like you have a ATC in case of

00:26:44,870 --> 00:26:49,010
the PCI Express and the further

00:26:46,549 --> 00:26:50,630
configuration bit and shows that whether

00:26:49,010 --> 00:26:55,100
to allow that or not something like that

00:26:50,630 --> 00:26:56,960
so so many questions so so actually you

00:26:55,100 --> 00:26:59,200
are talking about the communication

00:26:56,960 --> 00:27:01,730
between a guest and a host right yeah

00:26:59,200 --> 00:27:04,010
yeah yeah you're right so for the

00:27:01,730 --> 00:27:06,230
virtual device you know it doesn't have

00:27:04,010 --> 00:27:09,169
any configuration space it sure with

00:27:06,230 --> 00:27:11,630
sure can be green space with the PF

00:27:09,169 --> 00:27:13,850
right yeah so it doesn't have it right

00:27:11,630 --> 00:27:16,340
now yeah it doesn't have so what my

00:27:13,850 --> 00:27:17,179
question is in some of the configuration

00:27:16,340 --> 00:27:20,419
say for example the network

00:27:17,179 --> 00:27:22,250
configuration right so of the guess a

00:27:20,419 --> 00:27:25,250
for example it's trying to configure

00:27:22,250 --> 00:27:26,690
certain port and say it wants to

00:27:25,250 --> 00:27:29,240
configure a MAC address of the guest

00:27:26,690 --> 00:27:31,640
right depending upon whether the VF is

00:27:29,240 --> 00:27:33,740
trusted or non trusted you might

00:27:31,640 --> 00:27:35,980
actually end up in allowing that

00:27:33,740 --> 00:27:40,299
configuration from the guess itself

00:27:35,980 --> 00:27:42,980
right yep sorry so so I need to

00:27:40,299 --> 00:27:46,070
interrupt you actually follow contribute

00:27:42,980 --> 00:27:48,500
his face I think we what I talked about

00:27:46,070 --> 00:27:50,660
the completion space which are sure

00:27:48,500 --> 00:27:53,840
where the pier is a PCIe compression

00:27:50,660 --> 00:27:56,360
space but for a EDIF part it has some

00:27:53,840 --> 00:27:59,270
mmm reduce just like I mentioned in the

00:27:56,360 --> 00:28:02,480
in one slide we have divided into two

00:27:59,270 --> 00:28:05,720
parts wine sofas and ER is either either

00:28:02,480 --> 00:28:07,549
a fast pass for four sofas the Emma ad I

00:28:05,720 --> 00:28:10,160
could have some configuration and

00:28:07,549 --> 00:28:11,330
configure reduced list can be intercept

00:28:10,160 --> 00:28:14,840
by the Paramveer

00:28:11,330 --> 00:28:16,970
and I'm elated by the BDC em okay fine

00:28:14,840 --> 00:28:20,600
so that is the PCA configuration right

00:28:16,970 --> 00:28:23,510
so if I am understanding it correctly by

00:28:20,600 --> 00:28:25,850
this I actually also read it from one of

00:28:23,510 --> 00:28:28,520
the I think probably the patent filed by

00:28:25,850 --> 00:28:30,440
the Intel somewhere it was written that

00:28:28,520 --> 00:28:34,220
we don't require a mailbox now after

00:28:30,440 --> 00:28:35,120
having this Adi composable vs so I don't

00:28:34,220 --> 00:28:38,240
know whether I'm correct in

00:28:35,120 --> 00:28:40,670
understanding that or not or maybe yes

00:28:38,240 --> 00:28:42,940
so we probably we can talk of Ryan

00:28:40,670 --> 00:28:46,300
O'Brian yeah thank you

00:28:42,940 --> 00:28:46,300
okay thank you

00:28:47,130 --> 00:28:55,869
[Applause]

00:28:49,010 --> 00:28:55,869

YouTube URL: https://www.youtube.com/watch?v=G6D-jaCs6sc


